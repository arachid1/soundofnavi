Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2256
Description:  augm_half_mixednet
2021-06-26 04:28:56.822318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-26 04:28:59.397546: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-26 04:28:59.398491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-26 04:28:59.444130: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:28:59.444802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-26 04:28:59.444830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-26 04:28:59.448176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-26 04:28:59.448259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-26 04:28:59.449364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-26 04:28:59.449653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-26 04:28:59.450630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-26 04:28:59.451501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-26 04:28:59.451666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-26 04:28:59.451773: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:28:59.452499: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:28:59.453154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2256.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-26 04:29:04.667363: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-26 04:29:04.667626: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:29:04.668351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-26 04:29:04.668393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-26 04:29:04.668449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-26 04:29:04.668470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-26 04:29:04.668490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-26 04:29:04.668509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-26 04:29:04.668531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-26 04:29:04.668558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-26 04:29:04.668578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-26 04:29:04.668686: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:29:04.669402: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:29:04.670058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-26 04:29:04.670105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-26 04:29:05.397836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-26 04:29:05.397883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-26 04:29:05.397893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-26 04:29:05.398197: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:29:05.398961: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:29:05.399707: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-26 04:29:05.400346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-06-26 04:29:06.558600: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-26 04:29:06.560135: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-26 04:29:06.896968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-26 04:29:09.217255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-26 04:29:09.759405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 64, 1250, 1)]                       0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 64, 1250, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 64, 1250, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 32, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 32, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 32, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 32, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 16, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 16, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 16, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 16, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 8, 157, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 8, 157, 32)                          128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 8, 157, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 8, 157, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 4, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 4, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 4, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 4, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 2, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 2, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 58s - loss: 0.5906 - accuracy: 0.6272 - val_loss: 0.8134 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.16389320212850408
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
167/167 - 55s - loss: 0.3028 - accuracy: 0.8170 - val_loss: 0.9964 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.12008034898132218
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
167/167 - 53s - loss: 0.2022 - accuracy: 0.8908 - val_loss: 1.2138 - val_accuracy: 0.0847
Confusion matrix: 
 [[ 11 562]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.019 0.981]
 [0.    1.   ]]
Validation f1: 12.73
Validation accuracy: 8.47
Validation recall: 100.00
Validation precision: 6.80
Validation AUC: 0.09332956556827514
Validation class accuracies: [0.019197207678883072, 1.0]
Saving model...
Epoch 4/65
167/167 - 54s - loss: 0.1366 - accuracy: 0.9411 - val_loss: 0.4166 - val_accuracy: 0.8502
Confusion matrix: 
 [[516  57]
 [ 35   6]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.854 0.146]]
Validation f1: 11.54
Validation accuracy: 85.02
Validation recall: 14.63
Validation precision: 9.52
Validation AUC: 0.09931517641123573
Validation class accuracies: [0.900523560209424, 0.14634146341463414]
The validation tracker metric at 0.12732919254658384 hasn't increased by 0 in 1 epochs
Epoch 5/65
167/167 - 55s - loss: 0.0871 - accuracy: 0.9595 - val_loss: 2.1112 - val_accuracy: 0.4365
Confusion matrix: 
 [[227 346]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.396 0.604]
 [0.    1.   ]]
Validation f1: 19.16
Validation accuracy: 43.65
Validation recall: 100.00
Validation precision: 10.59
Validation AUC: 0.48777645836128697
Validation class accuracies: [0.3961605584642234, 1.0]
Saving model...
Epoch 6/65
167/167 - 54s - loss: 0.0593 - accuracy: 0.9771 - val_loss: 0.2493 - val_accuracy: 0.9300
Confusion matrix: 
 [[549  24]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.463 0.537]]
Validation f1: 50.57
Validation accuracy: 93.00
Validation recall: 53.66
Validation precision: 47.83
Validation AUC: 0.586409006531606
Validation class accuracies: [0.9581151832460733, 0.5365853658536586]
Saving model...
Epoch 7/65
167/167 - 57s - loss: 0.0611 - accuracy: 0.9801 - val_loss: 0.5616 - val_accuracy: 0.7687
Confusion matrix: 
 [[443 130]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.773 0.227]
 [0.293 0.707]]
Validation f1: 29.00
Validation accuracy: 76.87
Validation recall: 70.73
Validation precision: 18.24
Validation AUC: 0.561097323215323
Validation class accuracies: [0.7731239092495636, 0.7073170731707317]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 1 epochs
Epoch 8/65
167/167 - 54s - loss: 0.0742 - accuracy: 0.9685 - val_loss: 0.8838 - val_accuracy: 0.6889
Confusion matrix: 
 [[389 184]
 [  7  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.679 0.321]
 [0.171 0.829]]
Validation f1: 26.25
Validation accuracy: 68.89
Validation recall: 82.93
Validation precision: 15.60
Validation AUC: 0.6275455805970471
Validation class accuracies: [0.6788830715532286, 0.8292682926829268]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 2 epochs
Epoch 9/65
167/167 - 56s - loss: 0.0281 - accuracy: 0.9902 - val_loss: 0.2574 - val_accuracy: 0.9218
Confusion matrix: 
 [[543  30]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.439 0.561]]
Validation f1: 48.94
Validation accuracy: 92.18
Validation recall: 56.10
Validation precision: 43.40
Validation AUC: 0.5723411213386178
Validation class accuracies: [0.9476439790575916, 0.5609756097560976]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 3 epochs
Epoch 10/65
167/167 - 53s - loss: 0.0164 - accuracy: 0.9940 - val_loss: 0.2364 - val_accuracy: 0.9235
Confusion matrix: 
 [[545  28]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.463 0.537]]
Validation f1: 48.35
Validation accuracy: 92.35
Validation recall: 53.66
Validation precision: 44.00
Validation AUC: 0.5590280130219418
Validation class accuracies: [0.9511343804537522, 0.5365853658536586]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 4 epochs
Epoch 11/65
167/167 - 57s - loss: 0.0104 - accuracy: 0.9992 - val_loss: 0.2396 - val_accuracy: 0.9169
Confusion matrix: 
 [[539  34]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.415 0.585]]
Validation f1: 48.48
Validation accuracy: 91.69
Validation recall: 58.54
Validation precision: 41.38
Validation AUC: 0.5981992213943849
Validation class accuracies: [0.9406631762652705, 0.5853658536585366]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 5 epochs
Epoch 12/65
167/167 - 53s - loss: 0.0225 - accuracy: 0.9936 - val_loss: 0.2585 - val_accuracy: 0.9300
Confusion matrix: 
 [[551  22]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.512 0.488]]
Validation f1: 48.19
Validation accuracy: 93.00
Validation recall: 48.78
Validation precision: 47.62
Validation AUC: 0.5382153633424513
Validation class accuracies: [0.9616055846422339, 0.4878048780487805]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
167/167 - 56s - loss: 0.0315 - accuracy: 0.9876 - val_loss: 0.2586 - val_accuracy: 0.9169
Confusion matrix: 
 [[541  32]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.463 0.537]]
Validation f1: 46.32
Validation accuracy: 91.69
Validation recall: 53.66
Validation precision: 40.74
Validation AUC: 0.5202766460849534
Validation class accuracies: [0.944153577661431, 0.5365853658536586]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 7 epochs
Epoch 14/65
167/167 - 54s - loss: 0.0141 - accuracy: 0.9962 - val_loss: 0.2777 - val_accuracy: 0.9153
Confusion matrix: 
 [[537  36]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.39  0.61 ]]
Validation f1: 49.02
Validation accuracy: 91.53
Validation recall: 60.98
Validation precision: 40.98
Validation AUC: 0.5637884409393032
Validation class accuracies: [0.93717277486911, 0.6097560975609756]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 8 epochs
Epoch 15/65
167/167 - 54s - loss: 0.0099 - accuracy: 0.9981 - val_loss: 0.2238 - val_accuracy: 0.9267
Confusion matrix: 
 [[547  26]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.463 0.537]]
Validation f1: 49.44
Validation accuracy: 92.67
Validation recall: 53.66
Validation precision: 45.83
Validation AUC: 0.5475365513447978
Validation class accuracies: [0.9546247818499127, 0.5365853658536586]
The validation tracker metric at 0.5057471264367817 hasn't increased by 0 in 9 epochs
Epoch 16/65
167/167 - 54s - loss: 0.0142 - accuracy: 0.9962 - val_loss: 0.2115 - val_accuracy: 0.9397
Confusion matrix: 
 [[556  17]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.488 0.512]]
Validation f1: 53.16
Validation accuracy: 93.97
Validation recall: 51.22
Validation precision: 55.26
Validation AUC: 0.5847140044069328
Validation class accuracies: [0.9703315881326352, 0.5121951219512195]
Saving model...
Epoch 17/65
167/167 - 55s - loss: 0.0068 - accuracy: 0.9992 - val_loss: 0.2120 - val_accuracy: 0.9349
Confusion matrix: 
 [[552  21]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.463 0.537]]
Validation f1: 52.38
Validation accuracy: 93.49
Validation recall: 53.66
Validation precision: 51.16
Validation AUC: 0.5910845472332962
Validation class accuracies: [0.9633507853403142, 0.5365853658536586]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 1 epochs
Epoch 18/65
167/167 - 56s - loss: 0.0060 - accuracy: 0.9996 - val_loss: 0.2173 - val_accuracy: 0.9365
Confusion matrix: 
 [[555  18]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.512 0.488]]
Validation f1: 50.63
Validation accuracy: 93.65
Validation recall: 48.78
Validation precision: 52.63
Validation AUC: 0.5856472610287261
Validation class accuracies: [0.9685863874345549, 0.4878048780487805]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 2 epochs
Epoch 19/65
167/167 - 53s - loss: 0.0056 - accuracy: 0.9996 - val_loss: 0.2115 - val_accuracy: 0.9332
Confusion matrix: 
 [[551  22]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.463 0.537]]
Validation f1: 51.76
Validation accuracy: 93.32
Validation recall: 53.66
Validation precision: 50.00
Validation AUC: 0.5930330998313238
Validation class accuracies: [0.9616055846422339, 0.5365853658536586]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 3 epochs
Epoch 20/65
167/167 - 57s - loss: 0.0073 - accuracy: 0.9996 - val_loss: 0.2362 - val_accuracy: 0.9300
Confusion matrix: 
 [[549  24]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.57
Validation accuracy: 93.00
Validation recall: 53.66
Validation precision: 47.83
Validation AUC: 0.5666033076685262
Validation class accuracies: [0.9581151832460733, 0.5365853658536586]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 4 epochs
Epoch 21/65
167/167 - 54s - loss: 0.0043 - accuracy: 1.0000 - val_loss: 0.2372 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.5784291616954423
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 5 epochs
Epoch 22/65
167/167 - 57s - loss: 0.0043 - accuracy: 1.0000 - val_loss: 0.2301 - val_accuracy: 0.9316
Confusion matrix: 
 [[550  23]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.463 0.537]]
Validation f1: 51.16
Validation accuracy: 93.16
Validation recall: 53.66
Validation precision: 48.89
Validation AUC: 0.5872074321234534
Validation class accuracies: [0.9598603839441536, 0.5365853658536586]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
167/167 - 53s - loss: 0.0039 - accuracy: 0.9996 - val_loss: 0.2461 - val_accuracy: 0.9267
Confusion matrix: 
 [[546  27]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.439 0.561]]
Validation f1: 50.55
Validation accuracy: 92.67
Validation recall: 56.10
Validation precision: 46.00
Validation AUC: 0.582446968648449
Validation class accuracies: [0.9528795811518325, 0.5609756097560976]
The validation tracker metric at 0.5316455696202531 hasn't increased by 0 in 7 epochs
Epoch 24/65
167/167 - 56s - loss: 0.0040 - accuracy: 0.9996 - val_loss: 0.2188 - val_accuracy: 0.9349
Confusion matrix: 
 [[551  22]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.439 0.561]]
Validation f1: 53.49
Validation accuracy: 93.49
Validation recall: 56.10
Validation precision: 51.11
Validation AUC: 0.5959522218381667
Validation class accuracies: [0.9616055846422339, 0.5609756097560976]
Saving model...
Epoch 25/65
167/167 - 53s - loss: 0.0051 - accuracy: 1.0000 - val_loss: 0.2253 - val_accuracy: 0.9283
Confusion matrix: 
 [[546  27]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.415 0.585]]
Validation f1: 52.17
Validation accuracy: 92.83
Validation recall: 58.54
Validation precision: 47.06
Validation AUC: 0.5959867867424964
Validation class accuracies: [0.9528795811518325, 0.5853658536585366]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 1 epochs
Epoch 26/65
167/167 - 55s - loss: 0.0093 - accuracy: 0.9996 - val_loss: 0.3679 - val_accuracy: 0.9088
Confusion matrix: 
 [[529  44]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.293 0.707]]
Validation f1: 50.88
Validation accuracy: 90.88
Validation recall: 70.73
Validation precision: 39.73
Validation AUC: 0.5932313348785265
Validation class accuracies: [0.9232111692844677, 0.7073170731707317]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 2 epochs
Epoch 27/65
167/167 - 54s - loss: 0.0052 - accuracy: 0.9985 - val_loss: 0.2452 - val_accuracy: 0.9316
Confusion matrix: 
 [[550  23]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.463 0.537]]
Validation f1: 51.16
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.16
Validation recall: 53.66
Validation precision: 48.89
Validation AUC: 0.6036594439129562
Validation class accuracies: [0.9598603839441536, 0.5365853658536586]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 3 epochs
Epoch 28/65
167/167 - 53s - loss: 0.0040 - accuracy: 0.9996 - val_loss: 0.2383 - val_accuracy: 0.9267
Confusion matrix: 
 [[546  27]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.439 0.561]]
Validation f1: 50.55
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.67
Validation recall: 56.10
Validation precision: 46.00
Validation AUC: 0.5952525311410738
Validation class accuracies: [0.9528795811518325, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 4 epochs
Epoch 29/65
167/167 - 56s - loss: 0.0025 - accuracy: 1.0000 - val_loss: 0.2324 - val_accuracy: 0.9316
Confusion matrix: 
 [[549  24]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.439 0.561]]
Validation f1: 52.27
Validation accuracy: 93.16
Validation recall: 56.10
Validation precision: 48.94
Validation AUC: 0.5966167547061264
Validation class accuracies: [0.9581151832460733, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 5 epochs
Epoch 30/65
167/167 - 54s - loss: 0.0031 - accuracy: 1.0000 - val_loss: 0.2395 - val_accuracy: 0.9283
Confusion matrix: 
 [[547  26]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.439 0.561]]
Validation f1: 51.11
Validation accuracy: 92.83
Validation recall: 56.10
Validation precision: 46.94
Validation AUC: 0.5964198308137221
Validation class accuracies: [0.9546247818499127, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 31/65
167/167 - 57s - loss: 0.0060 - accuracy: 1.0000 - val_loss: 0.2444 - val_accuracy: 0.9267
Confusion matrix: 
 [[546  27]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.55
Validation accuracy: 92.67
Validation recall: 56.10
Validation precision: 46.00
Validation AUC: 0.6065166051064504
Validation class accuracies: [0.9528795811518325, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 7 epochs
Epoch 32/65
167/167 - 54s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2403 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
Validation f1: 51.69
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.5990910106248283
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 8 epochs
Epoch 33/65
167/167 - 57s - loss: 0.0023 - accuracy: 1.0000 - val_loss: 0.2344 - val_accuracy: 0.9332
Confusion matrix: 
 [[550  23]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.439 0.561]]
Validation f1: 52.87
Validation accuracy: 93.32
Validation recall: 56.10
Validation precision: 50.00
Validation AUC: 0.5989005976645032
Validation class accuracies: [0.9598603839441536, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 9 epochs
Epoch 34/65
167/167 - 54s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.2311 - val_accuracy: 0.9349
Confusion matrix: 
 [[551  22]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.49
Validation accuracy: 93.49
Validation recall: 56.10
Validation precision: 51.11
Validation AUC: 0.601125120537425
Validation class accuracies: [0.9616055846422339, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 10 epochs
Epoch 35/65
167/167 - 57s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.2393 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.5948123174043153
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 11 epochs
Epoch 36/65
167/167 - 53s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.2343 - val_accuracy: 0.9316
Confusion matrix: 
 [[549  24]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 93.16
Validation recall: 56.10
Validation precision: 48.94
Validation AUC: 0.6028465601678111
Validation class accuracies: [0.9581151832460733, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 37/65
167/167 - 55s - loss: 0.0028 - accuracy: 1.0000 - val_loss: 0.2360 - val_accuracy: 0.9349
Confusion matrix: 
 [[551  22]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.49
Validation accuracy: 93.49
Validation recall: 56.10
Validation precision: 51.11
Validation AUC: 0.5986801671743741
Validation class accuracies: [0.9616055846422339, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 13 epochs
Epoch 38/65
167/167 - 54s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2405 - val_accuracy: 0.9283
Confusion matrix: 
 [[547  26]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.11
Validation accuracy: 92.83
Validation recall: 56.10
Validation precision: 46.94
Validation AUC: 0.5971809767926083
Validation class accuracies: [0.9546247818499127, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 14 epochs
Epoch 39/65
167/167 - 54s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.2351 - val_accuracy: 0.9316
Confusion matrix: 
 [[549  24]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 93.16
Validation recall: 56.10
Validation precision: 48.94
Validation AUC: 0.597926078340438
Validation class accuracies: [0.9581151832460733, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 15 epochs
Epoch 40/65
167/167 - 56s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.2356 - val_accuracy: 0.9316
Confusion matrix: 
 [[549  24]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 93.16
Validation recall: 56.10
Validation precision: 48.94
Validation AUC: 0.6001841756032426
Validation class accuracies: [0.9581151832460733, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 16 epochs
Epoch 41/65
167/167 - 53s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.2382 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.6006033499047949
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 17 epochs
Epoch 42/65
167/167 - 56s - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.2295 - val_accuracy: 0.9332
Confusion matrix: 
 [[550  23]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.439 0.561]]
Validation f1: 52.87
Validation accuracy: 93.32
Validation recall: 56.10
Validation precision: 50.00
Validation AUC: 0.605347523264756
Validation class accuracies: [0.9598603839441536, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 43/65
167/167 - 54s - loss: 0.0026 - accuracy: 1.0000 - val_loss: 0.2301 - val_accuracy: 0.9316
Confusion matrix: 
 [[549  24]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.27
Validation accuracy: 93.16
Validation recall: 56.10
Validation precision: 48.94
Validation AUC: 0.6075618134401315
Validation class accuracies: [0.9581151832460733, 0.5609756097560976]
The validation tracker metric at 0.5348837209302325 hasn't increased by 0 in 19 epochs
Epoch 44/65
167/167 - 56s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.2325 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.6056122309226893
Validation class accuracies: [0.956369982547993, 0.5609756097560976]

The metrics for job 0 with the best target metric are: 
Best cm: [[551  22]
 [ 18  23]]
Best normalized cm: [[0.962 0.038]
 [0.439 0.561]]
Best f1: 0.53
Best accuracy: 0.93
Best recall: 0.56
Best precision: 0.51
Best AUC: 0.60
Best class accuracies: [0.9616055846422339, 0.5609756097560976]
Best epoch: 24
The number of epochs since last 1% equals the patience
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[5.251e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.04]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[8.676e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.288]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[1.921e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[7.803e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.023]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_0.png, [[0.275]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[1.557e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[5.044e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.159]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[7.307e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.215]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[5.495e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.094e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[6.38e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[8.838e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[3.271e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.22e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[1.13e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.78e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_1.png, [[0.57]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.014]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 12813
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_042859-1eggvurw/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_042859-1eggvurw/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.92997
wandb:             _runtime 2877
wandb:           _timestamp 1624684617
wandb:                _step 325
wandb:           train_loss 0.00237
wandb:             val_loss 0.23252
wandb:           val_recall 0.56098
wandb:        val_precision 0.47917
wandb:               val_f1 0.51685
wandb:              val_auc 0.60561
wandb:                   lr 3e-05
wandb:          best_val_f1 0.53488
wandb:    best_val_accuracy 0.93485
wandb:   best_val_precision 0.51111
wandb:      best_val_recall 0.56098
wandb:             best_auc 0.59595
wandb:           best_epoch 24
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇██▇████████████████████████████████
wandb:     val_accuracy ▁▁▁▇▄█▇▆████████████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▄▅▂█▁▂▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ███▁█▄▆▇▄▄▄▄▅▄▄▄▄▄▄▄▄▄▅▆▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▁▁▁▁▂▇▃▂▆▆▇▆▆▇█▇█▇▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▁▁▁▂█▄▃▇▇▇▇▇▇██████████████████████████
wandb:          val_auc ▂▁▁▁▆▇▇█▇▇▇▇▇▇▇█▇█▇▇▇███████████████████
wandb:               lr ███████████▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_042859-1eggvurw

-----------------------
Changing augmentation to v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 64, 1250, 1)]                       0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 64, 1250, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 64, 1250, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 32, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 32, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 32, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 32, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 16, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 16, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 16, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 16, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 8, 157, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 8, 157, 32)                          128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 8, 157, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 8, 157, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 4, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 4, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 4, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 4, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 2, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 2, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 54s - loss: 0.5643 - accuracy: 0.6504 - val_loss: 0.6476 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1466668563586065
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
167/167 - 50s - loss: 0.2919 - accuracy: 0.8297 - val_loss: 0.5597 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.24705514719264524
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
167/167 - 47s - loss: 0.1542 - accuracy: 0.9220 - val_loss: 0.7275 - val_accuracy: 0.3974
Confusion matrix: 
 [[211 362]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.368 0.632]
 [0.195 0.805]]
Validation f1: 15.14
Validation accuracy: 39.74
Validation recall: 80.49
Validation precision: 8.35
Validation AUC: 0.3143365325485509
Validation class accuracies: [0.3682373472949389, 0.8048780487804879]
Saving model...
Epoch 4/65
167/167 - 49s - loss: 0.1068 - accuracy: 0.9490 - val_loss: 0.4471 - val_accuracy: 0.8176
Confusion matrix: 
 [[480  93]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.463 0.537]]
Validation f1: 28.21
Validation accuracy: 81.76
Validation recall: 53.66
Validation precision: 19.13
Validation AUC: 0.16916376614932183
Validation class accuracies: [0.837696335078534, 0.5365853658536586]
Saving model...
Epoch 5/65
167/167 - 53s - loss: 0.0847 - accuracy: 0.9666 - val_loss: 0.3372 - val_accuracy: 0.8860
Confusion matrix: 
 [[519  54]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.39  0.61 ]]
Validation f1: 41.67
Validation accuracy: 88.60
Validation recall: 60.98
Validation precision: 31.65
Validation AUC: 0.33633558263652175
Validation class accuracies: [0.9057591623036649, 0.6097560975609756]
Saving model...
Epoch 6/65
167/167 - 56s - loss: 0.0685 - accuracy: 0.9722 - val_loss: 0.2729 - val_accuracy: 0.9218
Confusion matrix: 
 [[542  31]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.415 0.585]]
Validation f1: 50.00
Validation accuracy: 92.18
Validation recall: 58.54
Validation precision: 43.64
Validation AUC: 0.48296217183717655
Validation class accuracies: [0.9458987783595113, 0.5853658536585366]
Saving model...
Epoch 7/65
167/167 - 54s - loss: 0.0307 - accuracy: 0.9902 - val_loss: 0.2268 - val_accuracy: 0.9283
Confusion matrix: 
 [[558  15]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.707 0.293]]
Validation f1: 35.29
Validation accuracy: 92.83
Validation recall: 29.27
Validation precision: 44.44
Validation AUC: 0.4321949201363662
Validation class accuracies: [0.9738219895287958, 0.2926829268292683]
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
Epoch 8/65
167/167 - 56s - loss: 0.0429 - accuracy: 0.9842 - val_loss: 0.2930 - val_accuracy: 0.9283
Confusion matrix: 
 [[549  24]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.488 0.512]]
Validation f1: 48.84
Validation accuracy: 92.83
Validation recall: 51.22
Validation precision: 46.67
Validation AUC: 0.48333432719465047
Validation class accuracies: [0.9581151832460733, 0.5121951219512195]
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
Epoch 9/65
167/167 - 53s - loss: 0.0318 - accuracy: 0.9869 - val_loss: 0.2283 - val_accuracy: 0.9349
Confusion matrix: 
 [[553  20]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.488 0.512]]
Validation f1: 51.22
Validation accuracy: 93.49
Validation recall: 51.22
Validation precision: 51.22
Validation AUC: 0.5479671732461859
Validation class accuracies: [0.9650959860383944, 0.5121951219512195]
Saving model...
Epoch 10/65
167/167 - 55s - loss: 0.0213 - accuracy: 0.9932 - val_loss: 0.3752 - val_accuracy: 0.8550
Confusion matrix: 
 [[502  71]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.439 0.561]]
Validation f1: 34.07
Validation accuracy: 85.50
Validation recall: 56.10
Validation precision: 24.47
Validation AUC: 0.44266308214890265
Validation class accuracies: [0.8760907504363001, 0.5609756097560976]
The validation tracker metric at 0.5121951219512195 hasn't increased by 0 in 1 epochs
Epoch 11/65
167/167 - 53s - loss: 0.0088 - accuracy: 0.9989 - val_loss: 0.2617 - val_accuracy: 0.9218
Confusion matrix: 
 [[546  27]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.512 0.488]]
Validation f1: 45.45
Validation accuracy: 92.18
Validation recall: 48.78
Validation precision: 42.55
Validation AUC: 0.5190967286991596
Validation class accuracies: [0.9528795811518325, 0.4878048780487805]
The validation tracker metric at 0.5121951219512195 hasn't increased by 0 in 2 epochs
Epoch 12/65
167/167 - 53s - loss: 0.0089 - accuracy: 0.9985 - val_loss: 0.2183 - val_accuracy: 0.9300
Confusion matrix: 
 [[555  18]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.61  0.39 ]]
Validation f1: 42.67
Validation accuracy: 93.00
Validation recall: 39.02
Validation precision: 47.06
Validation AUC: 0.5095657955918519
Validation class accuracies: [0.9685863874345549, 0.3902439024390244]
The validation tracker metric at 0.5121951219512195 hasn't increased by 0 in 3 epochs
Epoch 13/65
167/167 - 55s - loss: 0.0073 - accuracy: 0.9989 - val_loss: 0.3491 - val_accuracy: 0.9072
Confusion matrix: 
 [[532  41]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.39  0.61 ]]
Validation f1: 46.73
Validation accuracy: 90.72
Validation recall: 60.98
Validation precision: 37.88
Validation AUC: 0.4886001122859937
Validation class accuracies: [0.9284467713787086, 0.6097560975609756]
The validation tracker metric at 0.5121951219512195 hasn't increased by 0 in 4 epochs
Epoch 14/65
167/167 - 53s - loss: 0.0066 - accuracy: 0.9996 - val_loss: 0.2949 - val_accuracy: 0.9332
Confusion matrix: 
 [[551  22]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.463 0.537]]
Validation f1: 51.76
Validation accuracy: 93.32
Validation recall: 53.66
Validation precision: 50.00
Validation AUC: 0.5030961762836524
Validation class accuracies: [0.9616055846422339, 0.5365853658536586]
Saving model...
Epoch 15/65
167/167 - 56s - loss: 0.0045 - accuracy: 1.0000 - val_loss: 0.3793 - val_accuracy: 0.9169
Confusion matrix: 
 [[539  34]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.48
Validation accuracy: 91.69
Validation recall: 58.54
Validation precision: 41.38
Validation AUC: 0.47208929826832613
Validation class accuracies: [0.9406631762652705, 0.5853658536585366]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 1 epochs
Epoch 16/65
167/167 - 54s - loss: 0.0053 - accuracy: 0.9989 - val_loss: 0.2815 - val_accuracy: 0.9267
Confusion matrix: 
 [[551  22]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.561 0.439]]
Validation f1: 44.44
Validation accuracy: 92.67
Validation recall: 43.90
Validation precision: 45.00
Validation AUC: 0.4410932619916694
Validation class accuracies: [0.9616055846422339, 0.43902439024390244]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 2 epochs
Epoch 17/65
167/167 - 57s - loss: 0.0038 - accuracy: 0.9996 - val_loss: 0.2709 - val_accuracy: 0.9283
Confusion matrix: 
 [[553  20]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.585 0.415]]
Validation f1: 43.59
Validation accuracy: 92.83
Validation recall: 41.46
Validation precision: 45.95
Validation AUC: 0.48968216104897744
Validation class accuracies: [0.9650959860383944, 0.4146341463414634]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 3 epochs
Epoch 18/65
167/167 - 54s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.2732 - val_accuracy: 0.9332
Confusion matrix: 
 [[558  15]
 [ 26  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.634 0.366]]
Validation f1: 42.25
Validation accuracy: 93.32
Validation recall: 36.59
Validation precision: 50.00
Validation AUC: 0.4632585752187892
Validation class accuracies: [0.9738219895287958, 0.36585365853658536]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 4 epochs
Epoch 19/65
167/167 - 57s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.3082 - val_accuracy: 0.9300
Confusion matrix: 
 [[554  19]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.585 0.415]]
Validation f1: 44.16
Validation accuracy: 93.00
Validation recall: 41.46
Validation precision: 47.22
Validation AUC: 0.4503384518294181
Validation class accuracies: [0.9668411867364747, 0.4146341463414634]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 5 epochs
Epoch 20/65
167/167 - 53s - loss: 0.0095 - accuracy: 0.9977 - val_loss: 0.7651 - val_accuracy: 0.8485
Confusion matrix: 
 [[492  81]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.293 0.707]]
Validation f1: 38.41
Validation accuracy: 84.85
Validation recall: 70.73
Validation precision: 26.36
Validation AUC: 0.466417603208982
Validation class accuracies: [0.8586387434554974, 0.7073170731707317]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 21/65
167/167 - 56s - loss: 0.0035 - accuracy: 0.9992 - val_loss: 0.2866 - val_accuracy: 0.9300
Confusion matrix: 
 [[554  19]
 [ 24  17]]
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.585 0.415]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.16
Validation accuracy: 93.00
Validation recall: 41.46
Validation precision: 47.22
Validation AUC: 0.492999403028473
Validation class accuracies: [0.9668411867364747, 0.4146341463414634]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 7 epochs
Epoch 22/65
167/167 - 53s - loss: 0.0022 - accuracy: 0.9996 - val_loss: 0.2837 - val_accuracy: 0.9300
Confusion matrix: 
 [[553  20]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.561 0.439]]
Validation f1: 45.57
Validation accuracy: 93.00
Validation recall: 43.90
Validation precision: 47.37
Validation AUC: 0.489145003411817
Validation class accuracies: [0.9650959860383944, 0.43902439024390244]
The validation tracker metric at 0.5176470588235295 hasn't increased by 0 in 8 epochs
Epoch 23/65
167/167 - 56s - loss: 0.0045 - accuracy: 0.9996 - val_loss: 0.3400 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.5564648308910751
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
Saving model...
Epoch 24/65
167/167 - 53s - loss: 0.0025 - accuracy: 1.0000 - val_loss: 0.3536 - val_accuracy: 0.9332
Confusion matrix: 
 [[550  23]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 52.87
Validation accuracy: 93.32
Validation recall: 56.10
Validation precision: 50.00
Validation AUC: 0.4915298360410609
Validation class accuracies: [0.9598603839441536, 0.5609756097560976]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 1 epochs
Epoch 25/65
167/167 - 56s - loss: 0.0019 - accuracy: 1.0000 - val_loss: 0.3012 - val_accuracy: 0.9316
Confusion matrix: 
 [[550  23]
 [ 19  22]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.463 0.537]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.16
Validation accuracy: 93.16
Validation recall: 53.66
Validation precision: 48.89
Validation AUC: 0.5207361086624208
Validation class accuracies: [0.9598603839441536, 0.5365853658536586]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 2 epochs
Epoch 26/65
167/167 - 54s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.2894 - val_accuracy: 0.9316
Confusion matrix: 
 [[554  19]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.561 0.439]]
Validation f1: 46.15
Validation accuracy: 93.16
Validation recall: 43.90
Validation precision: 48.65
Validation AUC: 0.509529524628308
Validation class accuracies: [0.9668411867364747, 0.43902439024390244]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 3 epochs
Epoch 27/65
167/167 - 56s - loss: 0.0020 - accuracy: 1.0000 - val_loss: 0.3281 - val_accuracy: 0.9300
Confusion matrix: 
 [[548  25]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 51.69
Validation accuracy: 93.00
Validation recall: 56.10
Validation precision: 47.92
Validation AUC: 0.5119475840945399
Validation class accuracies: [0.956369982547993, 0.5609756097560976]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 4 epochs
Epoch 28/65
167/167 - 54s - loss: 0.0080 - accuracy: 0.9985 - val_loss: 0.3303 - val_accuracy: 0.9283
Confusion matrix: 
 [[548  25]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.463 0.537]]
Validation f1: 50.00
Validation accuracy: 92.83
Validation recall: 53.66
Validation precision: 46.81
Validation AUC: 0.4981103726152987
Validation class accuracies: [0.956369982547993, 0.5365853658536586]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 5 epochs
Epoch 29/65
167/167 - 55s - loss: 0.0037 - accuracy: 0.9996 - val_loss: 0.3465 - val_accuracy: 0.9300
Confusion matrix: 
 [[553  20]
 [ 23  18]]
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.561 0.439]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.57
Validation accuracy: 93.00
Validation recall: 43.90
Validation precision: 47.37
Validation AUC: 0.44527510752684085
Validation class accuracies: [0.9650959860383944, 0.43902439024390244]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 30/65
167/167 - 54s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3413 - val_accuracy: 0.9283
Confusion matrix: 
 [[550  23]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.512 0.488]]
Validation f1: 47.62
Validation accuracy: 92.83
Validation recall: 48.78
Validation precision: 46.51
Validation AUC: 0.4670055246858364
Validation class accuracies: [0.9598603839441536, 0.4878048780487805]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 7 epochs
Epoch 31/65
167/167 - 55s - loss: 0.0017 - accuracy: 0.9996 - val_loss: 0.3417 - val_accuracy: 0.9300
Confusion matrix: 
 [[550  23]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.488 0.512]]
Validation f1: 49.41
Validation accuracy: 93.00
Validation recall: 51.22
Validation precision: 47.73
Validation AUC: 0.4574315610977265
Validation class accuracies: [0.9598603839441536, 0.5121951219512195]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 8 epochs
Epoch 32/65
167/167 - 54s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3213 - val_accuracy: 0.9267
Confusion matrix: 
 [[552  21]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.585 0.415]]
Validation f1: 43.04
Validation accuracy: 92.67
Validation recall: 41.46
Validation precision: 44.74
Validation AUC: 0.4790826071886679
Validation class accuracies: [0.9633507853403142, 0.4146341463414634]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 9 epochs
Epoch 33/65
167/167 - 54s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3201 - val_accuracy: 0.9251
Confusion matrix: 
 [[551  22]
 [ 24  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.585 0.415]]
Validation f1: 42.50
Validation accuracy: 92.51
Validation recall: 41.46
Validation precision: 43.59
Validation AUC: 0.48303377095973205
Validation class accuracies: [0.9616055846422339, 0.4146341463414634]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 10 epochs
Epoch 34/65
167/167 - 55s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.3333 - val_accuracy: 0.9267
Confusion matrix: 
 [[550  23]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.537 0.463]]
Validation f1: 45.78
Validation accuracy: 92.67
Validation recall: 46.34
Validation precision: 45.24
Validation AUC: 0.48831094067284575
Validation class accuracies: [0.9598603839441536, 0.4634146341463415]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 11 epochs
Epoch 35/65
167/167 - 54s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3414 - val_accuracy: 0.9251
Confusion matrix: 
 [[547  26]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.488 0.512]]
Validation f1: 47.73
Validation accuracy: 92.51
Validation recall: 51.22
Validation precision: 44.68
Validation AUC: 0.5084786859029248
Validation class accuracies: [0.9546247818499127, 0.5121951219512195]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 36/65
167/167 - 55s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3093 - val_accuracy: 0.9283
Confusion matrix: 
 [[551  22]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.537 0.463]]
Validation f1: 46.34
Validation accuracy: 92.83
Validation recall: 46.34
Validation precision: 46.34
Validation AUC: 0.5098789384355997
Validation class accuracies: [0.9616055846422339, 0.4634146341463415]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 13 epochs
Epoch 37/65
167/167 - 53s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.3308 - val_accuracy: 0.9283
Confusion matrix: 
 [[551  22]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.537 0.463]]
Validation f1: 46.34
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.83
Validation recall: 46.34
Validation precision: 46.34
Validation AUC: 0.4969649335494035
Validation class accuracies: [0.9616055846422339, 0.4634146341463415]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 14 epochs
Epoch 38/65
167/167 - 57s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3153 - val_accuracy: 0.9283
Confusion matrix: 
 [[552  21]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.561 0.439]]
Validation f1: 45.00
Validation accuracy: 92.83
Validation recall: 43.90
Validation precision: 46.15
Validation AUC: 0.5022689492756699
Validation class accuracies: [0.9633507853403142, 0.43902439024390244]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 15 epochs
Epoch 39/65
167/167 - 54s - loss: 0.0011 - accuracy: 1.0000 - val_loss: 0.3086 - val_accuracy: 0.9283
Confusion matrix: 
 [[552  21]
 [ 23  18]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.561 0.439]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.00
Validation accuracy: 92.83
Validation recall: 43.90
Validation precision: 46.15
Validation AUC: 0.5082243272481864
Validation class accuracies: [0.9633507853403142, 0.43902439024390244]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 16 epochs
Epoch 40/65
167/167 - 56s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3095 - val_accuracy: 0.9267
Confusion matrix: 
 [[550  23]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.78
Validation accuracy: 92.67
Validation recall: 46.34
Validation precision: 45.24
Validation AUC: 0.5164939752018718
Validation class accuracies: [0.9598603839441536, 0.4634146341463415]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 17 epochs
Epoch 41/65
167/167 - 54s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3186 - val_accuracy: 0.9267
Confusion matrix: 
 [[550  23]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.78
Validation accuracy: 92.67
Validation recall: 46.34
Validation precision: 45.24
Validation AUC: 0.5145652688825748
Validation class accuracies: [0.9598603839441536, 0.4634146341463415]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 42/65
167/167 - 57s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3115 - val_accuracy: 0.9332
Confusion matrix: 
 [[554  19]
 [ 22  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.537 0.463]]
Validation f1: 48.10
Validation accuracy: 93.32
Validation recall: 46.34
Validation precision: 50.00
Validation AUC: 0.5063623996151946
Validation class accuracies: [0.9668411867364747, 0.4634146341463415]
The validation tracker metric at 0.5436893203883495 hasn't increased by 0 in 19 epochs
Epoch 43/65
167/167 - 54s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.3225 - val_accuracy: 0.9267
Confusion matrix: 
 [[550  23]
 [ 22  19]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.537 0.463]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.78
Validation accuracy: 92.67
Validation recall: 46.34
Validation precision: 45.24
Validation AUC: 0.5067496254208778
Validation class accuracies: [0.9598603839441536, 0.4634146341463415]

The metrics for job 1 with the best target metric are: 
Best cm: [[539  34]
 [ 13  28]]
Best normalized cm: [[0.941 0.059]
 [0.317 0.683]]
Best f1: 0.54
Best accuracy: 0.92
Best recall: 0.68
Best precision: 0.45
Best AUC: 0.56
Best class accuracies: [0.9406631762652705, 0.6829268292682927]
Best epoch: 23
The number of epochs since last 1% equals the patience
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_207_2b4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[2.949e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_218_1b1_Pl_sc_Meditron_6_label_0_pred_0.png, [[1.407e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_222_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[4.59e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_222_1b1_Ar_sc_Meditron_0_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[3.409e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_226_1b1_Al_sc_Meditron_1_label_1_pred_0.png, [[5.177e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_1.png, [[0.995]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_213_1p5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_211_1p3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[7.052e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_0.png, [[0.407]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_205_4b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_203_2p3_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.574e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_222_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[2.437e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_204_2b5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_205_3b4_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.409e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[0.051]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_207_2b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[2.91e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[5.744e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_213_1p2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_221_2b2_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_221_2b1_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.066]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_218_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[5.7e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_218_1p1_Ar_sc_Litt3200_2_label_0_pred_0.png, [[0.034]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_211_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.028e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_213_1p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_223_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_207_2b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[4.931e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_3_label_1_pred_1.png, [[0.982]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_219_2b2_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_204_7p5_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[1.48e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_222_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_221_2b3_Lr_mc_LittC2SE_2_label_0_pred_0.png, [[0.084]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_207_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/jordan_EP36_pneumonia,Crep,P R M,36,F_5_label_1_pred_0.png, [[0.196]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_205_2b3_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/1/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[1.689e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 27336
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_051731-2qif9hhk/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_051731-2qif9hhk/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.92671
wandb:             _runtime 2780
wandb:           _timestamp 1624687431
wandb:                _step 321
wandb:           train_loss 0.0017
wandb:             val_loss 0.32251
wandb:           val_recall 0.46341
wandb:        val_precision 0.45238
wandb:               val_f1 0.45783
wandb:              val_auc 0.50675
wandb:                   lr 6e-05
wandb:          best_val_f1 0.54369
wandb:    best_val_accuracy 0.92345
wandb:   best_val_precision 0.45161
wandb:      best_val_recall 0.68293
wandb:             best_auc 0.55646
wandb:           best_epoch 23
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇▇██████████████████████████████████
wandb:     val_accuracy ██▁▆▇████▇████████▇█████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇██
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇██
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▅▃▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▆▅█▄▃▂▁▂▁▃▂▁▃▃▂▂▂▂█▂▂▃▃▂▂▂▃▃▃▂▂▂▃▂▂▂▂▂▂▂
wandb:       val_recall ▁▁█▆▆▆▄▅▅▆▅▄▆▆▅▅▄▅▇▅▅▇▆▆▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:    val_precision ▁▁▂▄▅▇▇▇█▄▇▇▆▇▇▇█▇▅▇▇▇████▇▇█▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▁▃▅▆▇▆▇█▅▇▆▇▇▇▇▆▇▆▇▇███▇█▇▇▇▇▆▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▁▃▄▁▄▇▆▇█▆▇▇▇▇▆▇▆▆▆▇▇█▇▇▇▇▆▆▆▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr ███████████████████▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_051731-2qif9hhk

-----------------------
Changing augmentation to v48
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v48'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2666
-----------------------
Number of train recordings: 2666 with pneumonia: 316 and non-pneumonia: 2350
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 64, 1250, 1)]                       0                
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                               (None, 64, 1250, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_10 (MixDepthGroupC (None, 64, 1250, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 32, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 32, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                               (None, 32, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_11 (MixDepthGroupC (None, 32, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 16, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 16, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                               (None, 16, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_12 (MixDepthGroupC (None, 16, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 8, 157, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 8, 157, 32)                          128              
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                               (None, 8, 157, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_13 (MixDepthGroupC (None, 8, 157, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 4, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 4, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                               (None, 4, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_14 (MixDepthGroupC (None, 4, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 2, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 2, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
167/167 - 54s - loss: 0.4954 - accuracy: 0.6699 - val_loss: 0.5800 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09885978944244277
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
167/167 - 55s - loss: 0.2384 - accuracy: 0.8785 - val_loss: 1.1312 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.05886011289931479
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 3/65
167/167 - 54s - loss: 0.1652 - accuracy: 0.9254 - val_loss: 1.6581 - val_accuracy: 0.0717
Confusion matrix: 
 [[  3 570]
 [  0  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.005 0.995]
 [0.    1.   ]]
Validation f1: 12.58
Validation accuracy: 7.17
Validation recall: 100.00
Validation precision: 6.71
Validation AUC: 0.0735691517568062
Validation class accuracies: [0.005235602094240838, 1.0]
Saving model...
Epoch 4/65
167/167 - 54s - loss: 0.1187 - accuracy: 0.9482 - val_loss: 1.3344 - val_accuracy: 0.3795
Confusion matrix: 
 [[200 373]
 [  8  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.349 0.651]
 [0.195 0.805]]
Validation f1: 14.77
Validation accuracy: 37.95
Validation recall: 80.49
Validation precision: 8.13
Validation AUC: 0.09817503263036234
Validation class accuracies: [0.34904013961605584, 0.8048780487804879]
Saving model...
Epoch 5/65
167/167 - 55s - loss: 0.0895 - accuracy: 0.9591 - val_loss: 0.2554 - val_accuracy: 0.9088
Confusion matrix: 
 [[548  25]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.756 0.244]]
Validation f1: 26.32
Validation accuracy: 90.88
Validation recall: 24.39
Validation precision: 28.57
Validation AUC: 0.30845188485612435
Validation class accuracies: [0.956369982547993, 0.24390243902439024]
Saving model...
Epoch 6/65
167/167 - 54s - loss: 0.0618 - accuracy: 0.9730 - val_loss: 0.8140 - val_accuracy: 0.7117
Confusion matrix: 
 [[409 164]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.714 0.286]
 [0.317 0.683]]
Validation f1: 24.03
Validation accuracy: 71.17
Validation recall: 68.29
Validation precision: 14.58
Validation AUC: 0.16895685865412463
Validation class accuracies: [0.7137870855148342, 0.6829268292682927]
The validation tracker metric at 0.2631578947368421 hasn't increased by 0 in 1 epochs
Epoch 7/65
167/167 - 55s - loss: 0.0645 - accuracy: 0.9756 - val_loss: 0.2519 - val_accuracy: 0.9137
Confusion matrix: 
 [[549  24]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.707 0.293]]
Validation f1: 31.17
Validation accuracy: 91.37
Validation recall: 29.27
Validation precision: 33.33
Validation AUC: 0.30314680052149634
Validation class accuracies: [0.9581151832460733, 0.2926829268292683]
Saving model...
Epoch 8/65
167/167 - 54s - loss: 0.0275 - accuracy: 0.9917 - val_loss: 0.2280 - val_accuracy: 0.9414
Confusion matrix: 
 [[566   7]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.707 0.293]]
Validation f1: 40.00
Validation accuracy: 94.14
Validation recall: 29.27
Validation precision: 63.16
Validation AUC: 0.4242479604377226
Validation class accuracies: [0.987783595113438, 0.2926829268292683]
Saving model...
Epoch 9/65
167/167 - 57s - loss: 0.0157 - accuracy: 0.9951 - val_loss: 0.2674 - val_accuracy: 0.9397
Confusion matrix: 
 [[570   3]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.829 0.171]]
Validation f1: 27.45
Validation accuracy: 93.97
Validation recall: 17.07
Validation precision: 70.00
Validation AUC: 0.4012604422927965
Validation class accuracies: [0.9947643979057592, 0.17073170731707318]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 1 epochs
Epoch 10/65
167/167 - 53s - loss: 0.0205 - accuracy: 0.9940 - val_loss: 0.2426 - val_accuracy: 0.9349
Confusion matrix: 
 [[562  11]
 [ 29  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.707 0.293]]
Validation f1: 37.50
Validation accuracy: 93.49
Validation recall: 29.27
Validation precision: 52.17
Validation AUC: 0.4377411667931861
Validation class accuracies: [0.9808027923211169, 0.2926829268292683]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 2 epochs
Epoch 11/65
167/167 - 56s - loss: 0.0109 - accuracy: 0.9981 - val_loss: 0.2992 - val_accuracy: 0.9218
Confusion matrix: 
 [[550  23]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.61 0.39]]
Validation f1: 40.00
Validation accuracy: 92.18
Validation recall: 39.02
Validation precision: 41.03
Validation AUC: 0.3706577520356062
Validation class accuracies: [0.9598603839441536, 0.3902439024390244]
Saving model...
Epoch 12/65
167/167 - 54s - loss: 0.0089 - accuracy: 0.9966 - val_loss: 0.3106 - val_accuracy: 0.9332
Confusion matrix: 
 [[571   2]
 [ 39   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.951 0.049]]
Validation f1: 8.89
Validation accuracy: 93.32
Validation recall: 4.88
Validation precision: 50.00
Validation AUC: 0.31609771427352135
Validation class accuracies: [0.9965095986038395, 0.04878048780487805]
The validation tracker metric at 0.4 hasn't increased by 0 in 1 epochs
Epoch 13/65
167/167 - 57s - loss: 0.0151 - accuracy: 0.9981 - val_loss: 0.6709 - val_accuracy: 0.9169
Confusion matrix: 
 [[563  10]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 91.69
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.08798159235159597
Validation class accuracies: [0.9825479930191972, 0.0]
The validation tracker metric at 0.4 hasn't increased by 0 in 2 epochs
Epoch 14/65
167/167 - 54s - loss: 0.0216 - accuracy: 0.9921 - val_loss: 0.3382 - val_accuracy: 0.8844
Confusion matrix: 
 [[525  48]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.561 0.439]]
Validation f1: 33.64
Validation accuracy: 88.44
Validation recall: 43.90
Validation precision: 27.27
Validation AUC: 0.35184666926652297
Validation class accuracies: [0.9162303664921466, 0.43902439024390244]
The validation tracker metric at 0.4 hasn't increased by 0 in 3 epochs
Epoch 15/65
167/167 - 56s - loss: 0.0093 - accuracy: 0.9985 - val_loss: 0.2867 - val_accuracy: 0.9316
Confusion matrix: 
 [[565   8]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.829 0.171]]
Validation f1: 25.00
Validation accuracy: 93.16
Validation recall: 17.07
Validation precision: 46.67
Validation AUC: 0.3719837852312203
Validation class accuracies: [0.9860383944153578, 0.17073170731707318]
The validation tracker metric at 0.4 hasn't increased by 0 in 4 epochs
Epoch 16/65
167/167 - 54s - loss: 0.0045 - accuracy: 1.0000 - val_loss: 0.2886 - val_accuracy: 0.9300
Confusion matrix: 
 [[562  11]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.78  0.22 ]]
Validation f1: 29.51
Validation accuracy: 93.00
Validation recall: 21.95
Validation precision: 45.00
Validation AUC: 0.3461327087368104
Validation class accuracies: [0.9808027923211169, 0.21951219512195122]
The validation tracker metric at 0.4 hasn't increased by 0 in 5 epochs
Epoch 17/65
167/167 - 56s - loss: 0.0043 - accuracy: 0.9992 - val_loss: 0.2826 - val_accuracy: 0.9332
Confusion matrix: 
 [[564   9]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.78  0.22 ]]
Validation f1: 30.51
Validation accuracy: 93.32
Validation recall: 21.95
Validation precision: 50.00
Validation AUC: 0.3874209851413258
Validation class accuracies: [0.9842931937172775, 0.21951219512195122]
The validation tracker metric at 0.4 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 18/65
167/167 - 53s - loss: 0.0040 - accuracy: 1.0000 - val_loss: 0.3147 - val_accuracy: 0.9251
Confusion matrix: 
 [[552  21]
 [ 25  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.61  0.39 ]]
Validation f1: 41.03
Validation accuracy: 92.51
Validation recall: 39.02
Validation precision: 43.24
Validation AUC: 0.4236420549511372
Validation class accuracies: [0.9633507853403142, 0.3902439024390244]
Saving model...
Epoch 19/65
167/167 - 56s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.3023 - val_accuracy: 0.9316
Confusion matrix: 
 [[563  10]
 [ 32   9]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.78  0.22 ]]
Validation f1: 30.00
Validation accuracy: 93.16
Validation recall: 21.95
Validation precision: 47.37
Validation AUC: 0.381588697187048
Validation class accuracies: [0.9825479930191972, 0.21951219512195122]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 1 epochs
Epoch 20/65
167/167 - 54s - loss: 0.0029 - accuracy: 0.9996 - val_loss: 0.2924 - val_accuracy: 0.9316
Confusion matrix: 
 [[564   9]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.805 0.195]]
Validation f1: 27.59
Validation accuracy: 93.16
Validation recall: 19.51
Validation precision: 47.06
Validation AUC: 0.3539541785868135
Validation class accuracies: [0.9842931937172775, 0.1951219512195122]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 2 epochs
Epoch 21/65
167/167 - 56s - loss: 0.0026 - accuracy: 1.0000 - val_loss: 0.2903 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.39497577504277953
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 3 epochs
Epoch 22/65
167/167 - 53s - loss: 0.0051 - accuracy: 0.9989 - val_loss: 0.2986 - val_accuracy: 0.9300
Confusion matrix: 
 [[562  11]
 [ 32   9]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.78  0.22 ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 29.51
Validation accuracy: 93.00
Validation recall: 21.95
Validation precision: 45.00
Validation AUC: 0.36247803937314504
Validation class accuracies: [0.9808027923211169, 0.21951219512195122]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 4 epochs
Epoch 23/65
167/167 - 55s - loss: 0.0062 - accuracy: 0.9989 - val_loss: 0.3479 - val_accuracy: 0.9430
Confusion matrix: 
 [[571   2]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.997 0.003]
 [0.805 0.195]]
Validation f1: 31.37
Validation accuracy: 94.30
Validation recall: 19.51
Validation precision: 80.00
Validation AUC: 0.4332980701949649
Validation class accuracies: [0.9965095986038395, 0.1951219512195122]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 5 epochs
Epoch 24/65
167/167 - 53s - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.3206 - val_accuracy: 0.9414
Confusion matrix: 
 [[570   3]
 [ 33   8]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.805 0.195]]
Validation f1: 30.77
Validation accuracy: 94.14
Validation recall: 19.51
Validation precision: 72.73
Validation AUC: 0.37782045863287084
Validation class accuracies: [0.9947643979057592, 0.1951219512195122]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
167/167 - 54s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.3000 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.39806190962996435
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 7 epochs
Epoch 26/65
167/167 - 54s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.2968 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
Validation f1: 34.92
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.40811130936045975
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 8 epochs
Epoch 27/65
167/167 - 54s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.3066 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.4030197610889916
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 9 epochs
Epoch 28/65
167/167 - 56s - loss: 0.0020 - accuracy: 1.0000 - val_loss: 0.3093 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.40626715966304383
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 10 epochs
Epoch 29/65
167/167 - 54s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3056 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.4061923633287145
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 11 epochs
Epoch 30/65
167/167 - 57s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3051 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
Validation f1: 34.92
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.40447515286077157
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 31/65
167/167 - 55s - loss: 0.0023 - accuracy: 1.0000 - val_loss: 0.3080 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.39894827363397234
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 13 epochs
Epoch 32/65
167/167 - 58s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.3034 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.3908347800760594
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 14 epochs
Epoch 33/65
167/167 - 54s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.3054 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.4102314654045869
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 15 epochs
Epoch 34/65
167/167 - 58s - loss: 0.0018 - accuracy: 0.9996 - val_loss: 0.3079 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.3990433225725572
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.4102564102564103 hasn't increased by 0 in 16 epochs
Epoch 35/65
167/167 - 54s - loss: 0.0045 - accuracy: 1.0000 - val_loss: 0.2960 - val_accuracy: 0.9349
Confusion matrix: 
 [[560  13]
 [ 27  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.659 0.341]]
Validation f1: 41.18
Validation accuracy: 93.49
Validation recall: 34.15
Validation precision: 51.85
Validation AUC: 0.44020386599837463
Validation class accuracies: [0.9773123909249564, 0.34146341463414637]
Saving model...
Epoch 36/65
167/167 - 57s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.3018 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.4395559689334378
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 1 epochs
Epoch 37/65
167/167 - 54s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3030 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.4363516649982118
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 2 epochs
Epoch 38/65
167/167 - 57s - loss: 0.0036 - accuracy: 1.0000 - val_loss: 0.2909 - val_accuracy: 0.9316
Confusion matrix: 
 [[561  12]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.732 0.268]]
Validation f1: 34.38
Validation accuracy: 93.16
Validation recall: 26.83
Validation precision: 47.83
Validation AUC: 0.4320410619555308
Validation class accuracies: [0.9790575916230366, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 3 epochs
Epoch 39/65
167/167 - 54s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.2943 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.42809933450912374
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 4 epochs
Epoch 40/65
167/167 - 58s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.2960 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.4202365457395049
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 5 epochs
Epoch 41/65
167/167 - 54s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.2953 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.4170074310425469
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 42/65
167/167 - 57s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.2998 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.4119671109041609
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 7 epochs
Epoch 43/65
167/167 - 54s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.3039 - val_accuracy: 0.9365
Confusion matrix: 
 [[564   9]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.07
Validation accuracy: 93.65
Validation recall: 26.83
Validation precision: 55.00
Validation AUC: 0.4120177729623543
Validation class accuracies: [0.9842931937172775, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 8 epochs
Epoch 44/65
167/167 - 58s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3049 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.4045127595419918
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 9 epochs
Epoch 45/65
167/167 - 55s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3062 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.4048505548359134
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 10 epochs
Epoch 46/65
167/167 - 57s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.3043 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.40300259496617014
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 11 epochs
Epoch 47/65
167/167 - 54s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3033 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.40525374481637416
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 3.125000148429535e-05
Epoch 48/65
167/167 - 56s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3070 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.48
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.4053877281926597
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 13 epochs
Epoch 49/65
167/167 - 55s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3042 - val_accuracy: 0.9349
Confusion matrix: 
 [[563  10]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.732 0.268]]
Validation f1: 35.48
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.49
Validation recall: 26.83
Validation precision: 52.38
Validation AUC: 0.404078521467387
Validation class accuracies: [0.9825479930191972, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 14 epochs
Epoch 50/65
167/167 - 56s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3052 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
Validation f1: 34.92
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.4033420749014368
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 15 epochs
Epoch 51/65
167/167 - 55s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.3085 - val_accuracy: 0.9316
Confusion matrix: 
 [[562  11]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.756 0.244]]
Validation f1: 32.26
Validation accuracy: 93.16
Validation recall: 24.39
Validation precision: 47.62
Validation AUC: 0.401526051710409
Validation class accuracies: [0.9808027923211169, 0.24390243902439024]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 16 epochs
Epoch 52/65
167/167 - 56s - loss: 0.0019 - accuracy: 1.0000 - val_loss: 0.3154 - val_accuracy: 0.9332
Confusion matrix: 
 [[563  10]
 [ 31  10]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.983 0.017]
 [0.756 0.244]]
Validation f1: 32.79
Validation accuracy: 93.32
Validation recall: 24.39
Validation precision: 50.00
Validation AUC: 0.39950401425545795
Validation class accuracies: [0.9825479930191972, 0.24390243902439024]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 17 epochs
Epoch 53/65
167/167 - 55s - loss: 0.0011 - accuracy: 1.0000 - val_loss: 0.3099 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.4021500233073071
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 54/65
167/167 - 55s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3101 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.402168620451655
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]
The validation tracker metric at 0.411764705882353 hasn't increased by 0 in 19 epochs
Epoch 55/65
167/167 - 56s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3093 - val_accuracy: 0.9332
Confusion matrix: 
 [[562  11]
 [ 30  11]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.732 0.268]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.92
Validation accuracy: 93.32
Validation recall: 26.83
Validation precision: 50.00
Validation AUC: 0.40330162103324596
Validation class accuracies: [0.9808027923211169, 0.2682926829268293]

The metrics for job 2 with the best target metric are: 
Best cm: [[560  13]
 [ 27  14]]
Best normalized cm: [[0.977 0.023]
 [0.659 0.341]]
Best f1: 0.41
Best accuracy: 0.93
Best recall: 0.34
Best precision: 0.52
Best AUC: 0.44
Best class accuracies: [0.9773123909249564, 0.34146341463414637]
Best epoch: 35
The number of epochs since last 1% equals the patience
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_226_1b1_Ll_sc_Meditron_2_label_1_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_207_2b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_211_2p4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_222_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_213_1p5_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_222_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_222_1b1_Lr_sc_Meditron_10_label_0_pred_0.png, [[7.927e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_204_7p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_211_2p3_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b2_Ar_mc_LittC2SE_3_label_0_pred_0.png, [[0.18]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Ar_sc_Meditron_6_label_0_pred_0.png, [[2.972e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Al_sc_Meditron_1_label_0_pred_0.png, [[4.336e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Pl_sc_Meditron_12_label_0_pred_0.png, [[9.154e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Ar_sc_Meditron_9_label_0_pred_0.png, [[2.108e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Ar_sc_Meditron_10_label_0_pred_0.png, [[0.039]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1p1_Ar_sc_Litt3200_4_label_0_pred_1.png, [[0.519]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_213_2p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_205_3b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.034e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[4.88e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_222_1b1_Lr_sc_Meditron_8_label_0_pred_0.png, [[5.222e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_205_2b3_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[6.703e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[4.977e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_222_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b3_Pr_mc_LittC2SE_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.016]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_207_2b2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[2.012e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_218_1b1_Ar_sc_Meditron_11_label_0_pred_0.png, [[0.304]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b1_Pl_mc_LittC2SE_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_213_1p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_211_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.026]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_210_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_204_2b5_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[8.933e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_221_2b1_Lr_mc_LittC2SE_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_219_2b1_Ar_mc_LittC2SE_2_label_1_pred_1.png, [[0.993]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_222_1b1_Ar_sc_Meditron_12_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_223_1b1_Lr_sc_Meditron_3_label_0_pred_0.png, [[7.78e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_219_2b3_Tc_mc_LittC2SE_3_label_1_pred_0.png, [[0.02]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/2/icbhi_217_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 5132
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_060427-28ue15m5/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_060427-28ue15m5/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.93322
wandb:             _runtime 3620
wandb:           _timestamp 1624691087
wandb:                _step 411
wandb:           train_loss 0.00128
wandb:             val_loss 0.30929
wandb:           val_recall 0.26829
wandb:        val_precision 0.5
wandb:               val_f1 0.34921
wandb:              val_auc 0.4033
wandb:                   lr 2e-05
wandb:          best_val_f1 0.41176
wandb:    best_val_accuracy 0.93485
wandb:   best_val_precision 0.51852
wandb:      best_val_recall 0.34146
wandb:             best_auc 0.4402
wandb:           best_epoch 35
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇▇██████████████████████████████████
wandb:     val_accuracy █▁▁█▆███████████████████████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▃▅█▁▄▁▁▁▁▃▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_recall ▁██▃▆▃▂▃▁▁▄▃▃▃▂▃▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:    val_precision ▁▂▂▄▂▄▇▆▅▁▃▅▅▅▅▆█▇▅▅▆▅▆▅▆▆▆▅▅▅▆▆▆▆▆▆▅▅▅▅
wandb:           val_f1 ▁▃▃▅▅▆▆▇▃▁▇▆▆▆▆▇▆▆▇▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▂▁▁▆▃▅▇█▆▂▆▆▇▇▆▇█▇▇▇▇▇▇▇▇█████▇▇▇▇▇▇▇▇▇▇
wandb:               lr █████████████▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_060427-28ue15m5

-----------------------
Changing augmentation to v42, v43
Audio Augmentation Parameters: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2774
-----------------------
Number of train recordings: 2774 with pneumonia: 474 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2874
-----------------------
Number of train recordings: 2874 with pneumonia: 474 and non-pneumonia: 2400
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_4 (InputLayer)                             [(None, 64, 1250, 1)]                       0                
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                               (None, 64, 1250, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_15 (MixDepthGroupC (None, 64, 1250, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePooling2D)          (None, 32, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormalization)      (None, 32, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                               (None, 32, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_16 (MixDepthGroupC (None, 32, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePooling2D)          (None, 16, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormalization)      (None, 16, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                               (None, 16, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_17 (MixDepthGroupC (None, 16, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePooling2D)          (None, 8, 157, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormalization)      (None, 8, 157, 32)                          128              
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                               (None, 8, 157, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_18 (MixDepthGroupC (None, 8, 157, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePooling2D)          (None, 4, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormalization)      (None, 4, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                               (None, 4, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_19 (MixDepthGroupC (None, 4, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePooling2D)          (None, 2, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormalization)      (None, 2, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_3 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
180/180 - 61s - loss: 0.6832 - accuracy: 0.6221 - val_loss: 0.9334 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.06843526412531209
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
180/180 - 59s - loss: 0.3773 - accuracy: 0.7582 - val_loss: 1.0151 - val_accuracy: 0.0668
Confusion matrix: 
 [[  0 573]
 [  0  41]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 12.52
Validation accuracy: 6.68
Validation recall: 100.00
Validation precision: 6.68
Validation AUC: 0.06151814903733156
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.1251908396946565 hasn't increased by 0 in 1 epochs
Epoch 3/65
180/180 - 62s - loss: 0.2653 - accuracy: 0.8490 - val_loss: 0.9204 - val_accuracy: 0.3844
Confusion matrix: 
 [[200 373]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.349 0.651]
 [0.122 0.878]]
Validation f1: 16.00
Validation accuracy: 38.44
Validation recall: 87.80
Validation precision: 8.80
Validation AUC: 0.08775763513538569
Validation class accuracies: [0.34904013961605584, 0.8780487804878049]
Saving model...
Epoch 4/65
180/180 - 59s - loss: 0.1490 - accuracy: 0.9200 - val_loss: 0.2637 - val_accuracy: 0.9202
Confusion matrix: 
 [[545  28]
 [ 21  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.512 0.488]]
Validation f1: 44.94
Validation accuracy: 92.02
Validation recall: 48.78
Validation precision: 41.67
Validation AUC: 0.29612421555749624
Validation class accuracies: [0.9511343804537522, 0.4878048780487805]
Saving model...
Epoch 5/65
180/180 - 58s - loss: 0.1006 - accuracy: 0.9530 - val_loss: 0.2843 - val_accuracy: 0.8990
Confusion matrix: 
 [[525  48]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.341 0.659]]
Validation f1: 46.55
Validation accuracy: 89.90
Validation recall: 65.85
Validation precision: 36.00
Validation AUC: 0.5313698216473052
Validation class accuracies: [0.9162303664921466, 0.6585365853658537]
Saving model...
Epoch 6/65
180/180 - 50s - loss: 0.1426 - accuracy: 0.9339 - val_loss: 0.2962 - val_accuracy: 0.9088
Confusion matrix: 
 [[532  41]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.366 0.634]]
Validation f1: 48.15
Validation accuracy: 90.88
Validation recall: 63.41
Validation precision: 38.81
Validation AUC: 0.5526789036130763
Validation class accuracies: [0.9284467713787086, 0.6341463414634146]
Saving model...
Epoch 7/65
180/180 - 50s - loss: 0.0771 - accuracy: 0.9666 - val_loss: 0.3153 - val_accuracy: 0.9007
Confusion matrix: 
 [[527  46]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.366 0.634]]
Validation f1: 46.02
Validation accuracy: 90.07
Validation recall: 63.41
Validation precision: 36.11
Validation AUC: 0.5632443349274525
Validation class accuracies: [0.9197207678883071, 0.6341463414634146]
The validation tracker metric at 0.4814814814814815 hasn't increased by 0 in 1 epochs
Epoch 8/65
180/180 - 48s - loss: 0.0526 - accuracy: 0.9791 - val_loss: 0.8446 - val_accuracy: 0.7264
Confusion matrix: 
 [[421 152]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.735 0.265]
 [0.39  0.61 ]]
Validation f1: 22.94
Validation accuracy: 72.64
Validation recall: 60.98
Validation precision: 14.12
Validation AUC: 0.509481860174278
Validation class accuracies: [0.7347294938917975, 0.6097560975609756]
The validation tracker metric at 0.4814814814814815 hasn't increased by 0 in 2 epochs
Epoch 9/65
180/180 - 48s - loss: 0.0468 - accuracy: 0.9826 - val_loss: 0.2792 - val_accuracy: 0.9153
Confusion matrix: 
 [[536  37]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.366 0.634]]
Validation f1: 50.00
Validation accuracy: 91.53
Validation recall: 63.41
Validation precision: 41.27
Validation AUC: 0.5122965546290067
Validation class accuracies: [0.9354275741710296, 0.6341463414634146]
Saving model...
Epoch 10/65
180/180 - 49s - loss: 0.0226 - accuracy: 0.9910 - val_loss: 0.2740 - val_accuracy: 0.9267
Confusion matrix: 
 [[542  31]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.341 0.659]]
Validation f1: 54.55
Validation accuracy: 92.67
Validation recall: 65.85
Validation precision: 46.55
Validation AUC: 0.5576176426763154
Validation class accuracies: [0.9458987783595113, 0.6585365853658537]
Saving model...
Epoch 11/65
180/180 - 49s - loss: 0.0184 - accuracy: 0.9951 - val_loss: 0.2594 - val_accuracy: 0.9349
Confusion matrix: 
 [[551  22]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.439 0.561]]
Validation f1: 53.49
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.49
Validation recall: 56.10
Validation precision: 51.11
Validation AUC: 0.595730459532089
Validation class accuracies: [0.9616055846422339, 0.5609756097560976]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 1 epochs
Epoch 12/65
180/180 - 49s - loss: 0.0178 - accuracy: 0.9930 - val_loss: 0.2825 - val_accuracy: 0.9300
Confusion matrix: 
 [[546  27]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.39  0.61 ]]
Validation f1: 53.76
Validation accuracy: 93.00
Validation recall: 60.98
Validation precision: 48.08
Validation AUC: 0.5609753128426677
Validation class accuracies: [0.9528795811518325, 0.6097560975609756]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 2 epochs
Epoch 13/65
180/180 - 49s - loss: 0.0169 - accuracy: 0.9937 - val_loss: 0.2671 - val_accuracy: 0.9397
Confusion matrix: 
 [[556  17]
 [ 20  21]]
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.488 0.512]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.16
Validation accuracy: 93.97
Validation recall: 51.22
Validation precision: 55.26
Validation AUC: 0.568689409476257
Validation class accuracies: [0.9703315881326352, 0.5121951219512195]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 3 epochs
Epoch 14/65
180/180 - 50s - loss: 0.0109 - accuracy: 0.9976 - val_loss: 0.2992 - val_accuracy: 0.9316
Confusion matrix: 
 [[548  25]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.415 0.585]]
Validation f1: 53.33
Validation accuracy: 93.16
Validation recall: 58.54
Validation precision: 48.98
Validation AUC: 0.5840230746399088
Validation class accuracies: [0.956369982547993, 0.5853658536585366]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 4 epochs
Epoch 15/65
180/180 - 49s - loss: 0.0125 - accuracy: 0.9965 - val_loss: 0.3141 - val_accuracy: 0.9202
Confusion matrix: 
 [[538  35]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.341 0.659]]
Validation f1: 52.43
Validation accuracy: 92.02
Validation recall: 65.85
Validation precision: 43.55
Validation AUC: 0.5736436031133331
Validation class accuracies: [0.9389179755671903, 0.6585365853658537]
The validation tracker metric at 0.5454545454545454 hasn't increased by 0 in 5 epochs
Epoch 16/65
180/180 - 49s - loss: 0.0099 - accuracy: 0.9972 - val_loss: 0.3056 - val_accuracy: 0.9349
Confusion matrix: 
 [[549  24]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.39  0.61 ]]
Validation f1: 55.56
Validation accuracy: 93.49
Validation recall: 60.98
Validation precision: 51.02
Validation AUC: 0.5844164498712188
Validation class accuracies: [0.9581151832460733, 0.6097560975609756]
Saving model...
Epoch 17/65
180/180 - 49s - loss: 0.0130 - accuracy: 0.9972 - val_loss: 0.3867 - val_accuracy: 0.9169
Confusion matrix: 
 [[540  33]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.439 0.561]]
Validation f1: 47.42
Validation accuracy: 91.69
Validation recall: 56.10
Validation precision: 41.07
Validation AUC: 0.597304724663492
Validation class accuracies: [0.9424083769633508, 0.5609756097560976]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 1 epochs
Epoch 18/65
180/180 - 49s - loss: 0.0207 - accuracy: 0.9920 - val_loss: 0.2795 - val_accuracy: 0.9251
Confusion matrix: 
 [[544  29]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.415 0.585]]
Validation f1: 51.06
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.51
Validation recall: 58.54
Validation precision: 45.28
Validation AUC: 0.5780520950799674
Validation class accuracies: [0.9493891797556719, 0.5853658536585366]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 2 epochs
Epoch 19/65
180/180 - 49s - loss: 0.0142 - accuracy: 0.9976 - val_loss: 0.5086 - val_accuracy: 0.8779
Confusion matrix: 
 [[510  63]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89  0.11 ]
 [0.293 0.707]]
Validation f1: 43.61
Validation accuracy: 87.79
Validation recall: 70.73
Validation precision: 31.52
Validation AUC: 0.5640807097018922
Validation class accuracies: [0.8900523560209425, 0.7073170731707317]
The validation tracker metric at 0.5555555555555556 hasn't increased by 0 in 3 epochs
Epoch 20/65
180/180 - 49s - loss: 0.0459 - accuracy: 0.9795 - val_loss: 0.2590 - val_accuracy: 0.9463
Confusion matrix: 
 [[558  15]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.439 0.561]]
Validation f1: 58.23
Validation accuracy: 94.63
Validation recall: 56.10
Validation precision: 60.53
Validation AUC: 0.6084594360770805
Validation class accuracies: [0.9738219895287958, 0.5609756097560976]
Saving model...
Epoch 21/65
180/180 - 49s - loss: 0.0441 - accuracy: 0.9878 - val_loss: 0.7887 - val_accuracy: 0.7834
Confusion matrix: 
 [[450 123]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.244 0.756]]
Validation f1: 31.79
Validation accuracy: 78.34
Validation recall: 75.61
Validation precision: 20.13
Validation AUC: 0.5325783026112776
Validation class accuracies: [0.7853403141361257, 0.7560975609756098]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 1 epochs
Epoch 22/65
180/180 - 48s - loss: 0.0168 - accuracy: 0.9941 - val_loss: 0.3719 - val_accuracy: 0.9267
Confusion matrix: 
 [[544  29]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.39  0.61 ]]
Validation f1: 52.63
Validation accuracy: 92.67
Validation recall: 60.98
Validation precision: 46.30
Validation AUC: 0.557606343628411
Validation class accuracies: [0.9493891797556719, 0.6097560975609756]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 2 epochs
Epoch 23/65
180/180 - 49s - loss: 0.0410 - accuracy: 0.9875 - val_loss: 0.4670 - val_accuracy: 0.8941
Confusion matrix: 
 [[524  49]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.39  0.61 ]]
Validation f1: 43.48
Validation accuracy: 89.41
Validation recall: 60.98
Validation precision: 33.78
Validation AUC: 0.4942033031809429
Validation class accuracies: [0.9144851657940664, 0.6097560975609756]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 3 epochs
Epoch 24/65
180/180 - 50s - loss: 0.0120 - accuracy: 0.9965 - val_loss: 0.4090 - val_accuracy: 0.8990
Confusion matrix: 
 [[524  49]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.317 0.683]]
Validation f1: 47.46
Validation accuracy: 89.90
Validation recall: 68.29
Validation precision: 36.36
Validation AUC: 0.541702089508797
Validation class accuracies: [0.9144851657940664, 0.6829268292682927]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 4 epochs
Epoch 25/65
180/180 - 50s - loss: 0.0069 - accuracy: 0.9990 - val_loss: 0.3162 - val_accuracy: 0.9235
Confusion matrix: 
 [[544  29]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.439 0.561]]
Validation f1: 49.46
Validation accuracy: 92.35
Validation recall: 56.10
Validation precision: 44.23
Validation AUC: 0.537419295118555
Validation class accuracies: [0.9493891797556719, 0.5609756097560976]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 5 epochs
Epoch 26/65
180/180 - 49s - loss: 0.0228 - accuracy: 0.9923 - val_loss: 0.3900 - val_accuracy: 0.9104
Confusion matrix: 
 [[535  38]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.415 0.585]]
Validation f1: 46.60
Validation accuracy: 91.04
Validation recall: 58.54
Validation precision: 38.71
Validation AUC: 0.5187317542542431
Validation class accuracies: [0.9336823734729494, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 27/65
180/180 - 50s - loss: 0.0081 - accuracy: 0.9979 - val_loss: 0.3650 - val_accuracy: 0.9072
Confusion matrix: 
 [[535  38]
 [ 19  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.463 0.537]]
Validation f1: 43.56
Validation accuracy: 90.72
Validation recall: 53.66
Validation precision: 36.67
Validation AUC: 0.5316114768598884
Validation class accuracies: [0.9336823734729494, 0.5365853658536586]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 7 epochs
Epoch 28/65
180/180 - 49s - loss: 0.0058 - accuracy: 0.9979 - val_loss: 0.3487 - val_accuracy: 0.9121
Confusion matrix: 
 [[537  36]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.439 0.561]]
Validation f1: 46.00
Validation accuracy: 91.21
Validation recall: 56.10
Validation precision: 38.98
Validation AUC: 0.5375713200903115
Validation class accuracies: [0.93717277486911, 0.5609756097560976]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 8 epochs
Epoch 29/65
180/180 - 49s - loss: 0.0128 - accuracy: 0.9986 - val_loss: 0.3998 - val_accuracy: 0.9088
Confusion matrix: 
 [[532  41]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.15
Validation accuracy: 90.88
Validation recall: 63.41
Validation precision: 38.81
Validation AUC: 0.5367993597204249
Validation class accuracies: [0.9284467713787086, 0.6341463414634146]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 9 epochs
Epoch 30/65
180/180 - 49s - loss: 0.0050 - accuracy: 0.9983 - val_loss: 0.3557 - val_accuracy: 0.9186
Confusion matrix: 
 [[541  32]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.439 0.561]]
Validation f1: 47.92
Validation accuracy: 91.86
Validation recall: 56.10
Validation precision: 41.82
Validation AUC: 0.5329385228568925
Validation class accuracies: [0.944153577661431, 0.5609756097560976]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 10 epochs
Epoch 31/65
180/180 - 49s - loss: 0.0044 - accuracy: 0.9986 - val_loss: 0.3489 - val_accuracy: 0.9267
Confusion matrix: 
 [[546  27]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.439 0.561]]
Validation f1: 50.55
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.67
Validation recall: 56.10
Validation precision: 46.00
Validation AUC: 0.5387419858883814
Validation class accuracies: [0.9528795811518325, 0.5609756097560976]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 11 epochs
Epoch 32/65
180/180 - 49s - loss: 0.0032 - accuracy: 0.9990 - val_loss: 0.3575 - val_accuracy: 0.9169
Confusion matrix: 
 [[540  33]
 [ 18  23]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.439 0.561]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 47.42
Validation accuracy: 91.69
Validation recall: 56.10
Validation precision: 41.07
Validation AUC: 0.537808358013977
Validation class accuracies: [0.9424083769633508, 0.5609756097560976]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 33/65
180/180 - 50s - loss: 0.0040 - accuracy: 0.9997 - val_loss: 0.3559 - val_accuracy: 0.9186
Confusion matrix: 
 [[540  33]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.415 0.585]]
Validation f1: 48.98
Validation accuracy: 91.86
Validation recall: 58.54
Validation precision: 42.11
Validation AUC: 0.5354410604682159
Validation class accuracies: [0.9424083769633508, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 13 epochs
Epoch 34/65
180/180 - 50s - loss: 0.0028 - accuracy: 0.9993 - val_loss: 0.3508 - val_accuracy: 0.9186
Confusion matrix: 
 [[540  33]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.98
Validation accuracy: 91.86
Validation recall: 58.54
Validation precision: 42.11
Validation AUC: 0.5382464893143821
Validation class accuracies: [0.9424083769633508, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 14 epochs
Epoch 35/65
180/180 - 49s - loss: 0.0072 - accuracy: 0.9993 - val_loss: 0.4206 - val_accuracy: 0.9088
Confusion matrix: 
 [[534  39]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.415 0.585]]
Validation f1: 46.15
Validation accuracy: 90.88
Validation recall: 58.54
Validation precision: 38.10
Validation AUC: 0.5180648638552836
Validation class accuracies: [0.9319371727748691, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 15 epochs
Epoch 36/65
180/180 - 49s - loss: 0.0043 - accuracy: 0.9990 - val_loss: 0.3579 - val_accuracy: 0.9202
Confusion matrix: 
 [[541  32]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.415 0.585]]
Validation f1: 49.48
Validation accuracy: 92.02
Validation recall: 58.54
Validation precision: 42.86
Validation AUC: 0.5264672379321693
Validation class accuracies: [0.944153577661431, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 16 epochs
Epoch 37/65
180/180 - 49s - loss: 0.0031 - accuracy: 0.9997 - val_loss: 0.3569 - val_accuracy: 0.9186
Confusion matrix: 
 [[540  33]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.98
Validation accuracy: 91.86
Validation recall: 58.54
Validation precision: 42.11
Validation AUC: 0.5271940428150921
Validation class accuracies: [0.9424083769633508, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 17 epochs
Epoch 38/65
180/180 - 49s - loss: 0.0030 - accuracy: 0.9997 - val_loss: 0.3551 - val_accuracy: 0.9202
Confusion matrix: 
 [[542  31]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.439 0.561]]
Validation f1: 48.42
Validation accuracy: 92.02
Validation recall: 56.10
Validation precision: 42.59
Validation AUC: 0.5304860679776574
Validation class accuracies: [0.9458987783595113, 0.5609756097560976]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 39/65
180/180 - 49s - loss: 0.0038 - accuracy: 1.0000 - val_loss: 0.3485 - val_accuracy: 0.9235
Confusion matrix: 
 [[543  30]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.415 0.585]]
Validation f1: 50.53
Validation accuracy: 92.35
Validation recall: 58.54
Validation precision: 44.44
Validation AUC: 0.5350714284215046
Validation class accuracies: [0.9476439790575916, 0.5853658536585366]
The validation tracker metric at 0.5822784810126583 hasn't increased by 0 in 19 epochs
Epoch 40/65
180/180 - 49s - loss: 0.0041 - accuracy: 0.9997 - val_loss: 0.3553 - val_accuracy: 0.9202
Confusion matrix: 
 [[541  32]
 [ 17  24]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.415 0.585]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.48
Validation accuracy: 92.02
Validation recall: 58.54
Validation precision: 42.86
Validation AUC: 0.5322259805488015
Validation class accuracies: [0.944153577661431, 0.5853658536585366]

The metrics for job 3 with the best target metric are: 
Best cm: [[558  15]
 [ 18  23]]
Best normalized cm: [[0.974 0.026]
 [0.439 0.561]]
Best f1: 0.58
Best accuracy: 0.95
Best recall: 0.56
Best precision: 0.61
Best AUC: 0.61
Best class accuracies: [0.9738219895287958, 0.5609756097560976]
Best epoch: 20
The number of epochs since last 1% equals the patience
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[1.707e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_205_4b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[5.59e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_221_2b1_Pl_mc_LittC2SE_0_label_0_pred_0.png, [[0.039]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_222_1b1_Pr_sc_Meditron_9_label_0_pred_0.png, [[8.607e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_219_2b1_Ar_mc_LittC2SE_0_label_1_pred_0.png, [[0.078]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_205_1b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[3.871e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_218_1b1_Ar_sc_Meditron_5_label_0_pred_0.png, [[5.377e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[6.499e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/jordan_EP36_pneumonia,Crep,P R M,36,F_4_label_1_pred_1.png, [[0.962]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_207_2b3_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_2p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_222_1b1_Lr_sc_Meditron_11_label_0_pred_0.png, [[9.623e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[6.484e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_218_1b1_Pr_sc_Meditron_11_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_218_1b1_Ar_sc_Meditron_13_label_0_pred_0.png, [[0.118]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.096]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_207_2b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_204_2b5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[7.66e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_224_1b1_Tc_sc_Meditron_0_label_0_pred_0.png, [[1.335e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[6.894e-07]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[4.146e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_205_1b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_207_2b4_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_222_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[2.701e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_1p5_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.095]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_223_1b1_Lr_sc_Meditron_4_label_0_pred_0.png, [[8.848e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.324]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_211_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[2.442e-08]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_205_1b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[2.798e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_1p2_Lr_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_204_7p5_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.007]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_2p2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_207_2b3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.868e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_207_2b4_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[8.123e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_203_2p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[4.624e-07]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_0.png, [[0.272]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_218_1b1_Al_sc_Meditron_9_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_205_1b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/3/icbhi_205_2b3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 16013
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_070522-1z7j0fm9/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_070522-1z7j0fm9/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99965
wandb:         val_accuracy 0.9202
wandb:             _runtime 2384
wandb:           _timestamp 1624693506
wandb:                _step 306
wandb:           train_loss 0.0041
wandb:             val_loss 0.35527
wandb:           val_recall 0.58537
wandb:        val_precision 0.42857
wandb:               val_f1 0.49485
wandb:              val_auc 0.53223
wandb:                   lr 0.00013
wandb:          best_val_f1 0.58228
wandb:    best_val_accuracy 0.94625
wandb:   best_val_precision 0.60526
wandb:      best_val_recall 0.56098
wandb:             best_auc 0.60846
wandb:           best_epoch 20
wandb: Run history:
wandb:   train_accuracy ▁▄▅▇▇▇▇█████████████████████████████████
wandb:     val_accuracy ▁▁▄████▆██████████▇█▇███████████████████
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▇█▇▁▁▁▂▆▁▁▁▁▁▁▂▁▂▁▃▁▆▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:       val_recall ██▆▁▃▃▃▃▃▃▂▃▁▂▃▃▂▂▄▂▅▃▃▄▂▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂
wandb:    val_precision ▁▁▁▆▅▅▅▂▅▆▇▆▇▆▆▇▅▆▄█▃▆▅▅▆▅▅▅▅▆▆▅▆▆▅▆▆▆▆▆
wandb:           val_f1 ▁▁▂▆▆▆▆▃▇▇▇▇▇▇▇█▆▇▆█▄▇▆▆▇▆▆▆▆▆▇▆▇▇▆▇▇▆▇▇
wandb:          val_auc ▁▁▁▄▇▇▇▇▇▇█▇▇█████▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:               lr ██████████████████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_070522-1z7j0fm9

-----------------------
Model 9 with new params
Changing augmentation to time/frequency masking
Audio Augmentation Parameters: {'ADD': 0, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Spec Augmentation Parameters: {'ADD': 1, 'QUANTITY': 158, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_4
Length of training samples after spec augmentation: 2616
-----------------------
Number of train recordings: 2616 with pneumonia: 316 and non-pneumonia: 2300
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_5
Length of training samples after spec augmentation: 2716
-----------------------
Number of train recordings: 2716 with pneumonia: 316 and non-pneumonia: 2400
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_5 (InputLayer)                             [(None, 64, 1250, 1)]                       0                
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                               (None, 64, 1250, 8)                         80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_20 (MixDepthGroupC (None, 64, 1250, 8)                         162              
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePooling2D)          (None, 32, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormalization)      (None, 32, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                               (None, 32, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_21 (MixDepthGroupC (None, 32, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePooling2D)          (None, 16, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormalization)      (None, 16, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                               (None, 16, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_22 (MixDepthGroupC (None, 16, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePooling2D)          (None, 8, 157, 32)                          0                
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormalization)      (None, 8, 157, 32)                          128              
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                               (None, 8, 157, 64)                          18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_23 (MixDepthGroupC (None, 8, 157, 64)                          1656             
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePooling2D)          (None, 4, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormalization)      (None, 4, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                               (None, 4, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_24 (MixDepthGroupC (None, 4, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePooling2D)          (None, 2, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormalization)      (None, 2, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_4 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
170/170 - 49s - loss: 0.5888 - accuracy: 0.6602 - val_loss: 0.5472 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09314892885518752
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
170/170 - 48s - loss: 0.3588 - accuracy: 0.7879 - val_loss: 0.2442 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1307408391599973
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
170/170 - 47s - loss: 0.2363 - accuracy: 0.8881 - val_loss: 0.2741 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1625227197518897
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
170/170 - 47s - loss: 0.1676 - accuracy: 0.9172 - val_loss: 0.4347 - val_accuracy: 0.8469
Confusion matrix: 
 [[493  80]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.341 0.659]]
Validation f1: 36.49
Validation accuracy: 84.69
Validation recall: 65.85
Validation precision: 25.23
Validation AUC: 0.4078178763833007
Validation class accuracies: [0.8603839441535777, 0.6585365853658537]
Saving model...
Epoch 5/65
170/170 - 47s - loss: 0.1622 - accuracy: 0.9334 - val_loss: 0.1776 - val_accuracy: 0.9365
Confusion matrix: 
 [[549  24]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.366 0.634]]
Validation f1: 57.14
Validation accuracy: 93.65
Validation recall: 63.41
Validation precision: 52.00
Validation AUC: 0.5887101092623082
Validation class accuracies: [0.9581151832460733, 0.6341463414634146]
Saving model...
Epoch 6/65
170/170 - 48s - loss: 0.0790 - accuracy: 0.9702 - val_loss: 0.1908 - val_accuracy: 0.9381
Confusion matrix: 
 [[549  24]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.341 0.659]]
Validation f1: 58.70
Validation accuracy: 93.81
Validation recall: 65.85
Validation precision: 52.94
Validation AUC: 0.5542541496982945
Validation class accuracies: [0.9581151832460733, 0.6585365853658537]
Saving model...
Epoch 7/65
170/170 - 48s - loss: 0.0797 - accuracy: 0.9658 - val_loss: 0.4634 - val_accuracy: 0.8469
Confusion matrix: 
 [[484  89]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.845 0.155]
 [0.122 0.878]]
Validation f1: 43.37
Validation accuracy: 84.69
Validation recall: 87.80
Validation precision: 28.80
Validation AUC: 0.6253437345392575
Validation class accuracies: [0.8446771378708552, 0.8780487804878049]
The validation tracker metric at 0.5869565217391304 hasn't increased by 0 in 1 epochs
Epoch 8/65
170/170 - 47s - loss: 0.0326 - accuracy: 0.9886 - val_loss: 0.2691 - val_accuracy: 0.9202
Confusion matrix: 
 [[533  40]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93 0.07]
 [0.22 0.78]]
Validation f1: 56.64
Validation accuracy: 92.02
Validation recall: 78.05
Validation precision: 44.44
Validation AUC: 0.6021022684440972
Validation class accuracies: [0.9301919720767888, 0.7804878048780488]
The validation tracker metric at 0.5869565217391304 hasn't increased by 0 in 2 epochs
Epoch 9/65
170/170 - 47s - loss: 0.0392 - accuracy: 0.9886 - val_loss: 0.2133 - val_accuracy: 0.9479
Confusion matrix: 
 [[555  18]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.341 0.659]]
Validation f1: 62.79
Validation accuracy: 94.79
Validation recall: 65.85
Validation precision: 60.00
Validation AUC: 0.6074193515433186
Validation class accuracies: [0.9685863874345549, 0.6585365853658537]
Saving model...
Epoch 10/65
170/170 - 47s - loss: 0.0292 - accuracy: 0.9893 - val_loss: 0.2514 - val_accuracy: 0.9235
Confusion matrix: 
 [[536  37]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.244 0.756]]
Validation f1: 56.88
Validation accuracy: 92.35
Validation recall: 75.61
Validation precision: 45.59
Validation AUC: 0.626668036493181
Validation class accuracies: [0.9354275741710296, 0.7560975609756098]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 1 epochs
Epoch 11/65
170/170 - 47s - loss: 0.0160 - accuracy: 0.9959 - val_loss: 0.3520 - val_accuracy: 0.9104
Confusion matrix: 
 [[524  49]
 [  6  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.146 0.854]]
Validation f1: 56.00
Validation accuracy: 91.04
Validation recall: 85.37
Validation precision: 41.67
Validation AUC: 0.5615590333531431
Validation class accuracies: [0.9144851657940664, 0.8536585365853658]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 2 epochs
Epoch 12/65
170/170 - 48s - loss: 0.0191 - accuracy: 0.9941 - val_loss: 0.3499 - val_accuracy: 0.8893
Confusion matrix: 
 [[514  59]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.22  0.78 ]]
Validation f1: 48.48
Validation accuracy: 88.93
Validation recall: 78.05
Validation precision: 35.16
Validation AUC: 0.5673157146528391
Validation class accuracies: [0.8970331588132635, 0.7804878048780488]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 3 epochs
Epoch 13/65
170/170 - 47s - loss: 0.0160 - accuracy: 0.9963 - val_loss: 0.2312 - val_accuracy: 0.9446
Confusion matrix: 
 [[553  20]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.341 0.659]]
Validation f1: 61.36
Validation accuracy: 94.46
Validation recall: 65.85
Validation precision: 57.45
Validation AUC: 0.6226144749386444
Validation class accuracies: [0.9650959860383944, 0.6585365853658537]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 4 epochs
Epoch 14/65
170/170 - 47s - loss: 0.0122 - accuracy: 0.9974 - val_loss: 0.2654 - val_accuracy: 0.9300
Confusion matrix: 
 [[540  33]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.244 0.756]]
Validation f1: 59.05
Validation accuracy: 93.00
Validation recall: 75.61
Validation precision: 48.44
Validation AUC: 0.6046237073666931
Validation class accuracies: [0.9424083769633508, 0.7560975609756098]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 5 epochs
Epoch 15/65
170/170 - 48s - loss: 0.0056 - accuracy: 0.9996 - val_loss: 0.3477 - val_accuracy: 0.9202
Confusion matrix: 
 [[533  40]
 [  9  32]]
Normalized Confusion matrix: 
 [[0.93 0.07]
 [0.22 0.78]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.64
Validation accuracy: 92.02
Validation recall: 78.05
Validation precision: 44.44
Validation AUC: 0.591452124369283
Validation class accuracies: [0.9301919720767888, 0.7804878048780488]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 16/65
170/170 - 47s - loss: 0.0097 - accuracy: 0.9993 - val_loss: 0.3024 - val_accuracy: 0.9283
Confusion matrix: 
 [[540  33]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.268 0.732]]
Validation f1: 57.69
Validation accuracy: 92.83
Validation recall: 73.17
Validation precision: 47.62
Validation AUC: 0.6021170642666156
Validation class accuracies: [0.9424083769633508, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 7 epochs
Epoch 17/65
170/170 - 47s - loss: 0.0105 - accuracy: 0.9978 - val_loss: 0.5536 - val_accuracy: 0.8974
Confusion matrix: 
 [[515  58]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.899 0.101]
 [0.122 0.878]]
Validation f1: 53.33
Validation accuracy: 89.74
Validation recall: 87.80
Validation precision: 38.30
Validation AUC: 0.583471005975597
Validation class accuracies: [0.8987783595113438, 0.8780487804878049]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 8 epochs
Epoch 18/65
170/170 - 47s - loss: 0.0055 - accuracy: 0.9996 - val_loss: 0.2822 - val_accuracy: 0.9332
Confusion matrix: 
 [[545  28]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.317 0.683]]
Validation f1: 57.73
Validation accuracy: 93.32
Validation recall: 68.29
Validation precision: 50.00
Validation AUC: 0.596442104476481
Validation class accuracies: [0.9511343804537522, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 9 epochs
Epoch 19/65
170/170 - 47s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.3445 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.5814237405581139
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 10 epochs
Epoch 20/65
170/170 - 47s - loss: 0.0081 - accuracy: 0.9974 - val_loss: 0.3953 - val_accuracy: 0.9186
Confusion matrix: 
 [[533  40]
 [ 10  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.244 0.756]]
Validation f1: 55.36
Validation accuracy: 91.86
Validation recall: 75.61
Validation precision: 43.66
Validation AUC: 0.5461139583197139
Validation class accuracies: [0.9301919720767888, 0.7560975609756098]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 11 epochs
Epoch 21/65
170/170 - 47s - loss: 0.0043 - accuracy: 0.9993 - val_loss: 0.2817 - val_accuracy: 0.9365
Confusion matrix: 
 [[548  25]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.341 0.659]]
Validation f1: 58.06
Validation accuracy: 93.65
Validation recall: 65.85
Validation precision: 51.92
Validation AUC: 0.5836410180600855
Validation class accuracies: [0.956369982547993, 0.6585365853658537]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 22/65
170/170 - 47s - loss: 0.0035 - accuracy: 1.0000 - val_loss: 0.3082 - val_accuracy: 0.9283
Confusion matrix: 
 [[541  32]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.293 0.707]]
Validation f1: 56.86
Validation accuracy: 92.83
Validation recall: 70.73
Validation precision: 47.54
Validation AUC: 0.5866694952270151
Validation class accuracies: [0.944153577661431, 0.7073170731707317]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 13 epochs
Epoch 23/65
170/170 - 46s - loss: 0.0077 - accuracy: 0.9993 - val_loss: 0.3284 - val_accuracy: 0.9218
Confusion matrix: 
 [[538  35]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.317 0.683]]
Validation f1: 53.85
Validation accuracy: 92.18
Validation recall: 68.29
Validation precision: 44.44
Validation AUC: 0.5674804985030533
Validation class accuracies: [0.9389179755671903, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 14 epochs
Epoch 24/65
170/170 - 46s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.3395 - val_accuracy: 0.9267
Confusion matrix: 
 [[539  34]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.268 0.732]]
Validation f1: 57.14
Validation accuracy: 92.67
Validation recall: 73.17
Validation precision: 46.88
Validation AUC: 0.5812218004728619
Validation class accuracies: [0.9406631762652705, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 15 epochs
Epoch 25/65
170/170 - 47s - loss: 0.0037 - accuracy: 1.0000 - val_loss: 0.3318 - val_accuracy: 0.9283
Confusion matrix: 
 [[540  33]
 [ 11  30]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.268 0.732]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.69
Validation accuracy: 92.83
Validation recall: 73.17
Validation precision: 47.62
Validation AUC: 0.5937287960013223
Validation class accuracies: [0.9424083769633508, 0.7317073170731707]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 16 epochs
Epoch 26/65
170/170 - 47s - loss: 0.0051 - accuracy: 1.0000 - val_loss: 0.6316 - val_accuracy: 0.8827
Confusion matrix: 
 [[506  67]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.122 0.878]]
Validation f1: 50.00
Validation accuracy: 88.27
Validation recall: 87.80
Validation precision: 34.95
Validation AUC: 0.5438774431794275
Validation class accuracies: [0.8830715532286213, 0.8780487804878049]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 17 epochs
Epoch 27/65
170/170 - 46s - loss: 0.0040 - accuracy: 0.9993 - val_loss: 0.2858 - val_accuracy: 0.9365
Confusion matrix: 
 [[547  26]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.317 0.683]]
Validation f1: 58.95
Validation accuracy: 93.65
Validation recall: 68.29
Validation precision: 51.85
Validation AUC: 0.6013694902607347
Validation class accuracies: [0.9546247818499127, 0.6829268292682927]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 28/65
170/170 - 47s - loss: 0.0030 - accuracy: 1.0000 - val_loss: 0.2886 - val_accuracy: 0.9365
Confusion matrix: 
 [[548  25]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.06
Validation accuracy: 93.65
Validation recall: 65.85
Validation precision: 51.92
Validation AUC: 0.5995006446720016
Validation class accuracies: [0.956369982547993, 0.6585365853658537]
The validation tracker metric at 0.627906976744186 hasn't increased by 0 in 19 epochs
Epoch 29/65
170/170 - 46s - loss: 0.0055 - accuracy: 1.0000 - val_loss: 0.3301 - val_accuracy: 0.9218
Confusion matrix: 
 [[539  34]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.341 0.659]]
Validation f1: 52.94
Validation accuracy: 92.18
Validation recall: 65.85
Validation precision: 44.26
Validation AUC: 0.5813096381836094
Validation class accuracies: [0.9406631762652705, 0.6585365853658537]

The metrics for job 4 with the best target metric are: 
Best cm: [[555  18]
 [ 14  27]]
Best normalized cm: [[0.969 0.031]
 [0.341 0.659]]
Best f1: 0.63
Best accuracy: 0.95
Best recall: 0.66
Best precision: 0.60
Best AUC: 0.61
Best class accuracies: [0.9685863874345549, 0.6585365853658537]
Best epoch: 9
The number of epochs since last 1% equals the patience
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_221_2b3_Ar_mc_LittC2SE_2_label_0_pred_1.png, [[0.992]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_3b4_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[2.581e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_223_1b1_Pl_sc_Meditron_1_label_0_pred_0.png, [[2.657e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_222_1b1_Pr_sc_Meditron_2_label_0_pred_0.png, [[9.211e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_218_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_224_1b1_Tc_sc_Meditron_1_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_218_1b1_Ar_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_210_1b1_Al_sc_Meditron_3_label_0_pred_0.png, [[7.588e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_203_2p3_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.772e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_223_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_222_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[8.004e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_3b2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_213_2p2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[9.856e-07]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_213_1p5_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[7.223e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_1b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_211_2p3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_213_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_3b2_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.067]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_1b3_Lr_mc_AKGC417L_0_label_0_pred_0.png, [[1.904e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.053]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_1b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_221_2b3_Ar_mc_LittC2SE_3_label_0_pred_1.png, [[0.867]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_213_1p3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_222_1b1_Ar_sc_Meditron_7_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[6.549e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b4_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b4_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[2.39e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_223_1b1_Ll_sc_Meditron_5_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[1.184e-06]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[8.899e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[4.128e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_223_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[1.717e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_205_1b3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b3_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.063]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[0.011]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_218_1b1_Ar_sc_Meditron_1_label_0_pred_0.png, [[0.281]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_203_2p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[2.176e-05]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_211_2p2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/4/icbhi_207_2b3_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[7.432e-06]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 21787
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_074536-iwfsstz6/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_074536-iwfsstz6/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.92182
wandb:             _runtime 1704
wandb:           _timestamp 1624695241
wandb:                _step 214
wandb:           train_loss 0.00545
wandb:             val_loss 0.33015
wandb:           val_recall 0.65854
wandb:        val_precision 0.44262
wandb:               val_f1 0.52941
wandb:              val_auc 0.58131
wandb:                   lr 0.00013
wandb:          best_val_f1 0.62791
wandb:    best_val_accuracy 0.94788
wandb:   best_val_precision 0.6
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.60742
wandb:           best_epoch 9
wandb: Run history:
wandb:   train_accuracy ▁▄▆▆▇▇▇██████████████████████
wandb:     val_accuracy ▇▇▇▁▇▇▁▆█▆▅▄█▇▆▇▅▇▆▆▇▇▆▇▇▃▇▇▆
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▄▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▇▂▂▅▁▁▅▂▂▂▄▄▂▂▄▃▇▃▄▄▃▃▃▃▃█▃▃▃
wandb:       val_recall ▁▁▁▆▆▆█▇▆▇█▇▆▇▇▇█▆▆▇▆▇▆▇▇█▆▆▆
wandb:    val_precision ▁▁▁▄▇▇▄▆█▆▆▅█▇▆▇▅▇▆▆▇▇▆▆▇▅▇▇▆
wandb:           val_f1 ▁▁▁▅▇█▆▇█▇▇▆██▇▇▇▇▇▇▇▇▇▇▇▇█▇▇
wandb:          val_auc ▁▁▂▅█▇████▇▇████▇█▇▇▇▇▇▇█▇██▇
wandb:               lr ███████████████▄▄▄▄▄▄▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210626_074536-iwfsstz6

-----------------------

 See logs at ../../new_cache/conv__2256__06_0428__v39__augm_half_mixednet/logs/