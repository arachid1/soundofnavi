Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2122
Description:  redo
2021-05-11 00:47:21.293926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:47:23.736398: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 00:47:23.737499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-11 00:47:23.790201: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:23.790992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 00:47:23.791027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:47:23.794798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 00:47:23.794921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 00:47:23.795976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 00:47:23.796271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 00:47:23.797234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 00:47:23.798257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 00:47:23.798449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 00:47:23.798581: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:23.799347: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:23.799986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2122.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2122__05_0045__v29__redo/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 12, 5.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2122
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1gpi7rns
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_004724-1gpi7rns
wandb: Run `wandb offline` to turn off syncing.
2021-05-11 00:47:29.248923: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 00:47:29.249194: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:29.249964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 00:47:29.250004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:47:29.250062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 00:47:29.250081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 00:47:29.250125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 00:47:29.250161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 00:47:29.250181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 00:47:29.250200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 00:47:29.250218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 00:47:29.250314: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:29.251075: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:29.251745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-11 00:47:29.251793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 00:47:30.007866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-11 00:47:30.007914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-11 00:47:30.007923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-11 00:47:30.008201: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:30.009121: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:30.009925: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 00:47:30.010662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-11 00:48:08.752414: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-11 00:48:08.754708: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-11 00:48:11.997710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 00:48:12.777596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 00:48:12.789782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 506s - loss: 0.7246 - accuracy: 0.5648 - val_loss: 0.6323 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.23446307744980055
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.23446307744980055
Epoch 2/40
263/263 - 498s - loss: 0.6857 - accuracy: 0.5860 - val_loss: 0.6948 - val_accuracy: 0.7528
Confusion matrix: 
 [[798  72]
 [197  21]]
Validation f1: 13.50
Validation accuracy: 75.28
Validation recall: 9.63
Validation precision: 22.58
Validation AUC: 0.20234880075524103
Validation class accuracies: [0.9172413793103448, 0.0963302752293578]
TARGET: 0
target metric(test auc): 0.20234880075524103
Epoch 3/40
263/263 - 499s - loss: 0.6849 - accuracy: 0.5908 - val_loss: 0.6925 - val_accuracy: 0.7785
Confusion matrix: 
 [[842  28]
 [213   5]]
Validation f1: 3.98
Validation accuracy: 77.85
Validation recall: 2.29
Validation precision: 15.15
Validation AUC: 0.21070704275189317
Validation class accuracies: [0.967816091954023, 0.022935779816513763]
TARGET: 0
target metric(test auc): 0.21070704275189317
Epoch 4/40
263/263 - 498s - loss: 0.6842 - accuracy: 0.5825 - val_loss: 0.6744 - val_accuracy: 0.7996
Confusion matrix: 
 [[867   3]
 [215   3]]
Validation f1: 2.68
Validation accuracy: 79.96
Validation recall: 1.38
Validation precision: 50.00
Validation AUC: 0.19192500138129062
Validation class accuracies: [0.996551724137931, 0.013761467889908258]
TARGET: 0
target metric(test auc): 0.19192500138129062
Epoch 5/40
263/263 - 498s - loss: 0.6818 - accuracy: 0.5901 - val_loss: 0.6446 - val_accuracy: 0.7858
Confusion matrix: 
 [[849  21]
 [212   6]]
Validation f1: 4.90
Validation accuracy: 78.58
Validation recall: 2.75
Validation precision: 22.22
Validation AUC: 0.19934444931033168
Validation class accuracies: [0.9758620689655172, 0.027522935779816515]
TARGET: 0
target metric(test auc): 0.19934444931033168
Saving model...
Epoch 6/40
263/263 - 499s - loss: 0.6811 - accuracy: 0.5801 - val_loss: 0.6919 - val_accuracy: 0.5138
Confusion matrix: 
 [[453 417]
 [112 106]]
Validation f1: 28.61
Validation accuracy: 51.38
Validation recall: 48.62
Validation precision: 20.27
Validation AUC: 0.1993920866921347
Validation class accuracies: [0.5206896551724138, 0.48623853211009177]
TARGET: 0
target metric(test auc): 0.1993920866921347
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 1 epochs
Saving model...
Epoch 7/40
263/263 - 500s - loss: 0.6812 - accuracy: 0.5813 - val_loss: 0.7234 - val_accuracy: 0.3244
Confusion matrix: 
 [[181 689]
 [ 46 172]]
Validation f1: 31.88
Validation accuracy: 32.44
Validation recall: 78.90
Validation precision: 19.98
Validation AUC: 0.2214362066564546
Validation class accuracies: [0.20804597701149424, 0.7889908256880734]
TARGET: 0
target metric(test auc): 0.2214362066564546
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 2 epochs
Saving model...
Epoch 8/40
263/263 - 499s - loss: 0.6806 - accuracy: 0.5806 - val_loss: 0.6655 - val_accuracy: 0.7730
Confusion matrix: 
 [[827  43]
 [204  14]]
Validation f1: 10.18
Validation accuracy: 77.30
Validation recall: 6.42
Validation precision: 24.56
Validation AUC: 0.20194440283297949
Validation class accuracies: [0.9505747126436782, 0.06422018348623854]
TARGET: 0
target metric(test auc): 0.20194440283297949
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 3 epochs
Epoch 9/40
263/263 - 498s - loss: 0.6775 - accuracy: 0.5894 - val_loss: 0.6594 - val_accuracy: 0.7583
Confusion matrix: 
 [[798  72]
 [191  27]]
Validation f1: 17.03
Validation accuracy: 75.83
Validation recall: 12.39
Validation precision: 27.27
Validation AUC: 0.23064031344596253
Validation class accuracies: [0.9172413793103448, 0.12385321100917432]
TARGET: 0
target metric(test auc): 0.23064031344596253
Lr has been adjusted to 0.000750000006519258
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 4 epochs
Saving model...
Epoch 10/40
263/263 - 499s - loss: 0.6752 - accuracy: 0.6008 - val_loss: 0.6675 - val_accuracy: 0.7050
Confusion matrix: 
 [[742 128]
 [193  25]]
Validation f1: 13.48
Validation accuracy: 70.50
Validation recall: 11.47
Validation precision: 16.34
Validation AUC: 0.20368861316381043
Validation class accuracies: [0.8528735632183908, 0.11467889908256881]
TARGET: 0
target metric(test auc): 0.20368861316381043
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 5 epochs
Epoch 11/40
263/263 - 498s - loss: 0.6740 - accuracy: 0.6242 - val_loss: 0.6966 - val_accuracy: 0.5901
Confusion matrix: 
 [[560 310]
 [136  82]]
Validation f1: 26.89
Validation accuracy: 59.01
Validation recall: 37.61
Validation precision: 20.92
Validation AUC: 0.21132292542295583
Validation class accuracies: [0.6436781609195402, 0.3761467889908257]
TARGET: 0
target metric(test auc): 0.21132292542295583
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 6 epochs
Epoch 12/40
263/263 - 498s - loss: 0.6733 - accuracy: 0.6173 - val_loss: 0.6704 - val_accuracy: 0.7546
Confusion matrix: 
 [[809  61]
 [206  12]]
Validation f1: 8.25
Validation accuracy: 75.46
Validation recall: 5.50
Validation precision: 16.44
Validation AUC: 0.1898012793961341
Validation class accuracies: [0.9298850574712644, 0.05504587155963303]
TARGET: 0
target metric(test auc): 0.1898012793961341
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 7 epochs
Epoch 13/40
263/263 - 498s - loss: 0.6705 - accuracy: 0.6466 - val_loss: 0.6521 - val_accuracy: 0.7868
Confusion matrix: 
 [[851  19]
 [213   5]]
Validation f1: 4.13
Validation accuracy: 78.68
Validation recall: 2.29
Validation precision: 20.83
Validation AUC: 0.18935350668673429
Validation class accuracies: [0.9781609195402299, 0.022935779816513763]
TARGET: 0
target metric(test auc): 0.18935350668673429
Lr has been adjusted to 0.0005624999757856131
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 8 epochs
Epoch 14/40
263/263 - 498s - loss: 0.6681 - accuracy: 0.6344 - val_loss: 0.6995 - val_accuracy: 0.5983
Confusion matrix: 
 [[567 303]
 [134  84]]
Validation f1: 27.77
Validation accuracy: 59.83
Validation recall: 38.53
Validation precision: 21.71
Validation AUC: 0.22796277225808736
Validation class accuracies: [0.6517241379310345, 0.3853211009174312]
TARGET: 0
target metric(test auc): 0.22796277225808736
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 9 epochs
Epoch 15/40
263/263 - 499s - loss: 0.6654 - accuracy: 0.6444 - val_loss: 0.6620 - val_accuracy: 0.6737
Confusion matrix: 
 [[691 179]
 [176  42]]
Validation f1: 19.13
Validation accuracy: 67.37
Validation recall: 19.27
Validation precision: 19.00
Validation AUC: 0.21609818995880975
Validation class accuracies: [0.7942528735632184, 0.1926605504587156]
TARGET: 0
target metric(test auc): 0.21609818995880975
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 10 epochs
Epoch 16/40
263/263 - 498s - loss: 0.6644 - accuracy: 0.6602 - val_loss: 0.6745 - val_accuracy: 0.6397
Confusion matrix: 
 [[641 229]
 [163  55]]
Validation f1: 21.91
Validation accuracy: 63.97
Validation recall: 25.23
Validation precision: 19.37
Validation AUC: 0.2150832978856405
Validation class accuracies: [0.7367816091954023, 0.25229357798165136]
TARGET: 0
target metric(test auc): 0.2150832978856405
The validation tracker metric at 0.19934444931033168 hasn't increased by 0.05 in 11 epochs
Epoch 17/40
263/263 - 497s - loss: 0.6610 - accuracy: 0.6671 - val_loss: 0.7137 - val_accuracy: 0.5386
Confusion matrix: 
 [[460 410]
 [ 92 126]]
Validation f1: 33.42
Validation accuracy: 53.86
Validation recall: 57.80
Validation precision: 23.51
Validation AUC: 0.2169994737898937
Validation class accuracies: [0.5287356321839081, 0.5779816513761468]

The metrics for the epoch with the best target metric are: 
Best cm: [[798  72]
 [191  27]]
Best f1: 0.17034700315457413
Best accuracy: 0.7582720588235294
Best recall: 0.12385321100917432
Best precision: 0.2727272727272727
Best AUC: 0.23064031344596253
Best epoch: 9
TARGET: 0
target metric(test auc): 0.2169994737898937
Lr has been adjusted to 0.0004218749818392098
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 40
Starting...
CM: [[ 9 51]
 [ 0 15]]
F1: 0.37037037037037035
AUC: 0.6136363636363636
Accuracy: 0.32
Precision: 0.22727272727272727
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2122__05_0045__v29__redo/validation_sheet_40.xls...
Done.
Epoch: 5
Starting...
CM: [[53  7]
 [13  2]]
F1: 0.16666666666666669
AUC: 0.2644444444444445
Accuracy: 0.7333333333333333
Precision: 0.2222222222222222
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2122__05_0045__v29__redo/validation_sheet_5.xls...
Done.
Epoch: 6
Starting...
CM: [[ 7 53]
 [ 0 15]]
F1: 0.36144578313253006
AUC: 0.6102941176470589
Accuracy: 0.29333333333333333
Precision: 0.22058823529411764
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2122__05_0045__v29__redo/validation_sheet_6.xls...
Done.
Epoch: 7
Starting...
CM: [[ 0 60]
 [ 0 15]]
F1: 0.33333333333333337
AUC: 0.6
Accuracy: 0.2
Precision: 0.2
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2122__05_0045__v29__redo/validation_sheet_7.xls...
Done.
Epoch: 9
Starting...
CM: [[34 26]
 [ 5 10]]
F1: 0.39215686274509803
AUC: 0.5055555555555555
Accuracy: 0.5866666666666667
Precision: 0.2777777777777778
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2122__05_0045__v29__redo/validation_sheet_9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 13806
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_004724-1gpi7rns/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_004724-1gpi7rns/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.66706
wandb:         val_accuracy 0.5386
wandb:             _runtime 8905
wandb:           _timestamp 1620702949
wandb:                _step 122
wandb:           train_loss 0.66096
wandb:             val_loss 0.71373
wandb:           val_recall 0.57798
wandb:        val_precision 0.23507
wandb:               val_f1 0.33422
wandb:              val_auc 0.217
wandb:                   lr 0.00056
wandb:          best_val_f1 0.17035
wandb:    best_val_accuracy 0.75827
wandb:   best_val_precision 0.27273
wandb:      best_val_recall 0.12385
wandb:             best_auc 0.23064
wandb:           best_epoch 9
wandb:           best_bd_f1 0.37037
wandb:          best_bd_auc 0.61364
wandb:     best_bd_accuracy 0.32
wandb:    best_bd_precision 0.22727
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 40
wandb: Run history:
wandb:   train_accuracy ▁▂▃▂▃▂▂▂▃▃▅▅▇▆▆██
wandb:     val_accuracy █▇███▄▁█▇▇▅▇█▅▆▆▄
wandb:         _runtime ▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇█████
wandb:       _timestamp ▁▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇█████
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▄▄▄▃▃▃▃▃▃▂▂▂▂▁▁▁
wandb:         val_loss ▁▆▆▄▂▆█▄▃▄▆▄▃▆▃▄▇
wandb:       val_recall ▁▂▁▁▁▅█▂▂▂▄▁▁▄▃▃▆
wandb:    val_precision ▁▄▃█▄▄▄▄▅▃▄▃▄▄▄▄▄
wandb:           val_f1 ▁▄▂▂▂▇█▃▅▄▇▃▂▇▅▆█
wandb:          val_auc █▃▄▁▃▃▆▃▇▃▄▁▁▇▅▅▅
wandb:               lr █████████▄▄▄▄▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 4 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2122: https://wandb.ai/arachid1/tensorboard-integration/runs/1gpi7rns


 See logs at ../../new_cache/conv__2122__05_0045__v29__redo/logs/