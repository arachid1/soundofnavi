Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2220
Description:  timeseries
2021-06-15 18:37:37.052920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-15 18:37:39.524162: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 18:37:39.525103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-15 18:37:39.537117: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:39.537799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 18:37:39.537844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 18:37:39.541408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 18:37:39.541485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 18:37:39.542512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 18:37:39.542831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 18:37:39.543810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 18:37:39.544661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 18:37:39.544822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 18:37:39.544928: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:39.545622: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:39.546243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2220.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2220__06_1837__v39__timeseries
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 50, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-15 18:37:44.432819: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-15 18:37:44.433039: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:44.433762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-15 18:37:44.433803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 18:37:44.433844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 18:37:44.433863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-15 18:37:44.433883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-15 18:37:44.433902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-15 18:37:44.433920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-15 18:37:44.433939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-15 18:37:44.433958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 18:37:44.434041: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:44.434791: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:44.435453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-15 18:37:44.435498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-15 18:37:45.176565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-15 18:37:45.176611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-15 18:37:45.176622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-15 18:37:45.176908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:45.177709: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:45.178398: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-15 18:37:45.179079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-15 18:37:46.890213: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-15 18:37:46.892494: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-15 18:37:47.243777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-15 18:37:49.238472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-15 18:37:49.691710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 1250, 128, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 1250, 128, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 1250, 128, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 1250, 128, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 1250, 128, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 1250, 128, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 1250, 128, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 1250, 128, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 1250, 128, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 625, 64, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 625, 64, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 625, 64, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 625, 64, 48)     40512        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 625, 64, 48)     40512        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 313, 32, 48)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 313, 32, 48)     192          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 313, 32, 48)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 313, 48)         0            dropout_1[0][0]                      
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 313, 256)        181248       time_distributed[0][0]               
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 313, 256)        394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 313, 128)        32896        bidirectional_1[0][0]                
______________________________________________________________________________________________________________
dense_1 (Dense)                     (None, 313, 1)          129          dense[0][0]                          
______________________________________________________________________________________________________________
flatten (Flatten)                   (None, 313)             0            dense_1[0][0]                        
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               314          flatten[0][0]                        
==============================================================================================================
Total params: 699,071
Trainable params: 696,381
Non-trainable params: 2,690
______________________________________________________________________________________________________________
Epoch 1/50
151/151 - 183s - loss: 0.6925 - accuracy: 0.2819 - val_loss: 0.6935 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.05873855195887501
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/50
151/151 - 189s - loss: 0.6923 - accuracy: 0.1772 - val_loss: 0.6961 - val_accuracy: 0.1570
Confusion matrix: 
 [[ 67 506]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.117 0.883]
 [0.125 0.875]]
Validation f1: 9.89
Validation accuracy: 15.70
Validation recall: 87.50
Validation precision: 5.24
Validation AUC: 0.06420997393298296
Validation class accuracies: [0.1169284467713787, 0.875]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/50
151/151 - 189s - loss: 0.6907 - accuracy: 0.7057 - val_loss: 0.6920 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0543154838219696
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/50
151/151 - 189s - loss: 0.6881 - accuracy: 0.3982 - val_loss: 0.6915 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11297539879894722
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 3 epochs
Epoch 5/50
151/151 - 189s - loss: 0.6867 - accuracy: 0.1436 - val_loss: 0.6925 - val_accuracy: 0.9455
Confusion matrix: 
 [[572   1]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 94.55
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05015877249890134
Validation class accuracies: [0.9982547993019197, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 4 epochs
Epoch 6/50
151/151 - 189s - loss: 0.6866 - accuracy: 0.9516 - val_loss: 0.6922 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05423153204040739
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 5 epochs
Epoch 7/50
151/151 - 190s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6913 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.055563535995048846
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 8/50
151/151 - 190s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6905 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05561248877103645
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 7 epochs
Epoch 9/50
151/151 - 191s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6908 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05595619322449123
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 8 epochs
Epoch 10/50
151/151 - 193s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6904 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05626193117940869
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 9 epochs
Epoch 11/50
151/151 - 190s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6901 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0557444100795531
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 10 epochs
Epoch 12/50
151/151 - 190s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6902 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05611265190368594
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 11 epochs
Epoch 13/50
151/151 - 191s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6897 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.0561549008901479
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 14/50
151/151 - 191s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6897 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05617736291305521
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 13 epochs
Epoch 15/50
151/151 - 191s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6897 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05643690857896379
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 14 epochs
Epoch 16/50
151/151 - 193s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6896 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05619710408136107
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 15 epochs
Epoch 17/50
151/151 - 196s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6897 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05646524764426195
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 16 epochs
Epoch 18/50
151/151 - 200s - loss: 0.6866 - accuracy: 0.9520 - val_loss: 0.6895 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.056942526387008696
Validation class accuracies: [1.0, 0.0]
local_gc_exec.sh: line 6: 30369 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2220__06_1837__v39__timeseries/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
