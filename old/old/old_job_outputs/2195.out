Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2195
Description:  less_pneu_augm
2021-06-06 18:21:51.304364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-06 18:21:53.553663: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-06 18:21:53.554656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-06 18:21:53.603107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:21:53.603816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-06 18:21:53.603846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-06 18:21:53.607492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-06 18:21:53.607590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-06 18:21:53.608797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-06 18:21:53.609110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-06 18:21:53.610187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-06 18:21:53.611103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-06 18:21:53.611313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-06 18:21:53.611420: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:21:53.612148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:21:53.612779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2195.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.25, 'PATIENCE': 8, 'MIN_LR': 1e-05, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-06 18:23:16.964403: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-06 18:23:16.964753: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:23:16.965603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-06 18:23:16.965654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-06 18:23:16.965738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-06 18:23:16.965762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-06 18:23:16.965785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-06 18:23:16.965807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-06 18:23:16.965828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-06 18:23:16.965850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-06 18:23:16.965876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-06 18:23:16.965978: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:23:16.966674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:23:16.967317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-06 18:23:16.967383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-06 18:23:17.643447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-06 18:23:17.643495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-06 18:23:17.643504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-06 18:23:17.643792: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:23:17.644583: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:23:17.645349: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-06 18:23:17.646021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Length of training samples after audio augmentation: 4712
Length of training samples after spec augmentation: 4862
-----------------------
Number of train recordings: 4862 with pneumonia: 1730 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
With concat = False and six = False, size of training set: 4862...
...and size of validation set: 1072
Initializing weights...
weights = {0: 0.7761813537675607, 1: 1.4052023121387283}
The step size for cyclical LR is 606
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 1 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 1) 4           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 32          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 1) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 32          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
__________________________________________________________________________________________________
2021-06-06 18:23:18.918869: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-06 18:23:18.920672: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-06 18:23:19.250493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-06 18:23:21.028718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-06 18:23:21.482418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/80
304/304 - 437s - loss: 0.6079 - accuracy: 0.7094 - val_loss: 0.6025 - val_accuracy: 0.7313
Confusion matrix: 
 [[784   0]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 73.13
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.31131885058536196
Validation class accuracies: [1.0, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
304/304 - 433s - loss: 0.4801 - accuracy: 0.8139 - val_loss: 1.2880 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.28943140799897854
Validation class accuracies: [0.0, 1.0]
The clause is activated.
The training is defaulting to either class.
Epoch 3/80
304/304 - 433s - loss: 0.4500 - accuracy: 0.8309 - val_loss: 0.5712 - val_accuracy: 0.7267
Confusion matrix: 
 [[777   7]
 [286   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99107143 0.00892857]
 [0.99305556 0.00694444]]
Validation f1: 1.35
Validation accuracy: 72.67
Validation recall: 0.69
Validation precision: 22.22
Validation AUC: 0.3337803365604635
Validation class accuracies: [0.9910714285714286, 0.006944444444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 4/80
304/304 - 429s - loss: 0.4211 - accuracy: 0.8412 - val_loss: 0.6092 - val_accuracy: 0.7220
Confusion matrix: 
 [[773  11]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98596939 0.01403061]
 [0.99652778 0.00347222]]
Validation f1: 0.67
Validation accuracy: 72.20
Validation recall: 0.35
Validation precision: 8.33
Validation AUC: 0.3315931657289653
Validation class accuracies: [0.985969387755102, 0.003472222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 5/80
304/304 - 428s - loss: 0.4012 - accuracy: 0.8482 - val_loss: 0.6337 - val_accuracy: 0.6828
Confusion matrix: 
 [[689  95]
 [245  43]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87882653 0.12117347]
 [0.85069444 0.14930556]]
Validation f1: 20.19
Validation accuracy: 68.28
Validation recall: 14.93
Validation precision: 31.16
Validation AUC: 0.2933569217330997
Validation class accuracies: [0.8788265306122449, 0.14930555555555555]
The clause is activated.
Not defaulting.
Saving model...
Epoch 6/80
304/304 - 428s - loss: 0.4207 - accuracy: 0.8297 - val_loss: 0.6063 - val_accuracy: 0.6884
Confusion matrix: 
 [[689  95]
 [239  49]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87882653 0.12117347]
 [0.82986111 0.17013889]]
Validation f1: 22.69
Validation accuracy: 68.84
Validation recall: 17.01
Validation precision: 34.03
Validation AUC: 0.3177109858282519
Validation class accuracies: [0.8788265306122449, 0.1701388888888889]
The clause is activated.
Not defaulting.
Saving model...
Epoch 7/80
304/304 - 428s - loss: 0.3986 - accuracy: 0.8425 - val_loss: 0.6565 - val_accuracy: 0.6427
Confusion matrix: 
 [[582 202]
 [181 107]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.74234694 0.25765306]
 [0.62847222 0.37152778]]
Validation f1: 35.85
Validation accuracy: 64.27
Validation recall: 37.15
Validation precision: 34.63
Validation AUC: 0.31239306157762986
Validation class accuracies: [0.7423469387755102, 0.3715277777777778]
The clause is activated.
Not defaulting.
Saving model...
Epoch 8/80
304/304 - 427s - loss: 0.3557 - accuracy: 0.8575 - val_loss: 0.6580 - val_accuracy: 0.6866
Confusion matrix: 
 [[686  98]
 [238  50]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.875      0.125     ]
 [0.82638889 0.17361111]]
Validation f1: 22.94
Validation accuracy: 68.66
Validation recall: 17.36
Validation precision: 33.78
Validation AUC: 0.30857820411299297
Validation class accuracies: [0.875, 0.1736111111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.35845896147403683 hasn't increased by 0 in 1 epochs
Epoch 9/80
304/304 - 427s - loss: 0.3142 - accuracy: 0.8715 - val_loss: 0.7199 - val_accuracy: 0.5998
Confusion matrix: 
 [[511 273]
 [156 132]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.65178571 0.34821429]
 [0.54166667 0.45833333]]
Validation f1: 38.10
Validation accuracy: 59.98
Validation recall: 45.83
Validation precision: 32.59
Validation AUC: 0.32941454612176474
Validation class accuracies: [0.6517857142857143, 0.4583333333333333]
The clause is activated.
Not defaulting.
Saving model...
Epoch 10/80
304/304 - 428s - loss: 0.3202 - accuracy: 0.8710 - val_loss: 0.8896 - val_accuracy: 0.7239
Confusion matrix: 
 [[775   9]
 [287   1]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.98852041 0.01147959]
 [0.99652778 0.00347222]]
Validation f1: 0.67
Validation accuracy: 72.39
Validation recall: 0.35
Validation precision: 10.00
Validation AUC: 0.29567592947550136
Validation class accuracies: [0.9885204081632653, 0.003472222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 11/80
304/304 - 428s - loss: 0.2752 - accuracy: 0.8873 - val_loss: 1.0617 - val_accuracy: 0.7267
Confusion matrix: 
 [[779   5]
 [288   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99362245 0.00637755]
 [1.         0.        ]]
Validation f1: 0.00
Validation accuracy: 72.67
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2587882565283629
Validation class accuracies: [0.9936224489795918, 0.0]
The clause is activated.
The training is defaulting to either class.
Epoch 12/80
304/304 - 428s - loss: 0.1669 - accuracy: 0.9340 - val_loss: 0.9907 - val_accuracy: 0.6530
Confusion matrix: 
 [[642 142]
 [230  58]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.81887755 0.18112245]
 [0.79861111 0.20138889]]
Validation f1: 23.77
Validation accuracy: 65.30
Validation recall: 20.14
Validation precision: 29.00
Validation AUC: 0.2904849271595907
Validation class accuracies: [0.8188775510204082, 0.2013888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 1 epochs
Epoch 13/80
304/304 - 428s - loss: 0.1164 - accuracy: 0.9570 - val_loss: 1.5369 - val_accuracy: 0.7062
Confusion matrix: 
 [[743  41]
 [274  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.94770408 0.05229592]
 [0.95138889 0.04861111]]
Validation f1: 8.16
Validation accuracy: 70.62
Validation recall: 4.86
Validation precision: 25.45
Validation AUC: 0.29145203541144094
Validation class accuracies: [0.9477040816326531, 0.04861111111111111]
The clause is activated.
The training is defaulting to either class.
Epoch 14/80
304/304 - 428s - loss: 0.1274 - accuracy: 0.9517 - val_loss: 1.2625 - val_accuracy: 0.6623
Confusion matrix: 
 [[628 156]
 [206  82]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.80102041 0.19897959]
 [0.71527778 0.28472222]]
Validation f1: 31.18
Validation accuracy: 66.23
Validation recall: 28.47
Validation precision: 34.45
Validation AUC: 0.3141562608732183
Validation class accuracies: [0.8010204081632653, 0.2847222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 2 epochs
Epoch 15/80
304/304 - 428s - loss: 0.1006 - accuracy: 0.9671 - val_loss: 1.3769 - val_accuracy: 0.7099
Confusion matrix: 
 [[741  43]
 [268  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.94515306 0.05484694]
 [0.93055556 0.06944444]]
Validation f1: 11.40
Validation accuracy: 70.99
Validation recall: 6.94
Validation precision: 31.75
Validation AUC: 0.3062172330533005
Validation class accuracies: [0.9451530612244898, 0.06944444444444445]
The clause is activated.
The training is defaulting to either class.
Epoch 16/80
304/304 - 428s - loss: 0.0546 - accuracy: 0.9823 - val_loss: 1.3946 - val_accuracy: 0.6838
Confusion matrix: 
 [[691  93]
 [246  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88137755 0.11862245]
 [0.85416667 0.14583333]]
Validation f1: 19.86
Validation accuracy: 68.38
Validation recall: 14.58
Validation precision: 31.11
Validation AUC: 0.3009502366461783
Validation class accuracies: [0.8813775510204082, 0.14583333333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 3 epochs
Epoch 17/80
304/304 - 428s - loss: 0.0577 - accuracy: 0.9815 - val_loss: 1.5152 - val_accuracy: 0.6968
Confusion matrix: 
 [[706  78]
 [247  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.9005102  0.0994898 ]
 [0.85763889 0.14236111]]
Validation f1: 20.15
Validation accuracy: 69.68
Validation recall: 14.24
Validation precision: 34.45
Validation AUC: 0.30049166567823815
Validation class accuracies: [0.9005102040816326, 0.1423611111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 4 epochs
Epoch 18/80
304/304 - 428s - loss: 0.0478 - accuracy: 0.9817 - val_loss: 1.3410 - val_accuracy: 0.6810
Confusion matrix: 
 [[650 134]
 [208  80]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.82908163 0.17091837]
 [0.72222222 0.27777778]]
Validation f1: 31.87
Validation accuracy: 68.10
Validation recall: 27.78
Validation precision: 37.38
Validation AUC: 0.3321013424871142
Validation class accuracies: [0.8290816326530612, 0.2777777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 5 epochs
Epoch 19/80
304/304 - 427s - loss: 0.0537 - accuracy: 0.9835 - val_loss: 1.4439 - val_accuracy: 0.6726
Confusion matrix: 
 [[653 131]
 [220  68]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.83290816 0.16709184]
 [0.76388889 0.23611111]]
Validation f1: 27.93
Validation accuracy: 67.26
Validation recall: 23.61
Validation precision: 34.17
Validation AUC: 0.30639152527833224
Validation class accuracies: [0.8329081632653061, 0.2361111111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 6 epochs
Epoch 20/80
304/304 - 428s - loss: 0.0377 - accuracy: 0.9872 - val_loss: 1.5804 - val_accuracy: 0.6912
Confusion matrix: 
 [[697  87]
 [244  44]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88903061 0.11096939]
 [0.84722222 0.15277778]]
Validation f1: 21.00
Validation accuracy: 69.12
Validation recall: 15.28
Validation precision: 33.59
Validation AUC: 0.3040467736029516
Validation class accuracies: [0.889030612244898, 0.1527777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 7 epochs
Epoch 21/80
304/304 - 428s - loss: 0.0417 - accuracy: 0.9852 - val_loss: 1.6672 - val_accuracy: 0.6950
Confusion matrix: 
 [[710  74]
 [253  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90561224 0.09438776]
 [0.87847222 0.12152778]]
Validation f1: 17.63
Validation accuracy: 69.50
Validation recall: 12.15
Validation precision: 32.11
Validation AUC: 0.3063028085945332
Validation class accuracies: [0.9056122448979592, 0.12152777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 8 epochs
Epoch 22/80
304/304 - 428s - loss: 0.0322 - accuracy: 0.9901 - val_loss: 1.5686 - val_accuracy: 0.6856
Confusion matrix: 
 [[681 103]
 [234  54]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86862245 0.13137755]
 [0.8125     0.1875    ]]
Validation f1: 24.27
Validation accuracy: 68.56
Validation recall: 18.75
Validation precision: 34.39
Validation AUC: 0.30159444954538894
Validation class accuracies: [0.8686224489795918, 0.1875]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 9 epochs
Epoch 23/80
304/304 - 427s - loss: 0.0330 - accuracy: 0.9881 - val_loss: 1.7528 - val_accuracy: 0.6968
Confusion matrix: 
 [[712  72]
 [253  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90816327 0.09183673]
 [0.87847222 0.12152778]]
Validation f1: 17.72
Validation accuracy: 69.68
Validation recall: 12.15
Validation precision: 32.71
Validation AUC: 0.3092443101061768
Validation class accuracies: [0.9081632653061225, 0.12152777777777778]
The clause is activated.
The training is defaulting to either class.
Epoch 24/80
304/304 - 428s - loss: 0.0306 - accuracy: 0.9903 - val_loss: 1.6860 - val_accuracy: 0.6856
Confusion matrix: 
 [[689  95]
 [242  46]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87882653 0.12117347]
 [0.84027778 0.15972222]]
Validation f1: 21.45
Validation accuracy: 68.56
Validation recall: 15.97
Validation precision: 32.62
Validation AUC: 0.3053061693384756
Validation class accuracies: [0.8788265306122449, 0.1597222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 10 epochs
Epoch 25/80
304/304 - 427s - loss: 0.0290 - accuracy: 0.9905 - val_loss: 1.6907 - val_accuracy: 0.6828
Confusion matrix: 
 [[680 104]
 [236  52]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86734694 0.13265306]
 [0.81944444 0.18055556]]
Validation f1: 23.42
Validation accuracy: 68.28
Validation recall: 18.06
Validation precision: 33.33
Validation AUC: 0.3023839425144278
Validation class accuracies: [0.8673469387755102, 0.18055555555555555]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 11 epochs
Epoch 26/80
304/304 - 427s - loss: 0.0357 - accuracy: 0.9858 - val_loss: 1.7056 - val_accuracy: 0.6810
Confusion matrix: 
 [[665 119]
 [223  65]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.84821429 0.15178571]
 [0.77430556 0.22569444]]
Validation f1: 27.54
Validation accuracy: 68.10
Validation recall: 22.57
Validation precision: 35.33
Validation AUC: 0.3145501647377923
Validation class accuracies: [0.8482142857142857, 0.22569444444444445]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 12 epochs
Epoch 27/80
304/304 - 427s - loss: 0.0292 - accuracy: 0.9905 - val_loss: 1.7550 - val_accuracy: 0.6940
Confusion matrix: 
 [[703  81]
 [247  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89668367 0.10331633]
 [0.85763889 0.14236111]]
Validation f1: 20.00
Validation accuracy: 69.40
Validation recall: 14.24
Validation precision: 33.61
Validation AUC: 0.3036832326889019
Validation class accuracies: [0.8966836734693877, 0.1423611111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 13 epochs
Epoch 28/80
304/304 - 427s - loss: 0.0284 - accuracy: 0.9916 - val_loss: 1.8137 - val_accuracy: 0.6940
Confusion matrix: 
 [[712  72]
 [256  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.90816327 0.09183673]
 [0.88888889 0.11111111]]
Validation f1: 16.33
Validation accuracy: 69.40
Validation recall: 11.11
Validation precision: 30.77
Validation AUC: 0.3051925517691533
Validation class accuracies: [0.9081632653061225, 0.1111111111111111]
The clause is activated.
The training is defaulting to either class.
Epoch 29/80
304/304 - 427s - loss: 0.0313 - accuracy: 0.9912 - val_loss: 1.7628 - val_accuracy: 0.6903
Confusion matrix: 
 [[705  79]
 [253  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89923469 0.10076531]
 [0.87847222 0.12152778]]
Validation f1: 17.41
Validation accuracy: 69.03
Validation recall: 12.15
Validation precision: 30.70
Validation AUC: 0.3076497060725485
Validation class accuracies: [0.8992346938775511, 0.12152777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 14 epochs
Epoch 30/80
304/304 - 428s - loss: 0.0359 - accuracy: 0.9875 - val_loss: 1.7015 - val_accuracy: 0.6782
Confusion matrix: 
 [[682 102]
 [243  45]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86989796 0.13010204]
 [0.84375    0.15625   ]]
Validation f1: 20.69
Validation accuracy: 67.82
Validation recall: 15.62
Validation precision: 30.61
Validation AUC: 0.2963005761297329
Validation class accuracies: [0.8698979591836735, 0.15625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 15 epochs
Epoch 31/80
304/304 - 427s - loss: 0.0262 - accuracy: 0.9922 - val_loss: 1.7905 - val_accuracy: 0.6866
Confusion matrix: 
 [[699  85]
 [251  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.89158163 0.10841837]
 [0.87152778 0.12847222]]
Validation f1: 18.05
Validation accuracy: 68.66
Validation recall: 12.85
Validation precision: 30.33
Validation AUC: 0.2994003078320277
Validation class accuracies: [0.8915816326530612, 0.1284722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 16 epochs
Epoch 32/80
304/304 - 427s - loss: 0.0230 - accuracy: 0.9926 - val_loss: 1.7387 - val_accuracy: 0.6884
Confusion matrix: 
 [[693  91]
 [243  45]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88392857 0.11607143]
 [0.84375    0.15625   ]]
Validation f1: 21.23
Validation accuracy: 68.84
Validation recall: 15.62
Validation precision: 33.09
Validation AUC: 0.302869932067551
Validation class accuracies: [0.8839285714285714, 0.15625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 17 epochs
Epoch 33/80
304/304 - 427s - loss: 0.0317 - accuracy: 0.9897 - val_loss: 1.7171 - val_accuracy: 0.6847
Confusion matrix: 
 [[688  96]
 [242  46]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.87755102 0.12244898]
 [0.84027778 0.15972222]]
Validation f1: 21.40
Validation accuracy: 68.47
Validation recall: 15.97
Validation precision: 32.39
Validation AUC: 0.30511979507272013
Validation class accuracies: [0.8775510204081632, 0.1597222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 18 epochs
Epoch 34/80
304/304 - 427s - loss: 0.0208 - accuracy: 0.9940 - val_loss: 1.7499 - val_accuracy: 0.6828
Confusion matrix: 
 [[689  95]
 [245  43]]
Normalized Confusion matrix: 
 [[0.87882653 0.12117347]
 [0.85069444 0.14930556]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 20.19
Validation accuracy: 68.28
Validation recall: 14.93
Validation precision: 31.16
Validation AUC: 0.30307822298081344
Validation class accuracies: [0.8788265306122449, 0.14930555555555555]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.380952380952381 hasn't increased by 0 in 19 epochs
Epoch 35/80
304/304 - 427s - loss: 0.0218 - accuracy: 0.9930 - val_loss: 1.7298 - val_accuracy: 0.6828
Confusion matrix: 
 [[682 102]
 [238  50]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86989796 0.13010204]
 [0.82638889 0.17361111]]
Validation f1: 22.73
Validation accuracy: 68.28
Validation recall: 17.36
Validation precision: 32.89
Validation AUC: 0.3071416116455731
Validation class accuracies: [0.8698979591836735, 0.1736111111111111]

The metrics for job 0 with the best target metric are: 
Best cm: [[511 273]
 [156 132]]
Best normalized cm: [[0.65178571 0.34821429]
 [0.54166667 0.45833333]]
Best f1: 0.38
Best accuracy: 0.60
Best recall: 0.46
Best precision: 0.33
Best AUC: 0.33
Best class accuracies: [0.6517857142857143, 0.4583333333333333]
Best epoch: 9
The clause is activated.
Not defaulting.
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[36 17]
 [18  4]]
F1: 0.18604651162790697
AUC: 0.30614718614718617
Accuracy: 0.5333333333333333
Precision: 0.19047619047619047
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[47  6]
 [21  1]]
F1: 0.06896551724137931
AUC: 0.23415584415584417
Accuracy: 0.64
Precision: 0.14285714285714285
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_80.xls...
Done.
Epoch: epoch5
Starting...
CM: [[48  5]
 [21  1]]
F1: 0.07142857142857144
AUC: 0.24606060606060606
Accuracy: 0.6533333333333333
Precision: 0.16666666666666666
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch5.xls...
Done.
Epoch: epoch5
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch5.xls...
Done.
Epoch: epoch5
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch5.xls...
Done.
Epoch: epoch6
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch6.xls...
Done.
Epoch: epoch6
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch6.xls...
Done.
Epoch: epoch6
Starting...
CM: [[53  0]
 [22  0]]
F1: 0.0
AUC: 0.6466666666666667
Accuracy: 0.7066666666666667
Precision: 0.0
Recall: 0.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch6.xls...
Done.
Epoch: epoch7
Starting...
CM: [[26 27]
 [13  9]]
F1: 0.31034482758620685
AUC: 0.41621212121212114
Accuracy: 0.4666666666666667
Precision: 0.25
Recall: 0.4090909090909091
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[42 11]
 [18  4]]
F1: 0.21621621621621623
AUC: 0.34424242424242424
Accuracy: 0.6133333333333333
Precision: 0.26666666666666666
Recall: 0.18181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch7.xls...
Done.
Epoch: epoch7
Starting...
CM: [[49  4]
 [21  1]]
F1: 0.07407407407407407
AUC: 0.26272727272727275
Accuracy: 0.6666666666666666
Precision: 0.2
Recall: 0.045454545454545456
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch7.xls...
Done.
Epoch: epoch9
Starting...
CM: [[ 3 50]
 [ 1 21]]
F1: 0.45161290322580644
AUC: 0.6318267178830559
Accuracy: 0.32
Precision: 0.29577464788732394
Recall: 0.9545454545454546
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch9.xls...
Done.
Epoch: epoch9
Starting...
CM: [[13 40]
 [ 4 18]]
F1: 0.45000000000000007
AUC: 0.5909299895506792
Accuracy: 0.41333333333333333
Precision: 0.3103448275862069
Recall: 0.8181818181818182
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch9.xls...
Done.
Epoch: epoch9
Starting...
CM: [[26 27]
 [ 9 13]]
F1: 0.41935483870967744
AUC: 0.5179545454545454
Accuracy: 0.52
Precision: 0.325
Recall: 0.5909090909090909
Ended. Saving the Excel Sheet ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/validation_sheet_epoch9.xls...
Done.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
wandb: Waiting for W&B process to finish, PID 2938
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210606_182153-u4fg0wl1/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210606_182153-u4fg0wl1/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99301
wandb:         val_accuracy 0.68284
wandb:             _runtime 16968
wandb:           _timestamp 1623020682
wandb:                _step 259
wandb:           train_loss 0.02176
wandb:             val_loss 1.72983
wandb:           val_recall 0.17361
wandb:        val_precision 0.32895
wandb:               val_f1 0.22727
wandb:              val_auc 0.30714
wandb:                   lr <tensorflow_addons.o...
wandb:          best_val_f1 0.38095
wandb:    best_val_accuracy 0.59981
wandb:   best_val_precision 0.32593
wandb:      best_val_recall 0.45833
wandb:             best_auc 0.32941
wandb:           best_epoch 9
wandb:           best_bd_f1 0.45161
wandb:          best_bd_auc 0.63183
wandb:     best_bd_accuracy 0.32
wandb:    best_bd_precision 0.29577
wandb:       best_bd_recall 0.95455
wandb:        best_bd_epoch epoch9
wandb: Run history:
wandb:   train_accuracy ▁▄▄▄▄▄▄▅▅▅▅▇▇▇▇████████████████████
wandb:     val_accuracy █▁██▇▇▇▇▆██▇█▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇██
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇██
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss █▆▆▆▆▆▆▅▄▅▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▅▁▁▁▁▁▁▂▃▄▃▆▅▆▆▆▅▆▇▇▇█▇▇▇███▇██▇██
wandb:       val_recall ▁█▁▁▂▂▄▂▄▁▁▂▁▃▁▂▂▃▃▂▂▂▂▂▂▃▂▂▂▂▂▂▂▂▂
wandb:    val_precision ▁▆▅▃▇▇▇▇▇▃▁▆▆▇▇▇▇█▇▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁█▁▁▄▅▇▅▇▁▁▅▂▆▃▄▄▆▆▄▄▅▄▅▅▆▄▄▄▄▄▅▅▄▅
wandb:          val_auc ▆▄██▄▇▆▆█▄▁▄▄▆▅▅▅█▅▅▅▅▆▅▅▆▅▅▆▅▅▅▅▅▆
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210606_182153-u4fg0wl1


 See logs at ../../new_cache/conv__2195__06_1810__v29__less_pneu_augm/logs/