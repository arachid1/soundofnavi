Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2152
Description:  mixednet
2021-05-19 16:08:59.884325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-19 16:09:02.261998: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-19 16:09:02.263148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-19 16:09:02.312342: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:02.313022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-19 16:09:02.313048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-19 16:09:02.316634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-19 16:09:02.316719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-19 16:09:02.317802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-19 16:09:02.318128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-19 16:09:02.319118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-19 16:09:02.319977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-19 16:09:02.320128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-19 16:09:02.320239: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:02.320940: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:02.321571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2152.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2152__05_1608__v29__mixednet/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2152
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/2nwfddud
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210519_160902-2nwfddud
wandb: Run `wandb offline` to turn off syncing.
2021-05-19 16:09:07.929952: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-19 16:09:07.930268: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:07.931323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-19 16:09:07.931388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-19 16:09:07.931471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-19 16:09:07.931497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-19 16:09:07.931542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-19 16:09:07.931569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-19 16:09:07.931596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-19 16:09:07.931623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-19 16:09:07.931649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-19 16:09:07.931780: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:07.932828: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:07.933834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-19 16:09:07.933899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-19 16:09:08.640499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-19 16:09:08.640538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-19 16:09:08.640547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-19 16:09:08.640826: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:08.641646: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:08.642342: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-19 16:09:08.643111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-05-19 16:09:44.457829: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-19 16:09:44.459606: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-19 16:09:46.032955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-19 16:09:46.795536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-19 16:09:46.804437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 8)      162       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 16)       414       
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 32)       828       
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 64)       1656      
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 128)        3402      
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 1)                 129       
=================================================================
Total params: 105,967
Trainable params: 105,471
Non-trainable params: 496
_________________________________________________________________
binary
Epoch 1/80
263/263 - 158s - loss: 0.5948 - accuracy: 0.7035 - val_loss: 0.5045 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17799753402384785
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 2/80
263/263 - 151s - loss: 0.5692 - accuracy: 0.7271 - val_loss: 0.5162 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.17921999902972707
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
column_sums: [1088    0]
cm_sum: 1088
The training is defaulting to either class.
Epoch 3/80
263/263 - 150s - loss: 0.5551 - accuracy: 0.7343 - val_loss: 0.5266 - val_accuracy: 0.7969
Confusion matrix: 
 [[866   4]
 [217   1]]
Validation f1: 0.90
Validation accuracy: 79.69
Validation recall: 0.46
Validation precision: 20.00
Validation AUC: 0.19896869914199683
Validation class accuracies: [0.9954022988505747, 0.0045871559633027525]
TARGET: 1
target metric(test f1): 0.008968609865470852
column_sums: [1083    5]
cm_sum: 1088
The training is defaulting to either class.
Epoch 4/80
263/263 - 150s - loss: 0.5407 - accuracy: 0.7421 - val_loss: 0.5744 - val_accuracy: 0.7776
Confusion matrix: 
 [[829  41]
 [201  17]]
Validation f1: 12.32
Validation accuracy: 77.76
Validation recall: 7.80
Validation precision: 29.31
Validation AUC: 0.2195375360268067
Validation class accuracies: [0.9528735632183908, 0.0779816513761468]
TARGET: 1
target metric(test f1): 0.12318840579710144
column_sums: [1030   58]
cm_sum: 1088
The training is defaulting to either class.
Epoch 5/80
263/263 - 151s - loss: 0.5213 - accuracy: 0.7533 - val_loss: 0.5552 - val_accuracy: 0.7564
Confusion matrix: 
 [[816  54]
 [211   7]]
Validation f1: 5.02
Validation accuracy: 75.64
Validation recall: 3.21
Validation precision: 11.48
Validation AUC: 0.22255855352824594
Validation class accuracies: [0.9379310344827586, 0.03211009174311927]
TARGET: 1
target metric(test f1): 0.05017921146953406
column_sums: [1027   61]
cm_sum: 1088
The training is defaulting to either class.
Epoch 6/80
263/263 - 150s - loss: 0.4946 - accuracy: 0.7672 - val_loss: 0.5743 - val_accuracy: 0.7987
Confusion matrix: 
 [[865   5]
 [214   4]]
Validation f1: 3.52
Validation accuracy: 79.87
Validation recall: 1.83
Validation precision: 44.44
Validation AUC: 0.19455429574627028
Validation class accuracies: [0.9942528735632183, 0.01834862385321101]
TARGET: 1
target metric(test f1): 0.03524229074889868
column_sums: [1079    9]
cm_sum: 1088
The training is defaulting to either class.
Epoch 7/80
263/263 - 151s - loss: 0.4574 - accuracy: 0.7939 - val_loss: 0.5689 - val_accuracy: 0.8015
Confusion matrix: 
 [[869   1]
 [215   3]]
Validation f1: 2.70
Validation accuracy: 80.15
Validation recall: 1.38
Validation precision: 75.00
Validation AUC: 0.22182504701442562
Validation class accuracies: [0.9988505747126437, 0.013761467889908258]
TARGET: 1
target metric(test f1): 0.02702702702702703
column_sums: [1084    4]
cm_sum: 1088
The training is defaulting to either class.
Epoch 8/80
263/263 - 151s - loss: 0.4130 - accuracy: 0.8112 - val_loss: 0.6385 - val_accuracy: 0.7757
Confusion matrix: 
 [[835  35]
 [209   9]]
Validation f1: 6.87
Validation accuracy: 77.57
Validation recall: 4.13
Validation precision: 20.45
Validation AUC: 0.1922739966086147
Validation class accuracies: [0.9597701149425287, 0.04128440366972477]
TARGET: 1
target metric(test f1): 0.06870229007633588
column_sums: [1044   44]
cm_sum: 1088
The training is defaulting to either class.
Epoch 9/80
263/263 - 151s - loss: 0.3601 - accuracy: 0.8477 - val_loss: 1.0404 - val_accuracy: 0.5643
Confusion matrix: 
 [[516 354]
 [120  98]]
Validation f1: 29.25
Validation accuracy: 56.43
Validation recall: 44.95
Validation precision: 21.68
Validation AUC: 0.2258135245645879
Validation class accuracies: [0.593103448275862, 0.44954128440366975]
TARGET: 1
target metric(test f1): 0.29253731343283584
column_sums: [636 452]
cm_sum: 1088
inside not defaulting
Saving model...
Epoch 10/80
263/263 - 151s - loss: 0.3184 - accuracy: 0.8687 - val_loss: 0.7794 - val_accuracy: 0.6636
Confusion matrix: 
 [[669 201]
 [165  53]]
Validation f1: 22.46
Validation accuracy: 66.36
Validation recall: 24.31
Validation precision: 20.87
Validation AUC: 0.2229403056122429
Validation class accuracies: [0.7689655172413793, 0.24311926605504589]
TARGET: 1
target metric(test f1): 0.22457627118644066
column_sums: [834 254]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 1 epochs
Epoch 11/80
263/263 - 150s - loss: 0.2650 - accuracy: 0.9016 - val_loss: 0.9276 - val_accuracy: 0.6094
Confusion matrix: 
 [[606 264]
 [161  57]]
Validation f1: 21.15
Validation accuracy: 60.94
Validation recall: 26.15
Validation precision: 17.76
Validation AUC: 0.1991621378761006
Validation class accuracies: [0.696551724137931, 0.26146788990825687]
TARGET: 1
target metric(test f1): 0.21150278293135436
column_sums: [767 321]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 2 epochs
Epoch 12/80
263/263 - 151s - loss: 0.2345 - accuracy: 0.9137 - val_loss: 0.9741 - val_accuracy: 0.6425
Confusion matrix: 
 [[658 212]
 [177  41]]
Validation f1: 17.41
Validation accuracy: 64.25
Validation recall: 18.81
Validation precision: 16.21
Validation AUC: 0.19322658321018554
Validation class accuracies: [0.7563218390804598, 0.18807339449541285]
TARGET: 1
target metric(test f1): 0.17409766454352443
column_sums: [835 253]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 3 epochs
Epoch 13/80
263/263 - 150s - loss: 0.2084 - accuracy: 0.9249 - val_loss: 0.8793 - val_accuracy: 0.6866
Confusion matrix: 
 [[699 171]
 [170  48]]
Validation f1: 21.97
Validation accuracy: 68.66
Validation recall: 22.02
Validation precision: 21.92
Validation AUC: 0.22660296115376685
Validation class accuracies: [0.803448275862069, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.21967963386727687
column_sums: [869 219]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 4 epochs
Epoch 14/80
263/263 - 150s - loss: 0.1585 - accuracy: 0.9485 - val_loss: 0.9562 - val_accuracy: 0.6268
Confusion matrix: 
 [[622 248]
 [158  60]]
Validation f1: 22.81
Validation accuracy: 62.68
Validation recall: 27.52
Validation precision: 19.48
Validation AUC: 0.2051738373978429
Validation class accuracies: [0.7149425287356321, 0.27522935779816515]
TARGET: 1
target metric(test f1): 0.2281368821292776
column_sums: [780 308]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 5 epochs
Epoch 15/80
263/263 - 151s - loss: 0.1336 - accuracy: 0.9619 - val_loss: 0.8938 - val_accuracy: 0.6875
Confusion matrix: 
 [[711 159]
 [181  37]]
Validation f1: 17.87
Validation accuracy: 68.75
Validation recall: 16.97
Validation precision: 18.88
Validation AUC: 0.2025960915350798
Validation class accuracies: [0.8172413793103448, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.178743961352657
column_sums: [892 196]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 6 epochs
Epoch 16/80
263/263 - 152s - loss: 0.1357 - accuracy: 0.9592 - val_loss: 0.9005 - val_accuracy: 0.7188
Confusion matrix: 
 [[756 114]
 [192  26]]
Validation f1: 14.53
Validation accuracy: 71.88
Validation recall: 11.93
Validation precision: 18.57
Validation AUC: 0.19933658394226128
Validation class accuracies: [0.8689655172413793, 0.11926605504587157]
TARGET: 1
target metric(test f1): 0.1452513966480447
column_sums: [948 140]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 7 epochs
Epoch 17/80
263/263 - 151s - loss: 0.1249 - accuracy: 0.9635 - val_loss: 0.9380 - val_accuracy: 0.6801
Confusion matrix: 
 [[707 163]
 [185  33]]
Validation f1: 15.94
Validation accuracy: 68.01
Validation recall: 15.14
Validation precision: 16.84
Validation AUC: 0.2029820732623122
Validation class accuracies: [0.8126436781609195, 0.15137614678899083]
TARGET: 1
target metric(test f1): 0.15942028985507248
column_sums: [892 196]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 8 epochs
Epoch 18/80
263/263 - 151s - loss: 0.1203 - accuracy: 0.9688 - val_loss: 0.9517 - val_accuracy: 0.6673
Confusion matrix: 
 [[689 181]
 [181  37]]
Validation f1: 16.97
Validation accuracy: 66.73
Validation recall: 16.97
Validation precision: 16.97
Validation AUC: 0.20150965810415017
Validation class accuracies: [0.7919540229885057, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.16972477064220184
column_sums: [870 218]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 9 epochs
Epoch 19/80
263/263 - 150s - loss: 0.1173 - accuracy: 0.9678 - val_loss: 0.9368 - val_accuracy: 0.6792
Confusion matrix: 
 [[703 167]
 [182  36]]
Validation f1: 17.10
Validation accuracy: 67.92
Validation recall: 16.51
Validation precision: 17.73
Validation AUC: 0.20193642233739442
Validation class accuracies: [0.8080459770114943, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.171021377672209
column_sums: [885 203]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 10 epochs
Epoch 20/80
263/263 - 150s - loss: 0.1166 - accuracy: 0.9647 - val_loss: 0.9408 - val_accuracy: 0.6829
Confusion matrix: 
 [[709 161]
 [184  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.46
Validation accuracy: 68.29
Validation recall: 15.60
Validation precision: 17.44
Validation AUC: 0.20147105223134795
Validation class accuracies: [0.8149425287356322, 0.1559633027522936]
TARGET: 1
target metric(test f1): 0.16464891041162227
column_sums: [893 195]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 11 epochs
Epoch 21/80
263/263 - 150s - loss: 0.1145 - accuracy: 0.9716 - val_loss: 0.9661 - val_accuracy: 0.6691
Confusion matrix: 
 [[688 182]
 [178  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 18.18
Validation accuracy: 66.91
Validation recall: 18.35
Validation precision: 18.02
Validation AUC: 0.2018077886236885
Validation class accuracies: [0.7908045977011494, 0.1834862385321101]
TARGET: 1
target metric(test f1): 0.18181818181818182
column_sums: [866 222]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 12 epochs
Epoch 22/80
263/263 - 150s - loss: 0.1096 - accuracy: 0.9714 - val_loss: 0.9535 - val_accuracy: 0.6783
Confusion matrix: 
 [[703 167]
 [183  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.67
Validation accuracy: 67.83
Validation recall: 16.06
Validation precision: 17.33
Validation AUC: 0.20170987774160345
Validation class accuracies: [0.8080459770114943, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.16666666666666669
column_sums: [886 202]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 13 epochs
Epoch 23/80
263/263 - 153s - loss: 0.1086 - accuracy: 0.9712 - val_loss: 0.9469 - val_accuracy: 0.6820
Confusion matrix: 
 [[709 161]
 [185  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.02
Validation accuracy: 68.20
Validation recall: 15.14
Validation precision: 17.01
Validation AUC: 0.20029903969411667
Validation class accuracies: [0.8149425287356322, 0.15137614678899083]
TARGET: 1
target metric(test f1): 0.16019417475728157
column_sums: [894 194]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 14 epochs
Epoch 24/80
263/263 - 150s - loss: 0.1097 - accuracy: 0.9700 - val_loss: 0.9472 - val_accuracy: 0.6857
Confusion matrix: 
 [[711 159]
 [183  35]]
Validation f1: 16.99
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 68.57
Validation recall: 16.06
Validation precision: 18.04
Validation AUC: 0.1996530163761201
Validation class accuracies: [0.8172413793103448, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.16990291262135923
column_sums: [894 194]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 15 epochs
Epoch 25/80
263/263 - 151s - loss: 0.1134 - accuracy: 0.9704 - val_loss: 0.9584 - val_accuracy: 0.6774
Confusion matrix: 
 [[700 170]
 [181  37]]
Validation f1: 17.41
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 67.74
Validation recall: 16.97
Validation precision: 17.87
Validation AUC: 0.20148617529474122
Validation class accuracies: [0.8045977011494253, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.17411764705882352
column_sums: [881 207]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 16 epochs
Epoch 26/80
263/263 - 151s - loss: 0.1069 - accuracy: 0.9716 - val_loss: 0.9515 - val_accuracy: 0.6801
Confusion matrix: 
 [[704 166]
 [182  36]]
Validation f1: 17.14
Validation accuracy: 68.01
Validation recall: 16.51
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 17.82
Validation AUC: 0.19979375646538572
Validation class accuracies: [0.8091954022988506, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.17142857142857143
column_sums: [886 202]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 17 epochs
Epoch 27/80
263/263 - 150s - loss: 0.1060 - accuracy: 0.9743 - val_loss: 0.9627 - val_accuracy: 0.6710
Confusion matrix: 
 [[692 178]
 [180  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.51
Validation accuracy: 67.10
Validation recall: 17.43
Validation precision: 17.59
Validation AUC: 0.2012522027249062
Validation class accuracies: [0.7954022988505747, 0.1743119266055046]
TARGET: 1
target metric(test f1): 0.17511520737327188
column_sums: [872 216]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 18 epochs
Epoch 28/80
263/263 - 151s - loss: 0.1070 - accuracy: 0.9752 - val_loss: 0.9558 - val_accuracy: 0.6801
Confusion matrix: 
 [[703 167]
 [181  37]]
Validation f1: 17.54
Validation accuracy: 68.01
Validation recall: 16.97
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation precision: 18.14
Validation AUC: 0.202327915082627
Validation class accuracies: [0.8080459770114943, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.17535545023696683
column_sums: [884 204]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 19 epochs
Epoch 29/80
263/263 - 150s - loss: 0.1101 - accuracy: 0.9721 - val_loss: 0.9577 - val_accuracy: 0.6783
Confusion matrix: 
 [[701 169]
 [181  37]]
Validation f1: 17.45
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation accuracy: 67.83
Validation recall: 16.97
Validation precision: 17.96
Validation AUC: 0.19974760377407658
Validation class accuracies: [0.8057471264367816, 0.16972477064220184]
TARGET: 1
target metric(test f1): 0.17452830188679247
column_sums: [882 206]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 20 epochs
Epoch 30/80
263/263 - 153s - loss: 0.1085 - accuracy: 0.9695 - val_loss: 0.9520 - val_accuracy: 0.6847
Confusion matrix: 
 [[710 160]
 [183  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.95
Validation accuracy: 68.47
Validation recall: 16.06
Validation precision: 17.95
Validation AUC: 0.20094836291636076
Validation class accuracies: [0.8160919540229885, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.16949152542372883
column_sums: [893 195]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 21 epochs
Epoch 31/80
263/263 - 150s - loss: 0.1103 - accuracy: 0.9704 - val_loss: 0.9519 - val_accuracy: 0.6829
Confusion matrix: 
 [[708 162]
 [183  35]]
Validation f1: 16.87
Validation accuracy: 68.29
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation recall: 16.06
Validation precision: 17.77
Validation AUC: 0.1999006367686943
Validation class accuracies: [0.8137931034482758, 0.16055045871559634]
TARGET: 1
target metric(test f1): 0.1686746987951807
column_sums: [891 197]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 22 epochs
Epoch 32/80
263/263 - 151s - loss: 0.1088 - accuracy: 0.9688 - val_loss: 0.9549 - val_accuracy: 0.6811
Confusion matrix: 
 [[705 165]
 [182  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.18
Validation accuracy: 68.11
Validation recall: 16.51
Validation precision: 17.91
Validation AUC: 0.1998956473208073
Validation class accuracies: [0.8103448275862069, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.17183770883054894
column_sums: [887 201]
cm_sum: 1088
inside not defaulting
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 23 epochs
Epoch 33/80
263/263 - 151s - loss: 0.1126 - accuracy: 0.9693 - val_loss: 0.9562 - val_accuracy: 0.6829
Confusion matrix: 
 [[707 163]
 [182  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 17.27
Validation accuracy: 68.29
Validation recall: 16.51
Validation precision: 18.09
Validation AUC: 0.1993203222559226
Validation class accuracies: [0.8126436781609195, 0.1651376146788991]
TARGET: 1
target metric(test f1): 0.17266187050359713
column_sums: [889 199]
cm_sum: 1088
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.29253731343283584 hasn't increased by 0 in 24 epochs
Epoch 34/80
263/263 - 151s - loss: 0.1071 - accuracy: 0.9704 - val_loss: 0.9542 - val_accuracy: 0.6765
Confusion matrix: 
 [[701 169]
 [183  35]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_plot/precision_recall_curve.py:77: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation f1: 16.59
Validation accuracy: 67.65
Validation recall: 16.06
Validation precision: 17.16
Validation AUC: 0.2007682643090854
Validation class accuracies: [0.8057471264367816, 0.16055045871559634]

The metrics for the epoch with the best target metric are: 
Best cm: [[516 354]
 [120  98]]
Best f1: 0.29253731343283584
Best accuracy: 0.5643382352941176
Best recall: 0.44954128440366975
Best precision: 0.2168141592920354
Best AUC: 0.2258135245645879
Best epoch: 9
TARGET: 1
target metric(test f1): 0.16587677725118485
column_sums: [884 204]
cm_sum: 1088
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[17 43]
 [ 7  8]]
F1: 0.2424242424242424
AUC: 0.3917647058823529
Accuracy: 0.3333333333333333
Precision: 0.1568627450980392
Recall: 0.5333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2152__05_1608__v29__mixednet/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[40 20]
 [11  4]]
F1: 0.2051282051282051
AUC: 0.29000000000000004
Accuracy: 0.5866666666666667
Precision: 0.16666666666666666
Recall: 0.26666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2152__05_1608__v29__mixednet/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[51  9]
 [13  2]]
F1: 0.15384615384615383
AUC: 0.24424242424242426
Accuracy: 0.7066666666666667
Precision: 0.18181818181818182
Recall: 0.13333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2152__05_1608__v29__mixednet/validation_sheet_80.xls...
Done.
Epoch: 9
Starting...
CM: [[ 8 52]
 [ 1 14]]
F1: 0.345679012345679
AUC: 0.5793939393939394
Accuracy: 0.29333333333333333
Precision: 0.21212121212121213
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2152__05_1608__v29__mixednet/validation_sheet_9.xls...
Done.
Epoch: 9
Starting...
CM: [[13 47]
 [ 2 13]]
F1: 0.3466666666666666
AUC: 0.555
Accuracy: 0.3466666666666667
Precision: 0.21666666666666667
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2152__05_1608__v29__mixednet/validation_sheet_9.xls...
Done.
Epoch: 9
Starting...
CM: [[28 32]
 [ 6  9]]
F1: 0.32142857142857145
AUC: 0.4497560975609756
Accuracy: 0.49333333333333335
Precision: 0.21951219512195122
Recall: 0.6
Ended. Saving the Excel Sheet ../../new_cache/conv__2152__05_1608__v29__mixednet/validation_sheet_9.xls...
Done.
wandb: Waiting for W&B process to finish, PID 24838
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210519_160902-2nwfddud/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210519_160902-2nwfddud/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.97045
wandb:         val_accuracy 0.67647
wandb:             _runtime 6168
wandb:           _timestamp 1621446710
wandb:                _step 243
wandb:           train_loss 0.10707
wandb:             val_loss 0.95415
wandb:           val_recall 0.16055
wandb:        val_precision 0.17157
wandb:               val_f1 0.16588
wandb:              val_auc 0.20077
wandb:                   lr 0.0
wandb:          best_val_f1 0.29254
wandb:    best_val_accuracy 0.56434
wandb:   best_val_precision 0.21681
wandb:      best_val_recall 0.44954
wandb:             best_auc 0.22581
wandb:           best_epoch 9
wandb:           best_bd_f1 0.34667
wandb:          best_bd_auc 0.555
wandb:     best_bd_accuracy 0.34667
wandb:    best_bd_precision 0.21667
wandb:       best_bd_recall 0.86667
wandb:        best_bd_epoch 9
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▃▃▄▅▅▆▆▇▇████████████████████
wandb:     val_accuracy ███▇▇██▇▁▄▂▃▅▃▅▆▄▄▄▅▄▄▄▅▄▄▄▄▄▅▅▄▅▄
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇██
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇██
wandb:            _step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss ██▇▇▇▇▆▅▅▄▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▁▁▂▂▂▂▃█▅▇▇▆▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:       val_recall ▁▁▁▂▂▁▁▂█▅▅▄▄▅▄▃▃▄▄▃▄▄▃▄▄▄▄▄▄▄▄▄▄▄
wandb:    val_precision ▁▁▃▄▂▅█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_f1 ▁▁▁▄▂▂▂▃█▆▆▅▆▆▅▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          val_auc ▁▁▄▇▇▃▇▃█▇▄▃█▅▅▄▅▄▄▄▄▄▄▄▄▄▄▅▄▄▄▄▄▄
wandb:               lr █████████████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 6 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2152: https://wandb.ai/arachid1/tensorboard-integration/runs/2nwfddud


 See logs at ../../new_cache/conv__2152__05_1608__v29__mixednet/logs/