Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2014
Description:  mixed_net
2021-03-31 09:05:10.695825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-31 09:05:12.845896: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-31 09:05:12.846934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-31 09:05:12.896874: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:12.897590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-31 09:05:12.897629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-31 09:05:12.901659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-31 09:05:12.901758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-31 09:05:12.903080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-31 09:05:12.903402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-31 09:05:12.904576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-31 09:05:12.905565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-31 09:05:12.905734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-31 09:05:12.905861: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:12.906607: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:12.907262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-31 09:05:12.909453: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-31 09:05:12.909625: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:12.910300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-31 09:05:12.910325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-31 09:05:12.910357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-31 09:05:12.910374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-31 09:05:12.910390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-31 09:05:12.910406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-31 09:05:12.910435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-31 09:05:12.910453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-31 09:05:12.910470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-31 09:05:12.910540: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:12.911243: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:12.911893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-31 09:05:12.911937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-31 09:05:13.664765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-31 09:05:13.664810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-31 09:05:13.664826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-31 09:05:13.665249: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:13.666286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:13.667215: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-31 09:05:13.668069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-03-31 09:05:14.602604: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-31 09:05:14.602657: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-31 09:05:14.602776: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-03-31 09:05:14.603055: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-03-31 09:05:14.604026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-03-31 09:05:14.824619: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-03-31 09:05:14.827605: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-03-31 09:05:15.184313: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-31 09:05:15.186646: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-03-31 09:05:17.145523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-31 09:05:17.640438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-31 09:05:18.069422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-31 09:05:21.960920: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-31 09:05:21.960963: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-31 09:05:22.968689: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-03-31 09:05:22.971703: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-03-31 09:05:23.019534: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 643 callback api events and 639 activity events. 
2021-03-31 09:05:23.042282: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
Tensorflow Version: 2.4.0
Num GPUs Available:  1
{"N_CLASSES": 2, "SR": 8000, "BATCH_SIZE": 16, "LR": 1e-3, "SHAPE": [128, 1250], 
"LL2_REG": 0, "WEIGHT_DECAY": 1e-4, "N_EPOCHS": 40, "FACTOR": 0.75, "PATIENCE": 3, "MIN_LR": 1e-5, "LABEL_SMOOTHING": 0,
"EPSILON": 1e-7, "ES_PATIENCE": 9, "OVERSAMPLE": 0, "MIN_DELTA": 0.01, "INITIAL_CHANNELS": 3, "CLASS_WEIGHTS": 1}
-----------------------
Using module located at /main/models/conv/train2014.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___03_0848___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mixed_net___2014/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07}
Learning Rate Parameters: {'factor': 0.75, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 9, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Model: "conv2d"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 1250, 3)]    0         
_________________________________________________________________
mix_depth_group_convolution2 (None, 128, 1250, 3)      27        
_________________________________________________________________
conv2d (Conv2D)              (None, 128, 1250, 8)      224       
_________________________________________________________________
average_pooling2d (AveragePo (None, 64, 625, 8)        0         
_________________________________________________________________
batch_normalization (BatchNo (None, 64, 625, 8)        32        
_________________________________________________________________
mix_depth_group_convolution2 (None, 64, 625, 8)        162       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 64, 625, 16)       1168      
_________________________________________________________________
average_pooling2d_1 (Average (None, 32, 313, 16)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 313, 16)       64        
_________________________________________________________________
mix_depth_group_convolution2 (None, 32, 313, 16)       414       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 313, 32)       4640      
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 157, 32)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 157, 32)       128       
_________________________________________________________________
mix_depth_group_convolution2 (None, 16, 157, 32)       828       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 157, 64)       18496     
_________________________________________________________________
average_pooling2d_3 (Average (None, 8, 79, 64)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 79, 64)         256       
_________________________________________________________________
mix_depth_group_convolution2 (None, 8, 79, 64)         1656      
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 79, 128)        73856     
_________________________________________________________________
average_pooling2d_4 (Average (None, 4, 40, 128)        0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 40, 128)        512       
_________________________________________________________________
global_average_pooling2d (Gl (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 258       
=================================================================
Total params: 102,721
Trainable params: 102,225
Non-trainable params: 496
_________________________________________________________________
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Epoch 1/40
872/872 - 340s - loss: 0.3104 - calc_accuracy: 0.6706 - val_loss: 0.4333 - val_calc_accuracy: 0.6732
Epoch 2/40
872/872 - 329s - loss: 0.2645 - calc_accuracy: 0.7222 - val_loss: 0.3624 - val_calc_accuracy: 0.7143
Epoch 3/40
872/872 - 329s - loss: 0.2475 - calc_accuracy: 0.7425 - val_loss: 0.3089 - val_calc_accuracy: 0.7697
Epoch 4/40
872/872 - 352s - loss: 0.2294 - calc_accuracy: 0.7642 - val_loss: 0.3806 - val_calc_accuracy: 0.6941
Epoch 5/40
872/872 - 324s - loss: 0.2160 - calc_accuracy: 0.7756 - val_loss: 0.3414 - val_calc_accuracy: 0.7395
Epoch 6/40
872/872 - 317s - loss: 0.2006 - calc_accuracy: 0.7959 - val_loss: 0.2928 - val_calc_accuracy: 0.7826
Epoch 7/40
872/872 - 326s - loss: 0.1863 - calc_accuracy: 0.8106 - val_loss: 0.2862 - val_calc_accuracy: 0.7918
Epoch 8/40
872/872 - 326s - loss: 0.1771 - calc_accuracy: 0.8195 - val_loss: 0.2683 - val_calc_accuracy: 0.8001
Epoch 9/40
872/872 - 331s - loss: 0.1674 - calc_accuracy: 0.8325 - val_loss: 0.2127 - val_calc_accuracy: 0.8496
Epoch 10/40
872/872 - 327s - loss: 0.1621 - calc_accuracy: 0.8338 - val_loss: 0.4310 - val_calc_accuracy: 0.6765
Epoch 11/40
872/872 - 317s - loss: 0.1560 - calc_accuracy: 0.8377 - val_loss: 0.2085 - val_calc_accuracy: 0.8557
Epoch 12/40
872/872 - 320s - loss: 0.1481 - calc_accuracy: 0.8496 - val_loss: 0.2464 - val_calc_accuracy: 0.8188
Epoch 13/40
872/872 - 325s - loss: 0.1453 - calc_accuracy: 0.8515 - val_loss: 0.4292 - val_calc_accuracy: 0.6242
Epoch 14/40
872/872 - 320s - loss: 0.1369 - calc_accuracy: 0.8639 - val_loss: 0.2612 - val_calc_accuracy: 0.8153

Epoch 00014: ReduceLROnPlateau reducing learning rate to 0.0007500000356230885.
Epoch 15/40
872/872 - 331s - loss: 0.1298 - calc_accuracy: 0.8671 - val_loss: 0.1868 - val_calc_accuracy: 0.8767
Epoch 16/40
872/872 - 316s - loss: 0.1254 - calc_accuracy: 0.8712 - val_loss: 0.2078 - val_calc_accuracy: 0.8560
Epoch 17/40
872/872 - 314s - loss: 0.1171 - calc_accuracy: 0.8810 - val_loss: 0.2220 - val_calc_accuracy: 0.8580
Epoch 18/40
872/872 - 316s - loss: 0.1135 - calc_accuracy: 0.8845 - val_loss: 0.1903 - val_calc_accuracy: 0.8755

Epoch 00018: ReduceLROnPlateau reducing learning rate to 0.0005625000048894435.
Epoch 19/40
872/872 - 316s - loss: 0.1056 - calc_accuracy: 0.8932 - val_loss: 0.2038 - val_calc_accuracy: 0.8642
Epoch 20/40
872/872 - 340s - loss: 0.1034 - calc_accuracy: 0.8942 - val_loss: 0.1996 - val_calc_accuracy: 0.8617
Epoch 21/40
872/872 - 283s - loss: 0.0989 - calc_accuracy: 0.8982 - val_loss: 0.2784 - val_calc_accuracy: 0.8190

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.0004218749818392098.
Epoch 22/40
872/872 - 288s - loss: 0.0960 - calc_accuracy: 0.9034 - val_loss: 0.2023 - val_calc_accuracy: 0.8667
Epoch 23/40
872/872 - 290s - loss: 0.0940 - calc_accuracy: 0.9038 - val_loss: 0.1804 - val_calc_accuracy: 0.8830
Epoch 24/40
872/872 - 289s - loss: 0.0921 - calc_accuracy: 0.9050 - val_loss: 0.1964 - val_calc_accuracy: 0.8747
Epoch 00024: early stopping

 See logs at ../../cache/conv___03_0848___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___mixed_net___2014/logs/