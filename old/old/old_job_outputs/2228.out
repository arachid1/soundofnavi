Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2228
Description:  pitchshifting
2021-06-16 20:38:28.952804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-16 20:38:31.203003: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 20:38:31.204009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-16 20:38:31.216860: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:31.217560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 20:38:31.217590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 20:38:31.221177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 20:38:31.221290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 20:38:31.222506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 20:38:31.222869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 20:38:31.223996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 20:38:31.224957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 20:38:31.225120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 20:38:31.225239: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:31.226036: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:31.226718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2228.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2228__06_2037__v39__pitchshifting
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 250, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-16 20:38:35.927485: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 20:38:35.927757: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:35.928463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 20:38:35.928518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 20:38:35.928602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 20:38:35.928637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 20:38:35.928670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 20:38:35.928705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 20:38:35.928737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 20:38:35.928766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 20:38:35.928795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 20:38:35.928926: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:35.929693: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:35.930343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-16 20:38:35.930395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 20:38:36.637837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-16 20:38:36.637883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-16 20:38:36.637892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-16 20:38:36.638203: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:36.639081: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:36.639785: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 20:38:36.640426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2532
-----------------------
Number of train recordings: 2532 with pneumonia: 232 and non-pneumonia: 2300
Length of training samples after audio augmentation: 3132
-----------------------
Number of train recordings: 3132 with pneumonia: 232 and non-pneumonia: 2900
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-16 20:38:37.932840: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-16 20:38:37.934779: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-16 20:38:38.298038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 20:38:40.103165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 20:38:40.561961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
196/196 - 280s - loss: 0.8743 - accuracy: 0.6114 - val_loss: 0.4116 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.07144427341431774
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
196/196 - 279s - loss: 0.5607 - accuracy: 0.6874 - val_loss: 0.2182 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.053208083497292835
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
196/196 - 279s - loss: 0.5417 - accuracy: 0.7302 - val_loss: 0.1947 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.42876547123400977
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
196/196 - 279s - loss: 0.5548 - accuracy: 0.7072 - val_loss: 1.5007 - val_accuracy: 0.2231
Confusion matrix: 
 [[107 466]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.187 0.813]
 [0.125 0.875]]
Validation f1: 10.65
Validation accuracy: 22.31
Validation recall: 87.50
Validation precision: 5.67
Validation AUC: 0.3175507543327472
Validation class accuracies: [0.18673647469458987, 0.875]
Saving model...
Epoch 5/65
196/196 - 279s - loss: 0.4966 - accuracy: 0.7197 - val_loss: 0.4736 - val_accuracy: 0.8512
Confusion matrix: 
 [[502  71]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.876 0.124]
 [0.594 0.406]]
Validation f1: 22.41
Validation accuracy: 85.12
Validation recall: 40.62
Validation precision: 15.48
Validation AUC: 0.2843870397673631
Validation class accuracies: [0.8760907504363001, 0.40625]
Saving model...
Epoch 6/65
196/196 - 278s - loss: 0.3911 - accuracy: 0.7676 - val_loss: 0.7089 - val_accuracy: 0.6529
Confusion matrix: 
 [[371 202]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.647 0.353]
 [0.25  0.75 ]]
Validation f1: 18.60
Validation accuracy: 65.29
Validation recall: 75.00
Validation precision: 10.62
Validation AUC: 0.4254991821888918
Validation class accuracies: [0.6474694589877836, 0.75]
The validation tracker metric at 0.22413793103448276 hasn't increased by 0 in 1 epochs
Epoch 7/65
196/196 - 276s - loss: 0.3384 - accuracy: 0.8132 - val_loss: 1.3186 - val_accuracy: 0.4149
Confusion matrix: 
 [[222 351]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.387 0.613]
 [0.094 0.906]]
Validation f1: 14.08
Validation accuracy: 41.49
Validation recall: 90.62
Validation precision: 7.63
Validation AUC: 0.31490674737911567
Validation class accuracies: [0.387434554973822, 0.90625]
The validation tracker metric at 0.22413793103448276 hasn't increased by 0 in 2 epochs
Epoch 8/65
196/196 - 277s - loss: 0.2659 - accuracy: 0.8608 - val_loss: 1.2993 - val_accuracy: 0.3455
Confusion matrix: 
 [[178 395]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.311 0.689]
 [0.031 0.969]]
Validation f1: 13.54
Validation accuracy: 34.55
Validation recall: 96.88
Validation precision: 7.28
Validation AUC: 0.22809159794021083
Validation class accuracies: [0.3106457242582897, 0.96875]
The validation tracker metric at 0.22413793103448276 hasn't increased by 0 in 3 epochs
Epoch 9/65
196/196 - 276s - loss: 0.2732 - accuracy: 0.8611 - val_loss: 1.2410 - val_accuracy: 0.5884
Confusion matrix: 
 [[326 247]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.569 0.431]
 [0.062 0.938]]
Validation f1: 19.42
Validation accuracy: 58.84
Validation recall: 93.75
Validation precision: 10.83
Validation AUC: 0.41439465577540846
Validation class accuracies: [0.568935427574171, 0.9375]
The validation tracker metric at 0.22413793103448276 hasn't increased by 0 in 4 epochs
Epoch 10/65
196/196 - 277s - loss: 0.2922 - accuracy: 0.8653 - val_loss: 0.6758 - val_accuracy: 0.8298
Confusion matrix: 
 [[480  93]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.838 0.162]
 [0.312 0.688]]
Validation f1: 29.93
Validation accuracy: 82.98
Validation recall: 68.75
Validation precision: 19.13
Validation AUC: 0.45273382247965366
Validation class accuracies: [0.837696335078534, 0.6875]
Saving model...
Epoch 11/65
196/196 - 277s - loss: 0.1720 - accuracy: 0.9205 - val_loss: 0.5425 - val_accuracy: 0.8959
Confusion matrix: 
 [[529  44]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.594 0.406]]
Validation f1: 29.21
Validation accuracy: 89.59
Validation recall: 40.62
Validation precision: 22.81
Validation AUC: 0.2837524328146602
Validation class accuracies: [0.9232111692844677, 0.40625]
The validation tracker metric at 0.2993197278911565 hasn't increased by 0 in 1 epochs
Epoch 12/65
196/196 - 277s - loss: 0.1930 - accuracy: 0.9061 - val_loss: 0.2688 - val_accuracy: 0.9570
Confusion matrix: 
 [[572   1]
 [ 25   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.781 0.219]]
Validation f1: 35.00
Validation accuracy: 95.70
Validation recall: 21.88
Validation precision: 87.50
Validation AUC: 0.39602952738512087
Validation class accuracies: [0.9982547993019197, 0.21875]
Saving model...
Epoch 13/65
196/196 - 278s - loss: 0.1213 - accuracy: 0.9413 - val_loss: 5.3491 - val_accuracy: 0.2215
Confusion matrix: 
 [[102 471]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.178 0.822]
 [0.    1.   ]]
Validation f1: 11.96
Validation accuracy: 22.15
Validation recall: 100.00
Validation precision: 6.36
Validation AUC: 0.4170919755313634
Validation class accuracies: [0.17801047120418848, 1.0]
The validation tracker metric at 0.35 hasn't increased by 0 in 1 epochs
Epoch 14/65
196/196 - 276s - loss: 0.0882 - accuracy: 0.9601 - val_loss: 0.3828 - val_accuracy: 0.8529
Confusion matrix: 
 [[494  79]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.862 0.138]
 [0.312 0.688]]
Validation f1: 33.08
Validation accuracy: 85.29
Validation recall: 68.75
Validation precision: 21.78
Validation AUC: 0.4643602970406685
Validation class accuracies: [0.8621291448516579, 0.6875]
The validation tracker metric at 0.35 hasn't increased by 0 in 2 epochs
Epoch 15/65
196/196 - 277s - loss: 0.0725 - accuracy: 0.9652 - val_loss: 1.3900 - val_accuracy: 0.8347
Confusion matrix: 
 [[488  85]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.852 0.148]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 25.37
Validation accuracy: 83.47
Validation recall: 53.12
Validation precision: 16.67
Validation AUC: 0.12682091954148433
Validation class accuracies: [0.8516579406631762, 0.53125]
The validation tracker metric at 0.35 hasn't increased by 0 in 3 epochs
Epoch 16/65
196/196 - 276s - loss: 0.1049 - accuracy: 0.9553 - val_loss: 0.3809 - val_accuracy: 0.9471
Confusion matrix: 
 [[560  13]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.594 0.406]]
Validation f1: 44.83
Validation accuracy: 94.71
Validation recall: 40.62
Validation precision: 50.00
Validation AUC: 0.2901065787992078
Validation class accuracies: [0.9773123909249564, 0.40625]
Saving model...
Epoch 17/65
196/196 - 277s - loss: 0.1751 - accuracy: 0.9333 - val_loss: 0.4432 - val_accuracy: 0.9091
Confusion matrix: 
 [[536  37]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.562 0.438]]
Validation f1: 33.73
Validation accuracy: 90.91
Validation recall: 43.75
Validation precision: 27.45
Validation AUC: 0.20611788624492908
Validation class accuracies: [0.9354275741710296, 0.4375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 1 epochs
Epoch 18/65
196/196 - 277s - loss: 0.0501 - accuracy: 0.9770 - val_loss: 0.4246 - val_accuracy: 0.8992
Confusion matrix: 
 [[527  46]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.469 0.531]]
Validation f1: 35.79
Validation accuracy: 89.92
Validation recall: 53.12
Validation precision: 26.98
Validation AUC: 0.33566667687432056
Validation class accuracies: [0.9197207678883071, 0.53125]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 2 epochs
Epoch 19/65
196/196 - 277s - loss: 0.0274 - accuracy: 0.9879 - val_loss: 0.2455 - val_accuracy: 0.9537
Confusion matrix: 
 [[566   7]
 [ 21  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.656 0.344]]
Validation f1: 44.00
Validation accuracy: 95.37
Validation recall: 34.38
Validation precision: 61.11
Validation AUC: 0.5123430111449784
Validation class accuracies: [0.987783595113438, 0.34375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 3 epochs
Epoch 20/65
196/196 - 277s - loss: 0.0985 - accuracy: 0.9620 - val_loss: 2.5678 - val_accuracy: 0.4298
Confusion matrix: 
 [[231 342]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.403 0.597]
 [0.094 0.906]]
Validation f1: 14.39
Validation accuracy: 42.98
Validation recall: 90.62
Validation precision: 7.82
Validation AUC: 0.29097685870599793
Validation class accuracies: [0.4031413612565445, 0.90625]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 4 epochs
Epoch 21/65
196/196 - 277s - loss: 0.0346 - accuracy: 0.9831 - val_loss: 0.3058 - val_accuracy: 0.9339
Confusion matrix: 
 [[553  20]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.625 0.375]]
Validation f1: 37.50
Validation accuracy: 93.39
Validation recall: 37.50
Validation precision: 37.50
Validation AUC: 0.36268497271254685
Validation class accuracies: [0.9650959860383944, 0.375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 5 epochs
Epoch 22/65
196/196 - 277s - loss: 0.0407 - accuracy: 0.9853 - val_loss: 3.7173 - val_accuracy: 0.2711
Confusion matrix: 
 [[134 439]
 [  2  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.234 0.766]
 [0.062 0.938]]
Validation f1: 11.98
Validation accuracy: 27.11
Validation recall: 93.75
Validation precision: 6.40
Validation AUC: 0.22765781510801744
Validation class accuracies: [0.2338568935427574, 0.9375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 23/65
196/196 - 277s - loss: 0.0688 - accuracy: 0.9716 - val_loss: 0.8225 - val_accuracy: 0.8694
Confusion matrix: 
 [[508  65]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.438 0.562]]
Validation f1: 31.30
Validation accuracy: 86.94
Validation recall: 56.25
Validation precision: 21.69
Validation AUC: 0.20226910036904522
Validation class accuracies: [0.8865619546247818, 0.5625]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 7 epochs
Epoch 24/65
196/196 - 277s - loss: 0.0194 - accuracy: 0.9939 - val_loss: 0.7751 - val_accuracy: 0.8628
Confusion matrix: 
 [[508  65]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.562 0.438]]
Validation f1: 25.23
Validation accuracy: 86.28
Validation recall: 43.75
Validation precision: 17.72
Validation AUC: 0.17076219106729107
Validation class accuracies: [0.8865619546247818, 0.4375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 8 epochs
Epoch 25/65
196/196 - 277s - loss: 0.0130 - accuracy: 0.9962 - val_loss: 0.6350 - val_accuracy: 0.8843
Confusion matrix: 
 [[519  54]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.906 0.094]
 [0.5   0.5  ]]
Validation f1: 31.37
Validation accuracy: 88.43
Validation recall: 50.00
Validation precision: 22.86
Validation AUC: 0.2878907356838503
Validation class accuracies: [0.9057591623036649, 0.5]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 9 epochs
Epoch 26/65
196/196 - 277s - loss: 0.0181 - accuracy: 0.9939 - val_loss: 0.6251 - val_accuracy: 0.8942
Confusion matrix: 
 [[529  44]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.625 0.375]]
Validation f1: 27.27
Validation accuracy: 89.42
Validation recall: 37.50
Validation precision: 21.43
Validation AUC: 0.1762452973311972
Validation class accuracies: [0.9232111692844677, 0.375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 10 epochs
Epoch 27/65
196/196 - 277s - loss: 0.0113 - accuracy: 0.9981 - val_loss: 0.4595 - val_accuracy: 0.9190
Confusion matrix: 
 [[540  33]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.5   0.5  ]]
Validation f1: 39.51
Validation accuracy: 91.90
Validation recall: 50.00
Validation precision: 32.65
Validation AUC: 0.3260378909112303
Validation class accuracies: [0.9424083769633508, 0.5]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 11 epochs
Epoch 28/65
196/196 - 277s - loss: 0.0106 - accuracy: 0.9974 - val_loss: 0.4643 - val_accuracy: 0.9058
Confusion matrix: 
 [[533  40]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.531 0.469]]
Validation f1: 34.48
Validation accuracy: 90.58
Validation recall: 46.88
Validation precision: 27.27
Validation AUC: 0.2903650517773757
Validation class accuracies: [0.9301919720767888, 0.46875]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 29/65
196/196 - 276s - loss: 0.0075 - accuracy: 0.9974 - val_loss: 0.5708 - val_accuracy: 0.8975
Confusion matrix: 
 [[530  43]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.594 0.406]]
Validation f1: 29.55
Validation accuracy: 89.75
Validation recall: 40.62
Validation precision: 23.21
Validation AUC: 0.196050629087729
Validation class accuracies: [0.924956369982548, 0.40625]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 13 epochs
Epoch 30/65
196/196 - 277s - loss: 0.0048 - accuracy: 0.9997 - val_loss: 0.5309 - val_accuracy: 0.9041
Confusion matrix: 
 [[532  41]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.531 0.469]]
Validation f1: 34.09
Validation accuracy: 90.41
Validation recall: 46.88
Validation precision: 26.79
Validation AUC: 0.23500841548872442
Validation class accuracies: [0.9284467713787086, 0.46875]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 14 epochs
Epoch 31/65
196/196 - 276s - loss: 0.0047 - accuracy: 0.9984 - val_loss: 0.5852 - val_accuracy: 0.8876
Confusion matrix: 
 [[522  51]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.531 0.469]]
Validation f1: 30.61
Validation accuracy: 88.76
Validation recall: 46.88
Validation precision: 22.73
Validation AUC: 0.22360222813214956
Validation class accuracies: [0.9109947643979057, 0.46875]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 15 epochs
Epoch 32/65
196/196 - 277s - loss: 0.0126 - accuracy: 0.9968 - val_loss: 0.4747 - val_accuracy: 0.9058
Confusion matrix: 
 [[535  38]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.594 0.406]]
Validation f1: 31.33
Validation accuracy: 90.58
Validation recall: 40.62
Validation precision: 25.49
Validation AUC: 0.24366531941414948
Validation class accuracies: [0.9336823734729494, 0.40625]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 16 epochs
Epoch 33/65
196/196 - 277s - loss: 0.0058 - accuracy: 0.9990 - val_loss: 0.5037 - val_accuracy: 0.9008
Confusion matrix: 
 [[528  45]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.469 0.531]]
Validation f1: 36.17
Validation accuracy: 90.08
Validation recall: 53.12
Validation precision: 27.42
Validation AUC: 0.28722245821870496
Validation class accuracies: [0.9214659685863874, 0.53125]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 17 epochs
Epoch 34/65
196/196 - 277s - loss: 0.0109 - accuracy: 0.9965 - val_loss: 0.3779 - val_accuracy: 0.9273
Confusion matrix: 
 [[547  26]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.562 0.438]]
Validation f1: 38.89
Validation accuracy: 92.73
Validation recall: 43.75
Validation precision: 35.00
Validation AUC: 0.32431830122969957
Validation class accuracies: [0.9546247818499127, 0.4375]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 35/65
196/196 - 277s - loss: 0.0040 - accuracy: 0.9987 - val_loss: 0.4079 - val_accuracy: 0.9140
Confusion matrix: 
 [[538  35]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 36.59
Validation accuracy: 91.40
Validation recall: 46.88
Validation precision: 30.00
Validation AUC: 0.3044960737926406
Validation class accuracies: [0.9389179755671903, 0.46875]
The validation tracker metric at 0.4482758620689655 hasn't increased by 0 in 19 epochs
Epoch 36/65
196/196 - 277s - loss: 0.0050 - accuracy: 0.9994 - val_loss: 0.4584 - val_accuracy: 0.9058
Confusion matrix: 
 [[531  42]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.469 0.531]]
Validation f1: 37.36
Validation accuracy: 90.58
Validation recall: 53.12
Validation precision: 28.81
Validation AUC: 0.3130567398488619
Validation class accuracies: [0.9267015706806283, 0.53125]

The metrics for job 0 with the best target metric are: 
Best cm: [[560  13]
 [ 19  13]]
Best normalized cm: [[0.977 0.023]
 [0.594 0.406]]
Best f1: 0.45
Best accuracy: 0.95
Best recall: 0.41
Best precision: 0.50
Best AUC: 0.29
Best class accuracies: [0.9773123909249564, 0.40625]
Best epoch: 16
The number of epochs since last 1% equals the patience
wandb: Waiting for W&B process to finish, PID 24043
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_203831-2tdtij7f/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_203831-2tdtij7f/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99936
wandb:         val_accuracy 0.90579
wandb:             _runtime 10477
wandb:           _timestamp 1623886389
wandb:                _step 266
wandb:           train_loss 0.00498
wandb:             val_loss 0.45839
wandb:           val_recall 0.53125
wandb:        val_precision 0.28814
wandb:               val_f1 0.37363
wandb:              val_auc 0.31306
wandb:                   lr 0.00013
wandb:          best_val_f1 0.44828
wandb:    best_val_accuracy 0.94711
wandb:   best_val_precision 0.5
wandb:      best_val_recall 0.40625
wandb:             best_auc 0.29011
wandb:           best_epoch 16
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_203831-2tdtij7f


 See logs at ../../new_cache/conv__2228__06_2037__v39__pitchshifting/logs/