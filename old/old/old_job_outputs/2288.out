Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2288
Description:  augmix
2021-07-06 03:22:03.434762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-07-06 03:22:05.677417: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 03:22:05.678377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-07-06 03:22:05.727198: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:22:05.727913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 03:22:05.727953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 03:22:05.731123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 03:22:05.731218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 03:22:05.732225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 03:22:05.732514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 03:22:05.733434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 03:22:05.734244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 03:22:05.734405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 03:22:05.734517: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:22:05.735242: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:22:05.735983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2288.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2288__07_0321__v39__augmix
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.25, 'PATIENCE': 5, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'JORDAN_DATASET': 1, 'PNEUMONIA_ONLY': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 0, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 1000, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 158, 'TIME_MASKING': 0, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-07-06 03:29:38.984430: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-06 03:29:38.984903: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:29:38.985677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-07-06 03:29:38.985753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 03:29:38.985824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 03:29:38.985847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-07-06 03:29:38.985867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-06 03:29:38.985888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-06 03:29:38.985907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-06 03:29:38.985928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-07-06 03:29:38.985948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 03:29:38.986049: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:29:38.986786: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:29:38.987434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-06 03:29:38.987501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-07-06 03:29:39.687096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-06 03:29:39.687142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-07-06 03:29:39.687151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-07-06 03:29:39.687429: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:29:39.688218: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:29:39.688938: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-06 03:29:39.689589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-07-06 03:29:40.747423: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-07-06 03:29:40.749854: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-07-06 03:29:41.080575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-07-06 03:29:43.238449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-07-06 03:29:43.687490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_1
Length of training samples after augmix augmentation: 3016
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_1 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d (Conv2D)                                  (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D)             (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization (BatchNormalization)         (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAveragePooling2D (None, 128)                                 0                
______________________________________________________________________________________________________________
dense (Dense)                                    (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
189/189 - 80s - loss: 0.2998 - accuracy: 0.9022 - val_loss: 0.2455 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06186168778677259
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
189/189 - 75s - loss: 0.1223 - accuracy: 0.9592 - val_loss: 0.2551 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.4450435642357531
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
189/189 - 76s - loss: 0.0818 - accuracy: 0.9731 - val_loss: 0.2160 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6472156313764604
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
189/189 - 74s - loss: 0.0616 - accuracy: 0.9791 - val_loss: 0.1621 - val_accuracy: 0.9528
Confusion matrix: 
 [[562  11]
 [ 18  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.439 0.561]]
Validation f1: 61.33
Validation accuracy: 95.28
Validation recall: 56.10
Validation precision: 67.65
Validation AUC: 0.6513818187890364
Validation class accuracies: [0.9808027923211169, 0.5609756097560976]
Saving model...
Epoch 5/65
189/189 - 74s - loss: 0.0442 - accuracy: 0.9854 - val_loss: 0.2313 - val_accuracy: 0.9430
Confusion matrix: 
 [[572   1]
 [ 34   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.829 0.171]]
Validation f1: 28.57
Validation accuracy: 94.30
Validation recall: 17.07
Validation precision: 87.50
Validation AUC: 0.6154649200177352
Validation class accuracies: [0.9982547993019197, 0.17073170731707318]
The validation tracker metric at 0.6133333333333334 hasn't increased by 0 in 1 epochs
Epoch 6/65
189/189 - 79s - loss: 0.0315 - accuracy: 0.9884 - val_loss: 0.4880 - val_accuracy: 0.8844
Confusion matrix: 
 [[513  60]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.268 0.732]]
Validation f1: 45.80
Validation accuracy: 88.44
Validation recall: 73.17
Validation precision: 33.33
Validation AUC: 0.5607713105984449
Validation class accuracies: [0.8952879581151832, 0.7317073170731707]
The validation tracker metric at 0.6133333333333334 hasn't increased by 0 in 2 epochs
Epoch 7/65
189/189 - 79s - loss: 0.0270 - accuracy: 0.9920 - val_loss: 0.2941 - val_accuracy: 0.9283
Confusion matrix: 
 [[543  30]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.341 0.659]]
Validation f1: 55.10
Validation accuracy: 92.83
Validation recall: 65.85
Validation precision: 47.37
Validation AUC: 0.5859824635316421
Validation class accuracies: [0.9476439790575916, 0.6585365853658537]
The validation tracker metric at 0.6133333333333334 hasn't increased by 0 in 3 epochs
Epoch 8/65
189/189 - 78s - loss: 0.0170 - accuracy: 0.9964 - val_loss: 0.3448 - val_accuracy: 0.9218
Confusion matrix: 
 [[538  35]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.317 0.683]]
Validation f1: 53.85
Validation accuracy: 92.18
Validation recall: 68.29
Validation precision: 44.44
Validation AUC: 0.608180588033995
Validation class accuracies: [0.9389179755671903, 0.6829268292682927]
The validation tracker metric at 0.6133333333333334 hasn't increased by 0 in 4 epochs
Epoch 9/65
189/189 - 79s - loss: 0.0146 - accuracy: 0.9970 - val_loss: 0.2475 - val_accuracy: 0.9495
Confusion matrix: 
 [[556  17]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.341 0.659]]
Validation f1: 63.53
Validation accuracy: 94.95
Validation recall: 65.85
Validation precision: 61.36
Validation AUC: 0.6178198525116502
Validation class accuracies: [0.9703315881326352, 0.6585365853658537]
Saving model...
Epoch 10/65
189/189 - 76s - loss: 0.0094 - accuracy: 0.9990 - val_loss: 0.4096 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.625342409846456
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 1 epochs
Epoch 11/65
189/189 - 78s - loss: 0.0072 - accuracy: 0.9993 - val_loss: 0.3385 - val_accuracy: 0.9332
Confusion matrix: 
 [[543  30]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.268 0.732]]
Validation f1: 59.41
Validation accuracy: 93.32
Validation recall: 73.17
Validation precision: 50.00
Validation AUC: 0.6634827978963476
Validation class accuracies: [0.9476439790575916, 0.7317073170731707]
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 2 epochs
Epoch 12/65
189/189 - 78s - loss: 0.0043 - accuracy: 1.0000 - val_loss: 0.3072 - val_accuracy: 0.9414
Confusion matrix: 
 [[551  22]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.341 0.659]]
Validation f1: 60.00
Validation accuracy: 94.14
Validation recall: 65.85
Validation precision: 55.10
Validation AUC: 0.5929112054876954
Validation class accuracies: [0.9616055846422339, 0.6585365853658537]
The validation tracker metric at 0.6352941176470588 hasn't increased by 0 in 3 epochs
Epoch 13/65
189/189 - 77s - loss: 0.0041 - accuracy: 0.9997 - val_loss: 0.2778 - val_accuracy: 0.9511
Confusion matrix: 
 [[557  16]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.341 0.659]]
Validation f1: 64.29
Validation accuracy: 95.11
Validation recall: 65.85
Validation precision: 62.79
Validation AUC: 0.6212171725426275
Validation class accuracies: [0.9720767888307156, 0.6585365853658537]
Saving model...
Epoch 14/65
189/189 - 78s - loss: 0.0076 - accuracy: 0.9980 - val_loss: 0.4862 - val_accuracy: 0.9137
Confusion matrix: 
 [[531  42]
 [ 11  30]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.927 0.073]
 [0.268 0.732]]
Validation f1: 53.10
Validation accuracy: 91.37
Validation recall: 73.17
Validation precision: 41.67
Validation AUC: 0.6513391937462838
Validation class accuracies: [0.9267015706806283, 0.7317073170731707]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 1 epochs
Epoch 15/65
189/189 - 79s - loss: 0.0054 - accuracy: 0.9993 - val_loss: 0.4190 - val_accuracy: 0.9235
Confusion matrix: 
 [[539  34]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.317 0.683]]
Validation f1: 54.37
Validation accuracy: 92.35
Validation recall: 68.29
Validation precision: 45.16
Validation AUC: 0.581831979951712
Validation class accuracies: [0.9406631762652705, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 2 epochs
Epoch 16/65
189/189 - 77s - loss: 0.0027 - accuracy: 1.0000 - val_loss: 0.4386 - val_accuracy: 0.9235
Confusion matrix: 
 [[540  33]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.341 0.659]]
Validation f1: 53.47
Validation accuracy: 92.35
Validation recall: 65.85
Validation precision: 45.00
Validation AUC: 0.5927407253688274
Validation class accuracies: [0.9424083769633508, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 3 epochs
Epoch 17/65
189/189 - 78s - loss: 0.0025 - accuracy: 1.0000 - val_loss: 0.4056 - val_accuracy: 0.9300
Confusion matrix: 
 [[544  29]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.341 0.659]]
Validation f1: 55.67
Validation accuracy: 93.00
Validation recall: 65.85
Validation precision: 48.21
Validation AUC: 0.585340172936009
Validation class accuracies: [0.9493891797556719, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 4 epochs
Epoch 18/65
189/189 - 78s - loss: 0.0040 - accuracy: 0.9997 - val_loss: 0.6288 - val_accuracy: 0.9023
Confusion matrix: 
 [[525  48]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.293 0.707]]
Validation f1: 49.15
Validation accuracy: 90.23
Validation recall: 70.73
Validation precision: 37.66
Validation AUC: 0.618406613759213
Validation class accuracies: [0.9162303664921466, 0.7073170731707317]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
189/189 - 77s - loss: 0.0024 - accuracy: 1.0000 - val_loss: 0.4232 - val_accuracy: 0.9300
Confusion matrix: 
 [[543  30]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.317 0.683]]
Validation f1: 56.57
Validation accuracy: 93.00
Validation recall: 68.29
Validation precision: 48.28
Validation AUC: 0.6182197471999189
Validation class accuracies: [0.9476439790575916, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 6 epochs
Epoch 20/65
189/189 - 79s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3928 - val_accuracy: 0.9300
Confusion matrix: 
 [[543  30]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.57
Validation accuracy: 93.00
Validation recall: 68.29
Validation precision: 48.28
Validation AUC: 0.6258365165141171
Validation class accuracies: [0.9476439790575916, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 7 epochs
Epoch 21/65
189/189 - 78s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.4403 - val_accuracy: 0.9300
Confusion matrix: 
 [[543  30]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.57
Validation accuracy: 93.00
Validation recall: 68.29
Validation precision: 48.28
Validation AUC: 0.6029007091829217
Validation class accuracies: [0.9476439790575916, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 8 epochs
Epoch 22/65
189/189 - 77s - loss: 0.0027 - accuracy: 0.9993 - val_loss: 0.3867 - val_accuracy: 0.9349
Confusion matrix: 
 [[546  27]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.317 0.683]]
Validation f1: 58.33
Validation accuracy: 93.49
Validation recall: 68.29
Validation precision: 50.91
Validation AUC: 0.621002182974559
Validation class accuracies: [0.9528795811518325, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 9 epochs
Epoch 23/65
189/189 - 78s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.4300 - val_accuracy: 0.9349
Confusion matrix: 
 [[546  27]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.33
Validation accuracy: 93.49
Validation recall: 68.29
Validation precision: 50.91
Validation AUC: 0.5973381422542957
Validation class accuracies: [0.9528795811518325, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 24/65
189/189 - 79s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.4260 - val_accuracy: 0.9349
Confusion matrix: 
 [[546  27]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 58.33
Validation accuracy: 93.49
Validation recall: 68.29
Validation precision: 50.91
Validation AUC: 0.6017060597358679
Validation class accuracies: [0.9528795811518325, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 11 epochs
Epoch 25/65
189/189 - 77s - loss: 0.0011 - accuracy: 1.0000 - val_loss: 0.4210 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6022626698873972
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 12 epochs
Epoch 26/65
189/189 - 79s - loss: 0.0016 - accuracy: 0.9997 - val_loss: 0.4162 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
Validation f1: 56.84
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6103543337832038
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 13 epochs
Epoch 27/65
189/189 - 78s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.4153 - val_accuracy: 0.9332
Confusion matrix: 
 [[546  27]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.84
Validation accuracy: 93.32
Validation recall: 65.85
Validation precision: 50.00
Validation AUC: 0.6135922504862602
Validation class accuracies: [0.9528795811518325, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 14 epochs
Epoch 28/65
189/189 - 77s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.4212 - val_accuracy: 0.9332
Confusion matrix: 
 [[545  28]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.317 0.683]]
Validation f1: 57.73
Validation accuracy: 93.32
Validation recall: 68.29
Validation precision: 50.00
Validation AUC: 0.6041428653594646
Validation class accuracies: [0.9511343804537522, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 29/65
189/189 - 79s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.4199 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.6031919545235243
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 16 epochs
Epoch 30/65
189/189 - 78s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.4282 - val_accuracy: 0.9316
Confusion matrix: 
 [[544  29]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.14
Validation accuracy: 93.16
Validation recall: 68.29
Validation precision: 49.12
Validation AUC: 0.5915662651595919
Validation class accuracies: [0.9493891797556719, 0.6829268292682927]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 17 epochs
Epoch 31/65
189/189 - 77s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.4204 - val_accuracy: 0.9316
Confusion matrix: 
 [[545  28]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.341 0.659]]
Validation f1: 56.25
Validation accuracy: 93.16
Validation recall: 65.85
Validation precision: 49.09
Validation AUC: 0.6072288456801185
Validation class accuracies: [0.9511343804537522, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 18 epochs
Epoch 32/65
189/189 - 78s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.4080 - val_accuracy: 0.9316
Confusion matrix: 
 [[545  28]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.341 0.659]]
Validation f1: 56.25
Validation accuracy: 93.16
Validation recall: 65.85
Validation precision: 49.09
Validation AUC: 0.6082177728217016
Validation class accuracies: [0.9511343804537522, 0.6585365853658537]
The validation tracker metric at 0.6428571428571429 hasn't increased by 0 in 19 epochs
Epoch 33/65
189/189 - 79s - loss: 0.0029 - accuracy: 0.9990 - val_loss: 0.4217 - val_accuracy: 0.9316
Confusion matrix: 
 [[545  28]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.25
Validation accuracy: 93.16
Validation recall: 65.85
Validation precision: 49.09
Validation AUC: 0.6066311647267629
Validation class accuracies: [0.9511343804537522, 0.6585365853658537]

The metrics for job 0 with the best target metric are: 
Best cm: [[557  16]
 [ 14  27]]
Best normalized cm: [[0.972 0.028]
 [0.341 0.659]]
Best f1: 0.64
Best accuracy: 0.95
Best recall: 0.66
Best precision: 0.63
Best AUC: 0.62
Best class accuracies: [0.9720767888307156, 0.6585365853658537]
Best epoch: 13
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p2_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.656e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.008]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Pr_mc_LittC2SE_3_label_0_pred_0.png, [[0.017]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p5_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_1_label_0_pred_0.png, [[3.735e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1p1_Pr_sc_Litt3200_0_label_0_pred_0.png, [[0.218]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_3_label_0_pred_0.png, [[0.035]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[9.693e-08]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[5.966e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_222_1b1_Pr_sc_Meditron_3_label_0_pred_0.png, [[2.208e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_3_label_0_pred_0.png, [[0.01]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b1_Ar_mc_LittC2SE_1_label_0_pred_1.png, [[1.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_203_2p3_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[6.312e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_211_1p2_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[2.014e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_211_1p2_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_2p2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[9.903e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_223_1b1_Pr_sc_Meditron_0_label_0_pred_0.png, [[0.015]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_0_label_0_pred_0.png, [[2.291e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[2.243e-07]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_214_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_5_label_0_pred_0.png, [[3.181e-07]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_216_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_12_label_0_pred_0.png, [[5.464e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p2_Pr_mc_AKGC417L_2_label_0_pred_0.png, [[2.302e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_2b5_Al_mc_AKGC417L_0_label_0_pred_0.png, [[8.846e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_4b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_215_1b2_Ar_sc_Meditron_2_label_0_pred_0.png, [[2.011e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_220_1b1_Tc_mc_LittC2SE_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b4_Al_mc_AKGC417L_2_label_0_pred_0.png, [[6.372e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p2_Al_mc_AKGC417L_2_label_0_pred_0.png, [[1.852e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[3.949e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_8_label_0_pred_0.png, [[6.864e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b4_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[1.846e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_226_1b1_Pl_sc_LittC2SE_1_label_1_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b1_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.302]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 28518
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_032205-3bz6w3io/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_032205-3bz6w3io/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.99901
wandb:         val_accuracy 0.9316
wandb:             _runtime 3367
wandb:           _timestamp 1625545093
wandb:                _step 239
wandb:           train_loss 0.0029
wandb:             val_loss 0.42174
wandb:           val_recall 0.65854
wandb:        val_precision 0.49091
wandb:               val_f1 0.5625
wandb:              val_auc 0.60663
wandb:                   lr 2e-05
wandb:          best_val_f1 0.64286
wandb:    best_val_accuracy 0.95114
wandb:   best_val_precision 0.62791
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.62122
wandb:           best_epoch 13
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_032205-3bz6w3io

-----------------------
158/800
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_2
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_3
Length of training samples after augmix augmentation: 3416
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_5 (MixDepthGroupCo (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_6 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_7 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_8 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_9 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
214/214 - 87s - loss: 0.2926 - accuracy: 0.9054 - val_loss: 0.2452 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06340113923149765
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
214/214 - 88s - loss: 0.1177 - accuracy: 0.9634 - val_loss: 0.2432 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.1612721117909793
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
214/214 - 85s - loss: 0.0793 - accuracy: 0.9719 - val_loss: 0.1368 - val_accuracy: 0.9577
Confusion matrix: 
 [[570   3]
 [ 23  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.561 0.439]]
Validation f1: 58.06
Validation accuracy: 95.77
Validation recall: 43.90
Validation precision: 85.71
Validation AUC: 0.6425409916561501
Validation class accuracies: [0.9947643979057592, 0.43902439024390244]
Saving model...
Epoch 4/65
214/214 - 87s - loss: 0.0561 - accuracy: 0.9816 - val_loss: 0.1700 - val_accuracy: 0.9430
Confusion matrix: 
 [[551  22]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.317 0.683]]
Validation f1: 61.54
Validation accuracy: 94.30
Validation recall: 68.29
Validation precision: 56.00
Validation AUC: 0.7352430883297014
Validation class accuracies: [0.9616055846422339, 0.6829268292682927]
Saving model...
Epoch 5/65
214/214 - 84s - loss: 0.0366 - accuracy: 0.9883 - val_loss: 0.3248 - val_accuracy: 0.8811
Confusion matrix: 
 [[509  64]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.22  0.78 ]]
Validation f1: 46.72
Validation accuracy: 88.11
Validation recall: 78.05
Validation precision: 33.33
Validation AUC: 0.6773303684127968
Validation class accuracies: [0.8883071553228621, 0.7804878048780488]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 1 epochs
Epoch 6/65
214/214 - 86s - loss: 0.0221 - accuracy: 0.9953 - val_loss: 0.2103 - val_accuracy: 0.9511
Confusion matrix: 
 [[558  15]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.974 0.026]
 [0.366 0.634]]
Validation f1: 63.41
Validation accuracy: 95.11
Validation recall: 63.41
Validation precision: 63.41
Validation AUC: 0.663621152539615
Validation class accuracies: [0.9738219895287958, 0.6341463414634146]
Saving model...
Epoch 7/65
214/214 - 87s - loss: 0.0176 - accuracy: 0.9959 - val_loss: 0.1498 - val_accuracy: 0.9674
Confusion matrix: 
 [[568   5]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.991 0.009]
 [0.366 0.634]]
Validation f1: 72.22
Validation accuracy: 96.74
Validation recall: 63.41
Validation precision: 83.87
Validation AUC: 0.7368030685518281
Validation class accuracies: [0.9912739965095986, 0.6341463414634146]
Saving model...
Epoch 8/65
214/214 - 84s - loss: 0.0104 - accuracy: 0.9994 - val_loss: 0.2438 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.6556936143545192
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 1 epochs
Epoch 9/65
214/214 - 87s - loss: 0.0069 - accuracy: 0.9991 - val_loss: 0.2407 - val_accuracy: 0.9479
Confusion matrix: 
 [[556  17]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.366 0.634]]
Validation f1: 61.90
Validation accuracy: 94.79
Validation recall: 63.41
Validation precision: 60.47
Validation AUC: 0.6580298325891202
Validation class accuracies: [0.9703315881326352, 0.6341463414634146]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 2 epochs
Epoch 10/65
214/214 - 87s - loss: 0.0053 - accuracy: 0.9997 - val_loss: 0.2350 - val_accuracy: 0.9528
Confusion matrix: 
 [[556  17]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.293 0.707]]
Validation f1: 66.67
Validation accuracy: 95.28
Validation recall: 70.73
Validation precision: 63.04
Validation AUC: 0.7029368874121704
Validation class accuracies: [0.9703315881326352, 0.7073170731707317]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 3 epochs
Epoch 11/65
214/214 - 85s - loss: 0.0074 - accuracy: 0.9982 - val_loss: 0.4980 - val_accuracy: 0.8795
Confusion matrix: 
 [[508  65]
 [  9  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.22  0.78 ]]
Validation f1: 46.38
Validation accuracy: 87.95
Validation recall: 78.05
Validation precision: 32.99
Validation AUC: 0.6205111019024796
Validation class accuracies: [0.8865619546247818, 0.7804878048780488]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 4 epochs
Epoch 12/65
214/214 - 87s - loss: 0.0054 - accuracy: 0.9997 - val_loss: 0.2342 - val_accuracy: 0.9577
Confusion matrix: 
 [[562  11]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.366 0.634]]
Validation f1: 66.67
Validation accuracy: 95.77
Validation recall: 63.41
Validation precision: 70.27
Validation AUC: 0.6813223655792722
Validation class accuracies: [0.9808027923211169, 0.6341463414634146]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 13/65
214/214 - 86s - loss: 0.0047 - accuracy: 0.9991 - val_loss: 0.2442 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6776103195789315
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 6 epochs
Epoch 14/65
214/214 - 86s - loss: 0.0026 - accuracy: 1.0000 - val_loss: 0.2567 - val_accuracy: 0.9430
Confusion matrix: 
 [[551  22]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 61.54
Validation accuracy: 94.30
Validation recall: 68.29
Validation precision: 56.00
Validation AUC: 0.6828651288141852
Validation class accuracies: [0.9616055846422339, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 7 epochs
Epoch 15/65
214/214 - 88s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.2483 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6902568171871005
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 8 epochs
Epoch 16/65
214/214 - 85s - loss: 0.0023 - accuracy: 1.0000 - val_loss: 0.2618 - val_accuracy: 0.9414
Confusion matrix: 
 [[550  23]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.317 0.683]]
Validation f1: 60.87
Validation accuracy: 94.14
Validation recall: 68.29
Validation precision: 54.90
Validation AUC: 0.6873003731124382
Validation class accuracies: [0.9598603839441536, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 9 epochs
Epoch 17/65
214/214 - 87s - loss: 0.0020 - accuracy: 1.0000 - val_loss: 0.2629 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6773149963426927
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 18/65
214/214 - 88s - loss: 0.0022 - accuracy: 1.0000 - val_loss: 0.2710 - val_accuracy: 0.9414
Confusion matrix: 
 [[550  23]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 60.87
Validation accuracy: 94.14
Validation recall: 68.29
Validation precision: 54.90
Validation AUC: 0.6744172148000251
Validation class accuracies: [0.9598603839441536, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 11 epochs
Epoch 19/65
214/214 - 84s - loss: 0.0019 - accuracy: 1.0000 - val_loss: 0.2456 - val_accuracy: 0.9463
Confusion matrix: 
 [[553  20]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.965 0.035]
 [0.317 0.683]]
Validation f1: 62.92
Validation accuracy: 94.63
Validation recall: 68.29
Validation precision: 58.33
Validation AUC: 0.6851314277929513
Validation class accuracies: [0.9650959860383944, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 12 epochs
Epoch 20/65
214/214 - 88s - loss: 0.0019 - accuracy: 1.0000 - val_loss: 0.2576 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6873250345579203
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 13 epochs
Epoch 21/65
214/214 - 88s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.2673 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
Validation f1: 62.22
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6754248859193063
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 14 epochs
Epoch 22/65
214/214 - 86s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.2620 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6829985964554853
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 23/65
214/214 - 88s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.2638 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6813118331146848
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 16 epochs
Epoch 24/65
214/214 - 85s - loss: 0.0020 - accuracy: 1.0000 - val_loss: 0.2644 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6801618697953983
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 17 epochs
Epoch 25/65
214/214 - 86s - loss: 0.0021 - accuracy: 0.9997 - val_loss: 0.2630 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6807195801925672
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 18 epochs
Epoch 26/65
214/214 - 88s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.2640 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6823112622767811
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]
The validation tracker metric at 0.7222222222222222 hasn't increased by 0 in 19 epochs
Epoch 27/65
214/214 - 84s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.2632 - val_accuracy: 0.9446
Confusion matrix: 
 [[552  21]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 62.22
Validation accuracy: 94.46
Validation recall: 68.29
Validation precision: 57.14
Validation AUC: 0.6790351163128839
Validation class accuracies: [0.9633507853403142, 0.6829268292682927]

The metrics for job 0 with the best target metric are: 
Best cm: [[568   5]
 [ 15  26]]
Best normalized cm: [[0.991 0.009]
 [0.366 0.634]]
Best f1: 0.72
Best accuracy: 0.97
Best recall: 0.63
Best precision: 0.84
Best AUC: 0.74
Best class accuracies: [0.9912739965095986, 0.6341463414634146]
Best epoch: 7
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.906250185536919e-06
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[4.753e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p5_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[7.319e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b4_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_217_1b1_Tc_sc_Meditron_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_7_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b3_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[8.044e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/jordan_EP69_pneumonia,Bronchial,P R L ,64,M_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_7_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1p1_Pl_sc_Litt3200_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_215_1b2_Ar_sc_Meditron_0_label_0_pred_0.png, [[3.764e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_2p2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.761e-07]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_2b5_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[0.033]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_219_2b1_Tc_mc_LittC2SE_2_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_4b2_Pl_mc_AKGC417L_1_label_0_pred_0.png, [[8.828e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_223_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[1.584e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b2_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_8_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_203_2p3_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[2.9e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p2_Pr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b3_Ar_mc_AKGC417L_2_label_0_pred_0.png, [[1.543e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_2p2_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.006]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_224_1b2_Al_sc_Meditron_3_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b3_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_223_1b1_Ll_sc_Meditron_4_label_0_pred_0.png, [[1.229e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Ar_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1p1_Pl_sc_Litt3200_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_11_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b2_Al_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b2_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.009]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Pr_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p5_Al_mc_AKGC417L_1_label_0_pred_0.png, [[1.437e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_7p5_Ll_mc_AKGC417L_1_label_0_pred_0.png, [[3.812e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_7p5_Lr_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_1_label_0_pred_1.png, [[0.786]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1p1_Pl_sc_Litt3200_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_225_1b1_Pl_sc_Meditron_2_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.024]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Al_mc_LittC2SE_2_label_0_pred_0.png, [[0.107]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[5.843e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_203_2p3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b4_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.001]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 2970
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_041847-20e1mt3x/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_041847-20e1mt3x/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.94463
wandb:             _runtime 3555
wandb:           _timestamp 1625548682
wandb:                _step 200
wandb:           train_loss 0.0016
wandb:             val_loss 0.26324
wandb:           val_recall 0.68293
wandb:        val_precision 0.57143
wandb:               val_f1 0.62222
wandb:              val_auc 0.67904
wandb:                   lr 2e-05
wandb:          best_val_f1 0.72222
wandb:    best_val_accuracy 0.96743
wandb:   best_val_precision 0.83871
wandb:      best_val_recall 0.63415
wandb:             best_auc 0.7368
wandb:           best_epoch 7
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_041847-20e1mt3x

-----------------------
158/2000
Collecting Variables...
All variables have been collected.
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2458 with pneumonia: 158 and non-pneumonia: 2300
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_4
The path used for augmix augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_mix_5
Length of training samples after augmix augmentation: 4616
Number of val recordings: 614 with pneumonia: 41 and non-pneumonia: 573
-----------------------
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_3 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                               (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_10 (MixDepthGroupC (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePooling2D)          (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                               (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_11 (MixDepthGroupC (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePooling2D)          (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormalization)      (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                               (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_12 (MixDepthGroupC (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePooling2D)          (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormalization)      (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                               (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_13 (MixDepthGroupC (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePooling2D)          (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormalization)      (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                               (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_14 (MixDepthGroupC (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePooling2D)          (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_2 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
289/289 - 111s - loss: 0.2424 - accuracy: 0.9276 - val_loss: 0.2565 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2709340554765846
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
289/289 - 113s - loss: 0.0858 - accuracy: 0.9682 - val_loss: 0.2843 - val_accuracy: 0.9332
Confusion matrix: 
 [[573   0]
 [ 41   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.32
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.6649587919353527
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
289/289 - 113s - loss: 0.0543 - accuracy: 0.9803 - val_loss: 0.7522 - val_accuracy: 0.7557
Confusion matrix: 
 [[426 147]
 [  3  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.743 0.257]
 [0.073 0.927]]
Validation f1: 33.63
Validation accuracy: 75.57
Validation recall: 92.68
Validation precision: 20.54
Validation AUC: 0.601506633461377
Validation class accuracies: [0.743455497382199, 0.926829268292683]
Saving model...
Epoch 4/65
289/289 - 109s - loss: 0.0352 - accuracy: 0.9881 - val_loss: 0.2610 - val_accuracy: 0.9283
Confusion matrix: 
 [[545  28]
 [ 16  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.39  0.61 ]]
Validation f1: 53.19
Validation accuracy: 92.83
Validation recall: 60.98
Validation precision: 47.17
Validation AUC: 0.5876154228059051
Validation class accuracies: [0.9511343804537522, 0.6097560975609756]
Saving model...
Epoch 5/65
289/289 - 113s - loss: 0.0299 - accuracy: 0.9890 - val_loss: 0.2031 - val_accuracy: 0.9414
Confusion matrix: 
 [[554  19]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.415 0.585]]
Validation f1: 57.14
Validation accuracy: 94.14
Validation recall: 58.54
Validation precision: 55.81
Validation AUC: 0.6329647195586624
Validation class accuracies: [0.9668411867364747, 0.5853658536585366]
Saving model...
Epoch 6/65
289/289 - 114s - loss: 0.0157 - accuracy: 0.9957 - val_loss: 0.8770 - val_accuracy: 0.7980
Confusion matrix: 
 [[454 119]
 [  5  36]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.792 0.208]
 [0.122 0.878]]
Validation f1: 36.73
Validation accuracy: 79.80
Validation recall: 87.80
Validation precision: 23.23
Validation AUC: 0.5763890741078677
Validation class accuracies: [0.7923211169284468, 0.8780487804878049]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 1 epochs
Epoch 7/65
289/289 - 111s - loss: 0.0110 - accuracy: 0.9978 - val_loss: 0.3447 - val_accuracy: 0.9235
Confusion matrix: 
 [[540  33]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 53.47
Validation accuracy: 92.35
Validation recall: 65.85
Validation precision: 45.00
Validation AUC: 0.5889502376883202
Validation class accuracies: [0.9424083769633508, 0.6585365853658537]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 2 epochs
Epoch 8/65
289/289 - 114s - loss: 0.0072 - accuracy: 0.9989 - val_loss: 0.4072 - val_accuracy: 0.9235
Confusion matrix: 
 [[538  35]
 [ 12  29]]
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.293 0.707]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.24
Validation accuracy: 92.35
Validation recall: 70.73
Validation precision: 45.31
Validation AUC: 0.6018761965571509
Validation class accuracies: [0.9389179755671903, 0.7073170731707317]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 3 epochs
Epoch 9/65
289/289 - 110s - loss: 0.0059 - accuracy: 0.9991 - val_loss: 0.3798 - val_accuracy: 0.9251
Confusion matrix: 
 [[544  29]
 [ 17  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.415 0.585]]
Validation f1: 51.06
Validation accuracy: 92.51
Validation recall: 58.54
Validation precision: 45.28
Validation AUC: 0.5594123430259914
Validation class accuracies: [0.9493891797556719, 0.5853658536585366]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 4 epochs
Epoch 10/65
289/289 - 113s - loss: 0.0038 - accuracy: 1.0000 - val_loss: 0.3675 - val_accuracy: 0.9267
Confusion matrix: 
 [[540  33]
 [ 12  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.293 0.707]]
Validation f1: 56.31
Validation accuracy: 92.67
Validation recall: 70.73
Validation precision: 46.77
Validation AUC: 0.6284681962706965
Validation class accuracies: [0.9424083769633508, 0.7073170731707317]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 11/65
289/289 - 113s - loss: 0.0048 - accuracy: 0.9989 - val_loss: 0.3290 - val_accuracy: 0.9283
Confusion matrix: 
 [[542  31]
 [ 13  28]]
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.317 0.683]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.00
Validation accuracy: 92.83
Validation recall: 68.29
Validation precision: 47.46
Validation AUC: 0.6376934322642642
Validation class accuracies: [0.9458987783595113, 0.6829268292682927]
The validation tracker metric at 0.5714285714285714 hasn't increased by 0 in 6 epochs
Epoch 12/65
289/289 - 111s - loss: 0.0029 - accuracy: 0.9998 - val_loss: 0.3050 - val_accuracy: 0.9349
Confusion matrix: 
 [[547  26]
 [ 14  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.341 0.659]]
Validation f1: 57.45
Validation accuracy: 93.49
Validation recall: 65.85
Validation precision: 50.94
Validation AUC: 0.6274078519378373
Validation class accuracies: [0.9546247818499127, 0.6585365853658537]
Saving model...
Epoch 13/65
289/289 - 113s - loss: 0.0023 - accuracy: 1.0000 - val_loss: 0.2897 - val_accuracy: 0.9365
Confusion matrix: 
 [[554  19]
 [ 20  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.967 0.033]
 [0.488 0.512]]
Validation f1: 51.85
Validation accuracy: 93.65
Validation recall: 51.22
Validation precision: 52.50
Validation AUC: 0.5921791417319708
Validation class accuracies: [0.9668411867364747, 0.5121951219512195]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 1 epochs
Epoch 14/65
289/289 - 110s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.3404 - val_accuracy: 0.9283
Confusion matrix: 
 [[544  29]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.366 0.634]]
Validation f1: 54.17
Validation accuracy: 92.83
Validation recall: 63.41
Validation precision: 47.27
Validation AUC: 0.5966462239679388
Validation class accuracies: [0.9493891797556719, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 2 epochs
Epoch 15/65
289/289 - 113s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.3402 - val_accuracy: 0.9316
Confusion matrix: 
 [[546  27]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.366 0.634]]
Validation f1: 55.32
Validation accuracy: 93.16
Validation recall: 63.41
Validation precision: 49.06
Validation AUC: 0.6047588057366983
Validation class accuracies: [0.9528795811518325, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 3 epochs
Epoch 16/65
289/289 - 113s - loss: 0.0021 - accuracy: 1.0000 - val_loss: 0.3347 - val_accuracy: 0.9349
Confusion matrix: 
 [[548  25]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.366 0.634]]
Validation f1: 56.52
Validation accuracy: 93.49
Validation recall: 63.41
Validation precision: 50.98
Validation AUC: 0.5973654870576189
Validation class accuracies: [0.956369982547993, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 4 epochs
Epoch 17/65
289/289 - 111s - loss: 0.0015 - accuracy: 1.0000 - val_loss: 0.3300 - val_accuracy: 0.9349
Confusion matrix: 
 [[547  26]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.45
Validation accuracy: 93.49
Validation recall: 65.85
Validation precision: 50.94
Validation AUC: 0.6293710345124005
Validation class accuracies: [0.9546247818499127, 0.6585365853658537]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 18/65
289/289 - 113s - loss: 0.0017 - accuracy: 0.9998 - val_loss: 0.3322 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6243404258629707
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 6 epochs
Epoch 19/65
289/289 - 111s - loss: 0.0017 - accuracy: 1.0000 - val_loss: 0.3302 - val_accuracy: 0.9349
Confusion matrix: 
 [[547  26]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 57.45
Validation accuracy: 93.49
Validation recall: 65.85
Validation precision: 50.94
Validation AUC: 0.6281310780038445
Validation class accuracies: [0.9546247818499127, 0.6585365853658537]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 7 epochs
Epoch 20/65
289/289 - 112s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3456 - val_accuracy: 0.9316
Confusion matrix: 
 [[545  28]
 [ 14  27]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.341 0.659]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.25
Validation accuracy: 93.16
Validation recall: 65.85
Validation precision: 49.09
Validation AUC: 0.6184684522856169
Validation class accuracies: [0.9511343804537522, 0.6585365853658537]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 8 epochs
Epoch 21/65
289/289 - 113s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3387 - val_accuracy: 0.9316
Confusion matrix: 
 [[546  27]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.32
Validation accuracy: 93.16
Validation recall: 63.41
Validation precision: 49.06
Validation AUC: 0.6170116704258146
Validation class accuracies: [0.9528795811518325, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 9 epochs
Epoch 22/65
289/289 - 111s - loss: 0.0020 - accuracy: 0.9998 - val_loss: 0.3287 - val_accuracy: 0.9349
Confusion matrix: 
 [[548  25]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 56.52
Validation accuracy: 93.49
Validation recall: 63.41
Validation precision: 50.98
Validation AUC: 0.6150800309295303
Validation class accuracies: [0.956369982547993, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 1.5625000742147677e-05
Epoch 23/65
289/289 - 113s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3248 - val_accuracy: 0.9365
Confusion matrix: 
 [[549  24]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.366 0.634]]
Validation f1: 57.14
Validation accuracy: 93.65
Validation recall: 63.41
Validation precision: 52.00
Validation AUC: 0.6160663150076319
Validation class accuracies: [0.9581151832460733, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 11 epochs
Epoch 24/65
289/289 - 111s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3292 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6169845145984781
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 12 epochs
Epoch 25/65
289/289 - 112s - loss: 0.0013 - accuracy: 1.0000 - val_loss: 0.3243 - val_accuracy: 0.9349
Confusion matrix: 
 [[548  25]
 [ 15  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.366 0.634]]
Validation f1: 56.52
Validation accuracy: 93.49
Validation recall: 63.41
Validation precision: 50.98
Validation AUC: 0.6169838047561529
Validation class accuracies: [0.956369982547993, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 13 epochs
Epoch 26/65
289/289 - 114s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3379 - val_accuracy: 0.9316
Confusion matrix: 
 [[546  27]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.32
Validation accuracy: 93.16
Validation recall: 63.41
Validation precision: 49.06
Validation AUC: 0.6166865339942442
Validation class accuracies: [0.9528795811518325, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 14 epochs
Epoch 27/65
289/289 - 110s - loss: 0.0016 - accuracy: 1.0000 - val_loss: 0.3327 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
Validation f1: 55.91
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6172871128980336
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 3.906250185536919e-06
Epoch 28/65
289/289 - 114s - loss: 0.0012 - accuracy: 1.0000 - val_loss: 0.3356 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6147460493725344
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 16 epochs
Epoch 29/65
289/289 - 113s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 0.3328 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6154961403658924
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 17 epochs
Epoch 30/65
289/289 - 112s - loss: 0.0018 - accuracy: 0.9998 - val_loss: 0.3352 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6174060079519444
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 18 epochs
Epoch 31/65
289/289 - 114s - loss: 0.0017 - accuracy: 0.9998 - val_loss: 0.3344 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.615922442658274
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]
The validation tracker metric at 0.574468085106383 hasn't increased by 0 in 19 epochs
Epoch 32/65
289/289 - 110s - loss: 0.0018 - accuracy: 1.0000 - val_loss: 0.3353 - val_accuracy: 0.9332
Confusion matrix: 
 [[547  26]
 [ 15  26]]
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.366 0.634]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 55.91
Validation accuracy: 93.32
Validation recall: 63.41
Validation precision: 50.00
Validation AUC: 0.6159061991728101
Validation class accuracies: [0.9546247818499127, 0.6341463414634146]

The metrics for job 0 with the best target metric are: 
Best cm: [[547  26]
 [ 14  27]]
Best normalized cm: [[0.955 0.045]
 [0.341 0.659]]
Best f1: 0.57
Best accuracy: 0.93
Best recall: 0.66
Best precision: 0.51
Best AUC: 0.63
Best class accuracies: [0.9546247818499127, 0.6585365853658537]
Best epoch: 12
The number of epochs since last 1% equals the patience
Lr has been adjusted to 9.765625463842298e-07
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b3_Pl_mc_AKGC417L_3_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_0_label_0_pred_0.png, [[5.056e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_0_label_0_pred_0.png, [[0.178]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_1b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_1b3_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[1.843e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_210_1b1_Ar_sc_Meditron_2_label_0_pred_0.png, [[3.268e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_211_1p2_Pl_mc_AKGC417L_0_label_0_pred_0.png, [[4.597e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_223_1b1_Pl_sc_Meditron_4_label_0_pred_0.png, [[3.79e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_4b2_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[1.883e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b3_Al_mc_AKGC417L_0_label_0_pred_0.png, [[0.012]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_2_label_0_pred_0.png, [[5.617e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_222_1b1_Lr_sc_Meditron_10_label_0_pred_0.png, [[1.149e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Al_sc_Meditron_8_label_0_pred_0.png, [[0.004]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pr_sc_Meditron_4_label_0_pred_0.png, [[7.521e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_222_1b1_Ar_sc_Meditron_3_label_0_pred_0.png, [[3.672e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_219_2b1_Tc_mc_LittC2SE_1_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/jordan_EP37_pneumonia,Crep,A R L,70,F_1_label_1_pred_1.png, [[1.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_211_2p2_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_219_2b2_Ar_mc_LittC2SE_0_label_1_pred_1.png, [[0.706]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_226_1b1_Ll_sc_Meditron_1_label_1_pred_0.png, [[2.247e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_215_1b3_Tc_sc_Meditron_2_label_0_pred_0.png, [[6.491e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b4_Tc_mc_AKGC417L_1_label_0_pred_0.png, [[0.001]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_2b3_Al_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_3b2_Tc_mc_AKGC417L_3_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1p1_Ar_sc_Litt3200_0_label_0_pred_0.png, [[0.005]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b1_Pl_mc_LittC2SE_2_label_0_pred_0.png, [[0.003]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_7p5_Lr_mc_AKGC417L_2_label_0_pred_0.png, [[2.823e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_2b3_Ll_mc_AKGC417L_3_label_0_pred_0.png, [[3.043e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_207_2b2_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[2.765e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_7_label_0_pred_0.png, [[1.795e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_218_1b1_Pl_sc_Meditron_0_label_0_pred_0.png, [[1.999e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_2p2_Pr_mc_AKGC417L_0_label_0_pred_0.png, [[4.022e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_221_2b3_Lr_mc_LittC2SE_1_label_0_pred_0.png, [[0.018]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_212_2b2_Tc_mc_LittC2SE_0_label_0_pred_1.png, [[0.996]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p3_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[2.297e-05]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_220_1b2_Al_mc_LittC2SE_2_label_0_pred_0.png, [[2.986e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_211_2p4_Tc_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_219_2b2_Ar_mc_LittC2SE_3_label_1_pred_0.png, [[0.143]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_226_1b1_Ll_sc_Meditron_0_label_1_pred_0.png, [[0.022]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_211_2p4_Tc_mc_AKGC417L_0_label_0_pred_0.png, [[0.002]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_226_1b1_Al_sc_Meditron_2_label_1_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p5_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_204_2b5_Ar_mc_AKGC417L_1_label_0_pred_0.png, [[0.]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_213_1p2_Ar_mc_AKGC417L_0_label_0_pred_0.png, [[3.778e-06]]
../../new_cache/conv__2288__07_0321__v39__augmix/0/icbhi_205_2b4_Pl_mc_AKGC417L_2_label_0_pred_0.png, [[1.776e-05]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
wandb: Waiting for W&B process to finish, PID 8727
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_051842-2ojqudtu/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_051842-2ojqudtu/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 1.0
wandb:         val_accuracy 0.93322
wandb:             _runtime 6106
wandb:           _timestamp 1625554829
wandb:                _step 235
wandb:           train_loss 0.00175
wandb:             val_loss 0.33534
wandb:           val_recall 0.63415
wandb:        val_precision 0.5
wandb:               val_f1 0.55914
wandb:              val_auc 0.61591
wandb:                   lr 0.0
wandb:          best_val_f1 0.57447
wandb:    best_val_accuracy 0.93485
wandb:   best_val_precision 0.50943
wandb:      best_val_recall 0.65854
wandb:             best_auc 0.62741
wandb:           best_epoch 12
wandb: Run history:
wandb:   train_accuracy 
wandb:     val_accuracy 
wandb:         _runtime 
wandb:       _timestamp 
wandb:            _step 
wandb:       train_loss 
wandb:         val_loss 
wandb:       val_recall 
wandb:    val_precision 
wandb:           val_f1 
wandb:          val_auc 
wandb:               lr 
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210706_051842-2ojqudtu


 See logs at ../../new_cache/conv__2288__07_0321__v39__augmix/logs/