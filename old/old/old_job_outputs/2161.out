Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
File:  conv.train2161
Description:  v32_weights
2021-05-26 20:41:21.361781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:41:23.636471: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-26 20:41:23.637481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-26 20:41:23.689882: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:23.690911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-26 20:41:23.690964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:41:23.696185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 20:41:23.696315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 20:41:23.697879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-26 20:41:23.698326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-26 20:41:23.699849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-26 20:41:23.701094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-26 20:41:23.701305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-26 20:41:23.701496: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:23.702640: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:23.703569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2161.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v32_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2161__05_2040__v32__v32_weights/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.25, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 25, 0%
Six: False and Concat: False
-----------------------
wandb: Tracking run with wandb version 0.10.30
wandb: Syncing run train2161
wandb: ⭐️ View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: 🚀 View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1yfjcu8o
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_204123-1yfjcu8o
wandb: Run `wandb offline` to turn off syncing.
2021-05-26 20:41:28.963333: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-26 20:41:28.963565: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:28.964348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-26 20:41:28.964396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:41:28.964452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 20:41:28.964483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 20:41:28.964513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-26 20:41:28.964543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-26 20:41:28.964571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-26 20:41:28.964598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-26 20:41:28.964625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-26 20:41:28.964748: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:28.965547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:28.966263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-26 20:41:28.966319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-26 20:41:29.736182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-26 20:41:29.736241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-26 20:41:29.736249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-26 20:41:29.736591: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:29.737401: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:29.738096: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-26 20:41:29.738782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-26 20:42:08.513953: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-26 20:42:08.515895: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-26 20:42:11.748363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-26 20:42:12.539886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-26 20:42:12.551411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
With concat = False and six = False, size of training set: 4165...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/80
261/261 - 497s - loss: 0.7490 - accuracy: 0.5539 - val_loss: 0.5945 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2433335584670898
Validation class accuracies: [1.0, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/80
261/261 - 490s - loss: 0.6870 - accuracy: 0.5553 - val_loss: 0.6521 - val_accuracy: 0.7950
Confusion matrix: 
 [[865   5]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.50
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.20167581519800243
Validation class accuracies: [0.9942528735632183, 0.0]
TARGET: 1
target metric(test f1): 0.0
inside not defaulting
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/80
261/261 - 489s - loss: 0.6828 - accuracy: 0.5827 - val_loss: 0.6687 - val_accuracy: 0.5561
Confusion matrix: 
 [[476 394]
 [ 89 129]]
Validation f1: 34.82
Validation accuracy: 55.61
Validation recall: 59.17
Validation precision: 24.67
Validation AUC: 0.2674805307732651
Validation class accuracies: [0.5471264367816092, 0.591743119266055]
TARGET: 1
target metric(test f1): 0.3481781376518219
inside not defaulting
Saving model...
Epoch 4/80
261/261 - 489s - loss: 0.6811 - accuracy: 0.5724 - val_loss: 0.7541 - val_accuracy: 0.6875
Confusion matrix: 
 [[714 156]
 [184  34]]
Validation f1: 16.67
Validation accuracy: 68.75
Validation recall: 15.60
Validation precision: 17.89
Validation AUC: 0.19649839809865507
Validation class accuracies: [0.8206896551724138, 0.1559633027522936]
TARGET: 1
target metric(test f1): 0.16666666666666666
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 1 epochs
Epoch 5/80
261/261 - 488s - loss: 0.6760 - accuracy: 0.5815 - val_loss: 0.8729 - val_accuracy: 0.2096
Confusion matrix: 
 [[ 13 857]
 [  3 215]]
Validation f1: 33.33
Validation accuracy: 20.96
Validation recall: 98.62
Validation precision: 20.06
Validation AUC: 0.19284075569202813
Validation class accuracies: [0.014942528735632184, 0.9862385321100917]
TARGET: 1
target metric(test f1): 0.33333333333333337
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 2 epochs
Epoch 6/80
261/261 - 490s - loss: 0.6708 - accuracy: 0.5635 - val_loss: 0.6437 - val_accuracy: 0.6700
Confusion matrix: 
 [[681 189]
 [170  48]]
Validation f1: 21.10
Validation accuracy: 67.00
Validation recall: 22.02
Validation precision: 20.25
Validation AUC: 0.20332737937219306
Validation class accuracies: [0.7827586206896552, 0.22018348623853212]
TARGET: 1
target metric(test f1): 0.21098901098901102
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 3 epochs
Epoch 7/80
261/261 - 488s - loss: 0.6672 - accuracy: 0.5880 - val_loss: 0.6418 - val_accuracy: 0.6415
Confusion matrix: 
 [[617 253]
 [137  81]]
Validation f1: 29.35
Validation accuracy: 64.15
Validation recall: 37.16
Validation precision: 24.25
Validation AUC: 0.23946686616251295
Validation class accuracies: [0.7091954022988506, 0.37155963302752293]
TARGET: 1
target metric(test f1): 0.2934782608695652
inside not defaulting
Lr has been adjusted to 0.0002500000118743628
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 4 epochs
Epoch 8/80
261/261 - 490s - loss: 0.6595 - accuracy: 0.5837 - val_loss: 0.6791 - val_accuracy: 0.5919
Confusion matrix: 
 [[547 323]
 [121  97]]
Validation f1: 30.41
Validation accuracy: 59.19
Validation recall: 44.50
Validation precision: 23.10
Validation AUC: 0.213660344418838
Validation class accuracies: [0.628735632183908, 0.44495412844036697]
TARGET: 1
target metric(test f1): 0.3040752351097179
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 5 epochs
Epoch 9/80
261/261 - 489s - loss: 0.6534 - accuracy: 0.5945 - val_loss: 0.8142 - val_accuracy: 0.3336
Confusion matrix: 
 [[204 666]
 [ 59 159]]
Validation f1: 30.49
Validation accuracy: 33.36
Validation recall: 72.94
Validation precision: 19.27
Validation AUC: 0.21134778576552532
Validation class accuracies: [0.23448275862068965, 0.7293577981651376]
TARGET: 1
target metric(test f1): 0.3048897411313518
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 6 epochs
Epoch 10/80
261/261 - 488s - loss: 0.6510 - accuracy: 0.5880 - val_loss: 0.7733 - val_accuracy: 0.4118
Confusion matrix: 
 [[300 570]
 [ 70 148]]
Validation f1: 31.62
Validation accuracy: 41.18
Validation recall: 67.89
Validation precision: 20.61
Validation AUC: 0.20618400839740883
Validation class accuracies: [0.3448275862068966, 0.6788990825688074]
TARGET: 1
target metric(test f1): 0.3162393162393162
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 7 epochs
Epoch 11/80
261/261 - 489s - loss: 0.6490 - accuracy: 0.5971 - val_loss: 0.7399 - val_accuracy: 0.3934
Confusion matrix: 
 [[290 580]
 [ 80 138]]
Validation f1: 29.49
Validation accuracy: 39.34
Validation recall: 63.30
Validation precision: 19.22
Validation AUC: 0.19774379408407178
Validation class accuracies: [0.3333333333333333, 0.6330275229357798]
TARGET: 1
target metric(test f1): 0.2948717948717949
inside not defaulting
Lr has been adjusted to 6.25000029685907e-05
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 8 epochs
Epoch 12/80
261/261 - 488s - loss: 0.6357 - accuracy: 0.6168 - val_loss: 0.7195 - val_accuracy: 0.5312
Confusion matrix: 
 [[467 403]
 [107 111]]
Validation f1: 30.33
Validation accuracy: 53.12
Validation recall: 50.92
Validation precision: 21.60
Validation AUC: 0.19926839092258702
Validation class accuracies: [0.5367816091954023, 0.5091743119266054]
TARGET: 1
target metric(test f1): 0.30327868852459017
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 9 epochs
Epoch 13/80
261/261 - 489s - loss: 0.6287 - accuracy: 0.6226 - val_loss: 0.7074 - val_accuracy: 0.5735
Confusion matrix: 
 [[537 333]
 [131  87]]
Validation f1: 27.27
Validation accuracy: 57.35
Validation recall: 39.91
Validation precision: 20.71
Validation AUC: 0.18793500372653923
Validation class accuracies: [0.6172413793103448, 0.39908256880733944]
TARGET: 1
target metric(test f1): 0.27272727272727276
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 10 epochs
Epoch 14/80
261/261 - 491s - loss: 0.6271 - accuracy: 0.6146 - val_loss: 0.7464 - val_accuracy: 0.4816
Confusion matrix: 
 [[406 464]
 [100 118]]
Validation f1: 29.50
Validation accuracy: 48.16
Validation recall: 54.13
Validation precision: 20.27
Validation AUC: 0.193065488270166
Validation class accuracies: [0.4666666666666667, 0.5412844036697247]
TARGET: 1
target metric(test f1): 0.295
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 11 epochs
Epoch 15/80
261/261 - 489s - loss: 0.6227 - accuracy: 0.6175 - val_loss: 0.7484 - val_accuracy: 0.5055
Confusion matrix: 
 [[440 430]
 [108 110]]
Validation f1: 29.02
Validation accuracy: 50.55
Validation recall: 50.46
Validation precision: 20.37
Validation AUC: 0.19662253982213523
Validation class accuracies: [0.5057471264367817, 0.5045871559633027]
TARGET: 1
target metric(test f1): 0.29023746701846964
inside not defaulting
Lr has been adjusted to 1.5625000742147677e-05
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 12 epochs
Epoch 16/80
261/261 - 488s - loss: 0.6205 - accuracy: 0.6269 - val_loss: 0.7514 - val_accuracy: 0.4991
Confusion matrix: 
 [[429 441]
 [104 114]]
Validation f1: 29.50
Validation accuracy: 49.91
Validation recall: 52.29
Validation precision: 20.54
Validation AUC: 0.19500093324169349
Validation class accuracies: [0.49310344827586206, 0.5229357798165137]
TARGET: 1
target metric(test f1): 0.29495472186287197
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 13 epochs
Epoch 17/80
261/261 - 489s - loss: 0.6151 - accuracy: 0.6230 - val_loss: 0.7497 - val_accuracy: 0.4926
Confusion matrix: 
 [[426 444]
 [108 110]]
Validation f1: 28.50
Validation accuracy: 49.26
Validation recall: 50.46
Validation precision: 19.86
Validation AUC: 0.193351679238762
Validation class accuracies: [0.4896551724137931, 0.5045871559633027]
TARGET: 1
target metric(test f1): 0.28497409326424866
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 14 epochs
Epoch 18/80
261/261 - 489s - loss: 0.6151 - accuracy: 0.6293 - val_loss: 0.7642 - val_accuracy: 0.4770
Confusion matrix: 
 [[400 470]
 [ 99 119]]
Validation f1: 29.49
Validation accuracy: 47.70
Validation recall: 54.59
Validation precision: 20.20
Validation AUC: 0.19417549972162146
Validation class accuracies: [0.45977011494252873, 0.5458715596330275]
TARGET: 1
target metric(test f1): 0.2949194547707559
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 15 epochs
Epoch 19/80
261/261 - 490s - loss: 0.6166 - accuracy: 0.6276 - val_loss: 0.7342 - val_accuracy: 0.5460
Confusion matrix: 
 [[491 379]
 [115 103]]
Validation f1: 29.43
Validation accuracy: 54.60
Validation recall: 47.25
Validation precision: 21.37
Validation AUC: 0.1935635661953458
Validation class accuracies: [0.5643678160919541, 0.4724770642201835]
TARGET: 1
target metric(test f1): 0.2942857142857143
inside not defaulting
Lr has been adjusted to 3.906250185536919e-06
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 16 epochs
Epoch 20/80
261/261 - 490s - loss: 0.6115 - accuracy: 0.6317 - val_loss: 0.7518 - val_accuracy: 0.5074
Confusion matrix: 
 [[442 428]
 [108 110]]
Validation f1: 29.10
Validation accuracy: 50.74
Validation recall: 50.46
Validation precision: 20.45
Validation AUC: 0.1932222255517778
Validation class accuracies: [0.5080459770114942, 0.5045871559633027]
TARGET: 1
target metric(test f1): 0.291005291005291
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 17 epochs
Epoch 21/80
261/261 - 489s - loss: 0.6142 - accuracy: 0.6298 - val_loss: 0.7402 - val_accuracy: 0.5239
Confusion matrix: 
 [[466 404]
 [114 104]]
Validation f1: 28.65
Validation accuracy: 52.39
Validation recall: 47.71
Validation precision: 20.47
Validation AUC: 0.1919839229406638
Validation class accuracies: [0.535632183908046, 0.47706422018348627]
TARGET: 1
target metric(test f1): 0.2865013774104683
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 18 epochs
Epoch 22/80
261/261 - 490s - loss: 0.6138 - accuracy: 0.6375 - val_loss: 0.7407 - val_accuracy: 0.5193
Confusion matrix: 
 [[462 408]
 [115 103]]
Validation f1: 28.26
Validation accuracy: 51.93
Validation recall: 47.25
Validation precision: 20.16
Validation AUC: 0.191018266553826
Validation class accuracies: [0.5310344827586206, 0.4724770642201835]
TARGET: 1
target metric(test f1): 0.28257887517146774
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 19 epochs
Epoch 23/80
261/261 - 489s - loss: 0.6156 - accuracy: 0.6276 - val_loss: 0.7441 - val_accuracy: 0.5129
Confusion matrix: 
 [[456 414]
 [116 102]]
Validation f1: 27.79
Validation accuracy: 51.29
Validation recall: 46.79
Validation precision: 19.77
Validation AUC: 0.1898181346776957
Validation class accuracies: [0.5241379310344828, 0.46788990825688076]
TARGET: 1
target metric(test f1): 0.2779291553133515
inside not defaulting
Lr has been adjusted to 9.765625463842298e-07
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 20 epochs
Epoch 24/80
261/261 - 489s - loss: 0.6072 - accuracy: 0.6245 - val_loss: 0.7439 - val_accuracy: 0.5092
Confusion matrix: 
 [[452 418]
 [116 102]]
Validation f1: 27.64
Validation accuracy: 50.92
Validation recall: 46.79
Validation precision: 19.62
Validation AUC: 0.19054677172879977
Validation class accuracies: [0.5195402298850574, 0.46788990825688076]
TARGET: 1
target metric(test f1): 0.2764227642276423
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 21 epochs
Epoch 25/80
261/261 - 489s - loss: 0.6095 - accuracy: 0.6281 - val_loss: 0.7457 - val_accuracy: 0.5083
Confusion matrix: 
 [[450 420]
 [115 103]]
Validation f1: 27.80
Validation accuracy: 50.83
Validation recall: 47.25
Validation precision: 19.69
Validation AUC: 0.19020477247371914
Validation class accuracies: [0.5172413793103449, 0.4724770642201835]
TARGET: 1
target metric(test f1): 0.27800269905533065
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 22 epochs
Epoch 26/80
261/261 - 490s - loss: 0.6126 - accuracy: 0.6230 - val_loss: 0.7439 - val_accuracy: 0.5092
Confusion matrix: 
 [[452 418]
 [116 102]]
Validation f1: 27.64
Validation accuracy: 50.92
Validation recall: 46.79
Validation precision: 19.62
Validation AUC: 0.19073911447470548
Validation class accuracies: [0.5195402298850574, 0.46788990825688076]
TARGET: 1
target metric(test f1): 0.2764227642276423
inside not defaulting
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 23 epochs
Epoch 27/80
261/261 - 489s - loss: 0.6140 - accuracy: 0.6286 - val_loss: 0.7462 - val_accuracy: 0.5101
Confusion matrix: 
 [[453 417]
 [116 102]]
Validation f1: 27.68
Validation accuracy: 51.01
Validation recall: 46.79
Validation precision: 19.65
Validation AUC: 0.19050729757823814
Validation class accuracies: [0.5206896551724138, 0.46788990825688076]
TARGET: 1
target metric(test f1): 0.276797829036635
inside not defaulting
Lr has been adjusted to 2.4414063659605745e-07
The validation tracker metric at 0.3481781376518219 hasn't increased by 0 in 24 epochs
Epoch 28/80
261/261 - 488s - loss: 0.6135 - accuracy: 0.6291 - val_loss: 0.7478 - val_accuracy: 0.5074
Confusion matrix: 
 [[448 422]
 [114 104]]
Validation f1: 27.96
Validation accuracy: 50.74
Validation recall: 47.71
Validation precision: 19.77
Validation AUC: 0.19068531473310052
Validation class accuracies: [0.5149425287356322, 0.47706422018348627]

The metrics for the epoch with the best target metric are: 
Best cm: [[476 394]
 [ 89 129]]
Best f1: 0.3481781376518219
Best accuracy: 0.5560661764705882
Best recall: 0.591743119266055
Best precision: 0.24665391969407266
Best AUC: 0.2674805307732651
Best epoch: 3
TARGET: 1
target metric(test f1): 0.27956989247311825
inside not defaulting
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 80
Starting...
CM: [[ 5 55]
 [ 1 14]]
F1: 0.33333333333333337
AUC: 0.5747826086956522
Accuracy: 0.25333333333333335
Precision: 0.2028985507246377
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_2040__v32__v32_weights/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[10 50]
 [ 2 13]]
F1: 0.3333333333333333
AUC: 0.5498412698412698
Accuracy: 0.30666666666666664
Precision: 0.20634920634920634
Recall: 0.8666666666666667
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_2040__v32__v32_weights/validation_sheet_80.xls...
Done.
Epoch: 80
Starting...
CM: [[20 40]
 [ 5 10]]
F1: 0.30769230769230765
AUC: 0.4666666666666667
Accuracy: 0.4
Precision: 0.2
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_2040__v32__v32_weights/validation_sheet_80.xls...
Done.
Epoch: epoch3
Starting...
CM: [[ 3 57]
 [ 0 15]]
F1: 0.3448275862068966
AUC: 0.6041666666666666
Accuracy: 0.24
Precision: 0.20833333333333334
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_2040__v32__v32_weights/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[14 46]
 [ 1 14]]
F1: 0.37333333333333335
AUC: 0.5900000000000001
Accuracy: 0.37333333333333335
Precision: 0.23333333333333334
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_2040__v32__v32_weights/validation_sheet_epoch3.xls...
Done.
Epoch: epoch3
Starting...
CM: [[24 36]
 [ 5 10]]
F1: 0.32786885245901637
AUC: 0.4753623188405798
Accuracy: 0.4533333333333333
Precision: 0.21739130434782608
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2161__05_2040__v32__v32_weights/validation_sheet_epoch3.xls...
Done.
wandb: Waiting for W&B process to finish, PID 4744
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: | 0.03MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: \ 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: | 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: / 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb: - 0.04MB of 0.04MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_204123-1yfjcu8o/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210526_204123-1yfjcu8o/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.62905
wandb:         val_accuracy 0.50735
wandb:             _runtime 14751
wandb:           _timestamp 1622076435
wandb:                _step 201
wandb:           train_loss 0.61352
wandb:             val_loss 0.74776
wandb:           val_recall 0.47706
wandb:        val_precision 0.19772
wandb:               val_f1 0.27957
wandb:              val_auc 0.19069
wandb:                   lr 0.0
wandb:          best_val_f1 0.34818
wandb:    best_val_accuracy 0.55607
wandb:   best_val_precision 0.24665
wandb:      best_val_recall 0.59174
wandb:             best_auc 0.26748
wandb:           best_epoch 3
wandb:           best_bd_f1 0.37333
wandb:          best_bd_auc 0.59
wandb:     best_bd_accuracy 0.37333
wandb:    best_bd_precision 0.23333
wandb:       best_bd_recall 0.93333
wandb:        best_bd_epoch epoch3
wandb: Run history:
wandb:   train_accuracy ▁▁▃▃▃▂▄▃▄▄▅▆▇▆▆▇▇▇▇█▇█▇▇▇▇▇▇
wandb:     val_accuracy ██▅▇▁▆▆▆▂▃▃▅▅▄▅▄▄▄▅▅▅▅▅▅▅▅▅▅
wandb:         _runtime ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:       _timestamp ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▅▅▄▄▄▄▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         val_loss ▁▂▃▅█▂▂▃▇▅▅▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:       val_recall ▁▁▅▂█▃▄▄▆▆▅▅▄▅▅▅▅▅▄▅▄▄▄▄▄▄▄▄
wandb:    val_precision ▁▁█▆▇▇██▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_f1 ▁▁█▄█▅▇▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_auc ▆▂█▂▁▂▆▃▃▃▂▂▁▁▂▂▁▂▁▁▁▁▁▁▁▁▁▁
wandb:               lr ███████▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Synced 6 W&B file(s), 6 media file(s), 5 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2161: https://wandb.ai/arachid1/tensorboard-integration/runs/1yfjcu8o


 See logs at ../../new_cache/conv__2161__05_2040__v32__v32_weights/logs/