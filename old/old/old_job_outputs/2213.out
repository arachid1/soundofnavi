Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2213
Description:  old_lstm2_wlabelsmoothing
2021-06-11 13:49:34.362605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-11 13:49:36.921453: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-11 13:49:36.922513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-11 13:49:36.969580: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:49:36.970306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-11 13:49:36.970336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-11 13:49:36.974069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-11 13:49:36.974158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-11 13:49:36.975307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-11 13:49:36.975610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-11 13:49:36.976703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-11 13:49:36.977645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-11 13:49:36.977803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-11 13:49:36.977906: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:49:36.978685: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:49:36.979532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2213.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2213__06_1349__v29__old_lstm2_wlabelsmoothing
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 80, 'FACTOR': 0.75, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0.4, 'EPSILON': 1e-07, 'ES_PATIENCE': 40, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v29', 'EPOCH_START': 1, 'CLAUSE': 1, 'CUBEROOTING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 250, 'WAV_PATH': 'v36,v37'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 150, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-11 13:50:20.900763: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-11 13:50:20.901063: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:50:20.901805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:05.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-11 13:50:20.901856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-11 13:50:20.901924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-11 13:50:20.901948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-11 13:50:20.901969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-11 13:50:20.901990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-11 13:50:20.902011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-11 13:50:20.902032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-11 13:50:20.902052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-11 13:50:20.902144: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:50:20.902890: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:50:20.903558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-11 13:50:20.903611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-11 13:50:21.629722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-11 13:50:21.629778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-11 13:50:21.629791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-11 13:50:21.630057: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:50:21.630880: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:50:21.631576: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-11 13:50:21.632227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:05.0, compute capability: 7.5)
2021-06-11 13:50:23.309159: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-11 13:50:23.311544: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-11 13:50:23.719957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-11 13:50:25.777112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-11 13:50:26.288907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Original number of folders: 453
Pneumonia patients: 109, Non-pneumonia patients: 270
-----------------------
Number of train recordings: 4212 with pneumonia: 1080 and non-pneumonia: 3132
Number of val recordings: 1072 with pneumonia: 288 and non-pneumonia: 784
-----------------------
The initial learning rate for this job is: 0.001
Initializing weights...
weights = {0: 0.6724137931034483, 1: 1.95}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 5, 250, 128, 1) 0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 5, 250, 128, 1)  4            input_1[0][0]                        
______________________________________________________________________________________________________________
time_distributed (TimeDistributed)  (None, 5, 250, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_2 (TimeDistributed (None, 5, 250, 128, 16) 32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_4 (TimeDistributed (None, 5, 250, 128, 1)  0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
time_distributed_1 (TimeDistributed (None, 5, 250, 128, 16) 2320         time_distributed[0][0]               
______________________________________________________________________________________________________________
time_distributed_3 (TimeDistributed (None, 5, 250, 128, 16) 6416         time_distributed_2[0][0]             
______________________________________________________________________________________________________________
time_distributed_5 (TimeDistributed (None, 5, 250, 128, 16) 32           time_distributed_4[0][0]             
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 5, 250, 128, 48) 0            time_distributed_1[0][0]             
                                                                         time_distributed_3[0][0]             
                                                                         time_distributed_5[0][0]             
______________________________________________________________________________________________________________
time_distributed_6 (TimeDistributed (None, 5, 125, 64, 48)  0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 5, 125, 64, 48)  192          time_distributed_6[0][0]             
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 5, 125, 64, 48)  0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
time_distributed_7 (TimeDistributed (None, 5, 125, 64, 48)  2352         dropout[0][0]                        
______________________________________________________________________________________________________________
time_distributed_9 (TimeDistributed (None, 5, 125, 64, 48)  2352         dropout[0][0]                        
______________________________________________________________________________________________________________
time_distributed_11 (TimeDistribute (None, 5, 125, 64, 48)  0            dropout[0][0]                        
______________________________________________________________________________________________________________
time_distributed_8 (TimeDistributed (None, 5, 125, 64, 48)  20784        time_distributed_7[0][0]             
______________________________________________________________________________________________________________
time_distributed_10 (TimeDistribute (None, 5, 125, 64, 48)  57648        time_distributed_9[0][0]             
______________________________________________________________________________________________________________
time_distributed_12 (TimeDistribute (None, 5, 125, 64, 48)  2352         time_distributed_11[0][0]            
______________________________________________________________________________________________________________
concatenate_1 (Concatenate)         (None, 5, 125, 64, 144) 0            time_distributed_8[0][0]             
                                                                         time_distributed_10[0][0]            
                                                                         time_distributed_12[0][0]            
______________________________________________________________________________________________________________
time_distributed_13 (TimeDistribute (None, 5, 63, 32, 144)  0            concatenate_1[0][0]                  
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 5, 63, 32, 144)  576          time_distributed_13[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 5, 63, 32, 144)  0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
time_distributed_14 (TimeDistribute (None, 5, 144)          0            dropout_1[0][0]                      
______________________________________________________________________________________________________________
bidirectional (Bidirectional)       (None, 5, 256)          279552       time_distributed_14[0][0]            
______________________________________________________________________________________________________________
bidirectional_1 (Bidirectional)     (None, 256)             394240       bidirectional[0][0]                  
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               257          bidirectional_1[0][0]                
==============================================================================================================
Total params: 769,141
Trainable params: 768,755
Non-trainable params: 386
______________________________________________________________________________________________________________
Epoch 1/80
264/264 - 132s - loss: 0.6940 - accuracy: 0.5057 - val_loss: 0.7347 - val_accuracy: 0.2687
Confusion matrix: 
 [[  0 784]
 [  0 288]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 42.35
Validation accuracy: 26.87
Validation recall: 100.00
Validation precision: 26.87
Validation AUC: 0.3095823060188249
Validation class accuracies: [0.0, 1.0]
The clause is activated.
The training is defaulting to either class.
Epoch 2/80
264/264 - 129s - loss: 0.6909 - accuracy: 0.5358 - val_loss: 0.6959 - val_accuracy: 0.4683
Confusion matrix: 
 [[287 497]
 [ 73 215]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.366 0.634]
 [0.253 0.747]]
Validation f1: 43.00
Validation accuracy: 46.83
Validation recall: 74.65
Validation precision: 30.20
Validation AUC: 0.3278933100113389
Validation class accuracies: [0.36607142857142855, 0.7465277777777778]
The clause is activated.
The training is defaulting to either class.
Epoch 3/80
264/264 - 127s - loss: 0.6896 - accuracy: 0.5499 - val_loss: 0.7121 - val_accuracy: 0.3470
Confusion matrix: 
 [[113 671]
 [ 29 259]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.144 0.856]
 [0.101 0.899]]
Validation f1: 42.53
Validation accuracy: 34.70
Validation recall: 89.93
Validation precision: 27.85
Validation AUC: 0.3351568395131248
Validation class accuracies: [0.1441326530612245, 0.8993055555555556]
The clause is activated.
The training is defaulting to either class.
Epoch 4/80
264/264 - 128s - loss: 0.6897 - accuracy: 0.5271 - val_loss: 0.7008 - val_accuracy: 0.4254
Confusion matrix: 
 [[243 541]
 [ 75 213]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.31 0.69]
 [0.26 0.74]]
Validation f1: 40.88
Validation accuracy: 42.54
Validation recall: 73.96
Validation precision: 28.25
Validation AUC: 0.3172705439271539
Validation class accuracies: [0.30994897959183676, 0.7395833333333334]
The clause is activated.
The training is defaulting to either class.
Epoch 5/80
264/264 - 126s - loss: 0.6882 - accuracy: 0.5537 - val_loss: 0.6917 - val_accuracy: 0.5224
Confusion matrix: 
 [[415 369]
 [143 145]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.529 0.471]
 [0.497 0.503]]
Validation f1: 36.16
Validation accuracy: 52.24
Validation recall: 50.35
Validation precision: 28.21
Validation AUC: 0.2999967669950131
Validation class accuracies: [0.5293367346938775, 0.5034722222222222]
The clause is activated.
Not defaulting.
Saving model...
Epoch 6/80
264/264 - 127s - loss: 0.6873 - accuracy: 0.5389 - val_loss: 0.7732 - val_accuracy: 0.2910
Confusion matrix: 
 [[ 45 739]
 [ 21 267]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.057 0.943]
 [0.073 0.927]]
Validation f1: 41.27
Validation accuracy: 29.10
Validation recall: 92.71
Validation precision: 26.54
Validation AUC: 0.30657828145557225
Validation class accuracies: [0.05739795918367347, 0.9270833333333334]
The clause is activated.
The training is defaulting to either class.
Epoch 7/80
264/264 - 128s - loss: 0.6870 - accuracy: 0.5567 - val_loss: 0.6982 - val_accuracy: 0.5205
Confusion matrix: 
 [[381 403]
 [111 177]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.486 0.514]
 [0.385 0.615]]
Validation f1: 40.78
Validation accuracy: 52.05
Validation recall: 61.46
Validation precision: 30.52
Validation AUC: 0.3258703180183302
Validation class accuracies: [0.48596938775510207, 0.6145833333333334]
The clause is activated.
Not defaulting.
Saving model...
Epoch 8/80
264/264 - 126s - loss: 0.6860 - accuracy: 0.5579 - val_loss: 0.7249 - val_accuracy: 0.3573
Confusion matrix: 
 [[132 652]
 [ 37 251]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.168 0.832]
 [0.128 0.872]]
Validation f1: 42.15
Validation accuracy: 35.73
Validation recall: 87.15
Validation precision: 27.80
Validation AUC: 0.3201678417869752
Validation class accuracies: [0.1683673469387755, 0.8715277777777778]
The clause is activated.
The training is defaulting to either class.
Epoch 9/80
264/264 - 128s - loss: 0.6850 - accuracy: 0.5620 - val_loss: 0.6894 - val_accuracy: 0.5700
Confusion matrix: 
 [[458 326]
 [135 153]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.584 0.416]
 [0.469 0.531]]
Validation f1: 39.90
Validation accuracy: 57.00
Validation recall: 53.12
Validation precision: 31.94
Validation AUC: 0.3258120504825752
Validation class accuracies: [0.5841836734693877, 0.53125]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 1 epochs
Epoch 10/80
264/264 - 129s - loss: 0.6845 - accuracy: 0.5836 - val_loss: 0.7778 - val_accuracy: 0.3144
Confusion matrix: 
 [[ 76 708]
 [ 27 261]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.097 0.903]
 [0.094 0.906]]
Validation f1: 41.53
Validation accuracy: 31.44
Validation recall: 90.62
Validation precision: 26.93
Validation AUC: 0.3064506336731307
Validation class accuracies: [0.09693877551020408, 0.90625]
The clause is activated.
The training is defaulting to either class.
Epoch 11/80
264/264 - 126s - loss: 0.6838 - accuracy: 0.5594 - val_loss: 0.7481 - val_accuracy: 0.3554
Confusion matrix: 
 [[146 638]
 [ 53 235]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.186 0.814]
 [0.184 0.816]]
Validation f1: 40.48
Validation accuracy: 35.54
Validation recall: 81.60
Validation precision: 26.92
Validation AUC: 0.30363685757545233
Validation class accuracies: [0.18622448979591838, 0.8159722222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 12/80
264/264 - 127s - loss: 0.6830 - accuracy: 0.5674 - val_loss: 0.8146 - val_accuracy: 0.3069
Confusion matrix: 
 [[ 67 717]
 [ 26 262]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.085 0.915]
 [0.09  0.91 ]]
Validation f1: 41.36
Validation accuracy: 30.69
Validation recall: 90.97
Validation precision: 26.76
Validation AUC: 0.27916861886909816
Validation class accuracies: [0.08545918367346939, 0.9097222222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 13/80
264/264 - 129s - loss: 0.6810 - accuracy: 0.5743 - val_loss: 0.6799 - val_accuracy: 0.6511
Confusion matrix: 
 [[612 172]
 [202  86]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.781 0.219]
 [0.701 0.299]]
Validation f1: 31.50
Validation accuracy: 65.11
Validation recall: 29.86
Validation precision: 33.33
Validation AUC: 0.3121380050098236
Validation class accuracies: [0.7806122448979592, 0.2986111111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 2 epochs
Epoch 14/80
264/264 - 126s - loss: 0.6797 - accuracy: 0.5959 - val_loss: 0.6768 - val_accuracy: 0.6446
Confusion matrix: 
 [[609 175]
 [206  82]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.777 0.223]
 [0.715 0.285]]
Validation f1: 30.09
Validation accuracy: 64.46
Validation recall: 28.47
Validation precision: 31.91
Validation AUC: 0.31949561754953437
Validation class accuracies: [0.7767857142857143, 0.2847222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 3 epochs
Epoch 15/80
264/264 - 127s - loss: 0.6793 - accuracy: 0.5800 - val_loss: 0.7201 - val_accuracy: 0.4179
Confusion matrix: 
 [[252 532]
 [ 92 196]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.321 0.679]
 [0.319 0.681]]
Validation f1: 38.58
Validation accuracy: 41.79
Validation recall: 68.06
Validation precision: 26.92
Validation AUC: 0.3021673963823569
Validation class accuracies: [0.32142857142857145, 0.6805555555555556]
The clause is activated.
The training is defaulting to either class.
Epoch 16/80
264/264 - 126s - loss: 0.6784 - accuracy: 0.6030 - val_loss: 0.7217 - val_accuracy: 0.4300
Confusion matrix: 
 [[263 521]
 [ 90 198]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.335 0.665]
 [0.312 0.688]]
Validation f1: 39.32
Validation accuracy: 43.00
Validation recall: 68.75
Validation precision: 27.54
Validation AUC: 0.30304663367249457
Validation class accuracies: [0.3354591836734694, 0.6875]
The clause is activated.
The training is defaulting to either class.
Epoch 17/80
264/264 - 127s - loss: 0.6782 - accuracy: 0.5800 - val_loss: 0.6876 - val_accuracy: 0.5718
Confusion matrix: 
 [[464 320]
 [139 149]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.592 0.408]
 [0.483 0.517]]
Validation f1: 39.37
Validation accuracy: 57.18
Validation recall: 51.74
Validation precision: 31.77
Validation AUC: 0.3280673694045906
Validation class accuracies: [0.5918367346938775, 0.5173611111111112]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 4 epochs
Epoch 18/80
264/264 - 127s - loss: 0.6770 - accuracy: 0.5916 - val_loss: 0.7209 - val_accuracy: 0.4627
Confusion matrix: 
 [[340 444]
 [132 156]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.434 0.566]
 [0.458 0.542]]
Validation f1: 35.14
Validation accuracy: 46.27
Validation recall: 54.17
Validation precision: 26.00
Validation AUC: 0.2774751978250251
Validation class accuracies: [0.4336734693877551, 0.5416666666666666]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 5 epochs
Epoch 19/80
264/264 - 126s - loss: 0.6744 - accuracy: 0.6123 - val_loss: 0.7624 - val_accuracy: 0.3713
Confusion matrix: 
 [[170 614]
 [ 60 228]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.217 0.783]
 [0.208 0.792]]
Validation f1: 40.35
Validation accuracy: 37.13
Validation recall: 79.17
Validation precision: 27.08
Validation AUC: 0.2978991574091844
Validation class accuracies: [0.21683673469387754, 0.7916666666666666]
The clause is activated.
The training is defaulting to either class.
Epoch 20/80
264/264 - 127s - loss: 0.6734 - accuracy: 0.6237 - val_loss: 0.6916 - val_accuracy: 0.5569
Confusion matrix: 
 [[474 310]
 [165 123]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.605 0.395]
 [0.573 0.427]]
Validation f1: 34.12
Validation accuracy: 55.69
Validation recall: 42.71
Validation precision: 28.41
Validation AUC: 0.3086277929251079
Validation class accuracies: [0.6045918367346939, 0.4270833333333333]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.000750000006519258
Epoch 21/80
264/264 - 129s - loss: 0.6722 - accuracy: 0.6182 - val_loss: 0.8537 - val_accuracy: 0.3256
Confusion matrix: 
 [[ 92 692]
 [ 31 257]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.117 0.883]
 [0.108 0.892]]
Validation f1: 41.55
Validation accuracy: 32.56
Validation recall: 89.24
Validation precision: 27.08
Validation AUC: 0.2825889056648682
Validation class accuracies: [0.11734693877551021, 0.8923611111111112]
The clause is activated.
The training is defaulting to either class.
Epoch 22/80
264/264 - 128s - loss: 0.6721 - accuracy: 0.6144 - val_loss: 0.7516 - val_accuracy: 0.3983
Confusion matrix: 
 [[200 584]
 [ 61 227]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.255 0.745]
 [0.212 0.788]]
Validation f1: 41.31
Validation accuracy: 39.83
Validation recall: 78.82
Validation precision: 27.99
Validation AUC: 0.30167259135586666
Validation class accuracies: [0.25510204081632654, 0.7881944444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 23/80
264/264 - 130s - loss: 0.6697 - accuracy: 0.6251 - val_loss: 0.8160 - val_accuracy: 0.3834
Confusion matrix: 
 [[201 583]
 [ 78 210]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.256 0.744]
 [0.271 0.729]]
Validation f1: 38.85
Validation accuracy: 38.34
Validation recall: 72.92
Validation precision: 26.48
Validation AUC: 0.2560809565998828
Validation class accuracies: [0.25637755102040816, 0.7291666666666666]
The clause is activated.
The training is defaulting to either class.
Epoch 24/80
264/264 - 132s - loss: 0.6691 - accuracy: 0.6327 - val_loss: 0.7040 - val_accuracy: 0.5149
Confusion matrix: 
 [[380 404]
 [116 172]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.485 0.515]
 [0.403 0.597]]
Validation f1: 39.81
Validation accuracy: 51.49
Validation recall: 59.72
Validation precision: 29.86
Validation AUC: 0.30608236180506676
Validation class accuracies: [0.4846938775510204, 0.5972222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 7 epochs
Epoch 25/80
264/264 - 128s - loss: 0.6685 - accuracy: 0.6365 - val_loss: 0.7927 - val_accuracy: 0.3983
Confusion matrix: 
 [[233 551]
 [ 94 194]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.297 0.703]
 [0.326 0.674]]
Validation f1: 37.56
Validation accuracy: 39.83
Validation recall: 67.36
Validation precision: 26.04
Validation AUC: 0.26097074239091433
Validation class accuracies: [0.2971938775510204, 0.6736111111111112]
The clause is activated.
The training is defaulting to either class.
Epoch 26/80
264/264 - 128s - loss: 0.6673 - accuracy: 0.6391 - val_loss: 0.7206 - val_accuracy: 0.4776
Confusion matrix: 
 [[353 431]
 [129 159]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.45  0.55 ]
 [0.448 0.552]]
Validation f1: 36.22
Validation accuracy: 47.76
Validation recall: 55.21
Validation precision: 26.95
Validation AUC: 0.28037878799035065
Validation class accuracies: [0.4502551020408163, 0.5520833333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 8 epochs
Epoch 27/80
264/264 - 127s - loss: 0.6656 - accuracy: 0.6484 - val_loss: 0.7923 - val_accuracy: 0.3815
Confusion matrix: 
 [[197 587]
 [ 76 212]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.251 0.749]
 [0.264 0.736]]
Validation f1: 39.01
Validation accuracy: 38.15
Validation recall: 73.61
Validation precision: 26.53
Validation AUC: 0.27228483424199695
Validation class accuracies: [0.2512755102040816, 0.7361111111111112]
The clause is activated.
The training is defaulting to either class.
Epoch 28/80
264/264 - 130s - loss: 0.6648 - accuracy: 0.6429 - val_loss: 0.7501 - val_accuracy: 0.4207
Confusion matrix: 
 [[285 499]
 [122 166]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.364 0.636]
 [0.424 0.576]]
Validation f1: 34.84
Validation accuracy: 42.07
Validation recall: 57.64
Validation precision: 24.96
Validation AUC: 0.258332808745091
Validation class accuracies: [0.3635204081632653, 0.5763888888888888]
The clause is activated.
The training is defaulting to either class.
Epoch 29/80
264/264 - 130s - loss: 0.6631 - accuracy: 0.6458 - val_loss: 0.7569 - val_accuracy: 0.4328
Confusion matrix: 
 [[280 504]
 [104 184]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.357 0.643]
 [0.361 0.639]]
Validation f1: 37.70
Validation accuracy: 43.28
Validation recall: 63.89
Validation precision: 26.74
Validation AUC: 0.2639948874245397
Validation class accuracies: [0.35714285714285715, 0.6388888888888888]
The clause is activated.
The training is defaulting to either class.
Epoch 30/80
264/264 - 127s - loss: 0.6614 - accuracy: 0.6600 - val_loss: 0.7300 - val_accuracy: 0.4608
Confusion matrix: 
 [[295 489]
 [ 89 199]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.376 0.624]
 [0.309 0.691]]
Validation f1: 40.78
Validation accuracy: 46.08
Validation recall: 69.10
Validation precision: 28.92
Validation AUC: 0.29477181741018404
Validation class accuracies: [0.3762755102040816, 0.6909722222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 31/80
264/264 - 129s - loss: 0.6612 - accuracy: 0.6538 - val_loss: 0.7626 - val_accuracy: 0.4076
Confusion matrix: 
 [[223 561]
 [ 74 214]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.284 0.716]
 [0.257 0.743]]
Validation f1: 40.26
Validation accuracy: 40.76
Validation recall: 74.31
Validation precision: 27.61
Validation AUC: 0.27295791432483796
Validation class accuracies: [0.2844387755102041, 0.7430555555555556]
The clause is activated.
The training is defaulting to either class.
Epoch 32/80
264/264 - 133s - loss: 0.6604 - accuracy: 0.6600 - val_loss: 0.7147 - val_accuracy: 0.5168
Confusion matrix: 
 [[422 362]
 [156 132]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.538 0.462]
 [0.542 0.458]]
Validation f1: 33.76
Validation accuracy: 51.68
Validation recall: 45.83
Validation precision: 26.72
Validation AUC: 0.2663619873961983
Validation class accuracies: [0.5382653061224489, 0.4583333333333333]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 9 epochs
Epoch 33/80
264/264 - 124s - loss: 0.6593 - accuracy: 0.6655 - val_loss: 0.7379 - val_accuracy: 0.4636
Confusion matrix: 
 [[341 443]
 [132 156]]
Normalized Confusion matrix: 
 [[0.435 0.565]
 [0.458 0.542]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 35.17
Validation accuracy: 46.36
Validation recall: 54.17
Validation precision: 26.04
Validation AUC: 0.26150259685342925
Validation class accuracies: [0.43494897959183676, 0.5416666666666666]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 10 epochs
Epoch 34/80
264/264 - 129s - loss: 0.6569 - accuracy: 0.6717 - val_loss: 0.7616 - val_accuracy: 0.4450
Confusion matrix: 
 [[277 507]
 [ 88 200]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.353 0.647]
 [0.306 0.694]]
Validation f1: 40.20
Validation accuracy: 44.50
Validation recall: 69.44
Validation precision: 28.29
Validation AUC: 0.27364158189801263
Validation class accuracies: [0.35331632653061223, 0.6944444444444444]
The clause is activated.
The training is defaulting to either class.
Epoch 35/80
264/264 - 130s - loss: 0.6569 - accuracy: 0.6743 - val_loss: 0.7505 - val_accuracy: 0.4478
Confusion matrix: 
 [[300 484]
 [108 180]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.383 0.617]
 [0.375 0.625]]
Validation f1: 37.82
Validation accuracy: 44.78
Validation recall: 62.50
Validation precision: 27.11
Validation AUC: 0.2675757445883813
Validation class accuracies: [0.3826530612244898, 0.625]
The clause is activated.
The training is defaulting to either class.
Epoch 36/80
264/264 - 130s - loss: 0.6566 - accuracy: 0.6797 - val_loss: 0.7619 - val_accuracy: 0.4198
Confusion matrix: 
 [[247 537]
 [ 85 203]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.315 0.685]
 [0.295 0.705]]
Validation f1: 39.49
Validation accuracy: 41.98
Validation recall: 70.49
Validation precision: 27.43
Validation AUC: 0.2785628420630172
Validation class accuracies: [0.31505102040816324, 0.7048611111111112]
The clause is activated.
The training is defaulting to either class.
Epoch 37/80
264/264 - 128s - loss: 0.6563 - accuracy: 0.6752 - val_loss: 0.7544 - val_accuracy: 0.4394
Confusion matrix: 
 [[277 507]
 [ 94 194]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.353 0.647]
 [0.326 0.674]]
Validation f1: 39.23
Validation accuracy: 43.94
Validation recall: 67.36
Validation precision: 27.67
Validation AUC: 0.2869408255624475
Validation class accuracies: [0.35331632653061223, 0.6736111111111112]
The clause is activated.
The training is defaulting to either class.
Epoch 38/80
264/264 - 131s - loss: 0.6532 - accuracy: 0.6830 - val_loss: 0.7586 - val_accuracy: 0.4543
Confusion matrix: 
 [[328 456]
 [129 159]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.418 0.582]
 [0.448 0.552]]
Validation f1: 35.22
Validation accuracy: 45.43
Validation recall: 55.21
Validation precision: 25.85
Validation AUC: 0.2623507330827331
Validation class accuracies: [0.41836734693877553, 0.5520833333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 11 epochs
Epoch 39/80
264/264 - 128s - loss: 0.6525 - accuracy: 0.6859 - val_loss: 0.8028 - val_accuracy: 0.3983
Confusion matrix: 
 [[206 578]
 [ 67 221]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.263 0.737]
 [0.233 0.767]]
Validation f1: 40.66
Validation accuracy: 39.83
Validation recall: 76.74
Validation precision: 27.66
Validation AUC: 0.2713632789089019
Validation class accuracies: [0.2627551020408163, 0.7673611111111112]
The clause is activated.
The training is defaulting to either class.
Epoch 40/80
264/264 - 129s - loss: 0.6517 - accuracy: 0.6895 - val_loss: 0.7642 - val_accuracy: 0.4478
Confusion matrix: 
 [[305 479]
 [113 175]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.389 0.611]
 [0.392 0.608]]
Validation f1: 37.15
Validation accuracy: 44.78
Validation recall: 60.76
Validation precision: 26.76
Validation AUC: 0.2658200401806109
Validation class accuracies: [0.38903061224489793, 0.6076388888888888]
The clause is activated.
The training is defaulting to either class.
Epoch 41/80
264/264 - 127s - loss: 0.6522 - accuracy: 0.6857 - val_loss: 0.7234 - val_accuracy: 0.5019
Confusion matrix: 
 [[396 388]
 [146 142]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.505 0.495]
 [0.507 0.493]]
Validation f1: 34.72
Validation accuracy: 50.19
Validation recall: 49.31
Validation precision: 26.79
Validation AUC: 0.2649429486598906
Validation class accuracies: [0.5051020408163265, 0.4930555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0005624999757856131
Epoch 42/80
264/264 - 130s - loss: 0.6490 - accuracy: 0.7037 - val_loss: 0.7735 - val_accuracy: 0.4375
Confusion matrix: 
 [[285 499]
 [104 184]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.364 0.636]
 [0.361 0.639]]
Validation f1: 37.90
Validation accuracy: 43.75
Validation recall: 63.89
Validation precision: 26.94
Validation AUC: 0.26186495140836136
Validation class accuracies: [0.3635204081632653, 0.6388888888888888]
The clause is activated.
The training is defaulting to either class.
Epoch 43/80
264/264 - 130s - loss: 0.6473 - accuracy: 0.7001 - val_loss: 0.7915 - val_accuracy: 0.4375
Confusion matrix: 
 [[309 475]
 [128 160]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.394 0.606]
 [0.444 0.556]]
Validation f1: 34.67
Validation accuracy: 43.75
Validation recall: 55.56
Validation precision: 25.20
Validation AUC: 0.2505775559592801
Validation class accuracies: [0.39413265306122447, 0.5555555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 13 epochs
Epoch 44/80
264/264 - 127s - loss: 0.6484 - accuracy: 0.6973 - val_loss: 0.7922 - val_accuracy: 0.4216
Confusion matrix: 
 [[257 527]
 [ 93 195]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.328 0.672]
 [0.323 0.677]]
Validation f1: 38.61
Validation accuracy: 42.16
Validation recall: 67.71
Validation precision: 27.01
Validation AUC: 0.26256197448913887
Validation class accuracies: [0.3278061224489796, 0.6770833333333334]
The clause is activated.
The training is defaulting to either class.
Epoch 45/80
264/264 - 128s - loss: 0.6472 - accuracy: 0.7049 - val_loss: 0.7904 - val_accuracy: 0.4170
Confusion matrix: 
 [[259 525]
 [100 188]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.33  0.67 ]
 [0.347 0.653]]
Validation f1: 37.56
Validation accuracy: 41.70
Validation recall: 65.28
Validation precision: 26.37
Validation AUC: 0.257667783991592
Validation class accuracies: [0.33035714285714285, 0.6527777777777778]
The clause is activated.
The training is defaulting to either class.
Epoch 46/80
264/264 - 129s - loss: 0.6449 - accuracy: 0.7099 - val_loss: 0.7954 - val_accuracy: 0.4347
Confusion matrix: 
 [[292 492]
 [114 174]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.372 0.628]
 [0.396 0.604]]
Validation f1: 36.48
Validation accuracy: 43.47
Validation recall: 60.42
Validation precision: 26.13
Validation AUC: 0.25445128452910887
Validation class accuracies: [0.37244897959183676, 0.6041666666666666]
The clause is activated.
The training is defaulting to either class.
Epoch 47/80
264/264 - 127s - loss: 0.6453 - accuracy: 0.7132 - val_loss: 0.7461 - val_accuracy: 0.5075
Confusion matrix: 
 [[420 364]
 [164 124]]
Normalized Confusion matrix: 
 [[0.536 0.464]
 [0.569 0.431]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 31.96
Validation accuracy: 50.75
Validation recall: 43.06
Validation precision: 25.41
Validation AUC: 0.25600469842239804
Validation class accuracies: [0.5357142857142857, 0.4305555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 14 epochs
Epoch 48/80
264/264 - 128s - loss: 0.6435 - accuracy: 0.7120 - val_loss: 0.7807 - val_accuracy: 0.4328
Confusion matrix: 
 [[283 501]
 [107 181]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.361 0.639]
 [0.372 0.628]]
Validation f1: 37.32
Validation accuracy: 43.28
Validation recall: 62.85
Validation precision: 26.54
Validation AUC: 0.2573390146412509
Validation class accuracies: [0.36096938775510207, 0.6284722222222222]
The clause is activated.
The training is defaulting to either class.
Epoch 49/80
264/264 - 128s - loss: 0.6427 - accuracy: 0.7182 - val_loss: 0.7590 - val_accuracy: 0.5093
Confusion matrix: 
 [[446 338]
 [188 100]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.569 0.431]
 [0.653 0.347]]
Validation f1: 27.55
Validation accuracy: 50.93
Validation recall: 34.72
Validation precision: 22.83
Validation AUC: 0.24724267021994384
Validation class accuracies: [0.5688775510204082, 0.3472222222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 15 epochs
Epoch 50/80
264/264 - 128s - loss: 0.6430 - accuracy: 0.7144 - val_loss: 0.7536 - val_accuracy: 0.4711
Confusion matrix: 
 [[346 438]
 [129 159]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.441 0.559]
 [0.448 0.552]]
Validation f1: 35.93
Validation accuracy: 47.11
Validation recall: 55.21
Validation precision: 26.63
Validation AUC: 0.267626378453905
Validation class accuracies: [0.4413265306122449, 0.5520833333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 16 epochs
Epoch 51/80
264/264 - 128s - loss: 0.6424 - accuracy: 0.7244 - val_loss: 0.7831 - val_accuracy: 0.4562
Confusion matrix: 
 [[344 440]
 [143 145]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.439 0.561]
 [0.497 0.503]]
Validation f1: 33.22
Validation accuracy: 45.62
Validation recall: 50.35
Validation precision: 24.79
Validation AUC: 0.25162031236056703
Validation class accuracies: [0.4387755102040816, 0.5034722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 17 epochs
Epoch 52/80
264/264 - 128s - loss: 0.6402 - accuracy: 0.7184 - val_loss: 0.7810 - val_accuracy: 0.4450
Confusion matrix: 
 [[325 459]
 [136 152]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.415 0.585]
 [0.472 0.528]]
Validation f1: 33.82
Validation accuracy: 44.50
Validation recall: 52.78
Validation precision: 24.88
Validation AUC: 0.251899771341211
Validation class accuracies: [0.4145408163265306, 0.5277777777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0004218749818392098
Epoch 53/80
264/264 - 129s - loss: 0.6372 - accuracy: 0.7255 - val_loss: 0.7566 - val_accuracy: 0.4944
Confusion matrix: 
 [[406 378]
 [164 124]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.518 0.482]
 [0.569 0.431]]
Validation f1: 31.39
Validation accuracy: 49.44
Validation recall: 43.06
Validation precision: 24.70
Validation AUC: 0.2539044854668051
Validation class accuracies: [0.5178571428571429, 0.4305555555555556]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 19 epochs
Epoch 54/80
264/264 - 127s - loss: 0.6385 - accuracy: 0.7322 - val_loss: 0.7654 - val_accuracy: 0.5047
Confusion matrix: 
 [[424 360]
 [171 117]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.541 0.459]
 [0.594 0.406]]
Validation f1: 30.59
Validation accuracy: 50.47
Validation recall: 40.62
Validation precision: 24.53
Validation AUC: 0.2480865050318471
Validation class accuracies: [0.5408163265306123, 0.40625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 20 epochs
Epoch 55/80
264/264 - 127s - loss: 0.6374 - accuracy: 0.7298 - val_loss: 0.8009 - val_accuracy: 0.4468
Confusion matrix: 
 [[322 462]
 [131 157]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.411 0.589]
 [0.455 0.545]]
Validation f1: 34.62
Validation accuracy: 44.68
Validation recall: 54.51
Validation precision: 25.36
Validation AUC: 0.25047317620553944
Validation class accuracies: [0.4107142857142857, 0.5451388888888888]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 21 epochs
Epoch 56/80
264/264 - 130s - loss: 0.6398 - accuracy: 0.7255 - val_loss: 0.7796 - val_accuracy: 0.4580
Confusion matrix: 
 [[356 428]
 [153 135]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.454 0.546]
 [0.531 0.469]]
Validation f1: 31.73
Validation accuracy: 45.80
Validation recall: 46.88
Validation precision: 23.98
Validation AUC: 0.24986056532800272
Validation class accuracies: [0.45408163265306123, 0.46875]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 22 epochs
Epoch 57/80
264/264 - 127s - loss: 0.6370 - accuracy: 0.7310 - val_loss: 0.7708 - val_accuracy: 0.4851
Confusion matrix: 
 [[403 381]
 [171 117]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.514 0.486]
 [0.594 0.406]]
Validation f1: 29.77
Validation accuracy: 48.51
Validation recall: 40.62
Validation precision: 23.49
Validation AUC: 0.2478213479026252
Validation class accuracies: [0.514030612244898, 0.40625]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 23 epochs
Epoch 58/80
264/264 - 127s - loss: 0.6360 - accuracy: 0.7360 - val_loss: 0.7744 - val_accuracy: 0.4804
Confusion matrix: 
 [[385 399]
 [158 130]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.491 0.509]
 [0.549 0.451]]
Validation f1: 31.82
Validation accuracy: 48.04
Validation recall: 45.14
Validation precision: 24.57
Validation AUC: 0.2496579071775038
Validation class accuracies: [0.49107142857142855, 0.4513888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 24 epochs
Lr has been adjusted to 0.0003164062509313226
Epoch 59/80
264/264 - 127s - loss: 0.6369 - accuracy: 0.7303 - val_loss: 0.7727 - val_accuracy: 0.5000
Confusion matrix: 
 [[424 360]
 [176 112]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.541 0.459]
 [0.611 0.389]]
Validation f1: 29.47
Validation accuracy: 50.00
Validation recall: 38.89
Validation precision: 23.73
Validation AUC: 0.24776405737214863
Validation class accuracies: [0.5408163265306123, 0.3888888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 25 epochs
Epoch 60/80
264/264 - 126s - loss: 0.6343 - accuracy: 0.7405 - val_loss: 0.7734 - val_accuracy: 0.4701
Confusion matrix: 
 [[359 425]
 [143 145]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.458 0.542]
 [0.497 0.503]]
Validation f1: 33.80
Validation accuracy: 47.01
Validation recall: 50.35
Validation precision: 25.44
Validation AUC: 0.2540737367121547
Validation class accuracies: [0.45790816326530615, 0.5034722222222222]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 26 epochs
Epoch 61/80
264/264 - 128s - loss: 0.6343 - accuracy: 0.7386 - val_loss: 0.7577 - val_accuracy: 0.5056
Confusion matrix: 
 [[421 363]
 [167 121]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.537 0.463]
 [0.58  0.42 ]]
Validation f1: 31.35
Validation accuracy: 50.56
Validation recall: 42.01
Validation precision: 25.00
Validation AUC: 0.25267172889674155
Validation class accuracies: [0.5369897959183674, 0.4201388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 27 epochs
Epoch 62/80
264/264 - 128s - loss: 0.6351 - accuracy: 0.7367 - val_loss: 0.7652 - val_accuracy: 0.5168
Confusion matrix: 
 [[451 333]
 [185 103]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.575 0.425]
 [0.642 0.358]]
Validation f1: 28.45
Validation accuracy: 51.68
Validation recall: 35.76
Validation precision: 23.62
Validation AUC: 0.24845046424473316
Validation class accuracies: [0.5752551020408163, 0.3576388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 28 epochs
Epoch 63/80
264/264 - 129s - loss: 0.6348 - accuracy: 0.7348 - val_loss: 0.7914 - val_accuracy: 0.4487
Confusion matrix: 
 [[341 443]
 [148 140]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.435 0.565]
 [0.514 0.486]]
Validation f1: 32.15
Validation accuracy: 44.87
Validation recall: 48.61
Validation precision: 24.01
Validation AUC: 0.24938888760108618
Validation class accuracies: [0.43494897959183676, 0.4861111111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 29 epochs
Epoch 64/80
264/264 - 126s - loss: 0.6336 - accuracy: 0.7388 - val_loss: 0.7990 - val_accuracy: 0.4487
Confusion matrix: 
 [[322 462]
 [129 159]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.411 0.589]
 [0.448 0.552]]
Validation f1: 34.98
Validation accuracy: 44.87
Validation recall: 55.21
Validation precision: 25.60
Validation AUC: 0.2505005513002915
Validation class accuracies: [0.4107142857142857, 0.5520833333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 30 epochs
Lr has been adjusted to 0.00023730468819849193
Epoch 65/80
264/264 - 128s - loss: 0.6342 - accuracy: 0.7410 - val_loss: 0.7986 - val_accuracy: 0.4534
Confusion matrix: 
 [[336 448]
 [138 150]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.429 0.571]
 [0.479 0.521]]
Validation f1: 33.86
Validation accuracy: 45.34
Validation recall: 52.08
Validation precision: 25.08
Validation AUC: 0.24948981414034163
Validation class accuracies: [0.42857142857142855, 0.5208333333333334]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 31 epochs
Epoch 66/80
264/264 - 128s - loss: 0.6327 - accuracy: 0.7441 - val_loss: 0.7898 - val_accuracy: 0.4757
Confusion matrix: 
 [[385 399]
 [163 125]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.491 0.509]
 [0.566 0.434]]
Validation f1: 30.79
Validation accuracy: 47.57
Validation recall: 43.40
Validation precision: 23.85
Validation AUC: 0.24443429618077345
Validation class accuracies: [0.49107142857142855, 0.4340277777777778]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 32 epochs
Epoch 67/80
264/264 - 126s - loss: 0.6313 - accuracy: 0.7512 - val_loss: 0.7869 - val_accuracy: 0.4795
Confusion matrix: 
 [[384 400]
 [158 130]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.49  0.51 ]
 [0.549 0.451]]
Validation f1: 31.78
Validation accuracy: 47.95
Validation recall: 45.14
Validation precision: 24.53
Validation AUC: 0.24806289782571733
Validation class accuracies: [0.4897959183673469, 0.4513888888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 33 epochs
Epoch 68/80
264/264 - 127s - loss: 0.6328 - accuracy: 0.7365 - val_loss: 0.7852 - val_accuracy: 0.4655
Confusion matrix: 
 [[368 416]
 [157 131]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.469 0.531]
 [0.545 0.455]]
Validation f1: 31.38
Validation accuracy: 46.55
Validation recall: 45.49
Validation precision: 23.95
Validation AUC: 0.2514040373260774
Validation class accuracies: [0.46938775510204084, 0.4548611111111111]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 34 epochs
Epoch 69/80
264/264 - 127s - loss: 0.6303 - accuracy: 0.7500 - val_loss: 0.7962 - val_accuracy: 0.4580
Confusion matrix: 
 [[354 430]
 [151 137]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.452 0.548]
 [0.524 0.476]]
Validation f1: 32.05
Validation accuracy: 45.80
Validation recall: 47.57
Validation precision: 24.16
Validation AUC: 0.24765389403075921
Validation class accuracies: [0.45153061224489793, 0.4756944444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 35 epochs
Epoch 70/80
264/264 - 126s - loss: 0.6319 - accuracy: 0.7429 - val_loss: 0.7720 - val_accuracy: 0.4813
Confusion matrix: 
 [[395 389]
 [167 121]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.504 0.496]
 [0.58  0.42 ]]
Validation f1: 30.33
Validation accuracy: 48.13
Validation recall: 42.01
Validation precision: 23.73
Validation AUC: 0.24990820503145783
Validation class accuracies: [0.5038265306122449, 0.4201388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 36 epochs
Lr has been adjusted to 0.00017797850887291133
Epoch 71/80
264/264 - 127s - loss: 0.6321 - accuracy: 0.7483 - val_loss: 0.7765 - val_accuracy: 0.4841
Confusion matrix: 
 [[398 386]
 [167 121]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.508 0.492]
 [0.58  0.42 ]]
Validation f1: 30.44
Validation accuracy: 48.41
Validation recall: 42.01
Validation precision: 23.87
Validation AUC: 0.24930761981323113
Validation class accuracies: [0.5076530612244898, 0.4201388888888889]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 37 epochs
Epoch 72/80
264/264 - 127s - loss: 0.6319 - accuracy: 0.7493 - val_loss: 0.7765 - val_accuracy: 0.5000
Confusion matrix: 
 [[417 367]
 [169 119]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.532 0.468]
 [0.587 0.413]]
Validation f1: 30.75
Validation accuracy: 50.00
Validation recall: 41.32
Validation precision: 24.49
Validation AUC: 0.24863917985260997
Validation class accuracies: [0.5318877551020408, 0.4131944444444444]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 38 epochs
Epoch 73/80
264/264 - 128s - loss: 0.6320 - accuracy: 0.7431 - val_loss: 0.7793 - val_accuracy: 0.4841
Confusion matrix: 
 [[393 391]
 [162 126]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.501 0.499]
 [0.562 0.438]]
Validation f1: 31.30
Validation accuracy: 48.41
Validation recall: 43.75
Validation precision: 24.37
Validation AUC: 0.25024680523858905
Validation class accuracies: [0.5012755102040817, 0.4375]
The clause is activated.
Not defaulting.
The validation tracker metric at 0.4078341013824885 hasn't increased by 0 in 39 epochs
Epoch 74/80
264/264 - 126s - loss: 0.6288 - accuracy: 0.7569 - val_loss: 0.7856 - val_accuracy: 0.4860
Confusion matrix: 
 [[397 387]
 [164 124]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.506 0.494]
 [0.569 0.431]]
Validation f1: 31.04
Validation accuracy: 48.60
Validation recall: 43.06
Validation precision: 24.27
Validation AUC: 0.2478477204586137
Validation class accuracies: [0.5063775510204082, 0.4305555555555556]

The metrics for job 0 with the best target metric are: 
Best cm: [[381 403]
 [111 177]]
Best normalized cm: [[0.486 0.514]
 [0.385 0.615]]
Best f1: 0.41
Best accuracy: 0.52
Best recall: 0.61
Best precision: 0.31
Best AUC: 0.33
Best class accuracies: [0.48596938775510207, 0.6145833333333334]
Best epoch: 7
The clause is activated.
Not defaulting.
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2213.py", line 445, in <module>
    train_model(train_file, job_dir, params, wav_params, spec_params)
  File "/home/alirachidi/classification_algorithm/trainers/main/models/conv/train2213.py", line 364, in train_model
    model = conv2d(**model_params)
NameError: name 'conv2d' is not defined
wandb: Waiting for W&B process to finish, PID 16514
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210611_134937-14oacmnk/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210611_134937-14oacmnk/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.75689
wandb:         val_accuracy 0.48601
wandb:             _runtime 10925
wandb:           _timestamp 1623430302
wandb:                _step 523
wandb:           train_loss 0.62884
wandb:             val_loss 0.78561
wandb:           val_recall 0.43056
wandb:        val_precision 0.24266
wandb:               val_f1 0.31039
wandb:              val_auc 0.24785
wandb:                   lr 0.00018
wandb:          best_val_f1 0.40783
wandb:    best_val_accuracy 0.52052
wandb:   best_val_precision 0.30517
wandb:      best_val_recall 0.61458
wandb:             best_auc 0.32587
wandb:           best_epoch 7
wandb: Run history:
wandb:   train_accuracy ▁▂▂▂▂▃▃▄▃▃▄▄▄▅▅▅▅▅▆▆▆▆▇▆▇▇▇▇▇▇▇▇█▇▇█▇███
wandb:     val_accuracy ▁▅▄▁▃▂▂█▄▇▃▂▃▃▃▄▅▆▄▄▄▄▄▄▄▅▅▄▅▄▅▅▅▆▄▅▅▅▅▅
wandb:         _runtime ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       _timestamp ▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:       train_loss ███▇▇▇▇▆▆▆▆▆▅▅▅▅▄▄▄▄▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁
wandb:         val_loss ▃▂▂▅▃▅▆▁▃▁▄█▇▆▆▄▃▃▄▄▄▄▅▆▅▄▄▅▄▆▅▅▅▄▆▅▅▅▅▅
wandb:       val_recall █▆▅▇▇▇▇▁▅▃▆▇▅▅▅▄▅▃▅▅▄▄▄▅▅▂▂▃▂▄▂▂▃▂▄▂▃▂▂▂
wandb:    val_precision ▄▇▅▄▅▄▄█▄█▄▄▄▃▄▄▆▄▅▅▃▄▄▄▄▃▁▃▂▃▂▂▃▂▃▂▂▂▂▂
wandb:           val_f1 ██▇▇█▇▇▂▆▆▇▇▆▆▆▆▇▄▇▆▄▅▆▆▆▃▁▄▃▄▂▂▄▁▄▂▃▂▂▃
wandb:          val_auc ▆█▇▆▇▆▄▇▆█▅▄▂▂▃▃▅▃▃▄▂▃▂▃▂▂▁▂▂▂▁▁▂▁▂▁▂▁▁▁
wandb:               lr ███████████▆▆▆▆▆▆▆▆▆▆▆▄▄▄▄▄▄▃▃▃▂▂▂▂▂▂▂▁▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210611_134937-14oacmnk


 See logs at ../../new_cache/conv__2213__06_1349__v29__old_lstm2_wlabelsmoothing/logs/