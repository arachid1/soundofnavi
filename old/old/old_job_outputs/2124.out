Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
File:  conv.train2124
Description:  model9_newparams
2021-05-11 04:02:15.438890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:02:17.829561: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 04:02:17.830672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-11 04:02:17.881411: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:17.882193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 04:02:17.882251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:02:17.886004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 04:02:17.886129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 04:02:17.887352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 04:02:17.887694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 04:02:17.888734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 04:02:17.889736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 04:02:17.889932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 04:02:17.890055: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:17.890891: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:17.891566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
wandb: Currently logged in as: arachid1 (use `wandb login --relogin` to force relogin)
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2124.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v29_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../new_cache/conv__2124__05_0400__v29__model9_newparams/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.0001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0.4}
Learning Rate Parameters: {'factor': 0.75, 'patience': 4, 'min_lr': 1e-10}
Early Stopping Patience and Delta: 20, 2.0%
Six: False and Concat: False
-----------------------
wandb: wandb version 0.10.30 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.29
wandb: Syncing run train2124
wandb: ‚≠êÔ∏è View project at https://wandb.ai/arachid1/tensorboard-integration
wandb: üöÄ View run at https://wandb.ai/arachid1/tensorboard-integration/runs/1tgjgo5w
wandb: Run data is saved locally in /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_040218-1tgjgo5w
wandb: Run `wandb offline` to turn off syncing.
2021-05-11 04:02:23.132028: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-11 04:02:23.132288: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:23.133057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-05-11 04:02:23.133118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:02:23.133207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 04:02:23.133244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 04:02:23.133285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-11 04:02:23.133320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-11 04:02:23.133354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-11 04:02:23.133388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-05-11 04:02:23.133420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-05-11 04:02:23.133551: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:23.134447: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:23.135140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-11 04:02:23.135195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-05-11 04:02:23.876485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-11 04:02:23.876534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-11 04:02:23.876545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-11 04:02:23.876850: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:23.877733: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:23.878571: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-05-11 04:02:23.879325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-05-11 04:03:02.989794: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-11 04:03:02.991496: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-05-11 04:03:06.365247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-05-11 04:03:07.160956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-05-11 04:03:07.171549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8

Original number of folders: 453
here
With concat = False and six = False, size of training set: 4196...
...and size of validation set: 1088
Initializing weights...
weights = {0: 0.7018518518518518, 1: 1.738532110091743}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            513         global_average_pooling2d[0][0]   
==================================================================================================
Total params: 6,200,749
Trainable params: 6,159,239
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
263/263 - 506s - loss: 0.7224 - accuracy: 0.5455 - val_loss: 0.6343 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2687321083313098
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.2687321083313098
Epoch 2/40
263/263 - 500s - loss: 0.6860 - accuracy: 0.5782 - val_loss: 0.6394 - val_accuracy: 0.7996
Confusion matrix: 
 [[870   0]
 [218   0]]
Validation f1: 0.00
Validation accuracy: 79.96
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22048203400481958
Validation class accuracies: [1.0, 0.0]
TARGET: 0
target metric(test auc): 0.22048203400481958
Epoch 3/40
263/263 - 499s - loss: 0.6821 - accuracy: 0.6001 - val_loss: 0.6373 - val_accuracy: 0.7969
Confusion matrix: 
 [[865   5]
 [216   2]]
Validation f1: 1.78
Validation accuracy: 79.69
Validation recall: 0.92
Validation precision: 28.57
Validation AUC: 0.2265908272153842
Validation class accuracies: [0.9942528735632183, 0.009174311926605505]
TARGET: 0
target metric(test auc): 0.2265908272153842
Epoch 4/40
263/263 - 501s - loss: 0.6767 - accuracy: 0.6051 - val_loss: 0.6700 - val_accuracy: 0.7546
Confusion matrix: 
 [[805  65]
 [202  16]]
Validation f1: 10.70
Validation accuracy: 75.46
Validation recall: 7.34
Validation precision: 19.75
Validation AUC: 0.19136034624835804
Validation class accuracies: [0.9252873563218391, 0.07339449541284404]
TARGET: 0
target metric(test auc): 0.19136034624835804
Epoch 5/40
263/263 - 500s - loss: 0.6708 - accuracy: 0.6232 - val_loss: 0.6753 - val_accuracy: 0.7197
Confusion matrix: 
 [[746 124]
 [181  37]]
Validation f1: 19.53
Validation accuracy: 71.97
Validation recall: 16.97
Validation precision: 22.98
Validation AUC: 0.2307786793082915
Validation class accuracies: [0.8574712643678161, 0.16972477064220184]
TARGET: 0
target metric(test auc): 0.2307786793082915
Saving model...
Epoch 6/40
263/263 - 500s - loss: 0.6685 - accuracy: 0.6382 - val_loss: 0.6628 - val_accuracy: 0.6875
Confusion matrix: 
 [[713 157]
 [183  35]]
Validation f1: 17.07
Validation accuracy: 68.75
Validation recall: 16.06
Validation precision: 18.23
Validation AUC: 0.20768400498761783
Validation class accuracies: [0.8195402298850575, 0.16055045871559634]
TARGET: 0
target metric(test auc): 0.20768400498761783
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 1 epochs
Epoch 7/40
263/263 - 500s - loss: 0.6656 - accuracy: 0.6490 - val_loss: 0.6503 - val_accuracy: 0.7601
Confusion matrix: 
 [[822  48]
 [213   5]]
Validation f1: 3.69
Validation accuracy: 76.01
Validation recall: 2.29
Validation precision: 9.43
Validation AUC: 0.19219991615990073
Validation class accuracies: [0.9448275862068966, 0.022935779816513763]
TARGET: 0
target metric(test auc): 0.19219991615990073
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 2 epochs
Epoch 8/40
263/263 - 499s - loss: 0.6618 - accuracy: 0.6549 - val_loss: 0.7431 - val_accuracy: 0.3971
Confusion matrix: 
 [[317 553]
 [103 115]]
Validation f1: 25.96
Validation accuracy: 39.71
Validation recall: 52.75
Validation precision: 17.22
Validation AUC: 0.1835869975651886
Validation class accuracies: [0.364367816091954, 0.5275229357798165]
TARGET: 0
target metric(test auc): 0.1835869975651886
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 3 epochs
Epoch 9/40
263/263 - 499s - loss: 0.6543 - accuracy: 0.6776 - val_loss: 0.6939 - val_accuracy: 0.6085
Confusion matrix: 
 [[581 289]
 [137  81]]
Validation f1: 27.55
Validation accuracy: 60.85
Validation recall: 37.16
Validation precision: 21.89
Validation AUC: 0.2206986328952396
Validation class accuracies: [0.667816091954023, 0.37155963302752293]
TARGET: 0
target metric(test auc): 0.2206986328952396
Lr has been adjusted to 7.499999628635123e-05
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 4 epochs
Epoch 10/40
263/263 - 499s - loss: 0.6446 - accuracy: 0.7035 - val_loss: 0.7007 - val_accuracy: 0.5846
Confusion matrix: 
 [[549 321]
 [131  87]]
Validation f1: 27.80
Validation accuracy: 58.46
Validation recall: 39.91
Validation precision: 21.32
Validation AUC: 0.21682932766112523
Validation class accuracies: [0.6310344827586207, 0.39908256880733944]
TARGET: 0
target metric(test auc): 0.21682932766112523
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 5 epochs
Epoch 11/40
263/263 - 499s - loss: 0.6347 - accuracy: 0.7226 - val_loss: 0.7529 - val_accuracy: 0.4954
Confusion matrix: 
 [[417 453]
 [ 96 122]]
Validation f1: 30.77
Validation accuracy: 49.54
Validation recall: 55.96
Validation precision: 21.22
Validation AUC: 0.21456249324777643
Validation class accuracies: [0.4793103448275862, 0.5596330275229358]
TARGET: 0
target metric(test auc): 0.21456249324777643
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 6 epochs
Epoch 12/40
263/263 - 498s - loss: 0.6286 - accuracy: 0.7407 - val_loss: 0.6906 - val_accuracy: 0.6443
Confusion matrix: 
 [[632 238]
 [149  69]]
Validation f1: 26.29
Validation accuracy: 64.43
Validation recall: 31.65
Validation precision: 22.48
Validation AUC: 0.21587520711304173
Validation class accuracies: [0.7264367816091954, 0.3165137614678899]
TARGET: 0
target metric(test auc): 0.21587520711304173
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 7 epochs
Epoch 13/40
263/263 - 497s - loss: 0.6190 - accuracy: 0.7660 - val_loss: 0.7431 - val_accuracy: 0.5165
Confusion matrix: 
 [[447 423]
 [103 115]]
Validation f1: 30.42
Validation accuracy: 51.65
Validation recall: 52.75
Validation precision: 21.38
Validation AUC: 0.20438251899985227
Validation class accuracies: [0.5137931034482759, 0.5275229357798165]
TARGET: 0
target metric(test auc): 0.20438251899985227
Lr has been adjusted to 5.624999903375283e-05
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 8 epochs
Epoch 14/40
263/263 - 498s - loss: 0.6097 - accuracy: 0.7865 - val_loss: 0.8747 - val_accuracy: 0.3189
Confusion matrix: 
 [[206 664]
 [ 77 141]]
Validation f1: 27.57
Validation accuracy: 31.89
Validation recall: 64.68
Validation precision: 17.52
Validation AUC: 0.18093908065253086
Validation class accuracies: [0.2367816091954023, 0.6467889908256881]
TARGET: 0
target metric(test auc): 0.18093908065253086
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 9 epochs
Epoch 15/40
263/263 - 499s - loss: 0.5990 - accuracy: 0.8010 - val_loss: 0.6849 - val_accuracy: 0.7463
Confusion matrix: 
 [[794  76]
 [200  18]]
Validation f1: 11.54
Validation accuracy: 74.63
Validation recall: 8.26
Validation precision: 19.15
Validation AUC: 0.20197209335497202
Validation class accuracies: [0.9126436781609195, 0.08256880733944955]
TARGET: 0
target metric(test auc): 0.20197209335497202
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 10 epochs
Epoch 16/40
263/263 - 498s - loss: 0.5932 - accuracy: 0.8272 - val_loss: 0.7052 - val_accuracy: 0.6397
Confusion matrix: 
 [[633 237]
 [155  63]]
Validation f1: 24.32
Validation accuracy: 63.97
Validation recall: 28.90
Validation precision: 21.00
Validation AUC: 0.21404453801007184
Validation class accuracies: [0.7275862068965517, 0.2889908256880734]
TARGET: 0
target metric(test auc): 0.21404453801007184
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 11 epochs
Epoch 17/40
263/263 - 498s - loss: 0.5856 - accuracy: 0.8425 - val_loss: 0.8776 - val_accuracy: 0.4136
Confusion matrix: 
 [[285 585]
 [ 53 165]]
Validation f1: 34.09
Validation accuracy: 41.36
Validation recall: 75.69
Validation precision: 22.00
Validation AUC: 0.23295388800545885
Validation class accuracies: [0.3275862068965517, 0.7568807339449541]
TARGET: 0
target metric(test auc): 0.23295388800545885
Lr has been adjusted to 4.2187501094304025e-05
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 12 epochs
Saving model...
Epoch 18/40
263/263 - 498s - loss: 0.5802 - accuracy: 0.8561 - val_loss: 0.7453 - val_accuracy: 0.5579
Confusion matrix: 
 [[513 357]
 [124  94]]
Validation f1: 28.10
Validation accuracy: 55.79
Validation recall: 43.12
Validation precision: 20.84
Validation AUC: 0.21869755178419292
Validation class accuracies: [0.5896551724137931, 0.43119266055045874]
TARGET: 0
target metric(test auc): 0.21869755178419292
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 13 epochs
Epoch 19/40
263/263 - 498s - loss: 0.5739 - accuracy: 0.8622 - val_loss: 0.7289 - val_accuracy: 0.5983
Confusion matrix: 
 [[576 294]
 [143  75]]
Validation f1: 25.55
Validation accuracy: 59.83
Validation recall: 34.40
Validation precision: 20.33
Validation AUC: 0.2147869552383566
Validation class accuracies: [0.6620689655172414, 0.3440366972477064]
TARGET: 0
target metric(test auc): 0.2147869552383566
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 14 epochs
Epoch 20/40
263/263 - 496s - loss: 0.5696 - accuracy: 0.8777 - val_loss: 0.7572 - val_accuracy: 0.5763
Confusion matrix: 
 [[545 325]
 [136  82]]
Validation f1: 26.24
Validation accuracy: 57.63
Validation recall: 37.61
Validation precision: 20.15
Validation AUC: 0.2184566797596365
Validation class accuracies: [0.6264367816091954, 0.3761467889908257]
TARGET: 0
target metric(test auc): 0.2184566797596365
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 15 epochs
Epoch 21/40
263/263 - 497s - loss: 0.5677 - accuracy: 0.8832 - val_loss: 0.6985 - val_accuracy: 0.7417
Confusion matrix: 
 [[780  90]
 [191  27]]
Validation f1: 16.12
Validation accuracy: 74.17
Validation recall: 12.39
Validation precision: 23.08
Validation AUC: 0.20766682159061628
Validation class accuracies: [0.896551724137931, 0.12385321100917432]
TARGET: 0
target metric(test auc): 0.20766682159061628
Lr has been adjusted to 3.164062582072802e-05
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 16 epochs
Epoch 22/40
263/263 - 497s - loss: 0.5644 - accuracy: 0.8923 - val_loss: 0.7124 - val_accuracy: 0.6857
Confusion matrix: 
 [[707 163]
 [179  39]]
Validation f1: 18.57
Validation accuracy: 68.57
Validation recall: 17.89
Validation precision: 19.31
Validation AUC: 0.21078187252134667
Validation class accuracies: [0.8126436781609195, 0.17889908256880735]
TARGET: 0
target metric(test auc): 0.21078187252134667
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 17 epochs
Epoch 23/40
263/263 - 498s - loss: 0.5583 - accuracy: 0.9073 - val_loss: 0.7358 - val_accuracy: 0.6103
Confusion matrix: 
 [[590 280]
 [144  74]]
Validation f1: 25.87
Validation accuracy: 61.03
Validation recall: 33.94
Validation precision: 20.90
Validation AUC: 0.21343191818520613
Validation class accuracies: [0.6781609195402298, 0.3394495412844037]
TARGET: 0
target metric(test auc): 0.21343191818520613
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 18 epochs
Epoch 24/40
263/263 - 498s - loss: 0.5567 - accuracy: 0.9094 - val_loss: 0.7161 - val_accuracy: 0.6893
Confusion matrix: 
 [[718 152]
 [186  32]]
Validation f1: 15.92
Validation accuracy: 68.93
Validation recall: 14.68
Validation precision: 17.39
Validation AUC: 0.19993129186194336
Validation class accuracies: [0.825287356321839, 0.14678899082568808]
TARGET: 0
target metric(test auc): 0.19993129186194336
The validation tracker metric at 0.2307786793082915 hasn't increased by 0.02 in 19 epochs
Epoch 25/40
263/263 - 498s - loss: 0.5588 - accuracy: 0.9023 - val_loss: 0.7372 - val_accuracy: 0.6121
Confusion matrix: 
 [[591 279]
 [143  75]]
Validation f1: 26.22
Validation accuracy: 61.21
Validation recall: 34.40
Validation precision: 21.19
Validation AUC: 0.22299747260285452
Validation class accuracies: [0.6793103448275862, 0.3440366972477064]

The metrics for the epoch with the best target metric are: 
Best cm: [[285 585]
 [ 53 165]]
Best f1: 0.3409090909090909
Best accuracy: 0.41360294117647056
Best recall: 0.7568807339449541
Best precision: 0.22
Best AUC: 0.23295388800545885
Best epoch: 17
TARGET: 0
target metric(test auc): 0.22299747260285452
Lr has been adjusted to 2.3730470275040716e-05
The number of epochs since last 1% equals the patience

Starting the Bangladesh analysis...
Epoch: 17
Starting...
CM: [[ 1 59]
 [ 0 15]]
F1: 0.3370786516853933
AUC: 0.6013513513513513
Accuracy: 0.21333333333333335
Precision: 0.20270270270270271
Recall: 1.0
Ended. Saving the Excel Sheet ../../new_cache/conv__2124__05_0400__v29__model9_newparams/validation_sheet_17.xls...
Done.
Epoch: 40
Starting...
CM: [[13 47]
 [ 1 14]]
F1: 0.3684210526315789
AUC: 0.588087431693989
Accuracy: 0.36
Precision: 0.22950819672131148
Recall: 0.9333333333333333
Ended. Saving the Excel Sheet ../../new_cache/conv__2124__05_0400__v29__model9_newparams/validation_sheet_40.xls...
Done.
Epoch: 5
Starting...
CM: [[26 34]
 [ 5 10]]
F1: 0.33898305084745756
AUC: 0.4803030303030303
Accuracy: 0.48
Precision: 0.22727272727272727
Recall: 0.6666666666666666
Ended. Saving the Excel Sheet ../../new_cache/conv__2124__05_0400__v29__model9_newparams/validation_sheet_5.xls...
Done.
wandb: Waiting for W&B process to finish, PID 4205
wandb: Program ended successfully.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: | 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_040218-1tgjgo5w/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/run-20210511_040218-1tgjgo5w/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.90229
wandb:         val_accuracy 0.61213
wandb:             _runtime 13065
wandb:           _timestamp 1620718803
wandb:                _step 176
wandb:           train_loss 0.55882
wandb:             val_loss 0.73717
wandb:           val_recall 0.34404
wandb:        val_precision 0.21186
wandb:               val_f1 0.26224
wandb:              val_auc 0.223
wandb:                   lr 3e-05
wandb:          best_val_f1 0.34091
wandb:    best_val_accuracy 0.4136
wandb:   best_val_precision 0.22
wandb:      best_val_recall 0.75688
wandb:             best_auc 0.23295
wandb:           best_epoch 17
wandb:           best_bd_f1 0.33708
wandb:          best_bd_auc 0.60135
wandb:     best_bd_accuracy 0.21333
wandb:    best_bd_precision 0.2027
wandb:       best_bd_recall 1.0
wandb:        best_bd_epoch 17
wandb: Run history:
wandb:   train_accuracy ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:     val_accuracy ‚ñà‚ñà‚ñà‚ñá‚ñá‚ñÜ‚ñá‚ñÇ‚ñÖ‚ñÖ‚ñÑ‚ñÜ‚ñÑ‚ñÅ‚ñá‚ñÜ‚ñÇ‚ñÑ‚ñÖ‚ñÖ‚ñá‚ñÜ‚ñÖ‚ñÜ‚ñÖ
wandb:         _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:            _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:       train_loss ‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:         val_loss ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÑ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñà‚ñÇ‚ñÉ‚ñà‚ñÑ‚ñÑ‚ñÖ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÑ
wandb:       val_recall ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÉ‚ñÇ‚ñÅ‚ñÜ‚ñÑ‚ñÖ‚ñÜ‚ñÑ‚ñÜ‚ñá‚ñÇ‚ñÑ‚ñà‚ñÖ‚ñÑ‚ñÑ‚ñÇ‚ñÉ‚ñÑ‚ñÇ‚ñÑ
wandb:    val_precision ‚ñÅ‚ñÅ‚ñà‚ñÜ‚ñá‚ñÖ‚ñÉ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÜ
wandb:           val_f1 ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÖ‚ñÖ‚ñÇ‚ñÜ‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñÉ‚ñÜ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÑ‚ñÖ‚ñÜ‚ñÑ‚ñÜ
wandb:          val_auc ‚ñà‚ñÑ‚ñÖ‚ñÇ‚ñÖ‚ñÉ‚ñÇ‚ñÅ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÅ‚ñÉ‚ñÑ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÑ
wandb:               lr ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 6 W&B file(s), 2 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced train2124: https://wandb.ai/arachid1/tensorboard-integration/runs/1tgjgo5w


 See logs at ../../new_cache/conv__2124__05_0400__v29__model9_newparams/logs/