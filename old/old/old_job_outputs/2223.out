Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2223
Description:  augmented_jobs
2021-06-16 02:03:54.198681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-16 02:03:56.859171: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 02:03:56.860334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-16 02:03:56.913110: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:03:56.913922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 02:03:56.913956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 02:03:56.918118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 02:03:56.918239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 02:03:56.919536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 02:03:56.919896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 02:03:56.921082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 02:03:56.922106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 02:03:56.922285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 02:03:56.922430: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:03:56.923339: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:03:56.924072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2223.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2223__06_0203__v39__augmented_jobs
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 148, 'WAV_PATH': 'v42,v43'}
Augmentation parameters for spectrograms: {'ADD': 1, 'QUANTITY': 200, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-16 02:04:57.509895: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-16 02:04:57.510289: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:04:57.511134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-16 02:04:57.511192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 02:04:57.511270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 02:04:57.511295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-16 02:04:57.511319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-16 02:04:57.511344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-16 02:04:57.511367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-16 02:04:57.511389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-16 02:04:57.511411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 02:04:57.511513: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:04:57.512318: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:04:57.513040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-16 02:04:57.513097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-16 02:04:58.321816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-16 02:04:58.321874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-16 02:04:58.321884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-16 02:04:58.322232: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:04:58.323191: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:04:58.324000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-16 02:04:58.324743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented
Length of training samples after spec augmentation: 2764
-----------------------
Number of train recordings: 2764 with pneumonia: 464 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2864
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_2
Length of training samples after spec augmentation: 2914
-----------------------
Number of train recordings: 2914 with pneumonia: 464 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-16 02:04:59.869530: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-16 02:04:59.871554: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-16 02:05:00.261432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-16 02:05:02.354950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-16 02:05:02.897580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
183/183 - 266s - loss: 1.4347 - accuracy: 0.5415 - val_loss: 1.1504 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.05322160730585853
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
183/183 - 262s - loss: 0.6140 - accuracy: 0.6187 - val_loss: 0.5403 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.050669632307312376
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
183/183 - 260s - loss: 0.4769 - accuracy: 0.7237 - val_loss: 0.2325 - val_accuracy: 0.9322
Confusion matrix: 
 [[562  11]
 [ 30   2]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.938 0.062]]
Validation f1: 8.89
Validation accuracy: 93.22
Validation recall: 6.25
Validation precision: 15.38
Validation AUC: 0.11533540671103812
Validation class accuracies: [0.9808027923211169, 0.0625]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
183/183 - 258s - loss: 0.5356 - accuracy: 0.7083 - val_loss: 4.2617 - val_accuracy: 0.1967
Confusion matrix: 
 [[ 87 486]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.152 0.848]
 [0.    1.   ]]
Validation f1: 11.64
Validation accuracy: 19.67
Validation recall: 100.00
Validation precision: 6.18
Validation AUC: 0.1148477654250105
Validation class accuracies: [0.1518324607329843, 1.0]
Saving model...
Epoch 5/65
183/183 - 259s - loss: 0.3397 - accuracy: 0.8150 - val_loss: 0.4995 - val_accuracy: 0.8446
Confusion matrix: 
 [[490  83]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.855 0.145]
 [0.344 0.656]]
Validation f1: 30.88
Validation accuracy: 84.46
Validation recall: 65.62
Validation precision: 20.19
Validation AUC: 0.5960958491913536
Validation class accuracies: [0.8551483420593369, 0.65625]
Saving model...
Epoch 6/65
183/183 - 259s - loss: 0.3587 - accuracy: 0.8212 - val_loss: 1.0103 - val_accuracy: 0.6545
Confusion matrix: 
 [[370 203]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.646 0.354]
 [0.188 0.812]]
Validation f1: 19.92
Validation accuracy: 65.45
Validation recall: 81.25
Validation precision: 11.35
Validation AUC: 0.5949216855359385
Validation class accuracies: [0.6457242582897034, 0.8125]
The validation tracker metric at 0.3088235294117648 hasn't increased by 0 in 1 epochs
Epoch 7/65
183/183 - 259s - loss: 0.2535 - accuracy: 0.8758 - val_loss: 2.4118 - val_accuracy: 0.5008
Confusion matrix: 
 [[275 298]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.48  0.52 ]
 [0.125 0.875]]
Validation f1: 15.64
Validation accuracy: 50.08
Validation recall: 87.50
Validation precision: 8.59
Validation AUC: 0.35161977953119555
Validation class accuracies: [0.4799301919720768, 0.875]
The validation tracker metric at 0.3088235294117648 hasn't increased by 0 in 2 epochs
Epoch 8/65
183/183 - 259s - loss: 0.2363 - accuracy: 0.8754 - val_loss: 0.6075 - val_accuracy: 0.8380
Confusion matrix: 
 [[486  87]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.848 0.152]
 [0.344 0.656]]
Validation f1: 30.00
Validation accuracy: 83.80
Validation recall: 65.62
Validation precision: 19.44
Validation AUC: 0.546414773465328
Validation class accuracies: [0.8481675392670157, 0.65625]
The validation tracker metric at 0.3088235294117648 hasn't increased by 0 in 3 epochs
Epoch 9/65
183/183 - 259s - loss: 0.2380 - accuracy: 0.8885 - val_loss: 0.7971 - val_accuracy: 0.7950
Confusion matrix: 
 [[456 117]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.796 0.204]
 [0.219 0.781]]
Validation f1: 28.74
Validation accuracy: 79.50
Validation recall: 78.12
Validation precision: 17.61
Validation AUC: 0.5916578775042877
Validation class accuracies: [0.7958115183246073, 0.78125]
The validation tracker metric at 0.3088235294117648 hasn't increased by 0 in 4 epochs
Epoch 10/65
183/183 - 258s - loss: 0.1796 - accuracy: 0.9173 - val_loss: 4.2596 - val_accuracy: 0.2992
Confusion matrix: 
 [[149 424]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.26 0.74]
 [0.   1.  ]]
Validation f1: 13.11
Validation accuracy: 29.92
Validation recall: 100.00
Validation precision: 7.02
Validation AUC: 0.5159862075746653
Validation class accuracies: [0.2600349040139616, 1.0]
The validation tracker metric at 0.3088235294117648 hasn't increased by 0 in 5 epochs
Epoch 11/65
183/183 - 258s - loss: 0.1620 - accuracy: 0.9221 - val_loss: 0.7964 - val_accuracy: 0.7669
Confusion matrix: 
 [[441 132]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.77  0.23 ]
 [0.281 0.719]]
Validation f1: 24.60
Validation accuracy: 76.69
Validation recall: 71.88
Validation precision: 14.84
Validation AUC: 0.42115171327918804
Validation class accuracies: [0.7696335078534031, 0.71875]
The validation tracker metric at 0.3088235294117648 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 12/65
183/183 - 259s - loss: 0.2780 - accuracy: 0.8957 - val_loss: 0.4269 - val_accuracy: 0.8595
Confusion matrix: 
 [[498  75]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.312 0.688]]
Validation f1: 34.11
Validation accuracy: 85.95
Validation recall: 68.75
Validation precision: 22.68
Validation AUC: 0.6525840593497342
Validation class accuracies: [0.8691099476439791, 0.6875]
Saving model...
Epoch 13/65
183/183 - 259s - loss: 0.1679 - accuracy: 0.9067 - val_loss: 0.4811 - val_accuracy: 0.8380
Confusion matrix: 
 [[485  88]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.846 0.154]
 [0.312 0.688]]
Validation f1: 30.99
Validation accuracy: 83.80
Validation recall: 68.75
Validation precision: 20.00
Validation AUC: 0.635811712516295
Validation class accuracies: [0.8464223385689355, 0.6875]
The validation tracker metric at 0.34108527131782945 hasn't increased by 0 in 1 epochs
Epoch 14/65
183/183 - 259s - loss: 0.1008 - accuracy: 0.9520 - val_loss: 0.4282 - val_accuracy: 0.8694
Confusion matrix: 
 [[503  70]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.878 0.122]
 [0.281 0.719]]
Validation f1: 36.80
Validation accuracy: 86.94
Validation recall: 71.88
Validation precision: 24.73
Validation AUC: 0.6408700936525052
Validation class accuracies: [0.8778359511343804, 0.71875]
Saving model...
Epoch 15/65
183/183 - 259s - loss: 0.0887 - accuracy: 0.9540 - val_loss: 0.3516 - val_accuracy: 0.8959
Confusion matrix: 
 [[521  52]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.344 0.656]]
Validation f1: 40.00
Validation accuracy: 89.59
Validation recall: 65.62
Validation precision: 28.77
Validation AUC: 0.5849190041805187
Validation class accuracies: [0.9092495636998255, 0.65625]
Saving model...
Epoch 16/65
183/183 - 260s - loss: 0.1145 - accuracy: 0.9447 - val_loss: 1.5013 - val_accuracy: 0.7008
Confusion matrix: 
 [[395 178]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.689 0.311]
 [0.094 0.906]]
Validation f1: 24.27
Validation accuracy: 70.08
Validation recall: 90.62
Validation precision: 14.01
Validation AUC: 0.6008747659542176
Validation class accuracies: [0.6893542757417103, 0.90625]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 1 epochs
Epoch 17/65
183/183 - 259s - loss: 0.0690 - accuracy: 0.9640 - val_loss: 0.3620 - val_accuracy: 0.8843
Confusion matrix: 
 [[516  57]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.406 0.594]]
Validation f1: 35.19
Validation accuracy: 88.43
Validation recall: 59.38
Validation precision: 25.00
Validation AUC: 0.5255032899465744
Validation class accuracies: [0.900523560209424, 0.59375]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 2 epochs
Epoch 18/65
183/183 - 259s - loss: 0.0591 - accuracy: 0.9719 - val_loss: 0.6083 - val_accuracy: 0.8595
Confusion matrix: 
 [[495  78]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.864 0.136]
 [0.219 0.781]]
Validation f1: 37.04
Validation accuracy: 85.95
Validation recall: 78.12
Validation precision: 24.27
Validation AUC: 0.6221106509791361
Validation class accuracies: [0.8638743455497382, 0.78125]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 3 epochs
Epoch 19/65
183/183 - 259s - loss: 0.0472 - accuracy: 0.9794 - val_loss: 0.5561 - val_accuracy: 0.8595
Confusion matrix: 
 [[498  75]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.869 0.131]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 34.11
Validation accuracy: 85.95
Validation recall: 68.75
Validation precision: 22.68
Validation AUC: 0.6145014634683326
Validation class accuracies: [0.8691099476439791, 0.6875]
The validation tracker metric at 0.39999999999999997 hasn't increased by 0 in 4 epochs
Epoch 20/65
183/183 - 259s - loss: 0.0304 - accuracy: 0.9873 - val_loss: 0.1868 - val_accuracy: 0.9521
Confusion matrix: 
 [[557  16]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.972 0.028]
 [0.406 0.594]]
Validation f1: 56.72
Validation accuracy: 95.21
Validation recall: 59.38
Validation precision: 54.29
Validation AUC: 0.626131535661035
Validation class accuracies: [0.9720767888307156, 0.59375]
Saving model...
Epoch 21/65
183/183 - 259s - loss: 0.0628 - accuracy: 0.9729 - val_loss: 1.1808 - val_accuracy: 0.6777
Confusion matrix: 
 [[397 176]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.693 0.307]
 [0.594 0.406]]
Validation f1: 11.76
Validation accuracy: 67.77
Validation recall: 40.62
Validation precision: 6.88
Validation AUC: 0.2564335376818832
Validation class accuracies: [0.6928446771378709, 0.40625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 1 epochs
Epoch 22/65
183/183 - 259s - loss: 0.0812 - accuracy: 0.9650 - val_loss: 0.3374 - val_accuracy: 0.9124
Confusion matrix: 
 [[532  41]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.375 0.625]]
Validation f1: 43.01
Validation accuracy: 91.24
Validation recall: 62.50
Validation precision: 32.79
Validation AUC: 0.6189950257160308
Validation class accuracies: [0.9284467713787086, 0.625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 2 epochs
Epoch 23/65
183/183 - 259s - loss: 0.0846 - accuracy: 0.9636 - val_loss: 0.4007 - val_accuracy: 0.8793
Confusion matrix: 
 [[511  62]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.892 0.108]
 [0.344 0.656]]
Validation f1: 36.52
Validation accuracy: 87.93
Validation recall: 65.62
Validation precision: 25.30
Validation AUC: 0.5436038736494837
Validation class accuracies: [0.8917975567190227, 0.65625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 3 epochs
Epoch 24/65
183/183 - 259s - loss: 0.0368 - accuracy: 0.9825 - val_loss: 0.4587 - val_accuracy: 0.8942
Confusion matrix: 
 [[520  53]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.344 0.656]]
Validation f1: 39.62
Validation accuracy: 89.42
Validation recall: 65.62
Validation precision: 28.38
Validation AUC: 0.6014495332980869
Validation class accuracies: [0.9075043630017452, 0.65625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 4 epochs
Epoch 25/65
183/183 - 258s - loss: 0.0310 - accuracy: 0.9883 - val_loss: 0.5350 - val_accuracy: 0.8975
Confusion matrix: 
 [[522  51]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.344 0.656]]
Validation f1: 40.38
Validation accuracy: 89.75
Validation recall: 65.62
Validation precision: 29.17
Validation AUC: 0.5673660920131387
Validation class accuracies: [0.9109947643979057, 0.65625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 5 epochs
Epoch 26/65
183/183 - 259s - loss: 0.0430 - accuracy: 0.9818 - val_loss: 0.4471 - val_accuracy: 0.8926
Confusion matrix: 
 [[520  53]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.908 0.092]
 [0.375 0.625]]
Validation f1: 38.10
Validation accuracy: 89.26
Validation recall: 62.50
Validation precision: 27.40
Validation AUC: 0.6034498076168731
Validation class accuracies: [0.9075043630017452, 0.625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
183/183 - 258s - loss: 0.0381 - accuracy: 0.9859 - val_loss: 0.3046 - val_accuracy: 0.9240
Confusion matrix: 
 [[539  34]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.375 0.625]]
Validation f1: 46.51
Validation accuracy: 92.40
Validation recall: 62.50
Validation precision: 37.04
Validation AUC: 0.625572511255826
Validation class accuracies: [0.9406631762652705, 0.625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 7 epochs
Epoch 28/65
183/183 - 259s - loss: 0.0152 - accuracy: 0.9942 - val_loss: 0.2772 - val_accuracy: 0.9322
Confusion matrix: 
 [[544  29]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.375 0.625]]
Validation f1: 49.38
Validation accuracy: 93.22
Validation recall: 62.50
Validation precision: 40.82
Validation AUC: 0.6708746159414352
Validation class accuracies: [0.9493891797556719, 0.625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 8 epochs
Epoch 29/65
183/183 - 259s - loss: 0.0158 - accuracy: 0.9949 - val_loss: 0.3986 - val_accuracy: 0.9107
Confusion matrix: 
 [[529  44]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.923 0.077]
 [0.312 0.688]]
Validation f1: 44.90
Validation accuracy: 91.07
Validation recall: 68.75
Validation precision: 33.33
Validation AUC: 0.6668133941000753
Validation class accuracies: [0.9232111692844677, 0.6875]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 9 epochs
Epoch 30/65
183/183 - 258s - loss: 0.0307 - accuracy: 0.9880 - val_loss: 0.4185 - val_accuracy: 0.9157
Confusion matrix: 
 [[533  40]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.344 0.656]]
Validation f1: 45.16
Validation accuracy: 91.57
Validation recall: 65.62
Validation precision: 34.43
Validation AUC: 0.6263168946773782
Validation class accuracies: [0.9301919720767888, 0.65625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 10 epochs
Epoch 31/65
183/183 - 259s - loss: 0.0174 - accuracy: 0.9959 - val_loss: 0.2707 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.5803859468405996
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 11 epochs
Epoch 32/65
183/183 - 258s - loss: 0.0438 - accuracy: 0.9866 - val_loss: 0.6812 - val_accuracy: 0.8231
Confusion matrix: 
 [[481  92]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.469 0.531]]
Validation f1: 24.11
Validation accuracy: 82.31
Validation recall: 53.12
Validation precision: 15.60
Validation AUC: 0.456111661309624
Validation class accuracies: [0.8394415357766143, 0.53125]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 33/65
183/183 - 258s - loss: 0.0291 - accuracy: 0.9828 - val_loss: 0.2937 - val_accuracy: 0.9240
Confusion matrix: 
 [[540  33]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.406 0.594]]
Validation f1: 45.24
Validation accuracy: 92.40
Validation recall: 59.38
Validation precision: 36.54
Validation AUC: 0.5890801966779724
Validation class accuracies: [0.9424083769633508, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 13 epochs
Epoch 34/65
183/183 - 259s - loss: 0.0174 - accuracy: 0.9911 - val_loss: 0.2600 - val_accuracy: 0.9306
Confusion matrix: 
 [[544  29]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.406 0.594]]
Validation f1: 47.50
Validation accuracy: 93.06
Validation recall: 59.38
Validation precision: 39.58
Validation AUC: 0.6340458276935436
Validation class accuracies: [0.9493891797556719, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 14 epochs
Epoch 35/65
183/183 - 258s - loss: 0.0150 - accuracy: 0.9955 - val_loss: 0.2474 - val_accuracy: 0.9372
Confusion matrix: 
 [[547  26]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.375 0.625]]
Validation f1: 51.28
Validation accuracy: 93.72
Validation recall: 62.50
Validation precision: 43.48
Validation AUC: 0.6692970556261597
Validation class accuracies: [0.9546247818499127, 0.625]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 15 epochs
Epoch 36/65
183/183 - 259s - loss: 0.0206 - accuracy: 0.9938 - val_loss: 0.3784 - val_accuracy: 0.9124
Confusion matrix: 
 [[530  43]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.312 0.688]]
Validation f1: 45.36
Validation accuracy: 91.24
Validation recall: 68.75
Validation precision: 33.85
Validation AUC: 0.675700575586004
Validation class accuracies: [0.924956369982548, 0.6875]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 16 epochs
Epoch 37/65
183/183 - 259s - loss: 0.0308 - accuracy: 0.9804 - val_loss: 0.2992 - val_accuracy: 0.9339
Confusion matrix: 
 [[546  27]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.406 0.594]]
Validation f1: 48.72
Validation accuracy: 93.39
Validation recall: 59.38
Validation precision: 41.30
Validation AUC: 0.607312303483826
Validation class accuracies: [0.9528795811518325, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 17 epochs
Epoch 38/65
183/183 - 258s - loss: 0.0126 - accuracy: 0.9928 - val_loss: 0.2451 - val_accuracy: 0.9372
Confusion matrix: 
 [[548  25]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.956 0.044]
 [0.406 0.594]]
Validation f1: 50.00
Validation accuracy: 93.72
Validation recall: 59.38
Validation precision: 43.18
Validation AUC: 0.6478722245402996
Validation class accuracies: [0.956369982547993, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 39/65
183/183 - 259s - loss: 0.0115 - accuracy: 0.9962 - val_loss: 0.2454 - val_accuracy: 0.9322
Confusion matrix: 
 [[545  28]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.406 0.594]]
Validation f1: 48.10
Validation accuracy: 93.22
Validation recall: 59.38
Validation precision: 40.43
Validation AUC: 0.6330396835072838
Validation class accuracies: [0.9511343804537522, 0.59375]
The validation tracker metric at 0.5671641791044776 hasn't increased by 0 in 19 epochs
Epoch 40/65
183/183 - 259s - loss: 0.0129 - accuracy: 0.9949 - val_loss: 0.2478 - val_accuracy: 0.9273
Confusion matrix: 
 [[542  31]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.406 0.594]]
Validation f1: 46.34
Validation accuracy: 92.73
Validation recall: 59.38
Validation precision: 38.00
Validation AUC: 0.6360019395141215
Validation class accuracies: [0.9458987783595113, 0.59375]

The metrics for job 0 with the best target metric are: 
Best cm: [[557  16]
 [ 13  19]]
Best normalized cm: [[0.972 0.028]
 [0.406 0.594]]
Best f1: 0.57
Best accuracy: 0.95
Best recall: 0.59
Best precision: 0.54
Best AUC: 0.63
Best class accuracies: [0.9720767888307156, 0.59375]
Best epoch: 20
The number of epochs since last 1% equals the patience
-----------------------
Mixednet
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented
Length of training samples after spec augmentation: 2764
-----------------------
Number of train recordings: 2764 with pneumonia: 464 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2864
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_2
Length of training samples after spec augmentation: 2914
-----------------------
Number of train recordings: 2914 with pneumonia: 464 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                                     Output Shape                                Param #          
==============================================================================================================
input_2 (InputLayer)                             [(None, 128, 1250, 1)]                      0                
______________________________________________________________________________________________________________
conv2d_5 (Conv2D)                                (None, 128, 1250, 8)                        80               
______________________________________________________________________________________________________________
mix_depth_group_convolution2d (MixDepthGroupConv (None, 128, 1250, 8)                        162              
______________________________________________________________________________________________________________
average_pooling2d_5 (AveragePooling2D)           (None, 64, 625, 8)                          0                
______________________________________________________________________________________________________________
batch_normalization_6 (BatchNormalization)       (None, 64, 625, 8)                          32               
______________________________________________________________________________________________________________
conv2d_6 (Conv2D)                                (None, 64, 625, 16)                         1168             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_1 (MixDepthGroupCo (None, 64, 625, 16)                         414              
______________________________________________________________________________________________________________
average_pooling2d_6 (AveragePooling2D)           (None, 32, 313, 16)                         0                
______________________________________________________________________________________________________________
batch_normalization_7 (BatchNormalization)       (None, 32, 313, 16)                         64               
______________________________________________________________________________________________________________
conv2d_7 (Conv2D)                                (None, 32, 313, 32)                         4640             
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_2 (MixDepthGroupCo (None, 32, 313, 32)                         828              
______________________________________________________________________________________________________________
average_pooling2d_7 (AveragePooling2D)           (None, 16, 157, 32)                         0                
______________________________________________________________________________________________________________
batch_normalization_8 (BatchNormalization)       (None, 16, 157, 32)                         128              
______________________________________________________________________________________________________________
conv2d_8 (Conv2D)                                (None, 16, 157, 64)                         18496            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_3 (MixDepthGroupCo (None, 16, 157, 64)                         1656             
______________________________________________________________________________________________________________
average_pooling2d_8 (AveragePooling2D)           (None, 8, 79, 64)                           0                
______________________________________________________________________________________________________________
batch_normalization_9 (BatchNormalization)       (None, 8, 79, 64)                           256              
______________________________________________________________________________________________________________
conv2d_9 (Conv2D)                                (None, 8, 79, 128)                          73856            
______________________________________________________________________________________________________________
mix_depth_group_convolution2d_4 (MixDepthGroupCo (None, 8, 79, 128)                          3402             
______________________________________________________________________________________________________________
average_pooling2d_9 (AveragePooling2D)           (None, 4, 40, 128)                          0                
______________________________________________________________________________________________________________
batch_normalization_10 (BatchNormalization)      (None, 4, 40, 128)                          512              
______________________________________________________________________________________________________________
global_average_pooling2d_1 (GlobalAveragePooling (None, 128)                                 0                
______________________________________________________________________________________________________________
dense_1 (Dense)                                  (None, 1)                                   129              
==============================================================================================================
Total params: 105,823
Trainable params: 105,327
Non-trainable params: 496
______________________________________________________________________________________________________________
Epoch 1/65
183/183 - 77s - loss: 0.6029 - accuracy: 0.6421 - val_loss: 0.7439 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.45586057718562734
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
183/183 - 74s - loss: 0.3572 - accuracy: 0.7824 - val_loss: 0.8908 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.5443233246089259
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
183/183 - 76s - loss: 0.2171 - accuracy: 0.8792 - val_loss: 1.7751 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.5000612283180841
Validation class accuracies: [0.0, 1.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
183/183 - 74s - loss: 0.1393 - accuracy: 0.9307 - val_loss: 0.9674 - val_accuracy: 0.5983
Confusion matrix: 
 [[336 237]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.586 0.414]
 [0.188 0.812]]
Validation f1: 17.63
Validation accuracy: 59.83
Validation recall: 81.25
Validation precision: 9.89
Validation AUC: 0.5556170478600253
Validation class accuracies: [0.5863874345549738, 0.8125]
Saving model...
Epoch 5/65
183/183 - 74s - loss: 0.1392 - accuracy: 0.9472 - val_loss: 2.0287 - val_accuracy: 0.5488
Confusion matrix: 
 [[301 272]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.525 0.475]
 [0.031 0.969]]
Validation f1: 18.51
Validation accuracy: 54.88
Validation recall: 96.88
Validation precision: 10.23
Validation AUC: 0.5425359972466883
Validation class accuracies: [0.525305410122164, 0.96875]
Saving model...
Epoch 6/65
183/183 - 74s - loss: 0.1098 - accuracy: 0.9396 - val_loss: 0.2062 - val_accuracy: 0.9669
Confusion matrix: 
 [[569   4]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.5   0.5  ]]
Validation f1: 61.54
Validation accuracy: 96.69
Validation recall: 50.00
Validation precision: 80.00
Validation AUC: 0.6072473619086453
Validation class accuracies: [0.9930191972076788, 0.5]
Saving model...
Epoch 7/65
183/183 - 73s - loss: 0.0535 - accuracy: 0.9770 - val_loss: 0.1846 - val_accuracy: 0.9438
Confusion matrix: 
 [[551  22]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.375 0.625]]
Validation f1: 54.05
Validation accuracy: 94.38
Validation recall: 62.50
Validation precision: 47.62
Validation AUC: 0.6073838372002942
Validation class accuracies: [0.9616055846422339, 0.625]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 1 epochs
Epoch 8/65
183/183 - 74s - loss: 0.0342 - accuracy: 0.9876 - val_loss: 1.1014 - val_accuracy: 0.7074
Confusion matrix: 
 [[402 171]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.702 0.298]
 [0.188 0.812]]
Validation f1: 22.71
Validation accuracy: 70.74
Validation recall: 81.25
Validation precision: 13.20
Validation AUC: 0.23486572502654823
Validation class accuracies: [0.7015706806282722, 0.8125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 2 epochs
Epoch 9/65
183/183 - 76s - loss: 0.0253 - accuracy: 0.9894 - val_loss: 0.3152 - val_accuracy: 0.9124
Confusion matrix: 
 [[530  43]
 [ 10  22]]
Normalized Confusion matrix: 
 [[0.925 0.075]
 [0.312 0.688]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 45.36
Validation accuracy: 91.24
Validation recall: 68.75
Validation precision: 33.85
Validation AUC: 0.6117988948142606
Validation class accuracies: [0.924956369982548, 0.6875]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 3 epochs
Epoch 10/65
183/183 - 74s - loss: 0.0571 - accuracy: 0.9743 - val_loss: 0.4532 - val_accuracy: 0.8860
Confusion matrix: 
 [[513  60]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.895 0.105]
 [0.281 0.719]]
Validation f1: 40.00
Validation accuracy: 88.60
Validation recall: 71.88
Validation precision: 27.71
Validation AUC: 0.5682932450909767
Validation class accuracies: [0.8952879581151832, 0.71875]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 4 epochs
Epoch 11/65
183/183 - 74s - loss: 0.1090 - accuracy: 0.9478 - val_loss: 0.3643 - val_accuracy: 0.8992
Confusion matrix: 
 [[523  50]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.344 0.656]]
Validation f1: 40.78
Validation accuracy: 89.92
Validation recall: 65.62
Validation precision: 29.58
Validation AUC: 0.5808389054218733
Validation class accuracies: [0.912739965095986, 0.65625]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 5 epochs
Epoch 12/65
183/183 - 75s - loss: 0.0250 - accuracy: 0.9866 - val_loss: 0.3652 - val_accuracy: 0.9124
Confusion matrix: 
 [[533  40]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.406 0.594]]
Validation f1: 41.76
Validation accuracy: 91.24
Validation recall: 59.38
Validation precision: 32.20
Validation AUC: 0.5045764922201784
Validation class accuracies: [0.9301919720767888, 0.59375]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
183/183 - 73s - loss: 0.0183 - accuracy: 0.9921 - val_loss: 0.3124 - val_accuracy: 0.9207
Confusion matrix: 
 [[540  33]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.469 0.531]]
Validation f1: 41.46
Validation accuracy: 92.07
Validation recall: 53.12
Validation precision: 34.00
Validation AUC: 0.5057244476335825
Validation class accuracies: [0.9424083769633508, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 7 epochs
Epoch 14/65
183/183 - 73s - loss: 0.0127 - accuracy: 0.9979 - val_loss: 0.3337 - val_accuracy: 0.9207
Confusion matrix: 
 [[540  33]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.46
Validation accuracy: 92.07
Validation recall: 53.12
Validation precision: 34.00
Validation AUC: 0.5132485476219034
Validation class accuracies: [0.9424083769633508, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 8 epochs
Epoch 15/65
183/183 - 77s - loss: 0.0503 - accuracy: 0.9918 - val_loss: 0.2843 - val_accuracy: 0.9372
Confusion matrix: 
 [[550  23]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.96  0.04 ]
 [0.469 0.531]]
Validation f1: 47.22
Validation accuracy: 93.72
Validation recall: 53.12
Validation precision: 42.50
Validation AUC: 0.5050345566731966
Validation class accuracies: [0.9598603839441536, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 9 epochs
Epoch 16/65
183/183 - 74s - loss: 0.0143 - accuracy: 0.9945 - val_loss: 0.3021 - val_accuracy: 0.9207
Confusion matrix: 
 [[540  33]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.469 0.531]]
Validation f1: 41.46
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.07
Validation recall: 53.12
Validation precision: 34.00
Validation AUC: 0.5207289626663234
Validation class accuracies: [0.9424083769633508, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 10 epochs
Epoch 17/65
183/183 - 74s - loss: 0.0142 - accuracy: 0.9979 - val_loss: 0.3350 - val_accuracy: 0.9174
Confusion matrix: 
 [[538  35]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.469 0.531]]
Validation f1: 40.48
Validation accuracy: 91.74
Validation recall: 53.12
Validation precision: 32.69
Validation AUC: 0.5180826281365946
Validation class accuracies: [0.9389179755671903, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 11 epochs
Epoch 18/65
183/183 - 77s - loss: 0.0115 - accuracy: 0.9973 - val_loss: 0.3083 - val_accuracy: 0.9289
Confusion matrix: 
 [[545  28]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.469 0.531]]
Validation f1: 44.16
Validation accuracy: 92.89
Validation recall: 53.12
Validation precision: 37.78
Validation AUC: 0.5041001982923354
Validation class accuracies: [0.9511343804537522, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 19/65
183/183 - 73s - loss: 0.0103 - accuracy: 0.9969 - val_loss: 0.3305 - val_accuracy: 0.9190
Confusion matrix: 
 [[539  34]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.469 0.531]]
Validation f1: 40.96
Validation accuracy: 91.90
Validation recall: 53.12
Validation precision: 33.33
Validation AUC: 0.4960439503857613
Validation class accuracies: [0.9406631762652705, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 13 epochs
Epoch 20/65
183/183 - 73s - loss: 0.0092 - accuracy: 0.9993 - val_loss: 0.2829 - val_accuracy: 0.9306
Confusion matrix: 
 [[546  27]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.469 0.531]]
Validation f1: 44.74
Validation accuracy: 93.06
Validation recall: 53.12
Validation precision: 38.64
Validation AUC: 0.5073457830231637
Validation class accuracies: [0.9528795811518325, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 14 epochs
Epoch 21/65
183/183 - 76s - loss: 0.0192 - accuracy: 0.9976 - val_loss: 0.3591 - val_accuracy: 0.9157
Confusion matrix: 
 [[537  36]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.937 0.063]
 [0.469 0.531]]
Validation f1: 40.00
Validation accuracy: 91.57
Validation recall: 53.12
Validation precision: 32.08
Validation AUC: 0.49361488021948546
Validation class accuracies: [0.93717277486911, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 15 epochs
Epoch 22/65
183/183 - 74s - loss: 0.0093 - accuracy: 0.9993 - val_loss: 0.3157 - val_accuracy: 0.9223
Confusion matrix: 
 [[541  32]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.98
Validation accuracy: 92.23
Validation recall: 53.12
Validation precision: 34.69
Validation AUC: 0.5144839064500752
Validation class accuracies: [0.944153577661431, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 16 epochs
Epoch 23/65
183/183 - 75s - loss: 0.0069 - accuracy: 0.9993 - val_loss: 0.3131 - val_accuracy: 0.9256
Confusion matrix: 
 [[543  30]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.948 0.052]
 [0.469 0.531]]
Validation f1: 43.04
Validation accuracy: 92.56
Validation recall: 53.12
Validation precision: 36.17
Validation AUC: 0.5234396122431331
Validation class accuracies: [0.9476439790575916, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 17 epochs
Epoch 24/65
183/183 - 75s - loss: 0.0083 - accuracy: 0.9990 - val_loss: 0.2869 - val_accuracy: 0.9306
Confusion matrix: 
 [[546  27]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.74
Validation accuracy: 93.06
Validation recall: 53.12
Validation precision: 38.64
Validation AUC: 0.5287871151692236
Validation class accuracies: [0.9528795811518325, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 25/65
183/183 - 74s - loss: 0.0068 - accuracy: 0.9990 - val_loss: 0.3079 - val_accuracy: 0.9273
Confusion matrix: 
 [[544  29]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.469 0.531]]
Validation f1: 43.59
Validation accuracy: 92.73
Validation recall: 53.12
Validation precision: 36.96
Validation AUC: 0.525259484976869
Validation class accuracies: [0.9493891797556719, 0.53125]
The validation tracker metric at 0.6153846153846154 hasn't increased by 0 in 19 epochs
Epoch 26/65
183/183 - 73s - loss: 0.0071 - accuracy: 0.9997 - val_loss: 0.3232 - val_accuracy: 0.9223
Confusion matrix: 
 [[541  32]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.98
Validation accuracy: 92.23
Validation recall: 53.12
Validation precision: 34.69
Validation AUC: 0.5328138799196854
Validation class accuracies: [0.944153577661431, 0.53125]

The metrics for job 0 with the best target metric are: 
Best cm: [[569   4]
 [ 16  16]]
Best normalized cm: [[0.993 0.007]
 [0.5   0.5  ]]
Best f1: 0.62
Best accuracy: 0.97
Best recall: 0.50
Best precision: 0.80
Best AUC: 0.61
Best class accuracies: [0.9930191972076788, 0.5]
Best epoch: 6
The number of epochs since last 1% equals the patience
-----------------------
Model 10
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented
Length of training samples after spec augmentation: 2764
-----------------------
Number of train recordings: 2764 with pneumonia: 464 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2864
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_2
Length of training samples after spec augmentation: 2914
-----------------------
Number of train recordings: 2914 with pneumonia: 464 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_3 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_11 (BatchNormal (None, 128, 1250, 1)    4            input_3[0][0]                        
______________________________________________________________________________________________________________
conv2d_10 (Conv2D)                  (None, 128, 1250, 8)    16           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_12 (Conv2D)                  (None, 128, 1250, 8)    16           batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_11[0][0]         
______________________________________________________________________________________________________________
conv2d_11 (Conv2D)                  (None, 128, 1250, 8)    584          conv2d_10[0][0]                      
______________________________________________________________________________________________________________
conv2d_13 (Conv2D)                  (None, 128, 1250, 8)    1608         conv2d_12[0][0]                      
______________________________________________________________________________________________________________
conv2d_14 (Conv2D)                  (None, 128, 1250, 8)    16           max_pooling2d_1[0][0]                
______________________________________________________________________________________________________________
concatenate_33671 (Concatenate)     (None, 128, 1250, 24)   0            conv2d_11[0][0]                      
                                                                         conv2d_13[0][0]                      
                                                                         conv2d_14[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_10 (AveragePoolin (None, 64, 625, 24)     0            concatenate_33671[0][0]              
______________________________________________________________________________________________________________
batch_normalization_12 (BatchNormal (None, 64, 625, 24)     96           average_pooling2d_10[0][0]           
______________________________________________________________________________________________________________
conv2d_15 (Conv2D)                  (None, 64, 625, 16)     400          batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_17 (Conv2D)                  (None, 64, 625, 16)     400          batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)      (None, 64, 625, 24)     0            batch_normalization_12[0][0]         
______________________________________________________________________________________________________________
conv2d_16 (Conv2D)                  (None, 64, 625, 16)     2320         conv2d_15[0][0]                      
______________________________________________________________________________________________________________
conv2d_18 (Conv2D)                  (None, 64, 625, 16)     6416         conv2d_17[0][0]                      
______________________________________________________________________________________________________________
conv2d_19 (Conv2D)                  (None, 64, 625, 16)     400          max_pooling2d_2[0][0]                
______________________________________________________________________________________________________________
concatenate_33672 (Concatenate)     (None, 64, 625, 48)     0            conv2d_16[0][0]                      
                                                                         conv2d_18[0][0]                      
                                                                         conv2d_19[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_11 (AveragePoolin (None, 32, 313, 48)     0            concatenate_33672[0][0]              
______________________________________________________________________________________________________________
batch_normalization_13 (BatchNormal (None, 32, 313, 48)     192          average_pooling2d_11[0][0]           
______________________________________________________________________________________________________________
conv2d_20 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
conv2d_22 (Conv2D)                  (None, 32, 313, 32)     1568         batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)      (None, 32, 313, 48)     0            batch_normalization_13[0][0]         
______________________________________________________________________________________________________________
conv2d_21 (Conv2D)                  (None, 32, 313, 32)     9248         conv2d_20[0][0]                      
______________________________________________________________________________________________________________
conv2d_23 (Conv2D)                  (None, 32, 313, 32)     25632        conv2d_22[0][0]                      
______________________________________________________________________________________________________________
conv2d_24 (Conv2D)                  (None, 32, 313, 32)     1568         max_pooling2d_3[0][0]                
______________________________________________________________________________________________________________
concatenate_33673 (Concatenate)     (None, 32, 313, 96)     0            conv2d_21[0][0]                      
                                                                         conv2d_23[0][0]                      
                                                                         conv2d_24[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_12 (AveragePoolin (None, 16, 157, 96)     0            concatenate_33673[0][0]              
______________________________________________________________________________________________________________
batch_normalization_14 (BatchNormal (None, 16, 157, 96)     384          average_pooling2d_12[0][0]           
______________________________________________________________________________________________________________
conv2d_25 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
conv2d_27 (Conv2D)                  (None, 16, 157, 64)     6208         batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)      (None, 16, 157, 96)     0            batch_normalization_14[0][0]         
______________________________________________________________________________________________________________
conv2d_26 (Conv2D)                  (None, 16, 157, 64)     36928        conv2d_25[0][0]                      
______________________________________________________________________________________________________________
conv2d_28 (Conv2D)                  (None, 16, 157, 64)     102464       conv2d_27[0][0]                      
______________________________________________________________________________________________________________
conv2d_29 (Conv2D)                  (None, 16, 157, 64)     6208         max_pooling2d_4[0][0]                
______________________________________________________________________________________________________________
concatenate_33674 (Concatenate)     (None, 16, 157, 192)    0            conv2d_26[0][0]                      
                                                                         conv2d_28[0][0]                      
                                                                         conv2d_29[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_13 (AveragePoolin (None, 8, 79, 192)      0            concatenate_33674[0][0]              
______________________________________________________________________________________________________________
batch_normalization_15 (BatchNormal (None, 8, 79, 192)      768          average_pooling2d_13[0][0]           
______________________________________________________________________________________________________________
conv2d_30 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
conv2d_32 (Conv2D)                  (None, 8, 79, 128)      24704        batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)      (None, 8, 79, 192)      0            batch_normalization_15[0][0]         
______________________________________________________________________________________________________________
conv2d_31 (Conv2D)                  (None, 8, 79, 128)      147584       conv2d_30[0][0]                      
______________________________________________________________________________________________________________
conv2d_33 (Conv2D)                  (None, 8, 79, 128)      409728       conv2d_32[0][0]                      
______________________________________________________________________________________________________________
conv2d_34 (Conv2D)                  (None, 8, 79, 128)      24704        max_pooling2d_5[0][0]                
______________________________________________________________________________________________________________
concatenate_33675 (Concatenate)     (None, 8, 79, 384)      0            conv2d_31[0][0]                      
                                                                         conv2d_33[0][0]                      
                                                                         conv2d_34[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_14 (AveragePoolin (None, 4, 40, 384)      0            concatenate_33675[0][0]              
______________________________________________________________________________________________________________
batch_normalization_16 (BatchNormal (None, 4, 40, 384)      1536         average_pooling2d_14[0][0]           
______________________________________________________________________________________________________________
conv2d_35 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
conv2d_37 (Conv2D)                  (None, 4, 40, 256)      98560        batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)      (None, 4, 40, 384)      0            batch_normalization_16[0][0]         
______________________________________________________________________________________________________________
conv2d_36 (Conv2D)                  (None, 4, 40, 256)      590080       conv2d_35[0][0]                      
______________________________________________________________________________________________________________
conv2d_38 (Conv2D)                  (None, 4, 40, 256)      1638656      conv2d_37[0][0]                      
______________________________________________________________________________________________________________
conv2d_39 (Conv2D)                  (None, 4, 40, 256)      98560        max_pooling2d_6[0][0]                
______________________________________________________________________________________________________________
concatenate_33676 (Concatenate)     (None, 4, 40, 768)      0            conv2d_36[0][0]                      
                                                                         conv2d_38[0][0]                      
                                                                         conv2d_39[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_15 (AveragePoolin (None, 2, 20, 768)      0            concatenate_33676[0][0]              
______________________________________________________________________________________________________________
batch_normalization_17 (BatchNormal (None, 2, 20, 768)      3072         average_pooling2d_15[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_2 (GlobalA (None, 768)             0            batch_normalization_17[0][0]         
______________________________________________________________________________________________________________
dense_2 (Dense)                     (None, 1)               769          global_average_pooling2d_2[0][0]     
==============================================================================================================
Total params: 3,372,437
Trainable params: 3,369,411
Non-trainable params: 3,026
______________________________________________________________________________________________________________
Epoch 1/65
183/183 - 69s - loss: 0.7466 - accuracy: 0.6266 - val_loss: 1.4401 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.058686390659433756
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
183/183 - 63s - loss: 0.4561 - accuracy: 0.7351 - val_loss: 0.2838 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.05288797738813634
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
183/183 - 64s - loss: 0.3036 - accuracy: 0.8161 - val_loss: 1.4789 - val_accuracy: 0.4050
Confusion matrix: 
 [[214 359]
 [  1  31]]
Normalized Confusion matrix: 
 [[0.373 0.627]
 [0.031 0.969]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 14.69
Validation accuracy: 40.50
Validation recall: 96.88
Validation precision: 7.95
Validation AUC: 0.1967040193539246
Validation class accuracies: [0.37347294938917974, 0.96875]
Saving model...
Epoch 4/65
183/183 - 66s - loss: 0.1959 - accuracy: 0.9012 - val_loss: 0.7372 - val_accuracy: 0.7818
Confusion matrix: 
 [[452 121]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.789 0.211]
 [0.344 0.656]]
Validation f1: 24.14
Validation accuracy: 78.18
Validation recall: 65.62
Validation precision: 14.79
Validation AUC: 0.5015391066985392
Validation class accuracies: [0.7888307155322862, 0.65625]
Saving model...
Epoch 5/65
183/183 - 64s - loss: 0.5320 - accuracy: 0.8034 - val_loss: 0.5143 - val_accuracy: 0.8017
Confusion matrix: 
 [[461 112]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.25  0.75 ]]
Validation f1: 28.57
Validation accuracy: 80.17
Validation recall: 75.00
Validation precision: 17.65
Validation AUC: 0.5888772867368743
Validation class accuracies: [0.8045375218150087, 0.75]
Saving model...
Epoch 6/65
183/183 - 63s - loss: 0.1974 - accuracy: 0.8850 - val_loss: 0.2434 - val_accuracy: 0.9355
Confusion matrix: 
 [[547  26]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.955 0.045]
 [0.406 0.594]]
Validation f1: 49.35
Validation accuracy: 93.55
Validation recall: 59.38
Validation precision: 42.22
Validation AUC: 0.5633266447838259
Validation class accuracies: [0.9546247818499127, 0.59375]
Saving model...
Epoch 7/65
183/183 - 63s - loss: 0.2708 - accuracy: 0.8693 - val_loss: 0.4399 - val_accuracy: 0.8479
Confusion matrix: 
 [[492  81]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.344 0.656]]
Validation f1: 31.34
Validation accuracy: 84.79
Validation recall: 65.62
Validation precision: 20.59
Validation AUC: 0.5996997579317549
Validation class accuracies: [0.8586387434554974, 0.65625]
The validation tracker metric at 0.49350649350649345 hasn't increased by 0 in 1 epochs
Epoch 8/65
183/183 - 65s - loss: 0.1541 - accuracy: 0.9166 - val_loss: 0.5713 - val_accuracy: 0.8198
Confusion matrix: 
 [[475  98]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.829 0.171]
 [0.344 0.656]]
Validation f1: 27.81
Validation accuracy: 81.98
Validation recall: 65.62
Validation precision: 17.65
Validation AUC: 0.6023010052279061
Validation class accuracies: [0.8289703315881326, 0.65625]
The validation tracker metric at 0.49350649350649345 hasn't increased by 0 in 2 epochs
Epoch 9/65
183/183 - 59s - loss: 0.1088 - accuracy: 0.9451 - val_loss: 1.2004 - val_accuracy: 0.6446
Confusion matrix: 
 [[364 209]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.635 0.365]
 [0.188 0.812]]
Validation f1: 19.48
Validation accuracy: 64.46
Validation recall: 81.25
Validation precision: 11.06
Validation AUC: 0.4556664305840191
Validation class accuracies: [0.6352530541012217, 0.8125]
The validation tracker metric at 0.49350649350649345 hasn't increased by 0 in 3 epochs
Epoch 10/65
183/183 - 64s - loss: 0.0627 - accuracy: 0.9677 - val_loss: 0.1841 - val_accuracy: 0.9653
Confusion matrix: 
 [[567   6]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.99  0.01 ]
 [0.469 0.531]]
Validation f1: 61.82
Validation accuracy: 96.53
Validation recall: 53.12
Validation precision: 73.91
Validation AUC: 0.6108278616545817
Validation class accuracies: [0.9895287958115183, 0.53125]
Saving model...
Epoch 11/65
183/183 - 64s - loss: 0.0527 - accuracy: 0.9784 - val_loss: 3.5458 - val_accuracy: 0.1983
Confusion matrix: 
 [[ 88 485]
 [  0  32]]
Normalized Confusion matrix: 
 [[0.154 0.846]
 [0.    1.   ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 11.66
Validation accuracy: 19.83
Validation recall: 100.00
Validation precision: 6.19
Validation AUC: 0.4179022171067205
Validation class accuracies: [0.15357766143106458, 1.0]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 1 epochs
Epoch 12/65
183/183 - 66s - loss: 0.0464 - accuracy: 0.9828 - val_loss: 0.2594 - val_accuracy: 0.9256
Confusion matrix: 
 [[545  28]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.00
Validation accuracy: 92.56
Validation recall: 46.88
Validation precision: 34.88
Validation AUC: 0.5016015334586293
Validation class accuracies: [0.9511343804537522, 0.46875]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 2 epochs
Epoch 13/65
183/183 - 63s - loss: 0.0327 - accuracy: 0.9883 - val_loss: 0.2840 - val_accuracy: 0.9421
Confusion matrix: 
 [[556  17]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.562 0.438]]
Validation f1: 44.44
Validation accuracy: 94.21
Validation recall: 43.75
Validation precision: 45.16
Validation AUC: 0.4901044832383735
Validation class accuracies: [0.9703315881326352, 0.4375]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 3 epochs
Epoch 14/65
183/183 - 63s - loss: 0.0267 - accuracy: 0.9897 - val_loss: 0.2558 - val_accuracy: 0.9058
Confusion matrix: 
 [[527  46]
 [ 11  21]]
Normalized Confusion matrix: 
 [[0.92  0.08 ]
 [0.344 0.656]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 42.42
Validation accuracy: 90.58
Validation recall: 65.62
Validation precision: 31.34
Validation AUC: 0.584555526289527
Validation class accuracies: [0.9197207678883071, 0.65625]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 4 epochs
Epoch 15/65
183/183 - 67s - loss: 0.0850 - accuracy: 0.9660 - val_loss: 0.5198 - val_accuracy: 0.8595
Confusion matrix: 
 [[504  69]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.88 0.12]
 [0.5  0.5 ]]
Validation f1: 27.35
Validation accuracy: 85.95
Validation recall: 50.00
Validation precision: 18.82
Validation AUC: 0.4387907309187429
Validation class accuracies: [0.8795811518324608, 0.5]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 5 epochs
Epoch 16/65
183/183 - 71s - loss: 0.0786 - accuracy: 0.9715 - val_loss: 0.2641 - val_accuracy: 0.9554
Confusion matrix: 
 [[562  11]
 [ 16  16]]
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.5   0.5  ]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.24
Validation accuracy: 95.54
Validation recall: 50.00
Validation precision: 59.26
Validation AUC: 0.5606427031562093
Validation class accuracies: [0.9808027923211169, 0.5]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 17/65
183/183 - 72s - loss: 0.0304 - accuracy: 0.9863 - val_loss: 0.2983 - val_accuracy: 0.9140
Confusion matrix: 
 [[532  41]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.344 0.656]]
Validation f1: 44.68
Validation accuracy: 91.40
Validation recall: 65.62
Validation precision: 33.87
Validation AUC: 0.5585463094283268
Validation class accuracies: [0.9284467713787086, 0.65625]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 7 epochs
Epoch 18/65
183/183 - 71s - loss: 0.0252 - accuracy: 0.9887 - val_loss: 0.4431 - val_accuracy: 0.8926
Confusion matrix: 
 [[517  56]
 [  9  23]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.902 0.098]
 [0.281 0.719]]
Validation f1: 41.44
Validation accuracy: 89.26
Validation recall: 71.88
Validation precision: 29.11
Validation AUC: 0.5169368733903849
Validation class accuracies: [0.9022687609075044, 0.71875]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 8 epochs
Epoch 19/65
183/183 - 72s - loss: 0.0249 - accuracy: 0.9897 - val_loss: 0.2588 - val_accuracy: 0.9223
Confusion matrix: 
 [[541  32]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.98
Validation accuracy: 92.23
Validation recall: 53.12
Validation precision: 34.69
Validation AUC: 0.5292964279962595
Validation class accuracies: [0.944153577661431, 0.53125]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 9 epochs
Epoch 20/65
183/183 - 77s - loss: 0.0172 - accuracy: 0.9959 - val_loss: 0.8415 - val_accuracy: 0.7769
Confusion matrix: 
 [[444 129]
 [  6  26]]
Normalized Confusion matrix: 
 [[0.775 0.225]
 [0.188 0.812]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 27.81
Validation accuracy: 77.69
Validation recall: 81.25
Validation precision: 16.77
Validation AUC: 0.5405588074566509
Validation class accuracies: [0.774869109947644, 0.8125]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 10 epochs
Epoch 21/65
183/183 - 77s - loss: 0.0317 - accuracy: 0.9863 - val_loss: 1.0550 - val_accuracy: 0.7306
Confusion matrix: 
 [[419 154]
 [  9  23]]
Normalized Confusion matrix: 
 [[0.731 0.269]
 [0.281 0.719]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 22.01
Validation accuracy: 73.06
Validation recall: 71.88
Validation precision: 12.99
Validation AUC: 0.4464831860444456
Validation class accuracies: [0.731239092495637, 0.71875]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 11 epochs
Epoch 22/65
183/183 - 78s - loss: 0.0179 - accuracy: 0.9921 - val_loss: 0.3001 - val_accuracy: 0.9240
Confusion matrix: 
 [[545  28]
 [ 18  14]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.562 0.438]]
Validation f1: 37.84
Validation accuracy: 92.40
Validation recall: 43.75
Validation precision: 33.33
Validation AUC: 0.5061335662505668
Validation class accuracies: [0.9511343804537522, 0.4375]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 23/65
183/183 - 78s - loss: 0.0120 - accuracy: 0.9959 - val_loss: 0.3027 - val_accuracy: 0.9273
Confusion matrix: 
 [[545  28]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.5   0.5  ]]
Validation f1: 42.11
Validation accuracy: 92.73
Validation recall: 50.00
Validation precision: 36.36
Validation AUC: 0.5137412561359755
Validation class accuracies: [0.9511343804537522, 0.5]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 13 epochs
Epoch 24/65
183/183 - 75s - loss: 0.0108 - accuracy: 0.9962 - val_loss: 0.3083 - val_accuracy: 0.9240
Confusion matrix: 
 [[544  29]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.531 0.469]]
Validation f1: 39.47
Validation accuracy: 92.40
Validation recall: 46.88
Validation precision: 34.09
Validation AUC: 0.5066044506377972
Validation class accuracies: [0.9493891797556719, 0.46875]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 14 epochs
Epoch 25/65
183/183 - 71s - loss: 0.0513 - accuracy: 0.9945 - val_loss: 0.2958 - val_accuracy: 0.9273
Confusion matrix: 
 [[541  32]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.375 0.625]]
Validation f1: 47.62
Validation accuracy: 92.73
Validation recall: 62.50
Validation precision: 38.46
Validation AUC: 0.5491482240940954
Validation class accuracies: [0.944153577661431, 0.625]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 15 epochs
Epoch 26/65
183/183 - 72s - loss: 0.0118 - accuracy: 0.9949 - val_loss: 0.2742 - val_accuracy: 0.9306
Confusion matrix: 
 [[546  27]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 44.74
Validation accuracy: 93.06
Validation recall: 53.12
Validation precision: 38.64
Validation AUC: 0.5216533650015065
Validation class accuracies: [0.9528795811518325, 0.53125]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 16 epochs
Epoch 27/65
183/183 - 77s - loss: 0.0122 - accuracy: 0.9955 - val_loss: 0.2720 - val_accuracy: 0.9273
Confusion matrix: 
 [[546  27]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.54
Validation accuracy: 92.73
Validation recall: 46.88
Validation precision: 35.71
Validation AUC: 0.5038754472815001
Validation class accuracies: [0.9528795811518325, 0.46875]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 17 epochs
Epoch 28/65
183/183 - 77s - loss: 0.0097 - accuracy: 0.9966 - val_loss: 0.2947 - val_accuracy: 0.9273
Confusion matrix: 
 [[546  27]
 [ 17  15]]
Normalized Confusion matrix: 
 [[0.953 0.047]
 [0.531 0.469]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.54
Validation accuracy: 92.73
Validation recall: 46.88
Validation precision: 35.71
Validation AUC: 0.4987423819963508
Validation class accuracies: [0.9528795811518325, 0.46875]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 29/65
183/183 - 78s - loss: 0.0081 - accuracy: 0.9990 - val_loss: 0.3071 - val_accuracy: 0.9273
Confusion matrix: 
 [[544  29]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.59
Validation accuracy: 92.73
Validation recall: 53.12
Validation precision: 36.96
Validation AUC: 0.5073656141706563
Validation class accuracies: [0.9493891797556719, 0.53125]
The validation tracker metric at 0.6181818181818182 hasn't increased by 0 in 19 epochs
Epoch 30/65
183/183 - 77s - loss: 0.0432 - accuracy: 0.9973 - val_loss: 0.3118 - val_accuracy: 0.9322
Confusion matrix: 
 [[545  28]
 [ 13  19]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.406 0.594]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 48.10
Validation accuracy: 93.22
Validation recall: 59.38
Validation precision: 40.43
Validation AUC: 0.5209496717240224
Validation class accuracies: [0.9511343804537522, 0.59375]

The metrics for job 0 with the best target metric are: 
Best cm: [[567   6]
 [ 15  17]]
Best normalized cm: [[0.99  0.01 ]
 [0.469 0.531]]
Best f1: 0.62
Best accuracy: 0.97
Best recall: 0.53
Best precision: 0.74
Best AUC: 0.61
Best class accuracies: [0.9895287958115183, 0.53125]
Best epoch: 10
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented
Length of training samples after spec augmentation: 2764
-----------------------
Number of train recordings: 2764 with pneumonia: 464 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2864
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_2
Length of training samples after spec augmentation: 2914
-----------------------
Number of train recordings: 2914 with pneumonia: 464 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_4 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_18 (BatchNormal (None, 128, 1250, 1)    4            input_4[0][0]                        
______________________________________________________________________________________________________________
conv2d_40 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_42 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_18[0][0]         
______________________________________________________________________________________________________________
conv2d_41 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_40[0][0]                      
______________________________________________________________________________________________________________
conv2d_43 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_42[0][0]                      
______________________________________________________________________________________________________________
conv2d_44 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_7[0][0]                
______________________________________________________________________________________________________________
concatenate_33677 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_41[0][0]                      
                                                                         conv2d_43[0][0]                      
                                                                         conv2d_44[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_16 (AveragePoolin (None, 64, 625, 48)     0            concatenate_33677[0][0]              
______________________________________________________________________________________________________________
batch_normalization_19 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_16[0][0]           
______________________________________________________________________________________________________________
dropout_5 (Dropout)                 (None, 64, 625, 48)     0            batch_normalization_19[0][0]         
______________________________________________________________________________________________________________
inverted_residual_10 (InvertedResid (None, 64, 625, 32)     35840        dropout_5[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_11 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_10[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_17 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_11[0][0]           
______________________________________________________________________________________________________________
batch_normalization_20 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_17[0][0]           
______________________________________________________________________________________________________________
dropout_6 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_20[0][0]         
______________________________________________________________________________________________________________
inverted_residual_12 (InvertedResid (None, 32, 312, 64)     27136        dropout_6[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_13 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_12[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_18 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_13[0][0]           
______________________________________________________________________________________________________________
batch_normalization_21 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_18[0][0]           
______________________________________________________________________________________________________________
dropout_7 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_21[0][0]         
______________________________________________________________________________________________________________
inverted_residual_14 (InvertedResid (None, 16, 156, 128)    91136        dropout_7[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_15 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_14[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_19 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_15[0][0]           
______________________________________________________________________________________________________________
batch_normalization_22 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_19[0][0]           
______________________________________________________________________________________________________________
dropout_8 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_22[0][0]         
______________________________________________________________________________________________________________
inverted_residual_16 (InvertedResid (None, 8, 78, 256)      329728       dropout_8[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_17 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_16[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_20 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_17[0][0]           
______________________________________________________________________________________________________________
batch_normalization_23 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_20[0][0]           
______________________________________________________________________________________________________________
dropout_9 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_23[0][0]         
______________________________________________________________________________________________________________
inverted_residual_18 (InvertedResid (None, 4, 39, 512)      1249280      dropout_9[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_19 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_18[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_3 (GlobalA (None, 512)             0            inverted_residual_19[0][0]           
______________________________________________________________________________________________________________
dense_3 (Dense)                     (None, 1)               513          global_average_pooling2d_3[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
183/183 - 262s - loss: 1.0484 - accuracy: 0.5148 - val_loss: 0.7655 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.056879667355541196
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
183/183 - 263s - loss: 0.6222 - accuracy: 0.6249 - val_loss: 0.4252 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.43852100445030917
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
183/183 - 263s - loss: 0.5639 - accuracy: 0.6637 - val_loss: 0.2825 - val_accuracy: 0.9273
Confusion matrix: 
 [[561  12]
 [ 32   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.979 0.021]
 [1.    0.   ]]
Validation f1: 0.00
Validation accuracy: 92.73
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.04317936736601042
Validation class accuracies: [0.9790575916230366, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
183/183 - 263s - loss: 0.4824 - accuracy: 0.7217 - val_loss: 2.5509 - val_accuracy: 0.3934
Confusion matrix: 
 [[206 367]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.36 0.64]
 [0.   1.  ]]
Validation f1: 14.85
Validation accuracy: 39.34
Validation recall: 100.00
Validation precision: 8.02
Validation AUC: 0.2711260979521021
Validation class accuracies: [0.35951134380453753, 1.0]
Saving model...
Epoch 5/65
183/183 - 264s - loss: 0.4018 - accuracy: 0.7780 - val_loss: 0.5954 - val_accuracy: 0.9008
Confusion matrix: 
 [[533  40]
 [ 20  12]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.625 0.375]]
Validation f1: 28.57
Validation accuracy: 90.08
Validation recall: 37.50
Validation precision: 23.08
Validation AUC: 0.2262680695213722
Validation class accuracies: [0.9301919720767888, 0.375]
Saving model...
Epoch 6/65
183/183 - 264s - loss: 0.3317 - accuracy: 0.8185 - val_loss: 0.7165 - val_accuracy: 0.7554
Confusion matrix: 
 [[432 141]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.754 0.246]
 [0.219 0.781]]
Validation f1: 25.25
Validation accuracy: 75.54
Validation recall: 78.12
Validation precision: 15.06
Validation AUC: 0.38252053450559503
Validation class accuracies: [0.7539267015706806, 0.78125]
The validation tracker metric at 0.2857142857142857 hasn't increased by 0 in 1 epochs
Epoch 7/65
183/183 - 263s - loss: 0.2856 - accuracy: 0.8535 - val_loss: 0.2682 - val_accuracy: 0.9041
Confusion matrix: 
 [[525  48]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.916 0.084]
 [0.312 0.688]]
Validation f1: 43.14
Validation accuracy: 90.41
Validation recall: 68.75
Validation precision: 31.43
Validation AUC: 0.6007524134401591
Validation class accuracies: [0.9162303664921466, 0.6875]
Saving model...
Epoch 8/65
183/183 - 263s - loss: 0.2210 - accuracy: 0.8850 - val_loss: 0.7181 - val_accuracy: 0.6992
Confusion matrix: 
 [[399 174]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.696 0.304]
 [0.25  0.75 ]]
Validation f1: 20.87
Validation accuracy: 69.92
Validation recall: 75.00
Validation precision: 12.12
Validation AUC: 0.5241626907021965
Validation class accuracies: [0.6963350785340314, 0.75]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 1 epochs
Epoch 9/65
183/183 - 262s - loss: 0.2521 - accuracy: 0.8826 - val_loss: 0.6558 - val_accuracy: 0.9405
Confusion matrix: 
 [[562  11]
 [ 25   7]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.981 0.019]
 [0.781 0.219]]
Validation f1: 28.00
Validation accuracy: 94.05
Validation recall: 21.88
Validation precision: 38.89
Validation AUC: 0.19945405502612737
Validation class accuracies: [0.9808027923211169, 0.21875]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 2 epochs
Epoch 10/65
183/183 - 264s - loss: 0.3348 - accuracy: 0.8336 - val_loss: 0.9729 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2321314487133309
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 3 epochs
Epoch 11/65
183/183 - 262s - loss: 0.1887 - accuracy: 0.9046 - val_loss: 0.8993 - val_accuracy: 0.7339
Confusion matrix: 
 [[415 158]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.724 0.276]
 [0.094 0.906]]
Validation f1: 26.48
Validation accuracy: 73.39
Validation recall: 90.62
Validation precision: 15.51
Validation AUC: 0.6696711992047398
Validation class accuracies: [0.7242582897033158, 0.90625]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 4 epochs
Epoch 12/65
183/183 - 263s - loss: 0.1742 - accuracy: 0.9125 - val_loss: 0.9105 - val_accuracy: 0.6793
Confusion matrix: 
 [[387 186]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.675 0.325]
 [0.25  0.75 ]]
Validation f1: 19.83
Validation accuracy: 67.93
Validation recall: 75.00
Validation precision: 11.43
Validation AUC: 0.6042515853414362
Validation class accuracies: [0.675392670157068, 0.75]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 5 epochs
Epoch 13/65
183/183 - 264s - loss: 0.1248 - accuracy: 0.9399 - val_loss: 0.1900 - val_accuracy: 0.9405
Confusion matrix: 
 [[556  17]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.594 0.406]]
Validation f1: 41.94
Validation accuracy: 94.05
Validation recall: 40.62
Validation precision: 43.33
Validation AUC: 0.4404046784460766
Validation class accuracies: [0.9703315881326352, 0.40625]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 14/65
183/183 - 264s - loss: 0.1069 - accuracy: 0.9458 - val_loss: 0.3737 - val_accuracy: 0.8512
Confusion matrix: 
 [[493  80]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.86  0.14 ]
 [0.312 0.688]]
Validation f1: 32.84
Validation accuracy: 85.12
Validation recall: 68.75
Validation precision: 21.57
Validation AUC: 0.6076608676924418
Validation class accuracies: [0.8603839441535777, 0.6875]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 7 epochs
Epoch 15/65
183/183 - 263s - loss: 0.0656 - accuracy: 0.9653 - val_loss: 0.6718 - val_accuracy: 0.8149
Confusion matrix: 
 [[468 105]
 [  7  25]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.817 0.183]
 [0.219 0.781]]
Validation f1: 30.86
Validation accuracy: 81.49
Validation recall: 78.12
Validation precision: 19.23
Validation AUC: 0.6337070565348495
Validation class accuracies: [0.8167539267015707, 0.78125]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 8 epochs
Epoch 16/65
183/183 - 263s - loss: 0.0589 - accuracy: 0.9732 - val_loss: 0.5977 - val_accuracy: 0.8248
Confusion matrix: 
 [[471 102]
 [  4  28]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.822 0.178]
 [0.125 0.875]]
Validation f1: 34.57
Validation accuracy: 82.48
Validation recall: 87.50
Validation precision: 21.54
Validation AUC: 0.6054408640151978
Validation class accuracies: [0.8219895287958116, 0.875]
The validation tracker metric at 0.43137254901960786 hasn't increased by 0 in 9 epochs
Epoch 17/65
183/183 - 263s - loss: 0.0831 - accuracy: 0.9763 - val_loss: 0.2203 - val_accuracy: 0.9521
Confusion matrix: 
 [[560  13]
 [ 16  16]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.977 0.023]
 [0.5   0.5  ]]
Validation f1: 52.46
Validation accuracy: 95.21
Validation recall: 50.00
Validation precision: 55.17
Validation AUC: 0.5453377811317356
Validation class accuracies: [0.9773123909249564, 0.5]
Saving model...
Epoch 18/65
183/183 - 261s - loss: 0.0831 - accuracy: 0.9609 - val_loss: 0.2301 - val_accuracy: 0.9686
Confusion matrix: 
 [[569   4]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.469 0.531]]
Validation f1: 64.15
Validation accuracy: 96.86
Validation recall: 53.12
Validation precision: 80.95
Validation AUC: 0.5670037568041516
Validation class accuracies: [0.9930191972076788, 0.53125]
Saving model...
Epoch 19/65
183/183 - 258s - loss: 0.0604 - accuracy: 0.9691 - val_loss: 0.2389 - val_accuracy: 0.9207
Confusion matrix: 
 [[536  37]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.344 0.656]]
Validation f1: 46.67
Validation accuracy: 92.07
Validation recall: 65.62
Validation precision: 36.21
Validation AUC: 0.6072325106636473
Validation class accuracies: [0.9354275741710296, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 1 epochs
Epoch 20/65
183/183 - 258s - loss: 0.0610 - accuracy: 0.9725 - val_loss: 0.3496 - val_accuracy: 0.9273
Confusion matrix: 
 [[552  21]
 [ 23   9]]
Normalized Confusion matrix: 
 [[0.963 0.037]
 [0.719 0.281]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 29.03
Validation accuracy: 92.73
Validation recall: 28.12
Validation precision: 30.00
Validation AUC: 0.24819351749653285
Validation class accuracies: [0.9633507853403142, 0.28125]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 2 epochs
Epoch 21/65
183/183 - 257s - loss: 0.0555 - accuracy: 0.9725 - val_loss: 2.0347 - val_accuracy: 0.5835
Confusion matrix: 
 [[327 246]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.571 0.429]
 [0.188 0.812]]
Validation f1: 17.11
Validation accuracy: 58.35
Validation recall: 81.25
Validation precision: 9.56
Validation AUC: 0.48836350136188483
Validation class accuracies: [0.5706806282722513, 0.8125]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 3 epochs
Epoch 22/65
183/183 - 257s - loss: 0.0430 - accuracy: 0.9791 - val_loss: 0.2377 - val_accuracy: 0.9322
Confusion matrix: 
 [[544  29]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.949 0.051]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 49.38
Validation accuracy: 93.22
Validation recall: 62.50
Validation precision: 40.82
Validation AUC: 0.6117601773069622
Validation class accuracies: [0.9493891797556719, 0.625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 4 epochs
Epoch 23/65
183/183 - 258s - loss: 0.0420 - accuracy: 0.9815 - val_loss: 0.2871 - val_accuracy: 0.9223
Confusion matrix: 
 [[539  34]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.406 0.594]]
Validation f1: 44.71
Validation accuracy: 92.23
Validation recall: 59.38
Validation precision: 35.85
Validation AUC: 0.5348519787036722
Validation class accuracies: [0.9406631762652705, 0.59375]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 5 epochs
Epoch 24/65
183/183 - 257s - loss: 0.0872 - accuracy: 0.9657 - val_loss: 0.4181 - val_accuracy: 0.8760
Confusion matrix: 
 [[507  66]
 [  9  23]]
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.281 0.719]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 38.02
Validation accuracy: 87.60
Validation recall: 71.88
Validation precision: 25.84
Validation AUC: 0.6736216143264481
Validation class accuracies: [0.8848167539267016, 0.71875]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 25/65
183/183 - 258s - loss: 0.0307 - accuracy: 0.9859 - val_loss: 0.5119 - val_accuracy: 0.8314
Confusion matrix: 
 [[482  91]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.841 0.159]
 [0.344 0.656]]
Validation f1: 29.17
Validation accuracy: 83.14
Validation recall: 65.62
Validation precision: 18.75
Validation AUC: 0.5734364877901634
Validation class accuracies: [0.8411867364746946, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 7 epochs
Epoch 26/65
183/183 - 257s - loss: 0.0273 - accuracy: 0.9866 - val_loss: 0.3051 - val_accuracy: 0.9074
Confusion matrix: 
 [[528  45]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.344 0.656]]
Validation f1: 42.86
Validation accuracy: 90.74
Validation recall: 65.62
Validation precision: 31.82
Validation AUC: 0.6306595837531608
Validation class accuracies: [0.9214659685863874, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 8 epochs
Epoch 27/65
183/183 - 257s - loss: 0.0234 - accuracy: 0.9894 - val_loss: 0.3585 - val_accuracy: 0.8959
Confusion matrix: 
 [[521  52]
 [ 11  21]]
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.344 0.656]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.00
Validation accuracy: 89.59
Validation recall: 65.62
Validation precision: 28.77
Validation AUC: 0.6182550764533231
Validation class accuracies: [0.9092495636998255, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 9 epochs
Epoch 28/65
183/183 - 258s - loss: 0.0310 - accuracy: 0.9873 - val_loss: 0.2584 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.645203687389212
Validation class accuracies: [0.9511343804537522, 0.625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 10 epochs
Epoch 29/65
183/183 - 257s - loss: 0.0256 - accuracy: 0.9883 - val_loss: 0.4133 - val_accuracy: 0.8876
Confusion matrix: 
 [[516  57]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.901 0.099]
 [0.344 0.656]]
Validation f1: 38.18
Validation accuracy: 88.76
Validation recall: 65.62
Validation precision: 26.92
Validation AUC: 0.6392548979550681
Validation class accuracies: [0.900523560209424, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 11 epochs
Epoch 30/65
183/183 - 257s - loss: 0.0156 - accuracy: 0.9935 - val_loss: 0.2939 - val_accuracy: 0.9190
Confusion matrix: 
 [[535  38]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.344 0.656]]
Validation f1: 46.15
Validation accuracy: 91.90
Validation recall: 65.62
Validation precision: 35.59
Validation AUC: 0.6314522661451993
Validation class accuracies: [0.9336823734729494, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 31/65
183/183 - 258s - loss: 0.0170 - accuracy: 0.9942 - val_loss: 0.6438 - val_accuracy: 0.8298
Confusion matrix: 
 [[481  92]
 [ 11  21]]
Normalized Confusion matrix: 
 [[0.839 0.161]
 [0.344 0.656]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 28.97
Validation accuracy: 82.98
Validation recall: 65.62
Validation precision: 18.58
Validation AUC: 0.6185845123013749
Validation class accuracies: [0.8394415357766143, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 13 epochs
Epoch 32/65
183/183 - 258s - loss: 0.0274 - accuracy: 0.9846 - val_loss: 0.3392 - val_accuracy: 0.9140
Confusion matrix: 
 [[533  40]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 43.48
Validation accuracy: 91.40
Validation recall: 62.50
Validation precision: 33.33
Validation AUC: 0.620906993255134
Validation class accuracies: [0.9301919720767888, 0.625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 14 epochs
Epoch 33/65
183/183 - 257s - loss: 0.0245 - accuracy: 0.9907 - val_loss: 0.3951 - val_accuracy: 0.9008
Confusion matrix: 
 [[524  49]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.914 0.086]
 [0.344 0.656]]
Validation f1: 41.18
Validation accuracy: 90.08
Validation recall: 65.62
Validation precision: 30.00
Validation AUC: 0.646435956199232
Validation class accuracies: [0.9144851657940664, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 15 epochs
Epoch 34/65
183/183 - 257s - loss: 0.0243 - accuracy: 0.9880 - val_loss: 0.3642 - val_accuracy: 0.9190
Confusion matrix: 
 [[536  37]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.375 0.625]]
Validation f1: 44.94
Validation accuracy: 91.90
Validation recall: 62.50
Validation precision: 35.09
Validation AUC: 0.6017549456996806
Validation class accuracies: [0.9354275741710296, 0.625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 16 epochs
Epoch 35/65
183/183 - 257s - loss: 0.0149 - accuracy: 0.9911 - val_loss: 0.2905 - val_accuracy: 0.9289
Confusion matrix: 
 [[542  31]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.946 0.054]
 [0.375 0.625]]
Validation f1: 48.19
Validation accuracy: 92.89
Validation recall: 62.50
Validation precision: 39.22
Validation AUC: 0.638589420095947
Validation class accuracies: [0.9458987783595113, 0.625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 17 epochs
Epoch 36/65
183/183 - 258s - loss: 0.0106 - accuracy: 0.9969 - val_loss: 0.3553 - val_accuracy: 0.9157
Confusion matrix: 
 [[533  40]
 [ 11  21]]
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.344 0.656]]
Validation f1: 45.16
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 91.57
Validation recall: 65.62
Validation precision: 34.43
Validation AUC: 0.6429574491115196
Validation class accuracies: [0.9301919720767888, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 6.25000029685907e-05
Epoch 37/65
183/183 - 257s - loss: 0.0178 - accuracy: 0.9925 - val_loss: 0.3857 - val_accuracy: 0.9041
Confusion matrix: 
 [[526  47]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.344 0.656]]
Validation f1: 42.00
Validation accuracy: 90.41
Validation recall: 65.62
Validation precision: 30.88
Validation AUC: 0.6264483716139008
Validation class accuracies: [0.9179755671902269, 0.65625]
The validation tracker metric at 0.6415094339622642 hasn't increased by 0 in 19 epochs
Epoch 38/65
183/183 - 257s - loss: 0.0119 - accuracy: 0.9938 - val_loss: 0.3486 - val_accuracy: 0.9207
Confusion matrix: 
 [[536  37]
 [ 11  21]]
Normalized Confusion matrix: 
 [[0.935 0.065]
 [0.344 0.656]]
Validation f1: 46.67
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation accuracy: 92.07
Validation recall: 65.62
Validation precision: 36.21
Validation AUC: 0.621533013578503
Validation class accuracies: [0.9354275741710296, 0.65625]

The metrics for job 0 with the best target metric are: 
Best cm: [[569   4]
 [ 15  17]]
Best normalized cm: [[0.993 0.007]
 [0.469 0.531]]
Best f1: 0.64
Best accuracy: 0.97
Best recall: 0.53
Best precision: 0.81
Best AUC: 0.57
Best class accuracies: [0.9930191972076788, 0.53125]
Best epoch: 18
The number of epochs since last 1% equals the patience
-----------------------
Model 9 with new params
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 1, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Collecting Variables...
All variables have been collected.
Pneumonia patients: 148, Non-pneumonia patients: 2873
-----------------------
Number of train recordings: 2416 with pneumonia: 116 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2648
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented
Length of training samples after spec augmentation: 2764
-----------------------
Number of train recordings: 2764 with pneumonia: 464 and non-pneumonia: 2300
Length of training samples after audio augmentation: 2864
The path used for spec augmentations is ../../data/txt_datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000/augmented_2
Length of training samples after spec augmentation: 2914
-----------------------
Number of train recordings: 2914 with pneumonia: 464 and non-pneumonia: 2450
Number of val recordings: 605 with pneumonia: 32 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_5 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization_24 (BatchNormal (None, 128, 1250, 1)    4            input_5[0][0]                        
______________________________________________________________________________________________________________
conv2d_45 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_47 (Conv2D)                  (None, 128, 1250, 16)   32           batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)      (None, 128, 1250, 1)    0            batch_normalization_24[0][0]         
______________________________________________________________________________________________________________
conv2d_46 (Conv2D)                  (None, 128, 1250, 16)   2320         conv2d_45[0][0]                      
______________________________________________________________________________________________________________
conv2d_48 (Conv2D)                  (None, 128, 1250, 16)   6416         conv2d_47[0][0]                      
______________________________________________________________________________________________________________
conv2d_49 (Conv2D)                  (None, 128, 1250, 16)   32           max_pooling2d_8[0][0]                
______________________________________________________________________________________________________________
concatenate_33678 (Concatenate)     (None, 128, 1250, 48)   0            conv2d_46[0][0]                      
                                                                         conv2d_48[0][0]                      
                                                                         conv2d_49[0][0]                      
______________________________________________________________________________________________________________
average_pooling2d_21 (AveragePoolin (None, 64, 625, 48)     0            concatenate_33678[0][0]              
______________________________________________________________________________________________________________
batch_normalization_25 (BatchNormal (None, 64, 625, 48)     192          average_pooling2d_21[0][0]           
______________________________________________________________________________________________________________
dropout_10 (Dropout)                (None, 64, 625, 48)     0            batch_normalization_25[0][0]         
______________________________________________________________________________________________________________
inverted_residual_20 (InvertedResid (None, 64, 625, 32)     35840        dropout_10[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_21 (InvertedResid (None, 64, 625, 32)     20864        inverted_residual_20[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_22 (AveragePoolin (None, 32, 312, 32)     0            inverted_residual_21[0][0]           
______________________________________________________________________________________________________________
batch_normalization_26 (BatchNormal (None, 32, 312, 32)     128          average_pooling2d_22[0][0]           
______________________________________________________________________________________________________________
dropout_11 (Dropout)                (None, 32, 312, 32)     0            batch_normalization_26[0][0]         
______________________________________________________________________________________________________________
inverted_residual_22 (InvertedResid (None, 32, 312, 64)     27136        dropout_11[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_23 (InvertedResid (None, 32, 312, 64)     66304        inverted_residual_22[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_23 (AveragePoolin (None, 16, 156, 64)     0            inverted_residual_23[0][0]           
______________________________________________________________________________________________________________
batch_normalization_27 (BatchNormal (None, 16, 156, 64)     256          average_pooling2d_23[0][0]           
______________________________________________________________________________________________________________
dropout_12 (Dropout)                (None, 16, 156, 64)     0            batch_normalization_27[0][0]         
______________________________________________________________________________________________________________
inverted_residual_24 (InvertedResid (None, 16, 156, 128)    91136        dropout_12[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_25 (InvertedResid (None, 16, 156, 128)    230912       inverted_residual_24[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_24 (AveragePoolin (None, 8, 78, 128)      0            inverted_residual_25[0][0]           
______________________________________________________________________________________________________________
batch_normalization_28 (BatchNormal (None, 8, 78, 128)      512          average_pooling2d_24[0][0]           
______________________________________________________________________________________________________________
dropout_13 (Dropout)                (None, 8, 78, 128)      0            batch_normalization_28[0][0]         
______________________________________________________________________________________________________________
inverted_residual_26 (InvertedResid (None, 8, 78, 256)      329728       dropout_13[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_27 (InvertedResid (None, 8, 78, 256)      855040       inverted_residual_26[0][0]           
______________________________________________________________________________________________________________
average_pooling2d_25 (AveragePoolin (None, 4, 39, 256)      0            inverted_residual_27[0][0]           
______________________________________________________________________________________________________________
batch_normalization_29 (BatchNormal (None, 4, 39, 256)      1024         average_pooling2d_25[0][0]           
______________________________________________________________________________________________________________
dropout_14 (Dropout)                (None, 4, 39, 256)      0            batch_normalization_29[0][0]         
______________________________________________________________________________________________________________
inverted_residual_28 (InvertedResid (None, 4, 39, 512)      1249280      dropout_14[0][0]                     
______________________________________________________________________________________________________________
inverted_residual_29 (InvertedResid (None, 4, 39, 512)      3282944      inverted_residual_28[0][0]           
______________________________________________________________________________________________________________
global_average_pooling2d_4 (GlobalA (None, 512)             0            inverted_residual_29[0][0]           
______________________________________________________________________________________________________________
dense_4 (Dense)                     (None, 1)               513          global_average_pooling2d_4[0][0]     
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Epoch 1/65
183/183 - 253s - loss: 1.2218 - accuracy: 0.5491 - val_loss: 1.4106 - val_accuracy: 0.0529
Confusion matrix: 
 [[  0 573]
 [  0  32]]
Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 10.05
Validation accuracy: 5.29
Validation recall: 100.00
Validation precision: 5.29
Validation AUC: 0.12969824116354384
Validation class accuracies: [0.0, 1.0]
Saving model...
Epoch 2/65
183/183 - 258s - loss: 0.6720 - accuracy: 0.5882 - val_loss: 0.4718 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.06615973582816193
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 1 epochs
Epoch 3/65
183/183 - 259s - loss: 0.6059 - accuracy: 0.6507 - val_loss: 0.2546 - val_accuracy: 0.9471
Confusion matrix: 
 [[573   0]
 [ 32   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation f1: 0.00
Validation accuracy: 94.71
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.11546265058311612
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0.10047095761381476 hasn't increased by 0 in 2 epochs
Epoch 4/65
183/183 - 258s - loss: 0.4536 - accuracy: 0.7440 - val_loss: 0.4412 - val_accuracy: 0.7653
Confusion matrix: 
 [[437 136]
 [  6  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.763 0.237]
 [0.188 0.812]]
Validation f1: 26.80
Validation accuracy: 76.53
Validation recall: 81.25
Validation precision: 16.05
Validation AUC: 0.4826675309859749
Validation class accuracies: [0.7626527050610821, 0.8125]
Saving model...
Epoch 5/65
183/183 - 257s - loss: 0.3259 - accuracy: 0.8411 - val_loss: 8.0484 - val_accuracy: 0.1388
Confusion matrix: 
 [[ 52 521]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.091 0.909]
 [0.    1.   ]]
Validation f1: 10.94
Validation accuracy: 13.88
Validation recall: 100.00
Validation precision: 5.79
Validation AUC: 0.1481127393553742
Validation class accuracies: [0.09075043630017451, 1.0]
The validation tracker metric at 0.26804123711340205 hasn't increased by 0 in 1 epochs
Epoch 6/65
183/183 - 257s - loss: 0.3385 - accuracy: 0.8294 - val_loss: 9.8838 - val_accuracy: 0.1124
Confusion matrix: 
 [[ 36 537]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.063 0.937]
 [0.    1.   ]]
Validation f1: 10.65
Validation accuracy: 11.24
Validation recall: 100.00
Validation precision: 5.62
Validation AUC: 0.49145246838572276
Validation class accuracies: [0.06282722513089005, 1.0]
The validation tracker metric at 0.26804123711340205 hasn't increased by 0 in 2 epochs
Epoch 7/65
183/183 - 257s - loss: 0.3647 - accuracy: 0.8219 - val_loss: 0.8988 - val_accuracy: 0.7190
Confusion matrix: 
 [[406 167]
 [  3  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.709 0.291]
 [0.094 0.906]]
Validation f1: 25.44
Validation accuracy: 71.90
Validation recall: 90.62
Validation precision: 14.80
Validation AUC: 0.646771403385981
Validation class accuracies: [0.7085514834205934, 0.90625]
The validation tracker metric at 0.26804123711340205 hasn't increased by 0 in 3 epochs
Epoch 8/65
183/183 - 257s - loss: 0.2546 - accuracy: 0.8727 - val_loss: 0.4868 - val_accuracy: 0.8744
Confusion matrix: 
 [[508  65]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.887 0.113]
 [0.344 0.656]]
Validation f1: 35.59
Validation accuracy: 87.44
Validation recall: 65.62
Validation precision: 24.42
Validation AUC: 0.596836074605695
Validation class accuracies: [0.8865619546247818, 0.65625]
Saving model...
Epoch 9/65
183/183 - 257s - loss: 0.3471 - accuracy: 0.8627 - val_loss: 7.5677 - val_accuracy: 0.2397
Confusion matrix: 
 [[114 459]
 [  1  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.199 0.801]
 [0.031 0.969]]
Validation f1: 11.88
Validation accuracy: 23.97
Validation recall: 96.88
Validation precision: 6.33
Validation AUC: 0.31712720719046616
Validation class accuracies: [0.19895287958115182, 0.96875]
The validation tracker metric at 0.35593220338983045 hasn't increased by 0 in 1 epochs
Epoch 10/65
183/183 - 257s - loss: 0.2633 - accuracy: 0.8717 - val_loss: 0.6933 - val_accuracy: 0.7752
Confusion matrix: 
 [[445 128]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.777 0.223]
 [0.25  0.75 ]]
Validation f1: 26.09
Validation accuracy: 77.52
Validation recall: 75.00
Validation precision: 15.79
Validation AUC: 0.6191768916220767
Validation class accuracies: [0.7766143106457243, 0.75]
The validation tracker metric at 0.35593220338983045 hasn't increased by 0 in 2 epochs
Epoch 11/65
183/183 - 257s - loss: 0.1785 - accuracy: 0.9056 - val_loss: 1.2533 - val_accuracy: 0.7471
Confusion matrix: 
 [[428 145]
 [  8  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.747 0.253]
 [0.25  0.75 ]]
Validation f1: 23.88
Validation accuracy: 74.71
Validation recall: 75.00
Validation precision: 14.20
Validation AUC: 0.45390608408737776
Validation class accuracies: [0.7469458987783595, 0.75]
The validation tracker metric at 0.35593220338983045 hasn't increased by 0 in 3 epochs
Epoch 12/65
183/183 - 257s - loss: 0.2586 - accuracy: 0.8809 - val_loss: 10.6521 - val_accuracy: 0.1636
Confusion matrix: 
 [[ 67 506]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.117 0.883]
 [0.    1.   ]]
Validation f1: 11.23
Validation accuracy: 16.36
Validation recall: 100.00
Validation precision: 5.95
Validation AUC: 0.4959065699819649
Validation class accuracies: [0.1169284467713787, 1.0]
The validation tracker metric at 0.35593220338983045 hasn't increased by 0 in 4 epochs
Epoch 13/65
183/183 - 257s - loss: 0.2297 - accuracy: 0.8988 - val_loss: 2.6325 - val_accuracy: 0.3570
Confusion matrix: 
 [[184 389]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.321 0.679]
 [0.    1.   ]]
Validation f1: 14.13
Validation accuracy: 35.70
Validation recall: 100.00
Validation precision: 7.60
Validation AUC: 0.48058836879630873
Validation class accuracies: [0.32111692844677137, 1.0]
The validation tracker metric at 0.35593220338983045 hasn't increased by 0 in 5 epochs
Epoch 14/65
183/183 - 257s - loss: 0.1103 - accuracy: 0.9403 - val_loss: 0.2167 - val_accuracy: 0.9438
Confusion matrix: 
 [[551  22]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.962 0.038]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 54.05
Validation accuracy: 94.38
Validation recall: 62.50
Validation precision: 47.62
Validation AUC: 0.567709357477834
Validation class accuracies: [0.9616055846422339, 0.625]
Saving model...
Epoch 15/65
183/183 - 257s - loss: 0.0907 - accuracy: 0.9595 - val_loss: 0.3087 - val_accuracy: 0.9124
Confusion matrix: 
 [[539  34]
 [ 19  13]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.941 0.059]
 [0.594 0.406]]
Validation f1: 32.91
Validation accuracy: 91.24
Validation recall: 40.62
Validation precision: 27.66
Validation AUC: 0.2529750315546675
Validation class accuracies: [0.9406631762652705, 0.40625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 1 epochs
Epoch 16/65
183/183 - 257s - loss: 0.0684 - accuracy: 0.9715 - val_loss: 0.6510 - val_accuracy: 0.7950
Confusion matrix: 
 [[461 112]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.805 0.195]
 [0.375 0.625]]
Validation f1: 24.39
Validation accuracy: 79.50
Validation recall: 62.50
Validation precision: 15.15
Validation AUC: 0.38386308625742993
Validation class accuracies: [0.8045375218150087, 0.625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 2 epochs
Epoch 17/65
183/183 - 257s - loss: 0.0876 - accuracy: 0.9602 - val_loss: 0.9025 - val_accuracy: 0.9455
Confusion matrix: 
 [[569   4]
 [ 29   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.906 0.094]]
Validation f1: 15.38
Validation accuracy: 94.55
Validation recall: 9.38
Validation precision: 42.86
Validation AUC: 0.20419035117726456
Validation class accuracies: [0.9930191972076788, 0.09375]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 3 epochs
Epoch 18/65
183/183 - 256s - loss: 0.1621 - accuracy: 0.9327 - val_loss: 0.6337 - val_accuracy: 0.8562
Confusion matrix: 
 [[497  76]
 [ 11  21]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.867 0.133]
 [0.344 0.656]]
Validation f1: 32.56
Validation accuracy: 85.62
Validation recall: 65.62
Validation precision: 21.65
Validation AUC: 0.6452136347667646
Validation class accuracies: [0.8673647469458988, 0.65625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 4 epochs
Epoch 19/65
183/183 - 256s - loss: 0.1024 - accuracy: 0.9588 - val_loss: 2.3620 - val_accuracy: 0.6231
Confusion matrix: 
 [[345 228]
 [  0  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.602 0.398]
 [0.    1.   ]]
Validation f1: 21.92
Validation accuracy: 62.31
Validation recall: 100.00
Validation precision: 12.31
Validation AUC: 0.5322492775902987
Validation class accuracies: [0.6020942408376964, 1.0]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 5 epochs
Epoch 20/65
183/183 - 257s - loss: 0.2738 - accuracy: 0.8960 - val_loss: 0.3612 - val_accuracy: 0.9107
Confusion matrix: 
 [[532  41]
 [ 13  19]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.406 0.594]]
Validation f1: 41.30
Validation accuracy: 91.07
Validation recall: 59.38
Validation precision: 31.67
Validation AUC: 0.5540746584702427
Validation class accuracies: [0.9284467713787086, 0.59375]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 21/65
183/183 - 257s - loss: 0.1002 - accuracy: 0.9461 - val_loss: 0.2005 - val_accuracy: 0.9488
Confusion matrix: 
 [[556  17]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.97  0.03 ]
 [0.438 0.562]]
Validation f1: 53.73
Validation accuracy: 94.88
Validation recall: 56.25
Validation precision: 51.43
Validation AUC: 0.5705282286008941
Validation class accuracies: [0.9703315881326352, 0.5625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 7 epochs
Epoch 22/65
183/183 - 257s - loss: 0.0557 - accuracy: 0.9736 - val_loss: 0.3903 - val_accuracy: 0.9025
Confusion matrix: 
 [[526  47]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.918 0.082]
 [0.375 0.625]]
Validation f1: 40.40
Validation accuracy: 90.25
Validation recall: 62.50
Validation precision: 29.85
Validation AUC: 0.5808887054682971
Validation class accuracies: [0.9179755671902269, 0.625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 8 epochs
Epoch 23/65
183/183 - 257s - loss: 0.0627 - accuracy: 0.9743 - val_loss: 0.2587 - val_accuracy: 0.9174
Confusion matrix: 
 [[535  38]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.934 0.066]
 [0.375 0.625]]
Validation f1: 44.44
Validation accuracy: 91.74
Validation recall: 62.50
Validation precision: 34.48
Validation AUC: 0.6150580286453398
Validation class accuracies: [0.9336823734729494, 0.625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 9 epochs
Epoch 24/65
183/183 - 257s - loss: 0.0626 - accuracy: 0.9825 - val_loss: 0.3650 - val_accuracy: 0.9058
Confusion matrix: 
 [[528  45]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.921 0.079]
 [0.375 0.625]]
Validation f1: 41.24
Validation accuracy: 90.58
Validation recall: 62.50
Validation precision: 30.77
Validation AUC: 0.5669434917097187
Validation class accuracies: [0.9214659685863874, 0.625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 10 epochs
Epoch 25/65
183/183 - 257s - loss: 0.0431 - accuracy: 0.9801 - val_loss: 0.2476 - val_accuracy: 0.9339
Confusion matrix: 
 [[545  28]
 [ 12  20]]
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.375 0.625]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 50.00
Validation accuracy: 93.39
Validation recall: 62.50
Validation precision: 41.67
Validation AUC: 0.624893543083247
Validation class accuracies: [0.9511343804537522, 0.625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 11 epochs
Epoch 26/65
183/183 - 257s - loss: 0.0418 - accuracy: 0.9801 - val_loss: 0.5107 - val_accuracy: 0.8975
Confusion matrix: 
 [[521  52]
 [ 10  22]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.909 0.091]
 [0.312 0.688]]
Validation f1: 41.51
Validation accuracy: 89.75
Validation recall: 68.75
Validation precision: 29.73
Validation AUC: 0.5859065241203286
Validation class accuracies: [0.9092495636998255, 0.6875]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 27/65
183/183 - 257s - loss: 0.0340 - accuracy: 0.9835 - val_loss: 0.4819 - val_accuracy: 0.8793
Confusion matrix: 
 [[512  61]
 [ 12  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.894 0.106]
 [0.375 0.625]]
Validation f1: 35.40
Validation accuracy: 87.93
Validation recall: 62.50
Validation precision: 24.69
Validation AUC: 0.5492182847798219
Validation class accuracies: [0.893542757417103, 0.625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 13 epochs
Epoch 28/65
183/183 - 257s - loss: 0.0248 - accuracy: 0.9911 - val_loss: 0.2739 - val_accuracy: 0.9306
Confusion matrix: 
 [[545  28]
 [ 14  18]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.951 0.049]
 [0.438 0.562]]
Validation f1: 46.15
Validation accuracy: 93.06
Validation recall: 56.25
Validation precision: 39.13
Validation AUC: 0.5693322491898792
Validation class accuracies: [0.9511343804537522, 0.5625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 14 epochs
Epoch 29/65
183/183 - 257s - loss: 0.0256 - accuracy: 0.9904 - val_loss: 0.3632 - val_accuracy: 0.9074
Confusion matrix: 
 [[532  41]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.928 0.072]
 [0.469 0.531]]
Validation f1: 37.78
Validation accuracy: 90.74
Validation recall: 53.12
Validation precision: 29.31
Validation AUC: 0.5289874414834166
Validation class accuracies: [0.9284467713787086, 0.53125]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 15 epochs
Epoch 30/65
183/183 - 257s - loss: 0.0193 - accuracy: 0.9925 - val_loss: 0.4261 - val_accuracy: 0.8975
Confusion matrix: 
 [[522  51]
 [ 11  21]]
Normalized Confusion matrix: 
 [[0.911 0.089]
 [0.344 0.656]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 40.38
Validation accuracy: 89.75
Validation recall: 65.62
Validation precision: 29.17
Validation AUC: 0.5633610462919262
Validation class accuracies: [0.9109947643979057, 0.65625]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 16 epochs
Epoch 31/65
183/183 - 257s - loss: 0.0415 - accuracy: 0.9911 - val_loss: 0.2029 - val_accuracy: 0.9455
Confusion matrix: 
 [[555  18]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.469 0.531]]
Validation f1: 50.75
Validation accuracy: 94.55
Validation recall: 53.12
Validation precision: 48.57
Validation AUC: 0.5487840825985975
Validation class accuracies: [0.9685863874345549, 0.53125]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 17 epochs
Epoch 32/65
183/183 - 257s - loss: 0.0899 - accuracy: 0.9801 - val_loss: 0.3904 - val_accuracy: 0.9207
Confusion matrix: 
 [[540  33]
 [ 15  17]]
Normalized Confusion matrix: 
 [[0.942 0.058]
 [0.469 0.531]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Validation f1: 41.46
Validation accuracy: 92.07
Validation recall: 53.12
Validation precision: 34.00
Validation AUC: 0.47856711700661325
Validation class accuracies: [0.9424083769633508, 0.53125]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 0.0001250000059371814
Epoch 33/65
183/183 - 257s - loss: 0.0398 - accuracy: 0.9863 - val_loss: 0.4043 - val_accuracy: 0.9190
Confusion matrix: 
 [[541  32]
 [ 17  15]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.944 0.056]
 [0.531 0.469]]
Validation f1: 37.97
Validation accuracy: 91.90
Validation recall: 46.88
Validation precision: 31.91
Validation AUC: 0.46072246111073123
Validation class accuracies: [0.944153577661431, 0.46875]
The validation tracker metric at 0.5405405405405405 hasn't increased by 0 in 19 epochs
Epoch 34/65
183/183 - 257s - loss: 0.0376 - accuracy: 0.9880 - val_loss: 0.4264 - val_accuracy: 0.9091
Confusion matrix: 
 [[533  40]
 [ 15  17]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.469 0.531]]
Validation f1: 38.20
Validation accuracy: 90.91
Validation recall: 53.12
Validation precision: 29.82
Validation AUC: 0.4879302086287705
Validation class accuracies: [0.9301919720767888, 0.53125]

The metrics for job 0 with the best target metric are: 
Best cm: [[551  22]
 [ 12  20]]
Best normalized cm: [[0.962 0.038]
 [0.375 0.625]]
Best f1: 0.54
Best accuracy: 0.94
Best recall: 0.62
Best precision: 0.48
Best AUC: 0.57
Best class accuracies: [0.9616055846422339, 0.625]
Best epoch: 14
The number of epochs since last 1% equals the patience
-----------------------
wandb: Waiting for W&B process to finish, PID 11139
wandb: Program ended successfully.
wandb: Find user logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_020357-1oymnl90/logs/debug.log
wandb: Find internal logs for this run at: /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_020357-1oymnl90/logs/debug-internal.log
wandb: Run summary:
wandb:       train_accuracy 0.98799
wandb:         val_accuracy 0.90909
wandb:             _runtime 35541
wandb:           _timestamp 1623844578
wandb:                _step 1256
wandb:           train_loss 0.03763
wandb:             val_loss 0.42638
wandb:           val_recall 0.53125
wandb:        val_precision 0.29825
wandb:               val_f1 0.38202
wandb:              val_auc 0.48793
wandb:                   lr 0.00013
wandb:          best_val_f1 0.54054
wandb:    best_val_accuracy 0.9438
wandb:   best_val_precision 0.47619
wandb:      best_val_recall 0.625
wandb:             best_auc 0.56771
wandb:           best_epoch 14
wandb: Run history:
wandb:   train_accuracy ▁▅▆▇▇▇████▇█████▆▆█▇███▁▆▆██▇███▃▆▆▇▆███
wandb:     val_accuracy █▅▂▇▇█▇███▅▆████▆▇██▆███▆▆▇█▇███▆▇▁▇████
wandb:         _runtime ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:       _timestamp ▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▄▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:            _step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:       train_loss █▅▃▂▂▂▁▁▁▁▂▁▁▁▁▁▃▃▁▂▁▁▁█▃▃▂▂▂▁▁▁▆▄▄▂▄▂▁▁
wandb:         val_loss ▁▂▄▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁
wandb:       val_recall ▁▇█▆▆▅▅▆▆▅▇▇▅▅▅▅▆▆▄▅▇▄▄▁▆▆▇▃▆▅▅▆▇▆█▅▅▅▅▅
wandb:    val_precision ▁▂▂▄▄▅▄▅▅▅▂▃▅▅▆▆▃▃▅█▃▅▅▁▂▂▄▅▄▆▅▅▃▄▂▃▅▅▆▅
wandb:           val_f1 ▁▄▃▆▆▇▆▇▇▇▃▄▆▆▇▇▄▅▆█▅▆▆▁▄▄▅▅▆▇▇▇▄▆▂▄▆▆▇▆
wandb:          val_auc ▁▇▆█▇▇▇▇██▇▃▆▆▆▆▆▇▆▇▆▆▆▅▆▇▇▃██▇█▆▇▆▅▇▇▇▆
wandb:               lr ███▄▄▄▄▂▁▁███▄▂▂████▄▂▂███▄▄▄▂▁▁█████▄▂▁
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/alirachidi/classification_algorithm/trainers/main/wandb/offline-run-20210616_020357-1oymnl90


 See logs at ../../new_cache/conv__2223__06_0203__v39__augmented_jobs/logs/