Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
File:  conv.train2023
Description:  2_MoE_512
2021-03-28 22:44:55.460657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-28 22:44:57.550573: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-28 22:44:57.551517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-28 22:44:57.600286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:57.601016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-28 22:44:57.601045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-28 22:44:57.604668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-28 22:44:57.604773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-28 22:44:57.605870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-28 22:44:57.606169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-28 22:44:57.607158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-28 22:44:57.608083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-28 22:44:57.608244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-28 22:44:57.608386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:57.609179: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:57.609855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-28 22:44:57.611979: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-28 22:44:57.612155: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:57.612860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-03-28 22:44:57.612881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-28 22:44:57.612908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-28 22:44:57.612922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-28 22:44:57.612936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-28 22:44:57.612949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-28 22:44:57.612973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-28 22:44:57.612988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-28 22:44:57.613002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-28 22:44:57.613065: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:57.613796: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:57.614469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-28 22:44:57.614507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-28 22:44:58.338207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-28 22:44:58.338274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-28 22:44:58.338284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-28 22:44:58.338568: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:58.339471: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:58.340278: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-28 22:44:58.340969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
2021-03-28 22:44:58.834596: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-28 22:44:58.834651: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-28 22:44:58.834701: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-03-28 22:44:58.834941: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64
2021-03-28 22:44:58.835842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so
2021-03-28 22:44:59.030293: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-03-28 22:44:59.032865: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module located at /main/models/conv/train2023.py
Using train_file located at ../../data/datasets/all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000.pkl
Using logs_path located at ../../cache/conv___03_2243___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___2_MoE_512___2023/logs/
-----------------------
Collecting Variables...
Model Parameters: {'N_CLASSES': 2, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': (128, 1250, 3), 'WEIGHT_DECAY': 0.0001, 'LL2_REG': 0, 'EPSILON': 1e-07, 'LABEL_SMOOTHING': 0}
Learning Rate Parameters: {'factor': 0.5, 'patience': 3, 'min_lr': 1e-05}
Early Stopping Patience and Delta: 8, 1.0%
-----------------------
Size of training set: 13945
Size of validation set: 3486
Initializing weights...
weights = {0: 0.6399045521292217, 1: 1.2145345596432553, 2: 1.1234209847898944, 3: 1.3816582117945466}
Model: "conv2d"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 1250, 3 0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128, 1250, 3) 12          input_1[0][0]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 128, 1250, 16 64          batch_normalization[0][0]        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 128, 1250, 3) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 128, 1250, 16 2320        conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 1250, 16 6416        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 1250, 16 64          max_pooling2d[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128, 1250, 48 0           conv2d_1[0][0]                   
                                                                 conv2d_3[0][0]                   
                                                                 conv2d_4[0][0]                   
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 64, 625, 48)  0           concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64, 625, 48)  192         average_pooling2d[0][0]          
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64, 625, 48)  0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
inverted_residual (InvertedResi (None, 64, 625, 32)  35840       dropout[0][0]                    
__________________________________________________________________________________________________
inverted_residual_1 (InvertedRe (None, 64, 625, 32)  20864       inverted_residual[0][0]          
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 312, 32)  0           inverted_residual_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 312, 32)  128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32, 312, 32)  0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
inverted_residual_2 (InvertedRe (None, 32, 312, 64)  27136       dropout_1[0][0]                  
__________________________________________________________________________________________________
inverted_residual_3 (InvertedRe (None, 32, 312, 64)  66304       inverted_residual_2[0][0]        
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 156, 64)  0           inverted_residual_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 16, 156, 64)  256         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16, 156, 64)  0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
inverted_residual_4 (InvertedRe (None, 16, 156, 128) 91136       dropout_2[0][0]                  
__________________________________________________________________________________________________
inverted_residual_5 (InvertedRe (None, 16, 156, 128) 230912      inverted_residual_4[0][0]        
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 8, 78, 128)   0           inverted_residual_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 8, 78, 128)   512         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 8, 78, 128)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
inverted_residual_6 (InvertedRe (None, 8, 78, 256)   329728      dropout_3[0][0]                  
__________________________________________________________________________________________________
inverted_residual_7 (InvertedRe (None, 8, 78, 256)   855040      inverted_residual_6[0][0]        
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 4, 39, 256)   0           inverted_residual_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 39, 256)   1024        average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 4, 39, 256)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
inverted_residual_8 (InvertedRe (None, 4, 39, 512)   1249280     dropout_4[0][0]                  
__________________________________________________________________________________________________
inverted_residual_9 (InvertedRe (None, 4, 39, 512)   3282944     inverted_residual_8[0][0]        
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           inverted_residual_9[0][0]        2021-03-28 22:45:00.214155: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-28 22:45:00.215997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-03-28 22:45:05.304759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-28 22:45:05.981657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-28 22:45:05.992976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-28 22:45:14.007388: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-03-28 22:45:14.007434: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-03-28 22:45:16.398257: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-03-28 22:45:16.401998: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed
2021-03-28 22:45:16.451436: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 2429 callback api events and 2425 activity events. 
2021-03-28 22:45:16.514778: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.

__________________________________________________________________________________________________
dense_mo_e (DenseMoE)           (None, 512)          526338      global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dense_mo_e_1 (DenseMoE)         (None, 512)          526338      dense_mo_e[0][0]                 
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            1026        dense_mo_e_1[0][0]               
==================================================================================================
Total params: 7,253,938
Trainable params: 7,212,428
Non-trainable params: 41,510
__________________________________________________________________________________________________
Epoch 1/40
872/872 - 1686s - loss: 0.5117 - calc_accuracy: 0.3542 - val_loss: 0.6909 - val_calc_accuracy: 0.3792
Epoch 2/40
872/872 - 1648s - loss: 0.5085 - calc_accuracy: 0.2552 - val_loss: 0.7181 - val_calc_accuracy: 0.2178
Epoch 3/40
872/872 - 1653s - loss: 0.4895 - calc_accuracy: 0.3880 - val_loss: 0.6878 - val_calc_accuracy: 0.3829
Epoch 4/40
872/872 - 1654s - loss: 0.5057 - calc_accuracy: 0.3759 - val_loss: 0.6829 - val_calc_accuracy: 0.3917
Epoch 5/40
872/872 - 1649s - loss: 0.5005 - calc_accuracy: 0.3491 - val_loss: 0.6669 - val_calc_accuracy: 0.3859
Epoch 6/40
872/872 - 1647s - loss: 0.4881 - calc_accuracy: 0.3705 - val_loss: 0.6521 - val_calc_accuracy: 0.4561
Epoch 7/40
872/872 - 1649s - loss: 0.4444 - calc_accuracy: 0.4696 - val_loss: 0.6287 - val_calc_accuracy: 0.4357
Epoch 8/40
872/872 - 1653s - loss: 0.4103 - calc_accuracy: 0.5208 - val_loss: 0.5927 - val_calc_accuracy: 0.5150
Epoch 9/40
872/872 - 1655s - loss: 0.3277 - calc_accuracy: 0.6407 - val_loss: 0.4150 - val_calc_accuracy: 0.6456
Epoch 10/40
872/872 - 1652s - loss: 0.2666 - calc_accuracy: 0.7194 - val_loss: 0.3273 - val_calc_accuracy: 0.7551
Epoch 11/40
872/872 - 1655s - loss: 0.2486 - calc_accuracy: 0.7412 - val_loss: 0.4707 - val_calc_accuracy: 0.5985
Epoch 12/40
872/872 - 1652s - loss: 0.2367 - calc_accuracy: 0.7516 - val_loss: 0.2958 - val_calc_accuracy: 0.7741
Epoch 13/40
872/872 - 1652s - loss: 0.2272 - calc_accuracy: 0.7631 - val_loss: 0.2820 - val_calc_accuracy: 0.7806
Epoch 14/40
872/872 - 1655s - loss: 0.2210 - calc_accuracy: 0.7666 - val_loss: 0.2939 - val_calc_accuracy: 0.7829
Epoch 15/40
872/872 - 1658s - loss: 0.2116 - calc_accuracy: 0.7736 - val_loss: 0.2487 - val_calc_accuracy: 0.8033
Epoch 16/40
872/872 - 1656s - loss: 0.2058 - calc_accuracy: 0.7817 - val_loss: 0.2519 - val_calc_accuracy: 0.8222
Epoch 17/40
872/872 - 1654s - loss: 0.1993 - calc_accuracy: 0.7920 - val_loss: 0.2401 - val_calc_accuracy: 0.8225
Epoch 18/40
872/872 - 1656s - loss: 0.1898 - calc_accuracy: 0.8032 - val_loss: 0.2557 - val_calc_accuracy: 0.8038
Epoch 19/40
872/872 - 1653s - loss: 0.1829 - calc_accuracy: 0.8105 - val_loss: 0.2300 - val_calc_accuracy: 0.8263
Epoch 20/40
872/872 - 1658s - loss: 0.1738 - calc_accuracy: 0.8223 - val_loss: 0.2537 - val_calc_accuracy: 0.8102
Epoch 21/40
872/872 - 1665s - loss: 0.1651 - calc_accuracy: 0.8297 - val_loss: 0.2188 - val_calc_accuracy: 0.8400
Epoch 22/40
872/872 - 1654s - loss: 0.1615 - calc_accuracy: 0.8352 - val_loss: 0.3384 - val_calc_accuracy: 0.7638
Epoch 23/40
872/872 - 1657s - loss: 0.1558 - calc_accuracy: 0.8400 - val_loss: 0.2090 - val_calc_accuracy: 0.8525
Epoch 24/40
872/872 - 1656s - loss: 0.1475 - calc_accuracy: 0.8492 - val_loss: 0.2435 - val_calc_accuracy: 0.8518
Epoch 25/40
872/872 - 1656s - loss: 0.1430 - calc_accuracy: 0.8561 - val_loss: 0.2451 - val_calc_accuracy: 0.8159
Epoch 26/40
872/872 - 1657s - loss: 0.1393 - calc_accuracy: 0.8576 - val_loss: 0.2779 - val_calc_accuracy: 0.8218

Epoch 00026: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 27/40
872/872 - 1656s - loss: 0.1254 - calc_accuracy: 0.8699 - val_loss: 0.1778 - val_calc_accuracy: 0.8752
Epoch 28/40
872/872 - 1655s - loss: 0.1232 - calc_accuracy: 0.8754 - val_loss: 0.1736 - val_calc_accuracy: 0.8769
Epoch 29/40
872/872 - 1656s - loss: 0.1191 - calc_accuracy: 0.8777 - val_loss: 0.1819 - val_calc_accuracy: 0.8750
Epoch 30/40
872/872 - 1653s - loss: 0.1159 - calc_accuracy: 0.8798 - val_loss: 0.1828 - val_calc_accuracy: 0.8792
Epoch 31/40
872/872 - 1655s - loss: 0.1127 - calc_accuracy: 0.8851 - val_loss: 0.1713 - val_calc_accuracy: 0.8838
Epoch 32/40
872/872 - 1656s - loss: 0.1109 - calc_accuracy: 0.8846 - val_loss: 0.1795 - val_calc_accuracy: 0.8766
Epoch 33/40
872/872 - 1655s - loss: 0.1107 - calc_accuracy: 0.8863 - val_loss: 0.1659 - val_calc_accuracy: 0.8834
Epoch 34/40
872/872 - 1657s - loss: 0.1072 - calc_accuracy: 0.8892 - val_loss: 0.1651 - val_calc_accuracy: 0.8849
Epoch 35/40
872/872 - 1658s - loss: 0.1059 - calc_accuracy: 0.8898 - val_loss: 0.1986 - val_calc_accuracy: 0.8779
Epoch 00035: early stopping

 See logs at ../../cache/conv___03_2243___all_sw_coch_preprocessed_v2_param_v26_augm_v0_cleaned_8000___2_MoE_512___2023/logs/