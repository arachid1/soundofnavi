Category:  coch
Dataset:  all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
File:  conv.train2237
Description:  newdata_pneumoniaonly
2021-06-22 16:22:48.664032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /home/alirachidi/classification_algorithm/trainers/main/models/conv/modules/augmentation.py:19: experimental_run_functions_eagerly (from tensorflow.python.eager.def_function) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.run_functions_eagerly` instead of the experimental version.
2021-06-22 16:22:51.484028: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 16:22:51.485020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-22 16:22:51.534276: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:51.535378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 16:22:51.535926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 16:22:51.539635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 16:22:51.539708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 16:22:51.540847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 16:22:51.541138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 16:22:51.542155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 16:22:51.543023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 16:22:51.543185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 16:22:51.543296: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:51.544074: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:51.544805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
Tensorflow Version: 2.4.0
Num GPUs Available:  1
-----------------------
Using module: nv/train2237.py
Using train_file: ../../data/datasets/all_sw_coch_preprocessed_v2_param_v39_augm_v0_cleaned_8000.pkl
Job directory: ../../new_cache/conv__2237__06_1620__v39__newdata_pneumoniaonly
Parameters: {'N_CLASSES': 1, 'SR': 8000, 'BATCH_SIZE': 16, 'LR': 0.001, 'SHAPE': [128, 1250], 'LL2_REG': 0, 'WEIGHT_DECAY': 0.001, 'N_EPOCHS': 65, 'FACTOR': 0.5, 'PATIENCE': 6, 'MIN_LR': 1e-07, 'LABEL_SMOOTHING': 0, 'EPSILON': 1e-07, 'ES_PATIENCE': 20, 'OVERSAMPLE': 0, 'MIN_DELTA': 0, 'PARAM': 'v39', 'EPOCH_START': 1, 'CLAUSE': 0, 'CUBEROOTING': 1, 'NORMALIZING': 1, 'AUGMENTATION': 0, 'TARGET': 1, 'INITIAL_CHANNELS': 1, 'ADAPTIVE_LR': 1, 'CLASS_WEIGHTS': 1, 'SIX': 0, 'CONCAT': 0, 'TESTING': 0}
Augmentation parameters for audio: {'ADD': 1, 'QUANTITY': 300, 'WAV_PATH': 'v42'}
Augmentation parameters for spectrograms: {'ADD': 0, 'QUANTITY': 300, 'TIME_MASKING': 1, 'FREQUENCY_MASKING': 1, 'LOUDNESS': 0}
-----------------------
Collecting Variables...
All variables have been collected.
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.3.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
2021-06-22 16:22:56.772702: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-22 16:22:56.773109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:56.774214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-06-22 16:22:56.774277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 16:22:56.774358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 16:22:56.774398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-22 16:22:56.774433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-22 16:22:56.774465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-22 16:22:56.774501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-22 16:22:56.774532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-22 16:22:56.774562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 16:22:56.774696: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:56.775813: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:56.776975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-22 16:22:56.777042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-22 16:22:57.593053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-22 16:22:57.593105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-06-22 16:22:57.593116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-06-22 16:22:57.593399: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:57.594244: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:57.595027: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-06-22 16:22:57.595748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13968 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)
Pneumonia patients: 148, Non-pneumonia patients: 2873
Pneumonia patients: 51, Non-pneumonia patients: 0
-----------------------
Number of train recordings: 2457 with pneumonia: 157 and non-pneumonia: 2300
Number of val recordings: 615 with pneumonia: 42 and non-pneumonia: 573
-----------------------
Initializing weights...
weights = {0: 0.5257570483814827, 1: 10.20608108108108}
Model: "conv2d"
______________________________________________________________________________________________________________
Layer (type)                        Output Shape            Param #      Connected to                         
==============================================================================================================
input_1 (InputLayer)                [(None, 128, 1250, 1)]  0                                                 
______________________________________________________________________________________________________________
batch_normalization (BatchNormaliza (None, 128, 1250, 1)    4            input_1[0][0]                        
______________________________________________________________________________________________________________
conv2d (Conv2D)                     (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_2 (Conv2D)                   (None, 128, 1250, 16)   32           batch_normalization[0][0]            
______________________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)        (None, 128, 1250, 1)    0            batch_normalization[0][0]            
______________________________________________________________________________________________________________
conv2d_1 (Conv2D)                   (None, 128, 1250, 16)   2320         conv2d[0][0]                         
______________________________________________________________________________________________________________
conv2d_3 (Conv2D)                   (None, 128, 1250, 16)   6416         conv2d_2[0][0]                       
______________________________________________________________________________________________________________
conv2d_4 (Conv2D)                   (None, 128, 1250, 16)   32           max_pooling2d[0][0]                  
______________________________________________________________________________________________________________
concatenate (Concatenate)           (None, 128, 1250, 48)   0            conv2d_1[0][0]                       
                                                                         conv2d_3[0][0]                       
                                                                         conv2d_4[0][0]                       
______________________________________________________________________________________________________________
average_pooling2d (AveragePooling2D (None, 64, 625, 48)     0            concatenate[0][0]                    
______________________________________________________________________________________________________________
batch_normalization_1 (BatchNormali (None, 64, 625, 48)     192          average_pooling2d[0][0]              
______________________________________________________________________________________________________________
dropout (Dropout)                   (None, 64, 625, 48)     0            batch_normalization_1[0][0]          
______________________________________________________________________________________________________________
inverted_residual (InvertedResidual (None, 64, 625, 32)     35840        dropout[0][0]                        
______________________________________________________________________________________________________________
inverted_residual_1 (InvertedResidu (None, 64, 625, 32)     20864        inverted_residual[0][0]              
______________________________________________________________________________________________________________
average_pooling2d_1 (AveragePooling (None, 32, 312, 32)     0            inverted_residual_1[0][0]            
______________________________________________________________________________________________________________
batch_normalization_2 (BatchNormali (None, 32, 312, 32)     128          average_pooling2d_1[0][0]            
______________________________________________________________________________________________________________
dropout_1 (Dropout)                 (None, 32, 312, 32)     0            batch_normalization_2[0][0]          
______________________________________________________________________________________________________________
inverted_residual_2 (InvertedResidu (None, 32, 312, 64)     27136        dropout_1[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_3 (InvertedResidu (None, 32, 312, 64)     66304        inverted_residual_2[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_2 (AveragePooling (None, 16, 156, 64)     0            inverted_residual_3[0][0]            
______________________________________________________________________________________________________________
batch_normalization_3 (BatchNormali (None, 16, 156, 64)     256          average_pooling2d_2[0][0]            
______________________________________________________________________________________________________________
dropout_2 (Dropout)                 (None, 16, 156, 64)     0            batch_normalization_3[0][0]          
______________________________________________________________________________________________________________
inverted_residual_4 (InvertedResidu (None, 16, 156, 128)    91136        dropout_2[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_5 (InvertedResidu (None, 16, 156, 128)    230912       inverted_residual_4[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_3 (AveragePooling (None, 8, 78, 128)      0            inverted_residual_5[0][0]            
______________________________________________________________________________________________________________
batch_normalization_4 (BatchNormali (None, 8, 78, 128)      512          average_pooling2d_3[0][0]            
______________________________________________________________________________________________________________
dropout_3 (Dropout)                 (None, 8, 78, 128)      0            batch_normalization_4[0][0]          
______________________________________________________________________________________________________________
inverted_residual_6 (InvertedResidu (None, 8, 78, 256)      329728       dropout_3[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_7 (InvertedResidu (None, 8, 78, 256)      855040       inverted_residual_6[0][0]            
______________________________________________________________________________________________________________
average_pooling2d_4 (AveragePooling (None, 4, 39, 256)      0            inverted_residual_7[0][0]            
______________________________________________________________________________________________________________
batch_normalization_5 (BatchNormali (None, 4, 39, 256)      1024         average_pooling2d_4[0][0]            
______________________________________________________________________________________________________________
dropout_4 (Dropout)                 (None, 4, 39, 256)      0            batch_normalization_5[0][0]          
______________________________________________________________________________________________________________
inverted_residual_8 (InvertedResidu (None, 4, 39, 512)      1249280      dropout_4[0][0]                      
______________________________________________________________________________________________________________
inverted_residual_9 (InvertedResidu (None, 4, 39, 512)      3282944      inverted_residual_8[0][0]            
______________________________________________________________________________________________________________
global_average_pooling2d (GlobalAve (None, 512)             0            inverted_residual_9[0][0]            
______________________________________________________________________________________________________________
dense (Dense)                       (None, 1)               513          global_average_pooling2d[0][0]       
==============================================================================================================
Total params: 6,200,645
Trainable params: 6,159,139
Non-trainable params: 41,506
______________________________________________________________________________________________________________
2021-06-22 16:22:59.103670: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
2021-06-22 16:22:59.105392: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2299995000 Hz
2021-06-22 16:22:59.519185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-22 16:23:01.630834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-22 16:23:02.140317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/65
154/154 - 242s - loss: 0.9779 - accuracy: 0.6451 - val_loss: 0.2683 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.09401044973084516
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 1 epochs
Epoch 2/65
154/154 - 235s - loss: 0.5201 - accuracy: 0.7477 - val_loss: 0.2684 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.2331919954928693
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 2 epochs
Epoch 3/65
154/154 - 237s - loss: 0.3988 - accuracy: 0.7831 - val_loss: 0.2575 - val_accuracy: 0.9317
Confusion matrix: 
 [[573   0]
 [ 42   0]]
Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]]
Validation f1: 0.00
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Validation accuracy: 93.17
Validation recall: 0.00
Validation precision: 0.00
Validation AUC: 0.22561277718986728
Validation class accuracies: [1.0, 0.0]
The validation tracker metric at 0 hasn't increased by 0 in 3 epochs
Epoch 4/65
154/154 - 236s - loss: 0.4341 - accuracy: 0.7941 - val_loss: 0.1985 - val_accuracy: 0.9480
Confusion matrix: 
 [[572   1]
 [ 31  11]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.998 0.002]
 [0.738 0.262]]
Validation f1: 40.74
Validation accuracy: 94.80
Validation recall: 26.19
Validation precision: 91.67
Validation AUC: 0.543057856182245
Validation class accuracies: [0.9982547993019197, 0.2619047619047619]
Saving model...
Epoch 5/65
154/154 - 235s - loss: 0.3605 - accuracy: 0.8242 - val_loss: 0.3944 - val_accuracy: 0.8114
Confusion matrix: 
 [[467 106]
 [ 10  32]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.815 0.185]
 [0.238 0.762]]
Validation f1: 35.56
Validation accuracy: 81.14
Validation recall: 76.19
Validation precision: 23.19
Validation AUC: 0.5977557144907206
Validation class accuracies: [0.8150087260034904, 0.7619047619047619]
The validation tracker metric at 0.4074074074074074 hasn't increased by 0 in 1 epochs
Epoch 6/65
154/154 - 235s - loss: 0.3229 - accuracy: 0.8270 - val_loss: 0.2808 - val_accuracy: 0.8732
Confusion matrix: 
 [[506  67]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.883 0.117]
 [0.262 0.738]]
Validation f1: 44.29
Validation accuracy: 87.32
Validation recall: 73.81
Validation precision: 31.63
Validation AUC: 0.6671042561093231
Validation class accuracies: [0.8830715532286213, 0.7380952380952381]
Saving model...
Epoch 7/65
154/154 - 235s - loss: 0.3304 - accuracy: 0.8547 - val_loss: 0.8218 - val_accuracy: 0.7252
Confusion matrix: 
 [[407 166]
 [  3  39]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.71  0.29 ]
 [0.071 0.929]]
Validation f1: 31.58
Validation accuracy: 72.52
Validation recall: 92.86
Validation precision: 19.02
Validation AUC: 0.489139855953886
Validation class accuracies: [0.7102966841186736, 0.9285714285714286]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 1 epochs
Epoch 8/65
154/154 - 235s - loss: 0.2734 - accuracy: 0.8681 - val_loss: 2.4532 - val_accuracy: 0.2911
Confusion matrix: 
 [[137 436]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.239 0.761]
 [0.    1.   ]]
Validation f1: 16.15
Validation accuracy: 29.11
Validation recall: 100.00
Validation precision: 8.79
Validation AUC: 0.2964916250542911
Validation class accuracies: [0.23909249563699825, 1.0]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 2 epochs
Epoch 9/65
154/154 - 235s - loss: 0.2645 - accuracy: 0.8726 - val_loss: 1.4771 - val_accuracy: 0.5886
Confusion matrix: 
 [[322 251]
 [  2  40]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.562 0.438]
 [0.048 0.952]]
Validation f1: 24.02
Validation accuracy: 58.86
Validation recall: 95.24
Validation precision: 13.75
Validation AUC: 0.443826868498465
Validation class accuracies: [0.5619546247818499, 0.9523809523809523]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 3 epochs
Epoch 10/65
154/154 - 235s - loss: 0.2490 - accuracy: 0.8893 - val_loss: 0.8658 - val_accuracy: 0.5984
Confusion matrix: 
 [[330 243]
 [  4  38]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.576 0.424]
 [0.095 0.905]]
Validation f1: 23.53
Validation accuracy: 59.84
Validation recall: 90.48
Validation precision: 13.52
Validation AUC: 0.28231144222348703
Validation class accuracies: [0.5759162303664922, 0.9047619047619048]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 4 epochs
Epoch 11/65
154/154 - 235s - loss: 0.2189 - accuracy: 0.8840 - val_loss: 0.4230 - val_accuracy: 0.8455
Confusion matrix: 
 [[489  84]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.853 0.147]
 [0.262 0.738]]
Validation f1: 39.49
Validation accuracy: 84.55
Validation recall: 73.81
Validation precision: 26.96
Validation AUC: 0.5467956574074657
Validation class accuracies: [0.8534031413612565, 0.7380952380952381]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 5 epochs
Epoch 12/65
154/154 - 235s - loss: 0.1801 - accuracy: 0.9276 - val_loss: 6.7000 - val_accuracy: 0.2358
Confusion matrix: 
 [[103 470]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.18 0.82]
 [0.   1.  ]]
Validation f1: 15.16
Validation accuracy: 23.58
Validation recall: 100.00
Validation precision: 8.20
Validation AUC: 0.5335473483212644
Validation class accuracies: [0.17975567190226877, 1.0]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0005000000237487257
Epoch 13/65
154/154 - 235s - loss: 0.1272 - accuracy: 0.9341 - val_loss: 3.4523 - val_accuracy: 0.3545
Confusion matrix: 
 [[177 396]
 [  1  41]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.309 0.691]
 [0.024 0.976]]
Validation f1: 17.12
Validation accuracy: 35.45
Validation recall: 97.62
Validation precision: 9.38
Validation AUC: 0.4170481627370191
Validation class accuracies: [0.3089005235602094, 0.9761904761904762]
The validation tracker metric at 0.4428571428571429 hasn't increased by 0 in 7 epochs
Epoch 14/65
154/154 - 235s - loss: 0.1212 - accuracy: 0.9520 - val_loss: 0.3027 - val_accuracy: 0.9122
Confusion matrix: 
 [[534  39]
 [ 15  27]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.932 0.068]
 [0.357 0.643]]
Validation f1: 50.00
Validation accuracy: 91.22
Validation recall: 64.29
Validation precision: 40.91
Validation AUC: 0.5761857624910809
Validation class accuracies: [0.9319371727748691, 0.6428571428571429]
Saving model...
Epoch 15/65
154/154 - 235s - loss: 0.1196 - accuracy: 0.9463 - val_loss: 0.7694 - val_accuracy: 0.8098
Confusion matrix: 
 [[465 108]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.812 0.188]
 [0.214 0.786]]
Validation f1: 36.07
Validation accuracy: 80.98
Validation recall: 78.57
Validation precision: 23.40
Validation AUC: 0.49980778974552525
Validation class accuracies: [0.8115183246073299, 0.7857142857142857]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 1 epochs
Epoch 16/65
154/154 - 235s - loss: 0.1531 - accuracy: 0.9353 - val_loss: 2.2129 - val_accuracy: 0.3984
Confusion matrix: 
 [[203 370]
 [  0  42]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.354 0.646]
 [0.    1.   ]]
Validation f1: 18.50
Validation accuracy: 39.84
Validation recall: 100.00
Validation precision: 10.19
Validation AUC: 0.1924022961045901
Validation class accuracies: [0.3542757417102967, 1.0]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 2 epochs
Epoch 17/65
154/154 - 235s - loss: 0.1377 - accuracy: 0.9312 - val_loss: 0.3228 - val_accuracy: 0.8537
Confusion matrix: 
 [[488  85]
 [  5  37]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.852 0.148]
 [0.119 0.881]]
Validation f1: 45.12
Validation accuracy: 85.37
Validation recall: 88.10
Validation precision: 30.33
Validation AUC: 0.48786527880003505
Validation class accuracies: [0.8516579406631762, 0.8809523809523809]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 3 epochs
Epoch 18/65
154/154 - 235s - loss: 0.0824 - accuracy: 0.9597 - val_loss: 0.3790 - val_accuracy: 0.8862
Confusion matrix: 
 [[514  59]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.897 0.103]
 [0.262 0.738]]
Validation f1: 46.97
Validation accuracy: 88.62
Validation recall: 73.81
Validation precision: 34.44
Validation AUC: 0.5430924353978103
Validation class accuracies: [0.8970331588132635, 0.7380952380952381]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 4 epochs
Epoch 19/65
154/154 - 234s - loss: 0.0716 - accuracy: 0.9707 - val_loss: 0.3881 - val_accuracy: 0.8602
Confusion matrix: 
 [[500  73]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.873 0.127]
 [0.31  0.69 ]]
Validation f1: 40.28
Validation accuracy: 86.02
Validation recall: 69.05
Validation precision: 28.43
Validation AUC: 0.4689206943339469
Validation class accuracies: [0.8726003490401396, 0.6904761904761905]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 5 epochs
Epoch 20/65
154/154 - 235s - loss: 0.0602 - accuracy: 0.9691 - val_loss: 0.4908 - val_accuracy: 0.8780
Confusion matrix: 
 [[507  66]
 [  9  33]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.214 0.786]]
Validation f1: 46.81
Validation accuracy: 87.80
Validation recall: 78.57
Validation precision: 33.33
Validation AUC: 0.6079137561775572
Validation class accuracies: [0.8848167539267016, 0.7857142857142857]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0002500000118743628
Epoch 21/65
154/154 - 235s - loss: 0.0484 - accuracy: 0.9801 - val_loss: 0.4968 - val_accuracy: 0.8748
Confusion matrix: 
 [[509  64]
 [ 13  29]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.888 0.112]
 [0.31  0.69 ]]
Validation f1: 42.96
Validation accuracy: 87.48
Validation recall: 69.05
Validation precision: 31.18
Validation AUC: 0.5308908239777216
Validation class accuracies: [0.8883071553228621, 0.6904761904761905]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 7 epochs
Epoch 22/65
154/154 - 235s - loss: 0.0364 - accuracy: 0.9866 - val_loss: 0.5704 - val_accuracy: 0.8504
Confusion matrix: 
 [[492  81]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.859 0.141]
 [0.262 0.738]]
Validation f1: 40.26
Validation accuracy: 85.04
Validation recall: 73.81
Validation precision: 27.68
Validation AUC: 0.512612245416425
Validation class accuracies: [0.8586387434554974, 0.7380952380952381]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 8 epochs
Epoch 23/65
154/154 - 235s - loss: 0.0359 - accuracy: 0.9853 - val_loss: 0.3591 - val_accuracy: 0.8927
Confusion matrix: 
 [[523  50]
 [ 16  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.913 0.087]
 [0.381 0.619]]
Validation f1: 44.07
Validation accuracy: 89.27
Validation recall: 61.90
Validation precision: 34.21
Validation AUC: 0.5824997115324961
Validation class accuracies: [0.912739965095986, 0.6190476190476191]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 9 epochs
Epoch 24/65
154/154 - 235s - loss: 0.0324 - accuracy: 0.9890 - val_loss: 0.6471 - val_accuracy: 0.8667
Confusion matrix: 
 [[499  74]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.871 0.129]
 [0.19  0.81 ]]
Validation f1: 45.33
Validation accuracy: 86.67
Validation recall: 80.95
Validation precision: 31.48
Validation AUC: 0.5722712676190783
Validation class accuracies: [0.8708551483420593, 0.8095238095238095]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 10 epochs
Epoch 25/65
154/154 - 235s - loss: 0.0388 - accuracy: 0.9841 - val_loss: 0.5488 - val_accuracy: 0.8764
Confusion matrix: 
 [[505  68]
 [  8  34]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.881 0.119]
 [0.19  0.81 ]]
Validation f1: 47.22
Validation accuracy: 87.64
Validation recall: 80.95
Validation precision: 33.33
Validation AUC: 0.6151859203532392
Validation class accuracies: [0.881326352530541, 0.8095238095238095]
The validation tracker metric at 0.5000000000000001 hasn't increased by 0 in 11 epochs
Epoch 26/65
154/154 - 235s - loss: 0.0282 - accuracy: 0.9910 - val_loss: 0.2789 - val_accuracy: 0.9171
Confusion matrix: 
 [[533  40]
 [ 11  31]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:3504: UserWarning: Even though the tf.config.experimental_run_functions_eagerly option is set, this option does not apply to tf.data functions. tf.data functions are still traced and executed as graphs.
  "Even though the tf.config.experimental_run_functions_eagerly "
Normalized Confusion matrix: 
 [[0.93  0.07 ]
 [0.262 0.738]]
Validation f1: 54.87
Validation accuracy: 91.71
Validation recall: 73.81
Validation precision: 43.66
Validation AUC: 0.5991619422755847
Validation class accuracies: [0.9301919720767888, 0.7380952380952381]
local_gc_exec.sh: line 6:   537 Killed                  python -m models.$MODULE_NAME --train-file $LOCAL_TRAIN_FILE --job-dir $LOCAL_JOB_DIR --params "$PARAMS" --wav-params "$WAV_PARAMS" --spec-params "$SPEC_PARAMS"

 See logs at ../../new_cache/conv__2237__06_1620__v39__newdata_pneumoniaonly/logs//home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/multiprocessing/semaphore_tracker.py:144: UserWarning: semaphore_tracker: There appear to be 6 leaked semaphores to clean up at shutdown
  len(cache))
