Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train96
Description: model9
-----------------------
Job id is 1.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
0
0
0
0
-----------------------
--- Final training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Final Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
Model: "leaf_resnet_bis"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 mel_filterbanks (MelFilterbanks)                multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 leaf (Leaf)                                     multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   21893442         
                                                                                                              
==============================================================================================================
Total params: 21,894,322
Trainable params: 21,877,298
Non-trainable params: 17,024
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
128/128 - 181s - loss: 0.8082 - accuracy: 0.7583 - 181s/epoch - 1s/step
Epoch 2/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
128/128 - 170s - loss: 0.6618 - accuracy: 0.8574 - 170s/epoch - 1s/step
Epoch 3/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
128/128 - 171s - loss: 0.6571 - accuracy: 0.8603 - 171s/epoch - 1s/step
Epoch 4/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
128/128 - 171s - loss: 0.6541 - accuracy: 0.8603 - 171s/epoch - 1s/step
Epoch 5/60
Validation cm: [[  0 172   0   0]
 [  1  69   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0.    1.    0.    0.   ]
 [0.014 0.986 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.23076923076923078
Validation class_accuracies: [0.0, 0.9857142857142858, 0.0, 0.0]
Validation sensitivity: 0.5433070866141733
Validation specificity: 0.0
Validation icbhi_score: 0.27165354330708663
Validation roc_auc: None
Validation avg_accuracy: 0.24642857142857144
Validation one_indexed_epoch: 5
128/128 - 171s - loss: 0.6532 - accuracy: 0.8603 - 171s/epoch - 1s/step
Epoch 6/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
128/128 - 168s - loss: 0.6547 - accuracy: 0.8603 - 168s/epoch - 1s/step
Epoch 7/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 7
128/128 - 167s - loss: 0.6519 - accuracy: 0.8603 - 167s/epoch - 1s/step
Epoch 8/60
Validation cm: [[  0 172   0   0]
 [  2  68   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0.    1.    0.    0.   ]
 [0.029 0.971 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.22742474916387959
Validation class_accuracies: [0.0, 0.9714285714285714, 0.0, 0.0]
Validation sensitivity: 0.5354330708661418
Validation specificity: 0.0
Validation icbhi_score: 0.2677165354330709
Validation roc_auc: None
Validation avg_accuracy: 0.24285714285714285
Validation one_indexed_epoch: 8
128/128 - 167s - loss: 0.6513 - accuracy: 0.8603 - 167s/epoch - 1s/step
Epoch 9/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 9
128/128 - 169s - loss: 0.6525 - accuracy: 0.8603 - 169s/epoch - 1s/step
Epoch 10/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 10
128/128 - 169s - loss: 0.6529 - accuracy: 0.8603 - 169s/epoch - 1s/step
Epoch 11/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 11
128/128 - 169s - loss: 0.6521 - accuracy: 0.8603 - 169s/epoch - 1s/step
Epoch 12/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 12
128/128 - 171s - loss: 0.6525 - accuracy: 0.8603 - 171s/epoch - 1s/step
Epoch 13/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 13
128/128 - 171s - loss: 0.6524 - accuracy: 0.8603 - 171s/epoch - 1s/step
Epoch 14/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 14
128/128 - 171s - loss: 0.6517 - accuracy: 0.8603 - 171s/epoch - 1s/step
Epoch 15/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 15
128/128 - 169s - loss: 0.6518 - accuracy: 0.8603 - 169s/epoch - 1s/step
Epoch 16/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 16
128/128 - 168s - loss: 0.6523 - accuracy: 0.8603 - 168s/epoch - 1s/step
Epoch 17/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 17
128/128 - 167s - loss: 0.6516 - accuracy: 0.8603 - 167s/epoch - 1s/step
Epoch 18/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 18
128/128 - 168s - loss: 0.6516 - accuracy: 0.8603 - 168s/epoch - 1s/step
Epoch 19/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 19
128/128 - 169s - loss: 0.6514 - accuracy: 0.8603 - 169s/epoch - 1s/step
Epoch 20/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 20
128/128 - 168s - loss: 0.6510 - accuracy: 0.8603 - 168s/epoch - 1s/step
Epoch 21/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 21
128/128 - 172s - loss: 0.6505 - accuracy: 0.8603 - 172s/epoch - 1s/step
Epoch 22/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 22
128/128 - 172s - loss: 0.6514 - accuracy: 0.8603 - 172s/epoch - 1s/step
Epoch 23/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 23
128/128 - 172s - loss: 0.6516 - accuracy: 0.8603 - 172s/epoch - 1s/step
Epoch 24/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 24
128/128 - 170s - loss: 0.6520 - accuracy: 0.8603 - 170s/epoch - 1s/step
Epoch 25/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 25
128/128 - 170s - loss: 0.6522 - accuracy: 0.8603 - 170s/epoch - 1s/step
Epoch 26/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.5511811023622047
Validation specificity: 0.0
Validation icbhi_score: 0.2755905511811024
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 26
128/128 - 170s - loss: 0.6516 - accuracy: 0.8603 - 170s/epoch - 1s/step
Epoch 27/60
