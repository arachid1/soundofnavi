Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train41
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 546s - loss: 0.4499 - accuracy: 0.5781 - 546s/epoch - 2s/step
Validation cm: [[726   1  11   2]
 [ 80   0  11   1]
 [ 58   1  15   3]
 [ 48   0  79   3]]
Validation normalized_cm: [[0.981 0.001 0.015 0.003]
 [0.87  0.    0.12  0.011]
 [0.753 0.013 0.195 0.039]
 [0.369 0.    0.608 0.023]]
Validation acc: 0.7160731472569779
Validation class_accuracies: [0.981081081081081, 0.0, 0.19480519480519481, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2997407997407997
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 530s - loss: 0.3433 - accuracy: 0.6233 - 530s/epoch - 2s/step
Validation cm: [[644  75  14   7]
 [ 36  34  20   2]
 [ 49   2  23   3]
 [ 25   5  84  16]]
Validation normalized_cm: [[0.87  0.101 0.019 0.009]
 [0.391 0.37  0.217 0.022]
 [0.636 0.026 0.299 0.039]
 [0.192 0.038 0.646 0.123]]
Validation acc: 0.6900866217516843
Validation class_accuracies: [0.8702702702702703, 0.3695652173913043, 0.2987012987012987, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41540342735994906
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 543s - loss: 0.3028 - accuracy: 0.6538 - 543s/epoch - 2s/step
Validation cm: [[651  16  61  12]
 [ 57  12  16   7]
 [ 24   0  48   5]
 [ 17   1 100  12]]
Validation normalized_cm: [[0.88  0.022 0.082 0.016]
 [0.62  0.13  0.174 0.076]
 [0.312 0.    0.623 0.065]
 [0.131 0.008 0.769 0.092]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.8797297297297297, 0.13043478260869565, 0.6233766233766234, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43146220700568527
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 530s - loss: 0.2722 - accuracy: 0.6626 - 530s/epoch - 2s/step
Validation cm: [[656  43  28  13]
 [ 45  25  18   4]
 [ 34   1  38   4]
 [ 27   5  85  13]]
Validation normalized_cm: [[0.886 0.058 0.038 0.018]
 [0.489 0.272 0.196 0.043]
 [0.442 0.013 0.494 0.052]
 [0.208 0.038 0.654 0.1  ]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.8864864864864865, 0.2717391304347826, 0.4935064935064935, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43793302760694064
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 540s - loss: 0.2399 - accuracy: 0.6605 - 540s/epoch - 2s/step
Validation cm: [[656  32  20  32]
 [ 46  22  15   9]
 [ 35   1  32   9]
 [ 33   1  69  27]]
Validation normalized_cm: [[0.886 0.043 0.027 0.043]
 [0.5   0.239 0.163 0.098]
 [0.455 0.013 0.416 0.117]
 [0.254 0.008 0.531 0.208]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.8864864864864865, 0.2391304347826087, 0.4155844155844156, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43722341113645463
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.43793302760694064 hasn't increased by 0 in 1 epochs
330/330 - 529s - loss: 0.2097 - accuracy: 0.6582 - 529s/epoch - 2s/step
Validation cm: [[539 170  16  15]
 [ 19  51   5  17]
 [ 19  11  21  26]
 [ 10  31  15  74]]
Validation normalized_cm: [[0.728 0.23  0.022 0.02 ]
 [0.207 0.554 0.054 0.185]
 [0.247 0.143 0.273 0.338]
 [0.077 0.238 0.115 0.569]]
Validation acc: 0.6592877767083735
Validation class_accuracies: [0.7283783783783784, 0.5543478260869565, 0.2727272727272727, 0.5692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5311710616058443
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 526s - loss: 0.1769 - accuracy: 0.6629 - 526s/epoch - 2s/step
Validation cm: [[552  70  73  45]
 [ 22  31  18  21]
 [ 20   1  38  18]
 [ 10  11  71  38]]
Validation normalized_cm: [[0.746 0.095 0.099 0.061]
 [0.239 0.337 0.196 0.228]
 [0.26  0.013 0.494 0.234]
 [0.077 0.085 0.546 0.292]]
Validation acc: 0.6342637151106834
Validation class_accuracies: [0.745945945945946, 0.33695652173913043, 0.4935064935064935, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4671791633748156
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5311710616058443 hasn't increased by 0 in 1 epochs
330/330 - 529s - loss: 0.1545 - accuracy: 0.6838 - 529s/epoch - 2s/step
Validation cm: [[552 105  56  27]
 [ 24  36  16  16]
 [ 17   8  36  16]
 [ 10  20  45  55]]
Validation normalized_cm: [[0.746 0.142 0.076 0.036]
 [0.261 0.391 0.174 0.174]
 [0.221 0.104 0.468 0.208]
 [0.077 0.154 0.346 0.423]]
Validation acc: 0.6535129932627527
Validation class_accuracies: [0.745945945945946, 0.391304347826087, 0.4675324675324675, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5069649210953558
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5311710616058443 hasn't increased by 0 in 2 epochs
330/330 - 536s - loss: 0.1237 - accuracy: 0.6899 - 536s/epoch - 2s/step
Validation cm: [[610  80  30  20]
 [ 34  40  13   5]
 [ 26   4  31  16]
 [ 15  16  67  32]]
Validation normalized_cm: [[0.824 0.108 0.041 0.027]
 [0.37  0.435 0.141 0.054]
 [0.338 0.052 0.403 0.208]
 [0.115 0.123 0.515 0.246]]
Validation acc: 0.6862367661212705
Validation class_accuracies: [0.8243243243243243, 0.43478260869565216, 0.4025974025974026, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4769645454428063
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5311710616058443 hasn't increased by 0 in 3 epochs
330/330 - 555s - loss: 0.1086 - accuracy: 0.6650 - 555s/epoch - 2s/step
Validation cm: [[648  60  26   6]
 [ 47  30  12   3]
 [ 28   4  38   7]
 [ 20  12  75  23]]
Validation normalized_cm: [[0.876 0.081 0.035 0.008]
 [0.511 0.326 0.13  0.033]
 [0.364 0.052 0.494 0.091]
 [0.154 0.092 0.577 0.177]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.8756756756756757, 0.32608695652173914, 0.4935064935064935, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4680480506567463
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.5311710616058443 hasn't increased by 0 in 4 epochs
330/330 - 551s - loss: 0.0838 - accuracy: 0.6810 - 551s/epoch - 2s/step
Validation cm: [[545 120  37  38]
 [ 20  42  16  14]
 [ 27   6  24  20]
 [ 10  12  51  57]]
Validation normalized_cm: [[0.736 0.162 0.05  0.051]
 [0.217 0.457 0.174 0.152]
 [0.351 0.078 0.312 0.26 ]
 [0.077 0.092 0.392 0.438]]
Validation acc: 0.6429258902791145
Validation class_accuracies: [0.7364864864864865, 0.45652173913043476, 0.3116883116883117, 0.43846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4857895189416928
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5311710616058443 hasn't increased by 0 in 5 epochs
330/330 - 546s - loss: 0.0815 - accuracy: 0.6643 - 546s/epoch - 2s/step
Validation cm: [[593  95  35  17]
 [ 29  36  17  10]
 [ 30   3  33  11]
 [ 14  19  52  45]]
Validation normalized_cm: [[0.801 0.128 0.047 0.023]
 [0.315 0.391 0.185 0.109]
 [0.39  0.039 0.429 0.143]
 [0.108 0.146 0.4   0.346]]
Validation acc: 0.6804619826756496
Validation class_accuracies: [0.8013513513513514, 0.391304347826087, 0.42857142857142855, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49184524347567826
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 551s - loss: 0.0657 - accuracy: 0.6608 - 551s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5311710616058443
Best cm: [[539 170  16  15]
 [ 19  51   5  17]
 [ 19  11  21  26]
 [ 10  31  15  74]]
Best normalized_cm: [[0.728 0.23  0.022 0.02 ]
 [0.207 0.554 0.054 0.185]
 [0.247 0.143 0.273 0.338]
 [0.077 0.238 0.115 0.569]]
Best acc: 0.6592877767083735
Best class_accuracies: [0.7283783783783784, 0.5543478260869565, 0.2727272727272727, 0.5692307692307692]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 7
Validation cm: [[  0   0 740   0]
 [  0   0  92   0]
 [  0   0  77   0]
 [  0   0 130   0]]
Validation normalized_cm: [[0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]]
Validation acc: 0.0741097208854668
Validation class_accuracies: [0.0, 0.0, 1.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization_5 (BatchNormalization)      multiple                                    4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_1 (Dense)                                 multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 1.]]
-- New best results were achieved. --
Saving model...
330/330 - 914s - accuracy: 0.6060 - student_loss: 0.4432 - distillation_loss: -9.5436e-03 - val_accuracy: 0.0741 - val_student_loss: 1.0802 - 914s/epoch - 3s/step
Validation cm: [[553 141  38   8]
 [ 24  45  11  12]
 [ 38   4  30   5]
 [ 10  19  72  29]]
Validation normalized_cm: [[0.747 0.191 0.051 0.011]
 [0.261 0.489 0.12  0.13 ]
 [0.494 0.052 0.39  0.065]
 [0.077 0.146 0.554 0.223]]
Validation acc: 0.6323387872954764
Validation class_accuracies: [0.7472972972972973, 0.4891304347826087, 0.38961038961038963, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46227876119180467
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 896s - accuracy: 0.6273 - student_loss: 0.2073 - distillation_loss: -4.1639e-03 - val_accuracy: 0.5014 - val_student_loss: 1.6021 - 896s/epoch - 3s/step
Validation cm: [[632  99   4   5]
 [ 42  46   2   2]
 [ 64   5   6   2]
 [ 70  21  29  10]]
Validation normalized_cm: [[0.854 0.134 0.005 0.007]
 [0.457 0.5   0.022 0.022]
 [0.831 0.065 0.078 0.026]
 [0.538 0.162 0.223 0.077]]
Validation acc: 0.6679499518768046
Validation class_accuracies: [0.8540540540540541, 0.5, 0.07792207792207792, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37722480222480226
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
The validation tracker metric at 0.46227876119180467 hasn't increased by 0 in 1 epochs
330/330 - 893s - accuracy: 0.6013 - student_loss: 0.9617 - distillation_loss: -4.7738e-03 - val_accuracy: 0.4533 - val_student_loss: 0.1445 - 893s/epoch - 3s/step
Validation cm: [[551 111  60  18]
 [ 28  41   5  18]
 [ 28   3  24  22]
 [  7   7  22  94]]
Validation normalized_cm: [[0.745 0.15  0.081 0.024]
 [0.304 0.446 0.054 0.196]
 [0.364 0.039 0.312 0.286]
 [0.054 0.054 0.169 0.723]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.7445945945945946, 0.44565217391304346, 0.3116883116883117, 0.7230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5562530008182183
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 892s - accuracy: 0.6322 - student_loss: 0.4807 - distillation_loss: -2.6428e-03 - val_accuracy: 0.4033 - val_student_loss: 0.9093 - 892s/epoch - 3s/step
Validation cm: [[488   7 213  32]
 [ 49   5  24  14]
 [ 41   0  29   7]
 [ 21   0  70  39]]
Validation normalized_cm: [[0.659 0.009 0.288 0.043]
 [0.533 0.054 0.261 0.152]
 [0.532 0.    0.377 0.091]
 [0.162 0.    0.538 0.3  ]]
Validation acc: 0.5399422521655438
Validation class_accuracies: [0.6594594594594595, 0.05434782608695652, 0.37662337662337664, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3476076655424482
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 1.]]
The validation tracker metric at 0.5562530008182183 hasn't increased by 0 in 1 epochs
330/330 - 891s - accuracy: 0.6013 - student_loss: 0.2086 - distillation_loss: -1.0146e-03 - val_accuracy: 0.1935 - val_student_loss: 0.4682 - 891s/epoch - 3s/step
Validation cm: [[719   1  14   6]
 [ 70   1  11  10]
 [ 64   0  12   1]
 [ 48   0  82   0]]
Validation normalized_cm: [[0.972 0.001 0.019 0.008]
 [0.761 0.011 0.12  0.109]
 [0.831 0.    0.156 0.013]
 [0.369 0.    0.631 0.   ]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.9716216216216216, 0.010869565217391304, 0.15584415584415584, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2845838356707922
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.5562530008182183 hasn't increased by 0 in 2 epochs
330/330 - 877s - accuracy: 0.6119 - student_loss: 0.1611 - distillation_loss: -3.7273e-03 - val_accuracy: 0.2810 - val_student_loss: 0.6386 - 877s/epoch - 3s/step
Validation cm: [[357 157 128  98]
 [ 15  36  13  28]
 [ 13   3  14  47]
 [  0   5  44  81]]
Validation normalized_cm: [[0.482 0.212 0.173 0.132]
 [0.163 0.391 0.141 0.304]
 [0.169 0.039 0.182 0.61 ]
 [0.    0.038 0.338 0.623]]
Validation acc: 0.46968238691049086
Validation class_accuracies: [0.48243243243243245, 0.391304347826087, 0.18181818181818182, 0.6230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4196579712884061
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.5562530008182183 hasn't increased by 0 in 3 epochs
330/330 - 880s - accuracy: 0.6077 - student_loss: 0.1449 - distillation_loss: -3.4784e-03 - val_accuracy: 0.5669 - val_student_loss: 2.9663 - 880s/epoch - 3s/step
Validation cm: [[605  86  25  24]
 [ 41  35   7   9]
 [ 23   3  23  28]
 [ 14  12  39  65]]
Validation normalized_cm: [[0.818 0.116 0.034 0.032]
 [0.446 0.38  0.076 0.098]
 [0.299 0.039 0.299 0.364]
 [0.108 0.092 0.3   0.5  ]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8175675675675675, 0.3804347826086957, 0.2987012987012987, 0.5]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4991759122193905
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5562530008182183 hasn't increased by 0 in 4 epochs
330/330 - 886s - accuracy: 0.6125 - student_loss: 0.3349 - distillation_loss: -2.3012e-03 - val_accuracy: 0.5467 - val_student_loss: 0.3329 - 886s/epoch - 3s/step
Validation cm: [[661  78   0   1]
 [ 52  40   0   0]
 [ 70   4   3   0]
 [ 81  13  35   1]]
Validation normalized_cm: [[0.893 0.105 0.    0.001]
 [0.565 0.435 0.    0.   ]
 [0.909 0.052 0.039 0.   ]
 [0.623 0.1   0.269 0.008]]
Validation acc: 0.6785370548604427
Validation class_accuracies: [0.8932432432432432, 0.43478260869565216, 0.03896103896103896, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3436697996480605
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5562530008182183 hasn't increased by 0 in 5 epochs
330/330 - 883s - accuracy: 0.6090 - student_loss: 0.5999 - distillation_loss: -1.5385e-03 - val_accuracy: 0.8046 - val_student_loss: 0.0828 - 883s/epoch - 3s/step
Validation cm: [[616  68  29  27]
 [ 27  41  10  14]
 [ 26   6  31  14]
 [ 31   9  49  41]]
Validation normalized_cm: [[0.832 0.092 0.039 0.036]
 [0.293 0.446 0.109 0.152]
 [0.338 0.078 0.403 0.182]
 [0.238 0.069 0.377 0.315]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.8324324324324325, 0.44565217391304346, 0.4025974025974026, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49901665608187346
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 883s - accuracy: 0.6567 - student_loss: 0.1229 - distillation_loss: 0.0015 - val_accuracy: 0.6449 - val_student_loss: 0.1599 - 883s/epoch - 3s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5562530008182183
Best cm: [[551 111  60  18]
 [ 28  41   5  18]
 [ 28   3  24  22]
 [  7   7  22  94]]
Best normalized_cm: [[0.745 0.15  0.081 0.024]
 [0.304 0.446 0.054 0.196]
 [0.364 0.039 0.312 0.286]
 [0.054 0.054 0.169 0.723]]
Best acc: 0.6833493743984601
Best class_accuracies: [0.7445945945945946, 0.44565217391304346, 0.3116883116883117, 0.7230769230769231]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 4
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
