Validation cm: [[601   0  92  47]
 [ 54   0  16  22]
 [ 63   0   6   8]
 [104   0  13  13]]
Validation normalized_cm: [[0.812 0.    0.124 0.064]
 [0.587 0.    0.174 0.239]
 [0.818 0.    0.078 0.104]
 [0.8   0.    0.1   0.1  ]]
Validation acc: 0.5967276227141483
Validation class_accuracies: [0.8121621621621622, 0.0, 0.07792207792207792, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24752106002106003
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train49
Description: Leaf with model 9/mixednet with P-T on Pneu
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 105,952
Trainable params: 105,456
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Saving model...
330/330 - 98s - loss: 0.4255 - accuracy: 0.5641 - 98s/epoch - 297ms/step
Validation cm: [[687   2   7  44]
 [ 65   1   5  21]
 [ 61   0   5  11]
 [102   0  18  10]]
Validation normalized_cm: [[0.928 0.003 0.009 0.059]
 [0.707 0.011 0.054 0.228]
 [0.792 0.    0.065 0.143]
 [0.785 0.    0.138 0.077]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.9283783783783783, 0.010869565217391304, 0.06493506493506493, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.27027652136347785
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Saving model...
330/330 - 92s - loss: 0.3394 - accuracy: 0.6371 - 92s/epoch - 279ms/step
Validation cm: [[454  16 155 115]
 [ 34   3  16  39]
 [ 21   0  37  19]
 [  5   0  84  41]]
Validation normalized_cm: [[0.614 0.022 0.209 0.155]
 [0.37  0.033 0.174 0.424]
 [0.273 0.    0.481 0.247]
 [0.038 0.    0.646 0.315]]
Validation acc: 0.5149181905678537
Validation class_accuracies: [0.6135135135135135, 0.03260869565217391, 0.4805194805194805, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3605065762674458
Validation one_indexed_epoch: 3
Epoch 3/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.2997 - accuracy: 0.6701 - 91s/epoch - 277ms/step
Validation cm: [[ 81   4  22 633]
 [  0   0   0  92]
 [  3   0   3  71]
 [  0   0   0 130]]
Validation normalized_cm: [[0.109 0.005 0.03  0.855]
 [0.    0.    0.    1.   ]
 [0.039 0.    0.039 0.922]
 [0.    0.    0.    1.   ]]
Validation acc: 0.20596727622714148
Validation class_accuracies: [0.10945945945945947, 0.0, 0.03896103896103896, 1.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2871051246051246
Validation one_indexed_epoch: 4
Epoch 4/40
The validation tracker metric at 0.3605065762674458 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.2740 - accuracy: 0.6813 - 92s/epoch - 280ms/step
Validation cm: [[134 199   4 403]
 [  1  10   0  81]
 [ 12  11   0  54]
 [  4  18   7 101]]
Validation normalized_cm: [[0.181 0.269 0.005 0.545]
 [0.011 0.109 0.    0.88 ]
 [0.156 0.143 0.    0.701]
 [0.031 0.138 0.054 0.777]]
Validation acc: 0.2358036573628489
Validation class_accuracies: [0.1810810810810811, 0.10869565217391304, 0.0, 0.7769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2666749525445178
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.3605065762674458 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.2460 - accuracy: 0.6768 - 91s/epoch - 277ms/step
Validation cm: [[683   0  19  38]
 [ 66   1   8  17]
 [ 34   2  32   9]
 [ 58   0  56  16]]
Validation normalized_cm: [[0.923 0.    0.026 0.051]
 [0.717 0.011 0.087 0.185]
 [0.442 0.026 0.416 0.117]
 [0.446 0.    0.431 0.123]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.922972972972973, 0.010869565217391304, 0.4155844155844156, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36812596921292573
Validation one_indexed_epoch: 6
Epoch 6/40
-- New best results were achieved. --
Saving model...
330/330 - 93s - loss: 0.2165 - accuracy: 0.6882 - 93s/epoch - 281ms/step
Validation cm: [[468 113  25 134]
 [ 19  31   3  39]
 [ 21   7  29  20]
 [ 16  19  54  41]]
Validation normalized_cm: [[0.632 0.153 0.034 0.181]
 [0.207 0.337 0.033 0.424]
 [0.273 0.091 0.377 0.26 ]
 [0.123 0.146 0.415 0.315]]
Validation acc: 0.5476419634263715
Validation class_accuracies: [0.6324324324324324, 0.33695652173913043, 0.37662337662337664, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4153492365448887
Validation one_indexed_epoch: 7
Epoch 7/40
-- New best results were achieved. --
Saving model...
330/330 - 92s - loss: 0.1942 - accuracy: 0.7208 - 92s/epoch - 278ms/step
Validation cm: [[255  20 141 324]
 [  5   2   5  80]
 [  4   5  33  35]
 [  6  13  30  81]]
Validation normalized_cm: [[0.345 0.027 0.191 0.438]
 [0.054 0.022 0.054 0.87 ]
 [0.052 0.065 0.429 0.455]
 [0.046 0.1   0.231 0.623]]
Validation acc: 0.3570741097208855
Validation class_accuracies: [0.34459459459459457, 0.021739130434782608, 0.42857142857142855, 0.6230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3544955191694322
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.4153492365448887 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.1663 - accuracy: 0.6996 - 92s/epoch - 278ms/step
Validation cm: [[100   4 190 446]
 [  0   0   4  88]
 [  4   0  23  50]
 [  0   0   3 127]]
Validation normalized_cm: [[0.135 0.005 0.257 0.603]
 [0.    0.    0.043 0.957]
 [0.052 0.    0.299 0.649]
 [0.    0.    0.023 0.977]]
Validation acc: 0.24061597690086622
Validation class_accuracies: [0.13513513513513514, 0.0, 0.2987012987012987, 0.9769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3526898776898777
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.4153492365448887 hasn't increased by 0 in 2 epochs
330/330 - 92s - loss: 0.1548 - accuracy: 0.6842 - 92s/epoch - 277ms/step
Validation cm: [[313  32 241 154]
 [ 11  11  11  59]
 [ 11   2  43  21]
 [  5   7  41  77]]
Validation normalized_cm: [[0.423 0.043 0.326 0.208]
 [0.12  0.12  0.12  0.641]
 [0.143 0.026 0.558 0.273]
 [0.038 0.054 0.315 0.592]]
Validation acc: 0.4273339749759384
Validation class_accuracies: [0.422972972972973, 0.11956521739130435, 0.5584415584415584, 0.5923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42332186027838203
Validation one_indexed_epoch: 10
Epoch 10/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.1273 - accuracy: 0.7111 - 91s/epoch - 275ms/step
Validation cm: [[169  16 118 437]
 [  0   4   4  84]
 [  8   3  28  38]
 [  3   2  13 112]]
Validation normalized_cm: [[0.228 0.022 0.159 0.591]
 [0.    0.043 0.043 0.913]
 [0.104 0.039 0.364 0.494]
 [0.023 0.015 0.1   0.862]]
Validation acc: 0.3012512030798845
Validation class_accuracies: [0.22837837837837838, 0.043478260869565216, 0.36363636363636365, 0.8615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3742578661056922
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.42332186027838203 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.1158 - accuracy: 0.6971 - 92s/epoch - 278ms/step
Validation cm: [[606  55  33  46]
 [ 40  19   4  29]
 [ 31   6  28  12]
 [ 46  31  23  30]]
Validation normalized_cm: [[0.819 0.074 0.045 0.062]
 [0.435 0.207 0.043 0.315]
 [0.403 0.078 0.364 0.156]
 [0.354 0.238 0.177 0.231]]
Validation acc: 0.6573628488931665
Validation class_accuracies: [0.8189189189189189, 0.20652173913043478, 0.36363636363636365, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.404961563113737
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.42332186027838203 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.1006 - accuracy: 0.6865 - 91s/epoch - 274ms/step
Validation cm: [[325  52 199 164]
 [ 13  10  16  53]
 [  5   4  42  26]
 [  1   6  33  90]]
Validation normalized_cm: [[0.439 0.07  0.269 0.222]
 [0.141 0.109 0.174 0.576]
 [0.065 0.052 0.545 0.338]
 [0.008 0.046 0.254 0.692]]
Validation acc: 0.4494706448508181
Validation class_accuracies: [0.4391891891891892, 0.10869565217391304, 0.5454545454545454, 0.6923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44641176978133496
Validation one_indexed_epoch: 13
Epoch 13/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.0792 - accuracy: 0.6808 - 91s/epoch - 277ms/step
Validation cm: [[395  96  91 158]
 [ 13  21   5  53]
 [ 16   6  31  24]
 [ 11  11  33  75]]
Validation normalized_cm: [[0.534 0.13  0.123 0.214]
 [0.141 0.228 0.054 0.576]
 [0.208 0.078 0.403 0.312]
 [0.085 0.085 0.254 0.577]]
Validation acc: 0.5024061597690087
Validation class_accuracies: [0.5337837837837838, 0.22826086956521738, 0.4025974025974026, 0.5769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43539128321737014
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 1 epochs
330/330 - 91s - loss: 0.0699 - accuracy: 0.6927 - 91s/epoch - 277ms/step
Validation cm: [[576  57  34  73]
 [ 31  26   2  33]
 [ 27   7  26  17]
 [ 32  36  25  37]]
Validation normalized_cm: [[0.778 0.077 0.046 0.099]
 [0.337 0.283 0.022 0.359]
 [0.351 0.091 0.338 0.221]
 [0.246 0.277 0.192 0.285]]
Validation acc: 0.6400384985563041
Validation class_accuracies: [0.7783783783783784, 0.2826086956521739, 0.33766233766233766, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4208161990770686
Validation one_indexed_epoch: 15
Epoch 15/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.0648 - accuracy: 0.6688 - 91s/epoch - 275ms/step
Validation cm: [[149   9 344 238]
 [  1   0  18  73]
 [  4   3  43  27]
 [  0   4  31  95]]
Validation normalized_cm: [[0.201 0.012 0.465 0.322]
 [0.011 0.    0.196 0.793]
 [0.052 0.039 0.558 0.351]
 [0.    0.031 0.238 0.731]]
Validation acc: 0.2762271414821944
Validation class_accuracies: [0.20135135135135135, 0.0, 0.5584415584415584, 0.7307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3726405351405351
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 3 epochs
330/330 - 91s - loss: 0.0577 - accuracy: 0.6924 - 91s/epoch - 276ms/step
Validation cm: [[341  94  96 209]
 [  9  18   6  59]
 [ 12   9  32  24]
 [ 11  21  22  76]]
Validation normalized_cm: [[0.461 0.127 0.13  0.282]
 [0.098 0.196 0.065 0.641]
 [0.156 0.117 0.416 0.312]
 [0.085 0.162 0.169 0.585]]
Validation acc: 0.4494706448508181
Validation class_accuracies: [0.4608108108108108, 0.1956521739130435, 0.4155844155844156, 0.5846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4141656962309137
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 4 epochs
330/330 - 91s - loss: 0.0446 - accuracy: 0.7066 - 91s/epoch - 276ms/step
Validation cm: [[505  47  91  97]
 [ 38  11   6  37]
 [ 22   3  35  17]
 [ 32  17  39  42]]
Validation normalized_cm: [[0.682 0.064 0.123 0.131]
 [0.413 0.12  0.065 0.402]
 [0.286 0.039 0.455 0.221]
 [0.246 0.131 0.3   0.323]]
Validation acc: 0.5707410972088547
Validation class_accuracies: [0.6824324324324325, 0.11956521739130435, 0.45454545454545453, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3949050068615286
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 5 epochs
330/330 - 91s - loss: 0.0435 - accuracy: 0.6863 - 91s/epoch - 277ms/step
Validation cm: [[567  47  69  57]
 [ 47  14   3  28]
 [ 29   1  25  22]
 [ 28  39  31  32]]
Validation normalized_cm: [[0.766 0.064 0.093 0.077]
 [0.511 0.152 0.033 0.304]
 [0.377 0.013 0.325 0.286]
 [0.215 0.3   0.238 0.246]]
Validation acc: 0.6140519730510106
Validation class_accuracies: [0.7662162162162162, 0.15217391304347827, 0.3246753246753247, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3723048250222163
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 6 epochs
330/330 - 91s - loss: 0.0434 - accuracy: 0.6815 - 91s/epoch - 275ms/step
Validation cm: [[463 130  43 104]
 [ 20  33   2  37]
 [ 24  10  23  20]
 [ 17  36  21  56]]
Validation normalized_cm: [[0.626 0.176 0.058 0.141]
 [0.217 0.359 0.022 0.402]
 [0.312 0.13  0.299 0.26 ]
 [0.131 0.277 0.162 0.431]]
Validation acc: 0.5534167468719923
Validation class_accuracies: [0.6256756756756757, 0.358695652173913, 0.2987012987012987, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42846046433002954
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 7 epochs
330/330 - 91s - loss: 0.0383 - accuracy: 0.6749 - 91s/epoch - 277ms/step
Validation cm: [[375 184  40 141]
 [ 16  34   2  40]
 [ 18   6  19  34]
 [ 11  36  16  67]]
Validation normalized_cm: [[0.507 0.249 0.054 0.191]
 [0.174 0.37  0.022 0.435]
 [0.234 0.078 0.247 0.442]
 [0.085 0.277 0.123 0.515]]
Validation acc: 0.4764196342637151
Validation class_accuracies: [0.5067567567567568, 0.3695652173913043, 0.24675324675324675, 0.5153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4096149590714808
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.44641176978133496 hasn't increased by 0 in 8 epochs
330/330 - 91s - loss: 0.0348 - accuracy: 0.6800 - 91s/epoch - 276ms/step
Validation cm: [[554  57  89  40]
 [ 33  22  10  27]
 [ 18   4  42  13]
 [ 27  10  56  37]]
Validation normalized_cm: [[0.749 0.077 0.12  0.054]
 [0.359 0.239 0.109 0.293]
 [0.234 0.052 0.545 0.169]
 [0.208 0.077 0.431 0.285]]
Validation acc: 0.6304138594802695
Validation class_accuracies: [0.7486486486486487, 0.2391304347826087, 0.5454545454545454, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4544622533752969
Validation one_indexed_epoch: 22
Epoch 22/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.0357 - accuracy: 0.6813 - 91s/epoch - 275ms/step
Validation cm: [[536  71  52  81]
 [ 24  27   4  37]
 [ 27   6  29  15]
 [ 21  31  32  46]]
Validation normalized_cm: [[0.724 0.096 0.07  0.109]
 [0.261 0.293 0.043 0.402]
 [0.351 0.078 0.377 0.195]
 [0.162 0.238 0.246 0.354]]
Validation acc: 0.6140519730510106
Validation class_accuracies: [0.7243243243243244, 0.29347826086956524, 0.37662337662337664, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43706802891585506
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.4544622533752969 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.0307 - accuracy: 0.6772 - 92s/epoch - 280ms/step
Validation cm: [[557  58  51  74]
 [ 30  23   4  35]
 [ 25   3  33  16]
 [ 16  20  37  57]]
Validation normalized_cm: [[0.753 0.078 0.069 0.1  ]
 [0.326 0.25  0.043 0.38 ]
 [0.325 0.039 0.429 0.208]
 [0.123 0.154 0.285 0.438]]
Validation acc: 0.6448508180943214
Validation class_accuracies: [0.7527027027027027, 0.25, 0.42857142857142855, 0.43846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46743391743391743
Validation one_indexed_epoch: 24
Epoch 24/40
-- New best results were achieved. --
Saving model...
330/330 - 90s - loss: 0.0219 - accuracy: 0.6901 - 90s/epoch - 274ms/step
Validation cm: [[389 121  82 148]
 [ 17  24   3  48]
 [  8   9  31  29]
 [  6  18  32  74]]
Validation normalized_cm: [[0.526 0.164 0.111 0.2  ]
 [0.185 0.261 0.033 0.522]
 [0.104 0.117 0.403 0.377]
 [0.046 0.138 0.246 0.569]]
Validation acc: 0.4985563041385948
Validation class_accuracies: [0.5256756756756756, 0.2608695652173913, 0.4025974025974026, 0.5692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4395933531803097
Validation one_indexed_epoch: 25
Epoch 25/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 1 epochs
330/330 - 90s - loss: 0.0281 - accuracy: 0.6722 - 90s/epoch - 273ms/step
Validation cm: [[550  49  73  68]
 [ 40  15   4  33]
 [ 24   2  38  13]
 [ 28   8  58  36]]
Validation normalized_cm: [[0.743 0.066 0.099 0.092]
 [0.435 0.163 0.043 0.359]
 [0.312 0.026 0.494 0.169]
 [0.215 0.062 0.446 0.277]]
Validation acc: 0.615014436958614
Validation class_accuracies: [0.7432432432432432, 0.16304347826086957, 0.4935064935064935, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41917907298342083
Validation one_indexed_epoch: 26
Epoch 26/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 2 epochs
330/330 - 90s - loss: 0.0295 - accuracy: 0.6741 - 90s/epoch - 273ms/step
Validation cm: [[424 112  79 125]
 [ 19  28   4  41]
 [ 24   5  32  16]
 [ 15  29  28  58]]
Validation normalized_cm: [[0.573 0.151 0.107 0.169]
 [0.207 0.304 0.043 0.446]
 [0.312 0.065 0.416 0.208]
 [0.115 0.223 0.215 0.446]]
Validation acc: 0.5216554379210779
Validation class_accuracies: [0.572972972972973, 0.30434782608695654, 0.4155844155844156, 0.4461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4347647651995478
Validation one_indexed_epoch: 27
Epoch 27/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 3 epochs
330/330 - 91s - loss: 0.0294 - accuracy: 0.6859 - 91s/epoch - 275ms/step
Validation cm: [[543  90  32  75]
 [ 26  33   1  32]
 [ 39   3  22  13]
 [ 31  48  23  28]]
Validation normalized_cm: [[0.734 0.122 0.043 0.101]
 [0.283 0.359 0.011 0.348]
 [0.506 0.039 0.286 0.169]
 [0.238 0.369 0.177 0.215]]
Validation acc: 0.602502406159769
Validation class_accuracies: [0.7337837837837838, 0.358695652173913, 0.2857142857142857, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39839458426414953
Validation one_indexed_epoch: 28
Epoch 28/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 4 epochs
330/330 - 91s - loss: 0.0262 - accuracy: 0.6603 - 91s/epoch - 276ms/step
Validation cm: [[464  70 116  90]
 [ 18  22  10  42]
 [ 18   2  41  16]
 [ 12  21  38  59]]
Validation normalized_cm: [[0.627 0.095 0.157 0.122]
 [0.196 0.239 0.109 0.457]
 [0.234 0.026 0.532 0.208]
 [0.092 0.162 0.292 0.454]]
Validation acc: 0.5640038498556305
Validation class_accuracies: [0.6270270270270271, 0.2391304347826087, 0.5324675324675324, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46311778703083045
Validation one_indexed_epoch: 29
Epoch 29/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 5 epochs
330/330 - 90s - loss: 0.0255 - accuracy: 0.6848 - 90s/epoch - 274ms/step
Validation cm: [[226  89 121 304]
 [  5  15   7  65]
 [  5   3  32  37]
 [  5  12  31  82]]
Validation normalized_cm: [[0.305 0.12  0.164 0.411]
 [0.054 0.163 0.076 0.707]
 [0.065 0.039 0.416 0.481]
 [0.038 0.092 0.238 0.631]]
Validation acc: 0.34167468719923005
Validation class_accuracies: [0.3054054054054054, 0.16304347826086957, 0.4155844155844156, 0.6307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3787006325049803
Validation one_indexed_epoch: 30
Epoch 30/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 6 epochs
330/330 - 90s - loss: 0.0223 - accuracy: 0.6616 - 90s/epoch - 274ms/step
Validation cm: [[511  48 102  79]
 [ 29  15  10  38]
 [ 27   2  35  13]
 [ 22  34  41  33]]
Validation normalized_cm: [[0.691 0.065 0.138 0.107]
 [0.315 0.163 0.109 0.413]
 [0.351 0.026 0.455 0.169]
 [0.169 0.262 0.315 0.254]]
Validation acc: 0.5717035611164581
Validation class_accuracies: [0.6905405405405406, 0.16304347826086957, 0.45454545454545453, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39049390679825463
Validation one_indexed_epoch: 31
Epoch 31/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 7 epochs
330/330 - 93s - loss: 0.0271 - accuracy: 0.6783 - 93s/epoch - 281ms/step
Validation cm: [[491 104  42 103]
 [ 21  28   3  40]
 [ 26   3  25  23]
 [ 19  46  21  44]]
Validation normalized_cm: [[0.664 0.141 0.057 0.139]
 [0.228 0.304 0.033 0.435]
 [0.338 0.039 0.325 0.299]
 [0.146 0.354 0.162 0.338]]
Validation acc: 0.5659287776708374
Validation class_accuracies: [0.6635135135135135, 0.30434782608695654, 0.3246753246753247, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4077495506843333
Validation one_indexed_epoch: 32
Epoch 32/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 8 epochs
330/330 - 92s - loss: 0.0251 - accuracy: 0.6639 - 92s/epoch - 278ms/step
Validation cm: [[574  59  48  59]
 [ 32  21  10  29]
 [ 30   2  30  15]
 [ 21  37  35  37]]
Validation normalized_cm: [[0.776 0.08  0.065 0.08 ]
 [0.348 0.228 0.109 0.315]
 [0.39  0.026 0.39  0.195]
 [0.162 0.285 0.269 0.285]]
Validation acc: 0.6371511068334937
Validation class_accuracies: [0.7756756756756756, 0.22826086956521738, 0.38961038961038963, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4195405798666668
Validation one_indexed_epoch: 33
Epoch 33/40
The validation tracker metric at 0.46743391743391743 hasn't increased by 0 in 9 epochs
330/330 - 91s - loss: 0.0202 - accuracy: 0.6629 - 91s/epoch - 276ms/step
Validation cm: [[434 132  58 116]
 [ 13  31   3  45]
 [ 19   5  29  24]
 [  8  33  21  68]]
Validation normalized_cm: [[0.586 0.178 0.078 0.157]
 [0.141 0.337 0.033 0.489]
 [0.247 0.065 0.377 0.312]
 [0.062 0.254 0.162 0.523]]
Validation acc: 0.5409047160731473
Validation class_accuracies: [0.5864864864864865, 0.33695652173913043, 0.37662337662337664, 0.5230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4557858269814792
Validation one_indexed_epoch: 34
Epoch 34/40
The number of epochs since last 1% equals the patience
330/330 - 91s - loss: 0.0196 - accuracy: 0.6779 - 91s/epoch - 277ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.46743391743391743
Best cm: [[557  58  51  74]
 [ 30  23   4  35]
 [ 25   3  33  16]
 [ 16  20  37  57]]
Best normalized_cm: [[0.753 0.078 0.069 0.1  ]
 [0.326 0.25  0.043 0.38 ]
 [0.325 0.039 0.429 0.208]
 [0.123 0.154 0.285 0.438]]
Best acc: 0.6448508180943214
Best class_accuracies: [0.7527027027027027, 0.25, 0.42857142857142855, 0.43846153846153846]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 24
Validation cm: [[736   4   0   0]
 [ 91   1   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[0.995 0.005 0.    0.   ]
 [0.989 0.011 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.9945945945945946, 0.010869565217391304, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2513660399529965
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 batch_normalization_5 (BatchNormalization)      multiple                                    4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_1 (Dense)                                 multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,158
Trainable params: 6,159,652
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Saving model...
330/330 - 223s - accuracy: 0.5143 - student_loss: 0.3398 - distillation_loss: -5.5467e-03 - val_accuracy: 0.9259 - val_student_loss: 0.3864 - 223s/epoch - 675ms/step
Validation cm: [[486  50 162  42]
 [ 26  11  36  19]
 [ 49   4  17   7]
 [ 44  18  31  37]]
Validation normalized_cm: [[0.657 0.068 0.219 0.057]
 [0.283 0.12  0.391 0.207]
 [0.636 0.052 0.221 0.091]
 [0.338 0.138 0.238 0.285]]
Validation acc: 0.5303176130895092
Validation class_accuracies: [0.6567567567567567, 0.11956521739130435, 0.22077922077922077, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3204291448856666
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Saving model...
330/330 - 211s - accuracy: 0.4688 - student_loss: 0.5443 - distillation_loss: 0.0041 - val_accuracy: 0.2830 - val_student_loss: 0.9112 - 211s/epoch - 638ms/step
Validation cm: [[617 102   8  13]
 [ 62  25   1   4]
 [ 64   8   0   5]
 [ 55  47   0  28]]
Validation normalized_cm: [[0.834 0.138 0.011 0.018]
 [0.674 0.272 0.011 0.043]
 [0.831 0.104 0.    0.065]
 [0.423 0.362 0.    0.215]]
Validation acc: 0.6448508180943214
Validation class_accuracies: [0.8337837837837838, 0.2717391304347826, 0.0, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.33022688240079545
Validation one_indexed_epoch: 3
Epoch 3/40
-- New best results were achieved. --
Saving model...
330/330 - 208s - accuracy: 0.4665 - student_loss: 0.3233 - distillation_loss: -4.9999e-03 - val_accuracy: 0.8932 - val_student_loss: 2.3416e-09 - 208s/epoch - 632ms/step
Validation cm: [[641   3  37  59]
 [ 68   0   8  16]
 [ 56   3   8  10]
 [ 46   4  22  58]]
Validation normalized_cm: [[0.866 0.004 0.05  0.08 ]
 [0.739 0.    0.087 0.174]
 [0.727 0.039 0.104 0.13 ]
 [0.354 0.031 0.169 0.446]]
Validation acc: 0.6804619826756496
Validation class_accuracies: [0.8662162162162163, 0.0, 0.1038961038961039, 0.4461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3540665415665416
Validation one_indexed_epoch: 4
Epoch 4/40
-- New best results were achieved. --
Saving model...
330/330 - 209s - accuracy: 0.4722 - student_loss: 0.6027 - distillation_loss: 2.7422e-04 - val_accuracy: 0.1097 - val_student_loss: 2.8151e-09 - 209s/epoch - 634ms/step
Validation cm: [[697   0  39   4]
 [ 88   0   4   0]
 [ 62   3  12   0]
 [ 90   1  18  21]]
Validation normalized_cm: [[0.942 0.    0.053 0.005]
 [0.957 0.    0.043 0.   ]
 [0.805 0.039 0.156 0.   ]
 [0.692 0.008 0.138 0.162]]
Validation acc: 0.7025986525505293
Validation class_accuracies: [0.9418918918918919, 0.0, 0.15584415584415584, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.31481862731862736
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.3540665415665416 hasn't increased by 0 in 1 epochs
330/330 - 208s - accuracy: 0.4756 - student_loss: 0.4811 - distillation_loss: 0.0086 - val_accuracy: 0.0731 - val_student_loss: 1.8966e-17 - 208s/epoch - 631ms/step
Validation cm: [[583  31  28  98]
 [ 54   3   8  27]
 [ 54   3  10  10]
 [ 48   7  61  14]]
Validation normalized_cm: [[0.788 0.042 0.038 0.132]
 [0.587 0.033 0.087 0.293]
 [0.701 0.039 0.13  0.13 ]
 [0.369 0.054 0.469 0.108]]
Validation acc: 0.5871029836381135
Validation class_accuracies: [0.7878378378378378, 0.03260869565217391, 0.12987012987012986, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26450224276311235
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.3540665415665416 hasn't increased by 0 in 2 epochs
330/330 - 209s - accuracy: 0.5035 - student_loss: 0.3103 - distillation_loss: -5.7709e-03 - val_accuracy: 0.6583 - val_student_loss: 3.7364e-04 - 209s/epoch - 632ms/step
Validation cm: [[129  61   8 542]
 [  3   8   0  81]
 [  3   6   2  66]
 [  0   1   0 129]]
Validation normalized_cm: [[0.174 0.082 0.011 0.732]
 [0.033 0.087 0.    0.88 ]
 [0.039 0.078 0.026 0.857]
 [0.    0.008 0.    0.992]]
Validation acc: 0.2579403272377286
Validation class_accuracies: [0.17432432432432432, 0.08695652173913043, 0.025974025974025976, 0.9923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3198906410862933
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.3540665415665416 hasn't increased by 0 in 3 epochs
330/330 - 210s - accuracy: 0.5794 - student_loss: 0.3725 - distillation_loss: 5.9773e-04 - val_accuracy: 0.4071 - val_student_loss: 8.4458 - 210s/epoch - 637ms/step
Validation cm: [[509  56 156  19]
 [ 58  11  18   5]
 [ 38   2  35   2]
 [ 33   0  81  16]]
Validation normalized_cm: [[0.688 0.076 0.211 0.026]
 [0.63  0.12  0.196 0.054]
 [0.494 0.026 0.455 0.026]
 [0.254 0.    0.623 0.123]]
Validation acc: 0.5495668912415784
Validation class_accuracies: [0.6878378378378378, 0.11956521739130435, 0.45454545454545453, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3462563582128799
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.3540665415665416 hasn't increased by 0 in 4 epochs
330/330 - 209s - accuracy: 0.5904 - student_loss: 0.3886 - distillation_loss: -1.1707e-02 - val_accuracy: 0.1848 - val_student_loss: 7.8154e-05 - 209s/epoch - 632ms/step
Validation cm: [[559 114  59   8]
 [ 36  41  11   4]
 [ 24  14  31   8]
 [ 12  18  80  20]]
Validation normalized_cm: [[0.755 0.154 0.08  0.011]
 [0.391 0.446 0.12  0.043]
 [0.312 0.182 0.403 0.104]
 [0.092 0.138 0.615 0.154]]
Validation acc: 0.6265640038498557
Validation class_accuracies: [0.7554054054054054, 0.44565217391304346, 0.4025974025974026, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4393752839405013
Validation one_indexed_epoch: 9
Epoch 9/40
-- New best results were achieved. --
Saving model...
330/330 - 210s - accuracy: 0.5734 - student_loss: 0.1346 - distillation_loss: 0.0012 - val_accuracy: 0.4293 - val_student_loss: 0.8001 - 210s/epoch - 635ms/step
Validation cm: [[451  58  30 201]
 [ 12  19   3  58]
 [ 31   9   7  30]
 [ 15  13   8  94]]
Validation normalized_cm: [[0.609 0.078 0.041 0.272]
 [0.13  0.207 0.033 0.63 ]
 [0.403 0.117 0.091 0.39 ]
 [0.115 0.1   0.062 0.723]]
Validation acc: 0.5495668912415784
Validation class_accuracies: [0.6094594594594595, 0.20652173913043478, 0.09090909090909091, 0.7230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40749180314397704
Validation one_indexed_epoch: 10
Epoch 10/40
The validation tracker metric at 0.4393752839405013 hasn't increased by 0 in 1 epochs
330/330 - 210s - accuracy: 0.6106 - student_loss: 0.9683 - distillation_loss: 0.0134 - val_accuracy: 0.5602 - val_student_loss: 2.1045 - 210s/epoch - 635ms/step
Validation cm: [[467 226  37  10]
 [ 44  44   4   0]
 [ 22  26  23   6]
 [ 20  34  58  18]]
Validation normalized_cm: [[0.631 0.305 0.05  0.014]
 [0.478 0.478 0.043 0.   ]
 [0.286 0.338 0.299 0.078]
 [0.154 0.262 0.446 0.138]]
Validation acc: 0.5312800769971127
Validation class_accuracies: [0.6310810810810811, 0.4782608695652174, 0.2987012987012987, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3866261969522839
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.4393752839405013 hasn't increased by 0 in 2 epochs
330/330 - 207s - accuracy: 0.6083 - student_loss: 0.5103 - distillation_loss: 0.0134 - val_accuracy: 0.6400 - val_student_loss: 0.5110 - 207s/epoch - 626ms/step
Validation cm: [[268 466   1   5]
 [  3  89   0   0]
 [ 14  59   4   0]
 [  1 116   0  13]]
Validation normalized_cm: [[0.362 0.63  0.001 0.007]
 [0.033 0.967 0.    0.   ]
 [0.182 0.766 0.052 0.   ]
 [0.008 0.892 0.    0.1  ]]
Validation acc: 0.3599615014436959
Validation class_accuracies: [0.3621621621621622, 0.967391304347826, 0.05194805194805195, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37037537961451006
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.4393752839405013 hasn't increased by 0 in 3 epochs
330/330 - 209s - accuracy: 0.6062 - student_loss: 0.4564 - distillation_loss: -1.4614e-02 - val_accuracy: 0.9220 - val_student_loss: 4.8028 - 209s/epoch - 635ms/step
Validation cm: [[356 258  93  33]
 [ 24  56  10   2]
 [ 16  17  31  13]
 [ 13  19  66  32]]
Validation normalized_cm: [[0.481 0.349 0.126 0.045]
 [0.261 0.609 0.109 0.022]
 [0.208 0.221 0.403 0.169]
 [0.1   0.146 0.508 0.246]]
Validation acc: 0.4571703561116458
Validation class_accuracies: [0.4810810810810811, 0.6086956521739131, 0.4025974025974026, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43463199550156073
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.4393752839405013 hasn't increased by 0 in 4 epochs
330/330 - 210s - accuracy: 0.6445 - student_loss: 0.2201 - distillation_loss: -2.2727e-03 - val_accuracy: 0.6064 - val_student_loss: 0.1104 - 210s/epoch - 635ms/step
Validation cm: [[169 361  68 142]
 [  2  76   1  13]
 [  6  29   7  35]
 [  2  58  11  59]]
Validation normalized_cm: [[0.228 0.488 0.092 0.192]
 [0.022 0.826 0.011 0.141]
 [0.078 0.377 0.091 0.455]
 [0.015 0.446 0.085 0.454]]
Validation acc: 0.2993262752646776
Validation class_accuracies: [0.22837837837837838, 0.8260869565217391, 0.09090909090909091, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3998051449138405
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.4393752839405013 hasn't increased by 0 in 5 epochs
330/330 - 210s - accuracy: 0.6821 - student_loss: 0.5631 - distillation_loss: -4.5363e-04 - val_accuracy: 0.6987 - val_student_loss: 7.0508 - 210s/epoch - 635ms/step
Validation cm: [[319 205 100 116]
 [  6  67   4  15]
 [ 21  15  25  16]
 [ 10  34  14  72]]
Validation normalized_cm: [[0.431 0.277 0.135 0.157]
 [0.065 0.728 0.043 0.163]
 [0.273 0.195 0.325 0.208]
 [0.077 0.262 0.108 0.554]]
Validation acc: 0.46487006737247355
Validation class_accuracies: [0.43108108108108106, 0.7282608695652174, 0.3246753246753247, 0.5538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5094658572919443
Validation one_indexed_epoch: 15
Epoch 15/40
-- New best results were achieved. --
Saving model...
330/330 - 210s - accuracy: 0.6411 - student_loss: 0.7793 - distillation_loss: 0.0053 - val_accuracy: 0.5245 - val_student_loss: 3.5719 - 210s/epoch - 635ms/step
Validation cm: [[239 133 224 144]
 [  7  33   9  43]
 [  4   7  47  19]
 [  1   4  84  41]]
Validation normalized_cm: [[0.323 0.18  0.303 0.195]
 [0.076 0.359 0.098 0.467]
 [0.052 0.091 0.61  0.247]
 [0.008 0.031 0.646 0.315]]
Validation acc: 0.34648700673724736
Validation class_accuracies: [0.32297297297297295, 0.358695652173913, 0.6103896103896104, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40186071273027796
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 1 epochs
330/330 - 209s - accuracy: 0.6411 - student_loss: 0.4759 - distillation_loss: -1.1366e-02 - val_accuracy: 0.3811 - val_student_loss: 6.6324 - 209s/epoch - 634ms/step
Validation cm: [[551 166   6  17]
 [ 37  48   1   6]
 [ 47  16   3  11]
 [ 43  31  18  38]]
Validation normalized_cm: [[0.745 0.224 0.008 0.023]
 [0.402 0.522 0.011 0.065]
 [0.61  0.208 0.039 0.143]
 [0.331 0.238 0.138 0.292]]
Validation acc: 0.6159769008662175
Validation class_accuracies: [0.7445945945945946, 0.5217391304347826, 0.03896103896103896, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39940061407452715
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 2 epochs
330/330 - 210s - accuracy: 0.6536 - student_loss: 1.0418 - distillation_loss: 0.0110 - val_accuracy: 0.7690 - val_student_loss: 1.2907 - 210s/epoch - 636ms/step
Validation cm: [[602  97  21  20]
 [ 48  35   2   7]
 [ 32  16  15  14]
 [ 30  31  43  26]]
Validation normalized_cm: [[0.814 0.131 0.028 0.027]
 [0.522 0.38  0.022 0.076]
 [0.416 0.208 0.195 0.182]
 [0.231 0.238 0.331 0.2  ]]
Validation acc: 0.6525505293551492
Validation class_accuracies: [0.8135135135135135, 0.3804347826086957, 0.19480519480519481, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.397188372731851
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 3 epochs
330/330 - 209s - accuracy: 0.6622 - student_loss: 0.2074 - distillation_loss: -3.1823e-03 - val_accuracy: 0.6968 - val_student_loss: 1.9497 - 209s/epoch - 634ms/step
Validation cm: [[414 113 110 103]
 [ 24  15   8  45]
 [ 16   6  32  23]
 [ 17  18  30  65]]
Validation normalized_cm: [[0.559 0.153 0.149 0.139]
 [0.261 0.163 0.087 0.489]
 [0.208 0.078 0.416 0.299]
 [0.131 0.138 0.231 0.5  ]]
Validation acc: 0.5062560153994226
Validation class_accuracies: [0.5594594594594594, 0.16304347826086957, 0.4155844155844156, 0.5]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40952183832618616
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 4 epochs
330/330 - 210s - accuracy: 0.6929 - student_loss: 0.1713 - distillation_loss: -5.6737e-03 - val_accuracy: 0.5120 - val_student_loss: 4.2663 - 210s/epoch - 636ms/step
Validation cm: [[401 200  72  67]
 [ 17  38  12  25]
 [ 22  10  25  20]
 [ 15  20  48  47]]
Validation normalized_cm: [[0.542 0.27  0.097 0.091]
 [0.185 0.413 0.13  0.272]
 [0.286 0.13  0.325 0.26 ]
 [0.115 0.154 0.369 0.362]]
Validation acc: 0.4918190567853705
Validation class_accuracies: [0.5418918918918919, 0.41304347826086957, 0.3246753246753247, 0.36153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4102872890916369
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 5 epochs
330/330 - 209s - accuracy: 0.7149 - student_loss: 0.3430 - distillation_loss: -9.0480e-03 - val_accuracy: 0.6227 - val_student_loss: 4.0148 - 209s/epoch - 635ms/step
Validation cm: [[615  17  77  31]
 [ 56   4   6  26]
 [ 35   0  27  15]
 [ 32   7  39  52]]
Validation normalized_cm: [[0.831 0.023 0.104 0.042]
 [0.609 0.043 0.065 0.283]
 [0.455 0.    0.351 0.195]
 [0.246 0.054 0.3   0.4  ]]
Validation acc: 0.6717998075072185
Validation class_accuracies: [0.831081081081081, 0.043478260869565216, 0.35064935064935066, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40630217314999917
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 6 epochs
330/330 - 209s - accuracy: 0.7072 - student_loss: 0.3093 - distillation_loss: -9.9885e-03 - val_accuracy: 0.3763 - val_student_loss: 3.5299 - 209s/epoch - 634ms/step
Validation cm: [[427  87 181  45]
 [ 42  22   9  19]
 [ 14   7  30  26]
 [ 12  10  27  81]]
Validation normalized_cm: [[0.577 0.118 0.245 0.061]
 [0.457 0.239 0.098 0.207]
 [0.182 0.091 0.39  0.338]
 [0.092 0.077 0.208 0.623]]
Validation acc: 0.5389797882579404
Validation class_accuracies: [0.577027027027027, 0.2391304347826087, 0.38961038961038963, 0.6230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4572111936242371
Validation one_indexed_epoch: 22
Epoch 22/40
The validation tracker metric at 0.5094658572919443 hasn't increased by 0 in 7 epochs
330/330 - 209s - accuracy: 0.6783 - student_loss: 0.2242 - distillation_loss: -8.2982e-03 - val_accuracy: 0.4687 - val_student_loss: 2.8258 - 209s/epoch - 635ms/step
Validation cm: [[515 126  72  27]
 [ 31  45   3  13]
 [ 22  16  26  13]
 [ 18  15  30  67]]
Validation normalized_cm: [[0.696 0.17  0.097 0.036]
 [0.337 0.489 0.033 0.141]
 [0.286 0.208 0.338 0.169]
 [0.138 0.115 0.231 0.515]]
Validation acc: 0.6284889316650626
Validation class_accuracies: [0.6959459459459459, 0.4891304347826087, 0.33766233766233766, 0.5153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.509530833443877
Validation one_indexed_epoch: 23
Epoch 23/40
-- New best results were achieved. --
Saving model...
330/330 - 209s - accuracy: 0.6948 - student_loss: 0.1836 - distillation_loss: 8.2401e-04 - val_accuracy: 0.6651 - val_student_loss: 1.8027 - 209s/epoch - 633ms/step
Validation cm: [[477  49 149  65]
 [ 39  12  19  22]
 [ 19   0  32  26]
 [ 11  10  27  82]]
Validation normalized_cm: [[0.645 0.066 0.201 0.088]
 [0.424 0.13  0.207 0.239]
 [0.247 0.    0.416 0.338]
 [0.085 0.077 0.208 0.631]]
Validation acc: 0.5803657362848893
Validation class_accuracies: [0.6445945945945946, 0.13043478260869565, 0.4155844155844156, 0.6307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45534575588923415
Validation one_indexed_epoch: 24
Epoch 24/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 1 epochs
330/330 - 210s - accuracy: 0.7375 - student_loss: 0.5285 - distillation_loss: -1.2219e-02 - val_accuracy: 0.4023 - val_student_loss: 3.8636 - 210s/epoch - 635ms/step
Validation cm: [[552  95  49  44]
 [ 37  28   4  23]
 [ 29   9  18  21]
 [ 17  19  49  45]]
Validation normalized_cm: [[0.746 0.128 0.066 0.059]
 [0.402 0.304 0.043 0.25 ]
 [0.377 0.117 0.234 0.273]
 [0.131 0.146 0.377 0.346]]
Validation acc: 0.6188642925890279
Validation class_accuracies: [0.745945945945946, 0.30434782608695654, 0.23376623376623376, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4075534629882456
Validation one_indexed_epoch: 25
Epoch 25/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 2 epochs
330/330 - 211s - accuracy: 0.6946 - student_loss: 0.2381 - distillation_loss: -4.7336e-03 - val_accuracy: 0.5929 - val_student_loss: 2.3244 - 211s/epoch - 639ms/step
Validation cm: [[629  81  21   9]
 [ 54  24   0  14]
 [ 32  15  19  11]
 [ 20  44  23  43]]
Validation normalized_cm: [[0.85  0.109 0.028 0.012]
 [0.587 0.261 0.    0.152]
 [0.416 0.195 0.247 0.143]
 [0.154 0.338 0.177 0.331]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.85, 0.2608695652173913, 0.24675324675324675, 0.33076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42209801068496716
Validation one_indexed_epoch: 26
Epoch 26/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 3 epochs
330/330 - 210s - accuracy: 0.7113 - student_loss: 1.0195 - distillation_loss: 0.0151 - val_accuracy: 0.6949 - val_student_loss: 2.9339 - 210s/epoch - 636ms/step
Validation cm: [[691  34  11   4]
 [ 61  19   5   7]
 [ 52   7  14   4]
 [ 44  40  28  18]]
Validation normalized_cm: [[0.934 0.046 0.015 0.005]
 [0.663 0.207 0.054 0.076]
 [0.675 0.091 0.182 0.052]
 [0.338 0.308 0.215 0.138]]
Validation acc: 0.714148219441771
Validation class_accuracies: [0.9337837837837838, 0.20652173913043478, 0.18181818181818182, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3651463107984847
Validation one_indexed_epoch: 27
Epoch 27/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 4 epochs
330/330 - 211s - accuracy: 0.6992 - student_loss: 0.1186 - distillation_loss: 7.9329e-04 - val_accuracy: 0.6622 - val_student_loss: 0.1453 - 211s/epoch - 639ms/step
Validation cm: [[710  21   8   1]
 [ 76   6  10   0]
 [ 53   6  15   3]
 [ 57  19  48   6]]
Validation normalized_cm: [[0.959 0.028 0.011 0.001]
 [0.826 0.065 0.109 0.   ]
 [0.688 0.078 0.195 0.039]
 [0.438 0.146 0.369 0.046]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.9594594594594594, 0.06521739130434782, 0.19480519480519481, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3164089729307121
Validation one_indexed_epoch: 28
Epoch 28/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 5 epochs
330/330 - 210s - accuracy: 0.7286 - student_loss: 1.2287 - distillation_loss: 0.0098 - val_accuracy: 0.3908 - val_student_loss: 0.1476 - 210s/epoch - 637ms/step
Validation cm: [[503  11 225   1]
 [ 39   0  51   2]
 [ 30   1  39   7]
 [ 23   6  97   4]]
Validation normalized_cm: [[0.68  0.015 0.304 0.001]
 [0.424 0.    0.554 0.022]
 [0.39  0.013 0.506 0.091]
 [0.177 0.046 0.746 0.031]]
Validation acc: 0.5255052935514918
Validation class_accuracies: [0.6797297297297298, 0.0, 0.5064935064935064, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3042481167481167
Validation one_indexed_epoch: 29
Epoch 29/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 6 epochs
330/330 - 210s - accuracy: 0.6582 - student_loss: 0.7304 - distillation_loss: 0.0159 - val_accuracy: 0.2502 - val_student_loss: 3.2244 - 210s/epoch - 637ms/step
Validation cm: [[587  31 111  11]
 [ 63  15   7   7]
 [ 34   1  30  12]
 [ 43  25  22  40]]
Validation normalized_cm: [[0.793 0.042 0.15  0.015]
 [0.685 0.163 0.076 0.076]
 [0.442 0.013 0.39  0.156]
 [0.331 0.192 0.169 0.308]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.7932432432432432, 0.16304347826086957, 0.38961038961038963, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4133973547017025
Validation one_indexed_epoch: 30
Epoch 30/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 7 epochs
330/330 - 211s - accuracy: 0.7102 - student_loss: 0.5124 - distillation_loss: 0.0147 - val_accuracy: 0.3888 - val_student_loss: 0.7962 - 211s/epoch - 638ms/step
Validation cm: [[714   9  17   0]
 [ 82   4   3   3]
 [ 50   1  23   3]
 [ 59  10  43  18]]
Validation normalized_cm: [[0.965 0.012 0.023 0.   ]
 [0.891 0.043 0.033 0.033]
 [0.649 0.013 0.299 0.039]
 [0.454 0.077 0.331 0.138]]
Validation acc: 0.7305101058710298
Validation class_accuracies: [0.9648648648648649, 0.043478260869565216, 0.2987012987012987, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3613764907243168
Validation one_indexed_epoch: 31
Epoch 31/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 8 epochs
330/330 - 210s - accuracy: 0.7054 - student_loss: 0.6600 - distillation_loss: 0.0058 - val_accuracy: 0.5303 - val_student_loss: 0.0155 - 210s/epoch - 636ms/step
Validation cm: [[650  21  64   5]
 [ 76   6   6   4]
 [ 33   2  35   7]
 [ 58  16  42  14]]
Validation normalized_cm: [[0.878 0.028 0.086 0.007]
 [0.826 0.065 0.065 0.043]
 [0.429 0.026 0.455 0.091]
 [0.446 0.123 0.323 0.108]]
Validation acc: 0.6785370548604427
Validation class_accuracies: [0.8783783783783784, 0.06521739130434782, 0.45454545454545453, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37645838298012213
Validation one_indexed_epoch: 32
Epoch 32/40
The validation tracker metric at 0.509530833443877 hasn't increased by 0 in 9 epochs
330/330 - 210s - accuracy: 0.7030 - student_loss: 0.1487 - distillation_loss: -5.0945e-03 - val_accuracy: 0.5005 - val_student_loss: 6.6420e-05 - 210s/epoch - 637ms/step
Validation cm: [[673  33  33   1]
 [ 81   6   3   2]
 [ 48   0  26   3]
 [ 73  16  21  20]]
Validation normalized_cm: [[0.909 0.045 0.045 0.001]
 [0.88  0.065 0.033 0.022]
 [0.623 0.    0.338 0.039]
 [0.562 0.123 0.162 0.154]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.9094594594594595, 0.06521739130434782, 0.33766233766233766, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3665463355680747
Validation one_indexed_epoch: 33
Epoch 33/40
The number of epochs since last 1% equals the patience
330/330 - 210s - accuracy: 0.7277 - student_loss: 0.1468 - distillation_loss: -5.4143e-05 - val_accuracy: 0.6352 - val_student_loss: 6.4385e-06 - 210s/epoch - 637ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.509530833443877
Best cm: [[515 126  72  27]
 [ 31  45   3  13]
 [ 22  16  26  13]
 [ 18  15  30  67]]
Best normalized_cm: [[0.696 0.17  0.097 0.036]
 [0.337 0.489 0.033 0.141]
 [0.286 0.208 0.338 0.169]
 [0.138 0.115 0.231 0.515]]
Best acc: 0.6284889316650626
Best class_accuracies: [0.6959459459459459, 0.4891304347826087, 0.33766233766233766, 0.5153846153846153]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 23
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
