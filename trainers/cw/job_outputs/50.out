Validation cm: [[728   3   1   8]
 [ 78   1   0  13]
 [ 77   0   0   0]
 [127   0   3   0]]
Validation normalized_cm: [[0.984 0.004 0.001 0.011]
 [0.848 0.011 0.    0.141]
 [1.    0.    0.    0.   ]
 [0.977 0.    0.023 0.   ]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.9837837837837838, 0.010869565217391304, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2486633372502938
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train50
Description: Leaf with model 9/mixednet with P-T on Pneu
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 105,952
Trainable params: 105,456
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Saving model...
330/330 - 96s - loss: 0.4274 - accuracy: 0.5654 - 96s/epoch - 292ms/step
Validation cm: [[632  63  15  30]
 [ 46  12  11  23]
 [ 57   2   7  11]
 [ 47  10  62  11]]
Validation normalized_cm: [[0.854 0.085 0.02  0.041]
 [0.5   0.13  0.12  0.25 ]
 [0.74  0.026 0.091 0.143]
 [0.362 0.077 0.477 0.085]]
Validation acc: 0.6371511068334937
Validation class_accuracies: [0.8540540540540541, 0.13043478260869565, 0.09090909090909091, 0.08461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2900033280468063
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Saving model...
330/330 - 90s - loss: 0.3401 - accuracy: 0.6282 - 90s/epoch - 273ms/step
Validation cm: [[403  65  76 196]
 [  7  17   3  65]
 [ 14   2  28  33]
 [  1   5  53  71]]
Validation normalized_cm: [[0.545 0.088 0.103 0.265]
 [0.076 0.185 0.033 0.707]
 [0.182 0.026 0.364 0.429]
 [0.008 0.038 0.408 0.546]]
Validation acc: 0.49951876804619827
Validation class_accuracies: [0.5445945945945946, 0.18478260869565216, 0.36363636363636365, 0.5461538461538461]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40979185327011414
Validation one_indexed_epoch: 3
Epoch 3/40
-- New best results were achieved. --
Saving model...
330/330 - 90s - loss: 0.3056 - accuracy: 0.6597 - 90s/epoch - 274ms/step
Validation cm: [[442  63 118 117]
 [ 27  18   5  42]
 [ 14   5  32  26]
 [  2   8  46  74]]
Validation normalized_cm: [[0.597 0.085 0.159 0.158]
 [0.293 0.196 0.054 0.457]
 [0.182 0.065 0.416 0.338]
 [0.015 0.062 0.354 0.569]]
Validation acc: 0.5447545717035611
Validation class_accuracies: [0.5972972972972973, 0.1956521739130435, 0.4155844155844156, 0.5692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4444411640063814
Validation one_indexed_epoch: 4
Epoch 4/40
-- New best results were achieved. --
Saving model...
330/330 - 92s - loss: 0.2733 - accuracy: 0.6665 - 92s/epoch - 278ms/step
Validation cm: [[598  82  13  47]
 [ 34  32   0  26]
 [ 40   2  18  17]
 [ 54  22  25  29]]
Validation normalized_cm: [[0.808 0.111 0.018 0.064]
 [0.37  0.348 0.    0.283]
 [0.519 0.026 0.234 0.221]
 [0.415 0.169 0.192 0.223]]
Validation acc: 0.6515880654475458
Validation class_accuracies: [0.8081081081081081, 0.34782608695652173, 0.23376623376623376, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4031943379769467
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 1 epochs
330/330 - 91s - loss: 0.2478 - accuracy: 0.6719 - 91s/epoch - 276ms/step
Validation cm: [[629  29  35  47]
 [ 40  14  14  24]
 [ 32   0  32  13]
 [ 26   4  76  24]]
Validation normalized_cm: [[0.85  0.039 0.047 0.064]
 [0.435 0.152 0.152 0.261]
 [0.416 0.    0.416 0.169]
 [0.2   0.031 0.585 0.185]]
Validation acc: 0.6727622714148219
Validation class_accuracies: [0.85, 0.15217391304347827, 0.4155844155844156, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4005934283108196
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.2162 - accuracy: 0.6863 - 91s/epoch - 276ms/step
Validation cm: [[248 116  72 304]
 [  3  12   2  75]
 [  9   3  25  40]
 [  0   1  20 109]]
Validation normalized_cm: [[0.335 0.157 0.097 0.411]
 [0.033 0.13  0.022 0.815]
 [0.117 0.039 0.325 0.519]
 [0.    0.008 0.154 0.838]]
Validation acc: 0.37921077959576516
Validation class_accuracies: [0.33513513513513515, 0.13043478260869565, 0.3246753246753247, 0.8384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4071766952201735
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 3 epochs
330/330 - 90s - loss: 0.1931 - accuracy: 0.7142 - 90s/epoch - 272ms/step
Validation cm: [[416 106  75 143]
 [ 14  16   3  59]
 [ 12   2  35  28]
 [  6  17  36  71]]
Validation normalized_cm: [[0.562 0.143 0.101 0.193]
 [0.152 0.174 0.033 0.641]
 [0.156 0.026 0.455 0.364]
 [0.046 0.131 0.277 0.546]]
Validation acc: 0.5178055822906641
Validation class_accuracies: [0.5621621621621622, 0.17391304347826086, 0.45454545454545453, 0.5461538461538461]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4341936265849309
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 4 epochs
330/330 - 91s - loss: 0.1684 - accuracy: 0.7218 - 91s/epoch - 277ms/step
Validation cm: [[467 218  13  42]
 [ 20  47   1  24]
 [ 17  19  18  23]
 [ 12  57  17  44]]
Validation normalized_cm: [[0.631 0.295 0.018 0.057]
 [0.217 0.511 0.011 0.261]
 [0.221 0.247 0.234 0.299]
 [0.092 0.438 0.131 0.338]]
Validation acc: 0.5543792107795957
Validation class_accuracies: [0.6310810810810811, 0.5108695652173914, 0.23376623376623376, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4285446046315612
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 5 epochs
330/330 - 90s - loss: 0.1514 - accuracy: 0.6948 - 90s/epoch - 274ms/step
Validation cm: [[476 139  21 104]
 [ 17  28   2  45]
 [ 20   6  20  31]
 [  4  21  32  73]]
Validation normalized_cm: [[0.643 0.188 0.028 0.141]
 [0.185 0.304 0.022 0.489]
 [0.26  0.078 0.26  0.403]
 [0.031 0.162 0.246 0.562]]
Validation acc: 0.5745909528392685
Validation class_accuracies: [0.6432432432432432, 0.30434782608695654, 0.2597402597402597, 0.5615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44221744765223026
Validation one_indexed_epoch: 10
Epoch 10/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 6 epochs
330/330 - 90s - loss: 0.1262 - accuracy: 0.7155 - 90s/epoch - 273ms/step
Validation cm: [[644  58   4  34]
 [ 47  21   3  21]
 [ 43   2  19  13]
 [ 47  21  36  26]]
Validation normalized_cm: [[0.87  0.078 0.005 0.046]
 [0.511 0.228 0.033 0.228]
 [0.558 0.026 0.247 0.169]
 [0.362 0.162 0.277 0.2  ]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.8702702702702703, 0.22826086956521738, 0.24675324675324675, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38632109664718356
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 7 epochs
330/330 - 90s - loss: 0.1140 - accuracy: 0.6908 - 90s/epoch - 272ms/step
Validation cm: [[330 270  15 125]
 [ 13  33   2  44]
 [ 15  15  13  34]
 [  7   7  18  98]]
Validation normalized_cm: [[0.446 0.365 0.02  0.169]
 [0.141 0.359 0.022 0.478]
 [0.195 0.195 0.169 0.442]
 [0.054 0.054 0.138 0.754]]
Validation acc: 0.45620789220404234
Validation class_accuracies: [0.44594594594594594, 0.358695652173913, 0.16883116883116883, 0.7538461538461538]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4318297301992954
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.4444411640063814 hasn't increased by 0 in 8 epochs
330/330 - 92s - loss: 0.1003 - accuracy: 0.6935 - 92s/epoch - 279ms/step
Validation cm: [[450 174  43  73]
 [ 19  34   2  37]
 [ 20   6  24  27]
 [  5   8  33  84]]
Validation normalized_cm: [[0.608 0.235 0.058 0.099]
 [0.207 0.37  0.022 0.402]
 [0.26  0.078 0.312 0.351]
 [0.038 0.062 0.254 0.646]]
Validation acc: 0.5697786333012512
Validation class_accuracies: [0.6081081081081081, 0.3695652173913043, 0.3116883116883117, 0.6461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4838788708353926
Validation one_indexed_epoch: 13
Epoch 13/40
-- New best results were achieved. --
Saving model...
330/330 - 90s - loss: 0.0837 - accuracy: 0.6870 - 90s/epoch - 274ms/step
Validation cm: [[529 147   4  60]
 [ 31  37   1  23]
 [ 36  10  13  18]
 [ 34  54  17  25]]
Validation normalized_cm: [[0.715 0.199 0.005 0.081]
 [0.337 0.402 0.011 0.25 ]
 [0.468 0.13  0.169 0.234]
 [0.262 0.415 0.131 0.192]]
Validation acc: 0.5813282001924928
Validation class_accuracies: [0.7148648648648649, 0.40217391304347827, 0.16883116883116883, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36954440976180103
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 1 epochs
330/330 - 91s - loss: 0.0699 - accuracy: 0.6899 - 91s/epoch - 274ms/step
Validation cm: [[539  66  45  90]
 [ 29   9  15  39]
 [ 30   3  20  24]
 [ 18  24  29  59]]
Validation normalized_cm: [[0.728 0.089 0.061 0.122]
 [0.315 0.098 0.163 0.424]
 [0.39  0.039 0.26  0.312]
 [0.138 0.185 0.223 0.454]]
Validation acc: 0.6034648700673725
Validation class_accuracies: [0.7283783783783784, 0.09782608695652174, 0.2597402597402597, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38494771973032843
Validation one_indexed_epoch: 15
Epoch 15/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 2 epochs
330/330 - 90s - loss: 0.0649 - accuracy: 0.6927 - 90s/epoch - 273ms/step
Validation cm: [[532  84  58  66]
 [ 32  15  10  35]
 [ 20   6  26  25]
 [ 19  11  40  60]]
Validation normalized_cm: [[0.719 0.114 0.078 0.089]
 [0.348 0.163 0.109 0.38 ]
 [0.26  0.078 0.338 0.325]
 [0.146 0.085 0.308 0.462]]
Validation acc: 0.6092396535129933
Validation class_accuracies: [0.7189189189189189, 0.16304347826086957, 0.33766233766233766, 0.46153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.420290799095147
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 3 epochs
330/330 - 92s - loss: 0.0646 - accuracy: 0.6979 - 92s/epoch - 278ms/step
Validation cm: [[588  96  15  41]
 [ 26  40   6  20]
 [ 36   6  18  17]
 [ 30  23  53  24]]
Validation normalized_cm: [[0.795 0.13  0.02  0.055]
 [0.283 0.435 0.065 0.217]
 [0.468 0.078 0.234 0.221]
 [0.231 0.177 0.408 0.185]]
Validation acc: 0.6448508180943214
Validation class_accuracies: [0.7945945945945946, 0.43478260869565216, 0.23376623376623376, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4119397054179663
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 4 epochs
330/330 - 91s - loss: 0.0491 - accuracy: 0.6935 - 91s/epoch - 276ms/step
Validation cm: [[576  54  53  57]
 [ 33  22   7  30]
 [ 26   1  35  15]
 [ 19  12  60  39]]
Validation normalized_cm: [[0.778 0.073 0.072 0.077]
 [0.359 0.239 0.076 0.326]
 [0.338 0.013 0.455 0.195]
 [0.146 0.092 0.462 0.3  ]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.7783783783783784, 0.2391304347826087, 0.45454545454545453, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4430135669266104
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 5 epochs
330/330 - 90s - loss: 0.0420 - accuracy: 0.6878 - 90s/epoch - 273ms/step
Validation cm: [[506 132  38  64]
 [ 35  21   3  33]
 [ 25   7  21  24]
 [ 14  27  35  54]]
Validation normalized_cm: [[0.684 0.178 0.051 0.086]
 [0.38  0.228 0.033 0.359]
 [0.325 0.091 0.273 0.312]
 [0.108 0.208 0.269 0.415]]
Validation acc: 0.5794032723772858
Validation class_accuracies: [0.6837837837837838, 0.22826086956521738, 0.2727272727272727, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40003913536522234
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 6 epochs
330/330 - 90s - loss: 0.0405 - accuracy: 0.6722 - 90s/epoch - 274ms/step
Validation cm: [[542 114  26  58]
 [ 31  26   5  30]
 [ 28   4  23  22]
 [ 27  26  39  38]]
Validation normalized_cm: [[0.732 0.154 0.035 0.078]
 [0.337 0.283 0.054 0.326]
 [0.364 0.052 0.299 0.286]
 [0.208 0.2   0.3   0.292]]
Validation acc: 0.6053897978825794
Validation class_accuracies: [0.7324324324324324, 0.2826086956521739, 0.2987012987012987, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40151252977339935
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 7 epochs
330/330 - 92s - loss: 0.0401 - accuracy: 0.6720 - 92s/epoch - 280ms/step
Validation cm: [[666  19  19  36]
 [ 59   7  11  15]
 [ 34   0  28  15]
 [ 54   7  59  10]]
Validation normalized_cm: [[0.9   0.026 0.026 0.049]
 [0.641 0.076 0.12  0.163]
 [0.442 0.    0.364 0.195]
 [0.415 0.054 0.454 0.077]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.9, 0.07608695652173914, 0.36363636363636365, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35416159927029495
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 8 epochs
330/330 - 90s - loss: 0.0339 - accuracy: 0.6707 - 90s/epoch - 274ms/step
Validation cm: [[500  80  75  85]
 [ 28  13  15  36]
 [ 23   1  34  19]
 [ 22  13  47  48]]
Validation normalized_cm: [[0.676 0.108 0.101 0.115]
 [0.304 0.141 0.163 0.391]
 [0.299 0.013 0.442 0.247]
 [0.169 0.1   0.362 0.369]]
Validation acc: 0.5726660250240616
Validation class_accuracies: [0.6756756756756757, 0.14130434782608695, 0.44155844155844154, 0.36923076923076925]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4069423085727433
Validation one_indexed_epoch: 22
Epoch 22/40
The validation tracker metric at 0.4838788708353926 hasn't increased by 0 in 9 epochs
330/330 - 90s - loss: 0.0378 - accuracy: 0.6821 - 90s/epoch - 273ms/step
Validation cm: [[589  64  39  48]
 [ 38  22  10  22]
 [ 31   0  29  17]
 [ 34  11  58  27]]
Validation normalized_cm: [[0.796 0.086 0.053 0.065]
 [0.413 0.239 0.109 0.239]
 [0.403 0.    0.377 0.221]
 [0.262 0.085 0.446 0.208]]
Validation acc: 0.641963426371511
Validation class_accuracies: [0.7959459459459459, 0.2391304347826087, 0.37662337662337664, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4048480162610597
Validation one_indexed_epoch: 23
Epoch 23/40
The number of epochs since last 1% equals the patience
330/330 - 91s - loss: 0.0300 - accuracy: 0.6834 - 91s/epoch - 275ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4838788708353926
Best cm: [[450 174  43  73]
 [ 19  34   2  37]
 [ 20   6  24  27]
 [  5   8  33  84]]
Best normalized_cm: [[0.608 0.235 0.058 0.099]
 [0.207 0.37  0.022 0.402]
 [0.26  0.078 0.312 0.351]
 [0.038 0.062 0.254 0.646]]
Best acc: 0.5697786333012512
Best class_accuracies: [0.6081081081081081, 0.3695652173913043, 0.3116883116883117, 0.6461538461538462]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 13
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_mixednet_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_1 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_1 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Saving model...
330/330 - 726s - accuracy: 0.5775 - student_loss: 0.3825 - distillation_loss: 2.3970e-05 - val_accuracy: 0.9259 - val_student_loss: 0.3806 - 726s/epoch - 2s/step
Validation cm: [[220 515   2   3]
 [  3  88   0   1]
 [ 14  50   0  13]
 [  1 109   0  20]]
Validation normalized_cm: [[0.297 0.696 0.003 0.004]
 [0.033 0.957 0.    0.011]
 [0.182 0.649 0.    0.169]
 [0.008 0.838 0.    0.154]]
Validation acc: 0.3156881616939365
Validation class_accuracies: [0.2972972972972973, 0.9565217391304348, 0.0, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35191629756847154
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Saving model...
330/330 - 716s - accuracy: 0.6174 - student_loss: 0.4128 - distillation_loss: -1.3353e-03 - val_accuracy: 0.8961 - val_student_loss: 0.6018 - 716s/epoch - 2s/step
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 72   0   3   2]
 [128   0   0   2]]
Validation normalized_cm: [[1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.935 0.    0.039 0.026]
 [0.985 0.    0.    0.015]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [1.0, 0.0, 0.03896103896103896, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26358641358641355
Validation one_indexed_epoch: 3
Epoch 3/40
The validation tracker metric at 0.35191629756847154 hasn't increased by 0 in 1 epochs
330/330 - 717s - accuracy: 0.6299 - student_loss: 0.3191 - distillation_loss: -8.7014e-04 - val_accuracy: 0.7892 - val_student_loss: 0.0202 - 717s/epoch - 2s/step
Validation cm: [[552  89  76  23]
 [ 29  36  14  13]
 [ 26   3  38  10]
 [ 19   9  65  37]]
Validation normalized_cm: [[0.746 0.12  0.103 0.031]
 [0.315 0.391 0.152 0.141]
 [0.338 0.039 0.494 0.13 ]
 [0.146 0.069 0.5   0.285]]
Validation acc: 0.6381135707410972
Validation class_accuracies: [0.745945945945946, 0.391304347826087, 0.4935064935064935, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4788430429734778
Validation one_indexed_epoch: 4
Epoch 4/40
-- New best results were achieved. --
Saving model...
330/330 - 716s - accuracy: 0.6339 - student_loss: 0.2330 - distillation_loss: 0.0026 - val_accuracy: 0.4658 - val_student_loss: 1.9159 - 716s/epoch - 2s/step
Validation cm: [[666  52  16   6]
 [ 50  23  12   7]
 [ 56   4  16   1]
 [ 39   5  56  30]]
Validation normalized_cm: [[0.9   0.07  0.022 0.008]
 [0.543 0.25  0.13  0.076]
 [0.727 0.052 0.208 0.013]
 [0.3   0.038 0.431 0.231]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.9, 0.25, 0.2077922077922078, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39714035964035965
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 1 epochs
330/330 - 716s - accuracy: 0.6650 - student_loss: 0.3355 - distillation_loss: -6.5341e-03 - val_accuracy: 0.6747 - val_student_loss: 0.2725 - 716s/epoch - 2s/step
Validation cm: [[571 162   5   2]
 [ 21  60   3   8]
 [ 46  14   6  11]
 [ 21  36  33  40]]
Validation normalized_cm: [[0.772 0.219 0.007 0.003]
 [0.228 0.652 0.033 0.087]
 [0.597 0.182 0.078 0.143]
 [0.162 0.277 0.254 0.308]]
Validation acc: 0.6515880654475458
Validation class_accuracies: [0.7716216216216216, 0.6521739130434783, 0.07792207792207792, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4523524800698714
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 2 epochs
330/330 - 717s - accuracy: 0.6415 - student_loss: 0.5534 - distillation_loss: 8.1600e-04 - val_accuracy: 0.7459 - val_student_loss: 0.7011 - 717s/epoch - 2s/step
Validation cm: [[452  33 159  96]
 [  8   3  34  47]
 [ 17   1  38  21]
 [ 10   1  57  62]]
Validation normalized_cm: [[0.611 0.045 0.215 0.13 ]
 [0.087 0.033 0.37  0.511]
 [0.221 0.013 0.494 0.273]
 [0.077 0.008 0.438 0.477]]
Validation acc: 0.534167468719923
Validation class_accuracies: [0.6108108108108108, 0.03260869565217391, 0.4935064935064935, 0.47692307692307695]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4034622692231388
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 3 epochs
330/330 - 717s - accuracy: 0.6643 - student_loss: 0.6128 - distillation_loss: -5.6916e-04 - val_accuracy: 0.2676 - val_student_loss: 2.2046 - 717s/epoch - 2s/step
Validation cm: [[577  50  87  26]
 [ 42  19  19  12]
 [ 31   1  43   2]
 [ 36   5  59  30]]
Validation normalized_cm: [[0.78  0.068 0.118 0.035]
 [0.457 0.207 0.207 0.13 ]
 [0.403 0.013 0.558 0.026]
 [0.277 0.038 0.454 0.231]]
Validation acc: 0.643888354186718
Validation class_accuracies: [0.7797297297297298, 0.20652173913043478, 0.5584415584415584, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44386556451773845
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 4 epochs
330/330 - 637s - accuracy: 0.6487 - student_loss: 0.0561 - distillation_loss: -1.9112e-03 - val_accuracy: 0.3474 - val_student_loss: 0.7938 - 637s/epoch - 2s/step
Validation cm: [[610  57  57  16]
 [ 49  25  10   8]
 [ 32   8  32   5]
 [ 36  17  45  32]]
Validation normalized_cm: [[0.824 0.077 0.077 0.022]
 [0.533 0.272 0.109 0.087]
 [0.416 0.104 0.416 0.065]
 [0.277 0.131 0.346 0.246]]
Validation acc: 0.6727622714148219
Validation class_accuracies: [0.8243243243243243, 0.2717391304347826, 0.4155844155844156, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4394504291243422
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 5 epochs
330/330 - 632s - accuracy: 0.6584 - student_loss: 0.2158 - distillation_loss: 0.0019 - val_accuracy: 0.4216 - val_student_loss: 1.2006 - 632s/epoch - 2s/step
Validation cm: [[517 176  24  23]
 [ 24  41  10  17]
 [ 25  11  19  22]
 [ 14  10  46  60]]
Validation normalized_cm: [[0.699 0.238 0.032 0.031]
 [0.261 0.446 0.109 0.185]
 [0.325 0.143 0.247 0.286]
 [0.108 0.077 0.354 0.462]]
Validation acc: 0.6130895091434071
Validation class_accuracies: [0.6986486486486486, 0.44565217391304346, 0.24675324675324675, 0.46153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4631481327133501
Validation one_indexed_epoch: 10
Epoch 10/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 6 epochs
330/330 - 634s - accuracy: 0.6578 - student_loss: 0.0698 - distillation_loss: -1.7704e-03 - val_accuracy: 0.7440 - val_student_loss: 1.5433 - 634s/epoch - 2s/step
Validation cm: [[690   4  43   3]
 [ 73   4  13   2]
 [ 51   1  21   4]
 [ 58   8  44  20]]
Validation normalized_cm: [[0.932 0.005 0.058 0.004]
 [0.793 0.043 0.141 0.022]
 [0.662 0.013 0.273 0.052]
 [0.446 0.062 0.338 0.154]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.9324324324324325, 0.043478260869565216, 0.2727272727272727, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.350621029968856
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 7 epochs
330/330 - 633s - accuracy: 0.6673 - student_loss: 0.0906 - distillation_loss: 0.0022 - val_accuracy: 0.3099 - val_student_loss: 0.8825 - 633s/epoch - 2s/step
Validation cm: [[720   8  10   2]
 [ 89   0   1   2]
 [ 58   0  15   4]
 [ 99   9  17   5]]
Validation normalized_cm: [[0.973 0.011 0.014 0.003]
 [0.967 0.    0.011 0.022]
 [0.753 0.    0.195 0.052]
 [0.762 0.069 0.131 0.038]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.972972972972973, 0.0, 0.19480519480519481, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3015599265599266
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 8 epochs
330/330 - 634s - accuracy: 0.6460 - student_loss: 0.3293 - distillation_loss: -7.1870e-03 - val_accuracy: 0.4533 - val_student_loss: 0.0487 - 634s/epoch - 2s/step
Validation cm: [[537 183   7  13]
 [ 18  57  10   7]
 [ 40  22   6   9]
 [ 23  43  25  39]]
Validation normalized_cm: [[0.726 0.247 0.009 0.018]
 [0.196 0.62  0.109 0.076]
 [0.519 0.286 0.078 0.117]
 [0.177 0.331 0.192 0.3  ]]
Validation acc: 0.615014436958614
Validation class_accuracies: [0.7256756756756757, 0.6195652173913043, 0.07792207792207792, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4307907427472645
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.4788430429734778 hasn't increased by 0 in 9 epochs
330/330 - 635s - accuracy: 0.6626 - student_loss: 0.0577 - distillation_loss: 0.0018 - val_accuracy: 0.8316 - val_student_loss: 0.1099 - 635s/epoch - 2s/step
Validation cm: [[462  32 207  39]
 [ 37  10  34  11]
 [ 20   5  36  16]
 [ 23   8  53  46]]
Validation normalized_cm: [[0.624 0.043 0.28  0.053]
 [0.402 0.109 0.37  0.12 ]
 [0.26  0.065 0.468 0.208]
 [0.177 0.062 0.408 0.354]]
Validation acc: 0.5332050048123196
Validation class_accuracies: [0.6243243243243243, 0.10869565217391304, 0.4675324675324675, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3885996494692147
Validation one_indexed_epoch: 14
Epoch 14/40
The number of epochs since last 1% equals the patience
330/330 - 633s - accuracy: 0.6430 - student_loss: 0.0306 - distillation_loss: -1.2630e-03 - val_accuracy: 0.2733 - val_student_loss: 3.0449 - 633s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4788430429734778
Best cm: [[552  89  76  23]
 [ 29  36  14  13]
 [ 26   3  38  10]
 [ 19   9  65  37]]
Best normalized_cm: [[0.746 0.12  0.103 0.031]
 [0.315 0.391 0.152 0.141]
 [0.338 0.039 0.494 0.13 ]
 [0.146 0.069 0.5   0.285]]
Best acc: 0.6381135707410972
Best class_accuracies: [0.745945945945946, 0.391304347826087, 0.4935064935064935, 0.2846153846153846]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 4
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
