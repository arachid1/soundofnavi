Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train16
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    280              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,232
Trainable params: 105,456
Non-trainable params: 776
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 464s - loss: 0.4519 - accuracy: 0.5813 - 464s/epoch - 1s/step
Validation cm: [[656  69  13   2]
 [ 51  28   3  10]
 [ 44   5  20   8]
 [ 64  11  38  17]]
Validation normalized_cm: [[0.886 0.093 0.018 0.003]
 [0.554 0.304 0.033 0.109]
 [0.571 0.065 0.26  0.104]
 [0.492 0.085 0.292 0.131]]
Validation acc: 0.6939364773820982
Validation class_accuracies: [0.8864864864864865, 0.30434782608695654, 0.2597402597402597, 0.13076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39533595077073336
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 456s - loss: 0.3578 - accuracy: 0.6248 - 456s/epoch - 1s/step
Validation cm: [[675  34  16  15]
 [ 52  22   6  12]
 [ 36   6  31   4]
 [ 35   7  78  10]]
Validation normalized_cm: [[0.912 0.046 0.022 0.02 ]
 [0.565 0.239 0.065 0.13 ]
 [0.468 0.078 0.403 0.052]
 [0.269 0.054 0.6   0.077]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.9121621621621622, 0.2391304347826087, 0.4025974025974026, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4077032691163126
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 462s - loss: 0.3234 - accuracy: 0.6487 - 462s/epoch - 1s/step
Validation cm: [[699  23  12   6]
 [ 56  18   5  13]
 [ 57   2  17   1]
 [ 52   3  66   9]]
Validation normalized_cm: [[0.945 0.031 0.016 0.008]
 [0.609 0.196 0.054 0.141]
 [0.74  0.026 0.221 0.013]
 [0.4   0.023 0.508 0.069]]
Validation acc: 0.7151106833493744
Validation class_accuracies: [0.9445945945945946, 0.1956521739130435, 0.22077922077922077, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.357564189629407
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
The validation tracker metric at 0.4077032691163126 hasn't increased by 0 in 1 epochs
330/330 - 461s - loss: 0.2889 - accuracy: 0.6409 - 461s/epoch - 1s/step
Validation cm: [[652  42  16  30]
 [ 40  26   5  21]
 [ 31   7  28  11]
 [ 40   5  53  32]]
Validation normalized_cm: [[0.881 0.057 0.022 0.041]
 [0.435 0.283 0.054 0.228]
 [0.403 0.091 0.364 0.143]
 [0.308 0.038 0.408 0.246]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8810810810810811, 0.2826086956521739, 0.36363636363636365, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4433699966308662
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 453s - loss: 0.2636 - accuracy: 0.6276 - 453s/epoch - 1s/step
Validation cm: [[628 104   3   5]
 [ 30  49   0  13]
 [ 53   5  16   3]
 [ 67  21  23  19]]
Validation normalized_cm: [[0.849 0.141 0.004 0.007]
 [0.326 0.533 0.    0.141]
 [0.688 0.065 0.208 0.039]
 [0.515 0.162 0.177 0.146]]
Validation acc: 0.685274302213667
Validation class_accuracies: [0.8486486486486486, 0.532608695652174, 0.2077922077922078, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43380084956171916
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.4433699966308662 hasn't increased by 0 in 1 epochs
330/330 - 465s - loss: 0.2323 - accuracy: 0.6329 - 465s/epoch - 1s/step
Validation cm: [[637  69  28   6]
 [ 47  32   4   9]
 [ 29   5  39   4]
 [ 46  15  39  30]]
Validation normalized_cm: [[0.861 0.093 0.038 0.008]
 [0.511 0.348 0.043 0.098]
 [0.377 0.065 0.506 0.052]
 [0.354 0.115 0.3   0.231]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8608108108108108, 0.34782608695652173, 0.5064935064935064, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4864749087575174
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 456s - loss: 0.2029 - accuracy: 0.6694 - 456s/epoch - 1s/step
Validation cm: [[661  49  15  15]
 [ 38  32   6  16]
 [ 37   4  28   8]
 [ 30   8  53  39]]
Validation normalized_cm: [[0.893 0.066 0.02  0.02 ]
 [0.413 0.348 0.065 0.174]
 [0.481 0.052 0.364 0.104]
 [0.231 0.062 0.408 0.3  ]]
Validation acc: 0.7314725697786333
Validation class_accuracies: [0.8932432432432432, 0.34782608695652173, 0.36363636363636365, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47617642345903216
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The validation tracker metric at 0.4864749087575174 hasn't increased by 0 in 1 epochs
330/330 - 458s - loss: 0.1773 - accuracy: 0.6684 - 458s/epoch - 1s/step
Validation cm: [[579 109  43   9]
 [ 23  42   7  20]
 [ 19   6  42  10]
 [ 19  17  48  46]]
Validation normalized_cm: [[0.782 0.147 0.058 0.012]
 [0.25  0.457 0.076 0.217]
 [0.247 0.078 0.545 0.13 ]
 [0.146 0.131 0.369 0.354]]
Validation acc: 0.6823869104908566
Validation class_accuracies: [0.7824324324324324, 0.45652173913043476, 0.5454545454545454, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5345637177158916
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 463s - loss: 0.1551 - accuracy: 0.6512 - 463s/epoch - 1s/step
Validation cm: [[557  98  70  15]
 [ 32  42   2  16]
 [ 21   4  42  10]
 [ 25  15  67  23]]
Validation normalized_cm: [[0.753 0.132 0.095 0.02 ]
 [0.348 0.457 0.022 0.174]
 [0.273 0.052 0.545 0.13 ]
 [0.192 0.115 0.515 0.177]]
Validation acc: 0.6390760346487007
Validation class_accuracies: [0.7527027027027027, 0.45652173913043476, 0.5454545454545454, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48290051605268997
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 1 epochs
330/330 - 455s - loss: 0.1266 - accuracy: 0.6641 - 455s/epoch - 1s/step
Validation cm: [[682  49   7   2]
 [ 54  28   1   9]
 [ 47   6  19   5]
 [ 62   8  41  19]]
Validation normalized_cm: [[0.922 0.066 0.009 0.003]
 [0.587 0.304 0.011 0.098]
 [0.61  0.078 0.247 0.065]
 [0.477 0.062 0.315 0.146]]
Validation acc: 0.7199230028873917
Validation class_accuracies: [0.9216216216216216, 0.30434782608695654, 0.24675324675324675, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4047191351539178
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 2 epochs
330/330 - 462s - loss: 0.1138 - accuracy: 0.6681 - 462s/epoch - 1s/step
Validation cm: [[630 104   6   0]
 [ 39  49   1   3]
 [ 45   7  23   2]
 [ 40  34  30  26]]
Validation normalized_cm: [[0.851 0.141 0.008 0.   ]
 [0.424 0.533 0.011 0.033]
 [0.584 0.091 0.299 0.026]
 [0.308 0.262 0.231 0.2  ]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8513513513513513, 0.532608695652174, 0.2987012987012987, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47066533642620595
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 3 epochs
Lr has been adjusted to 0.0005000000237487257
330/330 - 465s - loss: 0.0974 - accuracy: 0.6595 - 465s/epoch - 1s/step
Validation cm: [[670  35  25  10]
 [ 48  21   8  15]
 [ 32   4  37   4]
 [ 29   9  57  35]]
Validation normalized_cm: [[0.905 0.047 0.034 0.014]
 [0.522 0.228 0.087 0.163]
 [0.416 0.052 0.481 0.052]
 [0.223 0.069 0.438 0.269]]
Validation acc: 0.7343599615014437
Validation class_accuracies: [0.9054054054054054, 0.22826086956521738, 0.4805194805194805, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4708541311802181
Validation one_indexed_epoch: 13
Epoch 13/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 4 epochs
330/330 - 460s - loss: 0.0602 - accuracy: 0.6552 - 460s/epoch - 1s/step
Validation cm: [[686  40  11   3]
 [ 51  26  10   5]
 [ 40   7  29   1]
 [ 41   4  57  28]]
Validation normalized_cm: [[0.927 0.054 0.015 0.004]
 [0.554 0.283 0.109 0.054]
 [0.519 0.091 0.377 0.013]
 [0.315 0.031 0.438 0.215]]
Validation acc: 0.7401347449470644
Validation class_accuracies: [0.927027027027027, 0.2826086956521739, 0.37662337662337664, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4504109286717982
Validation one_indexed_epoch: 14
Epoch 14/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 5 epochs
330/330 - 473s - loss: 0.0410 - accuracy: 0.6571 - 473s/epoch - 1s/step
Validation cm: [[661  66   8   5]
 [ 45  31   1  15]
 [ 44   5  24   4]
 [ 44  12  45  29]]
Validation normalized_cm: [[0.893 0.089 0.011 0.007]
 [0.489 0.337 0.011 0.163]
 [0.571 0.065 0.312 0.052]
 [0.338 0.092 0.346 0.223]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [0.8932432432432432, 0.33695652173913043, 0.3116883116883117, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44124124993690217
Validation one_indexed_epoch: 15
Epoch 15/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
Lr has been adjusted to 0.0002500000118743628
330/330 - 462s - loss: 0.0447 - accuracy: 0.6580 - 462s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5345637177158916
Best cm: [[579 109  43   9]
 [ 23  42   7  20]
 [ 19   6  42  10]
 [ 19  17  48  46]]
Best normalized_cm: [[0.782 0.147 0.058 0.012]
 [0.25  0.457 0.076 0.217]
 [0.247 0.078 0.545 0.13 ]
 [0.146 0.131 0.369 0.354]]
Best acc: 0.6823869104908566
Best class_accuracies: [0.7824324324324324, 0.45652173913043476, 0.5454545454545454, 0.35384615384615387]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 9
Validation cm: [[652  63  17   8]
 [ 40  27   5  20]
 [ 35   6  31   5]
 [ 34  12  54  30]]
Validation normalized_cm: [[0.881 0.085 0.023 0.011]
 [0.435 0.293 0.054 0.217]
 [0.455 0.078 0.403 0.065]
 [0.262 0.092 0.415 0.231]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.8810810810810811, 0.29347826086956524, 0.4025974025974026, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45198149382931996
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 7 epochs
330/330 - 760s - loss: 0.0189 - accuracy: 0.6413 - 760s/epoch - 2s/step
Validation cm: [[652  57  23   8]
 [ 44  26   3  19]
 [ 33   6  33   5]
 [ 31  11  58  30]]
Validation normalized_cm: [[0.881 0.077 0.031 0.011]
 [0.478 0.283 0.033 0.207]
 [0.429 0.078 0.429 0.065]
 [0.238 0.085 0.446 0.231]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.8810810810810811, 0.2826086956521739, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4557576090184786
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 8 epochs
330/330 - 743s - loss: 0.0173 - accuracy: 0.6400 - 743s/epoch - 2s/step
Validation cm: [[646  65  21   8]
 [ 41  27   5  19]
 [ 34   6  32   5]
 [ 31   9  59  31]]
Validation normalized_cm: [[0.873 0.088 0.028 0.011]
 [0.446 0.293 0.054 0.207]
 [0.442 0.078 0.416 0.065]
 [0.238 0.069 0.454 0.238]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.8729729729729729, 0.29347826086956524, 0.4155844155844156, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4551242969721231
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 9 epochs
Lr has been adjusted to 0.0001250000059371814
330/330 - 745s - loss: 0.0167 - accuracy: 0.6436 - 745s/epoch - 2s/step
Validation cm: [[650  62  20   8]
 [ 40  28   5  19]
 [ 34   6  32   5]
 [ 33  10  57  30]]
Validation normalized_cm: [[0.878 0.084 0.027 0.011]
 [0.435 0.304 0.054 0.207]
 [0.442 0.078 0.416 0.065]
 [0.254 0.077 0.438 0.231]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.8783783783783784, 0.30434782608695654, 0.4155844155844156, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4572699627047454
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 10 epochs
330/330 - 735s - loss: 0.0161 - accuracy: 0.6400 - 735s/epoch - 2s/step
Validation cm: [[651  62  19   8]
 [ 40  27   6  19]
 [ 33   6  33   5]
 [ 33  10  56  31]]
Validation normalized_cm: [[0.88  0.084 0.026 0.011]
 [0.435 0.293 0.065 0.207]
 [0.429 0.078 0.429 0.065]
 [0.254 0.077 0.431 0.238]]
Validation acc: 0.714148219441771
Validation class_accuracies: [0.8797297297297297, 0.29347826086956524, 0.42857142857142855, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4600602394080655
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 11 epochs
330/330 - 736s - loss: 0.0159 - accuracy: 0.6453 - 736s/epoch - 2s/step
Validation cm: [[648  67  17   8]
 [ 41  28   4  19]
 [ 34   6  32   5]
 [ 35  12  54  29]]
Validation normalized_cm: [[0.876 0.091 0.023 0.011]
 [0.446 0.304 0.043 0.207]
 [0.442 0.078 0.416 0.065]
 [0.269 0.092 0.415 0.223]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.8756756756756757, 0.30434782608695654, 0.4155844155844156, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45467121010599276
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 6.25000029685907e-05
330/330 - 739s - loss: 0.0159 - accuracy: 0.6413 - 739s/epoch - 2s/step
Validation cm: [[646  66  20   8]
 [ 39  27   6  20]
 [ 32   6  34   5]
 [ 29  10  61  30]]
Validation normalized_cm: [[0.873 0.089 0.027 0.011]
 [0.424 0.293 0.065 0.217]
 [0.416 0.078 0.442 0.065]
 [0.223 0.077 0.469 0.231]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.8729729729729729, 0.29347826086956524, 0.44155844155844154, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4596947265425526
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 13 epochs
330/330 - 733s - loss: 0.0157 - accuracy: 0.6476 - 733s/epoch - 2s/step
Validation cm: [[646  66  20   8]
 [ 40  27   6  19]
 [ 33   6  33   5]
 [ 31  11  58  30]]
Validation normalized_cm: [[0.873 0.089 0.027 0.011]
 [0.435 0.293 0.065 0.207]
 [0.429 0.078 0.429 0.065]
 [0.238 0.085 0.446 0.231]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.8729729729729729, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4564479732957994
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 14 epochs
330/330 - 740s - loss: 0.0156 - accuracy: 0.6396 - 740s/epoch - 2s/step
Validation cm: [[649  64  19   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 31  12  58  29]]
Validation normalized_cm: [[0.877 0.086 0.026 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.238 0.092 0.446 0.223]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8770270270270271, 0.29347826086956524, 0.42857142857142855, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.455538409886236
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 3.125000148429535e-05
330/330 - 735s - loss: 0.0156 - accuracy: 0.6466 - 735s/epoch - 2s/step
Validation cm: [[649  63  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 30  10  60  30]]
Validation normalized_cm: [[0.877 0.085 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.231 0.077 0.462 0.231]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.8770270270270271, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4574614868093129
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 16 epochs
330/330 - 740s - loss: 0.0155 - accuracy: 0.6468 - 740s/epoch - 2s/step
Validation cm: [[647  65  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 30  11  59  30]]
Validation normalized_cm: [[0.874 0.088 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.231 0.085 0.454 0.231]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.8743243243243243, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45678581113363725
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 17 epochs
330/330 - 740s - loss: 0.0154 - accuracy: 0.6411 - 740s/epoch - 2s/step
Validation cm: [[647  64  21   8]
 [ 39  27   6  20]
 [ 34   6  32   5]
 [ 28  10  62  30]]
Validation normalized_cm: [[0.874 0.086 0.028 0.011]
 [0.424 0.293 0.065 0.217]
 [0.442 0.078 0.416 0.065]
 [0.215 0.077 0.477 0.231]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.8743243243243243, 0.29347826086956524, 0.4155844155844156, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.453539057886884
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.5625000742147677e-05
330/330 - 735s - loss: 0.0154 - accuracy: 0.6457 - 735s/epoch - 2s/step
Validation cm: [[648  64  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 29  11  60  30]]
Validation normalized_cm: [[0.876 0.086 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.223 0.085 0.462 0.231]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8756756756756757, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4571236489714751
Validation one_indexed_epoch: 13
Epoch 13/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 19 epochs
330/330 - 670s - loss: 0.0154 - accuracy: 0.6398 - 670s/epoch - 2s/step
Validation cm: [[648  64  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 30  10  60  30]]
Validation normalized_cm: [[0.876 0.086 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.231 0.077 0.462 0.231]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8756756756756757, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4571236489714751
Validation one_indexed_epoch: 14
Epoch 14/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 20 epochs
330/330 - 630s - loss: 0.0154 - accuracy: 0.6466 - 630s/epoch - 2s/step
Validation cm: [[649  63  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 30  11  59  30]]
Validation normalized_cm: [[0.877 0.085 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.231 0.085 0.454 0.231]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.8770270270270271, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4574614868093129
Validation one_indexed_epoch: 15
Epoch 15/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 21 epochs
Lr has been adjusted to 7.812500371073838e-06
330/330 - 632s - loss: 0.0154 - accuracy: 0.6411 - 632s/epoch - 2s/step
Validation cm: [[649  63  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 30  11  59  30]]
Validation normalized_cm: [[0.877 0.085 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.231 0.085 0.454 0.231]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.8770270270270271, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4574614868093129
Validation one_indexed_epoch: 16
Epoch 16/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 22 epochs
330/330 - 631s - loss: 0.0153 - accuracy: 0.6459 - 631s/epoch - 2s/step
Validation cm: [[648  64  20   8]
 [ 40  27   5  20]
 [ 33   6  33   5]
 [ 29  11  60  30]]
Validation normalized_cm: [[0.876 0.086 0.027 0.011]
 [0.435 0.293 0.054 0.217]
 [0.429 0.078 0.429 0.065]
 [0.223 0.085 0.462 0.231]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8756756756756757, 0.29347826086956524, 0.42857142857142855, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4571236489714751
Validation one_indexed_epoch: 17
Epoch 17/17
[[0. 0.]]
The validation tracker metric at 0.5345637177158916 hasn't increased by 0 in 23 epochs
330/330 - 648s - loss: 0.0153 - accuracy: 0.6462 - 648s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5345637177158916
Best cm: [[579 109  43   9]
 [ 23  42   7  20]
 [ 19   6  42  10]
 [ 19  17  48  46]]
Best normalized_cm: [[0.782 0.147 0.058 0.012]
 [0.25  0.457 0.076 0.217]
 [0.247 0.078 0.545 0.13 ]
 [0.146 0.131 0.369 0.354]]
Best acc: 0.6823869104908566
Best class_accuracies: [0.7824324324324324, 0.45652173913043476, 0.5454545454545454, 0.35384615384615387]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 9
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
