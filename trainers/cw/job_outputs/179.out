Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train179
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
training parameters
[('cache_root', '../cache/'), ('data_root', '../data/'), ('jordan_root', '../data/jwyy9np4gv-3/'), ('icbhi_root', '../data/raw_audios/icbhi_preprocessed_v2_cleaned_8000/'), ('bd_root', '../data/PCV_SEGMENTED_Processed_Files/'), ('excel_path', '../data/Bangladesh_PCV_onlyStudyPatients.xlsx'), ('perch_root', '../data/raw_audios/perch_8000_10seconds'), ('ant_root', '../data/raw_audios/Antwerp_Clinical_Complete'), ('description', ' effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,'), ('job_id', 0), ('mode', 'cw'), ('n_classes', 2), ('shape', (80, 500, 3)), ('n_epochs', 110), ('lr', 0.001), ('batch_size', 16), ('ll2_reg', 0), ('weight_decay', 0.01), ('label_smoothing', 0), ('epsilon', 1e-07), ('es_patience', 25), ('min_delta', 0), ('train_test_ratio', 0.8), ('kfold', False), ('clause', 0), ('epoch_start', 0), ('testing', 0), ('adaptive_lr', False), ('cuberooting', 1), ('normalizing', 1), ('class_weights', True), ('early_stopping', True), ('initial_channels', 1), ('factor', 0.5), ('lr_patience', 5), ('min_lr', 1e-05), ('sr', 4000), ('audio_length', 5), ('step_size', 2.5), ('n_fft', 1024), ('hop_length', 254), ('n_mels', 128), ('overlap_threshold', 0.3), ('trainable_fb', False), ('to_decibel', True), ('train_nn', False), ('train_mel', False), ('file_dir', '../cache/cw/train179'), ('n_sequences', 9), ('activate_spectral_loss', False), ('normalize', False), ('stacking', False), ('oversample', False), ('one_hot_encoding', False), ('activation', 'sigmoid'), ('n_filters', 80)]
Job id is 1.
Job dir: ../cache/cw/train179/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
turning the kfold from 90/10 to 80/20
100
12
to
90
22
-----------------------
--- Final training dataset went from 0 to 3969 elements, with 1889 none's, 991 crakles, 597 wheezes and 492 both ---
--- Final Validation dataset contains 2096 elements, with 989 none, 843 crackles, 120 wheezes and 144 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5252779248279513, 1: 1.0012613521695257, 2: 1.6620603015075377, 3: 2.0167682926829267}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 reshape (Reshape)           (None, 16, 6144)          0         
                                                                 
 bidirectional (Bidirectiona  (None, 16, 256)          6423552   
 l)                                                              
                                                                 
 bidirectional_1 (Bidirectio  (None, 16, 256)          394240    
 nal)                                                            
                                                                 
 dense (Dense)               (None, 16, 256)           65792     
                                                                 
 dropout (Dropout)           (None, 16, 256)           0         
                                                                 
 flatten (Flatten)           (None, 4096)              0         
                                                                 
 dense_1 (Dense)             (None, 2)                 8194      
                                                                 
=================================================================
Total params: 30,479,490
Trainable params: 30,426,370
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_174_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   30479490         
                                                                                                              
==============================================================================================================
Total params: 30,479,652
Trainable params: 6,891,940
Non-trainable params: 23,587,712
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[252 430 109 198]
 [ 92 587  41 123]
 [ 12  62  15  31]
 [ 15  98  13  18]]
Validation val_loss: 0.6519729910944482
Validation normalized_cm: [[0.255 0.435 0.11  0.2  ]
 [0.109 0.696 0.049 0.146]
 [0.1   0.517 0.125 0.258]
 [0.104 0.681 0.09  0.125]]
Validation acc: 0.41603053435114506
Validation class_accuracies: [0.25480283114256824, 0.6963226571767497, 0.125, 0.125]
Validation sensitivity: 0.5600722673893406
Validation specificity: 0.25480283114256824
Validation icbhi_score: 0.40743754926595444
Validation roc_auc: None
Validation avg_accuracy: 0.30028137207982947
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
249/249 - 163s - loss: 0.6738 - accuracy: 0.5430 - 163s/epoch - 654ms/step
Epoch 2/110
Validation cm: [[242 443  53 251]
 [ 77 583   9 174]
 [  5  47  11  57]
 [  9  93   8  34]]
Validation val_loss: 0.649898182501206
Validation normalized_cm: [[0.245 0.448 0.054 0.254]
 [0.091 0.692 0.011 0.206]
 [0.042 0.392 0.092 0.475]
 [0.062 0.646 0.056 0.236]]
Validation acc: 0.4150763358778626
Validation class_accuracies: [0.24469160768452983, 0.6915776986951364, 0.09166666666666666, 0.2361111111111111]
Validation sensitivity: 0.5672990063233966
Validation specificity: 0.24469160768452983
Validation icbhi_score: 0.4059953070039632
Validation roc_auc: None
Validation avg_accuracy: 0.316011771039361
Validation one_indexed_epoch: 2
The validation tracker metric at 0.40743754926595444 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 144s - loss: 0.6290 - accuracy: 0.6143 - 144s/epoch - 579ms/step
Epoch 3/110
Validation cm: [[214 535  47 193]
 [ 46 660   9 128]
 [  3  59   8  50]
 [  4  93   4  43]]
Validation val_loss: 0.6260669223665623
Validation normalized_cm: [[0.216 0.541 0.048 0.195]
 [0.055 0.783 0.011 0.152]
 [0.025 0.492 0.067 0.417]
 [0.028 0.646 0.028 0.299]]
Validation acc: 0.4413167938931298
Validation class_accuracies: [0.21638018200202225, 0.7829181494661922, 0.06666666666666667, 0.2986111111111111]
Validation sensitivity: 0.6422764227642277
Validation specificity: 0.21638018200202225
Validation icbhi_score: 0.42932830238312497
Validation roc_auc: None
Validation avg_accuracy: 0.34114402731149807
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
249/249 - 149s - loss: 0.5923 - accuracy: 0.6435 - 149s/epoch - 599ms/step
Epoch 4/110
Validation cm: [[250 303 199 237]
 [ 84 444  70 245]
 [  8  24  35  53]
 [ 11  51  38  44]]
Validation val_loss: 0.6860161740119561
Validation normalized_cm: [[0.253 0.306 0.201 0.24 ]
 [0.1   0.527 0.083 0.291]
 [0.067 0.2   0.292 0.442]
 [0.076 0.354 0.264 0.306]]
Validation acc: 0.3687977099236641
Validation class_accuracies: [0.2527805864509606, 0.5266903914590747, 0.2916666666666667, 0.3055555555555556]
Validation sensitivity: 0.47244805781391147
Validation specificity: 0.2527805864509606
Validation icbhi_score: 0.36261432213243605
Validation roc_auc: None
Validation avg_accuracy: 0.3441733000330644
Validation one_indexed_epoch: 4
The validation tracker metric at 0.42932830238312497 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 149s - loss: 0.5707 - accuracy: 0.6662 - 149s/epoch - 600ms/step
Epoch 5/110
Validation cm: [[264 231 290 204]
 [131 394 115 203]
 [ 11  14  69  26]
 [ 23  49  40  32]]
Validation val_loss: 0.7303504924368085
Validation normalized_cm: [[0.267 0.234 0.293 0.206]
 [0.155 0.467 0.136 0.241]
 [0.092 0.117 0.575 0.217]
 [0.16  0.34  0.278 0.222]]
Validation acc: 0.36211832061068705
Validation class_accuracies: [0.26693629929221435, 0.46737841043890865, 0.575, 0.2222222222222222]
Validation sensitivity: 0.44715447154471544
Validation specificity: 0.26693629929221435
Validation icbhi_score: 0.35704538541846487
Validation roc_auc: None
Validation avg_accuracy: 0.3828842329883363
Validation one_indexed_epoch: 5
The validation tracker metric at 0.42932830238312497 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 149s - loss: 0.5510 - accuracy: 0.6644 - 149s/epoch - 597ms/step
Epoch 6/110
Validation cm: [[150  97 580 162]
 [ 76 195 327 245]
 [  6   7  99   8]
 [  2  15  98  29]]
Validation val_loss: 0.9326907263052088
Validation normalized_cm: [[0.152 0.098 0.586 0.164]
 [0.09  0.231 0.388 0.291]
 [0.05  0.058 0.825 0.067]
 [0.014 0.104 0.681 0.201]]
Validation acc: 0.22566793893129772
Validation class_accuracies: [0.15166835187057634, 0.2313167259786477, 0.825, 0.2013888888888889]
Validation sensitivity: 0.2917795844625113
Validation specificity: 0.15166835187057634
Validation icbhi_score: 0.22172396816654383
Validation roc_auc: None
Validation avg_accuracy: 0.3523434916845282
Validation one_indexed_epoch: 6
The validation tracker metric at 0.42932830238312497 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 146s - loss: 0.5293 - accuracy: 0.6956 - 146s/epoch - 587ms/step
Epoch 7/110
Validation cm: [[541 294  87  67]
 [280 490  32  41]
 [ 46  30  39   5]
 [ 55  74  14   1]]
Validation val_loss: 0.5619567416302632
Validation normalized_cm: [[0.547 0.297 0.088 0.068]
 [0.332 0.581 0.038 0.049]
 [0.383 0.25  0.325 0.042]
 [0.382 0.514 0.097 0.007]]
Validation acc: 0.5109732824427481
Validation class_accuracies: [0.5470171890798786, 0.5812574139976275, 0.325, 0.006944444444444444]
Validation sensitivity: 0.4787714543812105
Validation specificity: 0.5470171890798786
Validation icbhi_score: 0.5128943217305446
Validation roc_auc: None
Validation avg_accuracy: 0.36505476188048763
Validation one_indexed_epoch: 7
-- New best results were achieved. --
There is no such attribute
249/249 - 146s - loss: 0.5383 - accuracy: 0.6772 - 146s/epoch - 586ms/step
Epoch 8/110
Validation cm: [[304 440  67 178]
 [ 94 566  28 155]
 [ 15  39  20  46]
 [ 16  74  18  36]]
Validation val_loss: 0.6466734494573174
Validation normalized_cm: [[0.307 0.445 0.068 0.18 ]
 [0.112 0.671 0.033 0.184]
 [0.125 0.325 0.167 0.383]
 [0.111 0.514 0.125 0.25 ]]
Validation acc: 0.44179389312977096
Validation class_accuracies: [0.30738119312436807, 0.6714116251482799, 0.16666666666666666, 0.25]
Validation sensitivity: 0.5618789521228545
Validation specificity: 0.30738119312436807
Validation icbhi_score: 0.4346300726236113
Validation roc_auc: None
Validation avg_accuracy: 0.3488648712348287
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5128943217305446 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 148s - loss: 0.5095 - accuracy: 0.7042 - 148s/epoch - 596ms/step
Epoch 9/110
Validation cm: [[291 196 309 193]
 [122 303 193 225]
 [ 13  12  59  36]
 [ 16  25  74  29]]
Validation val_loss: 0.8214503795207115
Validation normalized_cm: [[0.294 0.198 0.312 0.195]
 [0.145 0.359 0.229 0.267]
 [0.108 0.1   0.492 0.3  ]
 [0.111 0.174 0.514 0.201]]
Validation acc: 0.32538167938931295
Validation class_accuracies: [0.2942366026289181, 0.3594306049822064, 0.49166666666666664, 0.2013888888888889]
Validation sensitivity: 0.35320686540198737
Validation specificity: 0.2942366026289181
Validation icbhi_score: 0.32372173401545273
Validation roc_auc: None
Validation avg_accuracy: 0.33668069079167
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5128943217305446 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 149s - loss: 0.4854 - accuracy: 0.7166 - 149s/epoch - 599ms/step
Epoch 10/110
Validation cm: [[317 390  99 183]
 [117 500  70 156]
 [ 10  39  39  32]
 [ 18  67  33  26]]
Validation val_loss: 0.6868467930764784
Validation normalized_cm: [[0.321 0.394 0.1   0.185]
 [0.139 0.593 0.083 0.185]
 [0.083 0.325 0.325 0.267]
 [0.125 0.465 0.229 0.181]]
Validation acc: 0.4208015267175573
Validation class_accuracies: [0.320525783619818, 0.5931198102016607, 0.325, 0.18055555555555555]
Validation sensitivity: 0.5103884372177055
Validation specificity: 0.320525783619818
Validation icbhi_score: 0.41545711041876177
Validation roc_auc: None
Validation avg_accuracy: 0.35480028734425856
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5128943217305446 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 150s - loss: 0.4704 - accuracy: 0.7160 - 150s/epoch - 601ms/step
Epoch 11/110
Validation cm: [[403 324 124 138]
 [178 437  76 152]
 [ 25  21  45  29]
 [ 26  57  40  21]]
Validation val_loss: 0.6370547887129808
Validation normalized_cm: [[0.407 0.328 0.125 0.14 ]
 [0.211 0.518 0.09  0.18 ]
 [0.208 0.175 0.375 0.242]
 [0.181 0.396 0.278 0.146]]
Validation acc: 0.43225190839694655
Validation class_accuracies: [0.4074823053589484, 0.5183867141162515, 0.375, 0.14583333333333334]
Validation sensitivity: 0.45438121047877145
Validation specificity: 0.4074823053589484
Validation icbhi_score: 0.43093175791885996
Validation roc_auc: None
Validation avg_accuracy: 0.3616755882021333
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5128943217305446 hasn't increased by 0 in 4 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 150s - loss: 0.4564 - accuracy: 0.7304 - 150s/epoch - 602ms/step
Epoch 12/110
Validation cm: [[159 615  37 178]
 [ 38 627  12 166]
 [ 10  42  12  56]
 [  4  79  12  49]]
Validation val_loss: 0.6725840300022987
Validation normalized_cm: [[0.161 0.622 0.037 0.18 ]
 [0.045 0.744 0.014 0.197]
 [0.083 0.35  0.1   0.467]
 [0.028 0.549 0.083 0.34 ]]
Validation acc: 0.4041030534351145
Validation class_accuracies: [0.16076845298281092, 0.7437722419928826, 0.1, 0.3402777777777778]
Validation sensitivity: 0.6214995483288166
Validation specificity: 0.16076845298281092
Validation icbhi_score: 0.3911340006558138
Validation roc_auc: None
Validation avg_accuracy: 0.3362046181883679
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5128943217305446 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 151s - loss: 0.4466 - accuracy: 0.7223 - 151s/epoch - 607ms/step
Epoch 13/110
Validation cm: [[162 532  49 246]
 [ 46 627  10 160]
 [  8  36   4  72]
 [  2  81   7  54]]
Validation val_loss: 0.7349041055031263
Validation normalized_cm: [[0.164 0.538 0.05  0.249]
 [0.055 0.744 0.012 0.19 ]
 [0.067 0.3   0.033 0.6  ]
 [0.014 0.562 0.049 0.375]]
Validation acc: 0.4041030534351145
Validation class_accuracies: [0.16380182002022245, 0.7437722419928826, 0.03333333333333333, 0.375]
Validation sensitivity: 0.6187895212285456
Validation specificity: 0.16380182002022245
Validation icbhi_score: 0.39129567062438403
Validation roc_auc: None
Validation avg_accuracy: 0.3289768488366096
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5128943217305446 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 152s - loss: 0.4261 - accuracy: 0.7420 - 152s/epoch - 610ms/step
Epoch 14/110
Validation cm: [[573 300  41  75]
 [295 487  18  43]
 [ 53  20  30  17]
 [ 51  66  22   5]]
Validation val_loss: 0.5902278032642612
Validation normalized_cm: [[0.579 0.303 0.041 0.076]
 [0.35  0.578 0.021 0.051]
 [0.442 0.167 0.25  0.142]
 [0.354 0.458 0.153 0.035]]
Validation acc: 0.5224236641221374
Validation class_accuracies: [0.5793731041456016, 0.5776986951364176, 0.25, 0.034722222222222224]
Validation sensitivity: 0.4715447154471545
Validation specificity: 0.5793731041456016
Validation icbhi_score: 0.525458909796378
Validation roc_auc: None
Validation avg_accuracy: 0.3604485053760604
Validation one_indexed_epoch: 14
-- New best results were achieved. --
There is no such attribute
249/249 - 151s - loss: 0.4096 - accuracy: 0.7501 - 151s/epoch - 606ms/step
Epoch 15/110
Validation cm: [[710 117  99  63]
 [547 225  35  36]
 [ 65   7  41   7]
 [ 85  27  29   3]]
Validation val_loss: 0.6446030836344434
Validation normalized_cm: [[0.718 0.118 0.1   0.064]
 [0.649 0.267 0.042 0.043]
 [0.542 0.058 0.342 0.058]
 [0.59  0.188 0.201 0.021]]
Validation acc: 0.46708015267175573
Validation class_accuracies: [0.717896865520728, 0.2669039145907473, 0.3416666666666667, 0.020833333333333332]
Validation sensitivity: 0.24299909665763325
Validation specificity: 0.717896865520728
Validation icbhi_score: 0.48044798108918063
Validation roc_auc: None
Validation avg_accuracy: 0.33682519502786884
Validation one_indexed_epoch: 15
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 151s - loss: 0.3880 - accuracy: 0.7458 - 151s/epoch - 605ms/step
Epoch 16/110
Validation cm: [[176 730  11  72]
 [ 66 740   6  31]
 [ 19  77   8  16]
 [ 17 114   6   7]]
Validation val_loss: 0.6864712395054778
Validation normalized_cm: [[0.178 0.738 0.011 0.073]
 [0.078 0.878 0.007 0.037]
 [0.158 0.642 0.067 0.133]
 [0.118 0.792 0.042 0.049]]
Validation acc: 0.4441793893129771
Validation class_accuracies: [0.17795753286147623, 0.8778173190984578, 0.06666666666666667, 0.04861111111111111]
Validation sensitivity: 0.6820234869015357
Validation specificity: 0.17795753286147623
Validation icbhi_score: 0.42999050988150594
Validation roc_auc: None
Validation avg_accuracy: 0.292763157434428
Validation one_indexed_epoch: 16
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 151s - loss: 0.4039 - accuracy: 0.7455 - 151s/epoch - 606ms/step
Epoch 17/110
Validation cm: [[308 496  27 158]
 [152 572  24  95]
 [ 18  48  13  41]
 [ 23  73  26  22]]
Validation val_loss: 0.7171528173925156
Validation normalized_cm: [[0.311 0.502 0.027 0.16 ]
 [0.18  0.679 0.028 0.113]
 [0.15  0.4   0.108 0.342]
 [0.16  0.507 0.181 0.153]]
Validation acc: 0.43654580152671757
Validation class_accuracies: [0.3114256825075834, 0.6785290628706999, 0.10833333333333334, 0.1527777777777778]
Validation sensitivity: 0.5483288166214996
Validation specificity: 0.3114256825075834
Validation icbhi_score: 0.4298772495645415
Validation roc_auc: None
Validation avg_accuracy: 0.31276646412234865
Validation one_indexed_epoch: 17
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 161s - loss: 0.3837 - accuracy: 0.7496 - 161s/epoch - 645ms/step
Epoch 18/110
Validation cm: [[207 635  38 109]
 [ 68 671  19  85]
 [ 18  57  20  25]
 [ 11  83  18  32]]
Validation val_loss: 0.7046032736170326
Validation normalized_cm: [[0.209 0.642 0.038 0.11 ]
 [0.081 0.796 0.023 0.101]
 [0.15  0.475 0.167 0.208]
 [0.076 0.576 0.125 0.222]]
Validation acc: 0.4437022900763359
Validation class_accuracies: [0.20930232558139536, 0.7959667852906287, 0.16666666666666666, 0.2222222222222222]
Validation sensitivity: 0.6531165311653117
Validation specificity: 0.20930232558139536
Validation icbhi_score: 0.4312094283733535
Validation roc_auc: None
Validation avg_accuracy: 0.34853949994022826
Validation one_indexed_epoch: 18
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 153s - loss: 0.3536 - accuracy: 0.7581 - 153s/epoch - 616ms/step
Epoch 19/110
Validation cm: [[392 416  54 127]
 [208 518  35  82]
 [ 36  32  20  32]
 [ 34  58  33  19]]
Validation val_loss: 0.699626800179382
Validation normalized_cm: [[0.396 0.421 0.055 0.128]
 [0.247 0.614 0.042 0.097]
 [0.3   0.267 0.167 0.267]
 [0.236 0.403 0.229 0.132]]
Validation acc: 0.4527671755725191
Validation class_accuracies: [0.39635995955510617, 0.6144721233689205, 0.16666666666666666, 0.13194444444444445]
Validation sensitivity: 0.5031616982836495
Validation specificity: 0.39635995955510617
Validation icbhi_score: 0.44976082891937785
Validation roc_auc: None
Validation avg_accuracy: 0.32736079850878447
Validation one_indexed_epoch: 19
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 160s - loss: 0.3345 - accuracy: 0.7579 - 160s/epoch - 642ms/step
Epoch 20/110
Validation cm: [[719 163  33  74]
 [542 241  27  33]
 [ 77   7  23  13]
 [ 90  31  19   4]]
Validation val_loss: 0.6842953800112684
Validation normalized_cm: [[0.727 0.165 0.033 0.075]
 [0.643 0.286 0.032 0.039]
 [0.642 0.058 0.192 0.108]
 [0.625 0.215 0.132 0.028]]
Validation acc: 0.4708969465648855
Validation class_accuracies: [0.7269969666329625, 0.2858837485172005, 0.19166666666666668, 0.027777777777777776]
Validation sensitivity: 0.24209575429087624
Validation specificity: 0.7269969666329625
Validation icbhi_score: 0.4845463604619194
Validation roc_auc: None
Validation avg_accuracy: 0.30808128989865186
Validation one_indexed_epoch: 20
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 166s - loss: 0.3278 - accuracy: 0.7644 - 166s/epoch - 666ms/step
Epoch 21/110
Validation cm: [[314 338 121 216]
 [146 412  83 202]
 [ 23  22  38  37]
 [ 22  53  40  29]]
Validation val_loss: 0.878624145946206
Validation normalized_cm: [[0.317 0.342 0.122 0.218]
 [0.173 0.489 0.098 0.24 ]
 [0.192 0.183 0.317 0.308]
 [0.153 0.368 0.278 0.201]]
Validation acc: 0.37833969465648853
Validation class_accuracies: [0.31749241658240646, 0.4887307236061684, 0.31666666666666665, 0.2013888888888889]
Validation sensitivity: 0.4327009936766034
Validation specificity: 0.31749241658240646
Validation icbhi_score: 0.37509670512950494
Validation roc_auc: None
Validation avg_accuracy: 0.3310696739360326
Validation one_indexed_epoch: 21
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 164s - loss: 0.3226 - accuracy: 0.7800 - 164s/epoch - 659ms/step
Epoch 22/110
Validation cm: [[268 471  71 179]
 [110 583  20 130]
 [ 21  35  22  42]
 [  9  86  16  33]]
Validation val_loss: 0.8565447085871599
Validation normalized_cm: [[0.271 0.476 0.072 0.181]
 [0.13  0.692 0.024 0.154]
 [0.175 0.292 0.183 0.35 ]
 [0.062 0.597 0.111 0.229]]
Validation acc: 0.43225190839694655
Validation class_accuracies: [0.27098078867542974, 0.6915776986951364, 0.18333333333333332, 0.22916666666666666]
Validation sensitivity: 0.5763324299909666
Validation specificity: 0.27098078867542974
Validation icbhi_score: 0.42365660933319815
Validation roc_auc: None
Validation avg_accuracy: 0.34376462184264156
Validation one_indexed_epoch: 22
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 8 epochs
There is no such attribute
249/249 - 156s - loss: 0.2843 - accuracy: 0.7785 - 156s/epoch - 627ms/step
Epoch 23/110
Validation cm: [[477 288 123 101]
 [302 378  93  70]
 [ 38  19  41  22]
 [ 46  39  52   7]]
Validation val_loss: 0.7597145858733517
Validation normalized_cm: [[0.482 0.291 0.124 0.102]
 [0.358 0.448 0.11  0.083]
 [0.317 0.158 0.342 0.183]
 [0.319 0.271 0.361 0.049]]
Validation acc: 0.4308206106870229
Validation class_accuracies: [0.48230535894843274, 0.4483985765124555, 0.3416666666666667, 0.04861111111111111]
Validation sensitivity: 0.38482384823848237
Validation specificity: 0.48230535894843274
Validation icbhi_score: 0.43356460359345755
Validation roc_auc: None
Validation avg_accuracy: 0.3302454283096665
Validation one_indexed_epoch: 23
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 151s - loss: 0.3438 - accuracy: 0.7662 - 151s/epoch - 607ms/step
Epoch 24/110
Validation cm: [[406 334 125 124]
 [228 470  51  94]
 [ 31  28  41  20]
 [ 25  67  33  19]]
Validation val_loss: 0.7812591182791809
Validation normalized_cm: [[0.411 0.338 0.126 0.125]
 [0.27  0.558 0.06  0.112]
 [0.258 0.233 0.342 0.167]
 [0.174 0.465 0.229 0.132]]
Validation acc: 0.44656488549618323
Validation class_accuracies: [0.41051567239635994, 0.5575326215895611, 0.3416666666666667, 0.13194444444444445]
Validation sensitivity: 0.4787714543812105
Validation specificity: 0.41051567239635994
Validation icbhi_score: 0.4446435633887852
Validation roc_auc: None
Validation avg_accuracy: 0.36041485127425804
Validation one_indexed_epoch: 24
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 10 epochs
There is no such attribute
249/249 - 156s - loss: 0.2823 - accuracy: 0.7821 - 156s/epoch - 626ms/step
Epoch 25/110
Validation cm: [[359 489  36 105]
 [148 593  25  77]
 [ 26  47  17  30]
 [ 19  86  23  16]]
Validation val_loss: 0.7938619202750696
Validation normalized_cm: [[0.363 0.494 0.036 0.106]
 [0.176 0.703 0.03  0.091]
 [0.217 0.392 0.142 0.25 ]
 [0.132 0.597 0.16  0.111]]
Validation acc: 0.4699427480916031
Validation class_accuracies: [0.36299292214357937, 0.7034400948991696, 0.14166666666666666, 0.1111111111111111]
Validation sensitivity: 0.5654923215898826
Validation specificity: 0.36299292214357937
Validation icbhi_score: 0.464242621866731
Validation roc_auc: None
Validation avg_accuracy: 0.3298026987051317
Validation one_indexed_epoch: 25
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 11 epochs
There is no such attribute
249/249 - 150s - loss: 0.2626 - accuracy: 0.7894 - 150s/epoch - 602ms/step
Epoch 26/110
Validation cm: [[327 417  84 161]
 [133 527  40 143]
 [ 26  34  26  34]
 [ 20  68  23  33]]
Validation val_loss: 0.8813832397882896
Validation normalized_cm: [[0.331 0.422 0.085 0.163]
 [0.158 0.625 0.047 0.17 ]
 [0.217 0.283 0.217 0.283]
 [0.139 0.472 0.16  0.229]]
Validation acc: 0.43559160305343514
Validation class_accuracies: [0.3306370070778564, 0.6251482799525504, 0.21666666666666667, 0.22916666666666666]
Validation sensitivity: 0.5293586269196026
Validation specificity: 0.3306370070778564
Validation icbhi_score: 0.4299978169987295
Validation roc_auc: None
Validation avg_accuracy: 0.35040465509093505
Validation one_indexed_epoch: 26
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 12 epochs
There is no such attribute
249/249 - 155s - loss: 0.2517 - accuracy: 0.7843 - 155s/epoch - 622ms/step
Epoch 27/110
Validation cm: [[400 473  14 102]
 [189 598   9  47]
 [ 35  45  13  27]
 [ 21 107   6  10]]
Validation val_loss: 0.8529201020379569
Validation normalized_cm: [[0.404 0.478 0.014 0.103]
 [0.224 0.709 0.011 0.056]
 [0.292 0.375 0.108 0.225]
 [0.146 0.743 0.042 0.069]]
Validation acc: 0.48711832061068705
Validation class_accuracies: [0.4044489383215369, 0.7093712930011863, 0.10833333333333334, 0.06944444444444445]
Validation sensitivity: 0.5609756097560976
Validation specificity: 0.4044489383215369
Validation icbhi_score: 0.4827122740388172
Validation roc_auc: None
Validation avg_accuracy: 0.32289950227512526
Validation one_indexed_epoch: 27
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 13 epochs
There is no such attribute
249/249 - 163s - loss: 0.2383 - accuracy: 0.7800 - 163s/epoch - 654ms/step
Epoch 28/110
Validation cm: [[429 415  49  96]
 [233 522  31  57]
 [ 32  42  23  23]
 [ 25  84  23  12]]
Validation val_loss: 0.7507596657559665
Validation normalized_cm: [[0.434 0.42  0.05  0.097]
 [0.276 0.619 0.037 0.068]
 [0.267 0.35  0.192 0.192]
 [0.174 0.583 0.16  0.083]]
Validation acc: 0.47041984732824427
Validation class_accuracies: [0.43377148634984836, 0.6192170818505338, 0.19166666666666668, 0.08333333333333333]
Validation sensitivity: 0.5031616982836495
Validation specificity: 0.43377148634984836
Validation icbhi_score: 0.4684665923167489
Validation roc_auc: None
Validation avg_accuracy: 0.3319971420500955
Validation one_indexed_epoch: 28
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 14 epochs
There is no such attribute
249/249 - 164s - loss: 0.2384 - accuracy: 0.7894 - 164s/epoch - 659ms/step
Epoch 29/110
Validation cm: [[498 247 166  78]
 [327 342 107  67]
 [ 45  12  50  13]
 [ 39  40  55  10]]
Validation val_loss: 0.9390947090745446
Validation normalized_cm: [[0.504 0.25  0.168 0.079]
 [0.388 0.406 0.127 0.079]
 [0.375 0.1   0.417 0.108]
 [0.271 0.278 0.382 0.069]]
Validation acc: 0.42938931297709926
Validation class_accuracies: [0.5035389282103134, 0.40569395017793597, 0.4166666666666667, 0.06944444444444445]
Validation sensitivity: 0.36314363143631434
Validation specificity: 0.5035389282103134
Validation icbhi_score: 0.4333412798233139
Validation roc_auc: None
Validation avg_accuracy: 0.3488359973748401
Validation one_indexed_epoch: 29
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 15 epochs
There is no such attribute
249/249 - 166s - loss: 0.2105 - accuracy: 0.7919 - 166s/epoch - 669ms/step
Epoch 30/110
Validation cm: [[270 307 213 199]
 [152 391 137 163]
 [ 15  20  48  37]
 [ 22  46  56  20]]
Validation val_loss: 1.1821393348331712
Validation normalized_cm: [[0.273 0.31  0.215 0.201]
 [0.18  0.464 0.163 0.193]
 [0.125 0.167 0.4   0.308]
 [0.153 0.319 0.389 0.139]]
Validation acc: 0.34780534351145037
Validation class_accuracies: [0.2730030333670374, 0.4638196915776987, 0.4, 0.1388888888888889]
Validation sensitivity: 0.4146341463414634
Validation specificity: 0.2730030333670374
Validation icbhi_score: 0.3438185898542504
Validation roc_auc: None
Validation avg_accuracy: 0.31892790345840627
Validation one_indexed_epoch: 30
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 16 epochs
There is no such attribute
249/249 - 164s - loss: 0.2113 - accuracy: 0.8010 - 164s/epoch - 658ms/step
Epoch 31/110
Validation cm: [[204 640  23 122]
 [ 63 691  12  77]
 [  9  63  14  34]
 [ 12 107   8  17]]
Validation val_loss: 0.9304748606948179
Validation normalized_cm: [[0.206 0.647 0.023 0.123]
 [0.075 0.82  0.014 0.091]
 [0.075 0.525 0.117 0.283]
 [0.083 0.743 0.056 0.118]]
Validation acc: 0.44179389312977096
Validation class_accuracies: [0.20626895854398383, 0.8196915776986952, 0.11666666666666667, 0.11805555555555555]
Validation sensitivity: 0.6522131887985546
Validation specificity: 0.20626895854398383
Validation icbhi_score: 0.42924107367126924
Validation roc_auc: None
Validation avg_accuracy: 0.3151706896162253
Validation one_indexed_epoch: 31
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 17 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 165s - loss: 0.1994 - accuracy: 0.7758 - 165s/epoch - 661ms/step
Epoch 32/110
Validation cm: [[818 106  51  14]
 [695 109  25  14]
 [ 80   7  32   1]
 [105  17  20   2]]
Validation val_loss: 0.9290797351876172
Validation normalized_cm: [[0.827 0.107 0.052 0.014]
 [0.824 0.129 0.03  0.017]
 [0.667 0.058 0.267 0.008]
 [0.729 0.118 0.139 0.014]]
Validation acc: 0.45849236641221375
Validation class_accuracies: [0.8270980788675429, 0.12930011862396204, 0.26666666666666666, 0.013888888888888888]
Validation sensitivity: 0.12917795844625113
Validation specificity: 0.8270980788675429
Validation icbhi_score: 0.47813801865689703
Validation roc_auc: None
Validation avg_accuracy: 0.3092384382617651
Validation one_indexed_epoch: 32
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 18 epochs
There is no such attribute
249/249 - 164s - loss: 0.2178 - accuracy: 0.7949 - 164s/epoch - 661ms/step
Epoch 33/110
Validation cm: [[455 313  85 136]
 [332 373  41  97]
 [ 40  23  29  28]
 [ 42  52  27  23]]
Validation val_loss: 0.9262573805214208
Validation normalized_cm: [[0.46  0.316 0.086 0.138]
 [0.394 0.442 0.049 0.115]
 [0.333 0.192 0.242 0.233]
 [0.292 0.361 0.188 0.16 ]]
Validation acc: 0.4198473282442748
Validation class_accuracies: [0.46006066734074824, 0.4424673784104389, 0.24166666666666667, 0.1597222222222222]
Validation sensitivity: 0.3839205058717254
Validation specificity: 0.46006066734074824
Validation icbhi_score: 0.4219905866062368
Validation roc_auc: None
Validation avg_accuracy: 0.325979233660019
Validation one_indexed_epoch: 33
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 19 epochs
There is no such attribute
249/249 - 155s - loss: 0.2158 - accuracy: 0.8005 - 155s/epoch - 624ms/step
Epoch 34/110
Validation cm: [[401 306  86 196]
 [266 371  43 163]
 [ 34  13  29  44]
 [ 30  50  28  36]]
Validation val_loss: 1.1288845109792633
Validation normalized_cm: [[0.405 0.309 0.087 0.198]
 [0.316 0.44  0.051 0.193]
 [0.283 0.108 0.242 0.367]
 [0.208 0.347 0.194 0.25 ]]
Validation acc: 0.3993320610687023
Validation class_accuracies: [0.40546006066734075, 0.4400948991696323, 0.24166666666666667, 0.25]
Validation sensitivity: 0.3938572719060524
Validation specificity: 0.40546006066734075
Validation icbhi_score: 0.39965866628669655
Validation roc_auc: None
Validation avg_accuracy: 0.3343054066259099
Validation one_indexed_epoch: 34
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 20 epochs
There is no such attribute
249/249 - 164s - loss: 0.1486 - accuracy: 0.8075 - 164s/epoch - 658ms/step
Epoch 35/110
Validation cm: [[356 441  69 123]
 [198 535  46  64]
 [ 31  38  23  28]
 [ 27  69  32  16]]
Validation val_loss: 1.0644565732880937
Validation normalized_cm: [[0.36  0.446 0.07  0.124]
 [0.235 0.635 0.055 0.076]
 [0.258 0.317 0.192 0.233]
 [0.188 0.479 0.222 0.111]]
Validation acc: 0.4437022900763359
Validation class_accuracies: [0.35995955510616784, 0.6346381969157769, 0.19166666666666668, 0.1111111111111111]
Validation sensitivity: 0.5185185185185185
Validation specificity: 0.35995955510616784
Validation icbhi_score: 0.43923903681234316
Validation roc_auc: None
Validation avg_accuracy: 0.3243438824499307
Validation one_indexed_epoch: 35
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 21 epochs
There is no such attribute
249/249 - 164s - loss: 0.1475 - accuracy: 0.8055 - 164s/epoch - 661ms/step
Epoch 36/110
Validation cm: [[543 330  44  72]
 [337 439  26  41]
 [ 38  37  27  18]
 [ 53  59  25   7]]
Validation val_loss: 0.9115944211684568
Validation normalized_cm: [[0.549 0.334 0.044 0.073]
 [0.4   0.521 0.031 0.049]
 [0.317 0.308 0.225 0.15 ]
 [0.368 0.41  0.174 0.049]]
Validation acc: 0.4847328244274809
Validation class_accuracies: [0.5490394337714863, 0.5207591933570581, 0.225, 0.04861111111111111]
Validation sensitivity: 0.42728093947606144
Validation specificity: 0.5490394337714863
Validation icbhi_score: 0.4881601866237739
Validation roc_auc: None
Validation avg_accuracy: 0.3358524345599139
Validation one_indexed_epoch: 36
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 22 epochs
There is no such attribute
249/249 - 166s - loss: 0.1457 - accuracy: 0.7992 - 166s/epoch - 665ms/step
Epoch 37/110
Validation cm: [[470 368  59  92]
 [276 474  44  49]
 [ 39  33  24  24]
 [ 39  61  31  13]]
Validation val_loss: 1.061094817429716
Validation normalized_cm: [[0.475 0.372 0.06  0.093]
 [0.327 0.562 0.052 0.058]
 [0.325 0.275 0.2   0.2  ]
 [0.271 0.424 0.215 0.09 ]]
Validation acc: 0.46803435114503816
Validation class_accuracies: [0.4752275025278059, 0.5622775800711743, 0.2, 0.09027777777777778]
Validation sensitivity: 0.46160794941282746
Validation specificity: 0.4752275025278059
Validation icbhi_score: 0.46841772597031667
Validation roc_auc: None
Validation avg_accuracy: 0.33194571509418946
Validation one_indexed_epoch: 37
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 23 epochs
There is no such attribute
249/249 - 167s - loss: 0.1210 - accuracy: 0.8103 - 167s/epoch - 670ms/step
Epoch 38/110
Validation cm: [[483 288  96 122]
 [294 393  53 103]
 [ 33  24  36  27]
 [ 38  54  36  16]]
Validation val_loss: 1.0425272354833008
Validation normalized_cm: [[0.488 0.291 0.097 0.123]
 [0.349 0.466 0.063 0.122]
 [0.275 0.2   0.3   0.225]
 [0.264 0.375 0.25  0.111]]
Validation acc: 0.44274809160305345
Validation class_accuracies: [0.4883720930232558, 0.46619217081850534, 0.3, 0.1111111111111111]
Validation sensitivity: 0.4019873532068654
Validation specificity: 0.4883720930232558
Validation icbhi_score: 0.4451797231150606
Validation roc_auc: None
Validation avg_accuracy: 0.34141884373821807
Validation one_indexed_epoch: 38
The validation tracker metric at 0.525458909796378 hasn't increased by 0 in 24 epochs
There is no such attribute
249/249 - 167s - loss: 0.1512 - accuracy: 0.8035 - 167s/epoch - 670ms/step
Epoch 39/110
Validation cm: [[494 288  92 115]
 [335 395  44  69]
 [ 38  25  31  26]
 [ 42  50  34  18]]
Validation val_loss: 1.0565020859078318
Validation normalized_cm: [[0.499 0.291 0.093 0.116]
 [0.397 0.469 0.052 0.082]
 [0.317 0.208 0.258 0.217]
 [0.292 0.347 0.236 0.125]]
Validation acc: 0.44751908396946566
Validation class_accuracies: [0.4994944388270981, 0.46856465005931197, 0.25833333333333336, 0.125]
Validation sensitivity: 0.4010840108401084
Validation specificity: 0.4994944388270981
Validation icbhi_score: 0.45028922483360323
Validation roc_auc: None
Validation avg_accuracy: 0.33784810555493583
Validation one_indexed_epoch: 39
The number of epochs since last 1% equals the patience
There is no such attribute
249/249 - 166s - loss: 0.1445 - accuracy: 0.8221 - 166s/epoch - 666ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.525458909796378
Best cm: [[573 300  41  75]
 [295 487  18  43]
 [ 53  20  30  17]
 [ 51  66  22   5]]
Best val_loss: 0.5902278032642612
Best normalized_cm: [[0.579 0.303 0.041 0.076]
 [0.35  0.578 0.021 0.051]
 [0.442 0.167 0.25  0.142]
 [0.354 0.458 0.153 0.035]]
Best acc: 0.5224236641221374
Best class_accuracies: [0.5793731041456016, 0.5776986951364176, 0.25, 0.034722222222222224]
Best sensitivity: 0.4715447154471545
Best specificity: 0.5793731041456016
Best roc_auc: None
Best avg_accuracy: 0.3604485053760604
Best one_indexed_epoch: 14
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6738466024398804, 0.629003643989563, 0.5923236012458801, 0.5706502795219421, 0.5509989857673645, 0.5293105244636536, 0.5382552742958069, 0.5094633102416992, 0.48542049527168274, 0.47042033076286316, 0.4564318060874939, 0.4465831518173218, 0.4260571002960205, 0.4096330404281616, 0.38799020648002625, 0.4038618206977844, 0.3836701512336731, 0.353608101606369, 0.33450964093208313, 0.3278369903564453, 0.32258859276771545, 0.28431785106658936, 0.34380289912223816, 0.28230443596839905, 0.26256346702575684, 0.25166454911231995, 0.23828592896461487, 0.2384377270936966, 0.21053583920001984, 0.21129848062992096, 0.1994321197271347, 0.21779175102710724, 0.21576862037181854, 0.14859023690223694, 0.14753708243370056, 0.14566633105278015, 0.12098149955272675, 0.1511668860912323, 0.144466370344162], 'accuracy': [0.5429579019546509, 0.6142604947090149, 0.6434870362281799, 0.6661627888679504, 0.6643990874290466, 0.6956412196159363, 0.6772486567497253, 0.7042075991630554, 0.716553270816803, 0.7160493731498718, 0.7304106950759888, 0.7223482131958008, 0.7420005202293396, 0.7500630021095276, 0.745779812335968, 0.7455278635025024, 0.7495591044425964, 0.7581254839897156, 0.75787353515625, 0.7644242644309998, 0.7800453305244446, 0.7785336375236511, 0.7661879658699036, 0.782060980796814, 0.7893676161766052, 0.7843285202980042, 0.7800453305244446, 0.7893676161766052, 0.791887104511261, 0.800957441329956, 0.775762140750885, 0.7949105501174927, 0.8004535436630249, 0.8075081706047058, 0.8054925799369812, 0.7991937398910522, 0.8102796673774719, 0.8034769296646118, 0.8221214413642883]}
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 reshape_1 (Reshape)         (None, 16, 6144)          0         
                                                                 
 bidirectional_2 (Bidirectio  (None, 16, 256)          6423552   
 nal)                                                            
                                                                 
 bidirectional_3 (Bidirectio  (None, 16, 256)          394240    
 nal)                                                            
                                                                 
 dense_2 (Dense)             (None, 16, 256)           65792     
                                                                 
 dropout_1 (Dropout)         (None, 16, 256)           0         
                                                                 
 flatten_1 (Flatten)         (None, 4096)              0         
                                                                 
 dense_3 (Dense)             (None, 2)                 8194      
                                                                 
=================================================================
Total params: 30,479,490
Trainable params: 30,426,370
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_174_2_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   30479490         
                                                                                                              
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
==============================================================================================================
Total params: 30,480,212
Trainable params: 30,427,092
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 76   0 913   0]
 [ 90   0 753   0]
 [ 17   0 103   0]
 [ 27   0 117   0]]
Validation val_loss: 1.1632456579565547
Validation normalized_cm: [[0.077 0.    0.923 0.   ]
 [0.107 0.    0.893 0.   ]
 [0.142 0.    0.858 0.   ]
 [0.188 0.    0.812 0.   ]]
Validation acc: 0.08540076335877862
Validation class_accuracies: [0.07684529828109202, 0.0, 0.8583333333333333, 0.0]
Validation sensitivity: 0.0930442637759711
Validation specificity: 0.07684529828109202
Validation icbhi_score: 0.08494478102853156
Validation roc_auc: None
Validation avg_accuracy: 0.23379465790360632
Validation one_indexed_epoch: 1
-- New best results were achieved. --
249/249 - 688s - loss: 0.7434 - accuracy: 0.5319 - 688s/epoch - 3s/step
Epoch 2/110
Validation cm: [[840   2 127  20]
 [692   8 122  21]
 [102   0  15   3]
 [105   0  33   6]]
Validation val_loss: 0.7655420730491205
Validation normalized_cm: [[0.849 0.002 0.128 0.02 ]
 [0.821 0.009 0.145 0.025]
 [0.85  0.    0.125 0.025]
 [0.729 0.    0.229 0.042]]
Validation acc: 0.4145992366412214
Validation class_accuracies: [0.8493427704752275, 0.009489916963226572, 0.125, 0.041666666666666664]
Validation sensitivity: 0.026196928635953028
Validation specificity: 0.8493427704752275
Validation icbhi_score: 0.4377698495555903
Validation roc_auc: None
Validation avg_accuracy: 0.2563748385262802
Validation one_indexed_epoch: 2
-- New best results were achieved. --
249/249 - 650s - loss: 0.6603 - accuracy: 0.5747 - 650s/epoch - 3s/step
Epoch 3/110
Validation cm: [[456 408  40  85]
 [225 486  43  89]
 [ 44  60   4  12]
 [ 37  79   6  22]]
Validation val_loss: 0.6028807622892427
Validation normalized_cm: [[0.461 0.413 0.04  0.086]
 [0.267 0.577 0.051 0.106]
 [0.367 0.5   0.033 0.1  ]
 [0.257 0.549 0.042 0.153]]
Validation acc: 0.4618320610687023
Validation class_accuracies: [0.46107178968655205, 0.5765124555160143, 0.03333333333333333, 0.1527777777777778]
Validation sensitivity: 0.46251129177958444
Validation specificity: 0.46107178968655205
Validation icbhi_score: 0.4617915407330683
Validation roc_auc: None
Validation avg_accuracy: 0.30592383907841936
Validation one_indexed_epoch: 3
-- New best results were achieved. --
249/249 - 623s - loss: 0.6397 - accuracy: 0.5976 - 623s/epoch - 3s/step
Epoch 4/110
Validation cm: [[446  13 525   5]
 [348   4 485   6]
 [ 44   0  76   0]
 [ 72   1  71   0]]
Validation val_loss: 0.8403466304938331
Validation normalized_cm: [[0.451 0.013 0.531 0.005]
 [0.413 0.005 0.575 0.007]
 [0.367 0.    0.633 0.   ]
 [0.5   0.007 0.493 0.   ]]
Validation acc: 0.25095419847328243
Validation class_accuracies: [0.45096056622851366, 0.004744958481613286, 0.6333333333333333, 0.0]
Validation sensitivity: 0.07226738934056007
Validation specificity: 0.45096056622851366
Validation icbhi_score: 0.2616139777845369
Validation roc_auc: None
Validation avg_accuracy: 0.27225971451086506
Validation one_indexed_epoch: 4
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 1 epochs
249/249 - 620s - loss: 0.6228 - accuracy: 0.6165 - 620s/epoch - 2s/step
Epoch 5/110
Validation cm: [[564  84 327  14]
 [463  83 287  10]
 [ 50  11  58   1]
 [ 71  16  56   1]]
Validation val_loss: 0.7035377553934302
Validation normalized_cm: [[0.57  0.085 0.331 0.014]
 [0.549 0.098 0.34  0.012]
 [0.417 0.092 0.483 0.008]
 [0.493 0.111 0.389 0.007]]
Validation acc: 0.3368320610687023
Validation class_accuracies: [0.570273003033367, 0.09845788849347568, 0.48333333333333334, 0.006944444444444444]
Validation sensitivity: 0.12827461607949414
Validation specificity: 0.570273003033367
Validation icbhi_score: 0.3492738095564306
Validation roc_auc: None
Validation avg_accuracy: 0.2897521673261551
Validation one_indexed_epoch: 5
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 2 epochs
249/249 - 624s - loss: 0.6051 - accuracy: 0.6125 - 624s/epoch - 3s/step
Epoch 6/110
Validation cm: [[156 143 587 103]
 [ 86 106 557  94]
 [  9  10  88  13]
 [ 18  28  80  18]]
Validation val_loss: 1.2019089028498742
Validation normalized_cm: [[0.158 0.145 0.594 0.104]
 [0.102 0.126 0.661 0.112]
 [0.075 0.083 0.733 0.108]
 [0.125 0.194 0.556 0.125]]
Validation acc: 0.17557251908396945
Validation class_accuracies: [0.1577350859453994, 0.1257413997627521, 0.7333333333333333, 0.125]
Validation sensitivity: 0.1915085817524842
Validation specificity: 0.1577350859453994
Validation icbhi_score: 0.1746218338489418
Validation roc_auc: None
Validation avg_accuracy: 0.2854524547603712
Validation one_indexed_epoch: 6
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 3 epochs
249/249 - 621s - loss: 0.5821 - accuracy: 0.6495 - 621s/epoch - 2s/step
Epoch 7/110
Validation cm: [[594 153 187  55]
 [547  97 160  39]
 [ 58   7  40  15]
 [ 85  23  27   9]]
Validation val_loss: 0.6985701063260408
Validation normalized_cm: [[0.601 0.155 0.189 0.056]
 [0.649 0.115 0.19  0.046]
 [0.483 0.058 0.333 0.125]
 [0.59  0.16  0.188 0.062]]
Validation acc: 0.3530534351145038
Validation class_accuracies: [0.6006066734074823, 0.11506524317912219, 0.3333333333333333, 0.0625]
Validation sensitivity: 0.13188798554652212
Validation specificity: 0.6006066734074823
Validation icbhi_score: 0.3662473294770022
Validation roc_auc: None
Validation avg_accuracy: 0.27787631247998446
Validation one_indexed_epoch: 7
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 4 epochs
249/249 - 621s - loss: 0.5688 - accuracy: 0.6442 - 621s/epoch - 2s/step
Epoch 8/110
Validation cm: [[259 143 466 121]
 [203 100 421 119]
 [ 18  10  69  23]
 [ 32  21  64  27]]
Validation val_loss: 0.9607172563231288
Validation normalized_cm: [[0.262 0.145 0.471 0.122]
 [0.241 0.119 0.499 0.141]
 [0.15  0.083 0.575 0.192]
 [0.222 0.146 0.444 0.188]]
Validation acc: 0.21708015267175573
Validation class_accuracies: [0.26188068756319516, 0.11862396204033215, 0.575, 0.1875]
Validation sensitivity: 0.17705510388437218
Validation specificity: 0.26188068756319516
Validation icbhi_score: 0.21946789572378367
Validation roc_auc: None
Validation avg_accuracy: 0.28575116240088183
Validation one_indexed_epoch: 8
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 5 epochs
249/249 - 621s - loss: 0.5380 - accuracy: 0.6513 - 621s/epoch - 2s/step
Epoch 9/110
Validation cm: [[286  39 537 127]
 [173  29 519 122]
 [ 30   3  76  11]
 [ 37   6  79  22]]
Validation val_loss: 1.0913353575773908
Validation normalized_cm: [[0.289 0.039 0.543 0.128]
 [0.205 0.034 0.616 0.145]
 [0.25  0.025 0.633 0.092]
 [0.257 0.042 0.549 0.153]]
Validation acc: 0.19704198473282442
Validation class_accuracies: [0.2891809908998989, 0.03440094899169632, 0.6333333333333333, 0.1527777777777778]
Validation sensitivity: 0.11472448057813911
Validation specificity: 0.2891809908998989
Validation icbhi_score: 0.201952735739019
Validation roc_auc: None
Validation avg_accuracy: 0.2774232627506766
Validation one_indexed_epoch: 9
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 6 epochs
249/249 - 567s - loss: 0.5185 - accuracy: 0.6584 - 567s/epoch - 2s/step
Epoch 10/110
Validation cm: [[283 203 393 110]
 [193 204 308 138]
 [ 10   9  68  33]
 [ 26  25  70  23]]
Validation val_loss: 0.7830153002140631
Validation normalized_cm: [[0.286 0.205 0.397 0.111]
 [0.229 0.242 0.365 0.164]
 [0.083 0.075 0.567 0.275]
 [0.181 0.174 0.486 0.16 ]]
Validation acc: 0.27576335877862596
Validation class_accuracies: [0.2861476238624874, 0.24199288256227758, 0.5666666666666667, 0.1597222222222222]
Validation sensitivity: 0.26648599819331525
Validation specificity: 0.2861476238624874
Validation icbhi_score: 0.2763168110279013
Validation roc_auc: None
Validation avg_accuracy: 0.3136323488284135
Validation one_indexed_epoch: 10
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 7 epochs
249/249 - 554s - loss: 0.4839 - accuracy: 0.6578 - 554s/epoch - 2s/step
Epoch 11/110
Validation cm: [[194 352 104 339]
 [127 283  83 350]
 [ 16  17  16  71]
 [ 30  42  14  58]]
Validation val_loss: 0.9970444680204018
Validation normalized_cm: [[0.196 0.356 0.105 0.343]
 [0.151 0.336 0.098 0.415]
 [0.133 0.142 0.133 0.592]
 [0.208 0.292 0.097 0.403]]
Validation acc: 0.26288167938931295
Validation class_accuracies: [0.1961577350859454, 0.33570581257413995, 0.13333333333333333, 0.4027777777777778]
Validation sensitivity: 0.3224932249322493
Validation specificity: 0.1961577350859454
Validation icbhi_score: 0.25932548000909733
Validation roc_auc: None
Validation avg_accuracy: 0.2669936646927991
Validation one_indexed_epoch: 11
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 8 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
249/249 - 552s - loss: 0.4818 - accuracy: 0.6634 - 552s/epoch - 2s/step
Epoch 12/110
Validation cm: [[261 330 203 195]
 [150 336 172 185]
 [ 12  31  38  39]
 [ 22  52  32  38]]
Validation val_loss: 0.8324140129546024
Validation normalized_cm: [[0.264 0.334 0.205 0.197]
 [0.178 0.399 0.204 0.219]
 [0.1   0.258 0.317 0.325]
 [0.153 0.361 0.222 0.264]]
Validation acc: 0.321087786259542
Validation class_accuracies: [0.2639029322548028, 0.398576512455516, 0.31666666666666665, 0.2638888888888889]
Validation sensitivity: 0.3721770551038844
Validation specificity: 0.2639029322548028
Validation icbhi_score: 0.3180399936793436
Validation roc_auc: None
Validation avg_accuracy: 0.3107587500664686
Validation one_indexed_epoch: 12
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 9 epochs
249/249 - 557s - loss: 0.4343 - accuracy: 0.6909 - 557s/epoch - 2s/step
Epoch 13/110
Validation cm: [[369 173 303 144]
 [122 130 393 198]
 [ 14  11  68  27]
 [ 21  23  75  25]]
Validation val_loss: 0.8957520755796999
Validation normalized_cm: [[0.373 0.175 0.306 0.146]
 [0.145 0.154 0.466 0.235]
 [0.117 0.092 0.567 0.225]
 [0.146 0.16  0.521 0.174]]
Validation acc: 0.2824427480916031
Validation class_accuracies: [0.3731041456016178, 0.1542111506524318, 0.5666666666666667, 0.1736111111111111]
Validation sensitivity: 0.2014453477868112
Validation specificity: 0.3731041456016178
Validation icbhi_score: 0.2872747466942145
Validation roc_auc: None
Validation avg_accuracy: 0.3168982685079569
Validation one_indexed_epoch: 13
The validation tracker metric at 0.4617915407330683 hasn't increased by 0 in 10 epochs
249/249 - 553s - loss: 0.4145 - accuracy: 0.7047 - 553s/epoch - 2s/step
Epoch 14/110
