Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train42
Description: Leaf with model 9/mixednet with P-T
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 553s - loss: 0.4468 - accuracy: 0.5606 - 553s/epoch - 2s/step
Validation cm: [[604   2  91  43]
 [ 35   3  22  32]
 [ 56   0  14   7]
 [ 19   0  86  25]]
Validation normalized_cm: [[0.816 0.003 0.123 0.058]
 [0.38  0.033 0.239 0.348]
 [0.727 0.    0.182 0.091]
 [0.146 0.    0.662 0.192]]
Validation acc: 0.6217516843118384
Validation class_accuracies: [0.8162162162162162, 0.03260869565217391, 0.18181818181818182, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3057376964985661
Validation one_indexed_epoch: 2
Epoch 2/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 550s - loss: 0.3933 - accuracy: 0.6003 - 550s/epoch - 2s/step
Validation cm: [[731   3   6   0]
 [ 84   2   5   1]
 [ 66   0  11   0]
 [ 61   0  66   3]]
Validation normalized_cm: [[0.988 0.004 0.008 0.   ]
 [0.913 0.022 0.054 0.011]
 [0.857 0.    0.143 0.   ]
 [0.469 0.    0.508 0.023]]
Validation acc: 0.7189605389797883
Validation class_accuracies: [0.9878378378378379, 0.021739130434782608, 0.14285714285714285, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2938777585516716
Validation one_indexed_epoch: 3
Epoch 3/40
[[0. 0.]]
The validation tracker metric at 0.3057376964985661 hasn't increased by 0 in 1 epochs
330/330 - 547s - loss: 0.3730 - accuracy: 0.6113 - 547s/epoch - 2s/step
Validation cm: [[648  86   6   0]
 [ 50  37   4   1]
 [ 64   6   7   0]
 [ 56  14  55   5]]
Validation normalized_cm: [[0.876 0.116 0.008 0.   ]
 [0.543 0.402 0.043 0.011]
 [0.831 0.078 0.091 0.   ]
 [0.431 0.108 0.423 0.038]]
Validation acc: 0.670837343599615
Validation class_accuracies: [0.8756756756756757, 0.40217391304347827, 0.09090909090909091, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35180505452244587
Validation one_indexed_epoch: 4
Epoch 4/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 546s - loss: 0.3495 - accuracy: 0.6172 - 546s/epoch - 2s/step
Validation cm: [[576   5 144  15]
 [ 50   3  25  14]
 [ 24   0  49   4]
 [ 27   1  90  12]]
Validation normalized_cm: [[0.778 0.007 0.195 0.02 ]
 [0.543 0.033 0.272 0.152]
 [0.312 0.    0.636 0.052]
 [0.208 0.008 0.692 0.092]]
Validation acc: 0.6159769008662175
Validation class_accuracies: [0.7783783783783784, 0.03260869565217391, 0.6363636363636364, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38491460067547023
Validation one_indexed_epoch: 5
Epoch 5/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 558s - loss: 0.3298 - accuracy: 0.6307 - 558s/epoch - 2s/step
Validation cm: [[622  74  21  23]
 [ 27  40   9  16]
 [ 31   2  42   2]
 [ 20  11  91   8]]
Validation normalized_cm: [[0.841 0.1   0.028 0.031]
 [0.293 0.435 0.098 0.174]
 [0.403 0.026 0.545 0.026]
 [0.154 0.085 0.7   0.062]]
Validation acc: 0.685274302213667
Validation class_accuracies: [0.8405405405405405, 0.43478260869565216, 0.5454545454545454, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4705790390572999
Validation one_indexed_epoch: 6
Epoch 6/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 552s - loss: 0.3143 - accuracy: 0.6312 - 552s/epoch - 2s/step
Validation cm: [[691  35   7   7]
 [ 50  39   0   3]
 [ 49  10  18   0]
 [ 86   7  31   6]]
Validation normalized_cm: [[0.934 0.047 0.009 0.009]
 [0.543 0.424 0.    0.033]
 [0.636 0.13  0.234 0.   ]
 [0.662 0.054 0.238 0.046]]
Validation acc: 0.7256977863330125
Validation class_accuracies: [0.9337837837837838, 0.42391304347826086, 0.23376623376623376, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4094042267955312
Validation one_indexed_epoch: 7
Epoch 7/40
[[0. 0.]]
The validation tracker metric at 0.4705790390572999 hasn't increased by 0 in 1 epochs
330/330 - 550s - loss: 0.2997 - accuracy: 0.6523 - 550s/epoch - 2s/step
Validation cm: [[253   7 253 227]
 [  2   0  22  68]
 [  7   0  20  50]
 [  0   0  15 115]]
Validation normalized_cm: [[0.342 0.009 0.342 0.307]
 [0.022 0.    0.239 0.739]
 [0.091 0.    0.26  0.649]
 [0.    0.    0.115 0.885]]
Validation acc: 0.3734359961501444
Validation class_accuracies: [0.3418918918918919, 0.0, 0.2597402597402597, 0.8846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37156188406188406
Validation one_indexed_epoch: 8
Epoch 8/40
[[0. 0.]]
The validation tracker metric at 0.4705790390572999 hasn't increased by 0 in 2 epochs
330/330 - 547s - loss: 0.2803 - accuracy: 0.6360 - 547s/epoch - 2s/step
Validation cm: [[557 119  46  18]
 [ 21  47  11  13]
 [ 26   2  37  12]
 [ 13  13  59  45]]
Validation normalized_cm: [[0.753 0.161 0.062 0.024]
 [0.228 0.511 0.12  0.141]
 [0.338 0.026 0.481 0.156]
 [0.1   0.1   0.454 0.346]]
Validation acc: 0.6602502406159769
Validation class_accuracies: [0.7527027027027027, 0.5108695652173914, 0.4805194805194805, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5225613986483552
Validation one_indexed_epoch: 9
Epoch 9/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 548s - loss: 0.2721 - accuracy: 0.6240 - 548s/epoch - 2s/step
Validation cm: [[693  37   5   5]
 [ 62  28   0   2]
 [ 48   4  23   2]
 [ 65  10  37  18]]
Validation normalized_cm: [[0.936 0.05  0.007 0.007]
 [0.674 0.304 0.    0.022]
 [0.623 0.052 0.299 0.026]
 [0.5   0.077 0.285 0.138]]
Validation acc: 0.7333974975938402
Validation class_accuracies: [0.9364864864864865, 0.30434782608695654, 0.2987012987012987, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41949928743407006
Validation one_indexed_epoch: 10
Epoch 10/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 1 epochs
330/330 - 548s - loss: 0.2457 - accuracy: 0.6563 - 548s/epoch - 2s/step
Validation cm: [[674  53   8   5]
 [ 52  28   8   4]
 [ 59   9   6   3]
 [ 44  11  60  15]]
Validation normalized_cm: [[0.911 0.072 0.011 0.007]
 [0.565 0.304 0.087 0.043]
 [0.766 0.117 0.078 0.039]
 [0.338 0.085 0.462 0.115]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.9108108108108108, 0.30434782608695654, 0.07792207792207792, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3521163325511152
Validation one_indexed_epoch: 11
Epoch 11/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 2 epochs
330/330 - 545s - loss: 0.2398 - accuracy: 0.6571 - 545s/epoch - 2s/step
Validation cm: [[491 199  33  17]
 [ 10  58  10  14]
 [ 27  10  13  27]
 [ 14  31  33  52]]
Validation normalized_cm: [[0.664 0.269 0.045 0.023]
 [0.109 0.63  0.109 0.152]
 [0.351 0.13  0.169 0.351]
 [0.108 0.238 0.254 0.4  ]]
Validation acc: 0.5909528392685275
Validation class_accuracies: [0.6635135135135135, 0.6304347826086957, 0.16883116883116883, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46569486623834455
Validation one_indexed_epoch: 12
Epoch 12/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 3 epochs
330/330 - 547s - loss: 0.2268 - accuracy: 0.6375 - 547s/epoch - 2s/step
Validation cm: [[644  34  50  12]
 [ 47  20  14  11]
 [ 30   4  38   5]
 [ 26   4  69  31]]
Validation normalized_cm: [[0.87  0.046 0.068 0.016]
 [0.511 0.217 0.152 0.12 ]
 [0.39  0.052 0.494 0.065]
 [0.2   0.031 0.531 0.238]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.8702702702702703, 0.21739130434782608, 0.4935064935064935, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4549074016465321
Validation one_indexed_epoch: 13
Epoch 13/40
[[0. 1.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 4 epochs
330/330 - 544s - loss: 0.2090 - accuracy: 0.6217 - 544s/epoch - 2s/step
Validation cm: [[652  40  36  12]
 [ 49  19  12  12]
 [ 44   1  24   8]
 [ 28   8  59  35]]
Validation normalized_cm: [[0.881 0.054 0.049 0.016]
 [0.533 0.207 0.13  0.13 ]
 [0.571 0.013 0.312 0.104]
 [0.215 0.062 0.454 0.269]]
Validation acc: 0.7025986525505293
Validation class_accuracies: [0.8810810810810811, 0.20652173913043478, 0.3116883116883117, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4171304752826491
Validation one_indexed_epoch: 14
Epoch 14/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 5 epochs
330/330 - 544s - loss: 0.1988 - accuracy: 0.6502 - 544s/epoch - 2s/step
Validation cm: [[651  25  37  27]
 [ 44  20  14  14]
 [ 33   2  36   6]
 [ 23   4  69  34]]
Validation normalized_cm: [[0.88  0.034 0.05  0.036]
 [0.478 0.217 0.152 0.152]
 [0.429 0.026 0.468 0.078]
 [0.177 0.031 0.531 0.262]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.8797297297297297, 0.21739130434782608, 0.4675324675324675, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4565479907871212
Validation one_indexed_epoch: 15
Epoch 15/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 6 epochs
330/330 - 556s - loss: 0.1881 - accuracy: 0.6576 - 556s/epoch - 2s/step
Validation cm: [[552 121  38  29]
 [ 20  43  12  17]
 [ 26   7  29  15]
 [  8  13  63  46]]
Validation normalized_cm: [[0.746 0.164 0.051 0.039]
 [0.217 0.467 0.13  0.185]
 [0.338 0.091 0.377 0.195]
 [0.062 0.1   0.485 0.354]]
Validation acc: 0.6448508180943214
Validation class_accuracies: [0.745945945945946, 0.4673913043478261, 0.37662337662337664, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48595169519082565
Validation one_indexed_epoch: 16
Epoch 16/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 7 epochs
330/330 - 558s - loss: 0.1779 - accuracy: 0.6608 - 558s/epoch - 2s/step
Validation cm: [[494 102  88  56]
 [ 20  32  18  22]
 [ 17   2  37  21]
 [  6  10  64  50]]
Validation normalized_cm: [[0.668 0.138 0.119 0.076]
 [0.217 0.348 0.196 0.239]
 [0.221 0.026 0.481 0.273]
 [0.046 0.077 0.492 0.385]]
Validation acc: 0.5899903753609239
Validation class_accuracies: [0.6675675675675675, 0.34782608695652173, 0.4805194805194805, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4701321299147386
Validation one_indexed_epoch: 17
Epoch 17/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 8 epochs
330/330 - 549s - loss: 0.1506 - accuracy: 0.6510 - 549s/epoch - 2s/step
Validation cm: [[653  53  25   9]
 [ 42  27  12  11]
 [ 52   6  19   0]
 [ 29   6  68  27]]
Validation normalized_cm: [[0.882 0.072 0.034 0.012]
 [0.457 0.293 0.13  0.12 ]
 [0.675 0.078 0.247 0.   ]
 [0.223 0.046 0.523 0.208]]
Validation acc: 0.6987487969201155
Validation class_accuracies: [0.8824324324324324, 0.29347826086956524, 0.24675324675324675, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.407589061936888
Validation one_indexed_epoch: 18
Epoch 18/40
[[0. 0.]]
The validation tracker metric at 0.5225613986483552 hasn't increased by 0 in 9 epochs
330/330 - 552s - loss: 0.1504 - accuracy: 0.6610 - 552s/epoch - 2s/step
Validation cm: [[541 144  20  35]
 [ 24  40   7  21]
 [ 26  13  15  23]
 [  9  19  32  70]]
Validation normalized_cm: [[0.731 0.195 0.027 0.047]
 [0.261 0.435 0.076 0.228]
 [0.338 0.169 0.195 0.299]
 [0.069 0.146 0.246 0.538]]
Validation acc: 0.6410009624639076
Validation class_accuracies: [0.731081081081081, 0.43478260869565216, 0.19480519480519481, 0.5384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4747826057608666
Validation one_indexed_epoch: 19
Epoch 19/40
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 547s - loss: 0.1381 - accuracy: 0.6411 - 547s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5225613986483552
Best cm: [[557 119  46  18]
 [ 21  47  11  13]
 [ 26   2  37  12]
 [ 13  13  59  45]]
Best normalized_cm: [[0.753 0.161 0.062 0.024]
 [0.228 0.511 0.12  0.141]
 [0.338 0.026 0.481 0.156]
 [0.1   0.1   0.454 0.346]]
Best acc: 0.6602502406159769
Best class_accuracies: [0.7527027027027027, 0.5108695652173914, 0.4805194805194805, 0.34615384615384615]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 9
Validation cm: [[604 113  23   0]
 [ 46  43   3   0]
 [ 63  14   0   0]
 [ 57  65   8   0]]
Validation normalized_cm: [[0.816 0.153 0.031 0.   ]
 [0.5   0.467 0.033 0.   ]
 [0.818 0.182 0.    0.   ]
 [0.438 0.5   0.062 0.   ]]
Validation acc: 0.6227141482194418
Validation class_accuracies: [0.8162162162162162, 0.4673913043478261, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32090188014101056
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization_5 (BatchNormalization)      multiple                                    4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_1 (Dense)                                 multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 900s - accuracy: 0.5187 - student_loss: 0.4087 - distillation_loss: 0.0247 - val_accuracy: 0.2955 - val_student_loss: 0.6241 - 900s/epoch - 3s/step
Validation cm: [[255 474   9   2]
 [ 55  36   0   1]
 [ 28  49   0   0]
 [113  17   0   0]]
Validation normalized_cm: [[0.345 0.641 0.012 0.003]
 [0.598 0.391 0.    0.011]
 [0.364 0.636 0.    0.   ]
 [0.869 0.131 0.    0.   ]]
Validation acc: 0.28007699711260825
Validation class_accuracies: [0.34459459459459457, 0.391304347826087, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.1839747356051704
Validation one_indexed_epoch: 2
Epoch 2/40
[[1. 0.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 1 epochs
330/330 - 885s - accuracy: 0.5510 - student_loss: 0.6477 - distillation_loss: 0.0186 - val_accuracy: 0.9038 - val_student_loss: 0.0012 - 885s/epoch - 3s/step
Validation cm: [[737   1   2   0]
 [ 92   0   0   0]
 [ 76   0   1   0]
 [126   1   3   0]]
Validation normalized_cm: [[0.996 0.001 0.003 0.   ]
 [1.    0.    0.    0.   ]
 [0.987 0.    0.013 0.   ]
 [0.969 0.008 0.023 0.   ]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.995945945945946, 0.0, 0.012987012987012988, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25223323973323974
Validation one_indexed_epoch: 3
Epoch 3/40
[[0. 0.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 2 epochs
330/330 - 877s - accuracy: 0.5458 - student_loss: 0.5638 - distillation_loss: 0.0275 - val_accuracy: 0.2791 - val_student_loss: 1.6208e-04 - 877s/epoch - 3s/step
Validation cm: [[635  94  11   0]
 [ 53  36   3   0]
 [ 67  10   0   0]
 [ 72  57   1   0]]
Validation normalized_cm: [[0.858 0.127 0.015 0.   ]
 [0.576 0.391 0.033 0.   ]
 [0.87  0.13  0.    0.   ]
 [0.554 0.438 0.008 0.   ]]
Validation acc: 0.6458132820019249
Validation class_accuracies: [0.8581081081081081, 0.391304347826087, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.31235311398354876
Validation one_indexed_epoch: 4
Epoch 4/40
[[0. 0.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 3 epochs
330/330 - 909s - accuracy: 0.5623 - student_loss: 0.3560 - distillation_loss: 0.0251 - val_accuracy: 0.4370 - val_student_loss: 0.0817 - 909s/epoch - 3s/step
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
Epoch 5/40
[[0. 0.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 4 epochs
330/330 - 903s - accuracy: 0.5540 - student_loss: 0.4007 - distillation_loss: 0.0162 - val_accuracy: 0.0741 - val_student_loss: 0.0575 - 903s/epoch - 3s/step
Validation cm: [[699  41   0   0]
 [ 85   7   0   0]
 [ 74   2   0   1]
 [123   6   0   1]]
Validation normalized_cm: [[0.945 0.055 0.    0.   ]
 [0.924 0.076 0.    0.   ]
 [0.961 0.026 0.    0.013]
 [0.946 0.046 0.    0.008]]
Validation acc: 0.6804619826756496
Validation class_accuracies: [0.9445945945945946, 0.07608695652173914, 0.0, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2570934647021603
Validation one_indexed_epoch: 6
Epoch 6/40
[[0. 0.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 5 epochs
330/330 - 899s - accuracy: 0.5430 - student_loss: 0.5377 - distillation_loss: 0.0141 - val_accuracy: 0.2762 - val_student_loss: 4.0658e-06 - 899s/epoch - 3s/step
Validation cm: [[551  46 140   3]
 [ 82   6   4   0]
 [ 56   3  17   1]
 [118   4   7   1]]
Validation normalized_cm: [[0.745 0.062 0.189 0.004]
 [0.891 0.065 0.043 0.   ]
 [0.727 0.039 0.221 0.013]
 [0.908 0.031 0.054 0.008]]
Validation acc: 0.5534167468719923
Validation class_accuracies: [0.7445945945945946, 0.06521739130434782, 0.22077922077922077, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25957087859261774
Validation one_indexed_epoch: 7
Epoch 7/40
[[0. 1.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 6 epochs
330/330 - 910s - accuracy: 0.5690 - student_loss: 0.6780 - distillation_loss: 0.0139 - val_accuracy: 0.4187 - val_student_loss: 7.6128e-05 - 910s/epoch - 3s/step
Validation cm: [[530 147  28  35]
 [ 61  27   2   2]
 [ 61  13   1   2]
 [ 94  33   1   2]]
Validation normalized_cm: [[0.716 0.199 0.038 0.047]
 [0.663 0.293 0.022 0.022]
 [0.792 0.169 0.013 0.026]
 [0.723 0.254 0.008 0.015]]
Validation acc: 0.5389797882579404
Validation class_accuracies: [0.7162162162162162, 0.29347826086956524, 0.012987012987012988, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2595165263643524
Validation one_indexed_epoch: 8
Epoch 8/40
[[0. 1.]]
The validation tracker metric at 0.32090188014101056 hasn't increased by 0 in 7 epochs
330/330 - 909s - accuracy: 0.5466 - student_loss: 0.5232 - distillation_loss: 0.0163 - val_accuracy: 0.4687 - val_student_loss: 0.6240 - 909s/epoch - 3s/step
Validation cm: [[ 90 602   1  47]
 [  2  76   0  14]
 [ 14  48   0  15]
 [  2  60   0  68]]
Validation normalized_cm: [[0.122 0.814 0.001 0.064]
 [0.022 0.826 0.    0.152]
 [0.182 0.623 0.    0.195]
 [0.015 0.462 0.    0.523]]
Validation acc: 0.2252165543792108
Validation class_accuracies: [0.12162162162162163, 0.8260869565217391, 0.0, 0.5230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36769637530507093
Validation one_indexed_epoch: 9
Epoch 9/40
[[1. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 913s - accuracy: 0.5439 - student_loss: 0.3662 - distillation_loss: 0.0218 - val_accuracy: 0.9172 - val_student_loss: 2.6584 - 913s/epoch - 3s/step
Validation cm: [[639 101   0   0]
 [ 51  41   0   0]
 [ 67  10   0   0]
 [ 61  66   3   0]]
Validation normalized_cm: [[0.864 0.136 0.    0.   ]
 [0.554 0.446 0.    0.   ]
 [0.87  0.13  0.    0.   ]
 [0.469 0.508 0.023 0.   ]]
Validation acc: 0.6544754571703562
Validation class_accuracies: [0.8635135135135135, 0.44565217391304346, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32729142185663923
Validation one_indexed_epoch: 10
Epoch 10/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 1 epochs
330/330 - 904s - accuracy: 0.5692 - student_loss: 0.5641 - distillation_loss: 0.0171 - val_accuracy: 0.3609 - val_student_loss: 5.0288e-05 - 904s/epoch - 3s/step
Validation cm: [[737   3   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[0.996 0.004 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.995945945945946, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2489864864864865
Validation one_indexed_epoch: 11
Epoch 11/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 2 epochs
330/330 - 901s - accuracy: 0.5629 - student_loss: 0.4918 - distillation_loss: 0.0060 - val_accuracy: 0.0895 - val_student_loss: 3.9392e-09 - 901s/epoch - 3s/step
Validation cm: [[731   9   0   0]
 [ 88   3   1   0]
 [ 77   0   0   0]
 [128   2   0   0]]
Validation normalized_cm: [[0.988 0.012 0.    0.   ]
 [0.957 0.033 0.011 0.   ]
 [1.    0.    0.    0.   ]
 [0.985 0.015 0.    0.   ]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.9878378378378379, 0.03260869565217391, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2551116333725029
Validation one_indexed_epoch: 12
Epoch 12/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 3 epochs
330/330 - 898s - accuracy: 0.5515 - student_loss: 0.4172 - distillation_loss: 0.0083 - val_accuracy: 0.8316 - val_student_loss: 2.2978e-13 - 898s/epoch - 3s/step
Validation cm: [[549 191   0   0]
 [ 85   7   0   0]
 [ 60  17   0   0]
 [124   6   0   0]]
Validation normalized_cm: [[0.742 0.258 0.    0.   ]
 [0.924 0.076 0.    0.   ]
 [0.779 0.221 0.    0.   ]
 [0.954 0.046 0.    0.   ]]
Validation acc: 0.5351299326275265
Validation class_accuracies: [0.7418918918918919, 0.07608695652173914, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.20449471210340775
Validation one_indexed_epoch: 13
Epoch 13/40
[[1. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 4 epochs
330/330 - 894s - accuracy: 0.5897 - student_loss: 0.4484 - distillation_loss: 0.0206 - val_accuracy: 0.7093 - val_student_loss: 2.4447e-06 - 894s/epoch - 3s/step
Validation cm: [[732   8   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [129   0   0   1]]
Validation normalized_cm: [[0.989 0.011 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.992 0.    0.    0.008]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.9891891891891892, 0.0, 0.0, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2492203742203742
Validation one_indexed_epoch: 14
Epoch 14/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 5 epochs
330/330 - 898s - accuracy: 0.5614 - student_loss: 0.3266 - distillation_loss: 0.0221 - val_accuracy: 0.0991 - val_student_loss: 3.4340e-09 - 898s/epoch - 3s/step
Validation cm: [[494 242   0   4]
 [ 22  69   0   1]
 [ 47  28   2   0]
 [ 35  91   2   2]]
Validation normalized_cm: [[0.668 0.327 0.    0.005]
 [0.239 0.75  0.    0.011]
 [0.61  0.364 0.026 0.   ]
 [0.269 0.7   0.015 0.015]]
Validation acc: 0.5457170356111646
Validation class_accuracies: [0.6675675675675675, 0.75, 0.025974025974025976, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36473155223155224
Validation one_indexed_epoch: 15
Epoch 15/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 6 epochs
330/330 - 901s - accuracy: 0.5548 - student_loss: 0.2499 - distillation_loss: -1.9382e-03 - val_accuracy: 0.9172 - val_student_loss: 3.1522e-05 - 901s/epoch - 3s/step
Validation cm: [[567 173   0   0]
 [ 85   7   0   0]
 [ 62  15   0   0]
 [122   7   1   0]]
Validation normalized_cm: [[0.766 0.234 0.    0.   ]
 [0.924 0.076 0.    0.   ]
 [0.805 0.195 0.    0.   ]
 [0.938 0.054 0.008 0.   ]]
Validation acc: 0.5524542829643888
Validation class_accuracies: [0.7662162162162162, 0.07608695652173914, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21057579318448882
Validation one_indexed_epoch: 16
Epoch 16/40
[[1. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 7 epochs
330/330 - 900s - accuracy: 0.5770 - student_loss: 0.5289 - distillation_loss: 0.0167 - val_accuracy: 0.4909 - val_student_loss: 7.3323e-04 - 900s/epoch - 3s/step
Validation cm: [[708  32   0   0]
 [ 90   2   0   0]
 [ 74   2   0   1]
 [127   1   1   1]]
Validation normalized_cm: [[0.957 0.043 0.    0.   ]
 [0.978 0.022 0.    0.   ]
 [0.961 0.026 0.    0.013]
 [0.977 0.008 0.008 0.008]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.9567567567567568, 0.021739130434782608, 0.0, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24654704872096175
Validation one_indexed_epoch: 17
Epoch 17/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 8 epochs
330/330 - 901s - accuracy: 0.5933 - student_loss: 0.3525 - distillation_loss: 0.0149 - val_accuracy: 0.2406 - val_student_loss: 6.6065e-04 - 901s/epoch - 3s/step
Validation cm: [[722   9   8   1]
 [ 89   0   3   0]
 [ 65   0  11   1]
 [125   2   2   1]]
Validation normalized_cm: [[0.976 0.012 0.011 0.001]
 [0.967 0.    0.033 0.   ]
 [0.844 0.    0.143 0.013]
 [0.962 0.015 0.015 0.008]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.9756756756756757, 0.0, 0.14285714285714285, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28155628155628154
Validation one_indexed_epoch: 18
Epoch 18/40
[[0. 0.]]
The validation tracker metric at 0.36769637530507093 hasn't increased by 0 in 9 epochs
330/330 - 904s - accuracy: 0.5933 - student_loss: 0.2131 - distillation_loss: 0.0126 - val_accuracy: 0.8162 - val_student_loss: 2.6165e-07 - 904s/epoch - 3s/step
Validation cm: [[728  11   1   0]
 [ 91   1   0   0]
 [ 75   2   0   0]
 [128   1   1   0]]
Validation normalized_cm: [[0.984 0.015 0.001 0.   ]
 [0.989 0.011 0.    0.   ]
 [0.974 0.026 0.    0.   ]
 [0.985 0.008 0.008 0.   ]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.9837837837837838, 0.010869565217391304, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2486633372502938
Validation one_indexed_epoch: 19
Epoch 19/40
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 902s - accuracy: 0.5994 - student_loss: 0.5139 - distillation_loss: 0.0046 - val_accuracy: 0.1347 - val_student_loss: 2.0182e-11 - 902s/epoch - 3s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.36769637530507093
Best cm: [[ 90 602   1  47]
 [  2  76   0  14]
 [ 14  48   0  15]
 [  2  60   0  68]]
Best normalized_cm: [[0.122 0.814 0.001 0.064]
 [0.022 0.826 0.    0.152]
 [0.182 0.623 0.    0.195]
 [0.015 0.462 0.    0.523]]
Best acc: 0.2252165543792108
Best class_accuracies: [0.12162162162162163, 0.8260869565217391, 0.0, 0.5230769230769231]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 9
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
