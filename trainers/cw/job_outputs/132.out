Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train132
Description:  debugging, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.15, 4 one hot encoder, softmax, oversampling, no spectral loss
-----------------------
Job id is 1.
Job dir: ../cache/cw/train132/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_129"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 1)                          4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 15, 1024)                            6191296          
                                                                                                              
 sequential_5 (Sequential)                       (None, 4)                                   1365978          
                                                                                                              
==============================================================================================================
Total params: 7,566,272
Trainable params: 7,524,766
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
68/68 - 168s - loss: 1.3030 - accuracy: 0.3769 - 168s/epoch - 2s/step
Epoch 2/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 149s - loss: 1.2445 - accuracy: 0.4127 - 149s/epoch - 2s/step
Epoch 3/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 150s - loss: 1.2011 - accuracy: 0.4360 - 150s/epoch - 2s/step
Epoch 4/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 150s - loss: 1.1683 - accuracy: 0.4688 - 150s/epoch - 2s/step
Epoch 5/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 151s - loss: 1.1110 - accuracy: 0.4951 - 151s/epoch - 2s/step
Epoch 6/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
68/68 - 150s - loss: 1.0571 - accuracy: 0.4934 - 150s/epoch - 2s/step
Epoch 7/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
There is no such attribute
68/68 - 151s - loss: 0.9688 - accuracy: 0.5489 - 151s/epoch - 2s/step
Epoch 8/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
There is no such attribute
68/68 - 148s - loss: 0.9302 - accuracy: 0.5721 - 148s/epoch - 2s/step
Epoch 9/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
There is no such attribute
68/68 - 149s - loss: 0.9108 - accuracy: 0.5873 - 149s/epoch - 2s/step
Epoch 10/60
Validation cm: [[796  69  25   1]
 [561  24   3   1]
 [ 70   6   1   3]
 [132   6  14   4]]
Validation normalized_cm: [[0.893 0.077 0.028 0.001]
 [0.952 0.041 0.005 0.002]
 [0.875 0.075 0.013 0.037]
 [0.846 0.038 0.09  0.026]]
Validation acc: 0.4807692307692308
Validation class_accuracies: [0.8933782267115601, 0.04074702886247878, 0.0125, 0.02564102564102564]
Validation sensitivity: 0.03515151515151515
Validation specificity: 0.8933782267115601
Validation icbhi_score: 0.4642648709315376
Validation roc_auc: None
Validation avg_accuracy: 0.24306657030376613
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
There is no such attribute
68/68 - 150s - loss: 0.8730 - accuracy: 0.6082 - 150s/epoch - 2s/step
Epoch 11/60
Validation cm: [[356 469  23  43]
 [176 398   7   8]
 [ 17  48   6   9]
 [ 26  90  12  28]]
Validation normalized_cm: [[0.4   0.526 0.026 0.048]
 [0.299 0.676 0.012 0.014]
 [0.212 0.6   0.075 0.113]
 [0.167 0.577 0.077 0.179]]
Validation acc: 0.4592074592074592
Validation class_accuracies: [0.3995510662177329, 0.6757215619694398, 0.075, 0.1794871794871795]
Validation sensitivity: 0.5236363636363637
Validation specificity: 0.3995510662177329
Validation icbhi_score: 0.46159371492704826
Validation roc_auc: None
Validation avg_accuracy: 0.33243995191858805
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 150s - loss: 0.8543 - accuracy: 0.6213 - 150s/epoch - 2s/step
Epoch 12/60
Validation cm: [[792  90   9   0]
 [546  29   7   7]
 [ 67   9   4   0]
 [129   7  19   1]]
Validation normalized_cm: [[0.889 0.101 0.01  0.   ]
 [0.927 0.049 0.012 0.012]
 [0.838 0.113 0.05  0.   ]
 [0.827 0.045 0.122 0.006]]
Validation acc: 0.4813519813519814
Validation class_accuracies: [0.8888888888888888, 0.04923599320882852, 0.05, 0.00641025641025641]
Validation sensitivity: 0.041212121212121214
Validation specificity: 0.8888888888888888
Validation icbhi_score: 0.46505050505050505
Validation roc_auc: None
Validation avg_accuracy: 0.24863378462699345
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
There is no such attribute
68/68 - 150s - loss: 0.7664 - accuracy: 0.6606 - 150s/epoch - 2s/step
Epoch 13/60
Validation cm: [[619 100 100  72]
 [481  47  29  32]
 [ 35  10  23  12]
 [ 65  22  45  24]]
Validation normalized_cm: [[0.695 0.112 0.112 0.081]
 [0.817 0.08  0.049 0.054]
 [0.438 0.125 0.287 0.15 ]
 [0.417 0.141 0.288 0.154]]
Validation acc: 0.4155011655011655
Validation class_accuracies: [0.6947250280583613, 0.07979626485568761, 0.2875, 0.15384615384615385]
Validation sensitivity: 0.11393939393939394
Validation specificity: 0.6947250280583613
Validation icbhi_score: 0.4043322109988776
Validation roc_auc: None
Validation avg_accuracy: 0.3039668616900507
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
There is no such attribute
68/68 - 150s - loss: 0.7466 - accuracy: 0.6735 - 150s/epoch - 2s/step
Epoch 14/60
Validation cm: [[776  27  81   7]
 [549  14  24   2]
 [ 60   1  19   0]
 [112   2  40   2]]
Validation normalized_cm: [[0.871 0.03  0.091 0.008]
 [0.932 0.024 0.041 0.003]
 [0.75  0.013 0.237 0.   ]
 [0.718 0.013 0.256 0.013]]
Validation acc: 0.4726107226107226
Validation class_accuracies: [0.8709315375982043, 0.023769100169779286, 0.2375, 0.01282051282051282]
Validation sensitivity: 0.04242424242424243
Validation specificity: 0.8709315375982043
Validation icbhi_score: 0.4566778900112234
Validation roc_auc: None
Validation avg_accuracy: 0.2862552876471241
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
There is no such attribute
68/68 - 154s - loss: 0.7121 - accuracy: 0.6921 - 154s/epoch - 2s/step
Epoch 15/60
Validation cm: [[252 555   6  78]
 [225 324   5  35]
 [ 13  48   8  11]
 [ 44  61   5  46]]
Validation normalized_cm: [[0.283 0.623 0.007 0.088]
 [0.382 0.55  0.008 0.059]
 [0.163 0.6   0.1   0.138]
 [0.282 0.391 0.032 0.295]]
Validation acc: 0.36713286713286714
Validation class_accuracies: [0.2828282828282828, 0.5500848896434635, 0.1, 0.2948717948717949]
Validation sensitivity: 0.4581818181818182
Validation specificity: 0.2828282828282828
Validation icbhi_score: 0.3705050505050505
Validation roc_auc: None
Validation avg_accuracy: 0.30694624183588526
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
There is no such attribute
68/68 - 152s - loss: 0.6826 - accuracy: 0.7213 - 152s/epoch - 2s/step
Epoch 16/60
Validation cm: [[513 296  57  25]
 [312 254   5  18]
 [ 45  21   8   6]
 [ 49  49  19  39]]
Validation normalized_cm: [[0.576 0.332 0.064 0.028]
 [0.53  0.431 0.008 0.031]
 [0.562 0.263 0.1   0.075]
 [0.314 0.314 0.122 0.25 ]]
Validation acc: 0.47435897435897434
Validation class_accuracies: [0.5757575757575758, 0.4312393887945671, 0.1, 0.25]
Validation sensitivity: 0.36484848484848487
Validation specificity: 0.5757575757575758
Validation icbhi_score: 0.47030303030303033
Validation roc_auc: None
Validation avg_accuracy: 0.33924924113803573
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
68/68 - 152s - loss: 0.6479 - accuracy: 0.7261 - 152s/epoch - 2s/step
Epoch 17/60
Validation cm: [[646 117  67  61]
 [457  88  23  21]
 [ 48  12  16   4]
 [ 70  38  31  17]]
Validation normalized_cm: [[0.725 0.131 0.075 0.068]
 [0.776 0.149 0.039 0.036]
 [0.6   0.15  0.2   0.05 ]
 [0.449 0.244 0.199 0.109]]
Validation acc: 0.44696969696969696
Validation class_accuracies: [0.7250280583613917, 0.1494057724957555, 0.2, 0.10897435897435898]
Validation sensitivity: 0.14666666666666667
Validation specificity: 0.7250280583613917
Validation icbhi_score: 0.4358473625140292
Validation roc_auc: None
Validation avg_accuracy: 0.2958520474578766
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5 hasn't increased by 0 in 16 epochs
There is no such attribute
68/68 - 151s - loss: 0.5815 - accuracy: 0.7632 - 151s/epoch - 2s/step
Epoch 18/60
Validation cm: [[693 111  44  43]
 [469  92  17  11]
 [ 55  12   9   4]
 [ 76  43  15  22]]
Validation normalized_cm: [[0.778 0.125 0.049 0.048]
 [0.796 0.156 0.029 0.019]
 [0.688 0.15  0.113 0.05 ]
 [0.487 0.276 0.096 0.141]]
Validation acc: 0.4755244755244755
Validation class_accuracies: [0.7777777777777778, 0.15619694397283532, 0.1125, 0.14102564102564102]
Validation sensitivity: 0.14909090909090908
Validation specificity: 0.7777777777777778
Validation icbhi_score: 0.4634343434343434
Validation roc_auc: None
Validation avg_accuracy: 0.29687509069406354
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5 hasn't increased by 0 in 17 epochs
There is no such attribute
68/68 - 148s - loss: 0.5436 - accuracy: 0.7843 - 148s/epoch - 2s/step
Epoch 19/60
Validation cm: [[552 265  19  55]
 [381 181  16  11]
 [ 39  27   7   7]
 [ 51  60   9  36]]
Validation normalized_cm: [[0.62  0.297 0.021 0.062]
 [0.647 0.307 0.027 0.019]
 [0.487 0.338 0.087 0.087]
 [0.327 0.385 0.058 0.231]]
Validation acc: 0.4522144522144522
Validation class_accuracies: [0.6195286195286195, 0.3073005093378608, 0.0875, 0.23076923076923078]
Validation sensitivity: 0.27151515151515154
Validation specificity: 0.6195286195286195
Validation icbhi_score: 0.44552188552188554
Validation roc_auc: None
Validation avg_accuracy: 0.31127458990892776
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5 hasn't increased by 0 in 18 epochs
There is no such attribute
68/68 - 149s - loss: 0.5178 - accuracy: 0.7949 - 149s/epoch - 2s/step
Epoch 20/60
Validation cm: [[215 656   1  19]
 [103 464   6  16]
 [ 10  63   0   7]
 [ 10 113   0  33]]
Validation normalized_cm: [[0.241 0.736 0.001 0.021]
 [0.175 0.788 0.01  0.027]
 [0.125 0.787 0.    0.087]
 [0.064 0.724 0.    0.212]]
Validation acc: 0.4149184149184149
Validation class_accuracies: [0.24130190796857465, 0.7877758913412564, 0.0, 0.21153846153846154]
Validation sensitivity: 0.6024242424242424
Validation specificity: 0.24130190796857465
Validation icbhi_score: 0.42186307519640853
Validation roc_auc: None
Validation avg_accuracy: 0.3101540652120731
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5 hasn't increased by 0 in 19 epochs
There is no such attribute
68/68 - 154s - loss: 0.4725 - accuracy: 0.8112 - 154s/epoch - 2s/step
Epoch 21/60
Validation cm: [[570 211  52  58]
 [403 154  13  19]
 [ 39  23  10   8]
 [ 54  57  11  34]]
Validation normalized_cm: [[0.64  0.237 0.058 0.065]
 [0.684 0.261 0.022 0.032]
 [0.487 0.287 0.125 0.1  ]
 [0.346 0.365 0.071 0.218]]
Validation acc: 0.44755244755244755
Validation class_accuracies: [0.6397306397306397, 0.2614601018675722, 0.125, 0.21794871794871795]
Validation sensitivity: 0.24
Validation specificity: 0.6397306397306397
Validation icbhi_score: 0.43986531986531985
Validation roc_auc: None
Validation avg_accuracy: 0.3110348648867325
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 6.25000029685907e-05
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 152s - loss: 0.4700 - accuracy: 0.8188 - 152s/epoch - 2s/step
Epoch 22/60
Validation cm: [[696 115  37  43]
 [504  54  16  15]
 [ 57  11  10   2]
 [ 82  33  21  20]]
Validation normalized_cm: [[0.781 0.129 0.042 0.048]
 [0.856 0.092 0.027 0.025]
 [0.713 0.138 0.125 0.025]
 [0.526 0.212 0.135 0.128]]
Validation acc: 0.45454545454545453
Validation class_accuracies: [0.7811447811447811, 0.09168081494057725, 0.125, 0.1282051282051282]
Validation sensitivity: 0.10181818181818182
Validation specificity: 0.7811447811447811
Validation icbhi_score: 0.4414814814814815
Validation roc_auc: None
Validation avg_accuracy: 0.28150768107262164
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5 hasn't increased by 0 in 21 epochs
There is no such attribute
68/68 - 152s - loss: 0.3963 - accuracy: 0.8517 - 152s/epoch - 2s/step
Epoch 23/60
Validation cm: [[684  91  51  65]
 [474  80  20  15]
 [ 48   9  16   7]
 [ 80  32  16  28]]
Validation normalized_cm: [[0.768 0.102 0.057 0.073]
 [0.805 0.136 0.034 0.025]
 [0.6   0.113 0.2   0.087]
 [0.513 0.205 0.103 0.179]]
Validation acc: 0.47086247086247085
Validation class_accuracies: [0.7676767676767676, 0.13582342954159593, 0.2, 0.1794871794871795]
Validation sensitivity: 0.1503030303030303
Validation specificity: 0.7676767676767676
Validation icbhi_score: 0.45898989898989895
Validation roc_auc: None
Validation avg_accuracy: 0.32074684417638577
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5 hasn't increased by 0 in 22 epochs
There is no such attribute
68/68 - 152s - loss: 0.3821 - accuracy: 0.8593 - 152s/epoch - 2s/step
Epoch 24/60
Validation cm: [[514 279  33  65]
 [328 230  14  17]
 [ 39  25   9   7]
 [ 48  65   8  35]]
Validation normalized_cm: [[0.577 0.313 0.037 0.073]
 [0.557 0.39  0.024 0.029]
 [0.487 0.312 0.113 0.087]
 [0.308 0.417 0.051 0.224]]
Validation acc: 0.4592074592074592
Validation class_accuracies: [0.5768799102132436, 0.3904923599320883, 0.1125, 0.22435897435897437]
Validation sensitivity: 0.3321212121212121
Validation specificity: 0.5768799102132436
Validation icbhi_score: 0.4545005611672278
Validation roc_auc: None
Validation avg_accuracy: 0.32605781112607657
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5 hasn't increased by 0 in 23 epochs
There is no such attribute
68/68 - 157s - loss: 0.3586 - accuracy: 0.8655 - 157s/epoch - 2s/step
Epoch 25/60
Validation cm: [[541 264  34  52]
 [354 208  14  13]
 [ 40  26  11   3]
 [ 51  60  11  34]]
Validation normalized_cm: [[0.607 0.296 0.038 0.058]
 [0.601 0.353 0.024 0.022]
 [0.5   0.325 0.138 0.037]
 [0.327 0.385 0.071 0.218]]
Validation acc: 0.4627039627039627
Validation class_accuracies: [0.6071829405162739, 0.3531409168081494, 0.1375, 0.21794871794871795]
Validation sensitivity: 0.30666666666666664
Validation specificity: 0.6071829405162739
Validation icbhi_score: 0.45692480359147025
Validation roc_auc: None
Validation avg_accuracy: 0.32894314381828527
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5 hasn't increased by 0 in 24 epochs
There is no such attribute
68/68 - 152s - loss: 0.3387 - accuracy: 0.8733 - 152s/epoch - 2s/step
Epoch 26/60
Validation cm: [[537 206  72  76]
 [344 198  26  21]
 [ 40  17  15   8]
 [ 64  38  20  34]]
Validation normalized_cm: [[0.603 0.231 0.081 0.085]
 [0.584 0.336 0.044 0.036]
 [0.5   0.212 0.188 0.1  ]
 [0.41  0.244 0.128 0.218]]
Validation acc: 0.4568764568764569
Validation class_accuracies: [0.6026936026936027, 0.3361629881154499, 0.1875, 0.21794871794871795]
Validation sensitivity: 0.2993939393939394
Validation specificity: 0.6026936026936027
Validation icbhi_score: 0.451043771043771
Validation roc_auc: None
Validation avg_accuracy: 0.3360763271894427
Validation one_indexed_epoch: 26
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
68/68 - 152s - loss: 0.3274 - accuracy: 0.8779 - 152s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5
Best cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Best normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Best acc: 0.5192307692307693
Best class_accuracies: [1.0, 0.0, 0.0, 0.0]
Best sensitivity: 0.0
Best specificity: 1.0
Best roc_auc: None
Best avg_accuracy: 0.25
Best one_indexed_epoch: 1
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [1.3029639720916748, 1.2444615364074707, 1.2011423110961914, 1.1682685613632202, 1.1110056638717651, 1.0570952892303467, 0.9688022136688232, 0.9302129149436951, 0.9108395576477051, 0.8729684352874756, 0.8543079495429993, 0.766396164894104, 0.7465996146202087, 0.7120861411094666, 0.6826155185699463, 0.6479091048240662, 0.5814714431762695, 0.5436359643936157, 0.5177523493766785, 0.4724772274494171, 0.46995851397514343, 0.39626359939575195, 0.38210156559944153, 0.35858702659606934, 0.33874595165252686, 0.32742974162101746], 'accuracy': [0.37686824798583984, 0.412738561630249, 0.4359622895717621, 0.46884340047836304, 0.4950563311576843, 0.4934467673301697, 0.5488618016242981, 0.5720855593681335, 0.587261438369751, 0.6081857681274414, 0.621292233467102, 0.660611629486084, 0.6734881401062012, 0.6921131014823914, 0.7213152647018433, 0.7261439561843872, 0.7631639242172241, 0.784318208694458, 0.794895350933075, 0.8112209439277649, 0.818808913230896, 0.8516900539398193, 0.8592780232429504, 0.8654863238334656, 0.8733041882514954, 0.8779029846191406]}
Job dir: ../cache/cw/train132/2
Job id is 3.
Job dir: ../cache/cw/train132/3
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 4.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_efnet"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_6 (Sequential)                       (None, 4)                                   6580363          
                                                                                                              
==============================================================================================================
Total params: 6,580,525
Trainable params: 6,518,470
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[293 594   4   0]
 [116 473   0   0]
 [ 34  46   0   0]
 [ 52 104   0   0]]
Validation normalized_cm: [[0.329 0.667 0.004 0.   ]
 [0.197 0.803 0.    0.   ]
 [0.425 0.575 0.    0.   ]
 [0.333 0.667 0.    0.   ]]
Validation acc: 0.44638694638694637
Validation class_accuracies: [0.3288439955106622, 0.8030560271646859, 0.0, 0.0]
Validation sensitivity: 0.5733333333333334
Validation specificity: 0.3288439955106622
Validation icbhi_score: 0.4510886644219978
Validation roc_auc: None
Validation avg_accuracy: 0.28297500566883704
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
68/68 - 152s - loss: 1.0655 - accuracy: 0.5332 - 152s/epoch - 2s/step
Epoch 2/60
Validation cm: [[879   1   5   6]
 [588   0   0   1]
 [ 79   0   0   1]
 [144   3   2   7]]
Validation normalized_cm: [[0.987 0.001 0.006 0.007]
 [0.998 0.    0.    0.002]
 [0.988 0.    0.    0.013]
 [0.923 0.019 0.013 0.045]]
Validation acc: 0.5163170163170163
Validation class_accuracies: [0.9865319865319865, 0.0, 0.0, 0.04487179487179487]
Validation sensitivity: 0.008484848484848486
Validation specificity: 0.9865319865319865
Validation icbhi_score: 0.4975084175084175
Validation roc_auc: None
Validation avg_accuracy: 0.2578509453509453
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
68/68 - 135s - loss: 0.7315 - accuracy: 0.6997 - 135s/epoch - 2s/step
Epoch 3/60
Validation cm: [[877   2  12   0]
 [588   0   1   0]
 [ 77   0   2   1]
 [148   0   8   0]]
Validation normalized_cm: [[0.984 0.002 0.013 0.   ]
 [0.998 0.    0.002 0.   ]
 [0.963 0.    0.025 0.013]
 [0.949 0.    0.051 0.   ]]
Validation acc: 0.5122377622377622
Validation class_accuracies: [0.9842873176206509, 0.0, 0.025, 0.0]
Validation sensitivity: 0.0024242424242424242
Validation specificity: 0.9842873176206509
Validation icbhi_score: 0.4933557800224467
Validation roc_auc: None
Validation avg_accuracy: 0.25232182940516273
Validation one_indexed_epoch: 3
The validation tracker metric at 0.4975084175084175 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 135s - loss: 0.5554 - accuracy: 0.7744 - 135s/epoch - 2s/step
Epoch 4/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [155   1   0   0]]
Validation normalized_cm: [[1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.994 0.006 0.    0.   ]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
68/68 - 135s - loss: 0.4048 - accuracy: 0.8457 - 135s/epoch - 2s/step
Epoch 5/60
Validation cm: [[861   9  14   7]
 [567  21   1   0]
 [ 74   0   4   2]
 [130   8  15   3]]
Validation normalized_cm: [[0.966 0.01  0.016 0.008]
 [0.963 0.036 0.002 0.   ]
 [0.925 0.    0.05  0.025]
 [0.833 0.051 0.096 0.019]]
Validation acc: 0.5180652680652681
Validation class_accuracies: [0.9663299663299664, 0.035653650254668934, 0.05, 0.019230769230769232]
Validation sensitivity: 0.03393939393939394
Validation specificity: 0.9663299663299664
Validation icbhi_score: 0.5001346801346802
Validation roc_auc: None
Validation avg_accuracy: 0.26780359645385116
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
68/68 - 136s - loss: 0.3147 - accuracy: 0.8814 - 136s/epoch - 2s/step
Epoch 6/60
Validation cm: [[860  22   3   6]
 [548  29   1  11]
 [ 73   2   2   3]
 [122   7  20   7]]
Validation normalized_cm: [[0.965 0.025 0.003 0.007]
 [0.93  0.049 0.002 0.019]
 [0.912 0.025 0.025 0.037]
 [0.782 0.045 0.128 0.045]]
Validation acc: 0.5233100233100233
Validation class_accuracies: [0.9652076318742986, 0.04923599320882852, 0.025, 0.04487179487179487]
Validation sensitivity: 0.04606060606060606
Validation specificity: 0.9652076318742986
Validation icbhi_score: 0.5056341189674524
Validation roc_auc: None
Validation avg_accuracy: 0.27107885498873047
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
68/68 - 137s - loss: 0.2465 - accuracy: 0.9078 - 137s/epoch - 2s/step
Epoch 7/60
Validation cm: [[881   6   4   0]
 [556  33   0   0]
 [ 73   0   3   4]
 [133  11   8   4]]
Validation normalized_cm: [[0.989 0.007 0.004 0.   ]
 [0.944 0.056 0.    0.   ]
 [0.912 0.    0.037 0.05 ]
 [0.853 0.071 0.051 0.026]]
Validation acc: 0.5367132867132867
Validation class_accuracies: [0.9887766554433222, 0.05602716468590832, 0.0375, 0.02564102564102564]
Validation sensitivity: 0.048484848484848485
Validation specificity: 0.9887766554433222
Validation icbhi_score: 0.5186307519640854
Validation roc_auc: None
Validation avg_accuracy: 0.276986211442564
Validation one_indexed_epoch: 7
-- New best results were achieved. --
There is no such attribute
68/68 - 137s - loss: 0.1979 - accuracy: 0.9322 - 137s/epoch - 2s/step
Epoch 8/60
Validation cm: [[809  16  60   6]
 [527  47  11   4]
 [ 53   1  12  14]
 [ 93  12  46   5]]
Validation normalized_cm: [[0.908 0.018 0.067 0.007]
 [0.895 0.08  0.019 0.007]
 [0.662 0.013 0.15  0.175]
 [0.596 0.077 0.295 0.032]]
Validation acc: 0.5087412587412588
Validation class_accuracies: [0.9079685746352413, 0.07979626485568761, 0.15, 0.03205128205128205]
Validation sensitivity: 0.07757575757575758
Validation specificity: 0.9079685746352413
Validation icbhi_score: 0.49277216610549945
Validation roc_auc: None
Validation avg_accuracy: 0.29245403038555273
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5186307519640854 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 137s - loss: 0.1250 - accuracy: 0.9552 - 137s/epoch - 2s/step
Epoch 9/60
Validation cm: [[871  17   3   0]
 [539  47   3   0]
 [ 66   5   7   2]
 [116  13  26   1]]
Validation normalized_cm: [[0.978 0.019 0.003 0.   ]
 [0.915 0.08  0.005 0.   ]
 [0.825 0.062 0.087 0.025]
 [0.744 0.083 0.167 0.006]]
Validation acc: 0.5396270396270396
Validation class_accuracies: [0.9775533108866442, 0.07979626485568761, 0.0875, 0.00641025641025641]
Validation sensitivity: 0.06666666666666667
Validation specificity: 0.9775533108866442
Validation icbhi_score: 0.5221099887766555
Validation roc_auc: None
Validation avg_accuracy: 0.28781495803814705
Validation one_indexed_epoch: 9
-- New best results were achieved. --
There is no such attribute
68/68 - 137s - loss: 0.1184 - accuracy: 0.9600 - 137s/epoch - 2s/step
Epoch 10/60
Validation cm: [[768  57  66   0]
 [510  58  19   2]
 [ 51   3  22   4]
 [ 97  13  44   2]]
Validation normalized_cm: [[0.862 0.064 0.074 0.   ]
 [0.866 0.098 0.032 0.003]
 [0.637 0.037 0.275 0.05 ]
 [0.622 0.083 0.282 0.013]]
Validation acc: 0.49533799533799533
Validation class_accuracies: [0.8619528619528619, 0.09847198641765705, 0.275, 0.01282051282051282]
Validation sensitivity: 0.0993939393939394
Validation specificity: 0.8619528619528619
Validation icbhi_score: 0.48067340067340064
Validation roc_auc: None
Validation avg_accuracy: 0.31206134029775795
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5221099887766555 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 137s - loss: 0.1285 - accuracy: 0.9524 - 137s/epoch - 2s/step
Epoch 11/60
Validation cm: [[686  39  92  74]
 [416  67  19  87]
 [ 34   0  27  19]
 [ 72   7  51  26]]
Validation normalized_cm: [[0.77  0.044 0.103 0.083]
 [0.706 0.114 0.032 0.148]
 [0.425 0.    0.338 0.237]
 [0.462 0.045 0.327 0.167]]
Validation acc: 0.4696969696969697
Validation class_accuracies: [0.7699214365881033, 0.11375212224108659, 0.3375, 0.16666666666666666]
Validation sensitivity: 0.14545454545454545
Validation specificity: 0.7699214365881033
Validation icbhi_score: 0.4576879910213244
Validation roc_auc: None
Validation avg_accuracy: 0.34696005637396415
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5221099887766555 hasn't increased by 0 in 2 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 138s - loss: 0.1148 - accuracy: 0.9609 - 138s/epoch - 2s/step
Epoch 12/60
Validation cm: [[670 115 104   2]
 [393 152  38   6]
 [ 40   7  30   3]
 [ 63  37  54   2]]
Validation normalized_cm: [[0.752 0.129 0.117 0.002]
 [0.667 0.258 0.065 0.01 ]
 [0.5   0.087 0.375 0.037]
 [0.404 0.237 0.346 0.013]]
Validation acc: 0.4976689976689977
Validation class_accuracies: [0.7519640852974186, 0.25806451612903225, 0.375, 0.01282051282051282]
Validation sensitivity: 0.22303030303030302
Validation specificity: 0.7519640852974186
Validation icbhi_score: 0.48749719416386084
Validation roc_auc: None
Validation avg_accuracy: 0.34946227856174095
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5221099887766555 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 138s - loss: 0.1123 - accuracy: 0.9618 - 138s/epoch - 2s/step
Epoch 13/60
Validation cm: [[642 150  27  72]
 [405 151   8  25]
 [ 36  11   3  30]
 [ 65  18  20  53]]
Validation normalized_cm: [[0.721 0.168 0.03  0.081]
 [0.688 0.256 0.014 0.042]
 [0.45  0.138 0.037 0.375]
 [0.417 0.115 0.128 0.34 ]]
Validation acc: 0.49475524475524474
Validation class_accuracies: [0.7205387205387206, 0.2563667232597623, 0.0375, 0.33974358974358976]
Validation sensitivity: 0.2509090909090909
Validation specificity: 0.7205387205387206
Validation icbhi_score: 0.4857239057239058
Validation roc_auc: None
Validation avg_accuracy: 0.3385372583855182
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5221099887766555 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 138s - loss: 0.0904 - accuracy: 0.9669 - 138s/epoch - 2s/step
Epoch 14/60
Validation cm: [[758   7 118   8]
 [511  31  42   5]
 [ 71   0   9   0]
 [143   3  10   0]]
Validation normalized_cm: [[0.851 0.008 0.132 0.009]
 [0.868 0.053 0.071 0.008]
 [0.887 0.    0.113 0.   ]
 [0.917 0.019 0.064 0.   ]]
Validation acc: 0.46503496503496505
Validation class_accuracies: [0.8507295173961841, 0.05263157894736842, 0.1125, 0.0]
Validation sensitivity: 0.048484848484848485
Validation specificity: 0.8507295173961841
Validation icbhi_score: 0.44960718294051627
Validation roc_auc: None
Validation avg_accuracy: 0.25396527408588815
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5221099887766555 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
68/68 - 137s - loss: 0.0748 - accuracy: 0.9719 - 137s/epoch - 2s/step
Epoch 15/60
Validation cm: [[570 269  22  30]
 [237 323   5  24]
 [ 25  28   9  18]
 [ 38  59  20  39]]
Validation normalized_cm: [[0.64  0.302 0.025 0.034]
 [0.402 0.548 0.008 0.041]
 [0.312 0.35  0.113 0.225]
 [0.244 0.378 0.128 0.25 ]]
Validation acc: 0.5483682983682984
Validation class_accuracies: [0.6397306397306397, 0.5483870967741935, 0.1125, 0.25]
Validation sensitivity: 0.4496969696969697
Validation specificity: 0.6397306397306397
Validation icbhi_score: 0.5447138047138047
Validation roc_auc: None
Validation avg_accuracy: 0.3876544341262083
Validation one_indexed_epoch: 15
-- New best results were achieved. --
There is no such attribute
68/68 - 138s - loss: 0.0451 - accuracy: 0.9841 - 138s/epoch - 2s/step
Epoch 16/60
Validation cm: [[508 294  38  51]
 [269 292   4  24]
 [ 26  21   9  24]
 [ 41  62  18  35]]
Validation normalized_cm: [[0.57  0.33  0.043 0.057]
 [0.457 0.496 0.007 0.041]
 [0.325 0.263 0.113 0.3  ]
 [0.263 0.397 0.115 0.224]]
Validation acc: 0.49184149184149184
Validation class_accuracies: [0.5701459034792368, 0.49575551782682514, 0.1125, 0.22435897435897437]
Validation sensitivity: 0.4072727272727273
Validation specificity: 0.5701459034792368
Validation icbhi_score: 0.48870931537598206
Validation roc_auc: None
Validation avg_accuracy: 0.3506900989162591
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 138s - loss: 0.0254 - accuracy: 0.9922 - 138s/epoch - 2s/step
Epoch 17/60
Validation cm: [[598 162  63  68]
 [246 287  27  29]
 [ 36   6  22  16]
 [ 41  41  40  34]]
Validation normalized_cm: [[0.671 0.182 0.071 0.076]
 [0.418 0.487 0.046 0.049]
 [0.45  0.075 0.275 0.2  ]
 [0.263 0.263 0.256 0.218]]
Validation acc: 0.5483682983682984
Validation class_accuracies: [0.6711560044893379, 0.4872665534804754, 0.275, 0.21794871794871795]
Validation sensitivity: 0.41575757575757577
Validation specificity: 0.6711560044893379
Validation icbhi_score: 0.5434567901234568
Validation roc_auc: None
Validation avg_accuracy: 0.4128428189796328
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 138s - loss: 0.0134 - accuracy: 0.9963 - 138s/epoch - 2s/step
Epoch 18/60
Validation cm: [[574 139 154  24]
 [271 234  60  24]
 [ 26   6  39   9]
 [ 45  29  73   9]]
Validation normalized_cm: [[0.644 0.156 0.173 0.027]
 [0.46  0.397 0.102 0.041]
 [0.325 0.075 0.487 0.113]
 [0.288 0.186 0.468 0.058]]
Validation acc: 0.4988344988344988
Validation class_accuracies: [0.6442199775533108, 0.39728353140916806, 0.4875, 0.057692307692307696]
Validation sensitivity: 0.3418181818181818
Validation specificity: 0.6442199775533108
Validation icbhi_score: 0.4930190796857463
Validation roc_auc: None
Validation avg_accuracy: 0.39667395416369666
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 138s - loss: 0.0106 - accuracy: 0.9977 - 138s/epoch - 2s/step
Epoch 19/60
Validation cm: [[324 384 110  73]
 [126 394  25  44]
 [ 14  19  32  15]
 [ 16  66  44  30]]
Validation normalized_cm: [[0.364 0.431 0.123 0.082]
 [0.214 0.669 0.042 0.075]
 [0.175 0.237 0.4   0.188]
 [0.103 0.423 0.282 0.192]]
Validation acc: 0.45454545454545453
Validation class_accuracies: [0.36363636363636365, 0.6689303904923599, 0.4, 0.19230769230769232]
Validation sensitivity: 0.5527272727272727
Validation specificity: 0.36363636363636365
Validation icbhi_score: 0.4581818181818182
Validation roc_auc: None
Validation avg_accuracy: 0.40621861160910394
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 136s - loss: 0.0069 - accuracy: 0.9989 - 136s/epoch - 2s/step
Epoch 20/60
Validation cm: [[613 181  34  63]
 [258 286   7  38]
 [ 34   8  16  22]
 [ 32  58  24  42]]
Validation normalized_cm: [[0.688 0.203 0.038 0.071]
 [0.438 0.486 0.012 0.065]
 [0.425 0.1   0.2   0.275]
 [0.205 0.372 0.154 0.269]]
Validation acc: 0.5576923076923077
Validation class_accuracies: [0.6879910213243546, 0.4855687606112054, 0.2, 0.2692307692307692]
Validation sensitivity: 0.416969696969697
Validation specificity: 0.6879910213243546
Validation icbhi_score: 0.5524803591470258
Validation roc_auc: None
Validation avg_accuracy: 0.4106976377915823
Validation one_indexed_epoch: 20
-- New best results were achieved. --
There is no such attribute
68/68 - 137s - loss: 0.0062 - accuracy: 0.9982 - 137s/epoch - 2s/step
Epoch 21/60
Validation cm: [[586 195  56  54]
 [262 302  10  15]
 [ 32   9  18  21]
 [ 39  57  39  21]]
Validation normalized_cm: [[0.658 0.219 0.063 0.061]
 [0.445 0.513 0.017 0.025]
 [0.4   0.113 0.225 0.263]
 [0.25  0.365 0.25  0.135]]
Validation acc: 0.5402097902097902
Validation class_accuracies: [0.6576879910213244, 0.5127334465195246, 0.225, 0.1346153846153846]
Validation sensitivity: 0.41333333333333333
Validation specificity: 0.6576879910213244
Validation icbhi_score: 0.5355106621773289
Validation roc_auc: None
Validation avg_accuracy: 0.38250920553905843
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5524803591470258 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 138s - loss: 0.0053 - accuracy: 0.9989 - 138s/epoch - 2s/step
Epoch 22/60
Validation cm: [[440 321  37  93]
 [156 395   8  30]
 [ 24  17  13  26]
 [ 26  67  24  39]]
Validation normalized_cm: [[0.494 0.36  0.042 0.104]
 [0.265 0.671 0.014 0.051]
 [0.3   0.212 0.163 0.325]
 [0.167 0.429 0.154 0.25 ]]
Validation acc: 0.5168997668997669
Validation class_accuracies: [0.49382716049382713, 0.6706281833616299, 0.1625, 0.25]
Validation sensitivity: 0.5418181818181819
Validation specificity: 0.49382716049382713
Validation icbhi_score: 0.5178226711560046
Validation roc_auc: None
Validation avg_accuracy: 0.3942388359638643
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5524803591470258 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 138s - loss: 0.0090 - accuracy: 0.9975 - 138s/epoch - 2s/step
Epoch 23/60
Validation cm: [[773  54  37  27]
 [414 164   6   5]
 [ 52   3  13  12]
 [ 85  23  33  15]]
Validation normalized_cm: [[0.868 0.061 0.042 0.03 ]
 [0.703 0.278 0.01  0.008]
 [0.65  0.037 0.163 0.15 ]
 [0.545 0.147 0.212 0.096]]
Validation acc: 0.5623543123543123
Validation class_accuracies: [0.867564534231201, 0.27843803056027167, 0.1625, 0.09615384615384616]
Validation sensitivity: 0.23272727272727273
Validation specificity: 0.867564534231201
Validation icbhi_score: 0.5501459034792369
Validation roc_auc: None
Validation avg_accuracy: 0.35116410273632975
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5524803591470258 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 138s - loss: 0.0055 - accuracy: 0.9984 - 138s/epoch - 2s/step
Epoch 24/60
Validation cm: [[588 219  61  23]
 [322 246  12   9]
 [ 31  17  19  13]
 [ 46  50  50  10]]
Validation normalized_cm: [[0.66  0.246 0.068 0.026]
 [0.547 0.418 0.02  0.015]
 [0.388 0.212 0.237 0.163]
 [0.295 0.321 0.321 0.064]]
Validation acc: 0.502913752913753
Validation class_accuracies: [0.6599326599326599, 0.41765704584040747, 0.2375, 0.0641025641025641]
Validation sensitivity: 0.3333333333333333
Validation specificity: 0.6599326599326599
Validation icbhi_score: 0.49663299663299665
Validation roc_auc: None
Validation avg_accuracy: 0.3447980674689079
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5524803591470258 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 137s - loss: 0.0108 - accuracy: 0.9968 - 137s/epoch - 2s/step
Epoch 25/60
Validation cm: [[724 106   5  56]
 [450 123   4  12]
 [ 56   3   1  20]
 [ 76  35   8  37]]
Validation normalized_cm: [[0.813 0.119 0.006 0.063]
 [0.764 0.209 0.007 0.02 ]
 [0.7   0.037 0.013 0.25 ]
 [0.487 0.224 0.051 0.237]]
Validation acc: 0.5157342657342657
Validation class_accuracies: [0.8125701459034792, 0.20882852292020374, 0.0125, 0.23717948717948717]
Validation sensitivity: 0.19515151515151516
Validation specificity: 0.8125701459034792
Validation icbhi_score: 0.5038608305274972
Validation roc_auc: None
Validation avg_accuracy: 0.3177695390007925
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5524803591470258 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
68/68 - 138s - loss: 0.0110 - accuracy: 0.9959 - 138s/epoch - 2s/step
Epoch 26/60
Validation cm: [[544 284  21  42]
 [190 389   2   8]
 [ 33  13   9  25]
 [ 28  79  23  26]]
Validation normalized_cm: [[0.611 0.319 0.024 0.047]
 [0.323 0.66  0.003 0.014]
 [0.412 0.163 0.113 0.312]
 [0.179 0.506 0.147 0.167]]
Validation acc: 0.5641025641025641
Validation class_accuracies: [0.6105499438832772, 0.6604414261460102, 0.1125, 0.16666666666666666]
Validation sensitivity: 0.5139393939393939
Validation specificity: 0.6105499438832772
Validation icbhi_score: 0.5622446689113356
Validation roc_auc: None
Validation avg_accuracy: 0.38753950917398855
Validation one_indexed_epoch: 26
-- New best results were achieved. --
There is no such attribute
68/68 - 139s - loss: 0.0108 - accuracy: 0.9977 - 139s/epoch - 2s/step
Epoch 27/60
Validation cm: [[451 369  47  24]
 [156 421   6   6]
 [ 29  17  20  14]
 [ 23  82  30  21]]
Validation normalized_cm: [[0.506 0.414 0.053 0.027]
 [0.265 0.715 0.01  0.01 ]
 [0.362 0.212 0.25  0.175]
 [0.147 0.526 0.192 0.135]]
Validation acc: 0.532051282051282
Validation class_accuracies: [0.5061728395061729, 0.7147707979626485, 0.25, 0.1346153846153846]
Validation sensitivity: 0.56
Validation specificity: 0.5061728395061729
Validation icbhi_score: 0.5330864197530865
Validation roc_auc: None
Validation avg_accuracy: 0.4013897555210515
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 141s - loss: 0.0059 - accuracy: 0.9986 - 141s/epoch - 2s/step
Epoch 28/60
Validation cm: [[409 366  58  58]
 [202 350  12  25]
 [ 21  18  16  25]
 [ 29  67  29  31]]
Validation normalized_cm: [[0.459 0.411 0.065 0.065]
 [0.343 0.594 0.02  0.042]
 [0.263 0.225 0.2   0.312]
 [0.186 0.429 0.186 0.199]]
Validation acc: 0.4696969696969697
Validation class_accuracies: [0.4590347923681257, 0.5942275042444821, 0.2, 0.1987179487179487]
Validation sensitivity: 0.4812121212121212
Validation specificity: 0.4590347923681257
Validation icbhi_score: 0.47012345679012346
Validation roc_auc: None
Validation avg_accuracy: 0.36299506133263915
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 138s - loss: 0.0049 - accuracy: 0.9989 - 138s/epoch - 2s/step
Epoch 29/60
Validation cm: [[533 240  78  40]
 [283 272  16  18]
 [ 29  11  18  22]
 [ 35  53  39  29]]
Validation normalized_cm: [[0.598 0.269 0.088 0.045]
 [0.48  0.462 0.027 0.031]
 [0.362 0.138 0.225 0.275]
 [0.224 0.34  0.25  0.186]]
Validation acc: 0.4965034965034965
Validation class_accuracies: [0.5982042648709316, 0.4617996604414261, 0.225, 0.1858974358974359]
Validation sensitivity: 0.38666666666666666
Validation specificity: 0.5982042648709316
Validation icbhi_score: 0.49243546576879915
Validation roc_auc: None
Validation avg_accuracy: 0.3677253403024484
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 143s - loss: 0.0049 - accuracy: 0.9989 - 143s/epoch - 2s/step
Epoch 30/60
Validation cm: [[446 321  83  41]
 [174 387  14  14]
 [ 25  16  20  19]
 [ 23  71  36  26]]
Validation normalized_cm: [[0.501 0.36  0.093 0.046]
 [0.295 0.657 0.024 0.024]
 [0.312 0.2   0.25  0.237]
 [0.147 0.455 0.231 0.167]]
Validation acc: 0.5122377622377622
Validation class_accuracies: [0.500561167227834, 0.6570458404074703, 0.25, 0.16666666666666666]
Validation sensitivity: 0.5248484848484849
Validation specificity: 0.500561167227834
Validation icbhi_score: 0.5127048260381595
Validation roc_auc: None
Validation avg_accuracy: 0.39356841857549274
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 140s - loss: 0.0031 - accuracy: 0.9995 - 140s/epoch - 2s/step
Epoch 31/60
Validation cm: [[482 269  94  46]
 [222 333  17  17]
 [ 29  10  20  21]
 [ 33  54  42  27]]
Validation normalized_cm: [[0.541 0.302 0.105 0.052]
 [0.377 0.565 0.029 0.029]
 [0.362 0.125 0.25  0.263]
 [0.212 0.346 0.269 0.173]]
Validation acc: 0.5023310023310024
Validation class_accuracies: [0.5409652076318743, 0.565365025466893, 0.25, 0.17307692307692307]
Validation sensitivity: 0.46060606060606063
Validation specificity: 0.5409652076318743
Validation icbhi_score: 0.5007856341189675
Validation roc_auc: None
Validation avg_accuracy: 0.3823517890439226
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0001250000059371814
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 138s - loss: 0.0034 - accuracy: 0.9993 - 138s/epoch - 2s/step
Epoch 32/60
Validation cm: [[547 197 112  35]
 [248 299  30  12]
 [ 31   7  28  14]
 [ 33  42  53  28]]
Validation normalized_cm: [[0.614 0.221 0.126 0.039]
 [0.421 0.508 0.051 0.02 ]
 [0.388 0.087 0.35  0.175]
 [0.212 0.269 0.34  0.179]]
Validation acc: 0.5256410256410257
Validation class_accuracies: [0.6139169472502806, 0.5076400679117148, 0.35, 0.1794871794871795]
Validation sensitivity: 0.4303030303030303
Validation specificity: 0.6139169472502806
Validation icbhi_score: 0.5221099887766554
Validation roc_auc: None
Validation avg_accuracy: 0.41276104866229374
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 6 epochs
There is no such attribute
68/68 - 139s - loss: 0.0031 - accuracy: 0.9984 - 139s/epoch - 2s/step
Epoch 33/60
Validation cm: [[580 167  85  59]
 [272 259  17  41]
 [ 35   4  16  25]
 [ 38  35  37  46]]
Validation normalized_cm: [[0.651 0.187 0.095 0.066]
 [0.462 0.44  0.029 0.07 ]
 [0.438 0.05  0.2   0.312]
 [0.244 0.224 0.237 0.295]]
Validation acc: 0.5250582750582751
Validation class_accuracies: [0.6509539842873177, 0.4397283531409168, 0.2, 0.2948717948717949]
Validation sensitivity: 0.3890909090909091
Validation specificity: 0.6509539842873177
Validation icbhi_score: 0.5200224466891133
Validation roc_auc: None
Validation avg_accuracy: 0.3963885330750073
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 7 epochs
There is no such attribute
68/68 - 138s - loss: 0.0028 - accuracy: 0.9991 - 138s/epoch - 2s/step
Epoch 34/60
Validation cm: [[533 209 114  35]
 [227 324  28  10]
 [ 33   2  29  16]
 [ 36  47  47  26]]
Validation normalized_cm: [[0.598 0.235 0.128 0.039]
 [0.385 0.55  0.048 0.017]
 [0.412 0.025 0.362 0.2  ]
 [0.231 0.301 0.301 0.167]]
Validation acc: 0.5314685314685315
Validation class_accuracies: [0.5982042648709316, 0.5500848896434635, 0.3625, 0.16666666666666666]
Validation sensitivity: 0.4593939393939394
Validation specificity: 0.5982042648709316
Validation icbhi_score: 0.5287991021324355
Validation roc_auc: None
Validation avg_accuracy: 0.4193639552952655
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 8 epochs
There is no such attribute
68/68 - 137s - loss: 0.0033 - accuracy: 0.9991 - 137s/epoch - 2s/step
Epoch 35/60
Validation cm: [[449 309  77  56]
 [173 375  17  24]
 [ 30   8  15  27]
 [ 27  56  34  39]]
Validation normalized_cm: [[0.504 0.347 0.086 0.063]
 [0.294 0.637 0.029 0.041]
 [0.375 0.1   0.188 0.338]
 [0.173 0.359 0.218 0.25 ]]
Validation acc: 0.5116550116550117
Validation class_accuracies: [0.5039281705948373, 0.6366723259762309, 0.1875, 0.25]
Validation sensitivity: 0.52
Validation specificity: 0.5039281705948373
Validation icbhi_score: 0.5119640852974187
Validation roc_auc: None
Validation avg_accuracy: 0.3945251241427671
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 9 epochs
There is no such attribute
68/68 - 137s - loss: 0.0030 - accuracy: 0.9989 - 137s/epoch - 2s/step
Epoch 36/60
Validation cm: [[453 315  66  57]
 [193 371  12  13]
 [ 28  14  17  21]
 [ 27  65  36  28]]
Validation normalized_cm: [[0.508 0.354 0.074 0.064]
 [0.328 0.63  0.02  0.022]
 [0.35  0.175 0.212 0.263]
 [0.173 0.417 0.231 0.179]]
Validation acc: 0.5064102564102564
Validation class_accuracies: [0.5084175084175084, 0.629881154499151, 0.2125, 0.1794871794871795]
Validation sensitivity: 0.5042424242424243
Validation specificity: 0.5084175084175084
Validation icbhi_score: 0.5063299663299663
Validation roc_auc: None
Validation avg_accuracy: 0.38257146060095976
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
68/68 - 137s - loss: 0.0043 - accuracy: 0.9993 - 137s/epoch - 2s/step
Epoch 37/60
Validation cm: [[441 311  80  59]
 [183 368  21  17]
 [ 30  10  17  23]
 [ 26  61  37  32]]
Validation normalized_cm: [[0.495 0.349 0.09  0.066]
 [0.311 0.625 0.036 0.029]
 [0.375 0.125 0.212 0.287]
 [0.167 0.391 0.237 0.205]]
Validation acc: 0.5
Validation class_accuracies: [0.494949494949495, 0.6247877758913413, 0.2125, 0.20512820512820512]
Validation sensitivity: 0.5054545454545455
Validation specificity: 0.494949494949495
Validation icbhi_score: 0.5002020202020202
Validation roc_auc: None
Validation avg_accuracy: 0.3843413689922603
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 11 epochs
There is no such attribute
68/68 - 137s - loss: 0.0042 - accuracy: 0.9986 - 137s/epoch - 2s/step
Epoch 38/60
Validation cm: [[415 343  64  69]
 [155 391  22  21]
 [ 24  15  16  25]
 [ 25  65  36  30]]
Validation normalized_cm: [[0.466 0.385 0.072 0.077]
 [0.263 0.664 0.037 0.036]
 [0.3   0.188 0.2   0.312]
 [0.16  0.417 0.231 0.192]]
Validation acc: 0.4965034965034965
Validation class_accuracies: [0.4657687991021324, 0.6638370118845501, 0.2, 0.19230769230769232]
Validation sensitivity: 0.5296969696969697
Validation specificity: 0.4657687991021324
Validation icbhi_score: 0.49773288439955105
Validation roc_auc: None
Validation avg_accuracy: 0.3804783758235937
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 12 epochs
There is no such attribute
68/68 - 137s - loss: 0.0022 - accuracy: 0.9991 - 137s/epoch - 2s/step
Epoch 39/60
Validation cm: [[481 283  64  63]
 [185 365  15  24]
 [ 30   8  17  25]
 [ 31  58  36  31]]
Validation normalized_cm: [[0.54  0.318 0.072 0.071]
 [0.314 0.62  0.025 0.041]
 [0.375 0.1   0.212 0.312]
 [0.199 0.372 0.231 0.199]]
Validation acc: 0.5209790209790209
Validation class_accuracies: [0.5398428731762065, 0.6196943972835314, 0.2125, 0.1987179487179487]
Validation sensitivity: 0.5006060606060606
Validation specificity: 0.5398428731762065
Validation icbhi_score: 0.5202244668911336
Validation roc_auc: None
Validation avg_accuracy: 0.39268880479442164
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 13 epochs
There is no such attribute
68/68 - 135s - loss: 0.0020 - accuracy: 0.9995 - 135s/epoch - 2s/step
Epoch 40/60
Validation cm: [[459 303  70  59]
 [184 370  14  21]
 [ 29  12  16  23]
 [ 28  62  35  31]]
Validation normalized_cm: [[0.515 0.34  0.079 0.066]
 [0.312 0.628 0.024 0.036]
 [0.362 0.15  0.2   0.287]
 [0.179 0.397 0.224 0.199]]
Validation acc: 0.5104895104895105
Validation class_accuracies: [0.5151515151515151, 0.6281833616298812, 0.2, 0.1987179487179487]
Validation sensitivity: 0.5054545454545455
Validation specificity: 0.5151515151515151
Validation icbhi_score: 0.5103030303030303
Validation roc_auc: None
Validation avg_accuracy: 0.3855132063748362
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 14 epochs
There is no such attribute
68/68 - 136s - loss: 0.0018 - accuracy: 0.9995 - 136s/epoch - 2s/step
Epoch 41/60
Validation cm: [[448 311  78  54]
 [176 362  25  26]
 [ 23  12  20  25]
 [ 23  62  36  35]]
Validation normalized_cm: [[0.503 0.349 0.088 0.061]
 [0.299 0.615 0.042 0.044]
 [0.287 0.15  0.25  0.312]
 [0.147 0.397 0.231 0.224]]
Validation acc: 0.504079254079254
Validation class_accuracies: [0.5028058361391695, 0.6146010186757216, 0.25, 0.22435897435897437]
Validation sensitivity: 0.5054545454545455
Validation specificity: 0.5028058361391695
Validation icbhi_score: 0.5041301907968575
Validation roc_auc: None
Validation avg_accuracy: 0.3979414572934664
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
68/68 - 138s - loss: 0.0033 - accuracy: 0.9993 - 138s/epoch - 2s/step
Epoch 42/60
Validation cm: [[440 316  74  61]
 [164 373  27  25]
 [ 28   7  18  27]
 [ 27  58  38  33]]
Validation normalized_cm: [[0.494 0.355 0.083 0.068]
 [0.278 0.633 0.046 0.042]
 [0.35  0.087 0.225 0.338]
 [0.173 0.372 0.244 0.212]]
Validation acc: 0.5034965034965035
Validation class_accuracies: [0.49382716049382713, 0.633276740237691, 0.225, 0.21153846153846154]
Validation sensitivity: 0.5139393939393939
Validation specificity: 0.49382716049382713
Validation icbhi_score: 0.5038832772166105
Validation roc_auc: None
Validation avg_accuracy: 0.39091059056749494
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 16 epochs
There is no such attribute
68/68 - 138s - loss: 0.0039 - accuracy: 0.9991 - 138s/epoch - 2s/step
Epoch 43/60
Validation cm: [[439 329  70  53]
 [174 373  23  19]
 [ 26  14  17  23]
 [ 27  59  43  27]]
Validation normalized_cm: [[0.493 0.369 0.079 0.059]
 [0.295 0.633 0.039 0.032]
 [0.325 0.175 0.212 0.287]
 [0.173 0.378 0.276 0.173]]
Validation acc: 0.4988344988344988
Validation class_accuracies: [0.49270482603815935, 0.633276740237691, 0.2125, 0.17307692307692307]
Validation sensitivity: 0.5054545454545455
Validation specificity: 0.49270482603815935
Validation icbhi_score: 0.4990796857463524
Validation roc_auc: None
Validation avg_accuracy: 0.37788962233819334
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 17 epochs
There is no such attribute
68/68 - 138s - loss: 0.0019 - accuracy: 0.9995 - 138s/epoch - 2s/step
Epoch 44/60
Validation cm: [[448 317  57  69]
 [169 379  20  21]
 [ 29  12  12  27]
 [ 29  59  36  32]]
Validation normalized_cm: [[0.503 0.356 0.064 0.077]
 [0.287 0.643 0.034 0.036]
 [0.362 0.15  0.15  0.338]
 [0.186 0.378 0.231 0.205]]
Validation acc: 0.5075757575757576
Validation class_accuracies: [0.5028058361391695, 0.6434634974533107, 0.15, 0.20512820512820512]
Validation sensitivity: 0.5127272727272727
Validation specificity: 0.5028058361391695
Validation icbhi_score: 0.507766554433221
Validation roc_auc: None
Validation avg_accuracy: 0.37534938468017126
Validation one_indexed_epoch: 44
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 18 epochs
There is no such attribute
68/68 - 136s - loss: 0.0016 - accuracy: 0.9998 - 136s/epoch - 2s/step
Epoch 45/60
Validation cm: [[448 322  48  73]
 [167 381  20  21]
 [ 29  11  12  28]
 [ 29  62  34  31]]
Validation normalized_cm: [[0.503 0.361 0.054 0.082]
 [0.284 0.647 0.034 0.036]
 [0.362 0.138 0.15  0.35 ]
 [0.186 0.397 0.218 0.199]]
Validation acc: 0.5081585081585082
Validation class_accuracies: [0.5028058361391695, 0.6468590831918506, 0.15, 0.1987179487179487]
Validation sensitivity: 0.5139393939393939
Validation specificity: 0.5028058361391695
Validation icbhi_score: 0.5083726150392818
Validation roc_auc: None
Validation avg_accuracy: 0.3745957170122422
Validation one_indexed_epoch: 45
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 19 epochs
There is no such attribute
68/68 - 136s - loss: 0.0021 - accuracy: 0.9995 - 136s/epoch - 2s/step
Epoch 46/60
Validation cm: [[439 326  57  69]
 [164 378  24  23]
 [ 27  14  13  26]
 [ 30  58  36  32]]
Validation normalized_cm: [[0.493 0.366 0.064 0.077]
 [0.278 0.642 0.041 0.039]
 [0.338 0.175 0.163 0.325]
 [0.192 0.372 0.231 0.205]]
Validation acc: 0.5023310023310024
Validation class_accuracies: [0.49270482603815935, 0.6417657045840407, 0.1625, 0.20512820512820512]
Validation sensitivity: 0.5127272727272727
Validation specificity: 0.49270482603815935
Validation icbhi_score: 0.5027160493827161
Validation roc_auc: None
Validation avg_accuracy: 0.3755246839376013
Validation one_indexed_epoch: 46
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 1.5625000742147677e-05
There is no such attribute
68/68 - 135s - loss: 0.0026 - accuracy: 0.9993 - 135s/epoch - 2s/step
Epoch 47/60
Validation cm: [[448 318  50  75]
 [163 384  19  23]
 [ 29  11  12  28]
 [ 28  63  35  30]]
Validation normalized_cm: [[0.503 0.357 0.056 0.084]
 [0.277 0.652 0.032 0.039]
 [0.362 0.138 0.15  0.35 ]
 [0.179 0.404 0.224 0.192]]
Validation acc: 0.5093240093240093
Validation class_accuracies: [0.5028058361391695, 0.6519524617996605, 0.15, 0.19230769230769232]
Validation sensitivity: 0.5163636363636364
Validation specificity: 0.5028058361391695
Validation icbhi_score: 0.509584736251403
Validation roc_auc: None
Validation avg_accuracy: 0.37426649756163055
Validation one_indexed_epoch: 47
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 21 epochs
There is no such attribute
68/68 - 141s - loss: 0.0021 - accuracy: 0.9995 - 141s/epoch - 2s/step
Epoch 48/60
Validation cm: [[454 317  49  71]
 [163 385  19  22]
 [ 29  12  12  27]
 [ 28  64  34  30]]
Validation normalized_cm: [[0.51  0.356 0.055 0.08 ]
 [0.277 0.654 0.032 0.037]
 [0.362 0.15  0.15  0.338]
 [0.179 0.41  0.218 0.192]]
Validation acc: 0.5134032634032634
Validation class_accuracies: [0.5095398428731762, 0.6536502546689303, 0.15, 0.19230769230769232]
Validation sensitivity: 0.5175757575757576
Validation specificity: 0.5095398428731762
Validation icbhi_score: 0.513557800224467
Validation roc_auc: None
Validation avg_accuracy: 0.3763744474624497
Validation one_indexed_epoch: 48
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 22 epochs
There is no such attribute
68/68 - 139s - loss: 0.0016 - accuracy: 0.9995 - 139s/epoch - 2s/step
Epoch 49/60
Validation cm: [[465 312  52  62]
 [170 380  17  22]
 [ 26  15  13  26]
 [ 28  64  33  31]]
Validation normalized_cm: [[0.522 0.35  0.058 0.07 ]
 [0.289 0.645 0.029 0.037]
 [0.325 0.188 0.163 0.325]
 [0.179 0.41  0.212 0.199]]
Validation acc: 0.5180652680652681
Validation class_accuracies: [0.5218855218855218, 0.6451612903225806, 0.1625, 0.1987179487179487]
Validation sensitivity: 0.5139393939393939
Validation specificity: 0.5218855218855218
Validation icbhi_score: 0.5179124579124579
Validation roc_auc: None
Validation avg_accuracy: 0.38206619023151284
Validation one_indexed_epoch: 49
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 23 epochs
There is no such attribute
68/68 - 136s - loss: 0.0031 - accuracy: 0.9991 - 136s/epoch - 2s/step
Epoch 50/60
Validation cm: [[467 309  53  62]
 [169 383  15  22]
 [ 28  15  13  24]
 [ 27  63  36  30]]
Validation normalized_cm: [[0.524 0.347 0.059 0.07 ]
 [0.287 0.65  0.025 0.037]
 [0.35  0.188 0.163 0.3  ]
 [0.173 0.404 0.231 0.192]]
Validation acc: 0.5203962703962703
Validation class_accuracies: [0.5241301907968574, 0.6502546689303905, 0.1625, 0.19230769230769232]
Validation sensitivity: 0.5163636363636364
Validation specificity: 0.5241301907968574
Validation icbhi_score: 0.5202469135802469
Validation roc_auc: None
Validation avg_accuracy: 0.3822981380087351
Validation one_indexed_epoch: 50
The validation tracker metric at 0.5622446689113356 hasn't increased by 0 in 24 epochs
There is no such attribute
68/68 - 142s - loss: 0.0012 - accuracy: 0.9998 - 142s/epoch - 2s/step
Epoch 51/60
Validation cm: [[478 289  66  58]
 [185 371  14  19]
 [ 29  13  14  24]
 [ 30  60  36  30]]
Validation normalized_cm: [[0.536 0.324 0.074 0.065]
 [0.314 0.63  0.024 0.032]
 [0.362 0.163 0.175 0.3  ]
 [0.192 0.385 0.231 0.192]]
Validation acc: 0.5203962703962703
Validation class_accuracies: [0.5364758698092031, 0.629881154499151, 0.175, 0.19230769230769232]
Validation sensitivity: 0.503030303030303
Validation specificity: 0.5364758698092031
Validation icbhi_score: 0.519753086419753
Validation roc_auc: None
Validation avg_accuracy: 0.3834161791540116
Validation one_indexed_epoch: 51
The number of epochs since last 1% equals the patience
Lr has been adjusted to 7.812500371073838e-06
There is no such attribute
68/68 - 138s - loss: 0.0026 - accuracy: 0.9993 - 138s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5622446689113356
Best cm: [[544 284  21  42]
 [190 389   2   8]
 [ 33  13   9  25]
 [ 28  79  23  26]]
Best normalized_cm: [[0.611 0.319 0.024 0.047]
 [0.323 0.66  0.003 0.014]
 [0.412 0.163 0.113 0.312]
 [0.179 0.506 0.147 0.167]]
Best acc: 0.5641025641025641
Best class_accuracies: [0.6105499438832772, 0.6604414261460102, 0.1125, 0.16666666666666666]
Best sensitivity: 0.5139393939393939
Best specificity: 0.6105499438832772
Best roc_auc: None
Best avg_accuracy: 0.38753950917398855
Best one_indexed_epoch: 26
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [1.065529704093933, 0.731536865234375, 0.5553892254829407, 0.4047626554965973, 0.3146549463272095, 0.24649083614349365, 0.1979140043258667, 0.12495195865631104, 0.11839205026626587, 0.12853075563907623, 0.11480459570884705, 0.11228597909212112, 0.09042574465274811, 0.07479674369096756, 0.045096952468156815, 0.025436218827962875, 0.013354639522731304, 0.01058467011898756, 0.006886133924126625, 0.006228805519640446, 0.005289618857204914, 0.009014411829411983, 0.005452796816825867, 0.01077644620090723, 0.01099036168307066, 0.010776899755001068, 0.005887752864509821, 0.0049194032326340675, 0.004873077850788832, 0.003098239190876484, 0.003360697766765952, 0.0030862644780427217, 0.0028374979738146067, 0.0032549977768212557, 0.0029586325399577618, 0.004342334344983101, 0.00420563155785203, 0.0021524426992982626, 0.0019895965233445168, 0.0017574067460373044, 0.0033095753751695156, 0.003860695054754615, 0.0019105690298601985, 0.0016158445505425334, 0.0021254215389490128, 0.002576738130301237, 0.0020795848686248064, 0.0016286371974274516, 0.003107046475633979, 0.0012341577094048262, 0.0026273701805621386], 'accuracy': [0.5332260131835938, 0.6997010707855225, 0.7744309306144714, 0.8457116484642029, 0.8813520073890686, 0.9077948927879333, 0.9321683049201965, 0.9551621079444885, 0.9599907994270325, 0.9524028301239014, 0.9609105587005615, 0.9618303179740906, 0.966888964176178, 0.9719475507736206, 0.9841342568397522, 0.9921821355819702, 0.9963210225105286, 0.9977006316184998, 0.9988502860069275, 0.9981604814529419, 0.9988502860069275, 0.9974706768989563, 0.9983904361724854, 0.9967808723449707, 0.9958611130714417, 0.9977006316184998, 0.9986203908920288, 0.9988502860069275, 0.9988502860069275, 0.9995401501655579, 0.9993101954460144, 0.9983904361724854, 0.999080240726471, 0.999080240726471, 0.9988502860069275, 0.9993101954460144, 0.9986203908920288, 0.999080240726471, 0.9995401501655579, 0.9995401501655579, 0.9993101954460144, 0.999080240726471, 0.9995401501655579, 0.9997700452804565, 0.9995401501655579, 0.9993101954460144, 0.9995401501655579, 0.9995401501655579, 0.999080240726471, 0.9997700452804565, 0.9993101954460144]}
Job dir: ../cache/cw/train132/4
Job id is 5.
Job dir: ../cache/cw/train132/5
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 6.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_vgg16"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_4 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_5 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_7 (Sequential)                       (None, 4)                                   14716740         
                                                                                                              
==============================================================================================================
Total params: 14,716,902
Trainable params: 14,716,902
Non-trainable params: 0
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
68/68 - 119s - loss: 2.0331 - accuracy: 0.3318 - 119s/epoch - 2s/step
Epoch 2/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 107s - loss: 1.3010 - accuracy: 0.3881 - 107s/epoch - 2s/step
Epoch 3/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 107s - loss: 1.2989 - accuracy: 0.3865 - 107s/epoch - 2s/step
Epoch 4/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 106s - loss: 1.3064 - accuracy: 0.3769 - 106s/epoch - 2s/step
Epoch 5/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 107s - loss: 1.2961 - accuracy: 0.3888 - 107s/epoch - 2s/step
Epoch 6/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
68/68 - 108s - loss: 1.2940 - accuracy: 0.3888 - 108s/epoch - 2s/step
Epoch 7/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
There is no such attribute
68/68 - 112s - loss: 1.2935 - accuracy: 0.3888 - 112s/epoch - 2s/step
Epoch 8/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
There is no such attribute
68/68 - 109s - loss: 1.2922 - accuracy: 0.3888 - 109s/epoch - 2s/step
Epoch 9/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
There is no such attribute
68/68 - 113s - loss: 1.2843 - accuracy: 0.3909 - 113s/epoch - 2s/step
Epoch 10/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
There is no such attribute
68/68 - 115s - loss: 1.2947 - accuracy: 0.3888 - 115s/epoch - 2s/step
Epoch 11/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 117s - loss: 1.2937 - accuracy: 0.3888 - 117s/epoch - 2s/step
Epoch 12/60
Validation cm: [[888   3   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[0.997 0.003 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.5174825174825175
Validation class_accuracies: [0.9966329966329966, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 0.9966329966329966
Validation icbhi_score: 0.4983164983164983
Validation roc_auc: None
Validation avg_accuracy: 0.24915824915824916
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
There is no such attribute
68/68 - 112s - loss: 1.2943 - accuracy: 0.3888 - 112s/epoch - 2s/step
Epoch 13/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
There is no such attribute
68/68 - 114s - loss: 1.2940 - accuracy: 0.3888 - 114s/epoch - 2s/step
Epoch 14/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
There is no such attribute
68/68 - 114s - loss: 1.2926 - accuracy: 0.3888 - 114s/epoch - 2s/step
Epoch 15/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
There is no such attribute
68/68 - 113s - loss: 1.2915 - accuracy: 0.3888 - 113s/epoch - 2s/step
Epoch 16/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
68/68 - 113s - loss: 1.2917 - accuracy: 0.3888 - 113s/epoch - 2s/step
Epoch 17/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5 hasn't increased by 0 in 16 epochs
There is no such attribute
68/68 - 111s - loss: 1.2884 - accuracy: 0.3888 - 111s/epoch - 2s/step
Epoch 18/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5 hasn't increased by 0 in 17 epochs
There is no such attribute
68/68 - 113s - loss: 1.2851 - accuracy: 0.3888 - 113s/epoch - 2s/step
Epoch 19/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5 hasn't increased by 0 in 18 epochs
There is no such attribute
68/68 - 113s - loss: 1.2787 - accuracy: 0.3927 - 113s/epoch - 2s/step
Epoch 20/60
Validation cm: [[824   1   0  66]
 [564   1   0  24]
 [ 74   0   0   6]
 [150   0   0   6]]
Validation normalized_cm: [[0.925 0.001 0.    0.074]
 [0.958 0.002 0.    0.041]
 [0.925 0.    0.    0.075]
 [0.962 0.    0.    0.038]]
Validation acc: 0.48426573426573427
Validation class_accuracies: [0.9248035914702581, 0.001697792869269949, 0.0, 0.038461538461538464]
Validation sensitivity: 0.008484848484848486
Validation specificity: 0.9248035914702581
Validation icbhi_score: 0.46664421997755334
Validation roc_auc: None
Validation avg_accuracy: 0.24124073070026664
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5 hasn't increased by 0 in 19 epochs
There is no such attribute
68/68 - 112s - loss: 1.2609 - accuracy: 0.4061 - 112s/epoch - 2s/step
Epoch 21/60
Validation cm: [[765  52   7  67]
 [536  29   0  24]
 [ 56  16   0   8]
 [120  28   2   6]]
Validation normalized_cm: [[0.859 0.058 0.008 0.075]
 [0.91  0.049 0.    0.041]
 [0.7   0.2   0.    0.1  ]
 [0.769 0.179 0.013 0.038]]
Validation acc: 0.4662004662004662
Validation class_accuracies: [0.8585858585858586, 0.04923599320882852, 0.0, 0.038461538461538464]
Validation sensitivity: 0.04242424242424243
Validation specificity: 0.8585858585858586
Validation icbhi_score: 0.4505050505050505
Validation roc_auc: None
Validation avg_accuracy: 0.23657084756405639
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 6.25000029685907e-05
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 113s - loss: 1.2459 - accuracy: 0.4166 - 113s/epoch - 2s/step
Epoch 22/60
Validation cm: [[690  95  42  64]
 [488  71   8  22]
 [ 51  13  10   6]
 [ 89  33  28   6]]
Validation normalized_cm: [[0.774 0.107 0.047 0.072]
 [0.829 0.121 0.014 0.037]
 [0.637 0.163 0.125 0.075]
 [0.571 0.212 0.179 0.038]]
Validation acc: 0.4527972027972028
Validation class_accuracies: [0.7744107744107744, 0.12054329371816638, 0.125, 0.038461538461538464]
Validation sensitivity: 0.10545454545454545
Validation specificity: 0.7744107744107744
Validation icbhi_score: 0.43993265993265995
Validation roc_auc: None
Validation avg_accuracy: 0.2646039016476199
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5 hasn't increased by 0 in 21 epochs
There is no such attribute
68/68 - 113s - loss: 1.1955 - accuracy: 0.4433 - 113s/epoch - 2s/step
Epoch 23/60
Validation cm: [[556 206  62  67]
 [369 183   7  30]
 [ 38  13  15  14]
 [ 58  53  36   9]]
Validation normalized_cm: [[0.624 0.231 0.07  0.075]
 [0.626 0.311 0.012 0.051]
 [0.475 0.163 0.188 0.175]
 [0.372 0.34  0.231 0.058]]
Validation acc: 0.44463869463869465
Validation class_accuracies: [0.6240179573512907, 0.31069609507640067, 0.1875, 0.057692307692307696]
Validation sensitivity: 0.2509090909090909
Validation specificity: 0.6240179573512907
Validation icbhi_score: 0.43746352413019085
Validation roc_auc: None
Validation avg_accuracy: 0.29497659002999976
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5 hasn't increased by 0 in 22 epochs
There is no such attribute
68/68 - 113s - loss: 1.1425 - accuracy: 0.4599 - 113s/epoch - 2s/step
Epoch 24/60
Validation cm: [[778  61  29  23]
 [554  19   4  12]
 [ 61  13   5   1]
 [102  26  25   3]]
Validation normalized_cm: [[0.873 0.068 0.033 0.026]
 [0.941 0.032 0.007 0.02 ]
 [0.762 0.163 0.062 0.013]
 [0.654 0.167 0.16  0.019]]
Validation acc: 0.46911421911421913
Validation class_accuracies: [0.8731762065095399, 0.03225806451612903, 0.0625, 0.019230769230769232]
Validation sensitivity: 0.03272727272727273
Validation specificity: 0.8731762065095399
Validation icbhi_score: 0.4529517396184063
Validation roc_auc: None
Validation avg_accuracy: 0.24679126006410954
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5 hasn't increased by 0 in 23 epochs
There is no such attribute
68/68 - 113s - loss: 1.1048 - accuracy: 0.4723 - 113s/epoch - 2s/step
Epoch 25/60
Validation cm: [[373 367  80  71]
 [252 299  15  23]
 [ 26  19  28   7]
 [ 36  70  44   6]]
Validation normalized_cm: [[0.419 0.412 0.09  0.08 ]
 [0.428 0.508 0.025 0.039]
 [0.325 0.237 0.35  0.087]
 [0.231 0.449 0.282 0.038]]
Validation acc: 0.4114219114219114
Validation class_accuracies: [0.4186307519640853, 0.5076400679117148, 0.35, 0.038461538461538464]
Validation sensitivity: 0.4036363636363636
Validation specificity: 0.4186307519640853
Validation icbhi_score: 0.4111335578002244
Validation roc_auc: None
Validation avg_accuracy: 0.3286830895843346
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5 hasn't increased by 0 in 24 epochs
There is no such attribute
68/68 - 116s - loss: 1.0774 - accuracy: 0.4847 - 116s/epoch - 2s/step
Epoch 26/60
Validation cm: [[361 413  53  64]
 [241 319  10  19]
 [ 24  25  22   9]
 [ 32  77  39   8]]
Validation normalized_cm: [[0.405 0.464 0.059 0.072]
 [0.409 0.542 0.017 0.032]
 [0.3   0.312 0.275 0.113]
 [0.205 0.494 0.25  0.051]]
Validation acc: 0.41375291375291373
Validation class_accuracies: [0.4051627384960718, 0.5415959252971138, 0.275, 0.05128205128205128]
Validation sensitivity: 0.42303030303030303
Validation specificity: 0.4051627384960718
Validation icbhi_score: 0.4140965207631874
Validation roc_auc: None
Validation avg_accuracy: 0.31826017876880924
Validation one_indexed_epoch: 26
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
68/68 - 120s - loss: 1.0548 - accuracy: 0.5066 - 120s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5
Best cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Best normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Best acc: 0.5192307692307693
Best class_accuracies: [1.0, 0.0, 0.0, 0.0]
Best sensitivity: 0.0
Best specificity: 1.0
Best roc_auc: None
Best avg_accuracy: 0.25
Best one_indexed_epoch: 1
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [2.0331170558929443, 1.3009555339813232, 1.298927664756775, 1.306435465812683, 1.2960543632507324, 1.2940490245819092, 1.293535828590393, 1.2921696901321411, 1.2843263149261475, 1.2947113513946533, 1.2936774492263794, 1.2942878007888794, 1.2940176725387573, 1.2926384210586548, 1.2914621829986572, 1.2916791439056396, 1.2884302139282227, 1.285050630569458, 1.27867591381073, 1.2608978748321533, 1.2459458112716675, 1.195497751235962, 1.1425246000289917, 1.1048184633255005, 1.077387809753418, 1.0547813177108765], 'accuracy': [0.3318004012107849, 0.3881351947784424, 0.38652563095092773, 0.37686824798583984, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.39089447259902954, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.38882502913475037, 0.39273396134376526, 0.406070351600647, 0.4166474938392639, 0.44332030415534973, 0.45987582206726074, 0.4722924828529358, 0.48470911383628845, 0.5065532326698303]}
Job dir: ../cache/cw/train132/6
