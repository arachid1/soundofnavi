Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train55
Description: new callback
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
4055
1214
817
222
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 4055 0's, 1214 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 817 0's and 222 1's ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/25
Validation cm: [[124 693]
 [134  88]]
Validation normalized_cm: [[0.152 0.848]
 [0.604 0.396]]
Validation acc: 0.20404234841193455
Validation class_accuracies: [0.15177478580171358, 0.3963963963963964]
Validation precision: 0.11267605633802817
Validation recall: 0.3963963963963964
Validation f1: 0.17547357926221335
Validation roc_auc: 0.2145952562109233
Validation avg_accuracy: 0.274085591099055
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[ 27 592]
 [  0  33]] 
Patient Normalized Confusion matrix: 
 [[0.044 0.956]
 [0.    1.   ]] 
Patient Validation accuracy: 
 9.20 
Patient Validation class accuracies: 
 [0.04361873990306947, 1.0] 
330/330 - 551s - loss: 0.4848 - accuracy: 0.7692 - 551s/epoch - 2s/step
Epoch 2/25
Validation cm: [[805  12]
 [222   0]]
Validation normalized_cm: [[0.985 0.015]
 [1.    0.   ]]
Validation acc: 0.7747834456207893
Validation class_accuracies: [0.98531211750306, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.493317675080221
Validation avg_accuracy: 0.49265605875153
Validation one_indexed_epoch: 2
-- New best results were achieved. --
Patient Confusion matrix: 
 [[607  12]
 [ 33   0]] 
Patient Normalized Confusion matrix: 
 [[0.981 0.019]
 [1.    0.   ]] 
Patient Validation accuracy: 
 93.10 
Patient Validation class accuracies: 
 [0.9806138933764136, 0.0] 
330/330 - 543s - loss: 0.4972 - accuracy: 0.7745 - 543s/epoch - 2s/step
Epoch 3/25
Validation cm: [[803  14]
 [222   0]]
Validation normalized_cm: [[0.983 0.017]
 [1.    0.   ]]
Validation acc: 0.7728585178055823
Validation class_accuracies: [0.9828641370869033, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.34606944766063497
Validation avg_accuracy: 0.49143206854345167
Validation one_indexed_epoch: 3
The validation tracker metric at 0.49265605875153 hasn't increased by 0 in 1 epochs
330/330 - 542s - loss: 0.4923 - accuracy: 0.7774 - 542s/epoch - 2s/step
Epoch 4/25
Validation cm: [[ 11 806]
 [  0 222]]
Validation normalized_cm: [[0.013 0.987]
 [0.    1.   ]]
Validation acc: 0.22425409047160733
Validation class_accuracies: [0.01346389228886169, 1.0]
Validation precision: 0.21595330739299612
Validation recall: 1.0
Validation f1: 0.35519999999999996
Validation roc_auc: 0.4988201175471677
Validation avg_accuracy: 0.5067319461444308
Validation one_indexed_epoch: 4
-- New best results were achieved. --
Patient Confusion matrix: 
 [[ 10 609]
 [  0  33]] 
Patient Normalized Confusion matrix: 
 [[0.016 0.984]
 [0.    1.   ]] 
Patient Validation accuracy: 
 6.60 
Patient Validation class accuracies: 
 [0.01615508885298869, 1.0] 
330/330 - 544s - loss: 0.4838 - accuracy: 0.7778 - 544s/epoch - 2s/step
Epoch 5/25
