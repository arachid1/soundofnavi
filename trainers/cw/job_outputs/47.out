Validation cm: [[ 25   3   1 711]
 [  1   0   0  91]
 [  1   0   0  76]
 [  0   0   0 130]]
Validation normalized_cm: [[0.034 0.004 0.001 0.961]
 [0.011 0.    0.    0.989]
 [0.013 0.    0.    0.987]
 [0.    0.    0.    1.   ]]
Validation acc: 0.14918190567853706
Validation class_accuracies: [0.033783783783783786, 0.0, 0.0, 1.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25844594594594594
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train47
Description: Leaf with model 9/mixednet with P-T on fixed mel filterbs
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 105,952
Trainable params: 105,456
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Saving model...
330/330 - 97s - loss: 0.4382 - accuracy: 0.5162 - 97s/epoch - 294ms/step
Validation cm: [[109  12   8 611]
 [  1   0   0  91]
 [  5   0   1  71]
 [  0   0   0 130]]
Validation normalized_cm: [[0.147 0.016 0.011 0.826]
 [0.011 0.    0.    0.989]
 [0.065 0.    0.013 0.922]
 [0.    0.    0.    1.   ]]
Validation acc: 0.23099133782483156
Validation class_accuracies: [0.1472972972972973, 0.0, 0.012987012987012988, 1.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2900710775710776
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Saving model...
330/330 - 90s - loss: 0.4027 - accuracy: 0.5160 - 90s/epoch - 274ms/step
Validation cm: [[224   7 220 289]
 [  1   0  18  73]
 [  9   3  29  36]
 [  1   1  19 109]]
Validation normalized_cm: [[0.303 0.009 0.297 0.391]
 [0.011 0.    0.196 0.793]
 [0.117 0.039 0.377 0.468]
 [0.008 0.008 0.146 0.838]]
Validation acc: 0.3484119345524543
Validation class_accuracies: [0.3027027027027027, 0.0, 0.37662337662337664, 0.8384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37944690444690443
Validation one_indexed_epoch: 3
Epoch 3/40
-- New best results were achieved. --
Saving model...
330/330 - 92s - loss: 0.3714 - accuracy: 0.5775 - 92s/epoch - 280ms/step
Validation cm: [[712   1  26   1]
 [ 85   1   6   0]
 [ 51   0  24   2]
 [ 88   0  40   2]]
Validation normalized_cm: [[0.962 0.001 0.035 0.001]
 [0.924 0.011 0.065 0.   ]
 [0.662 0.    0.312 0.026]
 [0.677 0.    0.308 0.015]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.9621621621621622, 0.010869565217391304, 0.3116883116883117, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32502616361312014
Validation one_indexed_epoch: 4
Epoch 4/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 1 epochs
330/330 - 91s - loss: 0.3492 - accuracy: 0.6214 - 91s/epoch - 276ms/step
Validation cm: [[705  13  18   4]
 [ 71  10   6   5]
 [ 53   2  15   7]
 [ 70   1  55   4]]
Validation normalized_cm: [[0.953 0.018 0.024 0.005]
 [0.772 0.109 0.065 0.054]
 [0.688 0.026 0.195 0.091]
 [0.538 0.008 0.423 0.031]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.9527027027027027, 0.10869565217391304, 0.19480519480519481, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3217431951127603
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.3296 - accuracy: 0.6451 - 91s/epoch - 277ms/step
Validation cm: [[694  24   2  20]
 [ 67  11  12   2]
 [ 51   0  18   8]
 [ 60   7  39  24]]
Validation normalized_cm: [[0.938 0.032 0.003 0.027]
 [0.728 0.12  0.13  0.022]
 [0.662 0.    0.234 0.104]
 [0.462 0.054 0.3   0.185]]
Validation acc: 0.7189605389797883
Validation class_accuracies: [0.9378378378378378, 0.11956521739130435, 0.23376623376623376, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3689461684026902
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 3 epochs
330/330 - 92s - loss: 0.3066 - accuracy: 0.6246 - 92s/epoch - 277ms/step
Validation cm: [[184   8 224 324]
 [  1   0  12  79]
 [  2   3  24  48]
 [  1   1  28 100]]
Validation normalized_cm: [[0.249 0.011 0.303 0.438]
 [0.011 0.    0.13  0.859]
 [0.026 0.039 0.312 0.623]
 [0.008 0.008 0.215 0.769]]
Validation acc: 0.2964388835418672
Validation class_accuracies: [0.24864864864864866, 0.0, 0.3116883116883117, 0.7692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.33239193239193243
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 4 epochs
330/330 - 91s - loss: 0.2938 - accuracy: 0.6739 - 91s/epoch - 277ms/step
Validation cm: [[599   1 133   7]
 [ 79   0  13   0]
 [ 27   1  46   3]
 [ 58   0  69   3]]
Validation normalized_cm: [[0.809 0.001 0.18  0.009]
 [0.859 0.    0.141 0.   ]
 [0.351 0.013 0.597 0.039]
 [0.446 0.    0.531 0.023]]
Validation acc: 0.6236766121270453
Validation class_accuracies: [0.8094594594594594, 0.0, 0.5974025974025974, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3574847449847449
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 5 epochs
330/330 - 91s - loss: 0.2782 - accuracy: 0.6781 - 91s/epoch - 275ms/step
Validation cm: [[240  16 209 275]
 [  2   1   9  80]
 [  2   1  36  38]
 [  1   0  43  86]]
Validation normalized_cm: [[0.324 0.022 0.282 0.372]
 [0.022 0.011 0.098 0.87 ]
 [0.026 0.013 0.468 0.494]
 [0.008 0.    0.331 0.662]]
Validation acc: 0.34937439846005774
Validation class_accuracies: [0.32432432432432434, 0.010869565217391304, 0.4675324675324675, 0.6615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3660662046531612
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 6 epochs
330/330 - 91s - loss: 0.2688 - accuracy: 0.6257 - 91s/epoch - 276ms/step
Validation cm: [[194   1 415 130]
 [  2   0  47  43]
 [  2   2  38  35]
 [  1   1  76  52]]
Validation normalized_cm: [[0.262 0.001 0.561 0.176]
 [0.022 0.    0.511 0.467]
 [0.026 0.026 0.494 0.455]
 [0.008 0.008 0.585 0.4  ]]
Validation acc: 0.273339749759384
Validation class_accuracies: [0.26216216216216215, 0.0, 0.4935064935064935, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28891716391716393
Validation one_indexed_epoch: 10
Epoch 10/40
The validation tracker metric at 0.37944690444690443 hasn't increased by 0 in 7 epochs
330/330 - 91s - loss: 0.2459 - accuracy: 0.6793 - 91s/epoch - 275ms/step
Validation cm: [[408  30 156 146]
 [ 14   3  19  56]
 [ 13   2  43  19]
 [  2   1  73  54]]
Validation normalized_cm: [[0.551 0.041 0.211 0.197]
 [0.152 0.033 0.207 0.609]
 [0.169 0.026 0.558 0.247]
 [0.015 0.008 0.562 0.415]]
Validation acc: 0.48893166506256014
Validation class_accuracies: [0.5513513513513514, 0.03260869565217391, 0.5584415584415584, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3894465552074248
Validation one_indexed_epoch: 11
Epoch 11/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.2379 - accuracy: 0.6648 - 91s/epoch - 276ms/step
Validation cm: [[325  12 202 201]
 [  5   1  11  75]
 [  9   3  39  26]
 [  1   2  37  90]]
Validation normalized_cm: [[0.439 0.016 0.273 0.272]
 [0.054 0.011 0.12  0.815]
 [0.117 0.039 0.506 0.338]
 [0.008 0.015 0.285 0.692]]
Validation acc: 0.4379210779595765
Validation class_accuracies: [0.4391891891891892, 0.010869565217391304, 0.5064935064935064, 0.6923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4122149883019448
Validation one_indexed_epoch: 12
Epoch 12/40
-- New best results were achieved. --
Saving model...
330/330 - 92s - loss: 0.2307 - accuracy: 0.6669 - 92s/epoch - 280ms/step
Validation cm: [[659   7  59  15]
 [ 75   2  14   1]
 [ 28   3  40   6]
 [ 41  10  54  25]]
Validation normalized_cm: [[0.891 0.009 0.08  0.02 ]
 [0.815 0.022 0.152 0.011]
 [0.364 0.039 0.519 0.078]
 [0.315 0.077 0.415 0.192]]
Validation acc: 0.6987487969201155
Validation class_accuracies: [0.8905405405405405, 0.021739130434782608, 0.5194805194805194, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4060169706908837
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.4122149883019448 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.2134 - accuracy: 0.6496 - 92s/epoch - 278ms/step
Validation cm: [[713   4   6  17]
 [ 78   8   0   6]
 [ 50   5  20   2]
 [105  12   8   5]]
Validation normalized_cm: [[0.964 0.005 0.008 0.023]
 [0.848 0.087 0.    0.065]
 [0.649 0.065 0.26  0.026]
 [0.808 0.092 0.062 0.038]]
Validation acc: 0.7179980750721848
Validation class_accuracies: [0.9635135135135136, 0.08695652173913043, 0.2597402597402597, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3371679583636105
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.4122149883019448 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.2103 - accuracy: 0.6576 - 91s/epoch - 276ms/step
Validation cm: [[707   6  15  12]
 [ 70   2   8  12]
 [ 46   3  26   2]
 [ 61  12  52   5]]
Validation normalized_cm: [[0.955 0.008 0.02  0.016]
 [0.761 0.022 0.087 0.13 ]
 [0.597 0.039 0.338 0.026]
 [0.469 0.092 0.4   0.038]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.9554054054054054, 0.021739130434782608, 0.33766233766233766, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3383171029910161
Validation one_indexed_epoch: 15
Epoch 15/40
The validation tracker metric at 0.4122149883019448 hasn't increased by 0 in 3 epochs
330/330 - 91s - loss: 0.1928 - accuracy: 0.6495 - 91s/epoch - 277ms/step
Validation cm: [[595  64  55  26]
 [ 37  20  16  19]
 [ 28   5  38   6]
 [ 17  17  57  39]]
Validation normalized_cm: [[0.804 0.086 0.074 0.035]
 [0.402 0.217 0.174 0.207]
 [0.364 0.065 0.494 0.078]
 [0.131 0.131 0.438 0.3  ]]
Validation acc: 0.6660250240615977
Validation class_accuracies: [0.8040540540540541, 0.21739130434782608, 0.4935064935064935, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4537379629770934
Validation one_indexed_epoch: 16
Epoch 16/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.1843 - accuracy: 0.6924 - 91s/epoch - 276ms/step
Validation cm: [[462  32 149  97]
 [ 18   4  29  41]
 [ 16   4  39  18]
 [ 11   8  60  51]]
Validation normalized_cm: [[0.624 0.043 0.201 0.131]
 [0.196 0.043 0.315 0.446]
 [0.208 0.052 0.506 0.234]
 [0.085 0.062 0.462 0.392]]
Validation acc: 0.5351299326275265
Validation class_accuracies: [0.6243243243243243, 0.043478260869565216, 0.5064935064935064, 0.3923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39165094599877204
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.4537379629770934 hasn't increased by 0 in 1 epochs
330/330 - 91s - loss: 0.1691 - accuracy: 0.6515 - 91s/epoch - 277ms/step
Validation cm: [[598  98  28  16]
 [ 32  34  10  16]
 [ 34   5  33   5]
 [ 33  18  46  33]]
Validation normalized_cm: [[0.808 0.132 0.038 0.022]
 [0.348 0.37  0.109 0.174]
 [0.442 0.065 0.429 0.065]
 [0.254 0.138 0.354 0.254]]
Validation acc: 0.6717998075072185
Validation class_accuracies: [0.8081081081081081, 0.3695652173913043, 0.42857142857142855, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4650227269792487
Validation one_indexed_epoch: 18
Epoch 18/40
-- New best results were achieved. --
Saving model...
330/330 - 91s - loss: 0.1555 - accuracy: 0.6597 - 91s/epoch - 275ms/step
Validation cm: [[586  86  26  42]
 [ 31  27  10  24]
 [ 22   8  20  27]
 [ 13  19  39  59]]
Validation normalized_cm: [[0.792 0.116 0.035 0.057]
 [0.337 0.293 0.109 0.261]
 [0.286 0.104 0.26  0.351]
 [0.1   0.146 0.3   0.454]]
Validation acc: 0.6660250240615977
Validation class_accuracies: [0.7918918918918919, 0.29347826086956524, 0.2597402597402597, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44973914158696765
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.4650227269792487 hasn't increased by 0 in 1 epochs
330/330 - 91s - loss: 0.1450 - accuracy: 0.6664 - 91s/epoch - 277ms/step
Validation cm: [[376  32 241  91]
 [ 18  12  24  38]
 [  6   4  53  14]
 [  5   2  79  44]]
Validation normalized_cm: [[0.508 0.043 0.326 0.123]
 [0.196 0.13  0.261 0.413]
 [0.078 0.052 0.688 0.182]
 [0.038 0.015 0.608 0.338]]
Validation acc: 0.4667949951876805
Validation class_accuracies: [0.5081081081081081, 0.13043478260869565, 0.6883116883116883, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4163290293725077
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.4650227269792487 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.1387 - accuracy: 0.6417 - 91s/epoch - 275ms/step
Validation cm: [[219  27 340 154]
 [  4   3  45  40]
 [  1   4  44  28]
 [  3   2  73  52]]
Validation normalized_cm: [[0.296 0.036 0.459 0.208]
 [0.043 0.033 0.489 0.435]
 [0.013 0.052 0.571 0.364]
 [0.023 0.015 0.562 0.4  ]]
Validation acc: 0.3060635226179018
Validation class_accuracies: [0.2959459459459459, 0.03260869565217391, 0.5714285714285714, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32499580325667277
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.4650227269792487 hasn't increased by 0 in 3 epochs
330/330 - 92s - loss: 0.1336 - accuracy: 0.6510 - 92s/epoch - 279ms/step
Validation cm: [[583 127  21   9]
 [ 24  56  10   2]
 [ 33  13  26   5]
 [ 29  35  34  32]]
Validation normalized_cm: [[0.788 0.172 0.028 0.012]
 [0.261 0.609 0.109 0.022]
 [0.429 0.169 0.338 0.065]
 [0.223 0.269 0.262 0.246]]
Validation acc: 0.670837343599615
Validation class_accuracies: [0.7878378378378378, 0.6086956521739131, 0.33766233766233766, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4950874184569837
Validation one_indexed_epoch: 22
Epoch 22/40
-- New best results were achieved. --
Saving model...
330/330 - 92s - loss: 0.1196 - accuracy: 0.6538 - 92s/epoch - 278ms/step
Validation cm: [[340  17 331  52]
 [  6   2  63  21]
 [ 13   3  43  18]
 [ 12   3  80  35]]
Validation normalized_cm: [[0.459 0.023 0.447 0.07 ]
 [0.065 0.022 0.685 0.228]
 [0.169 0.039 0.558 0.234]
 [0.092 0.023 0.615 0.269]]
Validation acc: 0.40423484119345526
Validation class_accuracies: [0.4594594594594595, 0.021739130434782608, 0.5584415584415584, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3272177293916424
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.1153 - accuracy: 0.6565 - 92s/epoch - 278ms/step
Validation cm: [[720  18   1   1]
 [ 81   8   2   1]
 [ 64   5   6   2]
 [ 97  11  21   1]]
Validation normalized_cm: [[0.973 0.024 0.001 0.001]
 [0.88  0.087 0.022 0.011]
 [0.831 0.065 0.078 0.026]
 [0.746 0.085 0.162 0.008]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.972972972972973, 0.08695652173913043, 0.07792207792207792, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28638597008162225
Validation one_indexed_epoch: 24
Epoch 24/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 2 epochs
330/330 - 91s - loss: 0.1090 - accuracy: 0.6806 - 91s/epoch - 276ms/step
Validation cm: [[697  20  17   6]
 [ 68  14   8   2]
 [ 42   7  24   4]
 [ 77   6  40   7]]
Validation normalized_cm: [[0.942 0.027 0.023 0.008]
 [0.739 0.152 0.087 0.022]
 [0.545 0.091 0.312 0.052]
 [0.592 0.046 0.308 0.054]]
Validation acc: 0.714148219441771
Validation class_accuracies: [0.9418918918918919, 0.15217391304347827, 0.3116883116883117, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3649000676174589
Validation one_indexed_epoch: 25
Epoch 25/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 3 epochs
330/330 - 92s - loss: 0.0976 - accuracy: 0.6451 - 92s/epoch - 277ms/step
Validation cm: [[576 116  29  19]
 [ 27  42  13  10]
 [ 38   9  24   6]
 [ 16  17  71  26]]
Validation normalized_cm: [[0.778 0.157 0.039 0.026]
 [0.293 0.457 0.141 0.109]
 [0.494 0.117 0.312 0.078]
 [0.123 0.131 0.546 0.2  ]]
Validation acc: 0.6429258902791145
Validation class_accuracies: [0.7783783783783784, 0.45652173913043476, 0.3116883116883117, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4366471072992812
Validation one_indexed_epoch: 26
Epoch 26/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 4 epochs
330/330 - 91s - loss: 0.0901 - accuracy: 0.6607 - 91s/epoch - 277ms/step
Validation cm: [[700  28   4   8]
 [ 69  15   5   3]
 [ 46   7  20   4]
 [ 79  19  23   9]]
Validation normalized_cm: [[0.946 0.038 0.005 0.011]
 [0.75  0.163 0.054 0.033]
 [0.597 0.091 0.26  0.052]
 [0.608 0.146 0.177 0.069]]
Validation acc: 0.7160731472569779
Validation class_accuracies: [0.9459459459459459, 0.16304347826086957, 0.2597402597402597, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35949011329446107
Validation one_indexed_epoch: 27
Epoch 27/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 5 epochs
330/330 - 91s - loss: 0.0940 - accuracy: 0.6498 - 91s/epoch - 276ms/step
Validation cm: [[585  82  57  16]
 [ 39  29   8  16]
 [ 28   6  31  12]
 [ 29  17  48  36]]
Validation normalized_cm: [[0.791 0.111 0.077 0.022]
 [0.424 0.315 0.087 0.174]
 [0.364 0.078 0.403 0.156]
 [0.223 0.131 0.369 0.277]]
Validation acc: 0.6554379210779596
Validation class_accuracies: [0.7905405405405406, 0.31521739130434784, 0.4025974025974026, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.446319602841342
Validation one_indexed_epoch: 28
Epoch 28/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 6 epochs
330/330 - 91s - loss: 0.0760 - accuracy: 0.6377 - 91s/epoch - 276ms/step
Validation cm: [[710  13   3  14]
 [ 69  14   7   2]
 [ 56   6  15   0]
 [ 93   5  31   1]]
Validation normalized_cm: [[0.959 0.018 0.004 0.019]
 [0.75  0.152 0.076 0.022]
 [0.727 0.078 0.195 0.   ]
 [0.715 0.038 0.238 0.008]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.9594594594594594, 0.15217391304347827, 0.19480519480519481, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32853271875011003
Validation one_indexed_epoch: 29
Epoch 29/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 7 epochs
330/330 - 91s - loss: 0.0784 - accuracy: 0.6536 - 91s/epoch - 276ms/step
Validation cm: [[402  80 166  92]
 [ 23  18  22  29]
 [ 12   7  35  23]
 [ 12  14  63  41]]
Validation normalized_cm: [[0.543 0.108 0.224 0.124]
 [0.25  0.196 0.239 0.315]
 [0.156 0.091 0.455 0.299]
 [0.092 0.108 0.485 0.315]]
Validation acc: 0.4773820981713186
Validation class_accuracies: [0.5432432432432432, 0.1956521739130435, 0.45454545454545453, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37720637177158917
Validation one_indexed_epoch: 30
Epoch 30/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 8 epochs
330/330 - 93s - loss: 0.0685 - accuracy: 0.6643 - 93s/epoch - 281ms/step
Validation cm: [[713  16   3   8]
 [ 70  12   9   1]
 [ 55   3  18   1]
 [ 87  11  30   2]]
Validation normalized_cm: [[0.964 0.022 0.004 0.011]
 [0.761 0.13  0.098 0.011]
 [0.714 0.039 0.234 0.013]
 [0.669 0.085 0.231 0.015]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [0.9635135135135136, 0.13043478260869565, 0.23376623376623376, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3357747863182646
Validation one_indexed_epoch: 31
Epoch 31/40
The validation tracker metric at 0.4950874184569837 hasn't increased by 0 in 9 epochs
330/330 - 92s - loss: 0.0697 - accuracy: 0.6557 - 92s/epoch - 279ms/step
Validation cm: [[702  10  12  16]
 [ 69  13   6   4]
 [ 43   5  29   0]
 [ 88  12  27   3]]
Validation normalized_cm: [[0.949 0.014 0.016 0.022]
 [0.75  0.141 0.065 0.043]
 [0.558 0.065 0.377 0.   ]
 [0.677 0.092 0.208 0.023]]
Validation acc: 0.7189605389797883
Validation class_accuracies: [0.9486486486486486, 0.14130434782608695, 0.37662337662337664, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3724133240437588
Validation one_indexed_epoch: 32
Epoch 32/40
The number of epochs since last 1% equals the patience
330/330 - 92s - loss: 0.0614 - accuracy: 0.6087 - 92s/epoch - 279ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4950874184569837
Best cm: [[583 127  21   9]
 [ 24  56  10   2]
 [ 33  13  26   5]
 [ 29  35  34  32]]
Best normalized_cm: [[0.788 0.172 0.028 0.012]
 [0.261 0.609 0.109 0.022]
 [0.429 0.169 0.338 0.065]
 [0.223 0.269 0.262 0.246]]
Best acc: 0.670837343599615
Best class_accuracies: [0.7878378378378378, 0.6086956521739131, 0.33766233766233766, 0.24615384615384617]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 22
Validation cm: [[736   0   4   0]
 [ 91   0   1   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[0.995 0.    0.005 0.   ]
 [0.989 0.    0.011 0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.9945945945945946, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24864864864864866
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 batch_normalization_5 (BatchNormalization)      multiple                                    4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_1 (Dense)                                 multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,158
Trainable params: 6,159,652
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Saving model...
330/330 - 224s - accuracy: 0.4910 - student_loss: 0.3986 - distillation_loss: -2.1481e-03 - val_accuracy: 0.9192 - val_student_loss: 0.3397 - 224s/epoch - 678ms/step
Validation cm: [[459  69 127  85]
 [ 30  11  17  34]
 [ 48   4  16   9]
 [ 17  14  84  15]]
Validation normalized_cm: [[0.62  0.093 0.172 0.115]
 [0.326 0.12  0.185 0.37 ]
 [0.623 0.052 0.208 0.117]
 [0.131 0.108 0.646 0.115]]
Validation acc: 0.4821944177093359
Validation class_accuracies: [0.6202702702702703, 0.11956521739130435, 0.2077922077922078, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26575307770959944
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Saving model...
330/330 - 209s - accuracy: 0.4735 - student_loss: 0.4071 - distillation_loss: -7.1391e-04 - val_accuracy: 0.5101 - val_student_loss: 1.7918 - 209s/epoch - 634ms/step
Validation cm: [[304   5  78 353]
 [ 10   0  10  72]
 [ 40   1   7  29]
 [ 73   1  14  42]]
Validation normalized_cm: [[0.411 0.007 0.105 0.477]
 [0.109 0.    0.109 0.783]
 [0.519 0.013 0.091 0.377]
 [0.562 0.008 0.108 0.323]]
Validation acc: 0.3397497593840231
Validation class_accuracies: [0.41081081081081083, 0.0, 0.09090909090909091, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.20619920619920623
Validation one_indexed_epoch: 3
Epoch 3/40
The validation tracker metric at 0.26575307770959944 hasn't increased by 0 in 1 epochs
330/330 - 211s - accuracy: 0.4737 - student_loss: 0.3045 - distillation_loss: -5.9663e-03 - val_accuracy: 0.2993 - val_student_loss: 2.1773 - 211s/epoch - 638ms/step
Validation cm: [[683  55   2   0]
 [ 85   7   0   0]
 [ 68   8   1   0]
 [108  20   2   0]]
Validation normalized_cm: [[0.923 0.074 0.003 0.   ]
 [0.924 0.076 0.    0.   ]
 [0.883 0.104 0.013 0.   ]
 [0.831 0.154 0.015 0.   ]]
Validation acc: 0.6650625601539942
Validation class_accuracies: [0.922972972972973, 0.07608695652173914, 0.012987012987012988, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2530117356204313
Validation one_indexed_epoch: 4
Epoch 4/40
The validation tracker metric at 0.26575307770959944 hasn't increased by 0 in 2 epochs
330/330 - 209s - accuracy: 0.4659 - student_loss: 0.5160 - distillation_loss: -2.0461e-03 - val_accuracy: 0.7883 - val_student_loss: 0.0029 - 209s/epoch - 634ms/step
Validation cm: [[181 512  12  35]
 [  4  78   0  10]
 [ 19  35   8  15]
 [  2  49  33  46]]
Validation normalized_cm: [[0.245 0.692 0.016 0.047]
 [0.043 0.848 0.    0.109]
 [0.247 0.455 0.104 0.195]
 [0.015 0.377 0.254 0.354]]
Validation acc: 0.3012512030798845
Validation class_accuracies: [0.2445945945945946, 0.8478260869565217, 0.1038961038961039, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38754073482334356
Validation one_indexed_epoch: 5
Epoch 5/40
-- New best results were achieved. --
Saving model...
330/330 - 209s - accuracy: 0.5253 - student_loss: 0.1896 - distillation_loss: -5.4549e-03 - val_accuracy: 0.7632 - val_student_loss: 4.4465 - 209s/epoch - 633ms/step
Validation cm: [[178 186   8 368]
 [  2  19   0  71]
 [ 15  18   5  39]
 [  9  13   4 104]]
Validation normalized_cm: [[0.241 0.251 0.011 0.497]
 [0.022 0.207 0.    0.772]
 [0.195 0.234 0.065 0.506]
 [0.069 0.1   0.031 0.8  ]]
Validation acc: 0.2945139557266602
Validation class_accuracies: [0.24054054054054055, 0.20652173913043478, 0.06493506493506493, 0.8]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3279993361515101
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.38754073482334356 hasn't increased by 0 in 1 epochs
330/330 - 209s - accuracy: 0.5641 - student_loss: 0.6787 - distillation_loss: -3.2205e-03 - val_accuracy: 0.8219 - val_student_loss: 7.3098 - 209s/epoch - 634ms/step
Validation cm: [[206 133 109 292]
 [  3  15   1  73]
 [  6  11  21  39]
 [  0  11  12 107]]
Validation normalized_cm: [[0.278 0.18  0.147 0.395]
 [0.033 0.163 0.011 0.793]
 [0.078 0.143 0.273 0.506]
 [0.    0.085 0.092 0.823]]
Validation acc: 0.33589990375360923
Validation class_accuracies: [0.27837837837837837, 0.16304347826086957, 0.2727272727272727, 0.823076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38430651311086095
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.38754073482334356 hasn't increased by 0 in 2 epochs
330/330 - 210s - accuracy: 0.5878 - student_loss: 0.8161 - distillation_loss: -1.9162e-03 - val_accuracy: 0.4764 - val_student_loss: 6.1933 - 210s/epoch - 637ms/step
Validation cm: [[380 110  26 224]
 [ 23  12   3  54]
 [ 30   6  15  26]
 [ 25  14  29  62]]
Validation normalized_cm: [[0.514 0.149 0.035 0.303]
 [0.25  0.13  0.033 0.587]
 [0.39  0.078 0.195 0.338]
 [0.192 0.108 0.223 0.477]]
Validation acc: 0.45139557266602504
Validation class_accuracies: [0.5135135135135135, 0.13043478260869565, 0.19480519480519481, 0.47692307692307695]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32891914196262023
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.38754073482334356 hasn't increased by 0 in 3 epochs
330/330 - 209s - accuracy: 0.6005 - student_loss: 0.2575 - distillation_loss: -4.3804e-03 - val_accuracy: 0.7257 - val_student_loss: 3.8578 - 209s/epoch - 634ms/step
Validation cm: [[238 286  33 183]
 [ 13  39   0  40]
 [ 14  14  15  34]
 [ 18  21  17  74]]
Validation normalized_cm: [[0.322 0.386 0.045 0.247]
 [0.141 0.424 0.    0.435]
 [0.182 0.182 0.195 0.442]
 [0.138 0.162 0.131 0.569]]
Validation acc: 0.35226179018286813
Validation class_accuracies: [0.3216216216216216, 0.42391304347826086, 0.19480519480519481, 0.5692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3773926572839616
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.38754073482334356 hasn't increased by 0 in 4 epochs
330/330 - 209s - accuracy: 0.6392 - student_loss: 0.2203 - distillation_loss: -3.7639e-03 - val_accuracy: 0.6833 - val_student_loss: 5.9068 - 209s/epoch - 634ms/step
Validation cm: [[306 165  36 233]
 [  6  27   1  58]
 [ 18  10  13  36]
 [ 10   7  12 101]]
Validation normalized_cm: [[0.414 0.223 0.049 0.315]
 [0.065 0.293 0.011 0.63 ]
 [0.234 0.13  0.169 0.468]
 [0.077 0.054 0.092 0.777]]
Validation acc: 0.4302213666987488
Validation class_accuracies: [0.4135135135135135, 0.29347826086956524, 0.16883116883116883, 0.7769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4131865050343311
Validation one_indexed_epoch: 10
Epoch 10/40
-- New best results were achieved. --
Saving model...
330/330 - 209s - accuracy: 0.6599 - student_loss: 0.2876 - distillation_loss: -4.2789e-03 - val_accuracy: 0.7584 - val_student_loss: 8.2508 - 209s/epoch - 634ms/step
Validation cm: [[470  13 251   6]
 [ 26   0  64   2]
 [ 36   3  35   3]
 [ 21   0 101   8]]
Validation normalized_cm: [[0.635 0.018 0.339 0.008]
 [0.283 0.    0.696 0.022]
 [0.468 0.039 0.455 0.039]
 [0.162 0.    0.777 0.062]]
Validation acc: 0.4937439846005775
Validation class_accuracies: [0.6351351351351351, 0.0, 0.45454545454545453, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2878047628047628
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.4131865050343311 hasn't increased by 0 in 1 epochs
330/330 - 211s - accuracy: 0.6350 - student_loss: 0.1352 - distillation_loss: -1.1395e-03 - val_accuracy: 0.3253 - val_student_loss: 4.8627 - 211s/epoch - 639ms/step
Validation cm: [[269  49  48 374]
 [  9   6   6  71]
 [ 18   0  12  47]
 [ 10   0   5 115]]
Validation normalized_cm: [[0.364 0.066 0.065 0.505]
 [0.098 0.065 0.065 0.772]
 [0.234 0.    0.156 0.61 ]
 [0.077 0.    0.038 0.885]]
Validation acc: 0.3869104908565929
Validation class_accuracies: [0.3635135135135135, 0.06521739130434782, 0.15584415584415584, 0.8846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36729761131935046
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.4131865050343311 hasn't increased by 0 in 2 epochs
330/330 - 210s - accuracy: 0.6815 - student_loss: 1.0671 - distillation_loss: 0.0018 - val_accuracy: 0.6352 - val_student_loss: 10.7982 - 210s/epoch - 636ms/step
Validation cm: [[323 130 257  30]
 [ 23   3  62   4]
 [ 14   8  45  10]
 [  2   2  88  38]]
Validation normalized_cm: [[0.436 0.176 0.347 0.041]
 [0.25  0.033 0.674 0.043]
 [0.182 0.104 0.584 0.13 ]
 [0.015 0.015 0.677 0.292]]
Validation acc: 0.39364773820981713
Validation class_accuracies: [0.43648648648648647, 0.03260869565217391, 0.5844155844155844, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.33645461471548427
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.4131865050343311 hasn't increased by 0 in 3 epochs
330/330 - 209s - accuracy: 0.6464 - student_loss: 0.6213 - distillation_loss: 0.0057 - val_accuracy: 0.3388 - val_student_loss: 5.2179 - 209s/epoch - 635ms/step
Validation cm: [[188  54  85 413]
 [  3   7   4  78]
 [  7   6  15  49]
 [  0   2   1 127]]
Validation normalized_cm: [[0.254 0.073 0.115 0.558]
 [0.033 0.076 0.043 0.848]
 [0.091 0.078 0.195 0.636]
 [0.    0.015 0.008 0.977]]
Validation acc: 0.32435033686236764
Validation class_accuracies: [0.25405405405405407, 0.07608695652173914, 0.19480519480519481, 0.9769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37546732057601623
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.4131865050343311 hasn't increased by 0 in 4 epochs
330/330 - 209s - accuracy: 0.6512 - student_loss: 0.3401 - distillation_loss: -5.4553e-03 - val_accuracy: 0.3321 - val_student_loss: 17.0372 - 209s/epoch - 635ms/step
Validation cm: [[450  52  68 170]
 [ 32   4  13  43]
 [ 20   1  30  26]
 [ 14   3  62  51]]
Validation normalized_cm: [[0.608 0.07  0.092 0.23 ]
 [0.348 0.043 0.141 0.467]
 [0.26  0.013 0.39  0.338]
 [0.108 0.023 0.477 0.392]]
Validation acc: 0.5149181905678537
Validation class_accuracies: [0.6081081081081081, 0.043478260869565216, 0.38961038961038963, 0.3923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35837611272393877
Validation one_indexed_epoch: 15
Epoch 15/40
The validation tracker metric at 0.4131865050343311 hasn't increased by 0 in 5 epochs
330/330 - 211s - accuracy: 0.6698 - student_loss: 0.1355 - distillation_loss: -1.7303e-03 - val_accuracy: 0.5842 - val_student_loss: 5.0519 - 211s/epoch - 639ms/step
Validation cm: [[314 267  18 141]
 [ 15  25   1  51]
 [ 23  14   7  33]
 [ 11  21   3  95]]
Validation normalized_cm: [[0.424 0.361 0.024 0.191]
 [0.163 0.272 0.011 0.554]
 [0.299 0.182 0.091 0.429]
 [0.085 0.162 0.023 0.731]]
Validation acc: 0.424446583253128
Validation class_accuracies: [0.4243243243243243, 0.2717391304347826, 0.09090909090909091, 0.7307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37943544410935715
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.4131865050343311 hasn't increased by 0 in 6 epochs
330/330 - 209s - accuracy: 0.7005 - student_loss: 0.5124 - distillation_loss: -1.1810e-03 - val_accuracy: 0.8046 - val_student_loss: 5.9291 - 209s/epoch - 634ms/step
Validation cm: [[480 255   3   2]
 [ 32  57   0   3]
 [ 33  27  13   4]
 [ 17  63   0  50]]
Validation normalized_cm: [[0.649 0.345 0.004 0.003]
 [0.348 0.62  0.    0.033]
 [0.429 0.351 0.169 0.052]
 [0.131 0.485 0.    0.385]]
Validation acc: 0.5774783445620789
Validation class_accuracies: [0.6486486486486487, 0.6195652173913043, 0.16883116883116883, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45541510487162656
Validation one_indexed_epoch: 17
Epoch 17/40
-- New best results were achieved. --
Saving model...
330/330 - 209s - accuracy: 0.6764 - student_loss: 0.8266 - distillation_loss: 0.0045 - val_accuracy: 0.8922 - val_student_loss: 7.7628 - 209s/epoch - 634ms/step
Validation cm: [[360 360   5  15]
 [ 12  72   0   8]
 [ 21  35  14   7]
 [ 11  48  28  43]]
Validation normalized_cm: [[0.486 0.486 0.007 0.02 ]
 [0.13  0.783 0.    0.087]
 [0.273 0.455 0.182 0.091]
 [0.085 0.369 0.215 0.331]]
Validation acc: 0.4706448508180943
Validation class_accuracies: [0.4864864864864865, 0.782608695652174, 0.18181818181818182, 0.33076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44542064868151826
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 1 epochs
330/330 - 210s - accuracy: 0.6485 - student_loss: 0.4367 - distillation_loss: -3.0476e-03 - val_accuracy: 0.8422 - val_student_loss: 4.5773 - 210s/epoch - 635ms/step
Validation cm: [[394 317   4  25]
 [ 32  35   1  24]
 [ 29  22  16  10]
 [ 14  43  38  35]]
Validation normalized_cm: [[0.532 0.428 0.005 0.034]
 [0.348 0.38  0.011 0.261]
 [0.377 0.286 0.208 0.13 ]
 [0.108 0.331 0.292 0.269]]
Validation acc: 0.4619826756496631
Validation class_accuracies: [0.5324324324324324, 0.3804347826086957, 0.2077922077922078, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3474725480160263
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 2 epochs
330/330 - 211s - accuracy: 0.6736 - student_loss: 0.9145 - distillation_loss: -2.4423e-03 - val_accuracy: 0.8133 - val_student_loss: 5.0375 - 211s/epoch - 639ms/step
Validation cm: [[294 415  16  15]
 [ 23  67   1   1]
 [ 14  34  19  10]
 [ 25  83   3  19]]
Validation normalized_cm: [[0.397 0.561 0.022 0.02 ]
 [0.25  0.728 0.011 0.011]
 [0.182 0.442 0.247 0.13 ]
 [0.192 0.638 0.023 0.146]]
Validation acc: 0.38402309913378246
Validation class_accuracies: [0.3972972972972973, 0.7282608695652174, 0.24675324675324675, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3796163149424019
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 3 epochs
330/330 - 209s - accuracy: 0.7185 - student_loss: 0.1384 - distillation_loss: -1.8804e-03 - val_accuracy: 0.8412 - val_student_loss: 6.5640 - 209s/epoch - 634ms/step
Validation cm: [[190 291  11 248]
 [  9  43   1  39]
 [  7  19  13  38]
 [  5  21   8  96]]
Validation normalized_cm: [[0.257 0.393 0.015 0.335]
 [0.098 0.467 0.011 0.424]
 [0.091 0.247 0.169 0.494]
 [0.038 0.162 0.062 0.738]]
Validation acc: 0.329162656400385
Validation class_accuracies: [0.25675675675675674, 0.4673913043478261, 0.16883116883116883, 0.7384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40786019209932256
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 4 epochs
330/330 - 210s - accuracy: 0.6950 - student_loss: 0.1249 - distillation_loss: -4.2050e-03 - val_accuracy: 0.8537 - val_student_loss: 16.6014 - 210s/epoch - 636ms/step
Validation cm: [[216 499  13  12]
 [ 15  74   2   1]
 [ 10  40  14  13]
 [ 13  83   5  29]]
Validation normalized_cm: [[0.292 0.674 0.018 0.016]
 [0.163 0.804 0.022 0.011]
 [0.13  0.519 0.182 0.169]
 [0.1   0.638 0.038 0.223]]
Validation acc: 0.3205004812319538
Validation class_accuracies: [0.2918918918918919, 0.8043478260869565, 0.18181818181818182, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3752837057184884
Validation one_indexed_epoch: 22
Epoch 22/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 5 epochs
330/330 - 210s - accuracy: 0.7053 - student_loss: 0.3214 - distillation_loss: -4.8454e-03 - val_accuracy: 0.8662 - val_student_loss: 11.4959 - 210s/epoch - 637ms/step
Validation cm: [[566  51  74  49]
 [ 51   4  10  27]
 [ 33   5  24  15]
 [ 18  11  46  55]]
Validation normalized_cm: [[0.765 0.069 0.1   0.066]
 [0.554 0.043 0.109 0.293]
 [0.429 0.065 0.312 0.195]
 [0.138 0.085 0.354 0.423]]
Validation acc: 0.6246390760346487
Validation class_accuracies: [0.7648648648648648, 0.043478260869565216, 0.3116883116883117, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3857770901249162
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 6 epochs
330/330 - 211s - accuracy: 0.7231 - student_loss: 0.1803 - distillation_loss: -3.3304e-03 - val_accuracy: 0.4735 - val_student_loss: 3.2471 - 211s/epoch - 641ms/step
Validation cm: [[392 346   2   0]
 [ 31  59   2   0]
 [ 28  31  18   0]
 [ 17  88   9  16]]
Validation normalized_cm: [[0.53  0.468 0.003 0.   ]
 [0.337 0.641 0.022 0.   ]
 [0.364 0.403 0.234 0.   ]
 [0.131 0.677 0.069 0.123]]
Validation acc: 0.4667949951876805
Validation class_accuracies: [0.5297297297297298, 0.6413043478260869, 0.23376623376623376, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3819693085997434
Validation one_indexed_epoch: 24
Epoch 24/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 7 epochs
330/330 - 210s - accuracy: 0.6884 - student_loss: 0.1003 - distillation_loss: -2.2946e-03 - val_accuracy: 0.8816 - val_student_loss: 10.1636 - 210s/epoch - 637ms/step
Validation cm: [[367 355  16   2]
 [ 37  53   2   0]
 [ 26  27  18   6]
 [ 30  73   8  19]]
Validation normalized_cm: [[0.496 0.48  0.022 0.003]
 [0.402 0.576 0.022 0.   ]
 [0.338 0.351 0.234 0.078]
 [0.231 0.562 0.062 0.146]]
Validation acc: 0.43984600577478344
Validation class_accuracies: [0.49594594594594593, 0.5760869565217391, 0.23376623376623376, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36298824559694126
Validation one_indexed_epoch: 25
Epoch 25/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 8 epochs
330/330 - 210s - accuracy: 0.7288 - student_loss: 0.2824 - distillation_loss: -2.2400e-03 - val_accuracy: 0.8412 - val_student_loss: 10.4780 - 210s/epoch - 635ms/step
Validation cm: [[336  99  72 233]
 [ 31   8  15  38]
 [ 23   4  24  26]
 [ 24  16   9  81]]
Validation normalized_cm: [[0.454 0.134 0.097 0.315]
 [0.337 0.087 0.163 0.413]
 [0.299 0.052 0.312 0.338]
 [0.185 0.123 0.069 0.623]]
Validation acc: 0.43214629451395575
Validation class_accuracies: [0.4540540540540541, 0.08695652173913043, 0.3116883116883117, 0.6230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3689439526396048
Validation one_indexed_epoch: 26
Epoch 26/40
The validation tracker metric at 0.45541510487162656 hasn't increased by 0 in 9 epochs
330/330 - 210s - accuracy: 0.7519 - student_loss: 0.3084 - distillation_loss: -4.8942e-03 - val_accuracy: 0.5650 - val_student_loss: 17.3057 - 210s/epoch - 636ms/step
Validation cm: [[ 96 600  14  30]
 [  3  84   3   2]
 [  9  43  11  14]
 [  7  99   1  23]]
Validation normalized_cm: [[0.13  0.811 0.019 0.041]
 [0.033 0.913 0.033 0.022]
 [0.117 0.558 0.143 0.182]
 [0.054 0.762 0.008 0.177]]
Validation acc: 0.20596727622714148
Validation class_accuracies: [0.12972972972972974, 0.9130434782608695, 0.14285714285714285, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3406383569427048
Validation one_indexed_epoch: 27
Epoch 27/40
The number of epochs since last 1% equals the patience
330/330 - 211s - accuracy: 0.7191 - student_loss: 0.5146 - distillation_loss: -7.3491e-03 - val_accuracy: 0.8951 - val_student_loss: 23.6080 - 211s/epoch - 640ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.45541510487162656
Best cm: [[480 255   3   2]
 [ 32  57   0   3]
 [ 33  27  13   4]
 [ 17  63   0  50]]
Best normalized_cm: [[0.649 0.345 0.004 0.003]
 [0.348 0.62  0.    0.033]
 [0.429 0.351 0.169 0.052]
 [0.131 0.485 0.    0.385]]
Best acc: 0.5774783445620789
Best class_accuracies: [0.6486486486486487, 0.6195652173913043, 0.16883116883116883, 0.38461538461538464]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 17
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
