Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train39
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 564s - loss: 0.4381 - accuracy: 0.6014 - 564s/epoch - 2s/step
Validation cm: [[727  13   0   0]
 [ 88   3   1   0]
 [ 72   1   3   1]
 [102   2  22   4]]
Validation normalized_cm: [[0.982 0.018 0.    0.   ]
 [0.957 0.033 0.011 0.   ]
 [0.935 0.013 0.039 0.013]
 [0.785 0.015 0.169 0.031]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.9824324324324324, 0.03260869565217391, 0.03896103896103896, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.271192849453719
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 549s - loss: 0.3456 - accuracy: 0.6495 - 549s/epoch - 2s/step
Validation cm: [[670  43  19   8]
 [ 48  26  14   4]
 [ 38   2  32   5]
 [ 29   3  87  11]]
Validation normalized_cm: [[0.905 0.058 0.026 0.011]
 [0.522 0.283 0.152 0.043]
 [0.494 0.026 0.416 0.065]
 [0.223 0.023 0.669 0.085]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.9054054054054054, 0.2826086956521739, 0.4155844155844156, 0.08461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42205347531434484
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 558s - loss: 0.3147 - accuracy: 0.6515 - 558s/epoch - 2s/step
Validation cm: [[645  73  16   6]
 [ 30  41  16   5]
 [ 44   3  29   1]
 [ 39   5  81   5]]
Validation normalized_cm: [[0.872 0.099 0.022 0.008]
 [0.326 0.446 0.174 0.054]
 [0.571 0.039 0.377 0.013]
 [0.3   0.038 0.623 0.038]]
Validation acc: 0.6929740134744947
Validation class_accuracies: [0.8716216216216216, 0.44565217391304346, 0.37662337662337664, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43308967765489503
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 562s - loss: 0.2762 - accuracy: 0.6531 - 562s/epoch - 2s/step
Validation cm: [[686  48   4   2]
 [ 66  20   3   3]
 [ 60   5   7   5]
 [ 75   4  33  18]]
Validation normalized_cm: [[0.927 0.065 0.005 0.003]
 [0.717 0.217 0.033 0.033]
 [0.779 0.065 0.091 0.065]
 [0.577 0.031 0.254 0.138]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.927027027027027, 0.21739130434782608, 0.09090909090909091, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3434472401863706
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.43308967765489503 hasn't increased by 0 in 1 epochs
330/330 - 552s - loss: 0.2488 - accuracy: 0.6447 - 552s/epoch - 2s/step
Validation cm: [[628  94   5  13]
 [ 26  43   9  14]
 [ 42   7  17  11]
 [ 30  13  44  43]]
Validation normalized_cm: [[0.849 0.127 0.007 0.018]
 [0.283 0.467 0.098 0.152]
 [0.545 0.091 0.221 0.143]
 [0.231 0.1   0.338 0.331]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.8486486486486486, 0.4673913043478261, 0.22077922077922077, 0.33076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46689710113623156
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 544s - loss: 0.2118 - accuracy: 0.6629 - 544s/epoch - 2s/step
Validation cm: [[555  81  66  38]
 [ 23  31  15  23]
 [ 27   5  31  14]
 [ 15   7  75  33]]
Validation normalized_cm: [[0.75  0.109 0.089 0.051]
 [0.25  0.337 0.163 0.25 ]
 [0.351 0.065 0.403 0.182]
 [0.115 0.054 0.577 0.254]]
Validation acc: 0.6256015399422522
Validation class_accuracies: [0.75, 0.33695652173913043, 0.4025974025974026, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4358500195456717
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.46689710113623156 hasn't increased by 0 in 1 epochs
330/330 - 539s - loss: 0.1855 - accuracy: 0.6848 - 539s/epoch - 2s/step
Validation cm: [[637  39  47  17]
 [ 48  27  11   6]
 [ 28   5  39   5]
 [ 48   4  47  31]]
Validation normalized_cm: [[0.861 0.053 0.064 0.023]
 [0.522 0.293 0.12  0.065]
 [0.364 0.065 0.506 0.065]
 [0.369 0.031 0.362 0.238]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.8608108108108108, 0.29347826086956524, 0.5064935064935064, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4748110291588552
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 548s - loss: 0.1579 - accuracy: 0.6952 - 548s/epoch - 2s/step
Validation cm: [[404  89 136 111]
 [ 11  25  15  41]
 [ 11   2  30  34]
 [  3   2  43  82]]
Validation normalized_cm: [[0.546 0.12  0.184 0.15 ]
 [0.12  0.272 0.163 0.446]
 [0.143 0.026 0.39  0.442]
 [0.023 0.015 0.331 0.631]]
Validation acc: 0.5206929740134745
Validation class_accuracies: [0.5459459459459459, 0.2717391304347826, 0.38961038961038963, 0.6307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4595161741900872
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.4748110291588552 hasn't increased by 0 in 1 epochs
330/330 - 547s - loss: 0.1348 - accuracy: 0.6720 - 547s/epoch - 2s/step
Validation cm: [[564  44 106  26]
 [ 25  23  22  22]
 [ 16   1  50  10]
 [ 11   3 103  13]]
Validation normalized_cm: [[0.762 0.059 0.143 0.035]
 [0.272 0.25  0.239 0.239]
 [0.208 0.013 0.649 0.13 ]
 [0.085 0.023 0.792 0.1  ]]
Validation acc: 0.6256015399422522
Validation class_accuracies: [0.7621621621621621, 0.25, 0.6493506493506493, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4403782028782029
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.4748110291588552 hasn't increased by 0 in 2 epochs
330/330 - 544s - loss: 0.1057 - accuracy: 0.6779 - 544s/epoch - 2s/step
Validation cm: [[710  25   4   1]
 [ 68  14  10   0]
 [ 59   2  15   1]
 [ 59   2  59  10]]
Validation normalized_cm: [[0.959 0.034 0.005 0.001]
 [0.739 0.152 0.109 0.   ]
 [0.766 0.026 0.195 0.013]
 [0.454 0.015 0.454 0.077]]
Validation acc: 0.7208854667949952
Validation class_accuracies: [0.9594594594594594, 0.15217391304347827, 0.19480519480519481, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.34584041105780233
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.4748110291588552 hasn't increased by 0 in 3 epochs
330/330 - 540s - loss: 0.0941 - accuracy: 0.6669 - 540s/epoch - 2s/step
Validation cm: [[611  67  34  28]
 [ 26  29  15  22]
 [ 32   6  34   5]
 [ 27   5  62  36]]
Validation normalized_cm: [[0.826 0.091 0.046 0.038]
 [0.283 0.315 0.163 0.239]
 [0.416 0.078 0.442 0.065]
 [0.208 0.038 0.477 0.277]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.8256756756756757, 0.31521739130434784, 0.44155844155844154, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46484364636538544
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.4748110291588552 hasn't increased by 0 in 4 epochs
330/330 - 548s - loss: 0.0812 - accuracy: 0.6646 - 548s/epoch - 2s/step
Validation cm: [[458  49 193  40]
 [ 22  21  22  27]
 [ 12   0  42  23]
 [  4   3  73  50]]
Validation normalized_cm: [[0.619 0.066 0.261 0.054]
 [0.239 0.228 0.239 0.293]
 [0.156 0.    0.545 0.299]
 [0.031 0.023 0.562 0.385]]
Validation acc: 0.5495668912415784
Validation class_accuracies: [0.6189189189189189, 0.22826086956521738, 0.5454545454545454, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4443124296385166
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.4748110291588552 hasn't increased by 0 in 5 epochs
330/330 - 539s - loss: 0.0637 - accuracy: 0.6580 - 539s/epoch - 2s/step
Validation cm: [[662  36  32  10]
 [ 50  13  19  10]
 [ 38   5  26   8]
 [ 36   9  51  34]]
Validation normalized_cm: [[0.895 0.049 0.043 0.014]
 [0.543 0.141 0.207 0.109]
 [0.494 0.065 0.338 0.104]
 [0.277 0.069 0.392 0.262]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.8945945945945946, 0.14130434782608695, 0.33766233766233766, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40877493540537013
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 542s - loss: 0.0481 - accuracy: 0.6552 - 542s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4748110291588552
Best cm: [[637  39  47  17]
 [ 48  27  11   6]
 [ 28   5  39   5]
 [ 48   4  47  31]]
Best normalized_cm: [[0.861 0.053 0.064 0.023]
 [0.522 0.293 0.12  0.065]
 [0.364 0.065 0.506 0.065]
 [0.369 0.031 0.362 0.238]]
Best acc: 0.7064485081809432
Best class_accuracies: [0.8608108108108108, 0.29347826086956524, 0.5064935064935064, 0.23846153846153847]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 8
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
