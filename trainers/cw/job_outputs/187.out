Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train187
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
training parameters
[('cache_root', '../cache/'), ('data_root', '../data/'), ('jordan_root', '../data/jwyy9np4gv-3/'), ('icbhi_root', '../data/raw_audios/icbhi_preprocessed_v2_cleaned_8000/'), ('bd_root', '../data/PCV_SEGMENTED_Processed_Files/'), ('excel_path', '../data/Bangladesh_PCV_onlyStudyPatients.xlsx'), ('perch_root', '../data/raw_audios/perch_8000_10seconds'), ('ant_root', '../data/raw_audios/Antwerp_Clinical_Complete'), ('description', ' effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,'), ('job_id', 0), ('mode', 'cw'), ('n_classes', 2), ('shape', (80, 500, 3)), ('n_epochs', 110), ('lr', 0.001), ('batch_size', 16), ('ll2_reg', 0), ('weight_decay', 0.01), ('label_smoothing', 0), ('epsilon', 1e-07), ('es_patience', 15), ('min_delta', 0), ('train_test_ratio', 0.8), ('kfold', False), ('clause', 0), ('epoch_start', 0), ('testing', 0), ('adaptive_lr', True), ('cuberooting', 1), ('normalizing', 1), ('class_weights', True), ('early_stopping', True), ('initial_channels', 1), ('factor', 0.5), ('lr_patience', 5), ('min_lr', 1e-05), ('sr', 4000), ('audio_length', 5), ('step_size', 2.5), ('n_fft', 1024), ('hop_length', 254), ('n_mels', 128), ('overlap_threshold', 0.3), ('trainable_fb', False), ('to_decibel', True), ('train_nn', False), ('train_mel', False), ('file_dir', '../cache/cw/train187'), ('n_sequences', 9), ('activate_spectral_loss', False), ('normalize', False), ('stacking', False), ('oversample', False), ('one_hot_encoding', False), ('activation', 'sigmoid'), ('n_filters', 80)]
Job id is 1.
Job dir: ../cache/cw/train187/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
turning the kfold from 90/10 to 80/20
100
12
to
90
22
-----------------------
--- Final training dataset went from 0 to 3969 elements, with 1889 none's, 991 crakles, 597 wheezes and 492 both ---
--- Final Validation dataset contains 2096 elements, with 989 none, 843 crackles, 120 wheezes and 144 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5252779248279513, 1: 1.0012613521695257, 2: 1.6620603015075377, 3: 2.0167682926829267}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d (G  (None, 1280)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               128100    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[904  53  28   4]
 [785  39  11   8]
 [ 94  13   6   7]
 [129   6   9   0]]
Validation val_loss: 0.6530837343280552
Validation normalized_cm: [[0.914 0.054 0.028 0.004]
 [0.931 0.046 0.013 0.009]
 [0.783 0.108 0.05  0.058]
 [0.896 0.042 0.062 0.   ]]
Validation acc: 0.4527671755725191
Validation class_accuracies: [0.9140546006066734, 0.046263345195729534, 0.05, 0.0]
Validation sensitivity: 0.04065040650406504
Validation specificity: 0.9140546006066734
Validation icbhi_score: 0.47735250355536923
Validation roc_auc: None
Validation avg_accuracy: 0.25257948645060074
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
249/249 - 167s - loss: 0.6960 - accuracy: 0.4963 - 167s/epoch - 670ms/step
Epoch 2/110
Validation cm: [[614 355  10  10]
 [400 430   4   9]
 [ 72  36   5   7]
 [ 79  51   5   9]]
Validation val_loss: 0.621702930939789
Validation normalized_cm: [[0.621 0.359 0.01  0.01 ]
 [0.474 0.51  0.005 0.011]
 [0.6   0.3   0.042 0.058]
 [0.549 0.354 0.035 0.062]]
Validation acc: 0.5047709923664122
Validation class_accuracies: [0.6208291203235592, 0.5100830367734283, 0.041666666666666664, 0.0625]
Validation sensitivity: 0.4010840108401084
Validation specificity: 0.6208291203235592
Validation icbhi_score: 0.5109565655818338
Validation roc_auc: None
Validation avg_accuracy: 0.3087697059409135
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
249/249 - 150s - loss: 0.6721 - accuracy: 0.5107 - 150s/epoch - 603ms/step
Epoch 3/110
Validation cm: [[500  99 271 119]
 [503 176  87  77]
 [ 41   8  39  32]
 [ 82   8  35  19]]
Validation val_loss: 0.6616850827344274
Validation normalized_cm: [[0.506 0.1   0.274 0.12 ]
 [0.597 0.209 0.103 0.091]
 [0.342 0.067 0.325 0.267]
 [0.569 0.056 0.243 0.132]]
Validation acc: 0.3501908396946565
Validation class_accuracies: [0.5055611729019212, 0.20877817319098457, 0.325, 0.13194444444444445]
Validation sensitivity: 0.21138211382113822
Validation specificity: 0.5055611729019212
Validation icbhi_score: 0.3584716433615297
Validation roc_auc: None
Validation avg_accuracy: 0.2928209476343375
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 152s - loss: 0.6395 - accuracy: 0.5916 - 152s/epoch - 610ms/step
Epoch 4/110
Validation cm: [[863  21  85  20]
 [754  36  38  15]
 [ 60   4  35  21]
 [107  15  11  11]]
Validation val_loss: 0.5964166705304658
Validation normalized_cm: [[0.873 0.021 0.086 0.02 ]
 [0.894 0.043 0.045 0.018]
 [0.5   0.033 0.292 0.175]
 [0.743 0.104 0.076 0.076]]
Validation acc: 0.4508587786259542
Validation class_accuracies: [0.8725985844287159, 0.042704626334519574, 0.2916666666666667, 0.0763888888888889]
Validation sensitivity: 0.07407407407407407
Validation specificity: 0.8725985844287159
Validation icbhi_score: 0.47333632925139496
Validation roc_auc: None
Validation avg_accuracy: 0.3208396915796977
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 153s - loss: 0.5940 - accuracy: 0.6465 - 153s/epoch - 615ms/step
Epoch 5/110
Validation cm: [[746  97 108  38]
 [571 168  65  39]
 [ 40   8  34  38]
 [ 77  16  41  10]]
Validation val_loss: 0.5953537894569281
Validation normalized_cm: [[0.754 0.098 0.109 0.038]
 [0.677 0.199 0.077 0.046]
 [0.333 0.067 0.283 0.317]
 [0.535 0.111 0.285 0.069]]
Validation acc: 0.4570610687022901
Validation class_accuracies: [0.7542972699696663, 0.199288256227758, 0.2833333333333333, 0.06944444444444445]
Validation sensitivity: 0.1915085817524842
Validation specificity: 0.7542972699696663
Validation icbhi_score: 0.47290292586107524
Validation roc_auc: None
Validation avg_accuracy: 0.3265908259938005
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 152s - loss: 0.5536 - accuracy: 0.6926 - 152s/epoch - 608ms/step
Epoch 6/110
Validation cm: [[892   2  89   6]
 [754   2  84   3]
 [ 41   0  75   4]
 [113   1  29   1]]
Validation val_loss: 0.6017153859707235
Validation normalized_cm: [[0.902 0.002 0.09  0.006]
 [0.894 0.002 0.1   0.004]
 [0.342 0.    0.625 0.033]
 [0.785 0.007 0.201 0.007]]
Validation acc: 0.4627862595419847
Validation class_accuracies: [0.9019211324570273, 0.002372479240806643, 0.625, 0.006944444444444444]
Validation sensitivity: 0.07046070460704607
Validation specificity: 0.9019211324570273
Validation icbhi_score: 0.48619091853203666
Validation roc_auc: None
Validation avg_accuracy: 0.3840595140355696
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 155s - loss: 0.5305 - accuracy: 0.7218 - 155s/epoch - 621ms/step
Epoch 7/110
Validation cm: [[893  18  77   1]
 [774  43  25   1]
 [ 67   4  49   0]
 [108   4  31   1]]
Validation val_loss: 0.5480517338932925
Validation normalized_cm: [[0.903 0.018 0.078 0.001]
 [0.918 0.051 0.03  0.001]
 [0.558 0.033 0.408 0.   ]
 [0.75  0.028 0.215 0.007]]
Validation acc: 0.47041984732824427
Validation class_accuracies: [0.9029322548028311, 0.051008303677342826, 0.4083333333333333, 0.006944444444444444]
Validation sensitivity: 0.08401084010840108
Validation specificity: 0.9029322548028311
Validation icbhi_score: 0.4934715474556161
Validation roc_auc: None
Validation avg_accuracy: 0.3423045840644879
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
249/249 - 150s - loss: 0.5070 - accuracy: 0.7417 - 150s/epoch - 601ms/step
Epoch 8/110
Validation cm: [[433 381  42 133]
 [181 551  21  90]
 [ 18  12  29  61]
 [ 17  48  21  58]]
Validation val_loss: 0.561155017145433
Validation normalized_cm: [[0.438 0.385 0.042 0.134]
 [0.215 0.654 0.025 0.107]
 [0.15  0.1   0.242 0.508]
 [0.118 0.333 0.146 0.403]]
Validation acc: 0.5109732824427481
Validation class_accuracies: [0.4378159757330637, 0.6536180308422301, 0.24166666666666667, 0.4027777777777778]
Validation sensitivity: 0.5763324299909666
Validation specificity: 0.4378159757330637
Validation icbhi_score: 0.5070742028620151
Validation roc_auc: None
Validation avg_accuracy: 0.4339696127549346
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 152s - loss: 0.4841 - accuracy: 0.7654 - 152s/epoch - 610ms/step
Epoch 9/110
Validation cm: [[311 482  34 162]
 [ 91 634  13 105]
 [  8  14  28  70]
 [ 10  57  27  50]]
Validation val_loss: 0.56084440912312
Validation normalized_cm: [[0.314 0.487 0.034 0.164]
 [0.108 0.752 0.015 0.125]
 [0.067 0.117 0.233 0.583]
 [0.069 0.396 0.188 0.347]]
Validation acc: 0.4880725190839695
Validation class_accuracies: [0.31445904954499493, 0.7520759193357058, 0.23333333333333334, 0.3472222222222222]
Validation sensitivity: 0.6431797651309846
Validation specificity: 0.31445904954499493
Validation icbhi_score: 0.4788194073379898
Validation roc_auc: None
Validation avg_accuracy: 0.41177263110906415
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5109565655818338 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 155s - loss: 0.4715 - accuracy: 0.7707 - 155s/epoch - 624ms/step
Epoch 10/110
Validation cm: [[652 223  56  58]
 [317 442  24  60]
 [ 26  10  48  36]
 [ 38  44  41  21]]
Validation val_loss: 0.5161405859394212
Validation normalized_cm: [[0.659 0.225 0.057 0.059]
 [0.376 0.524 0.028 0.071]
 [0.217 0.083 0.4   0.3  ]
 [0.264 0.306 0.285 0.146]]
Validation acc: 0.5548664122137404
Validation class_accuracies: [0.6592517694641051, 0.5243179122182681, 0.4, 0.14583333333333334]
Validation sensitivity: 0.46160794941282746
Validation specificity: 0.6592517694641051
Validation icbhi_score: 0.5604298594384662
Validation roc_auc: None
Validation avg_accuracy: 0.43235075375392656
Validation one_indexed_epoch: 10
-- New best results were achieved. --
There is no such attribute
249/249 - 156s - loss: 0.4654 - accuracy: 0.7609 - 156s/epoch - 627ms/step
Epoch 11/110
Validation cm: [[410 401  41 137]
 [216 501  27  99]
 [ 14  17  21  68]
 [ 21  55  24  44]]
Validation val_loss: 0.5828756152417596
Validation normalized_cm: [[0.415 0.405 0.041 0.139]
 [0.256 0.594 0.032 0.117]
 [0.117 0.142 0.175 0.567]
 [0.146 0.382 0.167 0.306]]
Validation acc: 0.46564885496183206
Validation class_accuracies: [0.41456016177957533, 0.594306049822064, 0.175, 0.3055555555555556]
Validation sensitivity: 0.5112917795844625
Validation specificity: 0.41456016177957533
Validation icbhi_score: 0.4629259706820189
Validation roc_auc: None
Validation avg_accuracy: 0.37235544178929875
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 153s - loss: 0.4476 - accuracy: 0.7702 - 153s/epoch - 615ms/step
Epoch 12/110
Validation cm: [[410 449  51  79]
 [188 574  19  62]
 [ 18  23  29  50]
 [ 18  69  34  23]]
Validation val_loss: 0.5406958359570904
Validation normalized_cm: [[0.415 0.454 0.052 0.08 ]
 [0.223 0.681 0.023 0.074]
 [0.15  0.192 0.242 0.417]
 [0.125 0.479 0.236 0.16 ]]
Validation acc: 0.49427480916030536
Validation class_accuracies: [0.41456016177957533, 0.6809015421115066, 0.24166666666666667, 0.1597222222222222]
Validation sensitivity: 0.5654923215898826
Validation specificity: 0.41456016177957533
Validation icbhi_score: 0.49002624168472897
Validation roc_auc: None
Validation avg_accuracy: 0.37421264819499267
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 150s - loss: 0.4374 - accuracy: 0.7700 - 150s/epoch - 603ms/step
Epoch 13/110
Validation cm: [[380 431  39 139]
 [131 592  25  95]
 [ 22  17  29  52]
 [ 31  48  21  44]]
Validation val_loss: 0.5707732418388526
Validation normalized_cm: [[0.384 0.436 0.039 0.141]
 [0.155 0.702 0.03  0.113]
 [0.183 0.142 0.242 0.433]
 [0.215 0.333 0.146 0.306]]
Validation acc: 0.4985687022900763
Validation class_accuracies: [0.38422649140546006, 0.7022538552787663, 0.24166666666666667, 0.3055555555555556]
Validation sensitivity: 0.6007226738934056
Validation specificity: 0.38422649140546006
Validation icbhi_score: 0.49247458264943283
Validation roc_auc: None
Validation avg_accuracy: 0.40842564222661215
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 151s - loss: 0.4265 - accuracy: 0.7755 - 151s/epoch - 605ms/step
Epoch 14/110
Validation cm: [[187 472  37 293]
 [ 45 511  24 263]
 [  7  18  25  70]
 [  8  37  17  82]]
Validation val_loss: 0.7704153826019464
Validation normalized_cm: [[0.189 0.477 0.037 0.296]
 [0.053 0.606 0.028 0.312]
 [0.058 0.15  0.208 0.583]
 [0.056 0.257 0.118 0.569]]
Validation acc: 0.38406488549618323
Validation class_accuracies: [0.1890798786653185, 0.6061684460260973, 0.20833333333333334, 0.5694444444444444]
Validation sensitivity: 0.5582655826558266
Validation specificity: 0.1890798786653185
Validation icbhi_score: 0.37367273066057255
Validation roc_auc: None
Validation avg_accuracy: 0.3932565256172984
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 176s - loss: 0.4156 - accuracy: 0.7743 - 176s/epoch - 707ms/step
Epoch 15/110
Validation cm: [[671 127  83 108]
 [403 272  77  91]
 [ 20   7  65  28]
 [ 36  24  57  27]]
Validation val_loss: 0.6212712477320336
Validation normalized_cm: [[0.678 0.128 0.084 0.109]
 [0.478 0.323 0.091 0.108]
 [0.167 0.058 0.542 0.233]
 [0.25  0.167 0.396 0.188]]
Validation acc: 0.4937977099236641
Validation class_accuracies: [0.6784630940343782, 0.32265717674970346, 0.5416666666666666, 0.1875]
Validation sensitivity: 0.3288166214995483
Validation specificity: 0.6784630940343782
Validation icbhi_score: 0.5036398577669633
Validation roc_auc: None
Validation avg_accuracy: 0.43257173436268703
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
249/249 - 153s - loss: 0.4037 - accuracy: 0.7811 - 153s/epoch - 615ms/step
Epoch 16/110
Validation cm: [[329 524  38  98]
 [112 664  16  51]
 [ 16  31  37  36]
 [ 10  83  22  29]]
Validation val_loss: 0.5770237218012735
Validation normalized_cm: [[0.333 0.53  0.038 0.099]
 [0.133 0.788 0.019 0.06 ]
 [0.133 0.258 0.308 0.3  ]
 [0.069 0.576 0.153 0.201]]
Validation acc: 0.5052480916030534
Validation class_accuracies: [0.3326592517694641, 0.7876631079478055, 0.30833333333333335, 0.2013888888888889]
Validation sensitivity: 0.6594399277326106
Validation specificity: 0.3326592517694641
Validation icbhi_score: 0.49604958975103736
Validation roc_auc: None
Validation avg_accuracy: 0.40751114548487294
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 156s - loss: 0.3970 - accuracy: 0.7707 - 156s/epoch - 626ms/step
Epoch 17/110
Validation cm: [[365 414  50 160]
 [153 555  25 110]
 [ 12  15  38  55]
 [  8  57  36  43]]
Validation val_loss: 0.6060574623855641
Validation normalized_cm: [[0.369 0.419 0.051 0.162]
 [0.181 0.658 0.03  0.13 ]
 [0.1   0.125 0.317 0.458]
 [0.056 0.396 0.25  0.299]]
Validation acc: 0.4775763358778626
Validation class_accuracies: [0.3690596562184024, 0.6583629893238434, 0.31666666666666665, 0.2986111111111111]
Validation sensitivity: 0.5745257452574526
Validation specificity: 0.3690596562184024
Validation icbhi_score: 0.4717927007379275
Validation roc_auc: None
Validation avg_accuracy: 0.41067510583000594
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 155s - loss: 0.3842 - accuracy: 0.7876 - 155s/epoch - 622ms/step
Epoch 18/110
Validation cm: [[245 534  37 173]
 [ 96 626  17 104]
 [  9  22  26  63]
 [  7  65  17  55]]
Validation val_loss: 0.6291000507363183
Validation normalized_cm: [[0.248 0.54  0.037 0.175]
 [0.114 0.743 0.02  0.123]
 [0.075 0.183 0.217 0.525]
 [0.049 0.451 0.118 0.382]]
Validation acc: 0.4541984732824427
Validation class_accuracies: [0.24772497472194135, 0.7425860023724793, 0.21666666666666667, 0.3819444444444444]
Validation sensitivity: 0.6386630532971996
Validation specificity: 0.24772497472194135
Validation icbhi_score: 0.4431940140095705
Validation roc_auc: None
Validation avg_accuracy: 0.39723052205138293
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 8 epochs
There is no such attribute
249/249 - 158s - loss: 0.3818 - accuracy: 0.7904 - 158s/epoch - 634ms/step
Epoch 19/110
Validation cm: [[538 260  63 128]
 [308 419  35  81]
 [ 18  12  48  42]
 [ 22  48  35  39]]
Validation val_loss: 0.634097664302414
Validation normalized_cm: [[0.544 0.263 0.064 0.129]
 [0.365 0.497 0.042 0.096]
 [0.15  0.1   0.4   0.35 ]
 [0.153 0.333 0.243 0.271]]
Validation acc: 0.49809160305343514
Validation class_accuracies: [0.5439838220424671, 0.4970344009489917, 0.4, 0.2708333333333333]
Validation sensitivity: 0.45709123757904246
Validation specificity: 0.5439838220424671
Validation icbhi_score: 0.5005375298107548
Validation roc_auc: None
Validation avg_accuracy: 0.427962889081198
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 157s - loss: 0.3661 - accuracy: 0.7871 - 157s/epoch - 632ms/step
Epoch 20/110
Validation cm: [[213 636  29 111]
 [ 70 707  11  55]
 [ 12  32  25  51]
 [  5  93   8  38]]
Validation val_loss: 0.57566883622754
Validation normalized_cm: [[0.215 0.643 0.029 0.112]
 [0.083 0.839 0.013 0.065]
 [0.1   0.267 0.208 0.425]
 [0.035 0.646 0.056 0.264]]
Validation acc: 0.4689885496183206
Validation class_accuracies: [0.21536905965621841, 0.8386714116251482, 0.20833333333333334, 0.2638888888888889]
Validation sensitivity: 0.6955736224028907
Validation specificity: 0.21536905965621841
Validation icbhi_score: 0.45547134102955456
Validation roc_auc: None
Validation avg_accuracy: 0.3815656733758972
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
249/249 - 162s - loss: 0.3644 - accuracy: 0.7841 - 162s/epoch - 649ms/step
Epoch 21/110
Validation cm: [[162 566  42 219]
 [ 42 604  23 174]
 [  8  26  26  60]
 [  6  64  17  57]]
Validation val_loss: 0.7786569085682188
Validation normalized_cm: [[0.164 0.572 0.042 0.221]
 [0.05  0.716 0.027 0.206]
 [0.067 0.217 0.217 0.5  ]
 [0.042 0.444 0.118 0.396]]
Validation acc: 0.4050572519083969
Validation class_accuracies: [0.16380182002022245, 0.7164887307236062, 0.21666666666666667, 0.3958333333333333]
Validation sensitivity: 0.6205962059620597
Validation specificity: 0.16380182002022245
Validation icbhi_score: 0.39219901299114107
Validation roc_auc: None
Validation avg_accuracy: 0.37319763768595715
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 11 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 164s - loss: 0.3548 - accuracy: 0.7939 - 164s/epoch - 660ms/step
Epoch 22/110
Validation cm: [[371 440  33 145]
 [140 612  18  73]
 [ 12  19  28  61]
 [ 13  62  15  54]]
Validation val_loss: 0.6303570354543981
Validation normalized_cm: [[0.375 0.445 0.033 0.147]
 [0.166 0.726 0.021 0.087]
 [0.1   0.158 0.233 0.508]
 [0.09  0.431 0.104 0.375]]
Validation acc: 0.5081106870229007
Validation class_accuracies: [0.3751263902932255, 0.7259786476868327, 0.23333333333333334, 0.375]
Validation sensitivity: 0.6269196025293586
Validation specificity: 0.3751263902932255
Validation icbhi_score: 0.501022996411292
Validation roc_auc: None
Validation avg_accuracy: 0.4273595928283479
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 12 epochs
There is no such attribute
249/249 - 170s - loss: 0.3554 - accuracy: 0.7924 - 170s/epoch - 681ms/step
Epoch 23/110
Validation cm: [[593 249  48  99]
 [332 413  28  70]
 [ 26  14  39  41]
 [ 36  42  39  27]]
Validation val_loss: 0.6003961140700467
Validation normalized_cm: [[0.6   0.252 0.049 0.1  ]
 [0.394 0.49  0.033 0.083]
 [0.217 0.117 0.325 0.342]
 [0.25  0.292 0.271 0.188]]
Validation acc: 0.5114503816793893
Validation class_accuracies: [0.5995955510616785, 0.48991696322657174, 0.325, 0.1875]
Validation sensitivity: 0.4327009936766034
Validation specificity: 0.5995955510616785
Validation icbhi_score: 0.516148272369141
Validation roc_auc: None
Validation avg_accuracy: 0.40050312857206255
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 13 epochs
There is no such attribute
249/249 - 174s - loss: 0.3552 - accuracy: 0.7947 - 174s/epoch - 698ms/step
Epoch 24/110
Validation cm: [[610 236  63  80]
 [355 381  42  65]
 [ 23  11  53  33]
 [ 33  43  34  34]]
Validation val_loss: 0.6030644962674305
Validation normalized_cm: [[0.617 0.239 0.064 0.081]
 [0.421 0.452 0.05  0.077]
 [0.192 0.092 0.442 0.275]
 [0.229 0.299 0.236 0.236]]
Validation acc: 0.5143129770992366
Validation class_accuracies: [0.6167846309403437, 0.45195729537366547, 0.44166666666666665, 0.2361111111111111]
Validation sensitivity: 0.42276422764227645
Validation specificity: 0.6167846309403437
Validation icbhi_score: 0.5197744292913101
Validation roc_auc: None
Validation avg_accuracy: 0.43662992602294676
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5604298594384662 hasn't increased by 0 in 14 epochs
There is no such attribute
249/249 - 172s - loss: 0.3473 - accuracy: 0.7914 - 172s/epoch - 689ms/step
Epoch 25/110
Validation cm: [[636 170  90  93]
 [386 369  41  47]
 [ 25  11  56  28]
 [ 27  47  40  30]]
Validation val_loss: 0.5985107091522086
Validation normalized_cm: [[0.643 0.172 0.091 0.094]
 [0.458 0.438 0.049 0.056]
 [0.208 0.092 0.467 0.233]
 [0.188 0.326 0.278 0.208]]
Validation acc: 0.5205152671755725
Validation class_accuracies: [0.6430738119312437, 0.4377224199288256, 0.4666666666666667, 0.20833333333333334]
Validation sensitivity: 0.4110207768744354
Validation specificity: 0.6430738119312437
Validation icbhi_score: 0.5270472944028395
Validation roc_auc: None
Validation avg_accuracy: 0.4389490579650173
Validation one_indexed_epoch: 25
The number of epochs since last 1% equals the patience
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
249/249 - 174s - loss: 0.3485 - accuracy: 0.7901 - 174s/epoch - 699ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5604298594384662
Best cm: [[652 223  56  58]
 [317 442  24  60]
 [ 26  10  48  36]
 [ 38  44  41  21]]
Best val_loss: 0.5161405859394212
Best normalized_cm: [[0.659 0.225 0.057 0.059]
 [0.376 0.524 0.028 0.071]
 [0.217 0.083 0.4   0.3  ]
 [0.264 0.306 0.285 0.146]]
Best acc: 0.5548664122137404
Best class_accuracies: [0.6592517694641051, 0.5243179122182681, 0.4, 0.14583333333333334]
Best sensitivity: 0.46160794941282746
Best specificity: 0.6592517694641051
Best roc_auc: None
Best avg_accuracy: 0.43235075375392656
Best one_indexed_epoch: 10
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6959866285324097, 0.672094464302063, 0.639488160610199, 0.594038188457489, 0.5536105632781982, 0.5305418968200684, 0.5069940686225891, 0.4840724766254425, 0.4715385437011719, 0.46541687846183777, 0.44755202531814575, 0.4374203383922577, 0.42647862434387207, 0.41564491391181946, 0.40370801091194153, 0.3969793915748596, 0.3842467963695526, 0.38175639510154724, 0.36609768867492676, 0.3643723130226135, 0.35479146242141724, 0.3554016351699829, 0.3551636040210724, 0.34729114174842834, 0.3485322594642639], 'accuracy': [0.49634668231010437, 0.5107079744338989, 0.5915848016738892, 0.6465104818344116, 0.6926177740097046, 0.7218443155288696, 0.741748571395874, 0.7654321193695068, 0.7707231044769287, 0.7608969807624817, 0.7702192068099976, 0.769967257976532, 0.7755101919174194, 0.7742504477500916, 0.7810531854629517, 0.7707231044769287, 0.7876039147377014, 0.7903754115104675, 0.7871000170707703, 0.7840765714645386, 0.7939027547836304, 0.7923910021781921, 0.7946586012840271, 0.7913832068443298, 0.790123462677002]}
End
####################################
Job id is 3.
turning the kfold from 90/10 to 80/20
100
12
to
90
22
-----------------------
--- Final training dataset went from 0 to 4342 elements, with 1949 none's, 1225 crakles, 605 wheezes and 563 both ---
--- Final Validation dataset contains 1723 elements, with 929 none, 609 crackles, 112 wheezes and 73 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5569522832221652, 1: 0.8861224489795918, 2: 1.7942148760330578, 3: 1.9280639431616342}
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_1   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_3 (Dense)             (None, 100)               128100    
                                                                 
 dropout_2 (Dropout)         (None, 100)               0         
                                                                 
 dense_4 (Dense)             (None, 50)                5050      
                                                                 
 dropout_3 (Dropout)         (None, 50)                0         
                                                                 
 dense_5 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[149 171 143 466]
 [ 75  83  82 369]
 [  9  22  14  67]
 [ 10  13   7  43]]
Validation val_loss: 0.7074401407690153
Validation normalized_cm: [[0.16  0.184 0.154 0.502]
 [0.123 0.136 0.135 0.606]
 [0.08  0.196 0.125 0.598]
 [0.137 0.178 0.096 0.589]]
Validation acc: 0.1677307022634939
Validation class_accuracies: [0.1603875134553283, 0.13628899835796388, 0.125, 0.589041095890411]
Validation sensitivity: 0.17632241813602015
Validation specificity: 0.1603875134553283
Validation icbhi_score: 0.16835496579567422
Validation roc_auc: None
Validation avg_accuracy: 0.2526794019259258
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
272/272 - 167s - loss: 0.6967 - accuracy: 0.5364 - 167s/epoch - 616ms/step
Epoch 2/110
Validation cm: [[380 150 263 136]
 [291 122 124  72]
 [ 39  28  27  18]
 [ 22  14  23  14]]
Validation val_loss: 0.6795598686052766
Validation normalized_cm: [[0.409 0.161 0.283 0.146]
 [0.478 0.2   0.204 0.118]
 [0.348 0.25  0.241 0.161]
 [0.301 0.192 0.315 0.192]]
Validation acc: 0.3151479976784678
Validation class_accuracies: [0.40904198062432723, 0.20032840722495895, 0.24107142857142858, 0.1917808219178082]
Validation sensitivity: 0.2052896725440806
Validation specificity: 0.40904198062432723
Validation icbhi_score: 0.3071658265842039
Validation roc_auc: None
Validation avg_accuracy: 0.2605556595846308
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
272/272 - 156s - loss: 0.6781 - accuracy: 0.5219 - 156s/epoch - 572ms/step
Epoch 3/110
Validation cm: [[748 168  11   2]
 [386 213   5   5]
 [ 90  11  11   0]
 [ 53   9   7   4]]
Validation val_loss: 0.5563350634317514
Validation normalized_cm: [[0.805 0.181 0.012 0.002]
 [0.634 0.35  0.008 0.008]
 [0.804 0.098 0.098 0.   ]
 [0.726 0.123 0.096 0.055]]
Validation acc: 0.5664538595473012
Validation class_accuracies: [0.8051668460710442, 0.3497536945812808, 0.09821428571428571, 0.0547945205479452]
Validation sensitivity: 0.2871536523929471
Validation specificity: 0.8051668460710442
Validation icbhi_score: 0.5461602492319957
Validation roc_auc: None
Validation avg_accuracy: 0.32698233672863897
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
272/272 - 157s - loss: 0.6478 - accuracy: 0.5758 - 157s/epoch - 576ms/step
Epoch 4/110
Validation cm: [[673 104 139  13]
 [374 151  59  25]
 [ 37   4  68   3]
 [ 40   8  24   1]]
Validation val_loss: 0.5930529703806114
Validation normalized_cm: [[0.724 0.112 0.15  0.014]
 [0.614 0.248 0.097 0.041]
 [0.33  0.036 0.607 0.027]
 [0.548 0.11  0.329 0.014]]
Validation acc: 0.518282066163668
Validation class_accuracies: [0.7244348762109796, 0.24794745484400657, 0.6071428571428571, 0.0136986301369863]
Validation sensitivity: 0.2770780856423174
Validation specificity: 0.7244348762109796
Validation icbhi_score: 0.5007564809266485
Validation roc_auc: None
Validation avg_accuracy: 0.39830595458370743
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5461602492319957 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 159s - loss: 0.5889 - accuracy: 0.6294 - 159s/epoch - 583ms/step
Epoch 5/110
Validation cm: [[899   0  30   0]
 [599   0  10   0]
 [ 81   0  31   0]
 [ 61   0  12   0]]
Validation val_loss: 0.5358930849883698
Validation normalized_cm: [[0.968 0.    0.032 0.   ]
 [0.984 0.    0.016 0.   ]
 [0.723 0.    0.277 0.   ]
 [0.836 0.    0.164 0.   ]]
Validation acc: 0.5397562391178178
Validation class_accuracies: [0.9677072120559742, 0.0, 0.2767857142857143, 0.0]
Validation sensitivity: 0.03904282115869018
Validation specificity: 0.9677072120559742
Validation icbhi_score: 0.5033750166073322
Validation roc_auc: None
Validation avg_accuracy: 0.3111232315854221
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5461602492319957 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 142s - loss: 0.5444 - accuracy: 0.6838 - 142s/epoch - 521ms/step
Epoch 6/110
Validation cm: [[831  22  61  15]
 [504  48  36  21]
 [ 31   1  60  20]
 [ 43   4  22   4]]
Validation val_loss: 0.5084813807723969
Validation normalized_cm: [[0.895 0.024 0.066 0.016]
 [0.828 0.079 0.059 0.034]
 [0.277 0.009 0.536 0.179]
 [0.589 0.055 0.301 0.055]]
Validation acc: 0.547301218804411
Validation class_accuracies: [0.8945102260495156, 0.07881773399014778, 0.5357142857142857, 0.0547945205479452]
Validation sensitivity: 0.14105793450881612
Validation specificity: 0.8945102260495156
Validation icbhi_score: 0.5177840802791659
Validation roc_auc: None
Validation avg_accuracy: 0.3909591915754736
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5461602492319957 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 140s - loss: 0.5172 - accuracy: 0.7273 - 140s/epoch - 514ms/step
Epoch 7/110
Validation cm: [[909  17   3   0]
 [599  10   0   0]
 [ 97   4   9   2]
 [ 61   5   3   4]]
Validation val_loss: 0.5594977839821241
Validation normalized_cm: [[0.978 0.018 0.003 0.   ]
 [0.984 0.016 0.    0.   ]
 [0.866 0.036 0.08  0.018]
 [0.836 0.068 0.041 0.055]]
Validation acc: 0.5409170052234474
Validation class_accuracies: [0.9784714747039828, 0.016420361247947456, 0.08035714285714286, 0.0547945205479452]
Validation sensitivity: 0.028967254408060455
Validation specificity: 0.9784714747039828
Validation icbhi_score: 0.5037193645560216
Validation roc_auc: None
Validation avg_accuracy: 0.2825108748392546
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5461602492319957 hasn't increased by 0 in 4 epochs
There is no such attribute
272/272 - 141s - loss: 0.5031 - accuracy: 0.7395 - 141s/epoch - 520ms/step
Epoch 8/110
Validation cm: [[722 141  50  16]
 [362 213  22  12]
 [ 41  12  54   5]
 [ 45   7  15   6]]
Validation val_loss: 0.479609272837881
Validation normalized_cm: [[0.777 0.152 0.054 0.017]
 [0.594 0.35  0.036 0.02 ]
 [0.366 0.107 0.482 0.045]
 [0.616 0.096 0.205 0.082]]
Validation acc: 0.5774811375507836
Validation class_accuracies: [0.7771797631862217, 0.3497536945812808, 0.48214285714285715, 0.0821917808219178]
Validation sensitivity: 0.3438287153652393
Validation specificity: 0.7771797631862217
Validation icbhi_score: 0.5605042392757305
Validation roc_auc: None
Validation avg_accuracy: 0.4228170239330694
Validation one_indexed_epoch: 8
-- New best results were achieved. --
There is no such attribute
272/272 - 141s - loss: 0.4803 - accuracy: 0.7600 - 141s/epoch - 518ms/step
Epoch 9/110
Validation cm: [[753  72  89  15]
 [400 115  54  40]
 [ 36   3  69   4]
 [ 40   3  27   3]]
Validation val_loss: 0.5442135240223196
Validation normalized_cm: [[0.811 0.078 0.096 0.016]
 [0.657 0.189 0.089 0.066]
 [0.321 0.027 0.616 0.036]
 [0.548 0.041 0.37  0.041]]
Validation acc: 0.5455600696459664
Validation class_accuracies: [0.8105489773950484, 0.18883415435139572, 0.6160714285714286, 0.0410958904109589]
Validation sensitivity: 0.23551637279596976
Validation specificity: 0.8105489773950484
Validation icbhi_score: 0.5230326750955091
Validation roc_auc: None
Validation avg_accuracy: 0.4141376126822079
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5605042392757305 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 142s - loss: 0.4569 - accuracy: 0.7556 - 142s/epoch - 521ms/step
Epoch 10/110
Validation cm: [[574 254  54  47]
 [205 344  17  43]
 [ 28   8  50  26]
 [ 25  17  22   9]]
Validation val_loss: 0.5027535176504613
Validation normalized_cm: [[0.618 0.273 0.058 0.051]
 [0.337 0.565 0.028 0.071]
 [0.25  0.071 0.446 0.232]
 [0.342 0.233 0.301 0.123]]
Validation acc: 0.567034242600116
Validation class_accuracies: [0.6178686759956943, 0.5648604269293924, 0.44642857142857145, 0.1232876712328767]
Validation sensitivity: 0.5075566750629723
Validation specificity: 0.6178686759956943
Validation icbhi_score: 0.5627126755293332
Validation roc_auc: None
Validation avg_accuracy: 0.43811133639663374
Validation one_indexed_epoch: 10
-- New best results were achieved. --
There is no such attribute
272/272 - 142s - loss: 0.4268 - accuracy: 0.7780 - 142s/epoch - 522ms/step
Epoch 11/110
Validation cm: [[854   5  69   1]
 [561  13  34   1]
 [ 62   0  49   1]
 [ 51   0  22   0]]
Validation val_loss: 0.5237203619539634
Validation normalized_cm: [[0.919 0.005 0.074 0.001]
 [0.921 0.021 0.056 0.002]
 [0.554 0.    0.438 0.009]
 [0.699 0.    0.301 0.   ]]
Validation acc: 0.5316308763784098
Validation class_accuracies: [0.9192680301399354, 0.021346469622331693, 0.4375, 0.0]
Validation sensitivity: 0.07808564231738035
Validation specificity: 0.9192680301399354
Validation icbhi_score: 0.4986768362286579
Validation roc_auc: None
Validation avg_accuracy: 0.3445286249405668
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
272/272 - 141s - loss: 0.4186 - accuracy: 0.7796 - 141s/epoch - 520ms/step
Epoch 12/110
Validation cm: [[664 171  67  27]
 [311 240  21  37]
 [ 34   8  54  16]
 [ 42  10  19   2]]
Validation val_loss: 0.5378010249521001
Validation normalized_cm: [[0.715 0.184 0.072 0.029]
 [0.511 0.394 0.034 0.061]
 [0.304 0.071 0.482 0.143]
 [0.575 0.137 0.26  0.027]]
Validation acc: 0.5571677307022634
Validation class_accuracies: [0.7147470398277718, 0.39408866995073893, 0.48214285714285715, 0.0273972602739726]
Validation sensitivity: 0.37279596977329976
Validation specificity: 0.7147470398277718
Validation icbhi_score: 0.5437715048005358
Validation roc_auc: None
Validation avg_accuracy: 0.40459395679883514
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 143s - loss: 0.3948 - accuracy: 0.7828 - 143s/epoch - 527ms/step
Epoch 13/110
Validation cm: [[298 498  26 107]
 [ 73 427  14  95]
 [ 16  17  23  56]
 [ 10  29  14  20]]
Validation val_loss: 0.6538491128547657
Validation normalized_cm: [[0.321 0.536 0.028 0.115]
 [0.12  0.701 0.023 0.156]
 [0.143 0.152 0.205 0.5  ]
 [0.137 0.397 0.192 0.274]]
Validation acc: 0.4457341845618108
Validation class_accuracies: [0.3207750269106566, 0.7011494252873564, 0.20535714285714285, 0.273972602739726]
Validation sensitivity: 0.5919395465994962
Validation specificity: 0.3207750269106566
Validation icbhi_score: 0.4563572867550764
Validation roc_auc: None
Validation avg_accuracy: 0.3753135494487205
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 144s - loss: 0.3748 - accuracy: 0.7934 - 144s/epoch - 528ms/step
Epoch 14/110
Validation cm: [[725 145  42  17]
 [364 207  15  23]
 [ 44   7  31  30]
 [ 41   8  20   4]]
Validation val_loss: 0.49324651820194876
Validation normalized_cm: [[0.78  0.156 0.045 0.018]
 [0.598 0.34  0.025 0.038]
 [0.393 0.062 0.277 0.268]
 [0.562 0.11  0.274 0.055]]
Validation acc: 0.5612304120719674
Validation class_accuracies: [0.7804090419806243, 0.3399014778325123, 0.2767857142857143, 0.0547945205479452]
Validation sensitivity: 0.3047858942065491
Validation specificity: 0.7804090419806243
Validation icbhi_score: 0.5425974680935868
Validation roc_auc: None
Validation avg_accuracy: 0.362972688661699
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 4 epochs
There is no such attribute
272/272 - 143s - loss: 0.3549 - accuracy: 0.7847 - 143s/epoch - 526ms/step
Epoch 15/110
Validation cm: [[345 522  23  39]
 [105 471   9  24]
 [ 37  28  31  16]
 [ 22  33  10   8]]
Validation val_loss: 0.54383131442024
Validation normalized_cm: [[0.371 0.562 0.025 0.042]
 [0.172 0.773 0.015 0.039]
 [0.33  0.25  0.277 0.143]
 [0.301 0.452 0.137 0.11 ]]
Validation acc: 0.4962275101567034
Validation class_accuracies: [0.3713670613562971, 0.7733990147783252, 0.2767857142857143, 0.1095890410958904]
Validation sensitivity: 0.6423173803526449
Validation specificity: 0.3713670613562971
Validation icbhi_score: 0.506842220854471
Validation roc_auc: None
Validation avg_accuracy: 0.3827852078790568
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
272/272 - 140s - loss: 0.3235 - accuracy: 0.7966 - 140s/epoch - 514ms/step
Epoch 16/110
Validation cm: [[614 248  47  20]
 [242 317  14  36]
 [ 46   9  39  18]
 [ 30  23  17   3]]
Validation val_loss: 0.5271844695875172
Validation normalized_cm: [[0.661 0.267 0.051 0.022]
 [0.397 0.521 0.023 0.059]
 [0.411 0.08  0.348 0.161]
 [0.411 0.315 0.233 0.041]]
Validation acc: 0.5647127103888566
Validation class_accuracies: [0.6609257265877287, 0.5205254515599343, 0.3482142857142857, 0.0410958904109589]
Validation sensitivity: 0.4521410579345088
Validation specificity: 0.6609257265877287
Validation icbhi_score: 0.5565333922611188
Validation roc_auc: None
Validation avg_accuracy: 0.39269033856822694
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 6 epochs
There is no such attribute
272/272 - 143s - loss: 0.3025 - accuracy: 0.8017 - 143s/epoch - 524ms/step
Epoch 17/110
Validation cm: [[522 321  45  41]
 [186 372  19  32]
 [ 30   9  47  26]
 [ 17  32  14  10]]
Validation val_loss: 0.5372521874310532
Validation normalized_cm: [[0.562 0.346 0.048 0.044]
 [0.305 0.611 0.031 0.053]
 [0.268 0.08  0.42  0.232]
 [0.233 0.438 0.192 0.137]]
Validation acc: 0.5519442832269298
Validation class_accuracies: [0.5618945102260495, 0.6108374384236454, 0.41964285714285715, 0.136986301369863]
Validation sensitivity: 0.5403022670025189
Validation specificity: 0.5618945102260495
Validation icbhi_score: 0.5510983886142842
Validation roc_auc: None
Validation avg_accuracy: 0.43234027679060383
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 7 epochs
There is no such attribute
272/272 - 144s - loss: 0.2827 - accuracy: 0.8029 - 144s/epoch - 530ms/step
Epoch 18/110
Validation cm: [[580 233  35  81]
 [201 313  15  80]
 [ 24   6  43  39]
 [ 20  28  12  13]]
Validation val_loss: 0.5626227380248414
Validation normalized_cm: [[0.624 0.251 0.038 0.087]
 [0.33  0.514 0.025 0.131]
 [0.214 0.054 0.384 0.348]
 [0.274 0.384 0.164 0.178]]
Validation acc: 0.5507835171213
Validation class_accuracies: [0.6243272335844995, 0.5139573070607554, 0.38392857142857145, 0.1780821917808219]
Validation sensitivity: 0.464735516372796
Validation specificity: 0.6243272335844995
Validation icbhi_score: 0.5445313749786478
Validation roc_auc: None
Validation avg_accuracy: 0.42507382596366206
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 8 epochs
There is no such attribute
272/272 - 142s - loss: 0.2771 - accuracy: 0.8006 - 142s/epoch - 523ms/step
Epoch 19/110
Validation cm: [[539 257 124   9]
 [237 290  69  13]
 [ 30   8  65   9]
 [ 24  17  31   1]]
Validation val_loss: 0.6099834173773991
Validation normalized_cm: [[0.58  0.277 0.133 0.01 ]
 [0.389 0.476 0.113 0.021]
 [0.268 0.071 0.58  0.08 ]
 [0.329 0.233 0.425 0.014]]
Validation acc: 0.5194428322692978
Validation class_accuracies: [0.5801937567276642, 0.47619047619047616, 0.5803571428571429, 0.0136986301369863]
Validation sensitivity: 0.44836272040302266
Validation specificity: 0.5801937567276642
Validation icbhi_score: 0.5142782385653434
Validation roc_auc: None
Validation avg_accuracy: 0.41261000147806737
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 9 epochs
There is no such attribute
272/272 - 143s - loss: 0.2750 - accuracy: 0.7930 - 143s/epoch - 526ms/step
Epoch 20/110
Validation cm: [[835   8  78   8]
 [497  40  57  15]
 [ 38   0  60  14]
 [ 43   2  27   1]]
Validation val_loss: 0.6584098602963198
Validation normalized_cm: [[0.899 0.009 0.084 0.009]
 [0.816 0.066 0.094 0.025]
 [0.339 0.    0.536 0.125]
 [0.589 0.027 0.37  0.014]]
Validation acc: 0.543238537434707
Validation class_accuracies: [0.898815931108719, 0.06568144499178982, 0.5357142857142857, 0.0136986301369863]
Validation sensitivity: 0.12720403022670027
Validation specificity: 0.898815931108719
Validation icbhi_score: 0.5130099806677096
Validation roc_auc: None
Validation avg_accuracy: 0.37847757298794527
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
272/272 - 142s - loss: 0.2531 - accuracy: 0.8047 - 142s/epoch - 522ms/step
Epoch 21/110
Validation cm: [[427 289  65 148]
 [126 330  23 130]
 [ 10   5  47  50]
 [  8  22  25  18]]
Validation val_loss: 0.7683037802070548
Validation normalized_cm: [[0.46  0.311 0.07  0.159]
 [0.207 0.542 0.038 0.213]
 [0.089 0.045 0.42  0.446]
 [0.11  0.301 0.342 0.247]]
Validation acc: 0.4770748694138131
Validation class_accuracies: [0.4596340150699677, 0.541871921182266, 0.41964285714285715, 0.2465753424657534]
Validation sensitivity: 0.49748110831234255
Validation specificity: 0.4596340150699677
Validation icbhi_score: 0.47855756169115515
Validation roc_auc: None
Validation avg_accuracy: 0.41693103396521114
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 11 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
272/272 - 142s - loss: 0.2367 - accuracy: 0.8024 - 142s/epoch - 520ms/step
Epoch 22/110
Validation cm: [[303 507  35  84]
 [ 77 444  14  74]
 [ 19  16  34  43]
 [ 10  33  10  20]]
Validation val_loss: 0.6740012978159272
Validation normalized_cm: [[0.326 0.546 0.038 0.09 ]
 [0.126 0.729 0.023 0.122]
 [0.17  0.143 0.304 0.384]
 [0.137 0.452 0.137 0.274]]
Validation acc: 0.4648868253047011
Validation class_accuracies: [0.3261571582346609, 0.729064039408867, 0.30357142857142855, 0.273972602739726]
Validation sensitivity: 0.6272040302267002
Validation specificity: 0.3261571582346609
Validation icbhi_score: 0.47668059423068054
Validation roc_auc: None
Validation avg_accuracy: 0.40819130723867064
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5627126755293332 hasn't increased by 0 in 12 epochs
There is no such attribute
272/272 - 143s - loss: 0.2384 - accuracy: 0.8022 - 143s/epoch - 526ms/step
Epoch 23/110
Validation cm: [[686 130  63  50]
 [246 256  32  75]
 [ 24   5  58  25]
 [ 22  21  25   5]]
Validation val_loss: 0.5939037557053518
Validation normalized_cm: [[0.738 0.14  0.068 0.054]
 [0.404 0.42  0.053 0.123]
 [0.214 0.045 0.518 0.223]
 [0.301 0.288 0.342 0.068]]
Validation acc: 0.583284968078932
Validation class_accuracies: [0.7384284176533907, 0.42036124794745483, 0.5178571428571429, 0.0684931506849315]
Validation sensitivity: 0.4017632241813602
Validation specificity: 0.7384284176533907
Validation icbhi_score: 0.5700958209173754
Validation roc_auc: None
Validation avg_accuracy: 0.43628498978573
Validation one_indexed_epoch: 23
-- New best results were achieved. --
There is no such attribute
272/272 - 143s - loss: 0.2241 - accuracy: 0.8148 - 143s/epoch - 524ms/step
Epoch 24/110
Validation cm: [[583 238  48  60]
 [192 340  12  65]
 [ 22   7  45  38]
 [ 18  25  19  11]]
Validation val_loss: 0.6266335118240034
Validation normalized_cm: [[0.628 0.256 0.052 0.065]
 [0.315 0.558 0.02  0.107]
 [0.196 0.062 0.402 0.339]
 [0.247 0.342 0.26  0.151]]
Validation acc: 0.5681950087057458
Validation class_accuracies: [0.6275565123789021, 0.5582922824302134, 0.4017857142857143, 0.1506849315068493]
Validation sensitivity: 0.4987405541561713
Validation specificity: 0.6275565123789021
Validation icbhi_score: 0.5631485332675367
Validation roc_auc: None
Validation avg_accuracy: 0.43457986015041977
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 142s - loss: 0.2201 - accuracy: 0.8197 - 142s/epoch - 524ms/step
Epoch 25/110
Validation cm: [[628 185  71  45]
 [234 295  32  48]
 [ 30   5  41  36]
 [ 20  20  24   9]]
Validation val_loss: 0.5853242401729024
Validation normalized_cm: [[0.676 0.199 0.076 0.048]
 [0.384 0.484 0.053 0.079]
 [0.268 0.045 0.366 0.321]
 [0.274 0.274 0.329 0.123]]
Validation acc: 0.5647127103888566
Validation class_accuracies: [0.6759956942949408, 0.48440065681444994, 0.36607142857142855, 0.1232876712328767]
Validation sensitivity: 0.4345088161209068
Validation specificity: 0.6759956942949408
Validation icbhi_score: 0.5552522552079238
Validation roc_auc: None
Validation avg_accuracy: 0.412438862728424
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 143s - loss: 0.2230 - accuracy: 0.8088 - 143s/epoch - 525ms/step
Epoch 26/110
Validation cm: [[299 414  48 168]
 [ 84 375  11 139]
 [ 15   9  35  53]
 [  9  28  16  20]]
Validation val_loss: 0.8898990039617197
Validation normalized_cm: [[0.322 0.446 0.052 0.181]
 [0.138 0.616 0.018 0.228]
 [0.134 0.08  0.312 0.473]
 [0.123 0.384 0.219 0.274]]
Validation acc: 0.4230992455020313
Validation class_accuracies: [0.3218514531754575, 0.6157635467980296, 0.3125, 0.273972602739726]
Validation sensitivity: 0.5415617128463476
Validation specificity: 0.3218514531754575
Validation icbhi_score: 0.43170658301090253
Validation roc_auc: None
Validation avg_accuracy: 0.38102190067830327
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 143s - loss: 0.2116 - accuracy: 0.8098 - 143s/epoch - 526ms/step
Epoch 27/110
Validation cm: [[730  77  87  35]
 [326 199  43  41]
 [ 23   2  68  19]
 [ 20  17  32   4]]
Validation val_loss: 0.6080607266023563
Validation normalized_cm: [[0.786 0.083 0.094 0.038]
 [0.535 0.327 0.071 0.067]
 [0.205 0.018 0.607 0.17 ]
 [0.274 0.233 0.438 0.055]]
Validation acc: 0.5809634358676726
Validation class_accuracies: [0.7857911733046287, 0.32676518883415434, 0.6071428571428571, 0.0547945205479452]
Validation sensitivity: 0.3413098236775819
Validation specificity: 0.7857911733046287
Validation icbhi_score: 0.5635504984911053
Validation roc_auc: None
Validation avg_accuracy: 0.44362343495739637
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 4 epochs
There is no such attribute
272/272 - 143s - loss: 0.2034 - accuracy: 0.8125 - 143s/epoch - 527ms/step
Epoch 28/110
Validation cm: [[854  25  39  11]
 [484  87  28  10]
 [ 48   3  42  19]
 [ 49   5  18   1]]
Validation val_loss: 0.710191402730999
Validation normalized_cm: [[0.919 0.027 0.042 0.012]
 [0.795 0.143 0.046 0.016]
 [0.429 0.027 0.375 0.17 ]
 [0.671 0.068 0.247 0.014]]
Validation acc: 0.57109692396982
Validation class_accuracies: [0.9192680301399354, 0.14285714285714285, 0.375, 0.0136986301369863]
Validation sensitivity: 0.163727959697733
Validation specificity: 0.9192680301399354
Validation icbhi_score: 0.5414979949188342
Validation roc_auc: None
Validation avg_accuracy: 0.36270595078351614
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
272/272 - 142s - loss: 0.1995 - accuracy: 0.8121 - 142s/epoch - 522ms/step
Epoch 29/110
Validation cm: [[378 415  39  97]
 [106 402  11  90]
 [ 17  12  38  45]
 [  7  36  15  15]]
Validation val_loss: 0.7703028636993581
Validation normalized_cm: [[0.407 0.447 0.042 0.104]
 [0.174 0.66  0.018 0.148]
 [0.152 0.107 0.339 0.402]
 [0.096 0.493 0.205 0.205]]
Validation acc: 0.4834590829947766
Validation class_accuracies: [0.4068891280947255, 0.6600985221674877, 0.3392857142857143, 0.2054794520547945]
Validation sensitivity: 0.5730478589420654
Validation specificity: 0.4068891280947255
Validation icbhi_score: 0.48996849351839544
Validation roc_auc: None
Validation avg_accuracy: 0.4029382041506805
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 6 epochs
There is no such attribute
272/272 - 144s - loss: 0.1966 - accuracy: 0.8148 - 144s/epoch - 529ms/step
Epoch 30/110
Validation cm: [[854   7  64   4]
 [521  33  45  10]
 [ 40   0  60  12]
 [ 45   3  23   2]]
Validation val_loss: 0.7494409529798365
Validation normalized_cm: [[0.919 0.008 0.069 0.004]
 [0.856 0.054 0.074 0.016]
 [0.357 0.    0.536 0.107]
 [0.616 0.041 0.315 0.027]]
Validation acc: 0.5507835171213
Validation class_accuracies: [0.9192680301399354, 0.054187192118226604, 0.5357142857142857, 0.0273972602739726]
Validation sensitivity: 0.11964735516372796
Validation specificity: 0.9192680301399354
Validation icbhi_score: 0.5194576926518317
Validation roc_auc: None
Validation avg_accuracy: 0.3841416920616051
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 7 epochs
There is no such attribute
272/272 - 144s - loss: 0.1849 - accuracy: 0.8100 - 144s/epoch - 529ms/step
Epoch 31/110
Validation cm: [[489 365  44  31]
 [178 384   9  38]
 [ 30  19  40  23]
 [ 27  26  13   7]]
Validation val_loss: 0.6336439158629629
Validation normalized_cm: [[0.526 0.393 0.047 0.033]
 [0.292 0.631 0.015 0.062]
 [0.268 0.17  0.357 0.205]
 [0.37  0.356 0.178 0.096]]
Validation acc: 0.5339524085896692
Validation class_accuracies: [0.5263724434876211, 0.6305418719211823, 0.35714285714285715, 0.0958904109589041]
Validation sensitivity: 0.5428211586901763
Validation specificity: 0.5263724434876211
Validation icbhi_score: 0.5345968010888987
Validation roc_auc: None
Validation avg_accuracy: 0.4024868958776412
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 8 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
272/272 - 143s - loss: 0.1788 - accuracy: 0.8082 - 143s/epoch - 524ms/step
Epoch 32/110
Validation cm: [[792  63  57  17]
 [412 149  34  14]
 [ 36   5  52  19]
 [ 38   9  21   5]]
Validation val_loss: 0.6528943072491299
Validation normalized_cm: [[0.853 0.068 0.061 0.018]
 [0.677 0.245 0.056 0.023]
 [0.321 0.045 0.464 0.17 ]
 [0.521 0.123 0.288 0.068]]
Validation acc: 0.579222286709228
Validation class_accuracies: [0.852529601722282, 0.24466338259441708, 0.4642857142857143, 0.0684931506849315]
Validation sensitivity: 0.2594458438287154
Validation specificity: 0.852529601722282
Validation icbhi_score: 0.5559877227754987
Validation roc_auc: None
Validation avg_accuracy: 0.40749296232183624
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 9 epochs
There is no such attribute
272/272 - 143s - loss: 0.1812 - accuracy: 0.8155 - 143s/epoch - 526ms/step
Epoch 33/110
Validation cm: [[314 510  30  75]
 [ 75 467   8  59]
 [ 19  23  31  39]
 [ 10  37   8  18]]
Validation val_loss: 0.7463527679150733
Validation normalized_cm: [[0.338 0.549 0.032 0.081]
 [0.123 0.767 0.013 0.097]
 [0.17  0.205 0.277 0.348]
 [0.137 0.507 0.11  0.247]]
Validation acc: 0.481717933836332
Validation class_accuracies: [0.3379978471474704, 0.7668308702791461, 0.2767857142857143, 0.2465753424657534]
Validation sensitivity: 0.6498740554156172
Validation specificity: 0.3379978471474704
Validation icbhi_score: 0.4939359512815438
Validation roc_auc: None
Validation avg_accuracy: 0.40704744354452105
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
272/272 - 144s - loss: 0.1905 - accuracy: 0.8174 - 144s/epoch - 528ms/step
Epoch 34/110
Validation cm: [[397 433  37  62]
 [114 430   8  57]
 [ 18  21  37  36]
 [ 15  32   9  17]]
Validation val_loss: 0.6932233458192175
Validation normalized_cm: [[0.427 0.466 0.04  0.067]
 [0.187 0.706 0.013 0.094]
 [0.161 0.188 0.33  0.321]
 [0.205 0.438 0.123 0.233]]
Validation acc: 0.5113174695298898
Validation class_accuracies: [0.42734122712594186, 0.7060755336617406, 0.33035714285714285, 0.2328767123287671]
Validation sensitivity: 0.6095717884130982
Validation specificity: 0.42734122712594186
Validation icbhi_score: 0.51845650776952
Validation roc_auc: None
Validation avg_accuracy: 0.4241626539933981
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5700958209173754 hasn't increased by 0 in 11 epochs
There is no such attribute
272/272 - 142s - loss: 0.1827 - accuracy: 0.8100 - 142s/epoch - 523ms/step
Epoch 35/110
Validation cm: [[699 136  66  28]
 [277 265  29  38]
 [ 36   4  53  19]
 [ 28  17  19   9]]
Validation val_loss: 0.5910121381883598
Validation normalized_cm: [[0.752 0.146 0.071 0.03 ]
 [0.455 0.435 0.048 0.062]
 [0.321 0.036 0.473 0.17 ]
 [0.384 0.233 0.26  0.123]]
Validation acc: 0.5954730121880442
Validation class_accuracies: [0.7524219590958019, 0.4351395730706076, 0.4732142857142857, 0.1232876712328767]
Validation sensitivity: 0.41183879093198994
Validation specificity: 0.7524219590958019
Validation icbhi_score: 0.582130375013896
Validation roc_auc: None
Validation avg_accuracy: 0.446015872278393
Validation one_indexed_epoch: 35
-- New best results were achieved. --
There is no such attribute
272/272 - 144s - loss: 0.1819 - accuracy: 0.8194 - 144s/epoch - 528ms/step
Epoch 36/110
Validation cm: [[438 358  41  92]
 [131 380  15  83]
 [ 18   9  42  43]
 [  9  35  14  15]]
Validation val_loss: 0.765421134169578
Validation normalized_cm: [[0.471 0.385 0.044 0.099]
 [0.215 0.624 0.025 0.136]
 [0.161 0.08  0.375 0.384]
 [0.123 0.479 0.192 0.205]]
Validation acc: 0.5078351712130006
Validation class_accuracies: [0.4714747039827772, 0.6239737274220033, 0.375, 0.2054794520547945]
Validation sensitivity: 0.5503778337531486
Validation specificity: 0.4714747039827772
Validation icbhi_score: 0.5109262688679629
Validation roc_auc: None
Validation avg_accuracy: 0.41898197086489375
Validation one_indexed_epoch: 36
The validation tracker metric at 0.582130375013896 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 142s - loss: 0.1771 - accuracy: 0.8135 - 142s/epoch - 524ms/step
Epoch 37/110
Validation cm: [[529 285  53  62]
 [166 363  16  64]
 [ 20  11  44  37]
 [ 15  29  18  11]]
Validation val_loss: 0.6832273047099439
Validation normalized_cm: [[0.569 0.307 0.057 0.067]
 [0.273 0.596 0.026 0.105]
 [0.179 0.098 0.393 0.33 ]
 [0.205 0.397 0.247 0.151]]
Validation acc: 0.5496227510156704
Validation class_accuracies: [0.5694294940796556, 0.5960591133004927, 0.39285714285714285, 0.1506849315068493]
Validation sensitivity: 0.5264483627204031
Validation specificity: 0.5694294940796556
Validation icbhi_score: 0.5479389284000293
Validation roc_auc: None
Validation avg_accuracy: 0.4272576704360351
Validation one_indexed_epoch: 37
The validation tracker metric at 0.582130375013896 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 139s - loss: 0.1807 - accuracy: 0.8075 - 139s/epoch - 513ms/step
Epoch 38/110
Validation cm: [[460 345  44  80]
 [134 383  16  76]
 [ 19   9  38  46]
 [  9  33  13  18]]
Validation val_loss: 0.7402799990264555
Validation normalized_cm: [[0.495 0.371 0.047 0.086]
 [0.22  0.629 0.026 0.125]
 [0.17  0.08  0.339 0.411]
 [0.123 0.452 0.178 0.247]]
Validation acc: 0.5217643644805572
Validation class_accuracies: [0.4951560818083961, 0.6288998357963875, 0.3392857142857143, 0.2465753424657534]
Validation sensitivity: 0.552896725440806
Validation specificity: 0.4951560818083961
Validation icbhi_score: 0.5240264036246011
Validation roc_auc: None
Validation avg_accuracy: 0.42747924358906286
Validation one_indexed_epoch: 38
The validation tracker metric at 0.582130375013896 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 143s - loss: 0.1800 - accuracy: 0.8114 - 143s/epoch - 525ms/step
Epoch 39/110
Validation cm: [[671 150  67  41]
 [244 290  26  49]
 [ 31   6  52  23]
 [ 20  21  23   9]]
Validation val_loss: 0.5973767587895199
Validation normalized_cm: [[0.722 0.161 0.072 0.044]
 [0.401 0.476 0.043 0.08 ]
 [0.277 0.054 0.464 0.205]
 [0.274 0.288 0.315 0.123]]
Validation acc: 0.5931514799767846
Validation class_accuracies: [0.7222820236813778, 0.47619047619047616, 0.4642857142857143, 0.1232876712328767]
Validation sensitivity: 0.4420654911838791
Validation specificity: 0.7222820236813778
Validation icbhi_score: 0.5821737574326284
Validation roc_auc: None
Validation avg_accuracy: 0.44651147134761127
Validation one_indexed_epoch: 39
-- New best results were achieved. --
There is no such attribute
272/272 - 145s - loss: 0.1838 - accuracy: 0.8185 - 145s/epoch - 532ms/step
Epoch 40/110
Validation cm: [[445 379  39  66]
 [130 409  10  60]
 [ 18  15  39  40]
 [ 16  28  14  15]]
Validation val_loss: 0.6977409934543275
Validation normalized_cm: [[0.479 0.408 0.042 0.071]
 [0.213 0.672 0.016 0.099]
 [0.161 0.134 0.348 0.357]
 [0.219 0.384 0.192 0.205]]
Validation acc: 0.5269878119558908
Validation class_accuracies: [0.4790096878363832, 0.6715927750410509, 0.3482142857142857, 0.2054794520547945]
Validation sensitivity: 0.5831234256926953
Validation specificity: 0.4790096878363832
Validation icbhi_score: 0.5310665567645392
Validation roc_auc: None
Validation avg_accuracy: 0.4260740501616286
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 144s - loss: 0.1774 - accuracy: 0.8160 - 144s/epoch - 529ms/step
Epoch 41/110
Validation cm: [[393 418  30  88]
 [112 412   9  76]
 [ 14  15  39  44]
 [  9  34  11  19]]
Validation val_loss: 0.7655965285014577
Validation normalized_cm: [[0.423 0.45  0.032 0.095]
 [0.184 0.677 0.015 0.125]
 [0.125 0.134 0.348 0.393]
 [0.123 0.466 0.151 0.26 ]]
Validation acc: 0.5008705745792222
Validation class_accuracies: [0.42303552206673845, 0.6765188834154351, 0.3482142857142857, 0.2602739726027397]
Validation sensitivity: 0.5919395465994962
Validation specificity: 0.42303552206673845
Validation icbhi_score: 0.5074875343331173
Validation roc_auc: None
Validation avg_accuracy: 0.4270106659497997
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 143s - loss: 0.1754 - accuracy: 0.8109 - 143s/epoch - 526ms/step
Epoch 42/110
Validation cm: [[412 436  32  49]
 [125 426  10  48]
 [ 27  20  34  31]
 [ 18  31  11  13]]
Validation val_loss: 0.6785957155338674
Validation normalized_cm: [[0.443 0.469 0.034 0.053]
 [0.205 0.7   0.016 0.079]
 [0.241 0.179 0.304 0.277]
 [0.247 0.425 0.151 0.178]]
Validation acc: 0.5136390017411492
Validation class_accuracies: [0.4434876210979548, 0.6995073891625616, 0.30357142857142855, 0.1780821917808219]
Validation sensitivity: 0.5957178841309824
Validation specificity: 0.4434876210979548
Validation icbhi_score: 0.5196027526144686
Validation roc_auc: None
Validation avg_accuracy: 0.40616215765319175
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 144s - loss: 0.1666 - accuracy: 0.8105 - 144s/epoch - 531ms/step
Epoch 43/110
Validation cm: [[589 208  70  62]
 [219 295  26  69]
 [ 22   5  50  35]
 [ 18  25  20  10]]
Validation val_loss: 0.6944810750806616
Validation normalized_cm: [[0.634 0.224 0.075 0.067]
 [0.36  0.484 0.043 0.113]
 [0.196 0.045 0.446 0.312]
 [0.247 0.342 0.274 0.137]]
Validation acc: 0.5478816018572258
Validation class_accuracies: [0.6340150699677072, 0.48440065681444994, 0.44642857142857145, 0.136986301369863]
Validation sensitivity: 0.44710327455919396
Validation specificity: 0.6340150699677072
Validation icbhi_score: 0.5405591722634506
Validation roc_auc: None
Validation avg_accuracy: 0.4254576498951479
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 4 epochs
There is no such attribute
272/272 - 144s - loss: 0.1678 - accuracy: 0.8132 - 144s/epoch - 530ms/step
Epoch 44/110
Validation cm: [[648 145  86  50]
 [257 256  35  61]
 [ 26   7  53  26]
 [ 23  18  25   7]]
Validation val_loss: 0.6405478882834692
Validation normalized_cm: [[0.698 0.156 0.093 0.054]
 [0.422 0.42  0.057 0.1  ]
 [0.232 0.062 0.473 0.232]
 [0.315 0.247 0.342 0.096]]
Validation acc: 0.559489262913523
Validation class_accuracies: [0.697524219590958, 0.42036124794745483, 0.4732142857142857, 0.0958904109589041]
Validation sensitivity: 0.3979848866498741
Validation specificity: 0.697524219590958
Validation icbhi_score: 0.547754553120416
Validation roc_auc: None
Validation avg_accuracy: 0.4217475410529007
Validation one_indexed_epoch: 44
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
272/272 - 144s - loss: 0.1680 - accuracy: 0.8123 - 144s/epoch - 529ms/step
Epoch 45/110
Validation cm: [[504 300  46  79]
 [151 371  19  68]
 [ 22  11  36  43]
 [ 16  28  15  14]]
Validation val_loss: 0.7325904610188698
Validation normalized_cm: [[0.543 0.323 0.05  0.085]
 [0.248 0.609 0.031 0.112]
 [0.196 0.098 0.321 0.384]
 [0.219 0.384 0.205 0.192]]
Validation acc: 0.5368543238537434
Validation class_accuracies: [0.542518837459634, 0.6091954022988506, 0.32142857142857145, 0.1917808219178082]
Validation sensitivity: 0.5302267002518891
Validation specificity: 0.542518837459634
Validation icbhi_score: 0.5363727688557616
Validation roc_auc: None
Validation avg_accuracy: 0.4162309082762161
Validation one_indexed_epoch: 45
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 6 epochs
There is no such attribute
272/272 - 143s - loss: 0.1659 - accuracy: 0.8086 - 143s/epoch - 525ms/step
Epoch 46/110
Validation cm: [[487 327  41  74]
 [145 378  16  70]
 [ 21   9  38  44]
 [ 12  30  14  17]]
Validation val_loss: 0.7423937347748596
Validation normalized_cm: [[0.524 0.352 0.044 0.08 ]
 [0.238 0.621 0.026 0.115]
 [0.188 0.08  0.339 0.393]
 [0.164 0.411 0.192 0.233]]
Validation acc: 0.5339524085896692
Validation class_accuracies: [0.5242195909580194, 0.6206896551724138, 0.3392857142857143, 0.2328767123287671]
Validation sensitivity: 0.5453400503778337
Validation specificity: 0.5242195909580194
Validation icbhi_score: 0.5347798206679266
Validation roc_auc: None
Validation avg_accuracy: 0.42926791818622867
Validation one_indexed_epoch: 46
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 7 epochs
There is no such attribute
272/272 - 145s - loss: 0.1730 - accuracy: 0.8137 - 145s/epoch - 531ms/step
Epoch 47/110
Validation cm: [[511 302  46  70]
 [163 358  15  73]
 [ 20   9  41  42]
 [ 13  29  17  14]]
Validation val_loss: 0.7230325543987324
Validation normalized_cm: [[0.55  0.325 0.05  0.075]
 [0.268 0.588 0.025 0.12 ]
 [0.179 0.08  0.366 0.375]
 [0.178 0.397 0.233 0.192]]
Validation acc: 0.5362739408009286
Validation class_accuracies: [0.55005382131324, 0.5878489326765188, 0.36607142857142855, 0.1917808219178082]
Validation sensitivity: 0.5201511335012594
Validation specificity: 0.55005382131324
Validation icbhi_score: 0.5351024774072497
Validation roc_auc: None
Validation avg_accuracy: 0.4239387511197489
Validation one_indexed_epoch: 47
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 8 epochs
There is no such attribute
272/272 - 144s - loss: 0.1641 - accuracy: 0.8169 - 144s/epoch - 531ms/step
Epoch 48/110
Validation cm: [[588 224  60  57]
 [211 315  17  66]
 [ 23   6  47  36]
 [ 19  24  18  12]]
Validation val_loss: 0.6872120896959096
Validation normalized_cm: [[0.633 0.241 0.065 0.061]
 [0.346 0.517 0.028 0.108]
 [0.205 0.054 0.42  0.321]
 [0.26  0.329 0.247 0.164]]
Validation acc: 0.5583284968078932
Validation class_accuracies: [0.6329386437029063, 0.5172413793103449, 0.41964285714285715, 0.1643835616438356]
Validation sensitivity: 0.47103274559193953
Validation specificity: 0.6329386437029063
Validation icbhi_score: 0.5519856946474229
Validation roc_auc: None
Validation avg_accuracy: 0.43355161044998597
Validation one_indexed_epoch: 48
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 9 epochs
There is no such attribute
272/272 - 144s - loss: 0.1666 - accuracy: 0.8183 - 144s/epoch - 528ms/step
Epoch 49/110
Validation cm: [[580 240  52  57]
 [202 333  18  56]
 [ 26   7  42  37]
 [ 18  26  18  11]]
Validation val_loss: 0.6794943490760005
Validation normalized_cm: [[0.624 0.258 0.056 0.061]
 [0.332 0.547 0.03  0.092]
 [0.232 0.062 0.375 0.33 ]
 [0.247 0.356 0.247 0.151]]
Validation acc: 0.5606500290191526
Validation class_accuracies: [0.6243272335844995, 0.5467980295566502, 0.375, 0.1506849315068493]
Validation sensitivity: 0.48614609571788414
Validation specificity: 0.6243272335844995
Validation icbhi_score: 0.5552366646511918
Validation roc_auc: None
Validation avg_accuracy: 0.42420254866199975
Validation one_indexed_epoch: 49
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 1.5625000742147677e-05
There is no such attribute
272/272 - 146s - loss: 0.1658 - accuracy: 0.8116 - 146s/epoch - 538ms/step
Epoch 50/110
Validation cm: [[510 298  51  70]
 [158 362  16  73]
 [ 19   9  43  41]
 [ 13  29  18  13]]
Validation val_loss: 0.7319006472564863
Validation normalized_cm: [[0.549 0.321 0.055 0.075]
 [0.259 0.594 0.026 0.12 ]
 [0.17  0.08  0.384 0.366]
 [0.178 0.397 0.247 0.178]]
Validation acc: 0.538595473012188
Validation class_accuracies: [0.5489773950484392, 0.5944170771756979, 0.38392857142857145, 0.1780821917808219]
Validation sensitivity: 0.5264483627204031
Validation specificity: 0.5489773950484392
Validation icbhi_score: 0.5377128788844212
Validation roc_auc: None
Validation avg_accuracy: 0.4263513088583826
Validation one_indexed_epoch: 50
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 11 epochs
There is no such attribute
272/272 - 145s - loss: 0.1677 - accuracy: 0.8125 - 145s/epoch - 534ms/step
Epoch 51/110
Validation cm: [[586 237  51  55]
 [208 329  17  55]
 [ 25   8  45  34]
 [ 18  26  19  10]]
Validation val_loss: 0.6836031439063613
Validation normalized_cm: [[0.631 0.255 0.055 0.059]
 [0.342 0.54  0.028 0.09 ]
 [0.223 0.071 0.402 0.304]
 [0.247 0.356 0.26  0.137]]
Validation acc: 0.562971561230412
Validation class_accuracies: [0.6307857911733046, 0.5402298850574713, 0.4017857142857143, 0.136986301369863]
Validation sensitivity: 0.4836272040302267
Validation specificity: 0.6307857911733046
Validation icbhi_score: 0.5572064976017657
Validation roc_auc: None
Validation avg_accuracy: 0.42744692297158837
Validation one_indexed_epoch: 51
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 12 epochs
There is no such attribute
272/272 - 145s - loss: 0.1698 - accuracy: 0.8049 - 145s/epoch - 532ms/step
Epoch 52/110
Validation cm: [[567 245  57  60]
 [196 329  16  68]
 [ 24   5  44  39]
 [ 18  24  20  11]]
Validation val_loss: 0.6984472890834549
Validation normalized_cm: [[0.61  0.264 0.061 0.065]
 [0.322 0.54  0.026 0.112]
 [0.214 0.045 0.393 0.348]
 [0.247 0.329 0.274 0.151]]
Validation acc: 0.5519442832269298
Validation class_accuracies: [0.6103336921420882, 0.5402298850574713, 0.39285714285714285, 0.1506849315068493]
Validation sensitivity: 0.4836272040302267
Validation specificity: 0.6103336921420882
Validation icbhi_score: 0.5469804480861574
Validation roc_auc: None
Validation avg_accuracy: 0.4235264128908879
Validation one_indexed_epoch: 52
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 13 epochs
There is no such attribute
272/272 - 146s - loss: 0.1641 - accuracy: 0.8211 - 146s/epoch - 536ms/step
Epoch 53/110
Validation cm: [[475 334  46  74]
 [138 380  14  77]
 [ 20   8  38  46]
 [ 11  31  15  16]]
Validation val_loss: 0.7622236723591883
Validation normalized_cm: [[0.511 0.36  0.05  0.08 ]
 [0.227 0.624 0.023 0.126]
 [0.179 0.071 0.339 0.411]
 [0.151 0.425 0.205 0.219]]
Validation acc: 0.5275681950087058
Validation class_accuracies: [0.511302475780409, 0.6239737274220033, 0.3392857142857143, 0.2191780821917808]
Validation sensitivity: 0.5465994962216625
Validation specificity: 0.511302475780409
Validation icbhi_score: 0.5289509860010357
Validation roc_auc: None
Validation avg_accuracy: 0.4234349999199769
Validation one_indexed_epoch: 53
The validation tracker metric at 0.5821737574326284 hasn't increased by 0 in 14 epochs
There is no such attribute
272/272 - 145s - loss: 0.1697 - accuracy: 0.8116 - 145s/epoch - 534ms/step
Epoch 54/110
Validation cm: [[590 222  60  57]
 [217 316  18  58]
 [ 26   6  47  33]
 [ 18  26  19  10]]
Validation val_loss: 0.6894905871866531
Validation normalized_cm: [[0.635 0.239 0.065 0.061]
 [0.356 0.519 0.03  0.095]
 [0.232 0.054 0.42  0.295]
 [0.247 0.356 0.26  0.137]]
Validation acc: 0.558908879860708
Validation class_accuracies: [0.635091496232508, 0.5188834154351396, 0.41964285714285715, 0.136986301369863]
Validation sensitivity: 0.46977329974811083
Validation specificity: 0.635091496232508
Validation icbhi_score: 0.5524323979903094
Validation roc_auc: None
Validation avg_accuracy: 0.42765101754509194
Validation one_indexed_epoch: 54
The number of epochs since last 1% equals the patience
Lr has been adjusted to 7.812500371073838e-06
There is no such attribute
272/272 - 145s - loss: 0.1649 - accuracy: 0.8167 - 145s/epoch - 532ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5821737574326284
Best cm: [[671 150  67  41]
 [244 290  26  49]
 [ 31   6  52  23]
 [ 20  21  23   9]]
Best val_loss: 0.5973767587895199
Best normalized_cm: [[0.722 0.161 0.072 0.044]
 [0.401 0.476 0.043 0.08 ]
 [0.277 0.054 0.464 0.205]
 [0.274 0.288 0.315 0.123]]
Best acc: 0.5931514799767846
Best class_accuracies: [0.7222820236813778, 0.47619047619047616, 0.4642857142857143, 0.1232876712328767]
Best sensitivity: 0.4420654911838791
Best specificity: 0.7222820236813778
Best roc_auc: None
Best avg_accuracy: 0.44651147134761127
Best one_indexed_epoch: 39
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6967043876647949, 0.678051769733429, 0.6477720737457275, 0.5888752341270447, 0.5443655848503113, 0.5171753764152527, 0.5031203031539917, 0.48026856780052185, 0.4569372236728668, 0.42681998014450073, 0.4185827076435089, 0.39475202560424805, 0.37483522295951843, 0.35493049025535583, 0.3235260546207428, 0.30246394872665405, 0.2827228009700775, 0.27711042761802673, 0.2749757170677185, 0.2530762851238251, 0.2366916388273239, 0.23844709992408752, 0.2241201251745224, 0.220067098736763, 0.22301873564720154, 0.2116137444972992, 0.20342960953712463, 0.19949132204055786, 0.19657178223133087, 0.18492896854877472, 0.1787640005350113, 0.18118055164813995, 0.19050703942775726, 0.1826581358909607, 0.18189787864685059, 0.17707888782024384, 0.18071356415748596, 0.17998412251472473, 0.1837829202413559, 0.17741715908050537, 0.1754230558872223, 0.16655263304710388, 0.1678040474653244, 0.1679573804140091, 0.16587214171886444, 0.17301568388938904, 0.16408610343933105, 0.16664347052574158, 0.1657778024673462, 0.16771751642227173, 0.16981838643550873, 0.16407997906208038, 0.16971810162067413, 0.16492889821529388], 'accuracy': [0.5363887548446655, 0.5218793153762817, 0.5757715106010437, 0.6294334530830383, 0.6837862730026245, 0.7273145914077759, 0.7395209670066833, 0.7600184082984924, 0.7556425333023071, 0.7779824733734131, 0.7795946598052979, 0.7828189730644226, 0.7934131622314453, 0.7846614718437195, 0.7966374754905701, 0.8017042875289917, 0.8028558492660522, 0.8005527257919312, 0.7929525375366211, 0.8046982884407043, 0.802395224571228, 0.8021649122238159, 0.8148318529129028, 0.8196683526039124, 0.8088438510894775, 0.809765100479126, 0.8125287890434265, 0.8120681643486023, 0.8148318529129028, 0.8099954128265381, 0.8081529140472412, 0.8155227899551392, 0.817365288734436, 0.8099954128265381, 0.8194380402565002, 0.813450038433075, 0.8074619770050049, 0.811377227306366, 0.8185167908668518, 0.8159834146499634, 0.8109166026115417, 0.8104560375213623, 0.8132197260856628, 0.8122984766960144, 0.8086135387420654, 0.8136803507804871, 0.8169046640396118, 0.8182864785194397, 0.8116075396537781, 0.8125287890434265, 0.8049286007881165, 0.821050226688385, 0.8116075396537781, 0.8166743516921997]}
End
####################################
Job id is 4.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4458 elements, with 2140 none's, 1245 crakles, 575 wheezes and 498 both ---
--- Final Validation dataset contains 1607 elements, with 738 none, 589 crackles, 142 wheezes and 138 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5207943925233645, 1: 0.8951807228915662, 2: 1.9382608695652175, 3: 2.2379518072289155}
Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_2   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_6 (Dense)             (None, 100)               128100    
                                                                 
 dropout_4 (Dropout)         (None, 100)               0         
                                                                 
 dense_7 (Dense)             (None, 50)                5050      
                                                                 
 dropout_5 (Dropout)         (None, 50)                0         
                                                                 
 dense_8 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_4 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_5 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_2 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[394  54 274  16]
 [300  25 253  11]
 [ 79  15  43   5]
 [ 89  17  31   1]]
Validation val_loss: 0.6905590635170904
Validation normalized_cm: [[0.534 0.073 0.371 0.022]
 [0.509 0.042 0.43  0.019]
 [0.556 0.106 0.303 0.035]
 [0.645 0.123 0.225 0.007]]
Validation acc: 0.2881144990665837
Validation class_accuracies: [0.5338753387533876, 0.042444821731748725, 0.3028169014084507, 0.007246376811594203]
Validation sensitivity: 0.07940161104718067
Validation specificity: 0.5338753387533876
Validation icbhi_score: 0.3066384749002841
Validation roc_auc: None
Validation avg_accuracy: 0.2215958596762953
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
279/279 - 149s - loss: 0.7006 - accuracy: 0.3885 - 149s/epoch - 533ms/step
Epoch 2/110
Validation cm: [[105 628   1   4]
 [ 49 539   0   1]
 [ 29 107   0   6]
 [ 19 115   0   4]]
Validation val_loss: 0.6519190466544905
Validation normalized_cm: [[0.142 0.851 0.001 0.005]
 [0.083 0.915 0.    0.002]
 [0.204 0.754 0.    0.042]
 [0.138 0.833 0.    0.029]]
Validation acc: 0.403235843186061
Validation class_accuracies: [0.14227642276422764, 0.9151103565365025, 0.0, 0.028985507246376812]
Validation sensitivity: 0.6248561565017261
Validation specificity: 0.14227642276422764
Validation icbhi_score: 0.3835662896329769
Validation roc_auc: None
Validation avg_accuracy: 0.2715930716367767
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
279/279 - 135s - loss: 0.6765 - accuracy: 0.5018 - 135s/epoch - 484ms/step
Epoch 3/110
Validation cm: [[515  77 122  24]
 [355  81 126  27]
 [ 32   6  83  21]
 [ 32   8  74  24]]
Validation val_loss: 0.6394407530155847
Validation normalized_cm: [[0.698 0.104 0.165 0.033]
 [0.603 0.138 0.214 0.046]
 [0.225 0.042 0.585 0.148]
 [0.232 0.058 0.536 0.174]]
Validation acc: 0.4374611076540137
Validation class_accuracies: [0.6978319783197832, 0.13752122241086587, 0.5845070422535211, 0.17391304347826086]
Validation sensitivity: 0.21634062140391255
Validation specificity: 0.6978319783197832
Validation icbhi_score: 0.45708629986184784
Validation roc_auc: None
Validation avg_accuracy: 0.3984433216156077
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
279/279 - 134s - loss: 0.6458 - accuracy: 0.5393 - 134s/epoch - 481ms/step
Epoch 4/110
Validation cm: [[351 359  13  15]
 [136 404  16  33]
 [ 25  36  59  22]
 [ 14  47  53  24]]
Validation val_loss: 0.5703526393886523
Validation normalized_cm: [[0.476 0.486 0.018 0.02 ]
 [0.231 0.686 0.027 0.056]
 [0.176 0.254 0.415 0.155]
 [0.101 0.341 0.384 0.174]]
Validation acc: 0.5214685749844431
Validation class_accuracies: [0.47560975609756095, 0.6859083191850595, 0.4154929577464789, 0.17391304347826086]
Validation sensitivity: 0.5604142692750288
Validation specificity: 0.47560975609756095
Validation icbhi_score: 0.5180120126862948
Validation roc_auc: None
Validation avg_accuracy: 0.43773101912684
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
279/279 - 135s - loss: 0.6017 - accuracy: 0.6258 - 135s/epoch - 484ms/step
Epoch 5/110
Validation cm: [[709  26   3   0]
 [540  47   2   0]
 [ 80  16  40   6]
 [ 74  17  35  12]]
Validation val_loss: 0.5315479003611602
Validation normalized_cm: [[0.961 0.035 0.004 0.   ]
 [0.917 0.08  0.003 0.   ]
 [0.563 0.113 0.282 0.042]
 [0.536 0.123 0.254 0.087]]
Validation acc: 0.5028002489110143
Validation class_accuracies: [0.9607046070460704, 0.07979626485568761, 0.28169014084507044, 0.08695652173913043]
Validation sensitivity: 0.11392405063291139
Validation specificity: 0.9607046070460704
Validation icbhi_score: 0.5373143288394909
Validation roc_auc: None
Validation avg_accuracy: 0.35228688362148974
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
279/279 - 135s - loss: 0.5592 - accuracy: 0.6812 - 135s/epoch - 483ms/step
Epoch 6/110
Validation cm: [[691  19  27   1]
 [536  35  17   1]
 [ 63   3  74   2]
 [ 46   5  85   2]]
Validation val_loss: 0.5183903618803214
Validation normalized_cm: [[0.936 0.026 0.037 0.001]
 [0.91  0.059 0.029 0.002]
 [0.444 0.021 0.521 0.014]
 [0.333 0.036 0.616 0.014]]
Validation acc: 0.49906658369632856
Validation class_accuracies: [0.9363143631436315, 0.059422750424448216, 0.5211267605633803, 0.014492753623188406]
Validation sensitivity: 0.1277330264672037
Validation specificity: 0.9363143631436315
Validation icbhi_score: 0.5320236948054176
Validation roc_auc: None
Validation avg_accuracy: 0.3828391569386621
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5373143288394909 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 133s - loss: 0.5277 - accuracy: 0.6987 - 133s/epoch - 478ms/step
Epoch 7/110
Validation cm: [[438 208  48  44]
 [167 280  53  89]
 [ 19  13  63  47]
 [ 20  19  64  35]]
Validation val_loss: 0.5509764248251395
Validation normalized_cm: [[0.593 0.282 0.065 0.06 ]
 [0.284 0.475 0.09  0.151]
 [0.134 0.092 0.444 0.331]
 [0.145 0.138 0.464 0.254]]
Validation acc: 0.507778469197262
Validation class_accuracies: [0.5934959349593496, 0.47538200339558573, 0.44366197183098594, 0.2536231884057971]
Validation sensitivity: 0.43498273878020716
Validation specificity: 0.5934959349593496
Validation icbhi_score: 0.5142393368697784
Validation roc_auc: None
Validation avg_accuracy: 0.4415407746479296
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5373143288394909 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 127s - loss: 0.5040 - accuracy: 0.7263 - 127s/epoch - 457ms/step
Epoch 8/110
Validation cm: [[531 188  14   5]
 [298 283   5   3]
 [ 58  14  68   2]
 [ 31  19  76  12]]
Validation val_loss: 0.48309806456143767
Validation normalized_cm: [[0.72  0.255 0.019 0.007]
 [0.506 0.48  0.008 0.005]
 [0.408 0.099 0.479 0.014]
 [0.225 0.138 0.551 0.087]]
Validation acc: 0.5563161169881767
Validation class_accuracies: [0.7195121951219512, 0.48047538200339557, 0.4788732394366197, 0.08695652173913043]
Validation sensitivity: 0.4177215189873418
Validation specificity: 0.7195121951219512
Validation icbhi_score: 0.5686168570546465
Validation roc_auc: None
Validation avg_accuracy: 0.4414543345752742
Validation one_indexed_epoch: 8
-- New best results were achieved. --
There is no such attribute
279/279 - 127s - loss: 0.4737 - accuracy: 0.7479 - 127s/epoch - 454ms/step
Epoch 9/110
Validation cm: [[205 512   6  15]
 [ 46 530   1  12]
 [ 15  51  55  21]
 [  4  66  35  33]]
Validation val_loss: 0.5032078700526093
Validation normalized_cm: [[0.278 0.694 0.008 0.02 ]
 [0.078 0.9   0.002 0.02 ]
 [0.106 0.359 0.387 0.148]
 [0.029 0.478 0.254 0.239]]
Validation acc: 0.5121344119477287
Validation class_accuracies: [0.2777777777777778, 0.8998302207130731, 0.3873239436619718, 0.2391304347826087]
Validation sensitivity: 0.7111622554660529
Validation specificity: 0.2777777777777778
Validation icbhi_score: 0.49447001662191536
Validation roc_auc: None
Validation avg_accuracy: 0.45101559423385784
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5686168570546465 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 127s - loss: 0.4520 - accuracy: 0.7501 - 127s/epoch - 454ms/step
Epoch 10/110
Validation cm: [[648  75   7   8]
 [432 150   0   7]
 [ 62   9  60  11]
 [ 54   9  56  19]]
Validation val_loss: 0.47569416388730196
Validation normalized_cm: [[0.878 0.102 0.009 0.011]
 [0.733 0.255 0.    0.012]
 [0.437 0.063 0.423 0.077]
 [0.391 0.065 0.406 0.138]]
Validation acc: 0.5457373988799005
Validation class_accuracies: [0.8780487804878049, 0.2546689303904924, 0.4225352112676056, 0.13768115942028986]
Validation sensitivity: 0.26352128883774456
Validation specificity: 0.8780487804878049
Validation icbhi_score: 0.5707850346627747
Validation roc_auc: None
Validation avg_accuracy: 0.4232335203915482
Validation one_indexed_epoch: 10
-- New best results were achieved. --
There is no such attribute
279/279 - 126s - loss: 0.4223 - accuracy: 0.7660 - 126s/epoch - 453ms/step
Epoch 11/110
Validation cm: [[285 408  25  20]
 [ 94 451  19  25]
 [ 24  19  86  13]
 [  4  31  85  18]]
Validation val_loss: 0.4919263600269199
Validation normalized_cm: [[0.386 0.553 0.034 0.027]
 [0.16  0.766 0.032 0.042]
 [0.169 0.134 0.606 0.092]
 [0.029 0.225 0.616 0.13 ]]
Validation acc: 0.522713130056005
Validation class_accuracies: [0.3861788617886179, 0.765704584040747, 0.6056338028169014, 0.13043478260869565]
Validation sensitivity: 0.6386651323360184
Validation specificity: 0.3861788617886179
Validation icbhi_score: 0.5124219970623182
Validation roc_auc: None
Validation avg_accuracy: 0.47198800781374045
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 128s - loss: 0.4084 - accuracy: 0.7575 - 128s/epoch - 458ms/step
Epoch 12/110
Validation cm: [[463 251  18   6]
 [212 362   5  10]
 [ 44  19  77   2]
 [ 34  22  77   5]]
Validation val_loss: 0.4792657746019464
Validation normalized_cm: [[0.627 0.34  0.024 0.008]
 [0.36  0.615 0.008 0.017]
 [0.31  0.134 0.542 0.014]
 [0.246 0.159 0.558 0.036]]
Validation acc: 0.5644057249533292
Validation class_accuracies: [0.6273712737127372, 0.6146010186757216, 0.5422535211267606, 0.036231884057971016]
Validation sensitivity: 0.5109321058688148
Validation specificity: 0.6273712737127372
Validation icbhi_score: 0.569151689790776
Validation roc_auc: None
Validation avg_accuracy: 0.4551144243932976
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 128s - loss: 0.3786 - accuracy: 0.7654 - 128s/epoch - 459ms/step
Epoch 13/110
Validation cm: [[658  70   9   1]
 [509  72   5   3]
 [ 72  10  47  13]
 [ 65   3  59  11]]
Validation val_loss: 0.5090562054132851
Validation normalized_cm: [[0.892 0.095 0.012 0.001]
 [0.864 0.122 0.008 0.005]
 [0.507 0.07  0.331 0.092]
 [0.471 0.022 0.428 0.08 ]]
Validation acc: 0.4903546981953951
Validation class_accuracies: [0.8915989159891599, 0.12224108658743633, 0.33098591549295775, 0.07971014492753623]
Validation sensitivity: 0.14959723820483314
Validation specificity: 0.8915989159891599
Validation icbhi_score: 0.5205980770969965
Validation roc_auc: None
Validation avg_accuracy: 0.3561340157492725
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 128s - loss: 0.3569 - accuracy: 0.7694 - 128s/epoch - 458ms/step
Epoch 14/110
Validation cm: [[431 265  17  25]
 [218 352   9  10]
 [ 26  14  49  53]
 [ 16  39  25  58]]
Validation val_loss: 0.48870126612822906
Validation normalized_cm: [[0.584 0.359 0.023 0.034]
 [0.37  0.598 0.015 0.017]
 [0.183 0.099 0.345 0.373]
 [0.116 0.283 0.181 0.42 ]]
Validation acc: 0.5538270068450529
Validation class_accuracies: [0.5840108401084011, 0.597623089983022, 0.34507042253521125, 0.42028985507246375]
Validation sensitivity: 0.5281933256616801
Validation specificity: 0.5840108401084011
Validation icbhi_score: 0.5561020828850406
Validation roc_auc: None
Validation avg_accuracy: 0.4867485519247745
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 129s - loss: 0.3332 - accuracy: 0.7833 - 129s/epoch - 462ms/step
Epoch 15/110
Validation cm: [[359 234  55  90]
 [180 250  42 117]
 [ 22   6  54  60]
 [  9  14  43  72]]
Validation val_loss: 0.6142157684888763
Validation normalized_cm: [[0.486 0.317 0.075 0.122]
 [0.306 0.424 0.071 0.199]
 [0.155 0.042 0.38  0.423]
 [0.065 0.101 0.312 0.522]]
Validation acc: 0.45737398879900437
Validation class_accuracies: [0.48644986449864497, 0.4244482173174873, 0.38028169014084506, 0.5217391304347826]
Validation sensitivity: 0.4326812428078251
Validation specificity: 0.48644986449864497
Validation icbhi_score: 0.45956555365323504
Validation roc_auc: None
Validation avg_accuracy: 0.45322972559793995
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
279/279 - 128s - loss: 0.3098 - accuracy: 0.7860 - 128s/epoch - 458ms/step
Epoch 16/110
Validation cm: [[570 103  45  20]
 [379 155  38  17]
 [ 23   9  99  11]
 [ 25   4  90  19]]
Validation val_loss: 0.521978213599296
Validation normalized_cm: [[0.772 0.14  0.061 0.027]
 [0.643 0.263 0.065 0.029]
 [0.162 0.063 0.697 0.077]
 [0.181 0.029 0.652 0.138]]
Validation acc: 0.5245799626633478
Validation class_accuracies: [0.7723577235772358, 0.2631578947368421, 0.6971830985915493, 0.13768115942028986]
Validation sensitivity: 0.3141542002301496
Validation specificity: 0.7723577235772358
Validation icbhi_score: 0.5432559619036927
Validation roc_auc: None
Validation avg_accuracy: 0.46759496908147924
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 6 epochs
There is no such attribute
279/279 - 128s - loss: 0.2876 - accuracy: 0.7961 - 128s/epoch - 458ms/step
Epoch 17/110
Validation cm: [[463 157  60  58]
 [203 276  39  71]
 [ 29   5  95  13]
 [ 18  17  89  14]]
Validation val_loss: 0.6187275016295545
Validation normalized_cm: [[0.627 0.213 0.081 0.079]
 [0.345 0.469 0.066 0.121]
 [0.204 0.035 0.669 0.092]
 [0.13  0.123 0.645 0.101]]
Validation acc: 0.5276913503422527
Validation class_accuracies: [0.6273712737127372, 0.4685908319185059, 0.6690140845070423, 0.10144927536231885]
Validation sensitivity: 0.4430379746835443
Validation specificity: 0.6273712737127372
Validation icbhi_score: 0.5352046241981407
Validation roc_auc: None
Validation avg_accuracy: 0.466606366375151
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 7 epochs
There is no such attribute
279/279 - 128s - loss: 0.2589 - accuracy: 0.7948 - 128s/epoch - 459ms/step
Epoch 18/110
Validation cm: [[190 509  15  24]
 [ 43 498   4  44]
 [ 17  39  58  28]
 [  7  47  51  33]]
Validation val_loss: 0.6211269603295724
Validation normalized_cm: [[0.257 0.69  0.02  0.033]
 [0.073 0.846 0.007 0.075]
 [0.12  0.275 0.408 0.197]
 [0.051 0.341 0.37  0.239]]
Validation acc: 0.48475420037336653
Validation class_accuracies: [0.25745257452574527, 0.8455008488964346, 0.4084507042253521, 0.2391304347826087]
Validation sensitivity: 0.6777905638665133
Validation specificity: 0.25745257452574527
Validation icbhi_score: 0.4676215691961293
Validation roc_auc: None
Validation avg_accuracy: 0.4376336406075351
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 8 epochs
There is no such attribute
279/279 - 129s - loss: 0.2385 - accuracy: 0.8053 - 129s/epoch - 461ms/step
Epoch 19/110
Validation cm: [[380 345  10   3]
 [177 405   0   7]
 [ 25  53  23  41]
 [ 20  49  18  51]]
Validation val_loss: 0.5061021504434569
Validation normalized_cm: [[0.515 0.467 0.014 0.004]
 [0.301 0.688 0.    0.012]
 [0.176 0.373 0.162 0.289]
 [0.145 0.355 0.13  0.37 ]]
Validation acc: 0.5345364032358432
Validation class_accuracies: [0.5149051490514905, 0.6876061120543294, 0.1619718309859155, 0.3695652173913043]
Validation sensitivity: 0.5512082853855006
Validation specificity: 0.5149051490514905
Validation icbhi_score: 0.5330567172184956
Validation roc_auc: None
Validation avg_accuracy: 0.4335120773707599
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 9 epochs
There is no such attribute
279/279 - 128s - loss: 0.2394 - accuracy: 0.8100 - 128s/epoch - 460ms/step
Epoch 20/110
Validation cm: [[320 346  31  41]
 [106 401  16  66]
 [ 19  22  60  41]
 [  5  29  59  45]]
Validation val_loss: 0.5710392962572094
Validation normalized_cm: [[0.434 0.469 0.042 0.056]
 [0.18  0.681 0.027 0.112]
 [0.134 0.155 0.423 0.289]
 [0.036 0.21  0.428 0.326]]
Validation acc: 0.5140012445550716
Validation class_accuracies: [0.43360433604336046, 0.6808149405772496, 0.4225352112676056, 0.32608695652173914]
Validation sensitivity: 0.5822784810126582
Validation specificity: 0.43360433604336046
Validation icbhi_score: 0.5079414085280094
Validation roc_auc: None
Validation avg_accuracy: 0.46576036110248875
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
279/279 - 128s - loss: 0.2396 - accuracy: 0.7905 - 128s/epoch - 459ms/step
Epoch 21/110
Validation cm: [[487 174  53  24]
 [272 286  18  13]
 [ 44   8  67  23]
 [ 34  28  53  23]]
Validation val_loss: 0.5400217491379975
Validation normalized_cm: [[0.66  0.236 0.072 0.033]
 [0.462 0.486 0.031 0.022]
 [0.31  0.056 0.472 0.162]
 [0.246 0.203 0.384 0.167]]
Validation acc: 0.537025513378967
Validation class_accuracies: [0.6598915989159891, 0.4855687606112054, 0.47183098591549294, 0.16666666666666666]
Validation sensitivity: 0.4326812428078251
Validation specificity: 0.6598915989159891
Validation icbhi_score: 0.5462864208619072
Validation roc_auc: None
Validation avg_accuracy: 0.4459895030273386
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 11 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 129s - loss: 0.2194 - accuracy: 0.7914 - 129s/epoch - 463ms/step
Epoch 22/110
Validation cm: [[292 388  29  29]
 [112 428  12  37]
 [ 24  23  67  28]
 [ 10  39  50  39]]
Validation val_loss: 0.5993105958160256
Validation normalized_cm: [[0.396 0.526 0.039 0.039]
 [0.19  0.727 0.02  0.063]
 [0.169 0.162 0.472 0.197]
 [0.072 0.283 0.362 0.283]]
Validation acc: 0.5140012445550716
Validation class_accuracies: [0.3956639566395664, 0.7266553480475382, 0.47183098591549294, 0.2826086956521739]
Validation sensitivity: 0.6144994246260069
Validation specificity: 0.3956639566395664
Validation icbhi_score: 0.5050816906327866
Validation roc_auc: None
Validation avg_accuracy: 0.46918974656369283
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 12 epochs
There is no such attribute
279/279 - 128s - loss: 0.2021 - accuracy: 0.8010 - 128s/epoch - 460ms/step
Epoch 23/110
Validation cm: [[195 469  18  56]
 [ 50 437  17  85]
 [ 17  23  43  59]
 [  7  28  35  68]]
Validation val_loss: 0.6755324785603998
Validation normalized_cm: [[0.264 0.636 0.024 0.076]
 [0.085 0.742 0.029 0.144]
 [0.12  0.162 0.303 0.415]
 [0.051 0.203 0.254 0.493]]
Validation acc: 0.46235220908525204
Validation class_accuracies: [0.26422764227642276, 0.7419354838709677, 0.3028169014084507, 0.4927536231884058]
Validation sensitivity: 0.6306098964326813
Validation specificity: 0.26422764227642276
Validation icbhi_score: 0.44741876935455205
Validation roc_auc: None
Validation avg_accuracy: 0.45043341268606174
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 13 epochs
There is no such attribute
279/279 - 128s - loss: 0.2072 - accuracy: 0.7992 - 128s/epoch - 458ms/step
Epoch 24/110
Validation cm: [[236 459  13  30]
 [ 51 475   7  56]
 [ 24  29  40  49]
 [ 10  38  39  51]]
Validation val_loss: 0.6320347784466082
Validation normalized_cm: [[0.32  0.622 0.018 0.041]
 [0.087 0.806 0.012 0.095]
 [0.169 0.204 0.282 0.345]
 [0.072 0.275 0.283 0.37 ]]
Validation acc: 0.49906658369632856
Validation class_accuracies: [0.31978319783197834, 0.8064516129032258, 0.28169014084507044, 0.3695652173913043]
Validation sensitivity: 0.6513233601841196
Validation specificity: 0.31978319783197834
Validation icbhi_score: 0.485553279008049
Validation roc_auc: None
Validation avg_accuracy: 0.4443725422428947
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5707850346627747 hasn't increased by 0 in 14 epochs
There is no such attribute
279/279 - 128s - loss: 0.1958 - accuracy: 0.8179 - 128s/epoch - 459ms/step
Epoch 25/110
Validation cm: [[181 511   5  41]
 [ 37 481   3  68]
 [ 15  34  28  65]
 [  5  39  27  67]]
Validation val_loss: 0.6709474758936154
Validation normalized_cm: [[0.245 0.692 0.007 0.056]
 [0.063 0.817 0.005 0.115]
 [0.106 0.239 0.197 0.458]
 [0.036 0.283 0.196 0.486]]
Validation acc: 0.4710640945861854
Validation class_accuracies: [0.24525745257452575, 0.8166383701188455, 0.19718309859154928, 0.4855072463768116]
Validation sensitivity: 0.6628308400460299
Validation specificity: 0.24525745257452575
Validation icbhi_score: 0.4540441463102778
Validation roc_auc: None
Validation avg_accuracy: 0.436146541915433
Validation one_indexed_epoch: 25
The number of epochs since last 1% equals the patience
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
279/279 - 128s - loss: 0.1963 - accuracy: 0.8073 - 128s/epoch - 460ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5707850346627747
Best cm: [[648  75   7   8]
 [432 150   0   7]
 [ 62   9  60  11]
 [ 54   9  56  19]]
Best val_loss: 0.47569416388730196
Best normalized_cm: [[0.878 0.102 0.009 0.011]
 [0.733 0.255 0.    0.012]
 [0.437 0.063 0.423 0.077]
 [0.391 0.065 0.406 0.138]]
Best acc: 0.5457373988799005
Best class_accuracies: [0.8780487804878049, 0.2546689303904924, 0.4225352112676056, 0.13768115942028986]
Best sensitivity: 0.26352128883774456
Best specificity: 0.8780487804878049
Best roc_auc: None
Best avg_accuracy: 0.4232335203915482
Best one_indexed_epoch: 10
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7006483674049377, 0.6764900088310242, 0.6458364725112915, 0.6016572713851929, 0.5592007637023926, 0.5277357697486877, 0.5039870142936707, 0.4736770689487457, 0.45196208357810974, 0.4223204255104065, 0.4084235429763794, 0.37862256169319153, 0.35687878727912903, 0.3332483470439911, 0.3097968101501465, 0.28758448362350464, 0.2588706314563751, 0.23850086331367493, 0.23943212628364563, 0.23961526155471802, 0.21944977343082428, 0.20205773413181305, 0.20721383392810822, 0.19581590592861176, 0.1962902694940567], 'accuracy': [0.38851502537727356, 0.5017945170402527, 0.5392552614212036, 0.6258412003517151, 0.6812471747398376, 0.6987438201904297, 0.7263346910476685, 0.7478690147399902, 0.7501121759414673, 0.7660385966300964, 0.7575145959854126, 0.7653656601905823, 0.769403338432312, 0.7833108901977539, 0.7860026955604553, 0.796096920967102, 0.794750988483429, 0.8052938580513, 0.810004472732544, 0.7904890179634094, 0.7913862466812134, 0.8010318279266357, 0.7992373108863831, 0.8178555369377136, 0.8073126673698425]}
End
####################################
Job id is 5.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4467 elements, with 2251 none's, 1179 crakles, 516 wheezes and 521 both ---
--- Final Validation dataset contains 1598 elements, with 627 none, 655 crackles, 201 wheezes and 115 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.4961128387383385, 1: 0.9472010178117048, 2: 2.1642441860465116, 3: 2.1434740882917467}
Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_3   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_9 (Dense)             (None, 100)               128100    
                                                                 
 dropout_6 (Dropout)         (None, 100)               0         
                                                                 
 dense_10 (Dense)            (None, 50)                5050      
                                                                 
 dropout_7 (Dropout)         (None, 50)                0         
                                                                 
 dense_11 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_3"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_6 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_7 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_3 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[212 163  79 173]
 [137 184  61 273]
 [ 36  36  30  99]
 [ 25  25  22  43]]
Validation val_loss: 0.6857271639068374
Validation normalized_cm: [[0.338 0.26  0.126 0.276]
 [0.209 0.281 0.093 0.417]
 [0.179 0.179 0.149 0.493]
 [0.217 0.217 0.191 0.374]]
Validation acc: 0.2934918648310388
Validation class_accuracies: [0.33811802232854865, 0.28091603053435116, 0.14925373134328357, 0.3739130434782609]
Validation sensitivity: 0.2646755921730175
Validation specificity: 0.33811802232854865
Validation icbhi_score: 0.3013968072507831
Validation roc_auc: None
Validation avg_accuracy: 0.28555020692111105
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
280/280 - 141s - loss: 0.6965 - accuracy: 0.4820 - 141s/epoch - 502ms/step
Epoch 2/110
Validation cm: [[331  85 198  13]
 [321  63 260  11]
 [124   7  68   2]
 [ 71  18  24   2]]
Validation val_loss: 0.6873970533416924
Validation normalized_cm: [[0.528 0.136 0.316 0.021]
 [0.49  0.096 0.397 0.017]
 [0.617 0.035 0.338 0.01 ]
 [0.617 0.157 0.209 0.017]]
Validation acc: 0.2903629536921151
Validation class_accuracies: [0.5279106858054227, 0.09618320610687023, 0.3383084577114428, 0.017391304347826087]
Validation sensitivity: 0.13697219361483007
Validation specificity: 0.5279106858054227
Validation icbhi_score: 0.33244143971012635
Validation roc_auc: None
Validation avg_accuracy: 0.24494841349289045
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
280/280 - 126s - loss: 0.6686 - accuracy: 0.5554 - 126s/epoch - 450ms/step
Epoch 3/110
Validation cm: [[274 104 225  24]
 [277 145 189  44]
 [ 45  14 123  19]
 [ 13  11  78  13]]
Validation val_loss: 0.6573544587375822
Validation normalized_cm: [[0.437 0.166 0.359 0.038]
 [0.423 0.221 0.289 0.067]
 [0.224 0.07  0.612 0.095]
 [0.113 0.096 0.678 0.113]]
Validation acc: 0.34730913642052563
Validation class_accuracies: [0.4370015948963317, 0.22137404580152673, 0.6119402985074627, 0.11304347826086956]
Validation sensitivity: 0.2893923789907312
Validation specificity: 0.4370015948963317
Validation icbhi_score: 0.3631969869435315
Validation roc_auc: None
Validation avg_accuracy: 0.3458398543665477
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
280/280 - 126s - loss: 0.6302 - accuracy: 0.5735 - 126s/epoch - 451ms/step
Epoch 4/110
Validation cm: [[598  26   3   0]
 [566  75   9   5]
 [144   6  45   6]
 [ 86   4  21   4]]
Validation val_loss: 0.5660025997085029
Validation normalized_cm: [[0.954 0.041 0.005 0.   ]
 [0.864 0.115 0.014 0.008]
 [0.716 0.03  0.224 0.03 ]
 [0.748 0.035 0.183 0.035]]
Validation acc: 0.4518147684605757
Validation class_accuracies: [0.9537480063795853, 0.11450381679389313, 0.22388059701492538, 0.034782608695652174]
Validation sensitivity: 0.12770339855818744
Validation specificity: 0.9537480063795853
Validation icbhi_score: 0.5407257024688864
Validation roc_auc: None
Validation avg_accuracy: 0.331728757221014
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
280/280 - 126s - loss: 0.5875 - accuracy: 0.6376 - 126s/epoch - 451ms/step
Epoch 5/110
Validation cm: [[446 105  57  19]
 [370 188  67  30]
 [ 48  18  88  47]
 [ 30  22  41  22]]
Validation val_loss: 0.5867548838761333
Validation normalized_cm: [[0.711 0.167 0.091 0.03 ]
 [0.565 0.287 0.102 0.046]
 [0.239 0.09  0.438 0.234]
 [0.261 0.191 0.357 0.191]]
Validation acc: 0.4655819774718398
Validation class_accuracies: [0.7113237639553429, 0.2870229007633588, 0.43781094527363185, 0.19130434782608696]
Validation sensitivity: 0.30690010298661174
Validation specificity: 0.7113237639553429
Validation icbhi_score: 0.5091119334709773
Validation roc_auc: None
Validation avg_accuracy: 0.40686548945460516
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5407257024688864 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 126s - loss: 0.5532 - accuracy: 0.6935 - 126s/epoch - 451ms/step
Epoch 6/110
Validation cm: [[518 103   4   2]
 [494 161   0   0]
 [142  14  41   4]
 [ 76  23  15   1]]
Validation val_loss: 0.543616590655417
Validation normalized_cm: [[0.826 0.164 0.006 0.003]
 [0.754 0.246 0.    0.   ]
 [0.706 0.07  0.204 0.02 ]
 [0.661 0.2   0.13  0.009]]
Validation acc: 0.45118898623279097
Validation class_accuracies: [0.8261562998405104, 0.24580152671755726, 0.20398009950248755, 0.008695652173913044]
Validation sensitivity: 0.2090628218331617
Validation specificity: 0.8261562998405104
Validation icbhi_score: 0.5176095608368361
Validation roc_auc: None
Validation avg_accuracy: 0.32115839455861706
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5407257024688864 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 127s - loss: 0.5185 - accuracy: 0.6971 - 127s/epoch - 453ms/step
Epoch 7/110
Validation cm: [[450 167   8   2]
 [278 366   8   3]
 [ 71  46  54  30]
 [ 39  32  34  10]]
Validation val_loss: 0.5014717787485546
Validation normalized_cm: [[0.718 0.266 0.013 0.003]
 [0.424 0.559 0.012 0.005]
 [0.353 0.229 0.269 0.149]
 [0.339 0.278 0.296 0.087]]
Validation acc: 0.5506883604505632
Validation class_accuracies: [0.7177033492822966, 0.5587786259541985, 0.26865671641791045, 0.08695652173913043]
Validation sensitivity: 0.4428424304840371
Validation specificity: 0.7177033492822966
Validation icbhi_score: 0.5802728898831668
Validation roc_auc: None
Validation avg_accuracy: 0.40802380334838395
Validation one_indexed_epoch: 7
-- New best results were achieved. --
There is no such attribute
280/280 - 127s - loss: 0.4977 - accuracy: 0.7173 - 127s/epoch - 454ms/step
Epoch 8/110
Validation cm: [[565  14  38  10]
 [533  45  48  29]
 [ 58   5  84  54]
 [ 38   2  51  24]]
Validation val_loss: 0.5538985064353453
Validation normalized_cm: [[0.901 0.022 0.061 0.016]
 [0.814 0.069 0.073 0.044]
 [0.289 0.025 0.418 0.269]
 [0.33  0.017 0.443 0.209]]
Validation acc: 0.4493116395494368
Validation class_accuracies: [0.9011164274322169, 0.06870229007633588, 0.417910447761194, 0.20869565217391303]
Validation sensitivity: 0.15756951596292482
Validation specificity: 0.9011164274322169
Validation icbhi_score: 0.5293429716975708
Validation roc_auc: None
Validation avg_accuracy: 0.39910620436091493
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5802728898831668 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 128s - loss: 0.4689 - accuracy: 0.7343 - 128s/epoch - 455ms/step
Epoch 9/110
Validation cm: [[544  25  55   3]
 [452  98  87  18]
 [ 70   9 107  15]
 [ 45   7  59   4]]
Validation val_loss: 0.564233948253981
Validation normalized_cm: [[0.868 0.04  0.088 0.005]
 [0.69  0.15  0.133 0.027]
 [0.348 0.045 0.532 0.075]
 [0.391 0.061 0.513 0.035]]
Validation acc: 0.4712140175219024
Validation class_accuracies: [0.8676236044657097, 0.14961832061068703, 0.5323383084577115, 0.034782608695652174]
Validation sensitivity: 0.21524201853759012
Validation specificity: 0.8676236044657097
Validation icbhi_score: 0.5414328115016499
Validation roc_auc: None
Validation avg_accuracy: 0.3960907105574401
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5802728898831668 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 127s - loss: 0.4440 - accuracy: 0.7412 - 127s/epoch - 455ms/step
Epoch 10/110
Validation cm: [[583  35   8   1]
 [510 129   8   8]
 [124   8  47  22]
 [ 71  11  21  12]]
Validation val_loss: 0.534551356132323
Validation normalized_cm: [[0.93  0.056 0.013 0.002]
 [0.779 0.197 0.012 0.012]
 [0.617 0.04  0.234 0.109]
 [0.617 0.096 0.183 0.104]]
Validation acc: 0.48247809762202754
Validation class_accuracies: [0.9298245614035088, 0.1969465648854962, 0.23383084577114427, 0.10434782608695652]
Validation sensitivity: 0.19361483007209063
Validation specificity: 0.9298245614035088
Validation icbhi_score: 0.5617196957377997
Validation roc_auc: None
Validation avg_accuracy: 0.36623744953677645
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5802728898831668 hasn't increased by 0 in 3 epochs
There is no such attribute
280/280 - 128s - loss: 0.4223 - accuracy: 0.7629 - 128s/epoch - 455ms/step
Epoch 11/110
Validation cm: [[450 176   1   0]
 [249 400   3   3]
 [106  46  39  10]
 [ 47  45  17   6]]
Validation val_loss: 0.5514045645703138
Validation normalized_cm: [[0.718 0.281 0.002 0.   ]
 [0.38  0.611 0.005 0.005]
 [0.527 0.229 0.194 0.05 ]
 [0.409 0.391 0.148 0.052]]
Validation acc: 0.5600750938673341
Validation class_accuracies: [0.7177033492822966, 0.6106870229007634, 0.19402985074626866, 0.05217391304347826]
Validation sensitivity: 0.45829042224510813
Validation specificity: 0.7177033492822966
Validation icbhi_score: 0.5879968857637023
Validation roc_auc: None
Validation avg_accuracy: 0.3936485339932017
Validation one_indexed_epoch: 11
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
280/280 - 127s - loss: 0.3973 - accuracy: 0.7587 - 127s/epoch - 455ms/step
Epoch 12/110
Validation cm: [[341 224  22  40]
 [180 429  15  31]
 [ 35  51  59  56]
 [ 17  47  25  26]]
Validation val_loss: 0.5288966716767215
Validation normalized_cm: [[0.544 0.357 0.035 0.064]
 [0.275 0.655 0.023 0.047]
 [0.174 0.254 0.294 0.279]
 [0.148 0.409 0.217 0.226]]
Validation acc: 0.5350438047559449
Validation class_accuracies: [0.543859649122807, 0.6549618320610687, 0.2935323383084577, 0.22608695652173913]
Validation sensitivity: 0.529351184346035
Validation specificity: 0.543859649122807
Validation icbhi_score: 0.536605416734421
Validation roc_auc: None
Validation avg_accuracy: 0.4296101940035182
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 127s - loss: 0.3720 - accuracy: 0.7694 - 127s/epoch - 454ms/step
Epoch 13/110
Validation cm: [[502 109   8   8]
 [393 228   7  27]
 [ 76  32  46  47]
 [ 37  20  32  26]]
Validation val_loss: 0.5277372566500541
Validation normalized_cm: [[0.801 0.174 0.013 0.013]
 [0.6   0.348 0.011 0.041]
 [0.378 0.159 0.229 0.234]
 [0.322 0.174 0.278 0.226]]
Validation acc: 0.5018773466833542
Validation class_accuracies: [0.8006379585326954, 0.3480916030534351, 0.22885572139303484, 0.22608695652173913]
Validation sensitivity: 0.30895983522142123
Validation specificity: 0.8006379585326954
Validation icbhi_score: 0.5547988968770583
Validation roc_auc: None
Validation avg_accuracy: 0.4009180598752261
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 127s - loss: 0.3464 - accuracy: 0.7799 - 127s/epoch - 454ms/step
Epoch 14/110
Validation cm: [[299 290  26  12]
 [130 469  19  37]
 [ 32  60  63  46]
 [ 16  45  31  23]]
Validation val_loss: 0.5500214208985151
Validation normalized_cm: [[0.477 0.463 0.041 0.019]
 [0.198 0.716 0.029 0.056]
 [0.159 0.299 0.313 0.229]
 [0.139 0.391 0.27  0.2  ]]
Validation acc: 0.5344180225281602
Validation class_accuracies: [0.4768740031897927, 0.716030534351145, 0.31343283582089554, 0.2]
Validation sensitivity: 0.5715756951596292
Validation specificity: 0.4768740031897927
Validation icbhi_score: 0.524224849174711
Validation roc_auc: None
Validation avg_accuracy: 0.4265843433404583
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 3 epochs
There is no such attribute
280/280 - 128s - loss: 0.3182 - accuracy: 0.7891 - 128s/epoch - 457ms/step
Epoch 15/110
Validation cm: [[546  57  21   3]
 [503 118  13  21]
 [102  11  47  41]
 [ 59  11  33  12]]
Validation val_loss: 0.5644999545181778
Validation normalized_cm: [[0.871 0.091 0.033 0.005]
 [0.768 0.18  0.02  0.032]
 [0.507 0.055 0.234 0.204]
 [0.513 0.096 0.287 0.104]]
Validation acc: 0.4524405506883605
Validation class_accuracies: [0.8708133971291866, 0.1801526717557252, 0.23383084577114427, 0.10434782608695652]
Validation sensitivity: 0.1822863027806385
Validation specificity: 0.8708133971291866
Validation icbhi_score: 0.5265498499549126
Validation roc_auc: None
Validation avg_accuracy: 0.34728618518575316
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 4 epochs
There is no such attribute
280/280 - 128s - loss: 0.3030 - accuracy: 0.7911 - 128s/epoch - 456ms/step
Epoch 16/110
Validation cm: [[342 141  87  57]
 [278 251  69  57]
 [ 54  33  52  62]
 [ 21  29  27  38]]
Validation val_loss: 0.6389726773405608
Validation normalized_cm: [[0.545 0.225 0.139 0.091]
 [0.424 0.383 0.105 0.087]
 [0.269 0.164 0.259 0.308]
 [0.183 0.252 0.235 0.33 ]]
Validation acc: 0.42740926157697123
Validation class_accuracies: [0.5454545454545454, 0.383206106870229, 0.25870646766169153, 0.33043478260869563]
Validation sensitivity: 0.35118434603501547
Validation specificity: 0.5454545454545454
Validation icbhi_score: 0.44831944574478044
Validation roc_auc: None
Validation avg_accuracy: 0.3794504756487904
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
280/280 - 128s - loss: 0.2856 - accuracy: 0.7878 - 128s/epoch - 456ms/step
Epoch 17/110
Validation cm: [[559  55  11   2]
 [480 151  16   8]
 [100  20  58  23]
 [ 56   9  31  19]]
Validation val_loss: 0.5946418688450713
Validation normalized_cm: [[0.892 0.088 0.018 0.003]
 [0.733 0.231 0.024 0.012]
 [0.498 0.1   0.289 0.114]
 [0.487 0.078 0.27  0.165]]
Validation acc: 0.4924906132665832
Validation class_accuracies: [0.8915470494417863, 0.23053435114503817, 0.2885572139303483, 0.16521739130434782]
Validation sensitivity: 0.23480947476828012
Validation specificity: 0.8915470494417863
Validation icbhi_score: 0.5631782621050332
Validation roc_auc: None
Validation avg_accuracy: 0.39396400145538013
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 6 epochs
There is no such attribute
280/280 - 127s - loss: 0.2515 - accuracy: 0.8079 - 127s/epoch - 454ms/step
Epoch 18/110
Validation cm: [[153 472   1   1]
 [103 551   0   1]
 [ 43 110  17  31]
 [  9  90   4  12]]
Validation val_loss: 0.8038486653381728
Validation normalized_cm: [[0.244 0.753 0.002 0.002]
 [0.157 0.841 0.    0.002]
 [0.214 0.547 0.085 0.154]
 [0.078 0.783 0.035 0.104]]
Validation acc: 0.45869837296620775
Validation class_accuracies: [0.24401913875598086, 0.8412213740458016, 0.0845771144278607, 0.10434782608695652]
Validation sensitivity: 0.5973223480947477
Validation specificity: 0.24401913875598086
Validation icbhi_score: 0.42067074342536426
Validation roc_auc: None
Validation avg_accuracy: 0.3185413633291499
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 7 epochs
There is no such attribute
280/280 - 127s - loss: 0.2378 - accuracy: 0.7987 - 127s/epoch - 455ms/step
Epoch 19/110
Validation cm: [[427  71  82  47]
 [306 169  87  93]
 [ 39   7  88  67]
 [ 23   8  47  37]]
Validation val_loss: 0.7105479498785188
Validation normalized_cm: [[0.681 0.113 0.131 0.075]
 [0.467 0.258 0.133 0.142]
 [0.194 0.035 0.438 0.333]
 [0.2   0.07  0.409 0.322]]
Validation acc: 0.45118898623279097
Validation class_accuracies: [0.6810207336523126, 0.2580152671755725, 0.43781094527363185, 0.3217391304347826]
Validation sensitivity: 0.3027806385169928
Validation specificity: 0.6810207336523126
Validation icbhi_score: 0.4919006860846527
Validation roc_auc: None
Validation avg_accuracy: 0.42464651913407486
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 8 epochs
There is no such attribute
280/280 - 128s - loss: 0.2288 - accuracy: 0.8117 - 128s/epoch - 456ms/step
Epoch 20/110
Validation cm: [[500 124   3   0]
 [414 239   0   2]
 [113  39  29  20]
 [ 59  37   9  10]]
Validation val_loss: 0.7182584479113152
Validation normalized_cm: [[0.797 0.198 0.005 0.   ]
 [0.632 0.365 0.    0.003]
 [0.562 0.194 0.144 0.1  ]
 [0.513 0.322 0.078 0.087]]
Validation acc: 0.48685857321652065
Validation class_accuracies: [0.7974481658692185, 0.3648854961832061, 0.14427860696517414, 0.08695652173913043]
Validation sensitivity: 0.286302780638517
Validation specificity: 0.7974481658692185
Validation icbhi_score: 0.5418754732538678
Validation roc_auc: None
Validation avg_accuracy: 0.3483921976891823
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 9 epochs
There is no such attribute
280/280 - 127s - loss: 0.2269 - accuracy: 0.8066 - 127s/epoch - 454ms/step
Epoch 21/110
Validation cm: [[529  74  23   1]
 [385 230  21  19]
 [ 89  11  60  41]
 [ 55  11  34  15]]
Validation val_loss: 0.682083634350397
Validation normalized_cm: [[0.844 0.118 0.037 0.002]
 [0.588 0.351 0.032 0.029]
 [0.443 0.055 0.299 0.204]
 [0.478 0.096 0.296 0.13 ]]
Validation acc: 0.5219023779724656
Validation class_accuracies: [0.8437001594896332, 0.3511450381679389, 0.29850746268656714, 0.13043478260869565]
Validation sensitivity: 0.3141091658084449
Validation specificity: 0.8437001594896332
Validation icbhi_score: 0.5789046626490391
Validation roc_auc: None
Validation avg_accuracy: 0.4059468607382087
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
280/280 - 128s - loss: 0.2032 - accuracy: 0.8229 - 128s/epoch - 455ms/step
Epoch 22/110
Validation cm: [[441 135  38  13]
 [287 299  24  45]
 [ 45  24  63  69]
 [ 23  31  15  46]]
Validation val_loss: 0.606965562327221
Validation normalized_cm: [[0.703 0.215 0.061 0.021]
 [0.438 0.456 0.037 0.069]
 [0.224 0.119 0.313 0.343]
 [0.2   0.27  0.13  0.4  ]]
Validation acc: 0.5312891113892365
Validation class_accuracies: [0.7033492822966507, 0.45648854961832064, 0.31343283582089554, 0.4]
Validation sensitivity: 0.42018537590113286
Validation specificity: 0.7033492822966507
Validation icbhi_score: 0.5617673290988918
Validation roc_auc: None
Validation avg_accuracy: 0.4683176669339667
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 11 epochs
There is no such attribute
280/280 - 128s - loss: 0.1936 - accuracy: 0.8207 - 128s/epoch - 457ms/step
Epoch 23/110
Validation cm: [[468 104  43  12]
 [295 293  25  42]
 [ 47  18  83  53]
 [ 36  14  34  31]]
Validation val_loss: 0.6191647933350457
Validation normalized_cm: [[0.746 0.166 0.069 0.019]
 [0.45  0.447 0.038 0.064]
 [0.234 0.09  0.413 0.264]
 [0.313 0.122 0.296 0.27 ]]
Validation acc: 0.5475594493116396
Validation class_accuracies: [0.7464114832535885, 0.44732824427480916, 0.4129353233830846, 0.26956521739130435]
Validation sensitivity: 0.4191555097837281
Validation specificity: 0.7464114832535885
Validation icbhi_score: 0.5827834965186584
Validation roc_auc: None
Validation avg_accuracy: 0.46906006707569664
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5879968857637023 hasn't increased by 0 in 12 epochs
There is no such attribute
280/280 - 128s - loss: 0.1920 - accuracy: 0.8176 - 128s/epoch - 458ms/step
Epoch 24/110
Validation cm: [[540  65  22   0]
 [390 244   7  14]
 [ 75  24  59  43]
 [ 47  23  19  26]]
Validation val_loss: 0.6253438849690088
Validation normalized_cm: [[0.861 0.104 0.035 0.   ]
 [0.595 0.373 0.011 0.021]
 [0.373 0.119 0.294 0.214]
 [0.409 0.2   0.165 0.226]]
Validation acc: 0.5438047559449312
Validation class_accuracies: [0.861244019138756, 0.37251908396946565, 0.2935323383084577, 0.22608695652173913]
Validation sensitivity: 0.3388259526261586
Validation specificity: 0.861244019138756
Validation icbhi_score: 0.6000349858824573
Validation roc_auc: None
Validation avg_accuracy: 0.4383455994846046
Validation one_indexed_epoch: 24
-- New best results were achieved. --
There is no such attribute
280/280 - 128s - loss: 0.1787 - accuracy: 0.8220 - 128s/epoch - 457ms/step
Epoch 25/110
Validation cm: [[379 236   7   5]
 [253 381   4  17]
 [ 56  51  27  67]
 [ 24  41  11  39]]
Validation val_loss: 0.663612114311202
Validation normalized_cm: [[0.604 0.376 0.011 0.008]
 [0.386 0.582 0.006 0.026]
 [0.279 0.254 0.134 0.333]
 [0.209 0.357 0.096 0.339]]
Validation acc: 0.5168961201501877
Validation class_accuracies: [0.6044657097288676, 0.5816793893129771, 0.13432835820895522, 0.3391304347826087]
Validation sensitivity: 0.4603501544799176
Validation specificity: 0.6044657097288676
Validation icbhi_score: 0.5324079321043926
Validation roc_auc: None
Validation avg_accuracy: 0.41490097300835216
Validation one_indexed_epoch: 25
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 128s - loss: 0.1757 - accuracy: 0.8164 - 128s/epoch - 458ms/step
Epoch 26/110
Validation cm: [[474 113  34   6]
 [338 269  23  25]
 [ 50  25  75  51]
 [ 38  22  24  31]]
Validation val_loss: 0.6261129713393541
Validation normalized_cm: [[0.756 0.18  0.054 0.01 ]
 [0.516 0.411 0.035 0.038]
 [0.249 0.124 0.373 0.254]
 [0.33  0.191 0.209 0.27 ]]
Validation acc: 0.5312891113892365
Validation class_accuracies: [0.7559808612440191, 0.41068702290076337, 0.373134328358209, 0.26956521739130435]
Validation sensitivity: 0.3861997940267765
Validation specificity: 0.7559808612440191
Validation icbhi_score: 0.5710903276353978
Validation roc_auc: None
Validation avg_accuracy: 0.4523418574735739
Validation one_indexed_epoch: 26
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 128s - loss: 0.1762 - accuracy: 0.8238 - 128s/epoch - 458ms/step
Epoch 27/110
Validation cm: [[559  13  52   3]
 [506  86  43  20]
 [ 68   4  99  30]
 [ 50   4  51  10]]
Validation val_loss: 0.7899123770651788
Validation normalized_cm: [[0.892 0.021 0.083 0.005]
 [0.773 0.131 0.066 0.031]
 [0.338 0.02  0.493 0.149]
 [0.435 0.035 0.443 0.087]]
Validation acc: 0.4718397997496871
Validation class_accuracies: [0.8915470494417863, 0.13129770992366413, 0.4925373134328358, 0.08695652173913043]
Validation sensitivity: 0.2008238928939238
Validation specificity: 0.8915470494417863
Validation icbhi_score: 0.5461854711678551
Validation roc_auc: None
Validation avg_accuracy: 0.40058464863435417
Validation one_indexed_epoch: 27
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 3 epochs
There is no such attribute
280/280 - 128s - loss: 0.1793 - accuracy: 0.8234 - 128s/epoch - 458ms/step
Epoch 28/110
Validation cm: [[541  23  53  10]
 [495  94  34  32]
 [ 69   4  93  35]
 [ 45   4  44  22]]
Validation val_loss: 0.74677690075777
Validation normalized_cm: [[0.863 0.037 0.085 0.016]
 [0.756 0.144 0.052 0.049]
 [0.343 0.02  0.463 0.174]
 [0.391 0.035 0.383 0.191]]
Validation acc: 0.4693366708385482
Validation class_accuracies: [0.8628389154704944, 0.1435114503816794, 0.4626865671641791, 0.19130434782608696]
Validation sensitivity: 0.21524201853759012
Validation specificity: 0.8628389154704944
Validation icbhi_score: 0.5390404670040423
Validation roc_auc: None
Validation avg_accuracy: 0.41508532021060995
Validation one_indexed_epoch: 28
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 4 epochs
There is no such attribute
280/280 - 128s - loss: 0.1690 - accuracy: 0.8189 - 128s/epoch - 458ms/step
Epoch 29/110
Validation cm: [[525  68  25   9]
 [360 242  13  40]
 [ 71  20  60  50]
 [ 45  12  22  36]]
Validation val_loss: 0.6159471597195434
Validation normalized_cm: [[0.837 0.108 0.04  0.014]
 [0.55  0.369 0.02  0.061]
 [0.353 0.1   0.299 0.249]
 [0.391 0.104 0.191 0.313]]
Validation acc: 0.5400500625782227
Validation class_accuracies: [0.8373205741626795, 0.36946564885496186, 0.29850746268656714, 0.3130434782608696]
Validation sensitivity: 0.34809474768280124
Validation specificity: 0.8373205741626795
Validation icbhi_score: 0.5927076609227404
Validation roc_auc: None
Validation avg_accuracy: 0.4545842909912695
Validation one_indexed_epoch: 29
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
280/280 - 128s - loss: 0.1660 - accuracy: 0.8200 - 128s/epoch - 459ms/step
Epoch 30/110
Validation cm: [[373 239  10   5]
 [213 392   6  44]
 [ 40  47  24  90]
 [ 13  47  12  43]]
Validation val_loss: 0.6866522098700605
Validation normalized_cm: [[0.595 0.381 0.016 0.008]
 [0.325 0.598 0.009 0.067]
 [0.199 0.234 0.119 0.448]
 [0.113 0.409 0.104 0.374]]
Validation acc: 0.5206508135168961
Validation class_accuracies: [0.594896331738437, 0.5984732824427481, 0.11940298507462686, 0.3739130434782609]
Validation sensitivity: 0.4727085478887745
Validation specificity: 0.594896331738437
Validation icbhi_score: 0.5338024398136058
Validation roc_auc: None
Validation avg_accuracy: 0.4216714106835182
Validation one_indexed_epoch: 30
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 6 epochs
There is no such attribute
280/280 - 130s - loss: 0.1600 - accuracy: 0.8223 - 130s/epoch - 463ms/step
Epoch 31/110
Validation cm: [[497  50  64  16]
 [380 174  52  49]
 [ 45   9  96  51]
 [ 35   9  42  29]]
Validation val_loss: 0.7458677887641554
Validation normalized_cm: [[0.793 0.08  0.102 0.026]
 [0.58  0.266 0.079 0.075]
 [0.224 0.045 0.478 0.254]
 [0.304 0.078 0.365 0.252]]
Validation acc: 0.4981226533166458
Validation class_accuracies: [0.7926634768740032, 0.26564885496183205, 0.47761194029850745, 0.25217391304347825]
Validation sensitivity: 0.3079299691040165
Validation specificity: 0.7926634768740032
Validation icbhi_score: 0.5502967229890099
Validation roc_auc: None
Validation avg_accuracy: 0.4470245462944552
Validation one_indexed_epoch: 31
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
280/280 - 128s - loss: 0.1552 - accuracy: 0.8218 - 128s/epoch - 459ms/step
Epoch 32/110
Validation cm: [[508  93  20   6]
 [348 262  15  30]
 [ 68  25  58  50]
 [ 45  17  26  27]]
Validation val_loss: 0.6746157050342998
Validation normalized_cm: [[0.81  0.148 0.032 0.01 ]
 [0.531 0.4   0.023 0.046]
 [0.338 0.124 0.289 0.249]
 [0.391 0.148 0.226 0.235]]
Validation acc: 0.5350438047559449
Validation class_accuracies: [0.810207336523126, 0.4, 0.2885572139303483, 0.23478260869565218]
Validation sensitivity: 0.3573635427394439
Validation specificity: 0.810207336523126
Validation icbhi_score: 0.5837854396312849
Validation roc_auc: None
Validation avg_accuracy: 0.4333867897872816
Validation one_indexed_epoch: 32
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 8 epochs
There is no such attribute
280/280 - 128s - loss: 0.1552 - accuracy: 0.8214 - 128s/epoch - 459ms/step
Epoch 33/110
Validation cm: [[416 184  15  12]
 [239 343  14  59]
 [ 40  38  40  83]
 [ 23  34  19  39]]
Validation val_loss: 0.689322406579186
Validation normalized_cm: [[0.663 0.293 0.024 0.019]
 [0.365 0.524 0.021 0.09 ]
 [0.199 0.189 0.199 0.413]
 [0.2   0.296 0.165 0.339]]
Validation acc: 0.5244055068836045
Validation class_accuracies: [0.6634768740031898, 0.5236641221374045, 0.19900497512437812, 0.3391304347826087]
Validation sensitivity: 0.43460350154479915
Validation specificity: 0.6634768740031898
Validation icbhi_score: 0.5490401877739944
Validation roc_auc: None
Validation avg_accuracy: 0.4313191015118953
Validation one_indexed_epoch: 33
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 9 epochs
There is no such attribute
280/280 - 128s - loss: 0.1476 - accuracy: 0.8234 - 128s/epoch - 457ms/step
Epoch 34/110
Validation cm: [[463 111  42  11]
 [286 271  33  65]
 [ 54  16  72  59]
 [ 35  13  38  29]]
Validation val_loss: 0.7041403497040185
Validation normalized_cm: [[0.738 0.177 0.067 0.018]
 [0.437 0.414 0.05  0.099]
 [0.269 0.08  0.358 0.294]
 [0.304 0.113 0.33  0.252]]
Validation acc: 0.5225281602002503
Validation class_accuracies: [0.7384370015948963, 0.41374045801526715, 0.3582089552238806, 0.25217391304347825]
Validation sensitivity: 0.3831101956745623
Validation specificity: 0.7384370015948963
Validation icbhi_score: 0.5607735986347293
Validation roc_auc: None
Validation avg_accuracy: 0.44064008196938054
Validation one_indexed_epoch: 34
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
280/280 - 128s - loss: 0.1549 - accuracy: 0.8227 - 128s/epoch - 458ms/step
Epoch 35/110
Validation cm: [[445 141  32   9]
 [299 288  17  51]
 [ 46  25  59  71]
 [ 24  25  25  41]]
Validation val_loss: 0.6841340793275623
Validation normalized_cm: [[0.71  0.225 0.051 0.014]
 [0.456 0.44  0.026 0.078]
 [0.229 0.124 0.294 0.353]
 [0.209 0.217 0.217 0.357]]
Validation acc: 0.5212765957446809
Validation class_accuracies: [0.7097288676236044, 0.4396946564885496, 0.2935323383084577, 0.3565217391304348]
Validation sensitivity: 0.3995880535530381
Validation specificity: 0.7097288676236044
Validation icbhi_score: 0.5546584605883212
Validation roc_auc: None
Validation avg_accuracy: 0.44986940038776163
Validation one_indexed_epoch: 35
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 11 epochs
There is no such attribute
280/280 - 128s - loss: 0.1470 - accuracy: 0.8227 - 128s/epoch - 458ms/step
Epoch 36/110
Validation cm: [[491  96  30  10]
 [334 265  20  36]
 [ 58  22  62  59]
 [ 36  19  29  31]]
Validation val_loss: 0.6794702860153053
Validation normalized_cm: [[0.783 0.153 0.048 0.016]
 [0.51  0.405 0.031 0.055]
 [0.289 0.109 0.308 0.294]
 [0.313 0.165 0.252 0.27 ]]
Validation acc: 0.5312891113892365
Validation class_accuracies: [0.7830940988835726, 0.40458015267175573, 0.30845771144278605, 0.26956521739130435]
Validation sensitivity: 0.368692070030896
Validation specificity: 0.7830940988835726
Validation icbhi_score: 0.5758930844572343
Validation roc_auc: None
Validation avg_accuracy: 0.4414242950973547
Validation one_indexed_epoch: 36
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 12 epochs
There is no such attribute
280/280 - 128s - loss: 0.1477 - accuracy: 0.8281 - 128s/epoch - 457ms/step
Epoch 37/110
Validation cm: [[496  94  30   7]
 [350 251  18  36]
 [ 58  22  64  57]
 [ 39  17  25  34]]
Validation val_loss: 0.7184569117747474
Validation normalized_cm: [[0.791 0.15  0.048 0.011]
 [0.534 0.383 0.027 0.055]
 [0.289 0.109 0.318 0.284]
 [0.339 0.148 0.217 0.296]]
Validation acc: 0.5287859824780976
Validation class_accuracies: [0.7910685805422647, 0.383206106870229, 0.31840796019900497, 0.2956521739130435]
Validation sensitivity: 0.35942327497425336
Validation specificity: 0.7910685805422647
Validation icbhi_score: 0.575245927758259
Validation roc_auc: None
Validation avg_accuracy: 0.4470837053811355
Validation one_indexed_epoch: 37
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 13 epochs
There is no such attribute
280/280 - 128s - loss: 0.1418 - accuracy: 0.8176 - 128s/epoch - 457ms/step
Epoch 38/110
Validation cm: [[404 198  17   8]
 [253 348  12  42]
 [ 48  39  40  74]
 [ 26  35  15  39]]
Validation val_loss: 0.6970369734174691
Validation normalized_cm: [[0.644 0.316 0.027 0.013]
 [0.386 0.531 0.018 0.064]
 [0.239 0.194 0.199 0.368]
 [0.226 0.304 0.13  0.339]]
Validation acc: 0.5200250312891114
Validation class_accuracies: [0.6443381180223285, 0.5312977099236641, 0.19900497512437812, 0.3391304347826087]
Validation sensitivity: 0.43975283213182287
Validation specificity: 0.6443381180223285
Validation icbhi_score: 0.5420454750770757
Validation roc_auc: None
Validation avg_accuracy: 0.42844280946324487
Validation one_indexed_epoch: 38
The validation tracker metric at 0.6000349858824573 hasn't increased by 0 in 14 epochs
There is no such attribute
280/280 - 128s - loss: 0.1464 - accuracy: 0.8317 - 128s/epoch - 458ms/step
Epoch 39/110
Validation cm: [[501  89  31   6]
 [338 261  20  36]
 [ 56  21  67  57]
 [ 35  19  30  31]]
Validation val_loss: 0.719788523073825
Validation normalized_cm: [[0.799 0.142 0.049 0.01 ]
 [0.516 0.398 0.031 0.055]
 [0.279 0.104 0.333 0.284]
 [0.304 0.165 0.261 0.27 ]]
Validation acc: 0.5381727158948686
Validation class_accuracies: [0.7990430622009569, 0.3984732824427481, 0.3333333333333333, 0.26956521739130435]
Validation sensitivity: 0.36972193614830073
Validation specificity: 0.7990430622009569
Validation icbhi_score: 0.5843824991746288
Validation roc_auc: None
Validation avg_accuracy: 0.45010372384208563
Validation one_indexed_epoch: 39
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
280/280 - 129s - loss: 0.1422 - accuracy: 0.8281 - 129s/epoch - 462ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.6000349858824573
Best cm: [[540  65  22   0]
 [390 244   7  14]
 [ 75  24  59  43]
 [ 47  23  19  26]]
Best val_loss: 0.6253438849690088
Best normalized_cm: [[0.861 0.104 0.035 0.   ]
 [0.595 0.373 0.011 0.021]
 [0.373 0.119 0.294 0.214]
 [0.409 0.2   0.165 0.226]]
Best acc: 0.5438047559449312
Best class_accuracies: [0.861244019138756, 0.37251908396946565, 0.2935323383084577, 0.22608695652173913]
Best sensitivity: 0.3388259526261586
Best specificity: 0.861244019138756
Best roc_auc: None
Best avg_accuracy: 0.4383455994846046
Best one_indexed_epoch: 24
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6964635848999023, 0.6686182022094727, 0.6302061080932617, 0.5875107645988464, 0.5531532168388367, 0.5184962153434753, 0.49768999218940735, 0.46888384222984314, 0.444024920463562, 0.4223032295703888, 0.39729273319244385, 0.3720499575138092, 0.34641245007514954, 0.318155437707901, 0.30298173427581787, 0.2856326699256897, 0.25147390365600586, 0.2377907782793045, 0.22877325117588043, 0.22685153782367706, 0.20318949222564697, 0.19364885985851288, 0.1920352727174759, 0.1787334382534027, 0.17566916346549988, 0.17619507014751434, 0.17928446829319, 0.16904467344284058, 0.16595439612865448, 0.16000871360301971, 0.1552203893661499, 0.15522758662700653, 0.14764441549777985, 0.15488962829113007, 0.14702093601226807, 0.14770978689193726, 0.14178942143917084, 0.14642168581485748, 0.14215382933616638], 'accuracy': [0.4819789528846741, 0.5554063320159912, 0.5735393166542053, 0.6375643610954285, 0.6935303211212158, 0.6971121430397034, 0.7172598838806152, 0.7342735528945923, 0.741213321685791, 0.7629281282424927, 0.7586747407913208, 0.7694202065467834, 0.7799417972564697, 0.7891201972961426, 0.7911350131034851, 0.7877770066261292, 0.8079248070716858, 0.7987463474273682, 0.8117304444313049, 0.8065816164016724, 0.8229236602783203, 0.8206850290298462, 0.8175509572029114, 0.8220282196998596, 0.8164315819740295, 0.823819100856781, 0.823371410369873, 0.81889408826828, 0.8200134038925171, 0.822252094745636, 0.8218043446540833, 0.8213565945625305, 0.823371410369873, 0.822699785232544, 0.822699785232544, 0.8280725479125977, 0.8175509572029114, 0.8316543698310852, 0.8280725479125977]}
End
####################################
Job id is 6.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4630 elements, with 2232 none's, 1328 crakles, 563 wheezes and 507 both ---
--- Final Validation dataset contains 1435 elements, with 646 none, 506 crackles, 154 wheezes and 129 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5185931899641577, 1: 0.8716114457831325, 2: 2.05595026642984, 3: 2.2830374753451674}
Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_4   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_12 (Dense)            (None, 100)               128100    
                                                                 
 dropout_8 (Dropout)         (None, 100)               0         
                                                                 
 dense_13 (Dense)            (None, 50)                5050      
                                                                 
 dropout_9 (Dropout)         (None, 50)                0         
                                                                 
 dense_14 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_4"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_8 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_9 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_4 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[287  49 277  33]
 [134  31 313  28]
 [ 46   7  86  15]
 [ 40   6  77   6]]
Validation val_loss: 0.7014482491730812
Validation normalized_cm: [[0.444 0.076 0.429 0.051]
 [0.265 0.061 0.619 0.055]
 [0.299 0.045 0.558 0.097]
 [0.31  0.047 0.597 0.047]]
Validation acc: 0.2857142857142857
Validation class_accuracies: [0.44427244582043346, 0.06126482213438735, 0.5584415584415584, 0.046511627906976744]
Validation sensitivity: 0.155893536121673
Validation specificity: 0.44427244582043346
Validation icbhi_score: 0.30008299097105323
Validation roc_auc: None
Validation avg_accuracy: 0.277622613575839
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
290/290 - 132s - loss: 0.6981 - accuracy: 0.5175 - 132s/epoch - 456ms/step
Epoch 2/110
Validation cm: [[292 115 137 102]
 [200 135  80  91]
 [ 56  11  47  40]
 [ 84   9  22  14]]
Validation val_loss: 0.6833348030620335
Validation normalized_cm: [[0.452 0.178 0.212 0.158]
 [0.395 0.267 0.158 0.18 ]
 [0.364 0.071 0.305 0.26 ]
 [0.651 0.07  0.171 0.109]]
Validation acc: 0.3400696864111498
Validation class_accuracies: [0.4520123839009288, 0.26679841897233203, 0.3051948051948052, 0.10852713178294573]
Validation sensitivity: 0.24841571609632446
Validation specificity: 0.4520123839009288
Validation icbhi_score: 0.3502140499986266
Validation roc_auc: None
Validation avg_accuracy: 0.2831331849627529
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
290/290 - 118s - loss: 0.6710 - accuracy: 0.5488 - 118s/epoch - 407ms/step
Epoch 3/110
Validation cm: [[469 177   0   0]
 [401 104   1   0]
 [112  38   2   2]
 [116  11   2   0]]
Validation val_loss: 0.6358629855960088
Validation normalized_cm: [[0.726 0.274 0.    0.   ]
 [0.792 0.206 0.002 0.   ]
 [0.727 0.247 0.013 0.013]
 [0.899 0.085 0.016 0.   ]]
Validation acc: 0.40069686411149824
Validation class_accuracies: [0.7260061919504643, 0.20553359683794467, 0.012987012987012988, 0.0]
Validation sensitivity: 0.13434727503168567
Validation specificity: 0.7260061919504643
Validation icbhi_score: 0.430176733491075
Validation roc_auc: None
Validation avg_accuracy: 0.2361317004438555
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
290/290 - 119s - loss: 0.6306 - accuracy: 0.5629 - 119s/epoch - 411ms/step
Epoch 4/110
Validation cm: [[433 168  26  19]
 [259 177  42  28]
 [ 50  22  32  50]
 [ 55  18  45  11]]
Validation val_loss: 0.6124183095290686
Validation normalized_cm: [[0.67  0.26  0.04  0.029]
 [0.512 0.35  0.083 0.055]
 [0.325 0.143 0.208 0.325]
 [0.426 0.14  0.349 0.085]]
Validation acc: 0.45505226480836236
Validation class_accuracies: [0.6702786377708978, 0.34980237154150196, 0.2077922077922078, 0.08527131782945736]
Validation sensitivity: 0.2788339670468948
Validation specificity: 0.6702786377708978
Validation icbhi_score: 0.4745563024088963
Validation roc_auc: None
Validation avg_accuracy: 0.3282861337335162
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
290/290 - 119s - loss: 0.5852 - accuracy: 0.6244 - 119s/epoch - 411ms/step
Epoch 5/110
Validation cm: [[486  99  38  23]
 [257 141  43  65]
 [ 48   6  50  50]
 [ 76   5  41   7]]
Validation val_loss: 0.5914853492680326
Validation normalized_cm: [[0.752 0.153 0.059 0.036]
 [0.508 0.279 0.085 0.128]
 [0.312 0.039 0.325 0.325]
 [0.589 0.039 0.318 0.054]]
Validation acc: 0.47665505226480837
Validation class_accuracies: [0.7523219814241486, 0.27865612648221344, 0.3246753246753247, 0.05426356589147287]
Validation sensitivity: 0.2509505703422053
Validation specificity: 0.7523219814241486
Validation icbhi_score: 0.5016362758831769
Validation roc_auc: None
Validation avg_accuracy: 0.3524792496182899
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
290/290 - 119s - loss: 0.5456 - accuracy: 0.6989 - 119s/epoch - 410ms/step
Epoch 6/110
Validation cm: [[499  16 110  21]
 [272  46 150  38]
 [ 32   0  81  41]
 [ 47   2  74   6]]
Validation val_loss: 0.6486430105328145
Validation normalized_cm: [[0.772 0.025 0.17  0.033]
 [0.538 0.091 0.296 0.075]
 [0.208 0.    0.526 0.266]
 [0.364 0.016 0.574 0.047]]
Validation acc: 0.44041811846689893
Validation class_accuracies: [0.7724458204334366, 0.09090909090909091, 0.525974025974026, 0.046511627906976744]
Validation sensitivity: 0.16856780735107732
Validation specificity: 0.7724458204334366
Validation icbhi_score: 0.47050681389225696
Validation roc_auc: None
Validation avg_accuracy: 0.3589601413058826
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5016362758831769 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 119s - loss: 0.5033 - accuracy: 0.7356 - 119s/epoch - 410ms/step
Epoch 7/110
Validation cm: [[467  83  51  45]
 [232 128  53  93]
 [ 36   7  56  55]
 [ 61   5  52  11]]
Validation val_loss: 0.6104955075561792
Validation normalized_cm: [[0.723 0.128 0.079 0.07 ]
 [0.458 0.253 0.105 0.184]
 [0.234 0.045 0.364 0.357]
 [0.473 0.039 0.403 0.085]]
Validation acc: 0.46132404181184666
Validation class_accuracies: [0.7229102167182663, 0.25296442687747034, 0.36363636363636365, 0.08527131782945736]
Validation sensitivity: 0.24714828897338403
Validation specificity: 0.7229102167182663
Validation icbhi_score: 0.48502925284582515
Validation roc_auc: None
Validation avg_accuracy: 0.35619558126538936
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5016362758831769 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 119s - loss: 0.4878 - accuracy: 0.7603 - 119s/epoch - 411ms/step
Epoch 8/110
Validation cm: [[430 151  25  40]
 [209 225  23  49]
 [ 33   9  47  65]
 [ 56  10  42  21]]
Validation val_loss: 0.5569930792529824
Validation normalized_cm: [[0.666 0.234 0.039 0.062]
 [0.413 0.445 0.045 0.097]
 [0.214 0.058 0.305 0.422]
 [0.434 0.078 0.326 0.163]]
Validation acc: 0.5038327526132405
Validation class_accuracies: [0.6656346749226006, 0.44466403162055335, 0.3051948051948052, 0.16279069767441862]
Validation sensitivity: 0.37135614702154623
Validation specificity: 0.6656346749226006
Validation icbhi_score: 0.5184954109720734
Validation roc_auc: None
Validation avg_accuracy: 0.3945710523530945
Validation one_indexed_epoch: 8
-- New best results were achieved. --
There is no such attribute
290/290 - 120s - loss: 0.4611 - accuracy: 0.7665 - 120s/epoch - 412ms/step
Epoch 9/110
Validation cm: [[317 302  14  13]
 [122 360   5  19]
 [ 36  42  25  51]
 [ 58  27  32  12]]
Validation val_loss: 0.555418097126567
Validation normalized_cm: [[0.491 0.467 0.022 0.02 ]
 [0.241 0.711 0.01  0.038]
 [0.234 0.273 0.162 0.331]
 [0.45  0.209 0.248 0.093]]
Validation acc: 0.4975609756097561
Validation class_accuracies: [0.4907120743034056, 0.7114624505928854, 0.16233766233766234, 0.09302325581395349]
Validation sensitivity: 0.5031685678073511
Validation specificity: 0.4907120743034056
Validation icbhi_score: 0.49694032105537833
Validation roc_auc: None
Validation avg_accuracy: 0.36438386076197665
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5184954109720734 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 119s - loss: 0.4413 - accuracy: 0.7769 - 119s/epoch - 410ms/step
Epoch 10/110
Validation cm: [[298 301  22  25]
 [110 358  11  27]
 [ 30  29  28  67]
 [ 34  28  55  12]]
Validation val_loss: 0.5766441422446472
Validation normalized_cm: [[0.461 0.466 0.034 0.039]
 [0.217 0.708 0.022 0.053]
 [0.195 0.188 0.182 0.435]
 [0.264 0.217 0.426 0.093]]
Validation acc: 0.48501742160278744
Validation class_accuracies: [0.4613003095975232, 0.7075098814229249, 0.18181818181818182, 0.09302325581395349]
Validation sensitivity: 0.5044359949302915
Validation specificity: 0.4613003095975232
Validation icbhi_score: 0.48286815226390734
Validation roc_auc: None
Validation avg_accuracy: 0.36091290716314584
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5184954109720734 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 120s - loss: 0.4118 - accuracy: 0.7940 - 120s/epoch - 413ms/step
Epoch 11/110
Validation cm: [[393 212  19  22]
 [168 285   9  44]
 [ 33  15  45  61]
 [ 60  14  46   9]]
Validation val_loss: 0.5607370012533893
Validation normalized_cm: [[0.608 0.328 0.029 0.034]
 [0.332 0.563 0.018 0.087]
 [0.214 0.097 0.292 0.396]
 [0.465 0.109 0.357 0.07 ]]
Validation acc: 0.5101045296167247
Validation class_accuracies: [0.608359133126935, 0.5632411067193676, 0.2922077922077922, 0.06976744186046512]
Validation sensitivity: 0.4296577946768061
Validation specificity: 0.608359133126935
Validation icbhi_score: 0.5190084639018706
Validation roc_auc: None
Validation avg_accuracy: 0.38339386847863993
Validation one_indexed_epoch: 11
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
290/290 - 120s - loss: 0.3992 - accuracy: 0.7866 - 120s/epoch - 412ms/step
Epoch 12/110
Validation cm: [[607  11  27   1]
 [453  19  26   8]
 [ 56   1  61  36]
 [ 89   0  40   0]]
Validation val_loss: 0.5845604417267992
Validation normalized_cm: [[0.94  0.017 0.042 0.002]
 [0.895 0.038 0.051 0.016]
 [0.364 0.006 0.396 0.234]
 [0.69  0.    0.31  0.   ]]
Validation acc: 0.47874564459930313
Validation class_accuracies: [0.9396284829721362, 0.037549407114624504, 0.3961038961038961, 0.0]
Validation sensitivity: 0.10139416983523447
Validation specificity: 0.9396284829721362
Validation icbhi_score: 0.5205113264036854
Validation roc_auc: None
Validation avg_accuracy: 0.3433204465476642
Validation one_indexed_epoch: 12
-- New best results were achieved. --
There is no such attribute
290/290 - 119s - loss: 0.3649 - accuracy: 0.8024 - 119s/epoch - 411ms/step
Epoch 13/110
Validation cm: [[510 121   5  10]
 [302 187   7  10]
 [ 44  26  33  51]
 [ 85  16  20   8]]
Validation val_loss: 0.559195876465007
Validation normalized_cm: [[0.789 0.187 0.008 0.015]
 [0.597 0.37  0.014 0.02 ]
 [0.286 0.169 0.214 0.331]
 [0.659 0.124 0.155 0.062]]
Validation acc: 0.5142857142857142
Validation class_accuracies: [0.7894736842105263, 0.3695652173913043, 0.21428571428571427, 0.06201550387596899]
Validation sensitivity: 0.2889733840304182
Validation specificity: 0.7894736842105263
Validation icbhi_score: 0.5392235341204723
Validation roc_auc: None
Validation avg_accuracy: 0.35883502994087846
Validation one_indexed_epoch: 13
-- New best results were achieved. --
There is no such attribute
290/290 - 120s - loss: 0.3403 - accuracy: 0.8039 - 120s/epoch - 413ms/step
Epoch 14/110
Validation cm: [[557  55  24  10]
 [364  70  47  25]
 [ 43  13  70  28]
 [ 83   2  42   2]]
Validation val_loss: 0.6159256357040892
Validation normalized_cm: [[0.862 0.085 0.037 0.015]
 [0.719 0.138 0.093 0.049]
 [0.279 0.084 0.455 0.182]
 [0.643 0.016 0.326 0.016]]
Validation acc: 0.4871080139372822
Validation class_accuracies: [0.8622291021671826, 0.1383399209486166, 0.45454545454545453, 0.015503875968992248]
Validation sensitivity: 0.17997465145754118
Validation specificity: 0.8622291021671826
Validation icbhi_score: 0.5211018768123619
Validation roc_auc: None
Validation avg_accuracy: 0.36765458840756154
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5392235341204723 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 120s - loss: 0.3192 - accuracy: 0.8114 - 120s/epoch - 412ms/step
Epoch 15/110
Validation cm: [[394 179  29  44]
 [163 224  14 105]
 [ 27  12  35  80]
 [ 38  15  59  17]]
Validation val_loss: 0.708178244670853
Validation normalized_cm: [[0.61  0.277 0.045 0.068]
 [0.322 0.443 0.028 0.208]
 [0.175 0.078 0.227 0.519]
 [0.295 0.116 0.457 0.132]]
Validation acc: 0.46689895470383275
Validation class_accuracies: [0.6099071207430341, 0.4426877470355731, 0.22727272727272727, 0.13178294573643412]
Validation sensitivity: 0.34980988593155893
Validation specificity: 0.6099071207430341
Validation icbhi_score: 0.4798585033372965
Validation roc_auc: None
Validation avg_accuracy: 0.35291263519694216
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5392235341204723 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 120s - loss: 0.2897 - accuracy: 0.8229 - 120s/epoch - 414ms/step
Epoch 16/110
Validation cm: [[514  69  34  29]
 [315 119  19  53]
 [ 35   2  52  65]
 [ 65   5  50   9]]
Validation val_loss: 0.6061021315823033
Validation normalized_cm: [[0.796 0.107 0.053 0.045]
 [0.623 0.235 0.038 0.105]
 [0.227 0.013 0.338 0.422]
 [0.504 0.039 0.388 0.07 ]]
Validation acc: 0.48362369337979094
Validation class_accuracies: [0.7956656346749226, 0.23517786561264822, 0.33766233766233766, 0.06976744186046512]
Validation sensitivity: 0.22813688212927757
Validation specificity: 0.7956656346749226
Validation icbhi_score: 0.5119012584021001
Validation roc_auc: None
Validation avg_accuracy: 0.35956831995259336
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5392235341204723 hasn't increased by 0 in 3 epochs
There is no such attribute
290/290 - 119s - loss: 0.2645 - accuracy: 0.8244 - 119s/epoch - 411ms/step
Epoch 17/110
Validation cm: [[444 187   7   8]
 [196 290   3  17]
 [ 45  33  42  34]
 [ 71  16  38   4]]
Validation val_loss: 0.6098335490410317
Validation normalized_cm: [[0.687 0.289 0.011 0.012]
 [0.387 0.573 0.006 0.034]
 [0.292 0.214 0.273 0.221]
 [0.55  0.124 0.295 0.031]]
Validation acc: 0.5435540069686411
Validation class_accuracies: [0.6873065015479877, 0.5731225296442688, 0.2727272727272727, 0.031007751937984496]
Validation sensitivity: 0.42585551330798477
Validation specificity: 0.6873065015479877
Validation icbhi_score: 0.5565810074279862
Validation roc_auc: None
Validation avg_accuracy: 0.39104101396437846
Validation one_indexed_epoch: 17
-- New best results were achieved. --
There is no such attribute
290/290 - 120s - loss: 0.2598 - accuracy: 0.8171 - 120s/epoch - 413ms/step
Epoch 18/110
Validation cm: [[564  48  28   6]
 [386  83  27  10]
 [ 56   9  61  28]
 [ 59   6  60   4]]
Validation val_loss: 0.7157980421198635
Validation normalized_cm: [[0.873 0.074 0.043 0.009]
 [0.763 0.164 0.053 0.02 ]
 [0.364 0.058 0.396 0.182]
 [0.457 0.047 0.465 0.031]]
Validation acc: 0.4961672473867596
Validation class_accuracies: [0.8730650154798761, 0.16403162055335968, 0.3961038961038961, 0.031007751937984496]
Validation sensitivity: 0.18757921419518378
Validation specificity: 0.8730650154798761
Validation icbhi_score: 0.53032211483753
Validation roc_auc: None
Validation avg_accuracy: 0.3660520710187791
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 119s - loss: 0.2484 - accuracy: 0.8298 - 119s/epoch - 411ms/step
Epoch 19/110
Validation cm: [[406 204  24  12]
 [168 262  28  48]
 [ 36  25  45  48]
 [ 55  18  46  10]]
Validation val_loss: 0.7955039413697986
Validation normalized_cm: [[0.628 0.316 0.037 0.019]
 [0.332 0.518 0.055 0.095]
 [0.234 0.162 0.292 0.312]
 [0.426 0.14  0.357 0.078]]
Validation acc: 0.5038327526132405
Validation class_accuracies: [0.628482972136223, 0.5177865612648221, 0.2922077922077922, 0.07751937984496124]
Validation sensitivity: 0.4017743979721166
Validation specificity: 0.628482972136223
Validation icbhi_score: 0.5151286850541698
Validation roc_auc: None
Validation avg_accuracy: 0.3789991763634496
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 120s - loss: 0.2234 - accuracy: 0.8281 - 120s/epoch - 414ms/step
Epoch 20/110
Validation cm: [[421 216   5   4]
 [251 248   3   4]
 [ 40  45  37  32]
 [ 67  30  23   9]]
Validation val_loss: 0.6724678981893871
Validation normalized_cm: [[0.652 0.334 0.008 0.006]
 [0.496 0.49  0.006 0.008]
 [0.26  0.292 0.24  0.208]
 [0.519 0.233 0.178 0.07 ]]
Validation acc: 0.49825783972125437
Validation class_accuracies: [0.651702786377709, 0.4901185770750988, 0.24025974025974026, 0.06976744186046512]
Validation sensitivity: 0.3726235741444867
Validation specificity: 0.651702786377709
Validation icbhi_score: 0.5121631802610979
Validation roc_auc: None
Validation avg_accuracy: 0.36296213639325325
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 3 epochs
There is no such attribute
290/290 - 120s - loss: 0.2017 - accuracy: 0.8369 - 120s/epoch - 415ms/step
Epoch 21/110
Validation cm: [[385 239  13   9]
 [171 299  10  26]
 [ 43  33  34  44]
 [ 56  25  43   5]]
Validation val_loss: 0.7428999537276144
Validation normalized_cm: [[0.596 0.37  0.02  0.014]
 [0.338 0.591 0.02  0.051]
 [0.279 0.214 0.221 0.286]
 [0.434 0.194 0.333 0.039]]
Validation acc: 0.5038327526132405
Validation class_accuracies: [0.5959752321981424, 0.5909090909090909, 0.22077922077922077, 0.03875968992248062]
Validation sensitivity: 0.42839036755386567
Validation specificity: 0.5959752321981424
Validation icbhi_score: 0.512182799876004
Validation roc_auc: None
Validation avg_accuracy: 0.3616058084522337
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 4 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
290/290 - 120s - loss: 0.1898 - accuracy: 0.8328 - 120s/epoch - 414ms/step
Epoch 22/110
Validation cm: [[506 114  15  11]
 [305 181   8  12]
 [ 47  14  43  50]
 [ 67  15  39   8]]
Validation val_loss: 0.7462171822534639
Validation normalized_cm: [[0.783 0.176 0.023 0.017]
 [0.603 0.358 0.016 0.024]
 [0.305 0.091 0.279 0.325]
 [0.519 0.116 0.302 0.062]]
Validation acc: 0.5142857142857142
Validation class_accuracies: [0.7832817337461301, 0.3577075098814229, 0.2792207792207792, 0.06201550387596899]
Validation sensitivity: 0.29404309252217997
Validation specificity: 0.7832817337461301
Validation icbhi_score: 0.5386624131341551
Validation roc_auc: None
Validation avg_accuracy: 0.3705563816810753
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
290/290 - 121s - loss: 0.1873 - accuracy: 0.8341 - 121s/epoch - 416ms/step
Epoch 23/110
Validation cm: [[190 429  16  11]
 [ 76 403   4  23]
 [ 23  45  39  47]
 [ 33  35  55   6]]
Validation val_loss: 0.8653253002290797
Validation normalized_cm: [[0.294 0.664 0.025 0.017]
 [0.15  0.796 0.008 0.045]
 [0.149 0.292 0.253 0.305]
 [0.256 0.271 0.426 0.047]]
Validation acc: 0.4445993031358885
Validation class_accuracies: [0.29411764705882354, 0.7964426877470355, 0.2532467532467532, 0.046511627906976744]
Validation sensitivity: 0.5678073510773131
Validation specificity: 0.29411764705882354
Validation icbhi_score: 0.43096249906806827
Validation roc_auc: None
Validation avg_accuracy: 0.3475796789898973
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 6 epochs
There is no such attribute
290/290 - 120s - loss: 0.1705 - accuracy: 0.8328 - 120s/epoch - 414ms/step
Epoch 24/110
Validation cm: [[407 220  11   8]
 [175 307   6  18]
 [ 40  24  49  41]
 [ 49  31  35  14]]
Validation val_loss: 0.7450928914350359
Validation normalized_cm: [[0.63  0.341 0.017 0.012]
 [0.346 0.607 0.012 0.036]
 [0.26  0.156 0.318 0.266]
 [0.38  0.24  0.271 0.109]]
Validation acc: 0.5414634146341464
Validation class_accuracies: [0.6300309597523219, 0.6067193675889329, 0.3181818181818182, 0.10852713178294573]
Validation sensitivity: 0.46894803548795944
Validation specificity: 0.6300309597523219
Validation icbhi_score: 0.5494894976201407
Validation roc_auc: None
Validation avg_accuracy: 0.41586481932650465
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 7 epochs
There is no such attribute
290/290 - 121s - loss: 0.1525 - accuracy: 0.8475 - 121s/epoch - 416ms/step
Epoch 25/110
Validation cm: [[340 271  12  23]
 [122 324  10  50]
 [ 31  26  32  65]
 [ 21  31  46  31]]
Validation val_loss: 0.7214505221006153
Validation normalized_cm: [[0.526 0.42  0.019 0.036]
 [0.241 0.64  0.02  0.099]
 [0.201 0.169 0.208 0.422]
 [0.163 0.24  0.357 0.24 ]]
Validation acc: 0.5066202090592334
Validation class_accuracies: [0.5263157894736842, 0.6403162055335968, 0.2077922077922078, 0.24031007751937986]
Validation sensitivity: 0.49049429657794674
Validation specificity: 0.5263157894736842
Validation icbhi_score: 0.5084050430258155
Validation roc_auc: None
Validation avg_accuracy: 0.40368357007971717
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 8 epochs
There is no such attribute
290/290 - 120s - loss: 0.1484 - accuracy: 0.8374 - 120s/epoch - 414ms/step
Epoch 26/110
Validation cm: [[585  42  16   3]
 [440  47  13   6]
 [ 52  10  61  31]
 [ 93   4  32   0]]
Validation val_loss: 0.8239509014437808
Validation normalized_cm: [[0.906 0.065 0.025 0.005]
 [0.87  0.093 0.026 0.012]
 [0.338 0.065 0.396 0.201]
 [0.721 0.031 0.248 0.   ]]
Validation acc: 0.48292682926829267
Validation class_accuracies: [0.9055727554179567, 0.09288537549407115, 0.3961038961038961, 0.0]
Validation sensitivity: 0.13688212927756654
Validation specificity: 0.9055727554179567
Validation icbhi_score: 0.5212274423477616
Validation roc_auc: None
Validation avg_accuracy: 0.348640506753981
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 9 epochs
There is no such attribute
290/290 - 120s - loss: 0.1335 - accuracy: 0.8322 - 120s/epoch - 415ms/step
Epoch 27/110
Validation cm: [[294 320  18  14]
 [107 358   7  34]
 [ 34  35  35  50]
 [ 49  28  40  12]]
Validation val_loss: 0.9950312547631605
Validation normalized_cm: [[0.455 0.495 0.028 0.022]
 [0.211 0.708 0.014 0.067]
 [0.221 0.227 0.227 0.325]
 [0.38  0.217 0.31  0.093]]
Validation acc: 0.4871080139372822
Validation class_accuracies: [0.4551083591331269, 0.7075098814229249, 0.22727272727272727, 0.09302325581395349]
Validation sensitivity: 0.5133079847908745
Validation specificity: 0.4551083591331269
Validation icbhi_score: 0.4842081719620007
Validation roc_auc: None
Validation avg_accuracy: 0.37072855591068316
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
290/290 - 120s - loss: 0.1304 - accuracy: 0.8387 - 120s/epoch - 414ms/step
Epoch 28/110
Validation cm: [[336 288  12  10]
 [119 349   8  30]
 [ 35  35  35  49]
 [ 47  33  40   9]]
Validation val_loss: 0.9475606839793306
Validation normalized_cm: [[0.52  0.446 0.019 0.015]
 [0.235 0.69  0.016 0.059]
 [0.227 0.227 0.227 0.318]
 [0.364 0.256 0.31  0.07 ]]
Validation acc: 0.50801393728223
Validation class_accuracies: [0.5201238390092879, 0.6897233201581028, 0.22727272727272727, 0.06976744186046512]
Validation sensitivity: 0.49809885931558934
Validation specificity: 0.5201238390092879
Validation icbhi_score: 0.5091113491624386
Validation roc_auc: None
Validation avg_accuracy: 0.37672183207514576
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 11 epochs
There is no such attribute
290/290 - 121s - loss: 0.1253 - accuracy: 0.8518 - 121s/epoch - 416ms/step
Epoch 29/110
Validation cm: [[434 158  35  19]
 [199 220  34  53]
 [ 33  17  52  52]
 [ 41  19  62   7]]
Validation val_loss: 1.0484575841027501
Validation normalized_cm: [[0.672 0.245 0.054 0.029]
 [0.393 0.435 0.067 0.105]
 [0.214 0.11  0.338 0.338]
 [0.318 0.147 0.481 0.054]]
Validation acc: 0.4968641114982578
Validation class_accuracies: [0.6718266253869969, 0.43478260869565216, 0.33766233766233766, 0.05426356589147287]
Validation sensitivity: 0.35361216730038025
Validation specificity: 0.6718266253869969
Validation icbhi_score: 0.5127193963436886
Validation roc_auc: None
Validation avg_accuracy: 0.3746337844091149
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5565810074279862 hasn't increased by 0 in 12 epochs
There is no such attribute
290/290 - 121s - loss: 0.1210 - accuracy: 0.8346 - 121s/epoch - 417ms/step
Epoch 30/110
Validation cm: [[545  76  19   6]
 [323 164   8  11]
 [ 55  17  44  38]
 [ 79  12  30   8]]
Validation val_loss: 0.9964357360942636
Validation normalized_cm: [[0.844 0.118 0.029 0.009]
 [0.638 0.324 0.016 0.022]
 [0.357 0.11  0.286 0.247]
 [0.612 0.093 0.233 0.062]]
Validation acc: 0.5303135888501742
Validation class_accuracies: [0.8436532507739938, 0.3241106719367589, 0.2857142857142857, 0.06201550387596899]
Validation sensitivity: 0.2737642585551331
Validation specificity: 0.8436532507739938
Validation icbhi_score: 0.5587087546645635
Validation roc_auc: None
Validation avg_accuracy: 0.3788734280752518
Validation one_indexed_epoch: 30
-- New best results were achieved. --
There is no such attribute
290/290 - 120s - loss: 0.1239 - accuracy: 0.8346 - 120s/epoch - 415ms/step
Epoch 31/110
Validation cm: [[467 150  19  10]
 [211 258   8  29]
 [ 38  19  44  53]
 [ 54  24  45   6]]
Validation val_loss: 0.9776708432778883
Validation normalized_cm: [[0.723 0.232 0.029 0.015]
 [0.417 0.51  0.016 0.057]
 [0.247 0.123 0.286 0.344]
 [0.419 0.186 0.349 0.047]]
Validation acc: 0.5400696864111498
Validation class_accuracies: [0.7229102167182663, 0.5098814229249012, 0.2857142857142857, 0.046511627906976744]
Validation sensitivity: 0.39036755386565275
Validation specificity: 0.7229102167182663
Validation icbhi_score: 0.5566388852919595
Validation roc_auc: None
Validation avg_accuracy: 0.3912543883161075
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5587087546645635 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
290/290 - 121s - loss: 0.1077 - accuracy: 0.8387 - 121s/epoch - 417ms/step
Epoch 32/110
Validation cm: [[504 122  16   4]
 [268 219   8  11]
 [ 46  17  50  41]
 [ 59  26  35   9]]
Validation val_loss: 0.9424073969340038
Validation normalized_cm: [[0.78  0.189 0.025 0.006]
 [0.53  0.433 0.016 0.022]
 [0.299 0.11  0.325 0.266]
 [0.457 0.202 0.271 0.07 ]]
Validation acc: 0.5449477351916376
Validation class_accuracies: [0.7801857585139319, 0.43280632411067194, 0.3246753246753247, 0.06976744186046512]
Validation sensitivity: 0.3523447401774398
Validation specificity: 0.7801857585139319
Validation icbhi_score: 0.5662652493456859
Validation roc_auc: None
Validation avg_accuracy: 0.4018587122900984
Validation one_indexed_epoch: 32
-- New best results were achieved. --
There is no such attribute
290/290 - 121s - loss: 0.1119 - accuracy: 0.8451 - 121s/epoch - 417ms/step
Epoch 33/110
Validation cm: [[292 334  14   6]
 [115 366   7  18]
 [ 35  38  38  43]
 [ 51  30  38  10]]
Validation val_loss: 1.0662639670765
Validation normalized_cm: [[0.452 0.517 0.022 0.009]
 [0.227 0.723 0.014 0.036]
 [0.227 0.247 0.247 0.279]
 [0.395 0.233 0.295 0.078]]
Validation acc: 0.49198606271777
Validation class_accuracies: [0.4520123839009288, 0.7233201581027668, 0.24675324675324675, 0.07751937984496124]
Validation sensitivity: 0.5247148288973384
Validation specificity: 0.4520123839009288
Validation icbhi_score: 0.4883636063991336
Validation roc_auc: None
Validation avg_accuracy: 0.3749012921504759
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 121s - loss: 0.1095 - accuracy: 0.8417 - 121s/epoch - 417ms/step
Epoch 34/110
Validation cm: [[362 257  15  12]
 [154 320   7  25]
 [ 33  33  36  52]
 [ 43  27  48  11]]
Validation val_loss: 0.9978428832469273
Validation normalized_cm: [[0.56  0.398 0.023 0.019]
 [0.304 0.632 0.014 0.049]
 [0.214 0.214 0.234 0.338]
 [0.333 0.209 0.372 0.085]]
Validation acc: 0.50801393728223
Validation class_accuracies: [0.5603715170278638, 0.6324110671936759, 0.23376623376623376, 0.08527131782945736]
Validation sensitivity: 0.46514575411913817
Validation specificity: 0.5603715170278638
Validation icbhi_score: 0.512758635573501
Validation roc_auc: None
Validation avg_accuracy: 0.37795503395430774
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 120s - loss: 0.1086 - accuracy: 0.8384 - 120s/epoch - 415ms/step
Epoch 35/110
Validation cm: [[499 121  20   6]
 [270 206  12  18]
 [ 49  18  47  40]
 [ 62  12  47   8]]
Validation val_loss: 1.005176942237982
Validation normalized_cm: [[0.772 0.187 0.031 0.009]
 [0.534 0.407 0.024 0.036]
 [0.318 0.117 0.305 0.26 ]
 [0.481 0.093 0.364 0.062]]
Validation acc: 0.5296167247386759
Validation class_accuracies: [0.7724458204334366, 0.40711462450592883, 0.3051948051948052, 0.06201550387596899]
Validation sensitivity: 0.33079847908745247
Validation specificity: 0.7724458204334366
Validation icbhi_score: 0.5516221497604445
Validation roc_auc: None
Validation avg_accuracy: 0.3866926885025349
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 3 epochs
There is no such attribute
290/290 - 122s - loss: 0.1129 - accuracy: 0.8419 - 122s/epoch - 420ms/step
Epoch 36/110
Validation cm: [[269 343  20  14]
 [ 94 360   5  47]
 [ 27  44  36  47]
 [ 29  33  52  15]]
Validation val_loss: 0.9883348580590132
Validation normalized_cm: [[0.416 0.531 0.031 0.022]
 [0.186 0.711 0.01  0.093]
 [0.175 0.286 0.234 0.305]
 [0.225 0.256 0.403 0.116]]
Validation acc: 0.4738675958188153
Validation class_accuracies: [0.41640866873065013, 0.7114624505928854, 0.23376623376623376, 0.11627906976744186]
Validation sensitivity: 0.5209125475285171
Validation specificity: 0.41640866873065013
Validation icbhi_score: 0.46866060812958366
Validation roc_auc: None
Validation avg_accuracy: 0.3694791057143028
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 4 epochs
There is no such attribute
290/290 - 121s - loss: 0.1067 - accuracy: 0.8404 - 121s/epoch - 417ms/step
Epoch 37/110
Validation cm: [[418 196  19  13]
 [173 289   9  35]
 [ 39  18  49  48]
 [ 55  24  42   8]]
Validation val_loss: 1.0068386827485105
Validation normalized_cm: [[0.647 0.303 0.029 0.02 ]
 [0.342 0.571 0.018 0.069]
 [0.253 0.117 0.318 0.312]
 [0.426 0.186 0.326 0.062]]
Validation acc: 0.532404181184669
Validation class_accuracies: [0.6470588235294118, 0.5711462450592886, 0.3181818181818182, 0.06201550387596899]
Validation sensitivity: 0.4385297845373891
Validation specificity: 0.6470588235294118
Validation icbhi_score: 0.5427943040334005
Validation roc_auc: None
Validation avg_accuracy: 0.3996005976616218
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
290/290 - 121s - loss: 0.1002 - accuracy: 0.8380 - 121s/epoch - 418ms/step
Epoch 38/110
Validation cm: [[380 234  17  15]
 [157 303  13  33]
 [ 34  29  39  52]
 [ 46  26  47  10]]
Validation val_loss: 1.0436877967210254
Validation normalized_cm: [[0.588 0.362 0.026 0.023]
 [0.31  0.599 0.026 0.065]
 [0.221 0.188 0.253 0.338]
 [0.357 0.202 0.364 0.078]]
Validation acc: 0.5101045296167247
Validation class_accuracies: [0.5882352941176471, 0.5988142292490118, 0.2532467532467532, 0.07751937984496124]
Validation sensitivity: 0.4461343472750317
Validation specificity: 0.5882352941176471
Validation icbhi_score: 0.5171848206963394
Validation roc_auc: None
Validation avg_accuracy: 0.37945391411459334
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 6 epochs
There is no such attribute
290/290 - 121s - loss: 0.1019 - accuracy: 0.8359 - 121s/epoch - 419ms/step
Epoch 39/110
Validation cm: [[421 195  21   9]
 [175 287  17  27]
 [ 38  22  48  46]
 [ 49  25  46   9]]
Validation val_loss: 1.0073682226018332
Validation normalized_cm: [[0.652 0.302 0.033 0.014]
 [0.346 0.567 0.034 0.053]
 [0.247 0.143 0.312 0.299]
 [0.38  0.194 0.357 0.07 ]]
Validation acc: 0.5331010452961672
Validation class_accuracies: [0.651702786377709, 0.567193675889328, 0.3116883116883117, 0.06976744186046512]
Validation sensitivity: 0.43599493029150826
Validation specificity: 0.651702786377709
Validation icbhi_score: 0.5438488583346086
Validation roc_auc: None
Validation avg_accuracy: 0.40008805395395347
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 7 epochs
There is no such attribute
290/290 - 121s - loss: 0.0932 - accuracy: 0.8320 - 121s/epoch - 419ms/step
Epoch 40/110
Validation cm: [[487 138  18   3]
 [261 226   7  12]
 [ 45  20  44  45]
 [ 58  27  33  11]]
Validation val_loss: 1.0271225762284386
Validation normalized_cm: [[0.754 0.214 0.028 0.005]
 [0.516 0.447 0.014 0.024]
 [0.292 0.13  0.286 0.292]
 [0.45  0.209 0.256 0.085]]
Validation acc: 0.535191637630662
Validation class_accuracies: [0.7538699690402477, 0.44664031620553357, 0.2857142857142857, 0.08527131782945736]
Validation sensitivity: 0.3561470215462611
Validation specificity: 0.7538699690402477
Validation icbhi_score: 0.5550084952932544
Validation roc_auc: None
Validation avg_accuracy: 0.392873972197381
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 8 epochs
There is no such attribute
290/290 - 121s - loss: 0.0902 - accuracy: 0.8400 - 121s/epoch - 418ms/step
Epoch 41/110
Validation cm: [[474 136  20  16]
 [255 219   8  24]
 [ 40  20  44  50]
 [ 53  20  46  10]]
Validation val_loss: 1.1084459481022262
Validation normalized_cm: [[0.734 0.211 0.031 0.025]
 [0.504 0.433 0.016 0.047]
 [0.26  0.13  0.286 0.325]
 [0.411 0.155 0.357 0.078]]
Validation acc: 0.5205574912891986
Validation class_accuracies: [0.7337461300309598, 0.43280632411067194, 0.2857142857142857, 0.07751937984496124]
Validation sensitivity: 0.34600760456273766
Validation specificity: 0.7337461300309598
Validation icbhi_score: 0.5398768672968487
Validation roc_auc: None
Validation avg_accuracy: 0.3824465299252196
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 9 epochs
There is no such attribute
290/290 - 121s - loss: 0.0862 - accuracy: 0.8246 - 121s/epoch - 419ms/step
Epoch 42/110
Validation cm: [[493 131  17   5]
 [251 235   7  13]
 [ 46  19  44  45]
 [ 53  31  36   9]]
Validation val_loss: 1.0120878091823369
Validation normalized_cm: [[0.763 0.203 0.026 0.008]
 [0.496 0.464 0.014 0.026]
 [0.299 0.123 0.286 0.292]
 [0.411 0.24  0.279 0.07 ]]
Validation acc: 0.5442508710801394
Validation class_accuracies: [0.7631578947368421, 0.4644268774703557, 0.2857142857142857, 0.06976744186046512]
Validation sensitivity: 0.3650190114068441
Validation specificity: 0.7631578947368421
Validation icbhi_score: 0.5640884530718431
Validation roc_auc: None
Validation avg_accuracy: 0.39576662494548714
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
290/290 - 121s - loss: 0.0867 - accuracy: 0.8292 - 121s/epoch - 418ms/step
Epoch 43/110
Validation cm: [[497 111  25  13]
 [289 180  17  20]
 [ 42  14  52  46]
 [ 58  17  47   7]]
Validation val_loss: 1.154995792450891
Validation normalized_cm: [[0.769 0.172 0.039 0.02 ]
 [0.571 0.356 0.034 0.04 ]
 [0.273 0.091 0.338 0.299]
 [0.45  0.132 0.364 0.054]]
Validation acc: 0.5128919860627178
Validation class_accuracies: [0.7693498452012384, 0.3557312252964427, 0.33766233766233766, 0.05426356589147287]
Validation sensitivity: 0.302915082382763
Validation specificity: 0.7693498452012384
Validation icbhi_score: 0.5361324637920006
Validation roc_auc: None
Validation avg_accuracy: 0.37925174351287294
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 11 epochs
There is no such attribute
290/290 - 121s - loss: 0.0921 - accuracy: 0.8387 - 121s/epoch - 417ms/step
Epoch 44/110
Validation cm: [[491 118  27  10]
 [250 213  11  32]
 [ 37  15  53  49]
 [ 51  20  52   6]]
Validation val_loss: 1.0631588930466984
Validation normalized_cm: [[0.76  0.183 0.042 0.015]
 [0.494 0.421 0.022 0.063]
 [0.24  0.097 0.344 0.318]
 [0.395 0.155 0.403 0.047]]
Validation acc: 0.5317073170731708
Validation class_accuracies: [0.760061919504644, 0.4209486166007905, 0.34415584415584416, 0.046511627906976744]
Validation sensitivity: 0.34474017743979724
Validation specificity: 0.760061919504644
Validation icbhi_score: 0.5524010484722206
Validation roc_auc: None
Validation avg_accuracy: 0.39291950204206383
Validation one_indexed_epoch: 44
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 12 epochs
There is no such attribute
290/290 - 121s - loss: 0.0839 - accuracy: 0.8395 - 121s/epoch - 418ms/step
Epoch 45/110
Validation cm: [[502 110  21  13]
 [266 209  13  18]
 [ 45  16  43  50]
 [ 60  23  35  11]]
Validation val_loss: 1.0826718225058025
Validation normalized_cm: [[0.777 0.17  0.033 0.02 ]
 [0.526 0.413 0.026 0.036]
 [0.292 0.104 0.279 0.325]
 [0.465 0.178 0.271 0.085]]
Validation acc: 0.5331010452961672
Validation class_accuracies: [0.7770897832817337, 0.41304347826086957, 0.2792207792207792, 0.08527131782945736]
Validation sensitivity: 0.3333333333333333
Validation specificity: 0.7770897832817337
Validation icbhi_score: 0.5552115583075335
Validation roc_auc: None
Validation avg_accuracy: 0.38865633964820995
Validation one_indexed_epoch: 45
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 13 epochs
There is no such attribute
290/290 - 121s - loss: 0.0919 - accuracy: 0.8402 - 121s/epoch - 418ms/step
Epoch 46/110
Validation cm: [[423 186  27  10]
 [204 257  19  26]
 [ 36  21  46  51]
 [ 39  21  61   8]]
Validation val_loss: 1.0922639006607149
Validation normalized_cm: [[0.655 0.288 0.042 0.015]
 [0.403 0.508 0.038 0.051]
 [0.234 0.136 0.299 0.331]
 [0.302 0.163 0.473 0.062]]
Validation acc: 0.5114982578397212
Validation class_accuracies: [0.6547987616099071, 0.5079051383399209, 0.2987012987012987, 0.06201550387596899]
Validation sensitivity: 0.394169835234474
Validation specificity: 0.6547987616099071
Validation icbhi_score: 0.5244842984221906
Validation roc_auc: None
Validation avg_accuracy: 0.38085517563177396
Validation one_indexed_epoch: 46
The validation tracker metric at 0.5662652493456859 hasn't increased by 0 in 14 epochs
There is no such attribute
290/290 - 121s - loss: 0.0856 - accuracy: 0.8305 - 121s/epoch - 417ms/step
Epoch 47/110
Validation cm: [[486 125  25  10]
 [237 225  15  29]
 [ 38  15  53  48]
 [ 51  18  54   6]]
Validation val_loss: 1.063952097616573
Validation normalized_cm: [[0.752 0.193 0.039 0.015]
 [0.468 0.445 0.03  0.057]
 [0.247 0.097 0.344 0.312]
 [0.395 0.14  0.419 0.047]]
Validation acc: 0.5365853658536586
Validation class_accuracies: [0.7523219814241486, 0.44466403162055335, 0.34415584415584416, 0.046511627906976744]
Validation sensitivity: 0.35994930291508237
Validation specificity: 0.7523219814241486
Validation icbhi_score: 0.5561356421696155
Validation roc_auc: None
Validation avg_accuracy: 0.39691337127688076
Validation one_indexed_epoch: 47
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
290/290 - 122s - loss: 0.0849 - accuracy: 0.8335 - 122s/epoch - 419ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5662652493456859
Best cm: [[504 122  16   4]
 [268 219   8  11]
 [ 46  17  50  41]
 [ 59  26  35   9]]
Best val_loss: 0.9424073969340038
Best normalized_cm: [[0.78  0.189 0.025 0.006]
 [0.53  0.433 0.016 0.022]
 [0.299 0.11  0.325 0.266]
 [0.457 0.202 0.271 0.07 ]]
Best acc: 0.5449477351916376
Best class_accuracies: [0.7801857585139319, 0.43280632411067194, 0.3246753246753247, 0.06976744186046512]
Best sensitivity: 0.3523447401774398
Best specificity: 0.7801857585139319
Best roc_auc: None
Best avg_accuracy: 0.4018587122900984
Best one_indexed_epoch: 32
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6981160044670105, 0.6710298657417297, 0.6305505633354187, 0.5851873755455017, 0.5456075668334961, 0.5033208131790161, 0.4878287613391876, 0.46107977628707886, 0.4413164258003235, 0.4117899537086487, 0.39917615056037903, 0.36487433314323425, 0.34029096364974976, 0.3191838562488556, 0.28968459367752075, 0.2645317018032074, 0.2597782611846924, 0.2483573704957962, 0.2234029620885849, 0.20169802010059357, 0.18977797031402588, 0.1873079240322113, 0.1704724282026291, 0.15249194204807281, 0.14838890731334686, 0.1334969699382782, 0.13042418658733368, 0.12527871131896973, 0.1210208609700203, 0.12393549829721451, 0.10766495019197464, 0.11187141388654709, 0.10946357250213623, 0.1085873693227768, 0.1129496693611145, 0.1067240983247757, 0.10016835480928421, 0.10186417400836945, 0.09321247041225433, 0.09015987813472748, 0.08622578531503677, 0.08666994422674179, 0.09214451164007187, 0.08389422297477722, 0.09187445789575577, 0.08559223264455795, 0.08494942635297775], 'accuracy': [0.5174946188926697, 0.5488120913505554, 0.5628509521484375, 0.6244060397148132, 0.6989200711250305, 0.7356371283531189, 0.7602591514587402, 0.7665227055549622, 0.7768898606300354, 0.793952465057373, 0.7866090536117554, 0.8023757934570312, 0.803887665271759, 0.8114470839500427, 0.8228941559791565, 0.8244060277938843, 0.8170626163482666, 0.8298056125640869, 0.8280777335166931, 0.8369330167770386, 0.8328293561935425, 0.834125280380249, 0.8328293561935425, 0.8475161790847778, 0.8373650312423706, 0.832181453704834, 0.8386608958244324, 0.8518358469009399, 0.8345572352409363, 0.8345572352409363, 0.8386608958244324, 0.8451403975486755, 0.8416846394538879, 0.8384449481964111, 0.841900646686554, 0.8403887748718262, 0.8380129337310791, 0.8358531594276428, 0.831965446472168, 0.8399568200111389, 0.8246220350265503, 0.8291576504707336, 0.8386608958244324, 0.8395248651504517, 0.8401727676391602, 0.8304535746574402, 0.8334773182868958]}
End
####################################
Job id is 7.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4450 elements, with 2195 none's, 1234 crakles, 477 wheezes and 544 both ---
--- Final Validation dataset contains 1615 elements, with 683 none, 600 crackles, 240 wheezes and 92 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5068337129840547, 1: 0.9015397082658023, 2: 2.3322851153039834, 3: 2.0450367647058822}
Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_5   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_15 (Dense)            (None, 100)               128100    
                                                                 
 dropout_10 (Dropout)        (None, 100)               0         
                                                                 
 dense_16 (Dense)            (None, 50)                5050      
                                                                 
 dropout_11 (Dropout)        (None, 50)                0         
                                                                 
 dense_17 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_5"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_10 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_11 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_5 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[197 368  27  91]
 [119 361  35  85]
 [ 63  90  38  49]
 [ 22  44  11  15]]
Validation val_loss: 0.6804720725437436
Validation normalized_cm: [[0.288 0.539 0.04  0.133]
 [0.198 0.602 0.058 0.142]
 [0.263 0.375 0.158 0.204]
 [0.239 0.478 0.12  0.163]]
Validation acc: 0.378328173374613
Validation class_accuracies: [0.2884333821376281, 0.6016666666666667, 0.15833333333333333, 0.16304347826086957]
Validation sensitivity: 0.44420600858369097
Validation specificity: 0.2884333821376281
Validation icbhi_score: 0.36631969536065956
Validation roc_auc: None
Validation avg_accuracy: 0.3028692150996244
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
279/279 - 141s - loss: 0.7037 - accuracy: 0.5429 - 141s/epoch - 507ms/step
Epoch 2/110
Validation cm: [[624  32  27   0]
 [556  12  32   0]
 [210  11  17   2]
 [ 83   2   7   0]]
Validation val_loss: 0.6626684386848296
Validation normalized_cm: [[0.914 0.047 0.04  0.   ]
 [0.927 0.02  0.053 0.   ]
 [0.875 0.046 0.071 0.008]
 [0.902 0.022 0.076 0.   ]]
Validation acc: 0.4043343653250774
Validation class_accuracies: [0.9136163982430454, 0.02, 0.07083333333333333, 0.0]
Validation sensitivity: 0.03111587982832618
Validation specificity: 0.9136163982430454
Validation icbhi_score: 0.4723661390356858
Validation roc_auc: None
Validation avg_accuracy: 0.2511124328940947
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
279/279 - 127s - loss: 0.6832 - accuracy: 0.5256 - 127s/epoch - 455ms/step
Epoch 3/110
Validation cm: [[472 191  12   8]
 [384 188  17  11]
 [113  58  38  31]
 [ 62  17  11   2]]
Validation val_loss: 0.6213091933136754
Validation normalized_cm: [[0.691 0.28  0.018 0.012]
 [0.64  0.313 0.028 0.018]
 [0.471 0.242 0.158 0.129]
 [0.674 0.185 0.12  0.022]]
Validation acc: 0.43343653250773995
Validation class_accuracies: [0.6910688140556369, 0.31333333333333335, 0.15833333333333333, 0.021739130434782608]
Validation sensitivity: 0.2446351931330472
Validation specificity: 0.6910688140556369
Validation icbhi_score: 0.4678520035943421
Validation roc_auc: None
Validation avg_accuracy: 0.2961186527892715
Validation one_indexed_epoch: 3
The validation tracker metric at 0.4723661390356858 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 127s - loss: 0.6558 - accuracy: 0.5816 - 127s/epoch - 455ms/step
Epoch 4/110
Validation cm: [[530 147   6   0]
 [329 270   1   0]
 [117  44  71   8]
 [ 61  24   5   2]]
Validation val_loss: 0.5771850243441461
Validation normalized_cm: [[0.776 0.215 0.009 0.   ]
 [0.548 0.45  0.002 0.   ]
 [0.487 0.183 0.296 0.033]
 [0.663 0.261 0.054 0.022]]
Validation acc: 0.5405572755417957
Validation class_accuracies: [0.7759882869692533, 0.45, 0.29583333333333334, 0.021739130434782608]
Validation sensitivity: 0.36802575107296137
Validation specificity: 0.7759882869692533
Validation icbhi_score: 0.5720070190211073
Validation roc_auc: None
Validation avg_accuracy: 0.38589018768434236
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
279/279 - 127s - loss: 0.6286 - accuracy: 0.6144 - 127s/epoch - 455ms/step
Epoch 5/110
Validation cm: [[363  23 275  22]
 [252  96 198  54]
 [ 34   1 179  26]
 [ 18   1  67   6]]
Validation val_loss: 0.6474125033930729
Validation normalized_cm: [[0.531 0.034 0.403 0.032]
 [0.42  0.16  0.33  0.09 ]
 [0.142 0.004 0.746 0.108]
 [0.196 0.011 0.728 0.065]]
Validation acc: 0.39876160990712073
Validation class_accuracies: [0.5314787701317716, 0.16, 0.7458333333333333, 0.06521739130434782]
Validation sensitivity: 0.30150214592274677
Validation specificity: 0.5314787701317716
Validation icbhi_score: 0.41649045802725915
Validation roc_auc: None
Validation avg_accuracy: 0.3756323736923632
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5720070190211073 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 127s - loss: 0.5868 - accuracy: 0.6564 - 127s/epoch - 457ms/step
Epoch 6/110
Validation cm: [[606  51  22   4]
 [500  90   8   2]
 [109   7 121   3]
 [ 66   0  25   1]]
Validation val_loss: 0.541053460063211
Validation normalized_cm: [[0.887 0.075 0.032 0.006]
 [0.833 0.15  0.013 0.003]
 [0.454 0.029 0.504 0.013]
 [0.717 0.    0.272 0.011]]
Validation acc: 0.5065015479876162
Validation class_accuracies: [0.8872620790629575, 0.15, 0.5041666666666667, 0.010869565217391304]
Validation sensitivity: 0.22746781115879827
Validation specificity: 0.8872620790629575
Validation icbhi_score: 0.5573649451108779
Validation roc_auc: None
Validation avg_accuracy: 0.38807457773675386
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5720070190211073 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 127s - loss: 0.5576 - accuracy: 0.6948 - 127s/epoch - 456ms/step
Epoch 7/110
Validation cm: [[625  51   7   0]
 [489  98  11   2]
 [ 96   7 125  12]
 [ 62   3  27   0]]
Validation val_loss: 0.5063984031140251
Validation normalized_cm: [[0.915 0.075 0.01  0.   ]
 [0.815 0.163 0.018 0.003]
 [0.4   0.029 0.521 0.05 ]
 [0.674 0.033 0.293 0.   ]]
Validation acc: 0.525077399380805
Validation class_accuracies: [0.9150805270863837, 0.16333333333333333, 0.5208333333333334, 0.0]
Validation sensitivity: 0.23927038626609443
Validation specificity: 0.9150805270863837
Validation icbhi_score: 0.577175456676239
Validation roc_auc: None
Validation avg_accuracy: 0.39981179843826264
Validation one_indexed_epoch: 7
-- New best results were achieved. --
There is no such attribute
279/279 - 128s - loss: 0.5309 - accuracy: 0.7139 - 128s/epoch - 458ms/step
Epoch 8/110
Validation cm: [[644  36   3   0]
 [555  43   2   0]
 [133  29  76   2]
 [ 69   9  14   0]]
Validation val_loss: 0.551651979830612
Validation normalized_cm: [[0.943 0.053 0.004 0.   ]
 [0.925 0.072 0.003 0.   ]
 [0.554 0.121 0.317 0.008]
 [0.75  0.098 0.152 0.   ]]
Validation acc: 0.4724458204334365
Validation class_accuracies: [0.9428989751098097, 0.07166666666666667, 0.31666666666666665, 0.0]
Validation sensitivity: 0.1276824034334764
Validation specificity: 0.9428989751098097
Validation icbhi_score: 0.535290689271643
Validation roc_auc: None
Validation avg_accuracy: 0.33280807711078575
Validation one_indexed_epoch: 8
The validation tracker metric at 0.577175456676239 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 128s - loss: 0.5087 - accuracy: 0.7265 - 128s/epoch - 457ms/step
Epoch 9/110
Validation cm: [[295 350  16  22]
 [ 99 459  10  32]
 [ 23  51  43 123]
 [ 15  30  17  30]]
Validation val_loss: 0.5046383635501375
Validation normalized_cm: [[0.432 0.512 0.023 0.032]
 [0.165 0.765 0.017 0.053]
 [0.096 0.212 0.179 0.512]
 [0.163 0.326 0.185 0.326]]
Validation acc: 0.5120743034055728
Validation class_accuracies: [0.43191800878477304, 0.765, 0.17916666666666667, 0.32608695652173914]
Validation sensitivity: 0.5708154506437768
Validation specificity: 0.43191800878477304
Validation icbhi_score: 0.501366729714275
Validation roc_auc: None
Validation avg_accuracy: 0.42554290799329475
Validation one_indexed_epoch: 9
The validation tracker metric at 0.577175456676239 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 127s - loss: 0.4698 - accuracy: 0.7333 - 127s/epoch - 456ms/step
Epoch 10/110
Validation cm: [[471   0 212   0]
 [376   0 223   1]
 [ 25   0 206   9]
 [ 17   0  75   0]]
Validation val_loss: 0.6986367936889084
Validation normalized_cm: [[0.69  0.    0.31  0.   ]
 [0.627 0.    0.372 0.002]
 [0.104 0.    0.858 0.037]
 [0.185 0.    0.815 0.   ]]
Validation acc: 0.41919504643962846
Validation class_accuracies: [0.6896046852122987, 0.0, 0.8583333333333333, 0.0]
Validation sensitivity: 0.22103004291845493
Validation specificity: 0.6896046852122987
Validation icbhi_score: 0.4553173640653768
Validation roc_auc: None
Validation avg_accuracy: 0.386984504636408
Validation one_indexed_epoch: 10
The validation tracker metric at 0.577175456676239 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 129s - loss: 0.4630 - accuracy: 0.7494 - 129s/epoch - 461ms/step
Epoch 11/110
Validation cm: [[584  37  58   4]
 [393 153  37  17]
 [ 69  19 138  14]
 [ 42   7  39   4]]
Validation val_loss: 0.5186719751556407
Validation normalized_cm: [[0.855 0.054 0.085 0.006]
 [0.655 0.255 0.062 0.028]
 [0.287 0.079 0.575 0.058]
 [0.457 0.076 0.424 0.043]]
Validation acc: 0.5442724458204334
Validation class_accuracies: [0.8550512445095169, 0.255, 0.575, 0.043478260869565216]
Validation sensitivity: 0.3165236051502146
Validation specificity: 0.8550512445095169
Validation icbhi_score: 0.5857874248298658
Validation roc_auc: None
Validation avg_accuracy: 0.43213237634477053
Validation one_indexed_epoch: 11
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 128s - loss: 0.4388 - accuracy: 0.7508 - 128s/epoch - 459ms/step
Epoch 12/110
Validation cm: [[678   0   5   0]
 [596   0   4   0]
 [162   0  78   0]
 [ 79   0  13   0]]
Validation val_loss: 0.6187312503601929
Validation normalized_cm: [[0.993 0.    0.007 0.   ]
 [0.993 0.    0.007 0.   ]
 [0.675 0.    0.325 0.   ]
 [0.859 0.    0.141 0.   ]]
Validation acc: 0.4681114551083591
Validation class_accuracies: [0.9926793557833089, 0.0, 0.325, 0.0]
Validation sensitivity: 0.08369098712446352
Validation specificity: 0.9926793557833089
Validation icbhi_score: 0.5381851714538862
Validation roc_auc: None
Validation avg_accuracy: 0.3294198389458272
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5857874248298658 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 128s - loss: 0.4143 - accuracy: 0.7602 - 128s/epoch - 460ms/step
Epoch 13/110
Validation cm: [[196  31 308 148]
 [159  49 181 211]
 [ 18   2  77 143]
 [  7   0  38  47]]
Validation val_loss: 0.8839719392751393
Validation normalized_cm: [[0.287 0.045 0.451 0.217]
 [0.265 0.082 0.302 0.352]
 [0.075 0.008 0.321 0.596]
 [0.076 0.    0.413 0.511]]
Validation acc: 0.2284829721362229
Validation class_accuracies: [0.2869692532942899, 0.08166666666666667, 0.32083333333333336, 0.5108695652173914]
Validation sensitivity: 0.18562231759656653
Validation specificity: 0.2869692532942899
Validation icbhi_score: 0.23629578544542823
Validation roc_auc: None
Validation avg_accuracy: 0.3000847046279203
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5857874248298658 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 129s - loss: 0.3805 - accuracy: 0.7683 - 129s/epoch - 461ms/step
Epoch 14/110
Validation cm: [[450  31 192  10]
 [355  96 124  25]
 [ 43   3 146  48]
 [ 31   2  49  10]]
Validation val_loss: 0.6392611683303081
Validation normalized_cm: [[0.659 0.045 0.281 0.015]
 [0.592 0.16  0.207 0.042]
 [0.179 0.013 0.608 0.2  ]
 [0.337 0.022 0.533 0.109]]
Validation acc: 0.4346749226006192
Validation class_accuracies: [0.6588579795021962, 0.16, 0.6083333333333333, 0.10869565217391304]
Validation sensitivity: 0.2703862660944206
Validation specificity: 0.6588579795021962
Validation icbhi_score: 0.4646221227983084
Validation roc_auc: None
Validation avg_accuracy: 0.38397174125236067
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5857874248298658 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 129s - loss: 0.3697 - accuracy: 0.7804 - 129s/epoch - 462ms/step
Epoch 15/110
Validation cm: [[527  27 107  22]
 [416  75  89  20]
 [ 37  10 135  58]
 [ 29   8  33  22]]
Validation val_loss: 0.5751664953219817
Validation normalized_cm: [[0.772 0.04  0.157 0.032]
 [0.693 0.125 0.148 0.033]
 [0.154 0.042 0.562 0.242]
 [0.315 0.087 0.359 0.239]]
Validation acc: 0.469969040247678
Validation class_accuracies: [0.7715959004392386, 0.125, 0.5625, 0.2391304347826087]
Validation sensitivity: 0.24892703862660945
Validation specificity: 0.7715959004392386
Validation icbhi_score: 0.5102614695329241
Validation roc_auc: None
Validation avg_accuracy: 0.42455658380546185
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5857874248298658 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 129s - loss: 0.3532 - accuracy: 0.7872 - 129s/epoch - 461ms/step
Epoch 16/110
Validation cm: [[667   2  14   0]
 [583   2  15   0]
 [119   0 103  18]
 [ 64   1  27   0]]
Validation val_loss: 0.5820055819309717
Validation normalized_cm: [[0.977 0.003 0.02  0.   ]
 [0.972 0.003 0.025 0.   ]
 [0.496 0.    0.429 0.075]
 [0.696 0.011 0.293 0.   ]]
Validation acc: 0.4780185758513932
Validation class_accuracies: [0.9765739385065886, 0.0033333333333333335, 0.42916666666666664, 0.0]
Validation sensitivity: 0.11266094420600858
Validation specificity: 0.9765739385065886
Validation icbhi_score: 0.5446174413562985
Validation roc_auc: None
Validation avg_accuracy: 0.3522684846266471
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5857874248298658 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
279/279 - 129s - loss: 0.3199 - accuracy: 0.8155 - 129s/epoch - 463ms/step
Epoch 17/110
Validation cm: [[562  94  19   8]
 [275 287  23  15]
 [ 51  30 112  47]
 [ 28  15  38  11]]
Validation val_loss: 0.5285965738154879
Validation normalized_cm: [[0.823 0.138 0.028 0.012]
 [0.458 0.478 0.038 0.025]
 [0.212 0.125 0.467 0.196]
 [0.304 0.163 0.413 0.12 ]]
Validation acc: 0.6018575851393189
Validation class_accuracies: [0.8228404099560761, 0.47833333333333333, 0.4666666666666667, 0.11956521739130435]
Validation sensitivity: 0.43991416309012876
Validation specificity: 0.8228404099560761
Validation icbhi_score: 0.6313772865231024
Validation roc_auc: None
Validation avg_accuracy: 0.4718514068368452
Validation one_indexed_epoch: 17
-- New best results were achieved. --
There is no such attribute
279/279 - 129s - loss: 0.2924 - accuracy: 0.8144 - 129s/epoch - 462ms/step
Epoch 18/110
Validation cm: [[562 113   7   1]
 [301 289   5   5]
 [ 64  45  99  32]
 [ 43  24  19   6]]
Validation val_loss: 0.5740174515211764
Validation normalized_cm: [[0.823 0.165 0.01  0.001]
 [0.502 0.482 0.008 0.008]
 [0.267 0.188 0.412 0.133]
 [0.467 0.261 0.207 0.065]]
Validation acc: 0.5919504643962848
Validation class_accuracies: [0.8228404099560761, 0.4816666666666667, 0.4125, 0.06521739130434782]
Validation sensitivity: 0.4227467811158798
Validation specificity: 0.8228404099560761
Validation icbhi_score: 0.622793595535978
Validation roc_auc: None
Validation avg_accuracy: 0.4455561169817727
Validation one_indexed_epoch: 18
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 128s - loss: 0.2687 - accuracy: 0.8171 - 128s/epoch - 460ms/step
Epoch 19/110
Validation cm: [[524  46 103  10]
 [352 147  82  19]
 [ 41   9 135  55]
 [ 26   8  46  12]]
Validation val_loss: 0.6044974313942202
Validation normalized_cm: [[0.767 0.067 0.151 0.015]
 [0.587 0.245 0.137 0.032]
 [0.171 0.037 0.562 0.229]
 [0.283 0.087 0.5   0.13 ]]
Validation acc: 0.5065015479876162
Validation class_accuracies: [0.767203513909224, 0.245, 0.5625, 0.13043478260869565]
Validation sensitivity: 0.315450643776824
Validation specificity: 0.767203513909224
Validation icbhi_score: 0.541327078843024
Validation roc_auc: None
Validation avg_accuracy: 0.4262845741294799
Validation one_indexed_epoch: 19
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 129s - loss: 0.2591 - accuracy: 0.8171 - 129s/epoch - 462ms/step
Epoch 20/110
Validation cm: [[483 121  49  30]
 [214 306  33  47]
 [ 40  17  87  96]
 [ 24  13  34  21]]
Validation val_loss: 0.6049856130382617
Validation normalized_cm: [[0.707 0.177 0.072 0.044]
 [0.357 0.51  0.055 0.078]
 [0.167 0.071 0.362 0.4  ]
 [0.261 0.141 0.37  0.228]]
Validation acc: 0.5554179566563467
Validation class_accuracies: [0.7071742313323572, 0.51, 0.3625, 0.22826086956521738]
Validation sensitivity: 0.44420600858369097
Validation specificity: 0.7071742313323572
Validation icbhi_score: 0.5756901199580241
Validation roc_auc: None
Validation avg_accuracy: 0.45198377522439365
Validation one_indexed_epoch: 20
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 129s - loss: 0.2484 - accuracy: 0.8337 - 129s/epoch - 463ms/step
Epoch 21/110
Validation cm: [[407  27 238  11]
 [314 100 161  25]
 [ 30   8 174  28]
 [ 18   3  65   6]]
Validation val_loss: 0.7160787291504765
Validation normalized_cm: [[0.596 0.04  0.348 0.016]
 [0.523 0.167 0.268 0.042]
 [0.125 0.033 0.725 0.117]
 [0.196 0.033 0.707 0.065]]
Validation acc: 0.42538699690402476
Validation class_accuracies: [0.595900439238653, 0.16666666666666666, 0.725, 0.06521739130434782]
Validation sensitivity: 0.30042918454935624
Validation specificity: 0.595900439238653
Validation icbhi_score: 0.4481648118940046
Validation roc_auc: None
Validation avg_accuracy: 0.38819612430241685
Validation one_indexed_epoch: 21
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 4 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 129s - loss: 0.2371 - accuracy: 0.8326 - 129s/epoch - 463ms/step
Epoch 22/110
Validation cm: [[486  19 172   6]
 [372  63 149  16]
 [ 31   1 179  29]
 [ 20   4  66   2]]
Validation val_loss: 0.7621838795012527
Validation normalized_cm: [[0.712 0.028 0.252 0.009]
 [0.62  0.105 0.248 0.027]
 [0.129 0.004 0.746 0.121]
 [0.217 0.043 0.717 0.022]]
Validation acc: 0.4520123839009288
Validation class_accuracies: [0.7115666178623719, 0.105, 0.7458333333333333, 0.021739130434782608]
Validation sensitivity: 0.26180257510729615
Validation specificity: 0.7115666178623719
Validation icbhi_score: 0.486684596484834
Validation roc_auc: None
Validation avg_accuracy: 0.39603477040762197
Validation one_indexed_epoch: 22
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
279/279 - 129s - loss: 0.2242 - accuracy: 0.8369 - 129s/epoch - 462ms/step
Epoch 23/110
Validation cm: [[442  87 144  10]
 [317 166  81  36]
 [ 28  21 149  42]
 [ 26   8  50   8]]
Validation val_loss: 0.6593962976350751
Validation normalized_cm: [[0.647 0.127 0.211 0.015]
 [0.528 0.277 0.135 0.06 ]
 [0.117 0.087 0.621 0.175]
 [0.283 0.087 0.543 0.087]]
Validation acc: 0.47368421052631576
Validation class_accuracies: [0.6471449487554904, 0.27666666666666667, 0.6208333333333333, 0.08695652173913043]
Validation sensitivity: 0.3465665236051502
Validation specificity: 0.6471449487554904
Validation icbhi_score: 0.4968557361803203
Validation roc_auc: None
Validation avg_accuracy: 0.4079003676236552
Validation one_indexed_epoch: 23
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 6 epochs
There is no such attribute
279/279 - 129s - loss: 0.2084 - accuracy: 0.8243 - 129s/epoch - 463ms/step
Epoch 24/110
Validation cm: [[479 132  49  23]
 [245 272  45  38]
 [ 28  15 125  72]
 [ 19  14  45  14]]
Validation val_loss: 0.5801879663662639
Validation normalized_cm: [[0.701 0.193 0.072 0.034]
 [0.408 0.453 0.075 0.063]
 [0.117 0.062 0.521 0.3  ]
 [0.207 0.152 0.489 0.152]]
Validation acc: 0.5510835913312694
Validation class_accuracies: [0.7013177159590044, 0.4533333333333333, 0.5208333333333334, 0.15217391304347827]
Validation sensitivity: 0.4409871244635193
Validation specificity: 0.7013177159590044
Validation icbhi_score: 0.5711524202112619
Validation roc_auc: None
Validation avg_accuracy: 0.45691457391728735
Validation one_indexed_epoch: 24
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 7 epochs
There is no such attribute
279/279 - 129s - loss: 0.2127 - accuracy: 0.8285 - 129s/epoch - 462ms/step
Epoch 25/110
Validation cm: [[407 160  96  20]
 [209 309  38  44]
 [ 27  28  86  99]
 [ 18  18  35  21]]
Validation val_loss: 0.6576917844056801
Validation normalized_cm: [[0.596 0.234 0.141 0.029]
 [0.348 0.515 0.063 0.073]
 [0.113 0.117 0.358 0.412]
 [0.196 0.196 0.38  0.228]]
Validation acc: 0.5095975232198142
Validation class_accuracies: [0.595900439238653, 0.515, 0.35833333333333334, 0.22826086956521738]
Validation sensitivity: 0.44635193133047213
Validation specificity: 0.595900439238653
Validation icbhi_score: 0.5211261852845626
Validation roc_auc: None
Validation avg_accuracy: 0.4243736605343009
Validation one_indexed_epoch: 25
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 8 epochs
There is no such attribute
279/279 - 129s - loss: 0.2009 - accuracy: 0.8443 - 129s/epoch - 462ms/step
Epoch 26/110
Validation cm: [[304 276  57  46]
 [129 391  23  57]
 [ 23  44  61 112]
 [ 10  35  25  22]]
Validation val_loss: 0.6752867321864393
Validation normalized_cm: [[0.445 0.404 0.083 0.067]
 [0.215 0.652 0.038 0.095]
 [0.096 0.183 0.254 0.467]
 [0.109 0.38  0.272 0.239]]
Validation acc: 0.48173374613003095
Validation class_accuracies: [0.445095168374817, 0.6516666666666666, 0.25416666666666665, 0.2391304347826087]
Validation sensitivity: 0.5085836909871244
Validation specificity: 0.445095168374817
Validation icbhi_score: 0.4768394296809707
Validation roc_auc: None
Validation avg_accuracy: 0.39751473412268973
Validation one_indexed_epoch: 26
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 9 epochs
There is no such attribute
279/279 - 130s - loss: 0.1962 - accuracy: 0.8312 - 130s/epoch - 466ms/step
Epoch 27/110
Validation cm: [[446  43 159  35]
 [331 130  98  41]
 [ 41  13 120  66]
 [ 27   9  44  12]]
Validation val_loss: 0.7696321393199548
Validation normalized_cm: [[0.653 0.063 0.233 0.051]
 [0.552 0.217 0.163 0.068]
 [0.171 0.054 0.5   0.275]
 [0.293 0.098 0.478 0.13 ]]
Validation acc: 0.43839009287925695
Validation class_accuracies: [0.6530014641288433, 0.21666666666666667, 0.5, 0.13043478260869565]
Validation sensitivity: 0.2811158798283262
Validation specificity: 0.6530014641288433
Validation icbhi_score: 0.46705867197858475
Validation roc_auc: None
Validation avg_accuracy: 0.37502572835105136
Validation one_indexed_epoch: 27
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
279/279 - 130s - loss: 0.1906 - accuracy: 0.8344 - 130s/epoch - 465ms/step
Epoch 28/110
Validation cm: [[393 149  90  51]
 [193 240  60 107]
 [ 22  14 102 102]
 [ 13  11  42  26]]
Validation val_loss: 0.7390677646640111
Validation normalized_cm: [[0.575 0.218 0.132 0.075]
 [0.322 0.4   0.1   0.178]
 [0.092 0.058 0.425 0.425]
 [0.141 0.12  0.457 0.283]]
Validation acc: 0.4712074303405573
Validation class_accuracies: [0.575402635431918, 0.4, 0.425, 0.2826086956521739]
Validation sensitivity: 0.3948497854077253
Validation specificity: 0.575402635431918
Validation icbhi_score: 0.4851262104198217
Validation roc_auc: None
Validation avg_accuracy: 0.420752832771023
Validation one_indexed_epoch: 28
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 11 epochs
There is no such attribute
279/279 - 130s - loss: 0.1792 - accuracy: 0.8387 - 130s/epoch - 466ms/step
Epoch 29/110
Validation cm: [[484 105  61  33]
 [218 249  47  86]
 [ 33  11 105  91]
 [ 17  11  43  21]]
Validation val_loss: 0.7038513360999167
Validation normalized_cm: [[0.709 0.154 0.089 0.048]
 [0.363 0.415 0.078 0.143]
 [0.138 0.046 0.438 0.379]
 [0.185 0.12  0.467 0.228]]
Validation acc: 0.5318885448916408
Validation class_accuracies: [0.7086383601756955, 0.415, 0.4375, 0.22826086956521738]
Validation sensitivity: 0.40236051502145925
Validation specificity: 0.7086383601756955
Validation icbhi_score: 0.5554994375985773
Validation roc_auc: None
Validation avg_accuracy: 0.4473498074352282
Validation one_indexed_epoch: 29
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 12 epochs
There is no such attribute
279/279 - 130s - loss: 0.1926 - accuracy: 0.8400 - 130s/epoch - 465ms/step
Epoch 30/110
Validation cm: [[483 117  69  14]
 [245 281  43  31]
 [ 38  21 115  66]
 [ 25  15  43   9]]
Validation val_loss: 0.679149870781499
Validation normalized_cm: [[0.707 0.171 0.101 0.02 ]
 [0.408 0.468 0.072 0.052]
 [0.158 0.087 0.479 0.275]
 [0.272 0.163 0.467 0.098]]
Validation acc: 0.5498452012383901
Validation class_accuracies: [0.7071742313323572, 0.4683333333333333, 0.4791666666666667, 0.09782608695652174]
Validation sensitivity: 0.434549356223176
Validation specificity: 0.7071742313323572
Validation icbhi_score: 0.5708617937777666
Validation roc_auc: None
Validation avg_accuracy: 0.43812507957221974
Validation one_indexed_epoch: 30
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 13 epochs
There is no such attribute
279/279 - 130s - loss: 0.1793 - accuracy: 0.8411 - 130s/epoch - 466ms/step
Epoch 31/110
Validation cm: [[372 189  64  58]
 [138 281  43 138]
 [ 25  12  73 130]
 [  6  17  36  33]]
Validation val_loss: 0.7759317388762388
Validation normalized_cm: [[0.545 0.277 0.094 0.085]
 [0.23  0.468 0.072 0.23 ]
 [0.104 0.05  0.304 0.542]
 [0.065 0.185 0.391 0.359]]
Validation acc: 0.469969040247678
Validation class_accuracies: [0.5446559297218155, 0.4683333333333333, 0.30416666666666664, 0.358695652173913]
Validation sensitivity: 0.41523605150214593
Validation specificity: 0.5446559297218155
Validation icbhi_score: 0.47994599061198073
Validation roc_auc: None
Validation avg_accuracy: 0.4189628954739322
Validation one_indexed_epoch: 31
The validation tracker metric at 0.6313772865231024 hasn't increased by 0 in 14 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 130s - loss: 0.1781 - accuracy: 0.8389 - 130s/epoch - 465ms/step
Epoch 32/110
Validation cm: [[503 132  31  17]
 [212 319  23  46]
 [ 31  19 115  75]
 [ 23  12  44  13]]
Validation val_loss: 0.654675529904142
Validation normalized_cm: [[0.736 0.193 0.045 0.025]
 [0.353 0.532 0.038 0.077]
 [0.129 0.079 0.479 0.312]
 [0.25  0.13  0.478 0.141]]
Validation acc: 0.5882352941176471
Validation class_accuracies: [0.7364568081991215, 0.5316666666666666, 0.4791666666666667, 0.14130434782608695]
Validation sensitivity: 0.4796137339055794
Validation specificity: 0.7364568081991215
Validation icbhi_score: 0.6080352710523504
Validation roc_auc: None
Validation avg_accuracy: 0.47214862233963545
Validation one_indexed_epoch: 32
The number of epochs since last 1% equals the patience
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
279/279 - 130s - loss: 0.1688 - accuracy: 0.8378 - 130s/epoch - 466ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.6313772865231024
Best cm: [[562  94  19   8]
 [275 287  23  15]
 [ 51  30 112  47]
 [ 28  15  38  11]]
Best val_loss: 0.5285965738154879
Best normalized_cm: [[0.823 0.138 0.028 0.012]
 [0.458 0.478 0.038 0.025]
 [0.212 0.125 0.467 0.196]
 [0.304 0.163 0.413 0.12 ]]
Best acc: 0.6018575851393189
Best class_accuracies: [0.8228404099560761, 0.47833333333333333, 0.4666666666666667, 0.11956521739130435]
Best sensitivity: 0.43991416309012876
Best specificity: 0.8228404099560761
Best roc_auc: None
Best avg_accuracy: 0.4718514068368452
Best one_indexed_epoch: 17
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7036612033843994, 0.683196485042572, 0.6557749509811401, 0.628597617149353, 0.586794912815094, 0.5575665235519409, 0.5309399962425232, 0.5086566209793091, 0.46975722908973694, 0.46296387910842896, 0.43884846568107605, 0.4143150746822357, 0.3805483281612396, 0.36965081095695496, 0.35318490862846375, 0.3199480175971985, 0.2924242317676544, 0.2687055766582489, 0.2591123878955841, 0.2483961284160614, 0.23713839054107666, 0.22418434917926788, 0.2084386944770813, 0.212697371840477, 0.20087848603725433, 0.19615714251995087, 0.19060000777244568, 0.17922234535217285, 0.19264712929725647, 0.17926166951656342, 0.17805719375610352, 0.1687508225440979], 'accuracy': [0.5429213643074036, 0.5256179571151733, 0.5815730094909668, 0.6143820285797119, 0.6564044952392578, 0.6948314309120178, 0.7139325737953186, 0.726516842842102, 0.7332584261894226, 0.7494382262229919, 0.750786542892456, 0.7602246999740601, 0.7683145999908447, 0.7804494500160217, 0.7871910333633423, 0.8155056238174438, 0.814382016658783, 0.8170786499977112, 0.8170786499977112, 0.833707869052887, 0.8325842618942261, 0.8368539214134216, 0.8242696523666382, 0.8285393118858337, 0.8442696332931519, 0.831235945224762, 0.8343819975852966, 0.8386516571044922, 0.8399999737739563, 0.8411235809326172, 0.8388764262199402, 0.8377528190612793]}
End
####################################
Job id is 8.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4654 elements, with 2259 none's, 1302 crakles, 583 wheezes and 510 both ---
--- Final Validation dataset contains 1411 elements, with 619 none, 532 crackles, 134 wheezes and 126 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5150509074811863, 1: 0.8936251920122887, 2: 1.995711835334477, 3: 2.2813725490196077}
Model: "sequential_6"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_6   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_18 (Dense)            (None, 100)               128100    
                                                                 
 dropout_12 (Dropout)        (None, 100)               0         
                                                                 
 dense_19 (Dense)            (None, 50)                5050      
                                                                 
 dropout_13 (Dropout)        (None, 50)                0         
                                                                 
 dense_20 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_6"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_12 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_13 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_6 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  5 185   0 429]
 [  3 135   0 394]
 [  0  27   0 107]
 [  0  33   0  93]]
Validation val_loss: 0.734447369395546
Validation normalized_cm: [[0.008 0.299 0.    0.693]
 [0.006 0.254 0.    0.741]
 [0.    0.201 0.    0.799]
 [0.    0.262 0.    0.738]]
Validation acc: 0.16513111268603828
Validation class_accuracies: [0.008077544426494346, 0.25375939849624063, 0.0, 0.7380952380952381]
Validation sensitivity: 0.2878787878787879
Validation specificity: 0.008077544426494346
Validation icbhi_score: 0.14797816615264112
Validation roc_auc: None
Validation avg_accuracy: 0.24998304525449327
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
291/291 - 132s - loss: 0.6960 - accuracy: 0.5178 - 132s/epoch - 454ms/step
Epoch 2/110
Validation cm: [[105 176  48 290]
 [ 68 166  26 272]
 [ 11  22  16  85]
 [ 13  41  10  62]]
Validation val_loss: 0.695263919236388
Validation normalized_cm: [[0.17  0.284 0.078 0.468]
 [0.128 0.312 0.049 0.511]
 [0.082 0.164 0.119 0.634]
 [0.103 0.325 0.079 0.492]]
Validation acc: 0.24734231041814317
Validation class_accuracies: [0.16962843295638125, 0.31203007518796994, 0.11940298507462686, 0.49206349206349204]
Validation sensitivity: 0.30808080808080807
Validation specificity: 0.16962843295638125
Validation icbhi_score: 0.23885462051859466
Validation roc_auc: None
Validation avg_accuracy: 0.2732812463206175
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
291/291 - 118s - loss: 0.6700 - accuracy: 0.5230 - 118s/epoch - 405ms/step
Epoch 3/110
Validation cm: [[425  35  97  62]
 [297  67  96  72]
 [ 46   1  59  28]
 [ 39   4  61  22]]
Validation val_loss: 0.6561168742720579
Validation normalized_cm: [[0.687 0.057 0.157 0.1  ]
 [0.558 0.126 0.18  0.135]
 [0.343 0.007 0.44  0.209]
 [0.31  0.032 0.484 0.175]]
Validation acc: 0.406094968107725
Validation class_accuracies: [0.6865912762520194, 0.12593984962406016, 0.44029850746268656, 0.1746031746031746]
Validation sensitivity: 0.18686868686868688
Validation specificity: 0.6865912762520194
Validation icbhi_score: 0.43672998156035314
Validation roc_auc: None
Validation avg_accuracy: 0.3568582019854852
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
291/291 - 118s - loss: 0.6417 - accuracy: 0.5793 - 118s/epoch - 406ms/step
Epoch 4/110
Validation cm: [[479  47  44  49]
 [410  82  19  21]
 [ 83  11  27  13]
 [ 86   9  26   5]]
Validation val_loss: 0.6322694781990781
Validation normalized_cm: [[0.774 0.076 0.071 0.079]
 [0.771 0.154 0.036 0.039]
 [0.619 0.082 0.201 0.097]
 [0.683 0.071 0.206 0.04 ]]
Validation acc: 0.42026931254429484
Validation class_accuracies: [0.7738287560581584, 0.15413533834586465, 0.20149253731343283, 0.03968253968253968]
Validation sensitivity: 0.14393939393939395
Validation specificity: 0.7738287560581584
Validation icbhi_score: 0.45888407499877615
Validation roc_auc: None
Validation avg_accuracy: 0.2922847928499989
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
291/291 - 118s - loss: 0.6017 - accuracy: 0.5862 - 118s/epoch - 406ms/step
Epoch 5/110
Validation cm: [[458 104  16  41]
 [250 216  19  47]
 [ 51  11  37  35]
 [ 48  26  26  26]]
Validation val_loss: 0.5558752513191617
Validation normalized_cm: [[0.74  0.168 0.026 0.066]
 [0.47  0.406 0.036 0.088]
 [0.381 0.082 0.276 0.261]
 [0.381 0.206 0.206 0.206]]
Validation acc: 0.5223245924875974
Validation class_accuracies: [0.7399030694668821, 0.40601503759398494, 0.27611940298507465, 0.20634920634920634]
Validation sensitivity: 0.3522727272727273
Validation specificity: 0.7399030694668821
Validation icbhi_score: 0.5460878983698048
Validation roc_auc: None
Validation avg_accuracy: 0.407096679098787
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
291/291 - 119s - loss: 0.5706 - accuracy: 0.6218 - 119s/epoch - 408ms/step
Epoch 6/110
Validation cm: [[255 342  12  10]
 [160 346  11  15]
 [ 29  50  40  15]
 [ 31  54  14  27]]
Validation val_loss: 0.5553406768661285
Validation normalized_cm: [[0.412 0.553 0.019 0.016]
 [0.301 0.65  0.021 0.028]
 [0.216 0.373 0.299 0.112]
 [0.246 0.429 0.111 0.214]]
Validation acc: 0.47342310418143163
Validation class_accuracies: [0.41195476575121165, 0.650375939849624, 0.29850746268656714, 0.21428571428571427]
Validation sensitivity: 0.5214646464646465
Validation specificity: 0.41195476575121165
Validation icbhi_score: 0.46670970610792906
Validation roc_auc: None
Validation avg_accuracy: 0.39378097064327927
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 117s - loss: 0.5271 - accuracy: 0.6549 - 117s/epoch - 403ms/step
Epoch 7/110
Validation cm: [[515  22  67  15]
 [443  24  56   9]
 [ 66   2  62   4]
 [ 70   3  49   4]]
Validation val_loss: 0.6208830978919394
Validation normalized_cm: [[0.832 0.036 0.108 0.024]
 [0.833 0.045 0.105 0.017]
 [0.493 0.015 0.463 0.03 ]
 [0.556 0.024 0.389 0.032]]
Validation acc: 0.4287739192062367
Validation class_accuracies: [0.8319870759289176, 0.045112781954887216, 0.4626865671641791, 0.031746031746031744]
Validation sensitivity: 0.11363636363636363
Validation specificity: 0.8319870759289176
Validation icbhi_score: 0.47281171978264064
Validation roc_auc: None
Validation avg_accuracy: 0.3428831141985039
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 118s - loss: 0.5046 - accuracy: 0.6807 - 118s/epoch - 407ms/step
Epoch 8/110
Validation cm: [[266 302  27  24]
 [133 359  13  27]
 [ 43  30  38  23]
 [ 52  41  20  13]]
Validation val_loss: 0.5473178675956628
Validation normalized_cm: [[0.43  0.488 0.044 0.039]
 [0.25  0.675 0.024 0.051]
 [0.321 0.224 0.284 0.172]
 [0.413 0.325 0.159 0.103]]
Validation acc: 0.47909284195605956
Validation class_accuracies: [0.4297253634894992, 0.674812030075188, 0.2835820895522388, 0.10317460317460317]
Validation sensitivity: 0.5176767676767676
Validation specificity: 0.4297253634894992
Validation icbhi_score: 0.4737010655831334
Validation roc_auc: None
Validation avg_accuracy: 0.3728235215728823
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 3 epochs
There is no such attribute
291/291 - 118s - loss: 0.4761 - accuracy: 0.7089 - 118s/epoch - 406ms/step
Epoch 9/110
Validation cm: [[519  74  26   0]
 [401  80  47   4]
 [ 50  22  54   8]
 [ 63   2  59   2]]
Validation val_loss: 0.6009147954031476
Validation normalized_cm: [[0.838 0.12  0.042 0.   ]
 [0.754 0.15  0.088 0.008]
 [0.373 0.164 0.403 0.06 ]
 [0.5   0.016 0.468 0.016]]
Validation acc: 0.46420978029766125
Validation class_accuracies: [0.8384491114701131, 0.15037593984962405, 0.40298507462686567, 0.015873015873015872]
Validation sensitivity: 0.1717171717171717
Validation specificity: 0.8384491114701131
Validation icbhi_score: 0.5050831415936424
Validation roc_auc: None
Validation avg_accuracy: 0.3519207854549047
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 4 epochs
There is no such attribute
291/291 - 118s - loss: 0.4537 - accuracy: 0.7248 - 118s/epoch - 406ms/step
Epoch 10/110
Validation cm: [[384 229   3   3]
 [198 334   0   0]
 [ 65  43  14  12]
 [ 64  46   9   7]]
Validation val_loss: 0.5639974381339035
Validation normalized_cm: [[0.62  0.37  0.005 0.005]
 [0.372 0.628 0.    0.   ]
 [0.485 0.321 0.104 0.09 ]
 [0.508 0.365 0.071 0.056]]
Validation acc: 0.5237420269312544
Validation class_accuracies: [0.6203554119547657, 0.6278195488721805, 0.1044776119402985, 0.05555555555555555]
Validation sensitivity: 0.44823232323232326
Validation specificity: 0.6203554119547657
Validation icbhi_score: 0.5342938675935445
Validation roc_auc: None
Validation avg_accuracy: 0.3520520320807001
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
291/291 - 119s - loss: 0.4353 - accuracy: 0.7248 - 119s/epoch - 408ms/step
Epoch 11/110
Validation cm: [[352 233  28   6]
 [159 320  15  38]
 [ 33  27  38  36]
 [ 21  33  29  43]]
Validation val_loss: 0.5291616427484427
Validation normalized_cm: [[0.569 0.376 0.045 0.01 ]
 [0.299 0.602 0.028 0.071]
 [0.246 0.201 0.284 0.269]
 [0.167 0.262 0.23  0.341]]
Validation acc: 0.5336640680368533
Validation class_accuracies: [0.568659127625202, 0.6015037593984962, 0.2835820895522388, 0.3412698412698413]
Validation sensitivity: 0.5063131313131313
Validation specificity: 0.568659127625202
Validation icbhi_score: 0.5374861294691666
Validation roc_auc: None
Validation avg_accuracy: 0.4487537044614446
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 6 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
291/291 - 118s - loss: 0.4041 - accuracy: 0.7404 - 118s/epoch - 405ms/step
Epoch 12/110
Validation cm: [[371 160  30  58]
 [181 273  33  45]
 [ 36  12  59  27]
 [ 25  23  49  29]]
Validation val_loss: 0.6314320088114027
Validation normalized_cm: [[0.599 0.258 0.048 0.094]
 [0.34  0.513 0.062 0.085]
 [0.269 0.09  0.44  0.201]
 [0.198 0.183 0.389 0.23 ]]
Validation acc: 0.518781006378455
Validation class_accuracies: [0.5993537964458805, 0.5131578947368421, 0.44029850746268656, 0.23015873015873015]
Validation sensitivity: 0.45580808080808083
Validation specificity: 0.5993537964458805
Validation icbhi_score: 0.5275809386269806
Validation roc_auc: None
Validation avg_accuracy: 0.44574223220103487
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 7 epochs
There is no such attribute
291/291 - 119s - loss: 0.3975 - accuracy: 0.7501 - 119s/epoch - 409ms/step
Epoch 13/110
Validation cm: [[173 332  45  69]
 [ 65 341  20 106]
 [ 21  22  21  70]
 [  8  29  22  67]]
Validation val_loss: 0.6487924970137279
Validation normalized_cm: [[0.279 0.536 0.073 0.111]
 [0.122 0.641 0.038 0.199]
 [0.157 0.164 0.157 0.522]
 [0.063 0.23  0.175 0.532]]
Validation acc: 0.42664776754075123
Validation class_accuracies: [0.27948303715670436, 0.6409774436090225, 0.15671641791044777, 0.5317460317460317]
Validation sensitivity: 0.5416666666666666
Validation specificity: 0.27948303715670436
Validation icbhi_score: 0.4105748519116855
Validation roc_auc: None
Validation avg_accuracy: 0.40223073260555153
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 8 epochs
There is no such attribute
291/291 - 119s - loss: 0.3762 - accuracy: 0.7525 - 119s/epoch - 408ms/step
Epoch 14/110
Validation cm: [[109 489   1  20]
 [ 26 499   0   7]
 [ 17  66  15  36]
 [ 11  81   3  31]]
Validation val_loss: 0.6518858208675479
Validation normalized_cm: [[0.176 0.79  0.002 0.032]
 [0.049 0.938 0.    0.013]
 [0.127 0.493 0.112 0.269]
 [0.087 0.643 0.024 0.246]]
Validation acc: 0.4635010630758327
Validation class_accuracies: [0.17609046849757673, 0.9379699248120301, 0.11194029850746269, 0.24603174603174602]
Validation sensitivity: 0.6881313131313131
Validation specificity: 0.17609046849757673
Validation icbhi_score: 0.4321108908144449
Validation roc_auc: None
Validation avg_accuracy: 0.3680081094622039
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 9 epochs
There is no such attribute
291/291 - 119s - loss: 0.3639 - accuracy: 0.7694 - 119s/epoch - 408ms/step
Epoch 15/110
Validation cm: [[362 155  46  56]
 [167 272  35  58]
 [ 35  11  45  43]
 [ 21  21  58  26]]
Validation val_loss: 0.6382678597597874
Validation normalized_cm: [[0.585 0.25  0.074 0.09 ]
 [0.314 0.511 0.066 0.109]
 [0.261 0.082 0.336 0.321]
 [0.167 0.167 0.46  0.206]]
Validation acc: 0.49964564138908574
Validation class_accuracies: [0.5848142164781907, 0.5112781954887218, 0.3358208955223881, 0.20634920634920634]
Validation sensitivity: 0.43308080808080807
Validation specificity: 0.5848142164781907
Validation icbhi_score: 0.5089475122794993
Validation roc_auc: None
Validation avg_accuracy: 0.4095656284596267
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
291/291 - 118s - loss: 0.3454 - accuracy: 0.7578 - 118s/epoch - 406ms/step
Epoch 16/110
Validation cm: [[429 142  22  26]
 [245 238  16  33]
 [ 45  10  39  40]
 [ 33  29  37  27]]
Validation val_loss: 0.5805693881729423
Validation normalized_cm: [[0.693 0.229 0.036 0.042]
 [0.461 0.447 0.03  0.062]
 [0.336 0.075 0.291 0.299]
 [0.262 0.23  0.294 0.214]]
Validation acc: 0.5194897236002834
Validation class_accuracies: [0.6930533117932148, 0.4473684210526316, 0.291044776119403, 0.21428571428571427]
Validation sensitivity: 0.3838383838383838
Validation specificity: 0.6930533117932148
Validation icbhi_score: 0.5384458478157993
Validation roc_auc: None
Validation avg_accuracy: 0.4114380558127409
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 11 epochs
There is no such attribute
291/291 - 119s - loss: 0.3412 - accuracy: 0.7619 - 119s/epoch - 408ms/step
Epoch 17/110
Validation cm: [[381 178  27  33]
 [196 272  21  43]
 [ 36  18  36  44]
 [ 34  20  46  26]]
Validation val_loss: 0.6156680148697513
Validation normalized_cm: [[0.616 0.288 0.044 0.053]
 [0.368 0.511 0.039 0.081]
 [0.269 0.134 0.269 0.328]
 [0.27  0.159 0.365 0.206]]
Validation acc: 0.5067328136073707
Validation class_accuracies: [0.6155088852988692, 0.5112781954887218, 0.26865671641791045, 0.20634920634920634]
Validation sensitivity: 0.4217171717171717
Validation specificity: 0.6155088852988692
Validation icbhi_score: 0.5186130285080204
Validation roc_auc: None
Validation avg_accuracy: 0.4004482508886769
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5460878983698048 hasn't increased by 0 in 12 epochs
There is no such attribute
291/291 - 118s - loss: 0.3346 - accuracy: 0.7574 - 118s/epoch - 407ms/step
Epoch 18/110
Validation cm: [[369 217  14  19]
 [174 329   7  22]
 [ 40  22  34  38]
 [ 42  34  19  31]]
Validation val_loss: 0.5841831494324717
Validation normalized_cm: [[0.596 0.351 0.023 0.031]
 [0.327 0.618 0.013 0.041]
 [0.299 0.164 0.254 0.284]
 [0.333 0.27  0.151 0.246]]
Validation acc: 0.5407512402551382
Validation class_accuracies: [0.5961227786752827, 0.618421052631579, 0.2537313432835821, 0.24603174603174602]
Validation sensitivity: 0.49747474747474746
Validation specificity: 0.5961227786752827
Validation icbhi_score: 0.5467987630750151
Validation roc_auc: None
Validation avg_accuracy: 0.4285767301555475
Validation one_indexed_epoch: 18
-- New best results were achieved. --
There is no such attribute
291/291 - 119s - loss: 0.3215 - accuracy: 0.7613 - 119s/epoch - 410ms/step
Epoch 19/110
Validation cm: [[380 164  20  55]
 [184 284  20  44]
 [ 39  13  49  33]
 [ 27  28  36  35]]
Validation val_loss: 0.6469133238985997
Validation normalized_cm: [[0.614 0.265 0.032 0.089]
 [0.346 0.534 0.038 0.083]
 [0.291 0.097 0.366 0.246]
 [0.214 0.222 0.286 0.278]]
Validation acc: 0.5301204819277109
Validation class_accuracies: [0.6138933764135702, 0.5338345864661654, 0.3656716417910448, 0.2777777777777778]
Validation sensitivity: 0.46464646464646464
Validation specificity: 0.6138933764135702
Validation icbhi_score: 0.5392699205300174
Validation roc_auc: None
Validation avg_accuracy: 0.4477943456121396
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5467987630750151 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 120s - loss: 0.3114 - accuracy: 0.7636 - 120s/epoch - 412ms/step
Epoch 20/110
Validation cm: [[234 344  15  26]
 [103 381   7  41]
 [ 23  29  32  50]
 [ 19  44  22  41]]
Validation val_loss: 0.6467809014426298
Validation normalized_cm: [[0.378 0.556 0.024 0.042]
 [0.194 0.716 0.013 0.077]
 [0.172 0.216 0.239 0.373]
 [0.151 0.349 0.175 0.325]]
Validation acc: 0.4875974486180014
Validation class_accuracies: [0.3780290791599354, 0.7161654135338346, 0.23880597014925373, 0.3253968253968254]
Validation sensitivity: 0.5732323232323232
Validation specificity: 0.3780290791599354
Validation icbhi_score: 0.47563070119612927
Validation roc_auc: None
Validation avg_accuracy: 0.41459932205996225
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5467987630750151 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 119s - loss: 0.3087 - accuracy: 0.7714 - 119s/epoch - 408ms/step
Epoch 21/110
Validation cm: [[260 322  16  21]
 [120 381   5  26]
 [ 23  32  27  52]
 [ 20  45  21  40]]
Validation val_loss: 0.6167742385275524
Validation normalized_cm: [[0.42  0.52  0.026 0.034]
 [0.226 0.716 0.009 0.049]
 [0.172 0.239 0.201 0.388]
 [0.159 0.357 0.167 0.317]]
Validation acc: 0.5017717930545712
Validation class_accuracies: [0.420032310177706, 0.7161654135338346, 0.20149253731343283, 0.31746031746031744]
Validation sensitivity: 0.5656565656565656
Validation specificity: 0.420032310177706
Validation icbhi_score: 0.49284443791713584
Validation roc_auc: None
Validation avg_accuracy: 0.4137876446213227
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5467987630750151 hasn't increased by 0 in 3 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
291/291 - 119s - loss: 0.2957 - accuracy: 0.7720 - 119s/epoch - 409ms/step
Epoch 22/110
Validation cm: [[228 302  40  49]
 [ 95 347  24  66]
 [ 25  25  21  63]
 [  8  36  25  57]]
Validation val_loss: 0.6579693714526371
Validation normalized_cm: [[0.368 0.488 0.065 0.079]
 [0.179 0.652 0.045 0.124]
 [0.187 0.187 0.157 0.47 ]
 [0.063 0.286 0.198 0.452]]
Validation acc: 0.46279234585400425
Validation class_accuracies: [0.3683360258481422, 0.6522556390977443, 0.15671641791044777, 0.4523809523809524]
Validation sensitivity: 0.5366161616161617
Validation specificity: 0.3683360258481422
Validation icbhi_score: 0.4524760937321519
Validation roc_auc: None
Validation avg_accuracy: 0.40742225880932165
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5467987630750151 hasn't increased by 0 in 4 epochs
There is no such attribute
291/291 - 119s - loss: 0.2867 - accuracy: 0.7770 - 119s/epoch - 410ms/step
Epoch 23/110
Validation cm: [[453  77  39  50]
 [236 228  27  41]
 [ 42  10  53  29]
 [ 34  24  44  24]]
Validation val_loss: 0.6896463781456621
Validation normalized_cm: [[0.732 0.124 0.063 0.081]
 [0.444 0.429 0.051 0.077]
 [0.313 0.075 0.396 0.216]
 [0.27  0.19  0.349 0.19 ]]
Validation acc: 0.5372076541459957
Validation class_accuracies: [0.7318255250403877, 0.42857142857142855, 0.39552238805970147, 0.19047619047619047]
Validation sensitivity: 0.3851010101010101
Validation specificity: 0.7318255250403877
Validation icbhi_score: 0.5584632675706989
Validation roc_auc: None
Validation avg_accuracy: 0.436598883036927
Validation one_indexed_epoch: 23
-- New best results were achieved. --
There is no such attribute
291/291 - 119s - loss: 0.2813 - accuracy: 0.7750 - 119s/epoch - 408ms/step
Epoch 24/110
Validation cm: [[264 317  13  25]
 [107 362  10  53]
 [ 31  26  22  55]
 [ 33  40  18  35]]
Validation val_loss: 0.6454954618412518
Validation normalized_cm: [[0.426 0.512 0.021 0.04 ]
 [0.201 0.68  0.019 0.1  ]
 [0.231 0.194 0.164 0.41 ]
 [0.262 0.317 0.143 0.278]]
Validation acc: 0.48405386250885896
Validation class_accuracies: [0.42649434571890144, 0.6804511278195489, 0.16417910447761194, 0.2777777777777778]
Validation sensitivity: 0.5290404040404041
Validation specificity: 0.42649434571890144
Validation icbhi_score: 0.47776737487965276
Validation roc_auc: None
Validation avg_accuracy: 0.38722558894846004
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 119s - loss: 0.2846 - accuracy: 0.7735 - 119s/epoch - 410ms/step
Epoch 25/110
Validation cm: [[122 408  35  54]
 [ 43 393  13  83]
 [ 17  42  23  52]
 [  5  32  11  78]]
Validation val_loss: 0.746159227119731
Validation normalized_cm: [[0.197 0.659 0.057 0.087]
 [0.081 0.739 0.024 0.156]
 [0.127 0.313 0.172 0.388]
 [0.04  0.254 0.087 0.619]]
Validation acc: 0.4365698086463501
Validation class_accuracies: [0.19709208400646203, 0.7387218045112782, 0.17164179104477612, 0.6190476190476191]
Validation sensitivity: 0.6237373737373737
Validation specificity: 0.19709208400646203
Validation icbhi_score: 0.4104147288719179
Validation roc_auc: None
Validation avg_accuracy: 0.43162582465253385
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 119s - loss: 0.2689 - accuracy: 0.7742 - 119s/epoch - 409ms/step
Epoch 26/110
Validation cm: [[319 233  26  41]
 [170 314  20  28]
 [ 34  26  42  32]
 [ 23  37  38  28]]
Validation val_loss: 0.6403987856138257
Validation normalized_cm: [[0.515 0.376 0.042 0.066]
 [0.32  0.59  0.038 0.053]
 [0.254 0.194 0.313 0.239]
 [0.183 0.294 0.302 0.222]]
Validation acc: 0.4982282069454288
Validation class_accuracies: [0.5153473344103393, 0.5902255639097744, 0.31343283582089554, 0.2222222222222222]
Validation sensitivity: 0.48484848484848486
Validation specificity: 0.5153473344103393
Validation icbhi_score: 0.500097909629412
Validation roc_auc: None
Validation avg_accuracy: 0.41030698909080787
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 3 epochs
There is no such attribute
291/291 - 119s - loss: 0.2671 - accuracy: 0.7742 - 119s/epoch - 408ms/step
Epoch 27/110
Validation cm: [[181 326  38  74]
 [ 59 330  26 117]
 [ 22  26  27  59]
 [  8  26  26  66]]
Validation val_loss: 0.7225056730239163
Validation normalized_cm: [[0.292 0.527 0.061 0.12 ]
 [0.111 0.62  0.049 0.22 ]
 [0.164 0.194 0.201 0.44 ]
 [0.063 0.206 0.206 0.524]]
Validation acc: 0.42806520198440823
Validation class_accuracies: [0.2924071082390953, 0.6203007518796992, 0.20149253731343283, 0.5238095238095238]
Validation sensitivity: 0.5340909090909091
Validation specificity: 0.2924071082390953
Validation icbhi_score: 0.4132490086650022
Validation roc_auc: None
Validation avg_accuracy: 0.4095024803104378
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 4 epochs
There is no such attribute
291/291 - 120s - loss: 0.2581 - accuracy: 0.7826 - 120s/epoch - 412ms/step
Epoch 28/110
Validation cm: [[175 376  20  48]
 [ 68 372   9  83]
 [ 21  27  10  76]
 [ 16  34  18  58]]
Validation val_loss: 0.782206640527653
Validation normalized_cm: [[0.283 0.607 0.032 0.078]
 [0.128 0.699 0.017 0.156]
 [0.157 0.201 0.075 0.567]
 [0.127 0.27  0.143 0.46 ]]
Validation acc: 0.4358610914245216
Validation class_accuracies: [0.2827140549273021, 0.6992481203007519, 0.07462686567164178, 0.4603174603174603]
Validation sensitivity: 0.5555555555555556
Validation specificity: 0.2827140549273021
Validation icbhi_score: 0.4191348052414289
Validation roc_auc: None
Validation avg_accuracy: 0.379226625304289
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
291/291 - 119s - loss: 0.2492 - accuracy: 0.7722 - 119s/epoch - 409ms/step
Epoch 29/110
Validation cm: [[392 145  24  58]
 [206 253  26  47]
 [ 35  16  46  37]
 [ 22  26  41  37]]
Validation val_loss: 0.7208389192707387
Validation normalized_cm: [[0.633 0.234 0.039 0.094]
 [0.387 0.476 0.049 0.088]
 [0.261 0.119 0.343 0.276]
 [0.175 0.206 0.325 0.294]]
Validation acc: 0.515946137491141
Validation class_accuracies: [0.6332794830371568, 0.4755639097744361, 0.34328358208955223, 0.29365079365079366]
Validation sensitivity: 0.42424242424242425
Validation specificity: 0.6332794830371568
Validation icbhi_score: 0.5287609536397905
Validation roc_auc: None
Validation avg_accuracy: 0.43644444213798467
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 6 epochs
There is no such attribute
291/291 - 120s - loss: 0.2443 - accuracy: 0.7761 - 120s/epoch - 411ms/step
Epoch 30/110
Validation cm: [[431  72  61  55]
 [250 164  58  60]
 [ 37   9  61  27]
 [ 21  16  58  31]]
Validation val_loss: 0.8177613462654783
Validation normalized_cm: [[0.696 0.116 0.099 0.089]
 [0.47  0.308 0.109 0.113]
 [0.276 0.067 0.455 0.201]
 [0.167 0.127 0.46  0.246]]
Validation acc: 0.48688873139617295
Validation class_accuracies: [0.6962843295638126, 0.3082706766917293, 0.4552238805970149, 0.24603174603174602]
Validation sensitivity: 0.32323232323232326
Validation specificity: 0.6962843295638126
Validation icbhi_score: 0.509758326398068
Validation roc_auc: None
Validation avg_accuracy: 0.4264526582210757
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 7 epochs
There is no such attribute
291/291 - 120s - loss: 0.2396 - accuracy: 0.7832 - 120s/epoch - 411ms/step
Epoch 31/110
Validation cm: [[338 206  25  50]
 [135 327  17  53]
 [ 41  18  42  33]
 [ 31  26  33  36]]
Validation val_loss: 0.687253851277693
Validation normalized_cm: [[0.546 0.333 0.04  0.081]
 [0.254 0.615 0.032 0.1  ]
 [0.306 0.134 0.313 0.246]
 [0.246 0.206 0.262 0.286]]
Validation acc: 0.5265768958185684
Validation class_accuracies: [0.5460420032310178, 0.6146616541353384, 0.31343283582089554, 0.2857142857142857]
Validation sensitivity: 0.5113636363636364
Validation specificity: 0.5460420032310178
Validation icbhi_score: 0.5287028197973271
Validation roc_auc: None
Validation avg_accuracy: 0.4399626947253844
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 8 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
291/291 - 119s - loss: 0.2346 - accuracy: 0.7785 - 119s/epoch - 409ms/step
Epoch 32/110
Validation cm: [[359 177  28  55]
 [173 267  14  78]
 [ 33  13  41  47]
 [ 23  20  27  56]]
Validation val_loss: 0.7284847954842563
Validation normalized_cm: [[0.58  0.286 0.045 0.089]
 [0.325 0.502 0.026 0.147]
 [0.246 0.097 0.306 0.351]
 [0.183 0.159 0.214 0.444]]
Validation acc: 0.5124025513819985
Validation class_accuracies: [0.5799676898222941, 0.5018796992481203, 0.30597014925373134, 0.4444444444444444]
Validation sensitivity: 0.4595959595959596
Validation specificity: 0.5799676898222941
Validation icbhi_score: 0.5197818247091268
Validation roc_auc: None
Validation avg_accuracy: 0.45806549569214755
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 9 epochs
There is no such attribute
291/291 - 119s - loss: 0.2343 - accuracy: 0.7856 - 119s/epoch - 408ms/step
Epoch 33/110
Validation cm: [[313 255  20  31]
 [113 358   9  52]
 [ 31  31  37  35]
 [ 23  33  24  46]]
Validation val_loss: 0.6282807160139184
Validation normalized_cm: [[0.506 0.412 0.032 0.05 ]
 [0.212 0.673 0.017 0.098]
 [0.231 0.231 0.276 0.261]
 [0.183 0.262 0.19  0.365]]
Validation acc: 0.5343727852586818
Validation class_accuracies: [0.505654281098546, 0.6729323308270677, 0.27611940298507465, 0.36507936507936506]
Validation sensitivity: 0.5568181818181818
Validation specificity: 0.505654281098546
Validation icbhi_score: 0.5312362314583639
Validation roc_auc: None
Validation avg_accuracy: 0.4549463449975134
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
291/291 - 120s - loss: 0.2226 - accuracy: 0.7800 - 120s/epoch - 411ms/step
Epoch 34/110
Validation cm: [[333 233  20  33]
 [159 314  13  46]
 [ 36  20  37  41]
 [ 32  26  23  45]]
Validation val_loss: 0.7148038089878641
Validation normalized_cm: [[0.538 0.376 0.032 0.053]
 [0.299 0.59  0.024 0.086]
 [0.269 0.149 0.276 0.306]
 [0.254 0.206 0.183 0.357]]
Validation acc: 0.5166548547129696
Validation class_accuracies: [0.5379644588045234, 0.5902255639097744, 0.27611940298507465, 0.35714285714285715]
Validation sensitivity: 0.5
Validation specificity: 0.5379644588045234
Validation icbhi_score: 0.5189822294022617
Validation roc_auc: None
Validation avg_accuracy: 0.4403630707105574
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 11 epochs
There is no such attribute
291/291 - 119s - loss: 0.2218 - accuracy: 0.7905 - 119s/epoch - 409ms/step
Epoch 35/110
Validation cm: [[345 212  22  40]
 [133 337  13  49]
 [ 37  18  37  42]
 [ 25  23  27  51]]
Validation val_loss: 0.6423580045422406
Validation normalized_cm: [[0.557 0.342 0.036 0.065]
 [0.25  0.633 0.024 0.092]
 [0.276 0.134 0.276 0.313]
 [0.198 0.183 0.214 0.405]]
Validation acc: 0.5457122608079377
Validation class_accuracies: [0.5573505654281099, 0.6334586466165414, 0.27611940298507465, 0.40476190476190477]
Validation sensitivity: 0.5366161616161617
Validation specificity: 0.5573505654281099
Validation icbhi_score: 0.5469833635221357
Validation roc_auc: None
Validation avg_accuracy: 0.4679226299479077
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 12 epochs
There is no such attribute
291/291 - 120s - loss: 0.2325 - accuracy: 0.7757 - 120s/epoch - 413ms/step
Epoch 36/110
Validation cm: [[306 244  24  45]
 [153 275  19  85]
 [ 34  14  35  51]
 [ 22  21  26  57]]
Validation val_loss: 0.7541149266709031
Validation normalized_cm: [[0.494 0.394 0.039 0.073]
 [0.288 0.517 0.036 0.16 ]
 [0.254 0.104 0.261 0.381]
 [0.175 0.167 0.206 0.452]]
Validation acc: 0.47696669029057404
Validation class_accuracies: [0.49434571890145396, 0.5169172932330827, 0.26119402985074625, 0.4523809523809524]
Validation sensitivity: 0.4633838383838384
Validation specificity: 0.49434571890145396
Validation icbhi_score: 0.4788647786426462
Validation roc_auc: None
Validation avg_accuracy: 0.43120949859155877
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 13 epochs
There is no such attribute
291/291 - 120s - loss: 0.2244 - accuracy: 0.7770 - 120s/epoch - 412ms/step
Epoch 37/110
Validation cm: [[344 194  32  49]
 [159 257  27  89]
 [ 32  11  42  49]
 [ 23  16  35  52]]
Validation val_loss: 0.7812354972352215
Validation normalized_cm: [[0.556 0.313 0.052 0.079]
 [0.299 0.483 0.051 0.167]
 [0.239 0.082 0.313 0.366]
 [0.183 0.127 0.278 0.413]]
Validation acc: 0.49255846917080087
Validation class_accuracies: [0.555735056542811, 0.4830827067669173, 0.31343283582089554, 0.4126984126984127]
Validation sensitivity: 0.4431818181818182
Validation specificity: 0.555735056542811
Validation icbhi_score: 0.49945843736231454
Validation roc_auc: None
Validation avg_accuracy: 0.44123725295725913
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5584632675706989 hasn't increased by 0 in 14 epochs
There is no such attribute
291/291 - 118s - loss: 0.2222 - accuracy: 0.7851 - 118s/epoch - 407ms/step
Epoch 38/110
Validation cm: [[427  77  61  54]
 [233 159  57  83]
 [ 36   3  62  33]
 [ 21  11  64  30]]
Validation val_loss: 0.894899208649292
Validation normalized_cm: [[0.69  0.124 0.099 0.087]
 [0.438 0.299 0.107 0.156]
 [0.269 0.022 0.463 0.246]
 [0.167 0.087 0.508 0.238]]
Validation acc: 0.4805102763997165
Validation class_accuracies: [0.6898222940226171, 0.29887218045112784, 0.4626865671641791, 0.23809523809523808]
Validation sensitivity: 0.31691919191919193
Validation specificity: 0.6898222940226171
Validation icbhi_score: 0.5033707429709045
Validation roc_auc: None
Validation avg_accuracy: 0.42236906993329054
Validation one_indexed_epoch: 38
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
291/291 - 120s - loss: 0.2254 - accuracy: 0.7789 - 120s/epoch - 412ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5584632675706989
Best cm: [[453  77  39  50]
 [236 228  27  41]
 [ 42  10  53  29]
 [ 34  24  44  24]]
Best val_loss: 0.6896463781456621
Best normalized_cm: [[0.732 0.124 0.063 0.081]
 [0.444 0.429 0.051 0.077]
 [0.313 0.075 0.396 0.216]
 [0.27  0.19  0.349 0.19 ]]
Best acc: 0.5372076541459957
Best class_accuracies: [0.7318255250403877, 0.42857142857142855, 0.39552238805970147, 0.19047619047619047]
Best sensitivity: 0.3851010101010101
Best specificity: 0.7318255250403877
Best roc_auc: None
Best avg_accuracy: 0.436598883036927
Best one_indexed_epoch: 23
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6959860920906067, 0.6699868440628052, 0.6417134404182434, 0.6016618609428406, 0.5706313848495483, 0.5271418690681458, 0.504619300365448, 0.47611749172210693, 0.45370104908943176, 0.4353155493736267, 0.40411701798439026, 0.3975100517272949, 0.3761783540248871, 0.36393043398857117, 0.3454241156578064, 0.3411923050880432, 0.3346436023712158, 0.32147762179374695, 0.31142178177833557, 0.30868858098983765, 0.2957276701927185, 0.286713182926178, 0.2813383638858795, 0.28462275862693787, 0.2688919007778168, 0.2671129107475281, 0.2580914795398712, 0.2492263913154602, 0.24429495632648468, 0.23963254690170288, 0.23463407158851624, 0.23425458371639252, 0.2225588858127594, 0.22180472314357758, 0.23252259194850922, 0.22439666092395782, 0.22223934531211853, 0.22544564306735992], 'accuracy': [0.5178341269493103, 0.5229910016059875, 0.5792866349220276, 0.5861624479293823, 0.6218307018280029, 0.6549205183982849, 0.6807047724723816, 0.7088525891304016, 0.7247529029846191, 0.7247529029846191, 0.7404383420944214, 0.7501074075698853, 0.7524709701538086, 0.7694456577301025, 0.7578427195549011, 0.761925220489502, 0.7574129700660706, 0.7612805962562561, 0.7636441588401794, 0.7713794708251953, 0.7720240950584412, 0.7769660353660583, 0.7750322222709656, 0.7735281586647034, 0.7741727828979492, 0.7741727828979492, 0.7825526595115662, 0.7722389101982117, 0.776106595993042, 0.7831972241401672, 0.7784701585769653, 0.7855607867240906, 0.7799742221832275, 0.7905027866363525, 0.7756768465042114, 0.7769660353660583, 0.7851310968399048, 0.7788998484611511]}
End
####################################
Job id is 9.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4515 elements, with 2060 none's, 1314 crakles, 567 wheezes and 574 both ---
--- Final Validation dataset contains 1550 elements, with 818 none, 520 crackles, 150 wheezes and 62 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5479368932038835, 1: 0.8590182648401826, 2: 1.9907407407407407, 3: 1.9664634146341464}
Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_7   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_21 (Dense)            (None, 100)               128100    
                                                                 
 dropout_14 (Dropout)        (None, 100)               0         
                                                                 
 dense_22 (Dense)            (None, 50)                5050      
                                                                 
 dropout_15 (Dropout)        (None, 50)                0         
                                                                 
 dense_23 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_7"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_14 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_15 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_7 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[436 206 112  64]
 [270 103 105  42]
 [ 75  25  35  15]
 [ 28  14  10  10]]
Validation val_loss: 0.6763502230182771
Validation normalized_cm: [[0.533 0.252 0.137 0.078]
 [0.519 0.198 0.202 0.081]
 [0.5   0.167 0.233 0.1  ]
 [0.452 0.226 0.161 0.161]]
Validation acc: 0.3767741935483871
Validation class_accuracies: [0.5330073349633252, 0.19807692307692307, 0.23333333333333334, 0.16129032258064516]
Validation sensitivity: 0.20218579234972678
Validation specificity: 0.5330073349633252
Validation icbhi_score: 0.367596563656526
Validation roc_auc: None
Validation avg_accuracy: 0.2814269784885567
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
283/283 - 139s - loss: 0.7002 - accuracy: 0.5223 - 139s/epoch - 491ms/step
Epoch 2/110
Validation cm: [[562 117 129  10]
 [360  87  65   8]
 [ 95  14  35   6]
 [ 46   3  13   0]]
Validation val_loss: 0.6514158622872445
Validation normalized_cm: [[0.687 0.143 0.158 0.012]
 [0.692 0.167 0.125 0.015]
 [0.633 0.093 0.233 0.04 ]
 [0.742 0.048 0.21  0.   ]]
Validation acc: 0.44129032258064516
Validation class_accuracies: [0.687041564792176, 0.1673076923076923, 0.23333333333333334, 0.0]
Validation sensitivity: 0.16666666666666666
Validation specificity: 0.687041564792176
Validation icbhi_score: 0.42685411572942134
Validation roc_auc: None
Validation avg_accuracy: 0.2719206476083004
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
283/283 - 124s - loss: 0.6809 - accuracy: 0.5369 - 124s/epoch - 438ms/step
Epoch 3/110
Validation cm: [[724  94   0   0]
 [439  81   0   0]
 [122  27   1   0]
 [ 55   7   0   0]]
Validation val_loss: 0.5956396927948922
Validation normalized_cm: [[0.885 0.115 0.    0.   ]
 [0.844 0.156 0.    0.   ]
 [0.813 0.18  0.007 0.   ]
 [0.887 0.113 0.    0.   ]]
Validation acc: 0.52
Validation class_accuracies: [0.8850855745721271, 0.15576923076923077, 0.006666666666666667, 0.0]
Validation sensitivity: 0.11202185792349727
Validation specificity: 0.8850855745721271
Validation icbhi_score: 0.4985537162478122
Validation roc_auc: None
Validation avg_accuracy: 0.26188036800200615
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
283/283 - 123s - loss: 0.6648 - accuracy: 0.5568 - 123s/epoch - 436ms/step
Epoch 4/110
Validation cm: [[687  31  95   5]
 [361  64  82  13]
 [ 60   3  85   2]
 [ 47   4  11   0]]
Validation val_loss: 0.6073954178248683
Validation normalized_cm: [[0.84  0.038 0.116 0.006]
 [0.694 0.123 0.158 0.025]
 [0.4   0.02  0.567 0.013]
 [0.758 0.065 0.177 0.   ]]
Validation acc: 0.5393548387096774
Validation class_accuracies: [0.8398533007334963, 0.12307692307692308, 0.5666666666666667, 0.0]
Validation sensitivity: 0.20355191256830601
Validation specificity: 0.8398533007334963
Validation icbhi_score: 0.5217026066509012
Validation roc_auc: None
Validation avg_accuracy: 0.3823992226192715
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
283/283 - 124s - loss: 0.6367 - accuracy: 0.6058 - 124s/epoch - 439ms/step
Epoch 5/110
Validation cm: [[602 202  13   1]
 [250 254  12   4]
 [ 55  15  75   5]
 [ 41   7  12   2]]
Validation val_loss: 0.5167490747859401
Validation normalized_cm: [[0.736 0.247 0.016 0.001]
 [0.481 0.488 0.023 0.008]
 [0.367 0.1   0.5   0.033]
 [0.661 0.113 0.194 0.032]]
Validation acc: 0.6019354838709677
Validation class_accuracies: [0.7359413202933985, 0.48846153846153845, 0.5, 0.03225806451612903]
Validation sensitivity: 0.4521857923497268
Validation specificity: 0.7359413202933985
Validation icbhi_score: 0.5940635563215626
Validation roc_auc: None
Validation avg_accuracy: 0.4391652308177665
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
283/283 - 124s - loss: 0.6034 - accuracy: 0.6496 - 124s/epoch - 440ms/step
Epoch 6/110
Validation cm: [[500 277  36   5]
 [165 309  23  23]
 [ 26  20  89  15]
 [ 22  13  25   2]]
Validation val_loss: 0.5288331540361527
Validation normalized_cm: [[0.611 0.339 0.044 0.006]
 [0.317 0.594 0.044 0.044]
 [0.173 0.133 0.593 0.1  ]
 [0.355 0.21  0.403 0.032]]
Validation acc: 0.5806451612903226
Validation class_accuracies: [0.6112469437652812, 0.5942307692307692, 0.5933333333333334, 0.03225806451612903]
Validation sensitivity: 0.546448087431694
Validation specificity: 0.6112469437652812
Validation icbhi_score: 0.5788475155984876
Validation roc_auc: None
Validation avg_accuracy: 0.45776727771137815
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 124s - loss: 0.5682 - accuracy: 0.6791 - 124s/epoch - 438ms/step
Epoch 7/110
Validation cm: [[295  68 220 235]
 [ 50  86  83 301]
 [  4   2  71  73]
 [  2   2  28  30]]
Validation val_loss: 0.712847120992599
Validation normalized_cm: [[0.361 0.083 0.269 0.287]
 [0.096 0.165 0.16  0.579]
 [0.027 0.013 0.473 0.487]
 [0.032 0.032 0.452 0.484]]
Validation acc: 0.3109677419354839
Validation class_accuracies: [0.3606356968215159, 0.16538461538461538, 0.47333333333333333, 0.4838709677419355]
Validation sensitivity: 0.25546448087431695
Validation specificity: 0.3606356968215159
Validation icbhi_score: 0.3080500888479164
Validation roc_auc: None
Validation avg_accuracy: 0.37080615332035005
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 125s - loss: 0.5455 - accuracy: 0.6990 - 125s/epoch - 440ms/step
Epoch 8/110
Validation cm: [[385 365  47  21]
 [122 309  33  56]
 [ 21  15  69  45]
 [ 15  13  21  13]]
Validation val_loss: 0.533637359017326
Validation normalized_cm: [[0.471 0.446 0.057 0.026]
 [0.235 0.594 0.063 0.108]
 [0.14  0.1   0.46  0.3  ]
 [0.242 0.21  0.339 0.21 ]]
Validation acc: 0.5006451612903225
Validation class_accuracies: [0.4706601466992665, 0.5942307692307692, 0.46, 0.20967741935483872]
Validation sensitivity: 0.5341530054644809
Validation specificity: 0.4706601466992665
Validation icbhi_score: 0.5024065760818737
Validation roc_auc: None
Validation avg_accuracy: 0.4336420838212186
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 124s - loss: 0.5229 - accuracy: 0.7207 - 124s/epoch - 438ms/step
Epoch 9/110
Validation cm: [[389 254 126  49]
 [145 175  82 118]
 [  7  14  73  56]
 [ 12   7  19  24]]
Validation val_loss: 0.6174293317141072
Validation normalized_cm: [[0.476 0.311 0.154 0.06 ]
 [0.279 0.337 0.158 0.227]
 [0.047 0.093 0.487 0.373]
 [0.194 0.113 0.306 0.387]]
Validation acc: 0.4264516129032258
Validation class_accuracies: [0.47555012224938875, 0.33653846153846156, 0.4866666666666667, 0.3870967741935484]
Validation sensitivity: 0.37158469945355194
Validation specificity: 0.47555012224938875
Validation icbhi_score: 0.4235674108514703
Validation roc_auc: None
Validation avg_accuracy: 0.4214630061620164
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 4 epochs
There is no such attribute
283/283 - 125s - loss: 0.4971 - accuracy: 0.7274 - 125s/epoch - 442ms/step
Epoch 10/110
Validation cm: [[538  78 165  37]
 [225 122  90  83]
 [ 10   0  97  43]
 [ 10   0  35  17]]
Validation val_loss: 0.5880717247339987
Validation normalized_cm: [[0.658 0.095 0.202 0.045]
 [0.433 0.235 0.173 0.16 ]
 [0.067 0.    0.647 0.287]
 [0.161 0.    0.565 0.274]]
Validation acc: 0.4993548387096774
Validation class_accuracies: [0.6577017114914425, 0.23461538461538461, 0.6466666666666666, 0.27419354838709675]
Validation sensitivity: 0.3224043715846995
Validation specificity: 0.6577017114914425
Validation icbhi_score: 0.490053041538071
Validation roc_auc: None
Validation avg_accuracy: 0.4532943277901476
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
283/283 - 125s - loss: 0.4768 - accuracy: 0.7431 - 125s/epoch - 442ms/step
Epoch 11/110
Validation cm: [[668 129  18   3]
 [309 184  12  15]
 [ 46   5  73  26]
 [ 27   7  16  12]]
Validation val_loss: 0.46166099746381084
Validation normalized_cm: [[0.817 0.158 0.022 0.004]
 [0.594 0.354 0.023 0.029]
 [0.307 0.033 0.487 0.173]
 [0.435 0.113 0.258 0.194]]
Validation acc: 0.604516129032258
Validation class_accuracies: [0.8166259168704156, 0.35384615384615387, 0.4866666666666667, 0.1935483870967742]
Validation sensitivity: 0.3674863387978142
Validation specificity: 0.8166259168704156
Validation icbhi_score: 0.592056127834115
Validation roc_auc: None
Validation avg_accuracy: 0.46267178112000257
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 6 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 125s - loss: 0.4520 - accuracy: 0.7446 - 125s/epoch - 442ms/step
Epoch 12/110
Validation cm: [[448 303  32  35]
 [101 319  19  81]
 [ 19  17  65  49]
 [ 11  11  13  27]]
Validation val_loss: 0.4958403926895511
Validation normalized_cm: [[0.548 0.37  0.039 0.043]
 [0.194 0.613 0.037 0.156]
 [0.127 0.113 0.433 0.327]
 [0.177 0.177 0.21  0.435]]
Validation acc: 0.5541935483870968
Validation class_accuracies: [0.5476772616136919, 0.6134615384615385, 0.43333333333333335, 0.43548387096774194]
Validation sensitivity: 0.5614754098360656
Validation specificity: 0.5476772616136919
Validation icbhi_score: 0.5545763357248787
Validation roc_auc: None
Validation avg_accuracy: 0.5074890010940764
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5940635563215626 hasn't increased by 0 in 7 epochs
There is no such attribute
283/283 - 125s - loss: 0.4359 - accuracy: 0.7588 - 125s/epoch - 442ms/step
Epoch 13/110
Validation cm: [[613 173  27   5]
 [245 226  26  23]
 [ 40   6  89  15]
 [ 29   3  20  10]]
Validation val_loss: 0.46469760525370796
Validation normalized_cm: [[0.749 0.211 0.033 0.006]
 [0.471 0.435 0.05  0.044]
 [0.267 0.04  0.593 0.1  ]
 [0.468 0.048 0.323 0.161]]
Validation acc: 0.6051612903225806
Validation class_accuracies: [0.7493887530562348, 0.4346153846153846, 0.5933333333333334, 0.16129032258064516]
Validation sensitivity: 0.44398907103825136
Validation specificity: 0.7493887530562348
Validation icbhi_score: 0.5966889120472431
Validation roc_auc: None
Validation avg_accuracy: 0.48465694839639945
Validation one_indexed_epoch: 13
-- New best results were achieved. --
There is no such attribute
283/283 - 125s - loss: 0.4272 - accuracy: 0.7617 - 125s/epoch - 443ms/step
Epoch 14/110
Validation cm: [[312 428  35  43]
 [ 68 338  14 100]
 [  7  19  36  88]
 [ 13  12   8  29]]
Validation val_loss: 0.5472935572843398
Validation normalized_cm: [[0.381 0.523 0.043 0.053]
 [0.131 0.65  0.027 0.192]
 [0.047 0.127 0.24  0.587]
 [0.21  0.194 0.129 0.468]]
Validation acc: 0.4612903225806452
Validation class_accuracies: [0.38141809290953543, 0.65, 0.24, 0.46774193548387094]
Validation sensitivity: 0.5505464480874317
Validation specificity: 0.38141809290953543
Validation icbhi_score: 0.46598227049848356
Validation roc_auc: None
Validation avg_accuracy: 0.43479000709835164
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 125s - loss: 0.4141 - accuracy: 0.7566 - 125s/epoch - 441ms/step
Epoch 15/110
Validation cm: [[481 190  67  80]
 [143 214  38 125]
 [ 10   6  54  80]
 [  7   7  12  36]]
Validation val_loss: 0.5721900655809911
Validation normalized_cm: [[0.588 0.232 0.082 0.098]
 [0.275 0.412 0.073 0.24 ]
 [0.067 0.04  0.36  0.533]
 [0.113 0.113 0.194 0.581]]
Validation acc: 0.5064516129032258
Validation class_accuracies: [0.5880195599022005, 0.4115384615384615, 0.36, 0.5806451612903226]
Validation sensitivity: 0.41530054644808745
Validation specificity: 0.5880195599022005
Validation icbhi_score: 0.501660053175144
Validation roc_auc: None
Validation avg_accuracy: 0.4850507956827461
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 125s - loss: 0.3996 - accuracy: 0.7787 - 125s/epoch - 442ms/step
Epoch 16/110
Validation cm: [[289 449  25  55]
 [ 88 347  19  66]
 [  8  20  59  63]
 [  6  17  12  27]]
Validation val_loss: 0.5366341724102536
Validation normalized_cm: [[0.353 0.549 0.031 0.067]
 [0.169 0.667 0.037 0.127]
 [0.053 0.133 0.393 0.42 ]
 [0.097 0.274 0.194 0.435]]
Validation acc: 0.46580645161290324
Validation class_accuracies: [0.3533007334963325, 0.6673076923076923, 0.3933333333333333, 0.43548387096774194]
Validation sensitivity: 0.5915300546448088
Validation specificity: 0.3533007334963325
Validation icbhi_score: 0.47241539407057065
Validation roc_auc: None
Validation avg_accuracy: 0.462356407526275
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 125s - loss: 0.4011 - accuracy: 0.7668 - 125s/epoch - 443ms/step
Epoch 17/110
Validation cm: [[425 330  32  31]
 [117 322  20  61]
 [ 22  16  54  58]
 [ 14  14  10  24]]
Validation val_loss: 0.49286554904234026
Validation normalized_cm: [[0.52  0.403 0.039 0.038]
 [0.225 0.619 0.038 0.117]
 [0.147 0.107 0.36  0.387]
 [0.226 0.226 0.161 0.387]]
Validation acc: 0.532258064516129
Validation class_accuracies: [0.519559902200489, 0.6192307692307693, 0.36, 0.3870967741935484]
Validation sensitivity: 0.546448087431694
Validation specificity: 0.519559902200489
Validation icbhi_score: 0.5330039948160915
Validation roc_auc: None
Validation avg_accuracy: 0.4714718614062017
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 4 epochs
There is no such attribute
283/283 - 124s - loss: 0.3716 - accuracy: 0.7865 - 124s/epoch - 439ms/step
Epoch 18/110
Validation cm: [[297 217  95 209]
 [ 42 184  21 273]
 [  5   2  22 121]
 [  2   4  10  46]]
Validation val_loss: 0.7625676021598761
Validation normalized_cm: [[0.363 0.265 0.116 0.256]
 [0.081 0.354 0.04  0.525]
 [0.033 0.013 0.147 0.807]
 [0.032 0.065 0.161 0.742]]
Validation acc: 0.35419354838709677
Validation class_accuracies: [0.363080684596577, 0.35384615384615387, 0.14666666666666667, 0.7419354838709677]
Validation sensitivity: 0.3442622950819672
Validation specificity: 0.363080684596577
Validation icbhi_score: 0.3536714898392721
Validation roc_auc: None
Validation avg_accuracy: 0.4013822472450913
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
283/283 - 125s - loss: 0.3640 - accuracy: 0.7759 - 125s/epoch - 442ms/step
Epoch 19/110
Validation cm: [[510 246  51  11]
 [167 269  41  43]
 [ 29  11  84  26]
 [ 14  13  24  11]]
Validation val_loss: 0.4879627942356972
Validation normalized_cm: [[0.623 0.301 0.062 0.013]
 [0.321 0.517 0.079 0.083]
 [0.193 0.073 0.56  0.173]
 [0.226 0.21  0.387 0.177]]
Validation acc: 0.5638709677419355
Validation class_accuracies: [0.6234718826405868, 0.5173076923076924, 0.56, 0.1774193548387097]
Validation sensitivity: 0.4972677595628415
Validation specificity: 0.6234718826405868
Validation icbhi_score: 0.5603698211017142
Validation roc_auc: None
Validation avg_accuracy: 0.46954973244674725
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 6 epochs
There is no such attribute
283/283 - 125s - loss: 0.3412 - accuracy: 0.7891 - 125s/epoch - 443ms/step
Epoch 20/110
Validation cm: [[360 343  35  80]
 [ 84 281  20 135]
 [ 12  11  30  97]
 [ 10  11  10  31]]
Validation val_loss: 0.6128497957606469
Validation normalized_cm: [[0.44  0.419 0.043 0.098]
 [0.162 0.54  0.038 0.26 ]
 [0.08  0.073 0.2   0.647]
 [0.161 0.177 0.161 0.5  ]]
Validation acc: 0.4529032258064516
Validation class_accuracies: [0.4400977995110024, 0.5403846153846154, 0.2, 0.5]
Validation sensitivity: 0.4672131147540984
Validation specificity: 0.4400977995110024
Validation icbhi_score: 0.4536554571325504
Validation roc_auc: None
Validation avg_accuracy: 0.4201206037239044
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 7 epochs
There is no such attribute
283/283 - 126s - loss: 0.3315 - accuracy: 0.7925 - 126s/epoch - 445ms/step
Epoch 21/110
Validation cm: [[554 211  38  15]
 [209 245  25  41]
 [ 26  14  66  44]
 [ 15   9  18  20]]
Validation val_loss: 0.47445204633949023
Validation normalized_cm: [[0.677 0.258 0.046 0.018]
 [0.402 0.471 0.048 0.079]
 [0.173 0.093 0.44  0.293]
 [0.242 0.145 0.29  0.323]]
Validation acc: 0.5709677419354838
Validation class_accuracies: [0.6772616136919315, 0.47115384615384615, 0.44, 0.3225806451612903]
Validation sensitivity: 0.4521857923497268
Validation specificity: 0.6772616136919315
Validation icbhi_score: 0.5647237030208292
Validation roc_auc: None
Validation avg_accuracy: 0.47774902625176696
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 8 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 126s - loss: 0.3251 - accuracy: 0.7898 - 126s/epoch - 447ms/step
Epoch 22/110
Validation cm: [[500 277  21  20]
 [163 316   6  35]
 [ 26  18  30  76]
 [ 18  15   8  21]]
Validation val_loss: 0.4734544563990447
Validation normalized_cm: [[0.611 0.339 0.026 0.024]
 [0.313 0.608 0.012 0.067]
 [0.173 0.12  0.2   0.507]
 [0.29  0.242 0.129 0.339]]
Validation acc: 0.5593548387096774
Validation class_accuracies: [0.6112469437652812, 0.6076923076923076, 0.2, 0.3387096774193548]
Validation sensitivity: 0.5013661202185792
Validation specificity: 0.6112469437652812
Validation icbhi_score: 0.5563065319919303
Validation roc_auc: None
Validation avg_accuracy: 0.43941223221923587
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 9 epochs
There is no such attribute
283/283 - 125s - loss: 0.3145 - accuracy: 0.8053 - 125s/epoch - 442ms/step
Epoch 23/110
Validation cm: [[388 351  41  38]
 [ 90 309  24  97]
 [ 17  16  51  66]
 [  7  13  15  27]]
Validation val_loss: 0.56669174596457
Validation normalized_cm: [[0.474 0.429 0.05  0.046]
 [0.173 0.594 0.046 0.187]
 [0.113 0.107 0.34  0.44 ]
 [0.113 0.21  0.242 0.435]]
Validation acc: 0.5
Validation class_accuracies: [0.4743276283618582, 0.5942307692307692, 0.34, 0.43548387096774194]
Validation sensitivity: 0.5286885245901639
Validation specificity: 0.4743276283618582
Validation icbhi_score: 0.501508076476011
Validation roc_auc: None
Validation avg_accuracy: 0.46101056714009236
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
283/283 - 125s - loss: 0.3109 - accuracy: 0.8060 - 125s/epoch - 442ms/step
Epoch 24/110
Validation cm: [[369 375  39  35]
 [ 97 348  18  57]
 [ 21  18  47  64]
 [  9  16   7  30]]
Validation val_loss: 0.5494554384797812
Validation normalized_cm: [[0.451 0.458 0.048 0.043]
 [0.187 0.669 0.035 0.11 ]
 [0.14  0.12  0.313 0.427]
 [0.145 0.258 0.113 0.484]]
Validation acc: 0.512258064516129
Validation class_accuracies: [0.4511002444987775, 0.6692307692307692, 0.31333333333333335, 0.4838709677419355]
Validation sensitivity: 0.5806010928961749
Validation specificity: 0.4511002444987775
Validation icbhi_score: 0.5158506686974762
Validation roc_auc: None
Validation avg_accuracy: 0.4793838287012039
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 11 epochs
There is no such attribute
283/283 - 126s - loss: 0.2984 - accuracy: 0.8049 - 126s/epoch - 445ms/step
Epoch 25/110
Validation cm: [[346 264  62 146]
 [ 70 238  33 179]
 [  7   4  39 100]
 [  3   7   8  44]]
Validation val_loss: 0.698337290503325
Validation normalized_cm: [[0.423 0.323 0.076 0.178]
 [0.135 0.458 0.063 0.344]
 [0.047 0.027 0.26  0.667]
 [0.048 0.113 0.129 0.71 ]]
Validation acc: 0.43032258064516127
Validation class_accuracies: [0.4229828850855746, 0.4576923076923077, 0.26, 0.7096774193548387]
Validation sensitivity: 0.4385245901639344
Validation specificity: 0.4229828850855746
Validation icbhi_score: 0.4307537376247545
Validation roc_auc: None
Validation avg_accuracy: 0.46258815303318024
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 12 epochs
There is no such attribute
283/283 - 125s - loss: 0.3116 - accuracy: 0.8031 - 125s/epoch - 442ms/step
Epoch 26/110
Validation cm: [[435 339  28  16]
 [142 320  21  37]
 [ 25  17  57  51]
 [ 14  16  13  19]]
Validation val_loss: 0.5195516106882132
Validation normalized_cm: [[0.532 0.414 0.034 0.02 ]
 [0.273 0.615 0.04  0.071]
 [0.167 0.113 0.38  0.34 ]
 [0.226 0.258 0.21  0.306]]
Validation acc: 0.5361290322580645
Validation class_accuracies: [0.5317848410757946, 0.6153846153846154, 0.38, 0.3064516129032258]
Validation sensitivity: 0.5409836065573771
Validation specificity: 0.5317848410757946
Validation icbhi_score: 0.5363842238165859
Validation roc_auc: None
Validation avg_accuracy: 0.458405267340909
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 13 epochs
There is no such attribute
283/283 - 126s - loss: 0.2997 - accuracy: 0.8024 - 126s/epoch - 446ms/step
Epoch 27/110
Validation cm: [[534 206  51  27]
 [169 252  32  67]
 [ 21  11  62  56]
 [  9   9  20  24]]
Validation val_loss: 0.509682463423439
Validation normalized_cm: [[0.653 0.252 0.062 0.033]
 [0.325 0.485 0.062 0.129]
 [0.14  0.073 0.413 0.373]
 [0.145 0.145 0.323 0.387]]
Validation acc: 0.5625806451612904
Validation class_accuracies: [0.6528117359413202, 0.4846153846153846, 0.41333333333333333, 0.3870967741935484]
Validation sensitivity: 0.46174863387978143
Validation specificity: 0.6528117359413202
Validation icbhi_score: 0.5572801849105509
Validation roc_auc: None
Validation avg_accuracy: 0.4844643070208966
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5966889120472431 hasn't increased by 0 in 14 epochs
There is no such attribute
283/283 - 125s - loss: 0.2936 - accuracy: 0.8029 - 125s/epoch - 443ms/step
Epoch 28/110
Validation cm: [[501 253  43  21]
 [153 274  34  59]
 [ 30  11  66  43]
 [ 11  12  17  22]]
Validation val_loss: 0.517062060917998
Validation normalized_cm: [[0.612 0.309 0.053 0.026]
 [0.294 0.527 0.065 0.113]
 [0.2   0.073 0.44  0.287]
 [0.177 0.194 0.274 0.355]]
Validation acc: 0.5567741935483871
Validation class_accuracies: [0.6124694376528117, 0.5269230769230769, 0.44, 0.3548387096774194]
Validation sensitivity: 0.49453551912568305
Validation specificity: 0.6124694376528117
Validation icbhi_score: 0.5535024783892474
Validation roc_auc: None
Validation avg_accuracy: 0.483557806063327
Validation one_indexed_epoch: 28
The number of epochs since last 1% equals the patience
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
283/283 - 125s - loss: 0.2924 - accuracy: 0.8166 - 125s/epoch - 441ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5966889120472431
Best cm: [[613 173  27   5]
 [245 226  26  23]
 [ 40   6  89  15]
 [ 29   3  20  10]]
Best val_loss: 0.46469760525370796
Best normalized_cm: [[0.749 0.211 0.033 0.006]
 [0.471 0.435 0.05  0.044]
 [0.267 0.04  0.593 0.1  ]
 [0.468 0.048 0.323 0.161]]
Best acc: 0.6051612903225806
Best class_accuracies: [0.7493887530562348, 0.4346153846153846, 0.5933333333333334, 0.16129032258064516]
Best sensitivity: 0.44398907103825136
Best specificity: 0.7493887530562348
Best roc_auc: None
Best avg_accuracy: 0.48465694839639945
Best one_indexed_epoch: 13
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7002168297767639, 0.6808591485023499, 0.6648147106170654, 0.6366894245147705, 0.6034117937088013, 0.5682427287101746, 0.5455460548400879, 0.5229421854019165, 0.4971231520175934, 0.47678929567337036, 0.45200464129447937, 0.43589523434638977, 0.4272100329399109, 0.4140583574771881, 0.39956483244895935, 0.40110746026039124, 0.371621698141098, 0.36399659514427185, 0.341183602809906, 0.3315317928791046, 0.3251052498817444, 0.3145459294319153, 0.3109361231327057, 0.29836520552635193, 0.3116394281387329, 0.2997131943702698, 0.293612539768219, 0.2923506200313568], 'accuracy': [0.5222591161727905, 0.5368770956993103, 0.5568106174468994, 0.6057586073875427, 0.6496124267578125, 0.6790697574615479, 0.6990033388137817, 0.7207087278366089, 0.7273532748222351, 0.7430786490440369, 0.7446290254592896, 0.7588039636611938, 0.7616832852363586, 0.7565891742706299, 0.7787375450134277, 0.7667773962020874, 0.7864894866943359, 0.7758582234382629, 0.7891472578048706, 0.7924695611000061, 0.7898117303848267, 0.8053156137466431, 0.8059800863265991, 0.8048726320266724, 0.8031007647514343, 0.802436351776123, 0.802879273891449, 0.8166112899780273]}
End
####################################
Job id is 10.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4755 elements, with 2174 none's, 1360 crakles, 632 wheezes and 589 both ---
--- Final Validation dataset contains 1310 elements, with 704 none, 474 crackles, 85 wheezes and 47 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.546803127874885, 1: 0.8740808823529411, 2: 1.8809335443037976, 3: 2.018251273344652}
Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_8   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_24 (Dense)            (None, 100)               128100    
                                                                 
 dropout_16 (Dropout)        (None, 100)               0         
                                                                 
 dense_25 (Dense)            (None, 50)                5050      
                                                                 
 dropout_17 (Dropout)        (None, 50)                0         
                                                                 
 dense_26 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_8"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_16 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_17 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_8 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[557 132   6   9]
 [355 108   6   5]
 [ 58  26   0   1]
 [ 34  12   0   1]]
Validation val_loss: 0.6463940135167755
Validation normalized_cm: [[0.791 0.188 0.009 0.013]
 [0.749 0.228 0.013 0.011]
 [0.682 0.306 0.    0.012]
 [0.723 0.255 0.    0.021]]
Validation acc: 0.5083969465648855
Validation class_accuracies: [0.7911931818181818, 0.22784810126582278, 0.0, 0.02127659574468085]
Validation sensitivity: 0.17986798679867988
Validation specificity: 0.7911931818181818
Validation icbhi_score: 0.4855305843084308
Validation roc_auc: None
Validation avg_accuracy: 0.26007946970717133
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
298/298 - 127s - loss: 0.6961 - accuracy: 0.5600 - 127s/epoch - 426ms/step
Epoch 2/110
Validation cm: [[428  75 142  59]
 [218  76 125  55]
 [ 36   9  25  15]
 [ 33   1  10   3]]
Validation val_loss: 0.6767779110952188
Validation normalized_cm: [[0.608 0.107 0.202 0.084]
 [0.46  0.16  0.264 0.116]
 [0.424 0.106 0.294 0.176]
 [0.702 0.021 0.213 0.064]]
Validation acc: 0.40610687022900765
Validation class_accuracies: [0.6079545454545454, 0.16033755274261605, 0.29411764705882354, 0.06382978723404255]
Validation sensitivity: 0.1716171617161716
Validation specificity: 0.6079545454545454
Validation icbhi_score: 0.3897858535853585
Validation roc_auc: None
Validation avg_accuracy: 0.2815598831225069
Validation one_indexed_epoch: 2
The validation tracker metric at 0.4855305843084308 hasn't increased by 0 in 1 epochs
There is no such attribute
298/298 - 112s - loss: 0.6659 - accuracy: 0.5569 - 112s/epoch - 376ms/step
Epoch 3/110
Validation cm: [[565 129  10   0]
 [280 193   1   0]
 [ 57  14  10   4]
 [ 30  15   2   0]]
Validation val_loss: 0.5657095062368699
Validation normalized_cm: [[0.803 0.183 0.014 0.   ]
 [0.591 0.407 0.002 0.   ]
 [0.671 0.165 0.118 0.047]
 [0.638 0.319 0.043 0.   ]]
Validation acc: 0.5862595419847328
Validation class_accuracies: [0.8025568181818182, 0.40717299578059074, 0.11764705882352941, 0.0]
Validation sensitivity: 0.334983498349835
Validation specificity: 0.8025568181818182
Validation icbhi_score: 0.5687701582658267
Validation roc_auc: None
Validation avg_accuracy: 0.3318442181964846
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
298/298 - 114s - loss: 0.6306 - accuracy: 0.5771 - 114s/epoch - 382ms/step
Epoch 4/110
Validation cm: [[399 142  96  67]
 [241 174  31  28]
 [ 26  13  27  19]
 [ 17   7  11  12]]
Validation val_loss: 0.6440176811837058
Validation normalized_cm: [[0.567 0.202 0.136 0.095]
 [0.508 0.367 0.065 0.059]
 [0.306 0.153 0.318 0.224]
 [0.362 0.149 0.234 0.255]]
Validation acc: 0.467175572519084
Validation class_accuracies: [0.5667613636363636, 0.3670886075949367, 0.3176470588235294, 0.2553191489361702]
Validation sensitivity: 0.35148514851485146
Validation specificity: 0.5667613636363636
Validation icbhi_score: 0.45912325607560756
Validation roc_auc: None
Validation avg_accuracy: 0.37670404474775
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 1 epochs
There is no such attribute
298/298 - 114s - loss: 0.5804 - accuracy: 0.6437 - 114s/epoch - 381ms/step
Epoch 5/110
Validation cm: [[677  12  15   0]
 [470   2   2   0]
 [ 65   0  20   0]
 [ 46   1   0   0]]
Validation val_loss: 0.6028551946387036
Validation normalized_cm: [[0.962 0.017 0.021 0.   ]
 [0.992 0.004 0.004 0.   ]
 [0.765 0.    0.235 0.   ]
 [0.979 0.021 0.    0.   ]]
Validation acc: 0.533587786259542
Validation class_accuracies: [0.9616477272727273, 0.004219409282700422, 0.23529411764705882, 0.0]
Validation sensitivity: 0.036303630363036306
Validation specificity: 0.9616477272727273
Validation icbhi_score: 0.4989756788178818
Validation roc_auc: None
Validation avg_accuracy: 0.30029031355062163
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 2 epochs
There is no such attribute
298/298 - 114s - loss: 0.5414 - accuracy: 0.6837 - 114s/epoch - 383ms/step
Epoch 6/110
Validation cm: [[180 471  25  28]
 [ 29 432   5   8]
 [  6  38  22  19]
 [  4  32   8   3]]
Validation val_loss: 0.5178680957387422
Validation normalized_cm: [[0.256 0.669 0.036 0.04 ]
 [0.061 0.911 0.011 0.017]
 [0.071 0.447 0.259 0.224]
 [0.085 0.681 0.17  0.064]]
Validation acc: 0.4862595419847328
Validation class_accuracies: [0.2556818181818182, 0.9113924050632911, 0.25882352941176473, 0.06382978723404255]
Validation sensitivity: 0.7541254125412541
Validation specificity: 0.2556818181818182
Validation icbhi_score: 0.5049036153615362
Validation roc_auc: None
Validation avg_accuracy: 0.3724318849727291
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 3 epochs
There is no such attribute
298/298 - 113s - loss: 0.5113 - accuracy: 0.7152 - 113s/epoch - 380ms/step
Epoch 7/110
Validation cm: [[346 287  21  50]
 [155 266  18  35]
 [  7  15  28  35]
 [  4  31   5   7]]
Validation val_loss: 0.5438354185519327
Validation normalized_cm: [[0.491 0.408 0.03  0.071]
 [0.327 0.561 0.038 0.074]
 [0.082 0.176 0.329 0.412]
 [0.085 0.66  0.106 0.149]]
Validation acc: 0.49389312977099237
Validation class_accuracies: [0.4914772727272727, 0.5611814345991561, 0.32941176470588235, 0.14893617021276595]
Validation sensitivity: 0.4966996699669967
Validation specificity: 0.4914772727272727
Validation icbhi_score: 0.49408847134713474
Validation roc_auc: None
Validation avg_accuracy: 0.3827516605612693
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 4 epochs
There is no such attribute
298/298 - 114s - loss: 0.4853 - accuracy: 0.7363 - 114s/epoch - 382ms/step
Epoch 8/110
Validation cm: [[657   5  41   1]
 [450  11  12   1]
 [ 33   0  51   1]
 [ 31   0  16   0]]
Validation val_loss: 0.5044900449803312
Validation normalized_cm: [[0.933 0.007 0.058 0.001]
 [0.949 0.023 0.025 0.002]
 [0.388 0.    0.6   0.012]
 [0.66  0.    0.34  0.   ]]
Validation acc: 0.5488549618320611
Validation class_accuracies: [0.9332386363636364, 0.023206751054852322, 0.6, 0.0]
Validation sensitivity: 0.10231023102310231
Validation specificity: 0.9332386363636364
Validation icbhi_score: 0.5177744336933693
Validation roc_auc: None
Validation avg_accuracy: 0.3891113468546222
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
298/298 - 114s - loss: 0.4757 - accuracy: 0.7445 - 114s/epoch - 382ms/step
Epoch 9/110
Validation cm: [[458 125  49  72]
 [222 167  34  51]
 [ 11   5  37  32]
 [ 10  15  14   8]]
Validation val_loss: 0.5665477551121748
Validation normalized_cm: [[0.651 0.178 0.07  0.102]
 [0.468 0.352 0.072 0.108]
 [0.129 0.059 0.435 0.376]
 [0.213 0.319 0.298 0.17 ]]
Validation acc: 0.5114503816793893
Validation class_accuracies: [0.6505681818181818, 0.35232067510548526, 0.43529411764705883, 0.1702127659574468]
Validation sensitivity: 0.34983498349834985
Validation specificity: 0.6505681818181818
Validation icbhi_score: 0.5002015826582658
Validation roc_auc: None
Validation avg_accuracy: 0.4020989351320432
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 6 epochs
There is no such attribute
298/298 - 113s - loss: 0.4448 - accuracy: 0.7495 - 113s/epoch - 380ms/step
Epoch 10/110
Validation cm: [[289 305  23  87]
 [ 75 340  16  43]
 [  9  12  40  24]
 [  3  25  10   9]]
Validation val_loss: 0.5826275145677665
Validation normalized_cm: [[0.411 0.433 0.033 0.124]
 [0.158 0.717 0.034 0.091]
 [0.106 0.141 0.471 0.282]
 [0.064 0.532 0.213 0.191]]
Validation acc: 0.517557251908397
Validation class_accuracies: [0.41051136363636365, 0.7172995780590717, 0.47058823529411764, 0.19148936170212766]
Validation sensitivity: 0.641914191419142
Validation specificity: 0.41051136363636365
Validation icbhi_score: 0.5262127775277528
Validation roc_auc: None
Validation avg_accuracy: 0.44747213467292013
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 7 epochs
There is no such attribute
298/298 - 114s - loss: 0.4420 - accuracy: 0.7510 - 114s/epoch - 382ms/step
Epoch 11/110
Validation cm: [[543  76  66  19]
 [314 126  26   8]
 [ 23   5  50   7]
 [ 24  10  13   0]]
Validation val_loss: 0.5207231066637594
Validation normalized_cm: [[0.771 0.108 0.094 0.027]
 [0.662 0.266 0.055 0.017]
 [0.271 0.059 0.588 0.082]
 [0.511 0.213 0.277 0.   ]]
Validation acc: 0.5488549618320611
Validation class_accuracies: [0.7713068181818182, 0.26582278481012656, 0.5882352941176471, 0.0]
Validation sensitivity: 0.29042904290429045
Validation specificity: 0.7713068181818182
Validation icbhi_score: 0.5308679305430544
Validation roc_auc: None
Validation avg_accuracy: 0.40634122427739794
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 8 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
298/298 - 114s - loss: 0.4194 - accuracy: 0.7487 - 114s/epoch - 382ms/step
Epoch 12/110
Validation cm: [[291 327  11  75]
 [ 84 363   4  23]
 [ 10  21  13  41]
 [  5  26  10   6]]
Validation val_loss: 0.5503136679203114
Validation normalized_cm: [[0.413 0.464 0.016 0.107]
 [0.177 0.766 0.008 0.049]
 [0.118 0.247 0.153 0.482]
 [0.106 0.553 0.213 0.128]]
Validation acc: 0.5137404580152671
Validation class_accuracies: [0.4133522727272727, 0.7658227848101266, 0.15294117647058825, 0.1276595744680851]
Validation sensitivity: 0.6303630363036303
Validation specificity: 0.4133522727272727
Validation icbhi_score: 0.5218576545154515
Validation roc_auc: None
Validation avg_accuracy: 0.3649439521190181
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 9 epochs
There is no such attribute
298/298 - 113s - loss: 0.4052 - accuracy: 0.7560 - 113s/epoch - 379ms/step
Epoch 13/110
Validation cm: [[466 159  23  56]
 [202 211  22  39]
 [  9  11  42  23]
 [ 14  17  13   3]]
Validation val_loss: 0.5418643511760667
Validation normalized_cm: [[0.662 0.226 0.033 0.08 ]
 [0.426 0.445 0.046 0.082]
 [0.106 0.129 0.494 0.271]
 [0.298 0.362 0.277 0.064]]
Validation acc: 0.5511450381679389
Validation class_accuracies: [0.6619318181818182, 0.4451476793248945, 0.49411764705882355, 0.06382978723404255]
Validation sensitivity: 0.42244224422442245
Validation specificity: 0.6619318181818182
Validation icbhi_score: 0.5421870312031203
Validation roc_auc: None
Validation avg_accuracy: 0.41625673294989474
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
298/298 - 115s - loss: 0.4019 - accuracy: 0.7682 - 115s/epoch - 384ms/step
Epoch 14/110
Validation cm: [[129 418  17 140]
 [ 24 366   8  76]
 [  3   9  20  53]
 [  0  18  11  18]]
Validation val_loss: 0.7056846047573873
Validation normalized_cm: [[0.183 0.594 0.024 0.199]
 [0.051 0.772 0.017 0.16 ]
 [0.035 0.106 0.235 0.624]
 [0.    0.383 0.234 0.383]]
Validation acc: 0.4068702290076336
Validation class_accuracies: [0.18323863636363635, 0.7721518987341772, 0.23529411764705882, 0.3829787234042553]
Validation sensitivity: 0.6666666666666666
Validation specificity: 0.18323863636363635
Validation icbhi_score: 0.4249526515151515
Validation roc_auc: None
Validation avg_accuracy: 0.3934158440372819
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 11 epochs
There is no such attribute
298/298 - 114s - loss: 0.3804 - accuracy: 0.7666 - 114s/epoch - 384ms/step
Epoch 15/110
Validation cm: [[291 328  16  69]
 [ 84 343  10  37]
 [ 11  13  27  34]
 [  4  28   4  11]]
Validation val_loss: 0.5455078671736117
Validation normalized_cm: [[0.413 0.466 0.023 0.098]
 [0.177 0.724 0.021 0.078]
 [0.129 0.153 0.318 0.4  ]
 [0.085 0.596 0.085 0.234]]
Validation acc: 0.5129770992366413
Validation class_accuracies: [0.4133522727272727, 0.7236286919831224, 0.3176470588235294, 0.23404255319148937]
Validation sensitivity: 0.6287128712871287
Validation specificity: 0.4133522727272727
Validation icbhi_score: 0.5210325720072007
Validation roc_auc: None
Validation avg_accuracy: 0.42216764418135344
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 12 epochs
There is no such attribute
298/298 - 114s - loss: 0.3751 - accuracy: 0.7746 - 114s/epoch - 383ms/step
Epoch 16/110
Validation cm: [[233 390   7  74]
 [ 40 382   7  45]
 [  7  16  11  51]
 [  2  30   3  12]]
Validation val_loss: 0.5862568160391036
Validation normalized_cm: [[0.331 0.554 0.01  0.105]
 [0.084 0.806 0.015 0.095]
 [0.082 0.188 0.129 0.6  ]
 [0.043 0.638 0.064 0.255]]
Validation acc: 0.4870229007633588
Validation class_accuracies: [0.3309659090909091, 0.8059071729957806, 0.12941176470588237, 0.2553191489361702]
Validation sensitivity: 0.6683168316831684
Validation specificity: 0.3309659090909091
Validation icbhi_score: 0.4996413703870387
Validation roc_auc: None
Validation avg_accuracy: 0.38040099893218554
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 13 epochs
There is no such attribute
298/298 - 114s - loss: 0.3641 - accuracy: 0.7725 - 114s/epoch - 381ms/step
Epoch 17/110
Validation cm: [[258 315  20 111]
 [ 90 323  14  47]
 [  6  10  19  50]
 [  1  18  17  11]]
Validation val_loss: 0.6334429204151149
Validation normalized_cm: [[0.366 0.447 0.028 0.158]
 [0.19  0.681 0.03  0.099]
 [0.071 0.118 0.224 0.588]
 [0.021 0.383 0.362 0.234]]
Validation acc: 0.466412213740458
Validation class_accuracies: [0.3664772727272727, 0.6814345991561181, 0.2235294117647059, 0.23404255319148937]
Validation sensitivity: 0.5825082508250825
Validation specificity: 0.3664772727272727
Validation icbhi_score: 0.4744927617761776
Validation roc_auc: None
Validation avg_accuracy: 0.37637095920989655
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 14 epochs
There is no such attribute
298/298 - 114s - loss: 0.3628 - accuracy: 0.7680 - 114s/epoch - 384ms/step
Epoch 18/110
Validation cm: [[278 295  21 110]
 [ 64 334   9  67]
 [  6   8  31  40]
 [  4  19  14  10]]
Validation val_loss: 0.6617303935654518
Validation normalized_cm: [[0.395 0.419 0.03  0.156]
 [0.135 0.705 0.019 0.141]
 [0.071 0.094 0.365 0.471]
 [0.085 0.404 0.298 0.213]]
Validation acc: 0.4984732824427481
Validation class_accuracies: [0.39488636363636365, 0.7046413502109705, 0.36470588235294116, 0.2127659574468085]
Validation sensitivity: 0.6188118811881188
Validation specificity: 0.39488636363636365
Validation icbhi_score: 0.5068491224122412
Validation roc_auc: None
Validation avg_accuracy: 0.419249888411771
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
298/298 - 113s - loss: 0.3433 - accuracy: 0.7762 - 113s/epoch - 380ms/step
Epoch 19/110
Validation cm: [[309 249  29 117]
 [ 88 292  18  76]
 [  5   5  31  44]
 [  3  21  15   8]]
Validation val_loss: 0.6911123848029675
Validation normalized_cm: [[0.439 0.354 0.041 0.166]
 [0.186 0.616 0.038 0.16 ]
 [0.059 0.059 0.365 0.518]
 [0.064 0.447 0.319 0.17 ]]
Validation acc: 0.48854961832061067
Validation class_accuracies: [0.43892045454545453, 0.6160337552742616, 0.36470588235294116, 0.1702127659574468]
Validation sensitivity: 0.5462046204620462
Validation specificity: 0.43892045454545453
Validation icbhi_score: 0.49256253750375034
Validation roc_auc: None
Validation avg_accuracy: 0.39746821453252607
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 16 epochs
There is no such attribute
298/298 - 114s - loss: 0.3448 - accuracy: 0.7792 - 114s/epoch - 382ms/step
Epoch 20/110
Validation cm: [[182 419   8  95]
 [ 39 375   6  54]
 [  2  19  15  49]
 [  1  28   6  12]]
Validation val_loss: 0.6615744493517826
Validation normalized_cm: [[0.259 0.595 0.011 0.135]
 [0.082 0.791 0.013 0.114]
 [0.024 0.224 0.176 0.576]
 [0.021 0.596 0.128 0.255]]
Validation acc: 0.44580152671755724
Validation class_accuracies: [0.2585227272727273, 0.7911392405063291, 0.17647058823529413, 0.2553191489361702]
Validation sensitivity: 0.6633663366336634
Validation specificity: 0.2585227272727273
Validation icbhi_score: 0.46094453195319535
Validation roc_auc: None
Validation avg_accuracy: 0.3703629262376302
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 17 epochs
There is no such attribute
298/298 - 116s - loss: 0.3480 - accuracy: 0.7748 - 116s/epoch - 389ms/step
Epoch 21/110
Validation cm: [[297 274  26 107]
 [ 76 300  14  84]
 [  6   9  31  39]
 [  5  18  14  10]]
Validation val_loss: 0.6939982982921122
Validation normalized_cm: [[0.422 0.389 0.037 0.152]
 [0.16  0.633 0.03  0.177]
 [0.071 0.106 0.365 0.459]
 [0.106 0.383 0.298 0.213]]
Validation acc: 0.4870229007633588
Validation class_accuracies: [0.421875, 0.6329113924050633, 0.36470588235294116, 0.2127659574468085]
Validation sensitivity: 0.5627062706270627
Validation specificity: 0.421875
Validation icbhi_score: 0.49229063531353134
Validation roc_auc: None
Validation avg_accuracy: 0.4080645580512033
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5687701582658267 hasn't increased by 0 in 18 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
298/298 - 125s - loss: 0.3330 - accuracy: 0.7764 - 125s/epoch - 419ms/step
Epoch 22/110
Validation cm: [[303 282  36  83]
 [ 92 307  23  52]
 [  4  13  41  27]
 [  7  22  10   8]]
Validation val_loss: 0.6284647254045796
Validation normalized_cm: [[0.43  0.401 0.051 0.118]
 [0.194 0.648 0.049 0.11 ]
 [0.047 0.153 0.482 0.318]
 [0.149 0.468 0.213 0.17 ]]
Validation acc: 0.5030534351145038
Validation class_accuracies: [0.4303977272727273, 0.6476793248945147, 0.4823529411764706, 0.1702127659574468]
Validation sensitivity: 0.5874587458745875
Validation specificity: 0.4303977272727273
Validation icbhi_score: 0.5089282365736574
Validation roc_auc: None
Validation avg_accuracy: 0.4326606898252899
Validation one_indexed_epoch: 22
The number of epochs since last 1% equals the patience
There is no such attribute
298/298 - 116s - loss: 0.3433 - accuracy: 0.7760 - 116s/epoch - 390ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5687701582658267
Best cm: [[565 129  10   0]
 [280 193   1   0]
 [ 57  14  10   4]
 [ 30  15   2   0]]
Best val_loss: 0.5657095062368699
Best normalized_cm: [[0.803 0.183 0.014 0.   ]
 [0.591 0.407 0.002 0.   ]
 [0.671 0.165 0.118 0.047]
 [0.638 0.319 0.043 0.   ]]
Best acc: 0.5862595419847328
Best class_accuracies: [0.8025568181818182, 0.40717299578059074, 0.11764705882352941, 0.0]
Best sensitivity: 0.334983498349835
Best specificity: 0.8025568181818182
Best roc_auc: None
Best avg_accuracy: 0.3318442181964846
Best one_indexed_epoch: 3
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6960633993148804, 0.6658821105957031, 0.6305552124977112, 0.5804485082626343, 0.5414324998855591, 0.5113304853439331, 0.4853286147117615, 0.4757014214992523, 0.44475311040878296, 0.44197601079940796, 0.4193645417690277, 0.40522658824920654, 0.40187203884124756, 0.3803693354129791, 0.37510642409324646, 0.3640952408313751, 0.3627924621105194, 0.343323677778244, 0.3448481559753418, 0.34799474477767944, 0.33298999071121216, 0.3433425724506378], 'accuracy': [0.5600420832633972, 0.5568875074386597, 0.5770767331123352, 0.6437434554100037, 0.6837013959884644, 0.7152470946311951, 0.7362775802612305, 0.7444794774055481, 0.7495267987251282, 0.7509989738464355, 0.7486855983734131, 0.7560462951660156, 0.7682439684867859, 0.7665615081787109, 0.774553120136261, 0.7724500298500061, 0.7680336236953735, 0.7762355208396912, 0.7791798114776611, 0.7747634053230286, 0.7764458656311035, 0.7760252356529236]}
End
####################################
Job id is 11.
turning the kfold from 90/10 to 80/20
101
11
to
91
21
-----------------------
--- Final training dataset went from 0 to 4522 elements, with 2123 none's, 1260 crakles, 622 wheezes and 517 both ---
--- Final Validation dataset contains 1543 elements, with 755 none, 574 crackles, 95 wheezes and 119 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5325011775788978, 1: 0.8972222222222223, 2: 1.817524115755627, 3: 2.1866537717601546}
Model: "sequential_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_9   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_27 (Dense)            (None, 100)               128100    
                                                                 
 dropout_18 (Dropout)        (None, 100)               0         
                                                                 
 dense_28 (Dense)            (None, 50)                5050      
                                                                 
 dropout_19 (Dropout)        (None, 50)                0         
                                                                 
 dense_29 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_9"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_18 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_19 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_9 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  1   2 398 354]
 [  2   1 319 252]
 [  0   0  39  56]
 [  0   1  59  59]]
Validation val_loss: 0.7549464772524805
Validation normalized_cm: [[0.001 0.003 0.527 0.469]
 [0.003 0.002 0.556 0.439]
 [0.    0.    0.411 0.589]
 [0.    0.008 0.496 0.496]]
Validation acc: 0.06480881399870382
Validation class_accuracies: [0.0013245033112582781, 0.0017421602787456446, 0.4105263157894737, 0.4957983193277311]
Validation sensitivity: 0.12563451776649745
Validation specificity: 0.0013245033112582781
Validation icbhi_score: 0.06347951053887786
Validation roc_auc: None
Validation avg_accuracy: 0.22734782467680217
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
283/283 - 151s - loss: 0.7018 - accuracy: 0.3618 - 151s/epoch - 535ms/step
Epoch 2/110
Validation cm: [[  9   1 623 122]
 [  8   0 451 115]
 [  0   0  83  12]
 [  2   0  89  28]]
Validation val_loss: 0.7572712183809868
Validation normalized_cm: [[0.012 0.001 0.825 0.162]
 [0.014 0.    0.786 0.2  ]
 [0.    0.    0.874 0.126]
 [0.017 0.    0.748 0.235]]
Validation acc: 0.07777057679844458
Validation class_accuracies: [0.011920529801324504, 0.0, 0.8736842105263158, 0.23529411764705882]
Validation sensitivity: 0.14086294416243655
Validation specificity: 0.011920529801324504
Validation icbhi_score: 0.07639173698188052
Validation roc_auc: None
Validation avg_accuracy: 0.2802247144936748
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
283/283 - 146s - loss: 0.6751 - accuracy: 0.5095 - 146s/epoch - 516ms/step
Epoch 3/110
Validation cm: [[143 330  38 244]
 [ 78 334   5 157]
 [  3  30   0  62]
 [  8  45   5  61]]
Validation val_loss: 0.68082998037261
Validation normalized_cm: [[0.189 0.437 0.05  0.323]
 [0.136 0.582 0.009 0.274]
 [0.032 0.316 0.    0.653]
 [0.067 0.378 0.042 0.513]]
Validation acc: 0.3486714193130266
Validation class_accuracies: [0.18940397350993377, 0.5818815331010453, 0.0, 0.5126050420168067]
Validation sensitivity: 0.501269035532995
Validation specificity: 0.18940397350993377
Validation icbhi_score: 0.34533650452146436
Validation roc_auc: None
Validation avg_accuracy: 0.32097263715694646
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
283/283 - 145s - loss: 0.6428 - accuracy: 0.5759 - 145s/epoch - 513ms/step
Epoch 4/110
Validation cm: [[379  19 337  20]
 [210  19 268  77]
 [ 14   1  69  11]
 [ 12   0 102   5]]
Validation val_loss: 0.7006648584224926
Validation normalized_cm: [[0.502 0.025 0.446 0.026]
 [0.366 0.033 0.467 0.134]
 [0.147 0.011 0.726 0.116]
 [0.101 0.    0.857 0.042]]
Validation acc: 0.30589760207388206
Validation class_accuracies: [0.5019867549668874, 0.033101045296167246, 0.7263157894736842, 0.04201680672268908]
Validation sensitivity: 0.11802030456852793
Validation specificity: 0.5019867549668874
Validation icbhi_score: 0.3100035297677077
Validation roc_auc: None
Validation avg_accuracy: 0.325855099114857
Validation one_indexed_epoch: 4
The validation tracker metric at 0.34533650452146436 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 146s - loss: 0.5974 - accuracy: 0.6342 - 146s/epoch - 517ms/step
Epoch 5/110
Validation cm: [[253 142 200 160]
 [ 92  78 147 257]
 [  9  11  47  28]
 [ 11   8  50  50]]
Validation val_loss: 0.7317998169964193
Validation normalized_cm: [[0.335 0.188 0.265 0.212]
 [0.16  0.136 0.256 0.448]
 [0.095 0.116 0.495 0.295]
 [0.092 0.067 0.42  0.42 ]]
Validation acc: 0.27738172391445237
Validation class_accuracies: [0.3350993377483444, 0.13588850174216027, 0.49473684210526314, 0.42016806722689076]
Validation sensitivity: 0.22208121827411167
Validation specificity: 0.3350993377483444
Validation icbhi_score: 0.27859027801122804
Validation roc_auc: None
Validation avg_accuracy: 0.34647318720566467
Validation one_indexed_epoch: 5
The validation tracker metric at 0.34533650452146436 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 145s - loss: 0.5552 - accuracy: 0.6844 - 145s/epoch - 511ms/step
Epoch 6/110
Validation cm: [[679  47  25   4]
 [505  51  16   2]
 [ 38   7  46   4]
 [ 55   4  50  10]]
Validation val_loss: 0.5232682976912773
Validation normalized_cm: [[0.899 0.062 0.033 0.005]
 [0.88  0.089 0.028 0.003]
 [0.4   0.074 0.484 0.042]
 [0.462 0.034 0.42  0.084]]
Validation acc: 0.509397278029812
Validation class_accuracies: [0.8993377483443709, 0.08885017421602788, 0.4842105263157895, 0.08403361344537816]
Validation sensitivity: 0.13578680203045684
Validation specificity: 0.8993377483443709
Validation icbhi_score: 0.5175622751874138
Validation roc_auc: None
Validation avg_accuracy: 0.3891080155803916
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
283/283 - 146s - loss: 0.5166 - accuracy: 0.7273 - 146s/epoch - 517ms/step
Epoch 7/110
Validation cm: [[708   7  40   0]
 [538   8  28   0]
 [ 50   0  45   0]
 [ 83   0  35   1]]
Validation val_loss: 0.5664870671092576
Validation normalized_cm: [[0.938 0.009 0.053 0.   ]
 [0.937 0.014 0.049 0.   ]
 [0.526 0.    0.474 0.   ]
 [0.697 0.    0.294 0.008]]
Validation acc: 0.4938431626701231
Validation class_accuracies: [0.937748344370861, 0.013937282229965157, 0.47368421052631576, 0.008403361344537815]
Validation sensitivity: 0.06852791878172589
Validation specificity: 0.937748344370861
Validation icbhi_score: 0.5031381315762934
Validation roc_auc: None
Validation avg_accuracy: 0.35844329961791993
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5175622751874138 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 146s - loss: 0.4946 - accuracy: 0.7477 - 146s/epoch - 515ms/step
Epoch 8/110
Validation cm: [[442 192  79  42]
 [212 258  57  47]
 [ 12   8  65  10]
 [ 19  24  56  20]]
Validation val_loss: 0.5752378810711364
Validation normalized_cm: [[0.585 0.254 0.105 0.056]
 [0.369 0.449 0.099 0.082]
 [0.126 0.084 0.684 0.105]
 [0.16  0.202 0.471 0.168]]
Validation acc: 0.508749189889825
Validation class_accuracies: [0.5854304635761589, 0.44947735191637633, 0.6842105263157895, 0.16806722689075632]
Validation sensitivity: 0.4352791878172589
Validation specificity: 0.5854304635761589
Validation icbhi_score: 0.5103548256967089
Validation roc_auc: None
Validation avg_accuracy: 0.47179639217477026
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5175622751874138 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 147s - loss: 0.4701 - accuracy: 0.7477 - 147s/epoch - 518ms/step
Epoch 9/110
Validation cm: [[456  53 158  88]
 [197 101 112 164]
 [ 19   1  52  23]
 [ 20   6  61  32]]
Validation val_loss: 0.7430681683948808
Validation normalized_cm: [[0.604 0.07  0.209 0.117]
 [0.343 0.176 0.195 0.286]
 [0.2   0.011 0.547 0.242]
 [0.168 0.05  0.513 0.269]]
Validation acc: 0.4154244977316915
Validation class_accuracies: [0.6039735099337749, 0.1759581881533101, 0.5473684210526316, 0.2689075630252101]
Validation sensitivity: 0.23477157360406092
Validation specificity: 0.6039735099337749
Validation icbhi_score: 0.4193725417689179
Validation roc_auc: None
Validation avg_accuracy: 0.3990519205412316
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5175622751874138 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 145s - loss: 0.4542 - accuracy: 0.7581 - 145s/epoch - 512ms/step
Epoch 10/110
Validation cm: [[534 129  68  24]
 [276 230  38  30]
 [ 21   7  57  10]
 [ 26  18  55  20]]
Validation val_loss: 0.5467204040221807
Validation normalized_cm: [[0.707 0.171 0.09  0.032]
 [0.481 0.401 0.066 0.052]
 [0.221 0.074 0.6   0.105]
 [0.218 0.151 0.462 0.168]]
Validation acc: 0.5450421257290992
Validation class_accuracies: [0.7072847682119205, 0.40069686411149824, 0.6, 0.16806722689075632]
Validation sensitivity: 0.3895939086294416
Validation specificity: 0.7072847682119205
Validation icbhi_score: 0.548439338420681
Validation roc_auc: None
Validation avg_accuracy: 0.46901221480354377
Validation one_indexed_epoch: 10
-- New best results were achieved. --
There is no such attribute
283/283 - 145s - loss: 0.4285 - accuracy: 0.7707 - 145s/epoch - 514ms/step
Epoch 11/110
Validation cm: [[337 319  43  56]
 [ 89 422  20  43]
 [  9  24  32  30]
 [ 13  34  35  37]]
Validation val_loss: 0.5408802774317721
Validation normalized_cm: [[0.446 0.423 0.057 0.074]
 [0.155 0.735 0.035 0.075]
 [0.095 0.253 0.337 0.316]
 [0.109 0.286 0.294 0.311]]
Validation acc: 0.5366169799092677
Validation class_accuracies: [0.4463576158940397, 0.735191637630662, 0.3368421052631579, 0.31092436974789917]
Validation sensitivity: 0.6230964467005076
Validation specificity: 0.4463576158940397
Validation icbhi_score: 0.5347270312972736
Validation roc_auc: None
Validation avg_accuracy: 0.45732893213393966
Validation one_indexed_epoch: 11
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 147s - loss: 0.4051 - accuracy: 0.7698 - 147s/epoch - 519ms/step
Epoch 12/110
Validation cm: [[615  42  90   8]
 [376 132  47  19]
 [ 32   3  58   2]
 [ 44   6  61   8]]
Validation val_loss: 0.5472195384419165
Validation normalized_cm: [[0.815 0.056 0.119 0.011]
 [0.655 0.23  0.082 0.033]
 [0.337 0.032 0.611 0.021]
 [0.37  0.05  0.513 0.067]]
Validation acc: 0.5268956578094621
Validation class_accuracies: [0.8145695364238411, 0.22996515679442509, 0.6105263157894737, 0.06722689075630252]
Validation sensitivity: 0.2512690355329949
Validation specificity: 0.8145695364238411
Validation icbhi_score: 0.532919285978418
Validation roc_auc: None
Validation avg_accuracy: 0.43057197494101057
Validation one_indexed_epoch: 12
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 146s - loss: 0.3948 - accuracy: 0.7760 - 146s/epoch - 515ms/step
Epoch 13/110
Validation cm: [[574  68 100  13]
 [302 167  75  30]
 [ 28   6  52   9]
 [ 28  10  63  18]]
Validation val_loss: 0.5705046400377117
Validation normalized_cm: [[0.76  0.09  0.132 0.017]
 [0.526 0.291 0.131 0.052]
 [0.295 0.063 0.547 0.095]
 [0.235 0.084 0.529 0.151]]
Validation acc: 0.525599481529488
Validation class_accuracies: [0.7602649006622516, 0.29094076655052264, 0.5473684210526316, 0.15126050420168066]
Validation sensitivity: 0.30076142131979694
Validation specificity: 0.7602649006622516
Validation icbhi_score: 0.5305131609910243
Validation roc_auc: None
Validation avg_accuracy: 0.4374586481167716
Validation one_indexed_epoch: 13
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 151s - loss: 0.3616 - accuracy: 0.7804 - 151s/epoch - 534ms/step
Epoch 14/110
Validation cm: [[613  59  76   7]
 [404 128  36   6]
 [ 41   6  44   4]
 [ 47   7  55  10]]
Validation val_loss: 0.5878713155516597
Validation normalized_cm: [[0.812 0.078 0.101 0.009]
 [0.704 0.223 0.063 0.01 ]
 [0.432 0.063 0.463 0.042]
 [0.395 0.059 0.462 0.084]]
Validation acc: 0.5152300712896954
Validation class_accuracies: [0.8119205298013245, 0.2229965156794425, 0.4631578947368421, 0.08403361344537816]
Validation sensitivity: 0.23096446700507614
Validation specificity: 0.8119205298013245
Validation icbhi_score: 0.5214424984032003
Validation roc_auc: None
Validation avg_accuracy: 0.39552713841574677
Validation one_indexed_epoch: 14
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 4 epochs
There is no such attribute
283/283 - 161s - loss: 0.3366 - accuracy: 0.7972 - 161s/epoch - 568ms/step
Epoch 15/110
Validation cm: [[469 145  93  48]
 [203 242  75  54]
 [ 21   6  52  16]
 [ 17  20  55  27]]
Validation val_loss: 0.5839076005018963
Validation normalized_cm: [[0.621 0.192 0.123 0.064]
 [0.354 0.422 0.131 0.094]
 [0.221 0.063 0.547 0.168]
 [0.143 0.168 0.462 0.227]]
Validation acc: 0.5119896305897602
Validation class_accuracies: [0.6211920529801325, 0.42160278745644597, 0.5473684210526316, 0.226890756302521]
Validation sensitivity: 0.4073604060913706
Validation specificity: 0.6211920529801325
Validation icbhi_score: 0.5142762295357515
Validation roc_auc: None
Validation avg_accuracy: 0.45426350444793273
Validation one_indexed_epoch: 15
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
283/283 - 146s - loss: 0.3283 - accuracy: 0.7888 - 146s/epoch - 516ms/step
Epoch 16/110
Validation cm: [[549 123  49  34]
 [354 163  33  24]
 [ 18  10  50  17]
 [ 32  18  41  28]]
Validation val_loss: 0.5585400946610333
Validation normalized_cm: [[0.727 0.163 0.065 0.045]
 [0.617 0.284 0.057 0.042]
 [0.189 0.105 0.526 0.179]
 [0.269 0.151 0.345 0.235]]
Validation acc: 0.5119896305897602
Validation class_accuracies: [0.7271523178807947, 0.28397212543554007, 0.5263157894736842, 0.23529411764705882]
Validation sensitivity: 0.30583756345177665
Validation specificity: 0.7271523178807947
Validation icbhi_score: 0.5164949406662857
Validation roc_auc: None
Validation avg_accuracy: 0.44318358760926946
Validation one_indexed_epoch: 16
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 6 epochs
There is no such attribute
283/283 - 146s - loss: 0.2950 - accuracy: 0.7941 - 146s/epoch - 517ms/step
Epoch 17/110
Validation cm: [[433 198  50  74]
 [210 264  53  47]
 [ 15  12  46  22]
 [ 20  21  55  23]]
Validation val_loss: 0.6755030511661746
Validation normalized_cm: [[0.574 0.262 0.066 0.098]
 [0.366 0.46  0.092 0.082]
 [0.158 0.126 0.484 0.232]
 [0.168 0.176 0.462 0.193]]
Validation acc: 0.4964355152300713
Validation class_accuracies: [0.5735099337748344, 0.45993031358885017, 0.4842105263157895, 0.19327731092436976]
Validation sensitivity: 0.42258883248730966
Validation specificity: 0.5735099337748344
Validation icbhi_score: 0.49804938313107205
Validation roc_auc: None
Validation avg_accuracy: 0.42773202115096093
Validation one_indexed_epoch: 17
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 7 epochs
There is no such attribute
283/283 - 151s - loss: 0.2797 - accuracy: 0.7994 - 151s/epoch - 532ms/step
Epoch 18/110
Validation cm: [[562 100  70  23]
 [321 206  28  19]
 [ 26   9  46  14]
 [ 35  14  45  25]]
Validation val_loss: 0.5734507124114279
Validation normalized_cm: [[0.744 0.132 0.093 0.03 ]
 [0.559 0.359 0.049 0.033]
 [0.274 0.095 0.484 0.147]
 [0.294 0.118 0.378 0.21 ]]
Validation acc: 0.5437459494491251
Validation class_accuracies: [0.7443708609271523, 0.3588850174216028, 0.4842105263157895, 0.21008403361344538]
Validation sensitivity: 0.35152284263959394
Validation specificity: 0.7443708609271523
Validation icbhi_score: 0.5479468517833731
Validation roc_auc: None
Validation avg_accuracy: 0.44938760956949747
Validation one_indexed_epoch: 18
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 8 epochs
There is no such attribute
283/283 - 156s - loss: 0.2622 - accuracy: 0.8127 - 156s/epoch - 550ms/step
Epoch 19/110
Validation cm: [[412 233  48  62]
 [177 326  30  41]
 [ 19  15  34  27]
 [ 21  28  31  39]]
Validation val_loss: 0.5763563370444991
Validation normalized_cm: [[0.546 0.309 0.064 0.082]
 [0.308 0.568 0.052 0.071]
 [0.2   0.158 0.358 0.284]
 [0.176 0.235 0.261 0.328]]
Validation acc: 0.525599481529488
Validation class_accuracies: [0.5456953642384106, 0.5679442508710801, 0.35789473684210527, 0.3277310924369748]
Validation sensitivity: 0.5063451776649747
Validation specificity: 0.5456953642384106
Validation icbhi_score: 0.5260202709516926
Validation roc_auc: None
Validation avg_accuracy: 0.4498163610971427
Validation one_indexed_epoch: 19
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 9 epochs
There is no such attribute
283/283 - 160s - loss: 0.2548 - accuracy: 0.8180 - 160s/epoch - 564ms/step
Epoch 20/110
Validation cm: [[587  82  51  35]
 [343 176  37  18]
 [ 23   8  50  14]
 [ 32  20  50  17]]
Validation val_loss: 0.6401873688794171
Validation normalized_cm: [[0.777 0.109 0.068 0.046]
 [0.598 0.307 0.064 0.031]
 [0.242 0.084 0.526 0.147]
 [0.269 0.168 0.42  0.143]]
Validation acc: 0.5379131561892417
Validation class_accuracies: [0.7774834437086092, 0.30662020905923343, 0.5263157894736842, 0.14285714285714285]
Validation sensitivity: 0.3083756345177665
Validation specificity: 0.7774834437086092
Validation icbhi_score: 0.5429295391131879
Validation roc_auc: None
Validation avg_accuracy: 0.4383191462746674
Validation one_indexed_epoch: 20
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
283/283 - 159s - loss: 0.2532 - accuracy: 0.8182 - 159s/epoch - 562ms/step
Epoch 21/110
Validation cm: [[442 178  89  46]
 [220 241  45  68]
 [ 19   4  53  19]
 [ 17  19  61  22]]
Validation val_loss: 0.673243952673339
Validation normalized_cm: [[0.585 0.236 0.118 0.061]
 [0.383 0.42  0.078 0.118]
 [0.2   0.042 0.558 0.2  ]
 [0.143 0.16  0.513 0.185]]
Validation acc: 0.49125081011017496
Validation class_accuracies: [0.5854304635761589, 0.41986062717770034, 0.5578947368421052, 0.18487394957983194]
Validation sensitivity: 0.4010152284263959
Validation specificity: 0.5854304635761589
Validation icbhi_score: 0.4932228460012774
Validation roc_auc: None
Validation avg_accuracy: 0.4370149442939491
Validation one_indexed_epoch: 21
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 11 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 160s - loss: 0.2237 - accuracy: 0.8271 - 160s/epoch - 564ms/step
Epoch 22/110
Validation cm: [[629  36  82   8]
 [392 118  54  10]
 [ 27   4  60   4]
 [ 47   4  63   5]]
Validation val_loss: 0.7107304613709834
Validation normalized_cm: [[0.833 0.048 0.109 0.011]
 [0.683 0.206 0.094 0.017]
 [0.284 0.042 0.632 0.042]
 [0.395 0.034 0.529 0.042]]
Validation acc: 0.5262475696694751
Validation class_accuracies: [0.833112582781457, 0.20557491289198607, 0.631578947368421, 0.04201680672268908]
Validation sensitivity: 0.23223350253807107
Validation specificity: 0.833112582781457
Validation icbhi_score: 0.532673042659764
Validation roc_auc: None
Validation avg_accuracy: 0.4280708124411383
Validation one_indexed_epoch: 22
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 12 epochs
There is no such attribute
283/283 - 159s - loss: 0.2209 - accuracy: 0.8251 - 159s/epoch - 561ms/step
Epoch 23/110
Validation cm: [[409 226  66  54]
 [178 314  44  38]
 [ 19  10  50  16]
 [ 18  24  55  22]]
Validation val_loss: 0.668267957716806
Validation normalized_cm: [[0.542 0.299 0.087 0.072]
 [0.31  0.547 0.077 0.066]
 [0.2   0.105 0.526 0.168]
 [0.151 0.202 0.462 0.185]]
Validation acc: 0.5152300712896954
Validation class_accuracies: [0.5417218543046357, 0.5470383275261324, 0.5263157894736842, 0.18487394957983194]
Validation sensitivity: 0.48984771573604063
Validation specificity: 0.5417218543046357
Validation icbhi_score: 0.5157847850203382
Validation roc_auc: None
Validation avg_accuracy: 0.449987480221071
Validation one_indexed_epoch: 23
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 13 epochs
There is no such attribute
283/283 - 154s - loss: 0.2243 - accuracy: 0.8268 - 154s/epoch - 545ms/step
Epoch 24/110
Validation cm: [[532  95 109  19]
 [338 157  66  13]
 [ 29   4  58   4]
 [ 39   7  66   7]]
Validation val_loss: 0.7362278223537313
Validation normalized_cm: [[0.705 0.126 0.144 0.025]
 [0.589 0.274 0.115 0.023]
 [0.305 0.042 0.611 0.042]
 [0.328 0.059 0.555 0.059]]
Validation acc: 0.48865845755022685
Validation class_accuracies: [0.704635761589404, 0.2735191637630662, 0.6105263157894737, 0.058823529411764705]
Validation sensitivity: 0.2817258883248731
Validation specificity: 0.704635761589404
Validation icbhi_score: 0.49318082495713855
Validation roc_auc: None
Validation avg_accuracy: 0.4118761926384272
Validation one_indexed_epoch: 24
The validation tracker metric at 0.548439338420681 hasn't increased by 0 in 14 epochs
There is no such attribute
283/283 - 154s - loss: 0.2095 - accuracy: 0.8299 - 154s/epoch - 543ms/step
Epoch 25/110
Validation cm: [[391 252  69  43]
 [173 335  25  41]
 [ 23  10  51  11]
 [ 16  27  52  24]]
Validation val_loss: 0.7158004889480934
Validation normalized_cm: [[0.518 0.334 0.091 0.057]
 [0.301 0.584 0.044 0.071]
 [0.242 0.105 0.537 0.116]
 [0.134 0.227 0.437 0.202]]
Validation acc: 0.5191186001296176
Validation class_accuracies: [0.5178807947019868, 0.5836236933797909, 0.5368421052631579, 0.20168067226890757]
Validation sensitivity: 0.5203045685279187
Validation specificity: 0.5178807947019868
Validation icbhi_score: 0.5190926816149528
Validation roc_auc: None
Validation avg_accuracy: 0.4600068164034608
Validation one_indexed_epoch: 25
The number of epochs since last 1% equals the patience
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
283/283 - 160s - loss: 0.2127 - accuracy: 0.8291 - 160s/epoch - 566ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.548439338420681
Best cm: [[534 129  68  24]
 [276 230  38  30]
 [ 21   7  57  10]
 [ 26  18  55  20]]
Best val_loss: 0.5467204040221807
Best normalized_cm: [[0.707 0.171 0.09  0.032]
 [0.481 0.401 0.066 0.052]
 [0.221 0.074 0.6   0.105]
 [0.218 0.151 0.462 0.168]]
Best acc: 0.5450421257290992
Best class_accuracies: [0.7072847682119205, 0.40069686411149824, 0.6, 0.16806722689075632]
Best sensitivity: 0.3895939086294416
Best specificity: 0.7072847682119205
Best roc_auc: None
Best avg_accuracy: 0.46901221480354377
Best one_indexed_epoch: 10
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.701800525188446, 0.6751396059989929, 0.6428082585334778, 0.5974195003509521, 0.5552364587783813, 0.5165656805038452, 0.4945693612098694, 0.4700907766819, 0.4541947543621063, 0.4285147190093994, 0.40506330132484436, 0.394785612821579, 0.3616260886192322, 0.3365616500377655, 0.32832804322242737, 0.29497215151786804, 0.2797340452671051, 0.2622392773628235, 0.2548425495624542, 0.2531658411026001, 0.2236510068178177, 0.2208598256111145, 0.2242884337902069, 0.20954622328281403, 0.2126951664686203], 'accuracy': [0.361786812543869, 0.5095090866088867, 0.5758513808250427, 0.6342326402664185, 0.6844316720962524, 0.7273330092430115, 0.7476780414581299, 0.7476780414581299, 0.7580716609954834, 0.7706766724586487, 0.7697921395301819, 0.7759840488433838, 0.7804068922996521, 0.797213613986969, 0.7888102531433105, 0.7941176295280457, 0.7994250059127808, 0.8126934766769409, 0.8180009126663208, 0.8182220458984375, 0.8270676732063293, 0.8250774145126343, 0.8268465399742126, 0.829942524433136, 0.8290579319000244]}
End
####################################
Job dir: ../cache/cw/train187/11
