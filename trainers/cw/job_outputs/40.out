Validation cm: [[  0 740   0   0]
 [  0  92   0   0]
 [  0  77   0   0]
 [  0 130   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.08854667949951876
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train40
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization (BatchNormalization)        multiple                                    4                
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_3 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense (Dense)                                   multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[1. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 669s - loss: 0.5101 - accuracy: 0.5597 - 669s/epoch - 2s/step
Validation cm: [[534 189  17   0]
 [ 18  63  11   0]
 [ 54  16   7   0]
 [ 20  32  78   0]]
Validation normalized_cm: [[0.722 0.255 0.023 0.   ]
 [0.196 0.685 0.12  0.   ]
 [0.701 0.208 0.091 0.   ]
 [0.154 0.246 0.6   0.   ]]
Validation acc: 0.5813282001924928
Validation class_accuracies: [0.7216216216216216, 0.6847826086956522, 0.09090909090909091, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3743283303065912
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 656s - loss: 0.4109 - accuracy: 0.5762 - 656s/epoch - 2s/step
Validation cm: [[626  23  85   6]
 [ 46  26  12   8]
 [ 19   1  49   8]
 [ 24   3  88  15]]
Validation normalized_cm: [[0.846 0.031 0.115 0.008]
 [0.5   0.283 0.13  0.087]
 [0.247 0.013 0.636 0.104]
 [0.185 0.023 0.677 0.115]]
Validation acc: 0.6891241578440809
Validation class_accuracies: [0.845945945945946, 0.2826086956521739, 0.6363636363636364, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47007572333659287
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 657s - loss: 0.3732 - accuracy: 0.5980 - 657s/epoch - 2s/step
Validation cm: [[441 185 110   4]
 [ 10  68  10   4]
 [ 10  13  42  12]
 [  6  22  56  46]]
Validation normalized_cm: [[0.596 0.25  0.149 0.005]
 [0.109 0.739 0.109 0.043]
 [0.13  0.169 0.545 0.156]
 [0.046 0.169 0.431 0.354]]
Validation acc: 0.5745909528392685
Validation class_accuracies: [0.595945945945946, 0.7391304347826086, 0.5454545454545454, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5585942700073134
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 1.]]
-- New best results were achieved. --
Saving model...
330/330 - 658s - loss: 0.3562 - accuracy: 0.6143 - 658s/epoch - 2s/step
Validation cm: [[626  85  29   0]
 [ 33  35  24   0]
 [ 51   3  22   1]
 [ 23  14  84   9]]
Validation normalized_cm: [[0.846 0.115 0.039 0.   ]
 [0.359 0.38  0.261 0.   ]
 [0.662 0.039 0.286 0.013]
 [0.177 0.108 0.646 0.069]]
Validation acc: 0.6660250240615977
Validation class_accuracies: [0.845945945945946, 0.3804347826086957, 0.2857142857142857, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39533144587492414
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.5585942700073134 hasn't increased by 0 in 1 epochs
330/330 - 652s - loss: 0.3392 - accuracy: 0.6033 - 652s/epoch - 2s/step
Validation cm: [[689  31  17   3]
 [ 62  16  10   4]
 [ 58   0  15   4]
 [ 64   1  48  17]]
Validation normalized_cm: [[0.931 0.042 0.023 0.004]
 [0.674 0.174 0.109 0.043]
 [0.753 0.    0.195 0.052]
 [0.492 0.008 0.369 0.131]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.9310810810810811, 0.17391304347826086, 0.19480519480519481, 0.13076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3576421375334419
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.5585942700073134 hasn't increased by 0 in 2 epochs
330/330 - 649s - loss: 0.3290 - accuracy: 0.5937 - 649s/epoch - 2s/step
Validation cm: [[636  94   3   7]
 [ 30  50   3   9]
 [ 43  12  16   6]
 [ 24  19  44  43]]
Validation normalized_cm: [[0.859 0.127 0.004 0.009]
 [0.326 0.543 0.033 0.098]
 [0.558 0.156 0.208 0.078]
 [0.185 0.146 0.338 0.331]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [0.8594594594594595, 0.5434782608695652, 0.2077922077922078, 0.33076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4853747897226158
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.5585942700073134 hasn't increased by 0 in 3 epochs
330/330 - 651s - loss: 0.3147 - accuracy: 0.6162 - 651s/epoch - 2s/step
Validation cm: [[663  74   2   1]
 [ 68  24   0   0]
 [ 65   1  11   0]
 [ 81   8  39   2]]
Validation normalized_cm: [[0.896 0.1   0.003 0.001]
 [0.739 0.261 0.    0.   ]
 [0.844 0.013 0.143 0.   ]
 [0.623 0.062 0.3   0.015]]
Validation acc: 0.6737247353224254
Validation class_accuracies: [0.8959459459459459, 0.2608695652173913, 0.14285714285714285, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3287643173512738
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5585942700073134 hasn't increased by 0 in 4 epochs
330/330 - 665s - loss: 0.2952 - accuracy: 0.6451 - 665s/epoch - 2s/step
Validation cm: [[634  34  50  22]
 [ 44  18  15  15]
 [ 32   1  34  10]
 [ 39   6  44  41]]
Validation normalized_cm: [[0.857 0.046 0.068 0.03 ]
 [0.478 0.196 0.163 0.163]
 [0.416 0.013 0.442 0.13 ]
 [0.3   0.046 0.338 0.315]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.8567567567567568, 0.1956521739130435, 0.44155844155844154, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4523379969032143
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 1.]]
The validation tracker metric at 0.5585942700073134 hasn't increased by 0 in 5 epochs
330/330 - 674s - loss: 0.2866 - accuracy: 0.6445 - 674s/epoch - 2s/step
Validation cm: [[626  92  19   3]
 [ 34  35  21   2]
 [ 42   6  26   3]
 [ 20   8  71  31]]
Validation normalized_cm: [[0.846 0.124 0.026 0.004]
 [0.37  0.38  0.228 0.022]
 [0.545 0.078 0.338 0.039]
 [0.154 0.062 0.546 0.238]]
Validation acc: 0.6910490856592878
Validation class_accuracies: [0.845945945945946, 0.3804347826086957, 0.33766233766233766, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45062615116962945
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 669s - loss: 0.2748 - accuracy: 0.6050 - 669s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5585942700073134
Best cm: [[441 185 110   4]
 [ 10  68  10   4]
 [ 10  13  42  12]
 [  6  22  56  46]]
Best normalized_cm: [[0.596 0.25  0.149 0.005]
 [0.109 0.739 0.109 0.043]
 [0.13  0.169 0.545 0.156]
 [0.046 0.169 0.431 0.354]]
Best acc: 0.5745909528392685
Best class_accuracies: [0.595945945945946, 0.7391304347826086, 0.5454545454545454, 0.35384615384615387]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 4
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [125   0   5   0]]
Validation normalized_cm: [[1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.962 0.    0.038 0.   ]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_4 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_1 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 822s - accuracy: 0.5697 - student_loss: 0.5826 - distillation_loss: -8.3207e-03 - val_accuracy: 0.8518 - val_student_loss: 0.1809 - 822s/epoch - 2s/step
Validation cm: [[ 55   1 150 534]
 [  0   0   5  87]
 [  3   0   7  67]
 [  0   0   5 125]]
Validation normalized_cm: [[0.074 0.001 0.203 0.722]
 [0.    0.    0.054 0.946]
 [0.039 0.    0.091 0.87 ]
 [0.    0.    0.038 0.962]]
Validation acc: 0.17998075072184794
Validation class_accuracies: [0.07432432432432433, 0.0, 0.09090909090909091, 0.9615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2816929691929692
Validation one_indexed_epoch: 2
Epoch 2/20
[[1. 1.]]
-- New best results were achieved. --
Saving model...
330/330 - 816s - accuracy: 0.6087 - student_loss: 0.4193 - distillation_loss: 0.0047 - val_accuracy: 0.1165 - val_student_loss: 4.0198 - 816s/epoch - 2s/step
Validation cm: [[639  75  24   2]
 [ 48  24  16   4]
 [ 55   5  15   2]
 [ 35  16  68  11]]
Validation normalized_cm: [[0.864 0.101 0.032 0.003]
 [0.522 0.261 0.174 0.043]
 [0.714 0.065 0.195 0.026]
 [0.269 0.123 0.523 0.085]]
Validation acc: 0.6631376323387873
Validation class_accuracies: [0.8635135135135135, 0.2608695652173913, 0.19480519480519481, 0.08461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35095091453787103
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 817s - accuracy: 0.6066 - student_loss: 0.3143 - distillation_loss: 0.0116 - val_accuracy: 0.4013 - val_student_loss: 0.5889 - 817s/epoch - 2s/step
Validation cm: [[633  98   8   1]
 [ 43  42   5   2]
 [ 62   9   3   3]
 [ 44  24  47  15]]
Validation normalized_cm: [[0.855 0.132 0.011 0.001]
 [0.467 0.457 0.054 0.022]
 [0.805 0.117 0.039 0.039]
 [0.338 0.185 0.362 0.115]]
Validation acc: 0.6669874879692012
Validation class_accuracies: [0.8554054054054054, 0.45652173913043476, 0.03896103896103896, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36656819972037363
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 816s - accuracy: 0.6214 - student_loss: 0.4153 - distillation_loss: -7.8880e-03 - val_accuracy: 0.6179 - val_student_loss: 0.1287 - 816s/epoch - 2s/step
Validation cm: [[420 282  15  23]
 [  9  58   3  22]
 [ 31  16   9  21]
 [  5  24  19  82]]
Validation normalized_cm: [[0.568 0.381 0.02  0.031]
 [0.098 0.63  0.033 0.239]
 [0.403 0.208 0.117 0.273]
 [0.038 0.185 0.146 0.631]]
Validation acc: 0.5476419634263715
Validation class_accuracies: [0.5675675675675675, 0.6304347826086957, 0.11688311688311688, 0.6307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4864136744571527
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 817s - accuracy: 0.6288 - student_loss: 0.1319 - distillation_loss: -5.6514e-04 - val_accuracy: 0.7719 - val_student_loss: 1.1247 - 817s/epoch - 2s/step
Validation cm: [[552 123  35  30]
 [ 23  33   4  32]
 [ 26   6  32  13]
 [  9  13  30  78]]
Validation normalized_cm: [[0.746 0.166 0.047 0.041]
 [0.25  0.359 0.043 0.348]
 [0.338 0.078 0.416 0.169]
 [0.069 0.1   0.231 0.6  ]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.745945945945946, 0.358695652173913, 0.4155844155844156, 0.6]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5300565034260687
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 820s - accuracy: 0.6339 - student_loss: 0.6989 - distillation_loss: 0.0028 - val_accuracy: 0.5072 - val_student_loss: 1.1183 - 820s/epoch - 2s/step
Validation cm: [[552 181   5   2]
 [ 27  59   2   4]
 [ 43  22   4   8]
 [ 18  43  25  44]]
Validation normalized_cm: [[0.746 0.245 0.007 0.003]
 [0.293 0.641 0.022 0.043]
 [0.558 0.286 0.052 0.104]
 [0.138 0.331 0.192 0.338]]
Validation acc: 0.6342637151106834
Validation class_accuracies: [0.745945945945946, 0.6413043478260869, 0.05194805194805195, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44441497104540584
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.5300565034260687 hasn't increased by 0 in 1 epochs
330/330 - 797s - accuracy: 0.6324 - student_loss: 0.4531 - distillation_loss: 0.0052 - val_accuracy: 0.8239 - val_student_loss: 0.2204 - 797s/epoch - 2s/step
Validation cm: [[682  26  30   2]
 [ 63  10   7  12]
 [ 45   2  26   4]
 [ 35  10  73  12]]
Validation normalized_cm: [[0.922 0.035 0.041 0.003]
 [0.685 0.109 0.076 0.13 ]
 [0.584 0.026 0.338 0.052]
 [0.269 0.077 0.562 0.092]]
Validation acc: 0.7025986525505293
Validation class_accuracies: [0.9216216216216216, 0.10869565217391304, 0.33766233766233766, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3650718259413912
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5300565034260687 hasn't increased by 0 in 2 epochs
330/330 - 797s - accuracy: 0.6386 - student_loss: 0.2061 - distillation_loss: -7.6558e-04 - val_accuracy: 0.4129 - val_student_loss: 0.9426 - 797s/epoch - 2s/step
Validation cm: [[624 113   2   1]
 [ 38  42   1  11]
 [ 52  10  13   2]
 [ 43  26  43  18]]
Validation normalized_cm: [[0.843 0.153 0.003 0.001]
 [0.413 0.457 0.011 0.12 ]
 [0.675 0.13  0.169 0.026]
 [0.331 0.2   0.331 0.138]]
Validation acc: 0.670837343599615
Validation class_accuracies: [0.8432432432432433, 0.45652173913043476, 0.16883116883116883, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4017644224165963
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5300565034260687 hasn't increased by 0 in 3 epochs
330/330 - 798s - accuracy: 0.6236 - student_loss: 0.0827 - distillation_loss: -5.7814e-03 - val_accuracy: 0.7305 - val_student_loss: 0.2616 - 798s/epoch - 2s/step
Validation cm: [[597  45  76  22]
 [ 37  16  19  20]
 [ 30   4  29  14]
 [ 24  11  41  54]]
Validation normalized_cm: [[0.807 0.061 0.103 0.03 ]
 [0.402 0.174 0.207 0.217]
 [0.39  0.052 0.377 0.182]
 [0.185 0.085 0.315 0.415]]
Validation acc: 0.6698748796920115
Validation class_accuracies: [0.8067567567567567, 0.17391304347826086, 0.37662337662337664, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4431694480607524
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5300565034260687 hasn't increased by 0 in 4 epochs
330/330 - 799s - accuracy: 0.6322 - student_loss: 0.0834 - distillation_loss: -2.7891e-03 - val_accuracy: 0.4812 - val_student_loss: 1.0631 - 799s/epoch - 2s/step
Validation cm: [[524 181  28   7]
 [ 13  55   4  20]
 [ 22  10  34  11]
 [ 15  28  28  59]]
Validation normalized_cm: [[0.708 0.245 0.038 0.009]
 [0.141 0.598 0.043 0.217]
 [0.286 0.13  0.442 0.143]
 [0.115 0.215 0.215 0.454]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.7081081081081081, 0.5978260869565217, 0.44155844155844154, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5503346976173064
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 800s - accuracy: 0.6517 - student_loss: 0.3465 - distillation_loss: 0.0066 - val_accuracy: 0.6699 - val_student_loss: 0.4809 - 800s/epoch - 2s/step
Validation cm: [[437 224  27  52]
 [ 12  43   7  30]
 [ 25  15  12  25]
 [  8  21  46  55]]
Validation normalized_cm: [[0.591 0.303 0.036 0.07 ]
 [0.13  0.467 0.076 0.326]
 [0.325 0.195 0.156 0.325]
 [0.062 0.162 0.354 0.423]]
Validation acc: 0.5264677574590952
Validation class_accuracies: [0.5905405405405405, 0.4673913043478261, 0.15584415584415584, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4092132309523614
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5503346976173064 hasn't increased by 0 in 1 epochs
330/330 - 752s - accuracy: 0.6204 - student_loss: 0.3689 - distillation_loss: 0.0014 - val_accuracy: 0.7642 - val_student_loss: 1.2514 - 752s/epoch - 2s/step
Validation cm: [[677  58   3   2]
 [ 49  37   1   5]
 [ 48   3  23   3]
 [ 61   9  31  29]]
Validation normalized_cm: [[0.915 0.078 0.004 0.003]
 [0.533 0.402 0.011 0.054]
 [0.623 0.039 0.299 0.039]
 [0.469 0.069 0.238 0.223]]
Validation acc: 0.737247353224254
Validation class_accuracies: [0.9148648648648648, 0.40217391304347827, 0.2987012987012987, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4597042499216413
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.5503346976173064 hasn't increased by 0 in 2 epochs
330/330 - 719s - accuracy: 0.6519 - student_loss: 0.2616 - distillation_loss: -2.2868e-03 - val_accuracy: 0.6603 - val_student_loss: 0.0545 - 719s/epoch - 2s/step
Validation cm: [[609 124   2   5]
 [ 37  46   1   8]
 [ 52  13  11   1]
 [ 60  20  30  20]]
Validation normalized_cm: [[0.823 0.168 0.003 0.007]
 [0.402 0.5   0.011 0.087]
 [0.675 0.169 0.143 0.013]
 [0.462 0.154 0.231 0.154]]
Validation acc: 0.6602502406159769
Validation class_accuracies: [0.822972972972973, 0.5, 0.14285714285714285, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40491906741906736
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.5503346976173064 hasn't increased by 0 in 3 epochs
330/330 - 728s - accuracy: 0.6352 - student_loss: 0.1047 - distillation_loss: -1.0362e-03 - val_accuracy: 0.7652 - val_student_loss: 0.0581 - 728s/epoch - 2s/step
Validation cm: [[528 196   9   7]
 [ 13  55   6  18]
 [ 39  14  16   8]
 [ 22  27  49  32]]
Validation normalized_cm: [[0.714 0.265 0.012 0.009]
 [0.141 0.598 0.065 0.196]
 [0.506 0.182 0.208 0.104]
 [0.169 0.208 0.377 0.246]]
Validation acc: 0.6073147256977863
Validation class_accuracies: [0.7135135135135136, 0.5978260869565217, 0.2077922077922078, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44132141360402233
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.5503346976173064 hasn't increased by 0 in 4 epochs
330/330 - 736s - accuracy: 0.6303 - student_loss: 0.1596 - distillation_loss: -1.3120e-03 - val_accuracy: 0.7690 - val_student_loss: 0.9956 - 736s/epoch - 2s/step
Validation cm: [[566 123  31  20]
 [ 15  43   9  25]
 [ 34  10  28   5]
 [ 14  25  54  37]]
Validation normalized_cm: [[0.765 0.166 0.042 0.027]
 [0.163 0.467 0.098 0.272]
 [0.442 0.13  0.364 0.065]
 [0.108 0.192 0.415 0.285]]
Validation acc: 0.6487006737247353
Validation class_accuracies: [0.7648648648648648, 0.4673913043478261, 0.36363636363636365, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4701269793661098
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.5503346976173064 hasn't increased by 0 in 5 epochs
330/330 - 734s - accuracy: 0.6436 - student_loss: 0.1454 - distillation_loss: 0.0090 - val_accuracy: 0.6083 - val_student_loss: 2.2969 - 734s/epoch - 2s/step
Validation cm: [[458 133  81  68]
 [ 13  34  11  34]
 [ 16   8  28  25]
 [  7  16  48  59]]
Validation normalized_cm: [[0.619 0.18  0.109 0.092]
 [0.141 0.37  0.12  0.37 ]
 [0.208 0.104 0.364 0.325]
 [0.054 0.123 0.369 0.454]]
Validation acc: 0.5572666025024061
Validation class_accuracies: [0.6189189189189189, 0.3695652173913043, 0.36363636363636365, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4514916634481852
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 734s - accuracy: 0.6555 - student_loss: 0.2399 - distillation_loss: 0.0024 - val_accuracy: 0.5890 - val_student_loss: 1.7767 - 734s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5503346976173064
Best cm: [[524 181  28   7]
 [ 13  55   4  20]
 [ 22  10  34  11]
 [ 15  28  28  59]]
Best normalized_cm: [[0.708 0.245 0.038 0.009]
 [0.141 0.598 0.043 0.217]
 [0.286 0.13  0.442 0.143]
 [0.115 0.215 0.215 0.454]]
Best acc: 0.6467757459095284
Best class_accuracies: [0.7081081081081081, 0.5978260869565217, 0.44155844155844154, 0.45384615384615384]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 11
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
