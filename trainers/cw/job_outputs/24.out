Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train24
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 539s - loss: 0.5812 - accuracy: 0.5973 - 539s/epoch - 2s/step
Validation cm: [[379 272  33  56]
 [ 11  53   1  27]
 [ 36  13  10  18]
 [  8  30   0  92]]
Validation normalized_cm: [[0.512 0.368 0.045 0.076]
 [0.12  0.576 0.011 0.293]
 [0.468 0.169 0.13  0.234]
 [0.062 0.231 0.    0.708]]
Validation acc: 0.5139557266602502
Validation class_accuracies: [0.5121621621621621, 0.5760869565217391, 0.12987012987012986, 0.7076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4814528890615847
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 542s - loss: 0.5058 - accuracy: 0.5764 - 542s/epoch - 2s/step
Validation cm: [[620  73  35  12]
 [ 34  33  17   8]
 [ 57   4  16   0]
 [ 27  14  88   1]]
Validation normalized_cm: [[0.838 0.099 0.047 0.016]
 [0.37  0.359 0.185 0.087]
 [0.74  0.052 0.208 0.   ]
 [0.208 0.108 0.677 0.008]]
Validation acc: 0.6448508180943214
Validation class_accuracies: [0.8378378378378378, 0.358695652173913, 0.2077922077922078, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3530045013740666
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
The validation tracker metric at 0.4814528890615847 hasn't increased by 0 in 1 epochs
330/330 - 525s - loss: 0.4430 - accuracy: 0.5766 - 525s/epoch - 2s/step
Validation cm: [[573  85  46  36]
 [ 19  42  15  16]
 [ 47   5  18   7]
 [ 16  14  85  15]]
Validation normalized_cm: [[0.774 0.115 0.062 0.049]
 [0.207 0.457 0.163 0.174]
 [0.61  0.065 0.234 0.091]
 [0.123 0.108 0.654 0.115]]
Validation acc: 0.6236766121270453
Validation class_accuracies: [0.7743243243243243, 0.45652173913043476, 0.23376623376623376, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3949992281514021
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
The validation tracker metric at 0.4814528890615847 hasn't increased by 0 in 2 epochs
330/330 - 538s - loss: 0.4116 - accuracy: 0.5644 - 538s/epoch - 2s/step
Validation cm: [[658  32  33  17]
 [ 46  23  18   5]
 [ 60   3  13   1]
 [ 43   2  84   1]]
Validation normalized_cm: [[0.889 0.043 0.045 0.023]
 [0.5   0.25  0.196 0.054]
 [0.779 0.039 0.169 0.013]
 [0.331 0.015 0.646 0.008]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.8891891891891892, 0.25, 0.16883116883116883, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3289281664281664
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
The validation tracker metric at 0.4814528890615847 hasn't increased by 0 in 3 epochs
330/330 - 537s - loss: 0.3900 - accuracy: 0.5828 - 537s/epoch - 2s/step
Validation cm: [[630  81  17  12]
 [ 32  37   9  14]
 [ 59   6   9   3]
 [ 31  20  78   1]]
Validation normalized_cm: [[0.851 0.109 0.023 0.016]
 [0.348 0.402 0.098 0.152]
 [0.766 0.078 0.117 0.039]
 [0.238 0.154 0.6   0.008]]
Validation acc: 0.6515880654475458
Validation class_accuracies: [0.8513513513513513, 0.40217391304347827, 0.11688311688311688, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3445251722425635
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.4814528890615847 hasn't increased by 0 in 4 epochs
330/330 - 538s - loss: 0.3708 - accuracy: 0.5794 - 538s/epoch - 2s/step
Validation cm: [[641  53  23  23]
 [ 39  38  13   2]
 [ 55   1  19   2]
 [ 35  10  82   3]]
Validation normalized_cm: [[0.866 0.072 0.031 0.031]
 [0.424 0.413 0.141 0.022]
 [0.714 0.013 0.247 0.026]
 [0.269 0.077 0.631 0.023]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8662162162162163, 0.41304347826086957, 0.24675324675324675, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38727246607681387
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
The validation tracker metric at 0.4814528890615847 hasn't increased by 0 in 5 epochs
330/330 - 537s - loss: 0.3592 - accuracy: 0.5978 - 537s/epoch - 2s/step
Validation cm: [[635  99   5   1]
 [ 30  51   5   6]
 [ 66   8   3   0]
 [ 48  22  58   2]]
Validation normalized_cm: [[0.858 0.134 0.007 0.001]
 [0.326 0.554 0.054 0.065]
 [0.857 0.104 0.039 0.   ]
 [0.369 0.169 0.446 0.015]]
Validation acc: 0.6650625601539942
Validation class_accuracies: [0.8581081081081081, 0.5543478260869565, 0.03896103896103896, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3667003971351797
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 537s - loss: 0.3439 - accuracy: 0.6140 - 537s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4814528890615847
Best cm: [[379 272  33  56]
 [ 11  53   1  27]
 [ 36  13  10  18]
 [  8  30   0  92]]
Best normalized_cm: [[0.512 0.368 0.045 0.076]
 [0.12  0.576 0.011 0.293]
 [0.468 0.169 0.13  0.234]
 [0.062 0.231 0.    0.708]]
Best acc: 0.5139557266602502
Best class_accuracies: [0.5121621621621621, 0.5760869565217391, 0.12987012987012986, 0.7076923076923077]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 2
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
