Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train14
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 850s - loss: 0.4499 - accuracy: 0.5641 - 850s/epoch - 3s/step
Validation cm: [[720  18   2   0]
 [ 83   6   3   0]
 [ 72   2   2   1]
 [ 91   0  32   7]]
Validation normalized_cm: [[0.973 0.024 0.003 0.   ]
 [0.902 0.065 0.033 0.   ]
 [0.935 0.026 0.026 0.013]
 [0.7   0.    0.246 0.054]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.972972972972973, 0.06521739130434782, 0.025974025974025976, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2795026360243752
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 860s - loss: 0.3626 - accuracy: 0.6453 - 860s/epoch - 3s/step
Validation cm: [[700  40   0   0]
 [ 76  15   0   1]
 [ 75   1   1   0]
 [ 93   2  35   0]]
Validation normalized_cm: [[0.946 0.054 0.    0.   ]
 [0.826 0.163 0.    0.011]
 [0.974 0.013 0.013 0.   ]
 [0.715 0.015 0.269 0.   ]]
Validation acc: 0.6891241578440809
Validation class_accuracies: [0.9459459459459459, 0.16304347826086957, 0.012987012987012988, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2804941092984571
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 855s - loss: 0.3417 - accuracy: 0.6607 - 855s/epoch - 3s/step
Validation cm: [[610 105  15  10]
 [ 31  48   9   4]
 [ 34   7  23  13]
 [ 40  11  65  14]]
Validation normalized_cm: [[0.824 0.142 0.02  0.014]
 [0.337 0.522 0.098 0.043]
 [0.442 0.091 0.299 0.169]
 [0.308 0.085 0.5   0.108]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.8243243243243243, 0.5217391304347826, 0.2987012987012987, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4381142652881783
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 864s - loss: 0.3128 - accuracy: 0.6307 - 864s/epoch - 3s/step
Validation cm: [[712  27   1   0]
 [ 77  14   1   0]
 [ 63   3  10   1]
 [ 99   0  25   6]]
Validation normalized_cm: [[0.962 0.036 0.001 0.   ]
 [0.837 0.152 0.011 0.   ]
 [0.818 0.039 0.13  0.013]
 [0.762 0.    0.192 0.046]]
Validation acc: 0.714148219441771
Validation class_accuracies: [0.9621621621621622, 0.15217391304347827, 0.12987012987012986, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3225900128074042
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
The validation tracker metric at 0.4381142652881783 hasn't increased by 0 in 1 epochs
330/330 - 868s - loss: 0.2906 - accuracy: 0.6212 - 868s/epoch - 3s/step
Validation cm: [[572  55  66  47]
 [ 21  31  16  24]
 [ 14   1  48  14]
 [ 12   2  72  44]]
Validation normalized_cm: [[0.773 0.074 0.089 0.064]
 [0.228 0.337 0.174 0.261]
 [0.182 0.013 0.623 0.182]
 [0.092 0.015 0.554 0.338]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.772972972972973, 0.33695652173913043, 0.6233766233766234, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5179419141375663
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 869s - loss: 0.2614 - accuracy: 0.6385 - 869s/epoch - 3s/step
Validation cm: [[493  39 138  70]
 [ 16  12  21  43]
 [ 15   2  53   7]
 [ 15   5  76  34]]
Validation normalized_cm: [[0.666 0.053 0.186 0.095]
 [0.174 0.13  0.228 0.467]
 [0.195 0.026 0.688 0.091]
 [0.115 0.038 0.585 0.262]]
Validation acc: 0.5697786333012512
Validation class_accuracies: [0.6662162162162162, 0.13043478260869565, 0.6883116883116883, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4366252871687654
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
The validation tracker metric at 0.5179419141375663 hasn't increased by 0 in 1 epochs
330/330 - 872s - loss: 0.2413 - accuracy: 0.6523 - 872s/epoch - 3s/step
Validation cm: [[644  53  25  18]
 [ 43  25  13  11]
 [ 29   4  36   8]
 [ 42   6  61  21]]
Validation normalized_cm: [[0.87  0.072 0.034 0.024]
 [0.467 0.272 0.141 0.12 ]
 [0.377 0.052 0.468 0.104]
 [0.323 0.046 0.469 0.162]]
Validation acc: 0.6987487969201155
Validation class_accuracies: [0.8702702702702703, 0.2717391304347826, 0.4675324675324675, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4427700824439955
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The validation tracker metric at 0.5179419141375663 hasn't increased by 0 in 2 epochs
330/330 - 870s - loss: 0.2131 - accuracy: 0.6366 - 870s/epoch - 3s/step
Validation cm: [[541 104  64  31]
 [ 22  42   8  20]
 [ 14   3  43  17]
 [ 21  19  53  37]]
Validation normalized_cm: [[0.731 0.141 0.086 0.042]
 [0.239 0.457 0.087 0.217]
 [0.182 0.039 0.558 0.221]
 [0.162 0.146 0.408 0.285]]
Validation acc: 0.6381135707410972
Validation class_accuracies: [0.731081081081081, 0.45652173913043476, 0.5584415584415584, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5076649408171147
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.5179419141375663 hasn't increased by 0 in 3 epochs
Lr has been adjusted to 0.0005000000237487257
330/330 - 863s - loss: 0.2002 - accuracy: 0.6316 - 863s/epoch - 3s/step
Validation cm: [[619  75  27  19]
 [ 33  36   8  15]
 [ 23   5  37  12]
 [ 32  10  49  39]]
Validation normalized_cm: [[0.836 0.101 0.036 0.026]
 [0.359 0.391 0.087 0.163]
 [0.299 0.065 0.481 0.156]
 [0.246 0.077 0.377 0.3  ]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.8364864864864865, 0.391304347826087, 0.4805194805194805, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5020775787080135
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.5179419141375663 hasn't increased by 0 in 4 epochs
330/330 - 860s - loss: 0.1526 - accuracy: 0.6377 - 860s/epoch - 3s/step
Validation cm: [[610  80  32  18]
 [ 33  31  12  16]
 [ 23   6  42   6]
 [ 25   7  65  33]]
Validation normalized_cm: [[0.824 0.108 0.043 0.024]
 [0.359 0.337 0.13  0.174]
 [0.299 0.078 0.545 0.078]
 [0.192 0.054 0.5   0.254]]
Validation acc: 0.6891241578440809
Validation class_accuracies: [0.8243243243243243, 0.33695652173913043, 0.5454545454545454, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4901453863410385
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.5179419141375663 hasn't increased by 0 in 5 epochs
330/330 - 862s - loss: 0.1343 - accuracy: 0.6472 - 862s/epoch - 3s/step
Validation cm: [[615  69  34  22]
 [ 38  27  10  17]
 [ 23   6  41   7]
 [ 29  10  51  40]]
Validation normalized_cm: [[0.831 0.093 0.046 0.03 ]
 [0.413 0.293 0.109 0.185]
 [0.299 0.078 0.532 0.091]
 [0.223 0.077 0.392 0.308]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.831081081081081, 0.29347826086956524, 0.5324675324675324, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49117979552762164
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
Lr has been adjusted to 0.0002500000118743628
330/330 - 866s - loss: 0.1127 - accuracy: 0.6369 - 866s/epoch - 3s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5179419141375663
Best cm: [[572  55  66  47]
 [ 21  31  16  24]
 [ 14   1  48  14]
 [ 12   2  72  44]]
Best normalized_cm: [[0.773 0.074 0.089 0.064]
 [0.228 0.337 0.174 0.261]
 [0.182 0.013 0.623 0.182]
 [0.092 0.015 0.554 0.338]]
Best acc: 0.6689124157844081
Best class_accuracies: [0.772972972972973, 0.33695652173913043, 0.6233766233766234, 0.3384615384615385]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 6
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
