Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train26
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    280              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,232
Trainable params: 105,736
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 459s - loss: 0.4483 - accuracy: 0.5997 - 459s/epoch - 1s/step
Validation cm: [[734   0   6   0]
 [ 86   0   4   2]
 [ 54   0  16   7]
 [ 74   0  44  12]]
Validation normalized_cm: [[0.992 0.    0.008 0.   ]
 [0.935 0.    0.043 0.022]
 [0.701 0.    0.208 0.091]
 [0.569 0.    0.338 0.092]]
Validation acc: 0.7333974975938402
Validation class_accuracies: [0.9918918918918919, 0.0, 0.2077922077922078, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.322997947997948
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 469s - loss: 0.3478 - accuracy: 0.6366 - 469s/epoch - 1s/step
Validation cm: [[703  33   4   0]
 [ 75  10   4   3]
 [ 58   0  14   5]
 [ 68   1  55   6]]
Validation normalized_cm: [[0.95  0.045 0.005 0.   ]
 [0.815 0.109 0.043 0.033]
 [0.753 0.    0.182 0.065]
 [0.523 0.008 0.423 0.046]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.95, 0.10869565217391304, 0.18181818181818182, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3216669200364853
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
The validation tracker metric at 0.322997947997948 hasn't increased by 0 in 1 epochs
330/330 - 470s - loss: 0.3065 - accuracy: 0.6354 - 470s/epoch - 1s/step
Validation cm: [[642  88   7   3]
 [ 28  47  11   6]
 [ 56   4  15   2]
 [ 45  13  49  23]]
Validation normalized_cm: [[0.868 0.119 0.009 0.004]
 [0.304 0.511 0.12  0.065]
 [0.727 0.052 0.195 0.026]
 [0.346 0.1   0.377 0.177]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.8675675675675676, 0.5108695652173914, 0.19480519480519481, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43754135112830767
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 468s - loss: 0.2706 - accuracy: 0.6367 - 468s/epoch - 1s/step
Validation cm: [[660  30  34  16]
 [ 63  11  12   6]
 [ 33   3  34   7]
 [ 39   3  65  23]]
Validation normalized_cm: [[0.892 0.041 0.046 0.022]
 [0.685 0.12  0.13  0.065]
 [0.429 0.039 0.442 0.091]
 [0.3   0.023 0.5   0.177]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8918918918918919, 0.11956521739130435, 0.44155844155844154, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4074846569411787
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
The validation tracker metric at 0.43754135112830767 hasn't increased by 0 in 1 epochs
330/330 - 467s - loss: 0.2421 - accuracy: 0.6430 - 467s/epoch - 1s/step
Validation cm: [[644  51  15  30]
 [ 43  29   7  13]
 [ 34   3  27  13]
 [ 23  20  36  51]]
Validation normalized_cm: [[0.87  0.069 0.02  0.041]
 [0.467 0.315 0.076 0.141]
 [0.442 0.039 0.351 0.169]
 [0.177 0.154 0.277 0.392]]
Validation acc: 0.7228103946102021
Validation class_accuracies: [0.8702702702702703, 0.31521739130434784, 0.35064935064935066, 0.3923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48211117613291526
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 467s - loss: 0.2060 - accuracy: 0.6525 - 467s/epoch - 1s/step
Validation cm: [[579  95  36  30]
 [ 25  40   9  18]
 [ 27   5  32  13]
 [ 14  13  70  33]]
Validation normalized_cm: [[0.782 0.128 0.049 0.041]
 [0.272 0.435 0.098 0.196]
 [0.351 0.065 0.416 0.169]
 [0.108 0.1   0.538 0.254]]
Validation acc: 0.65832531280077
Validation class_accuracies: [0.7824324324324324, 0.43478260869565216, 0.4155844155844156, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4716614026396635
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
The validation tracker metric at 0.48211117613291526 hasn't increased by 0 in 1 epochs
330/330 - 467s - loss: 0.1760 - accuracy: 0.6766 - 467s/epoch - 1s/step
Validation cm: [[640  59  24  17]
 [ 46  29   8   9]
 [ 36   4  29   8]
 [ 47  10  46  27]]
Validation normalized_cm: [[0.865 0.08  0.032 0.023]
 [0.5   0.315 0.087 0.098]
 [0.468 0.052 0.377 0.104]
 [0.362 0.077 0.354 0.208]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.8648648648648649, 0.31521739130434784, 0.37662337662337664, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44109948512122427
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The validation tracker metric at 0.48211117613291526 hasn't increased by 0 in 2 epochs
330/330 - 467s - loss: 0.1499 - accuracy: 0.6758 - 467s/epoch - 1s/step
Validation cm: [[606  82  23  29]
 [ 35  34  12  11]
 [ 40   4  20  13]
 [ 17   9  59  45]]
Validation normalized_cm: [[0.819 0.111 0.031 0.039]
 [0.38  0.37  0.13  0.12 ]
 [0.519 0.052 0.26  0.169]
 [0.131 0.069 0.454 0.346]]
Validation acc: 0.6785370548604427
Validation class_accuracies: [0.8189189189189189, 0.3695652173913043, 0.2597402597402597, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44859456055108227
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.48211117613291526 hasn't increased by 0 in 3 epochs
330/330 - 465s - loss: 0.1253 - accuracy: 0.6563 - 465s/epoch - 1s/step
Validation cm: [[624  74  28  14]
 [ 43  33  11   5]
 [ 34   5  30   8]
 [ 26   7  65  32]]
Validation normalized_cm: [[0.843 0.1   0.038 0.019]
 [0.467 0.359 0.12  0.054]
 [0.442 0.065 0.39  0.104]
 [0.2   0.054 0.5   0.246]]
Validation acc: 0.6920115495668913
Validation class_accuracies: [0.8432432432432433, 0.358695652173913, 0.38961038961038963, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45942578279534807
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.48211117613291526 hasn't increased by 0 in 4 epochs
330/330 - 465s - loss: 0.1032 - accuracy: 0.6711 - 465s/epoch - 1s/step
Validation cm: [[661  43  24  12]
 [ 59  17  11   5]
 [ 44   4  22   7]
 [ 38  11  45  36]]
Validation normalized_cm: [[0.893 0.058 0.032 0.016]
 [0.641 0.185 0.12  0.054]
 [0.571 0.052 0.286 0.091]
 [0.292 0.085 0.346 0.277]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.8932432432432432, 0.18478260869565216, 0.2857142857142857, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4101658036440645
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.48211117613291526 hasn't increased by 0 in 5 epochs
330/330 - 466s - loss: 0.0877 - accuracy: 0.6576 - 466s/epoch - 1s/step
Validation cm: [[620  74  17  29]
 [ 35  34   8  15]
 [ 41   5  20  11]
 [ 16  13  46  55]]
Validation normalized_cm: [[0.838 0.1   0.023 0.039]
 [0.38  0.37  0.087 0.163]
 [0.532 0.065 0.26  0.143]
 [0.123 0.1   0.354 0.423]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.8378378378378378, 0.3695652173913043, 0.2597402597402597, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4725550595115812
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 466s - loss: 0.0762 - accuracy: 0.6555 - 466s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.48211117613291526
Best cm: [[644  51  15  30]
 [ 43  29   7  13]
 [ 34   3  27  13]
 [ 23  20  36  51]]
Best normalized_cm: [[0.87  0.069 0.02  0.041]
 [0.467 0.315 0.076 0.141]
 [0.442 0.039 0.351 0.169]
 [0.177 0.154 0.277 0.392]]
Best acc: 0.7228103946102021
Best class_accuracies: [0.8702702702702703, 0.31521739130434784, 0.35064935064935066, 0.3923076923076923]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 6
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
