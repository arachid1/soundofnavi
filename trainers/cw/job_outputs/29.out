Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train29
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 592s - loss: 0.4379 - accuracy: 0.6026 - 592s/epoch - 2s/step
Validation cm: [[691  47   2   0]
 [ 72  19   0   1]
 [ 63   4   8   2]
 [ 60   8  54   8]]
Validation normalized_cm: [[0.934 0.064 0.003 0.   ]
 [0.783 0.207 0.    0.011]
 [0.818 0.052 0.104 0.026]
 [0.462 0.062 0.415 0.062]]
Validation acc: 0.6987487969201155
Validation class_accuracies: [0.9337837837837838, 0.20652173913043478, 0.1038961038961039, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.326435022087196
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 582s - loss: 0.3415 - accuracy: 0.6502 - 582s/epoch - 2s/step
Validation cm: [[560  54  85  41]
 [ 27  33  15  17]
 [ 22   1  42  12]
 [  6   4  79  41]]
Validation normalized_cm: [[0.757 0.073 0.115 0.055]
 [0.293 0.359 0.163 0.185]
 [0.286 0.013 0.545 0.156]
 [0.046 0.031 0.608 0.315]]
Validation acc: 0.6506256015399422
Validation class_accuracies: [0.7567567567567568, 0.358695652173913, 0.5454545454545454, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49407289244245767
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 599s - loss: 0.3064 - accuracy: 0.6500 - 599s/epoch - 2s/step
Validation cm: [[637  84  12   7]
 [ 35  44  10   3]
 [ 41   5  21  10]
 [ 18  15  67  30]]
Validation normalized_cm: [[0.861 0.114 0.016 0.009]
 [0.38  0.478 0.109 0.033]
 [0.532 0.065 0.273 0.13 ]
 [0.138 0.115 0.515 0.231]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.8608108108108108, 0.4782608695652174, 0.2727272727272727, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4606420459681329
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
The validation tracker metric at 0.49407289244245767 hasn't increased by 0 in 1 epochs
330/330 - 596s - loss: 0.2703 - accuracy: 0.6449 - 596s/epoch - 2s/step
Validation cm: [[704  24   7   5]
 [ 83   5   3   1]
 [ 61   3   7   6]
 [ 68   2  45  15]]
Validation normalized_cm: [[0.951 0.032 0.009 0.007]
 [0.902 0.054 0.033 0.011]
 [0.792 0.039 0.091 0.078]
 [0.523 0.015 0.346 0.115]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.9513513513513514, 0.05434782608695652, 0.09090909090909091, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.30299822093300355
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.49407289244245767 hasn't increased by 0 in 2 epochs
330/330 - 632s - loss: 0.2414 - accuracy: 0.6367 - 632s/epoch - 2s/step
Validation cm: [[618  93  10  19]
 [ 30  38   6  18]
 [ 45   5  17  10]
 [ 18  10  48  54]]
Validation normalized_cm: [[0.835 0.126 0.014 0.026]
 [0.326 0.413 0.065 0.196]
 [0.584 0.065 0.221 0.13 ]
 [0.138 0.077 0.369 0.415]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.8351351351351352, 0.41304347826086957, 0.22077922077922077, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4710856123899602
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.49407289244245767 hasn't increased by 0 in 3 epochs
330/330 - 639s - loss: 0.2040 - accuracy: 0.6571 - 639s/epoch - 2s/step
Validation cm: [[612  86  25  17]
 [ 35  43  10   4]
 [ 35   1  28  13]
 [ 23  14  67  26]]
Validation normalized_cm: [[0.827 0.116 0.034 0.023]
 [0.38  0.467 0.109 0.043]
 [0.455 0.013 0.364 0.169]
 [0.177 0.108 0.515 0.2  ]]
Validation acc: 0.6823869104908566
Validation class_accuracies: [0.827027027027027, 0.4673913043478261, 0.36363636363636365, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4645136737528042
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.49407289244245767 hasn't increased by 0 in 4 epochs
330/330 - 638s - loss: 0.1787 - accuracy: 0.6819 - 638s/epoch - 2s/step
Validation cm: [[543  65  89  43]
 [ 32  29  13  18]
 [ 17   3  34  23]
 [  6   9  43  72]]
Validation normalized_cm: [[0.734 0.088 0.12  0.058]
 [0.348 0.315 0.141 0.196]
 [0.221 0.039 0.442 0.299]
 [0.046 0.069 0.331 0.554]]
Validation acc: 0.6525505293551492
Validation class_accuracies: [0.7337837837837838, 0.31521739130434784, 0.44155844155844154, 0.5538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5111014426231817
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 637s - loss: 0.1477 - accuracy: 0.6751 - 637s/epoch - 2s/step
Validation cm: [[497  97 110  36]
 [ 20  40  15  17]
 [ 17   1  41  18]
 [  5   5  52  68]]
Validation normalized_cm: [[0.672 0.131 0.149 0.049]
 [0.217 0.435 0.163 0.185]
 [0.221 0.013 0.532 0.234]
 [0.038 0.038 0.4   0.523]]
Validation acc: 0.6217516843118384
Validation class_accuracies: [0.6716216216216216, 0.43478260869565216, 0.5324675324675324, 0.5230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5404871714654323
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 637s - loss: 0.1259 - accuracy: 0.6637 - 637s/epoch - 2s/step
Validation cm: [[578  60  73  29]
 [ 36  28  12  16]
 [ 19   4  40  14]
 [  8   8  70  44]]
Validation normalized_cm: [[0.781 0.081 0.099 0.039]
 [0.391 0.304 0.13  0.174]
 [0.247 0.052 0.519 0.182]
 [0.062 0.062 0.538 0.338]]
Validation acc: 0.6641000962463908
Validation class_accuracies: [0.7810810810810811, 0.30434782608695654, 0.5194805194805194, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4858427412775239
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5404871714654323 hasn't increased by 0 in 1 epochs
330/330 - 637s - loss: 0.0979 - accuracy: 0.6755 - 637s/epoch - 2s/step
Validation cm: [[716  14  10   0]
 [ 82   5   4   1]
 [ 56   1  18   2]
 [ 46   2  60  22]]
Validation normalized_cm: [[0.968 0.019 0.014 0.   ]
 [0.891 0.054 0.043 0.011]
 [0.727 0.013 0.234 0.026]
 [0.354 0.015 0.462 0.169]]
Validation acc: 0.7324350336862367
Validation class_accuracies: [0.9675675675675676, 0.05434782608695652, 0.23376623376623376, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3562280991628818
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.5404871714654323 hasn't increased by 0 in 2 epochs
330/330 - 637s - loss: 0.0917 - accuracy: 0.6730 - 637s/epoch - 2s/step
Validation cm: [[569 105  32  34]
 [ 28  34  12  18]
 [ 28   5  28  16]
 [ 14   7  55  54]]
Validation normalized_cm: [[0.769 0.142 0.043 0.046]
 [0.304 0.37  0.13  0.196]
 [0.364 0.065 0.364 0.208]
 [0.108 0.054 0.423 0.415]]
Validation acc: 0.6592877767083735
Validation class_accuracies: [0.768918918918919, 0.3695652173913043, 0.36363636363636365, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4793762788328006
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5404871714654323 hasn't increased by 0 in 3 epochs
330/330 - 638s - loss: 0.0736 - accuracy: 0.6626 - 638s/epoch - 2s/step
Validation cm: [[590  60  55  35]
 [ 49  15   6  22]
 [ 19   6  33  19]
 [ 15   4  45  66]]
Validation normalized_cm: [[0.797 0.081 0.074 0.047]
 [0.533 0.163 0.065 0.239]
 [0.247 0.078 0.429 0.247]
 [0.115 0.031 0.346 0.508]]
Validation acc: 0.6775745909528392
Validation class_accuracies: [0.7972972972972973, 0.16304347826086957, 0.42857142857142855, 0.5076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47415112795547576
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.5404871714654323 hasn't increased by 0 in 4 epochs
330/330 - 638s - loss: 0.0565 - accuracy: 0.6569 - 638s/epoch - 2s/step
Validation cm: [[603 105  22  10]
 [ 42  32   8  10]
 [ 31  12  18  16]
 [ 17  15  43  55]]
Validation normalized_cm: [[0.815 0.142 0.03  0.014]
 [0.457 0.348 0.087 0.109]
 [0.403 0.156 0.234 0.208]
 [0.131 0.115 0.331 0.423]]
Validation acc: 0.6814244465832531
Validation class_accuracies: [0.8148648648648649, 0.34782608695652173, 0.23376623376623376, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4548835271661359
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.5404871714654323 hasn't increased by 0 in 5 epochs
330/330 - 636s - loss: 0.0523 - accuracy: 0.6599 - 636s/epoch - 2s/step
Validation cm: [[629  81   6  24]
 [ 31  36   8  17]
 [ 46   7  12  12]
 [ 29  17  52  32]]
Validation normalized_cm: [[0.85  0.109 0.008 0.032]
 [0.337 0.391 0.087 0.185]
 [0.597 0.091 0.156 0.156]
 [0.223 0.131 0.4   0.246]]
Validation acc: 0.6823869104908566
Validation class_accuracies: [0.85, 0.391304347826087, 0.15584415584415584, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41082558745602227
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 638s - loss: 0.0524 - accuracy: 0.6470 - 638s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5404871714654323
Best cm: [[497  97 110  36]
 [ 20  40  15  17]
 [ 17   1  41  18]
 [  5   5  52  68]]
Best normalized_cm: [[0.672 0.131 0.149 0.049]
 [0.217 0.435 0.163 0.185]
 [0.221 0.013 0.532 0.234]
 [0.038 0.038 0.4   0.523]]
Best acc: 0.6217516843118384
Best class_accuracies: [0.6716216216216216, 0.43478260869565216, 0.5324675324675324, 0.5230769230769231]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 9
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Job id is 2.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_1 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_1 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 377s - loss: 0.4534 - accuracy: 0.6022 - 377s/epoch - 1s/step
Validation cm: [[735   0   2   3]
 [ 82   1   9   0]
 [ 68   0   7   2]
 [ 69   1  56   4]]
Validation normalized_cm: [[0.993 0.    0.003 0.004]
 [0.891 0.011 0.098 0.   ]
 [0.883 0.    0.091 0.026]
 [0.531 0.008 0.431 0.031]]
Validation acc: 0.7189605389797883
Validation class_accuracies: [0.9932432432432432, 0.010869565217391304, 0.09090909090909091, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.281447782534739
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 373s - loss: 0.3725 - accuracy: 0.6043 - 373s/epoch - 1s/step
Validation cm: [[694  42   4   0]
 [ 72   9  11   0]
 [ 70   0   6   1]
 [ 55   4  69   2]]
Validation normalized_cm: [[0.938 0.057 0.005 0.   ]
 [0.783 0.098 0.12  0.   ]
 [0.909 0.    0.078 0.013]
 [0.423 0.031 0.531 0.015]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.9378378378378378, 0.09782608695652174, 0.07792207792207792, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2822426545252632
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 375s - loss: 0.3248 - accuracy: 0.5950 - 375s/epoch - 1s/step
Validation cm: [[554  65  92  29]
 [ 24  28  14  26]
 [ 30   3  33  11]
 [ 13   4  67  46]]
Validation normalized_cm: [[0.749 0.088 0.124 0.039]
 [0.261 0.304 0.152 0.283]
 [0.39  0.039 0.429 0.143]
 [0.1   0.031 0.515 0.354]]
Validation acc: 0.6361886429258903
Validation class_accuracies: [0.7486486486486487, 0.30434782608695654, 0.42857142857142855, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45885351428829696
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 373s - loss: 0.2913 - accuracy: 0.6058 - 373s/epoch - 1s/step
Validation cm: [[556  80  77  27]
 [ 31  29  15  17]
 [ 28   6  22  21]
 [ 19   7  66  38]]
Validation normalized_cm: [[0.751 0.108 0.104 0.036]
 [0.337 0.315 0.163 0.185]
 [0.364 0.078 0.286 0.273]
 [0.146 0.054 0.508 0.292]]
Validation acc: 0.6207892204042348
Validation class_accuracies: [0.7513513513513513, 0.31521739130434784, 0.2857142857142857, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4111476801694193
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.45885351428829696 hasn't increased by 0 in 1 epochs
330/330 - 374s - loss: 0.2589 - accuracy: 0.6066 - 374s/epoch - 1s/step
Validation cm: [[644  74  18   4]
 [ 39  41  10   2]
 [ 45  11  12   9]
 [ 27  17  78   8]]
Validation normalized_cm: [[0.87  0.1   0.024 0.005]
 [0.424 0.446 0.109 0.022]
 [0.584 0.143 0.156 0.117]
 [0.208 0.131 0.6   0.062]]
Validation acc: 0.6785370548604427
Validation class_accuracies: [0.8702702702702703, 0.44565217391304346, 0.15584415584415584, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3833262653914828
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.45885351428829696 hasn't increased by 0 in 2 epochs
330/330 - 374s - loss: 0.2239 - accuracy: 0.6377 - 374s/epoch - 1s/step
Validation cm: [[547  72  82  39]
 [ 31  31  16  14]
 [ 27   8  23  19]
 [ 14   7  54  55]]
Validation normalized_cm: [[0.739 0.097 0.111 0.053]
 [0.337 0.337 0.174 0.152]
 [0.351 0.104 0.299 0.247]
 [0.108 0.054 0.415 0.423]]
Validation acc: 0.631376323387873
Validation class_accuracies: [0.7391891891891892, 0.33695652173913043, 0.2987012987012987, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4494809831766354
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.45885351428829696 hasn't increased by 0 in 3 epochs
330/330 - 375s - loss: 0.1793 - accuracy: 0.6276 - 375s/epoch - 1s/step
Validation cm: [[606  62  42  30]
 [ 38  23  13  18]
 [ 48   4  18   7]
 [ 24   5  70  31]]
Validation normalized_cm: [[0.819 0.084 0.057 0.041]
 [0.413 0.25  0.141 0.196]
 [0.623 0.052 0.234 0.091]
 [0.185 0.038 0.538 0.238]]
Validation acc: 0.6525505293551492
Validation class_accuracies: [0.8189189189189189, 0.25, 0.23376623376623376, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3852866727866728
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.45885351428829696 hasn't increased by 0 in 4 epochs
330/330 - 374s - loss: 0.1507 - accuracy: 0.6476 - 374s/epoch - 1s/step
Validation cm: [[632  82  24   2]
 [ 43  37  11   1]
 [ 49   4  16   8]
 [ 45  15  49  21]]
Validation normalized_cm: [[0.854 0.111 0.032 0.003]
 [0.467 0.402 0.12  0.011]
 [0.636 0.052 0.208 0.104]
 [0.346 0.115 0.377 0.162]]
Validation acc: 0.6794995187680462
Validation class_accuracies: [0.8540540540540541, 0.40217391304347827, 0.2077922077922078, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40638965910705044
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.45885351428829696 hasn't increased by 0 in 5 epochs
330/330 - 374s - loss: 0.1250 - accuracy: 0.6438 - 374s/epoch - 1s/step
Validation cm: [[610 102  28   0]
 [ 31  45  15   1]
 [ 47   2  20   8]
 [ 35  18  56  21]]
Validation normalized_cm: [[0.824 0.138 0.038 0.   ]
 [0.337 0.489 0.163 0.011]
 [0.61  0.026 0.26  0.104]
 [0.269 0.138 0.431 0.162]]
Validation acc: 0.6698748796920115
Validation class_accuracies: [0.8243243243243243, 0.4891304347826087, 0.2597402597402597, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4336833700964136
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 374s - loss: 0.1008 - accuracy: 0.6464 - 374s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.45885351428829696
Best cm: [[554  65  92  29]
 [ 24  28  14  26]
 [ 30   3  33  11]
 [ 13   4  67  46]]
Best normalized_cm: [[0.749 0.088 0.124 0.039]
 [0.261 0.304 0.152 0.283]
 [0.39  0.039 0.429 0.143]
 [0.1   0.031 0.515 0.354]]
Best acc: 0.6361886429258903
Best class_accuracies: [0.7486486486486487, 0.30434782608695654, 0.42857142857142855, 0.35384615384615387]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 4
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Job id is 3.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_2 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_2 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 298s - loss: 0.4678 - accuracy: 0.5506 - 298s/epoch - 904ms/step
Validation cm: [[721  15   4   0]
 [ 79   5   8   0]
 [ 72   1   4   0]
 [ 73   2  55   0]]
Validation normalized_cm: [[0.974 0.02  0.005 0.   ]
 [0.859 0.054 0.087 0.   ]
 [0.935 0.013 0.052 0.   ]
 [0.562 0.015 0.423 0.   ]]
Validation acc: 0.7025986525505293
Validation class_accuracies: [0.9743243243243244, 0.05434782608695652, 0.05194805194805195, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2701550505898332
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 296s - loss: 0.3897 - accuracy: 0.5675 - 296s/epoch - 896ms/step
Validation cm: [[613  56  25  46]
 [ 35  25  12  20]
 [ 51   1  14  11]
 [ 24   6  52  48]]
Validation normalized_cm: [[0.828 0.076 0.034 0.062]
 [0.38  0.272 0.13  0.217]
 [0.662 0.013 0.182 0.143]
 [0.185 0.046 0.4   0.369]]
Validation acc: 0.6737247353224254
Validation class_accuracies: [0.8283783783783784, 0.2717391304347826, 0.18181818181818182, 0.36923076923076925]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.412791614965528
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 295s - loss: 0.3465 - accuracy: 0.5904 - 295s/epoch - 893ms/step
Validation cm: [[617  68  29  26]
 [ 39  26  11  16]
 [ 52   6  10   9]
 [ 27  11  59  33]]
Validation normalized_cm: [[0.834 0.092 0.039 0.035]
 [0.424 0.283 0.12  0.174]
 [0.675 0.078 0.13  0.117]
 [0.208 0.085 0.454 0.254]]
Validation acc: 0.6602502406159769
Validation class_accuracies: [0.8337837837837838, 0.2826086956521739, 0.12987012987012986, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37502719078806035
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
The validation tracker metric at 0.412791614965528 hasn't increased by 0 in 1 epochs
330/330 - 294s - loss: 0.3123 - accuracy: 0.6062 - 294s/epoch - 891ms/step
Validation cm: [[639  69  18  14]
 [ 39  26  13  14]
 [ 51   7  18   1]
 [ 31  10  68  21]]
Validation normalized_cm: [[0.864 0.093 0.024 0.019]
 [0.424 0.283 0.141 0.152]
 [0.662 0.091 0.234 0.013]
 [0.238 0.077 0.523 0.162]]
Validation acc: 0.6775745909528392
Validation class_accuracies: [0.8635135135135135, 0.2826086956521739, 0.23376623376623376, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3853567261175957
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.412791614965528 hasn't increased by 0 in 2 epochs
330/330 - 295s - loss: 0.2713 - accuracy: 0.6200 - 295s/epoch - 894ms/step
Validation cm: [[626  80  20  14]
 [ 37  36  14   5]
 [ 47   6  19   5]
 [ 28  14  50  38]]
Validation normalized_cm: [[0.846 0.108 0.027 0.019]
 [0.402 0.391 0.152 0.054]
 [0.61  0.078 0.247 0.065]
 [0.215 0.108 0.385 0.292]]
Validation acc: 0.6920115495668913
Validation class_accuracies: [0.845945945945946, 0.391304347826087, 0.24675324675324675, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.444077808208243
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 294s - loss: 0.2477 - accuracy: 0.6377 - 294s/epoch - 890ms/step
Validation cm: [[600  42  58  40]
 [ 36  21  18  17]
 [ 33   5  27  12]
 [ 32   3  56  39]]
Validation normalized_cm: [[0.811 0.057 0.078 0.054]
 [0.391 0.228 0.196 0.185]
 [0.429 0.065 0.351 0.156]
 [0.246 0.023 0.431 0.3  ]]
Validation acc: 0.6612127045235804
Validation class_accuracies: [0.8108108108108109, 0.22826086956521738, 0.35064935064935066, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42243025775634474
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 1.]]
The validation tracker metric at 0.444077808208243 hasn't increased by 0 in 1 epochs
330/330 - 296s - loss: 0.2074 - accuracy: 0.6462 - 296s/epoch - 896ms/step
Validation cm: [[555 140  22  23]
 [ 24  47  12   9]
 [ 33  21  14   9]
 [ 26  24  35  45]]
Validation normalized_cm: [[0.75  0.189 0.03  0.031]
 [0.261 0.511 0.13  0.098]
 [0.429 0.273 0.182 0.117]
 [0.2   0.185 0.269 0.346]]
Validation acc: 0.6361886429258903
Validation class_accuracies: [0.75, 0.5108695652173914, 0.18181818181818182, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44721039829735487
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 280s - loss: 0.1736 - accuracy: 0.6464 - 280s/epoch - 849ms/step
Validation cm: [[657  18  55  10]
 [ 51  17  18   6]
 [ 48   2  24   3]
 [ 40   4  63  23]]
Validation normalized_cm: [[0.888 0.024 0.074 0.014]
 [0.554 0.185 0.196 0.065]
 [0.623 0.026 0.312 0.039]
 [0.308 0.031 0.485 0.177]]
Validation acc: 0.6939364773820982
Validation class_accuracies: [0.8878378378378379, 0.18478260869565216, 0.3116883116883117, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39030795878621966
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.44721039829735487 hasn't increased by 0 in 1 epochs
330/330 - 279s - loss: 0.1392 - accuracy: 0.6536 - 279s/epoch - 845ms/step
Validation cm: [[665  43  21  11]
 [ 51  23  13   5]
 [ 52   7  13   5]
 [ 42   6  61  21]]
Validation normalized_cm: [[0.899 0.058 0.028 0.015]
 [0.554 0.25  0.141 0.054]
 [0.675 0.091 0.169 0.065]
 [0.323 0.046 0.469 0.162]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.8986486486486487, 0.25, 0.16883116883116883, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3697545697545698
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.44721039829735487 hasn't increased by 0 in 2 epochs
330/330 - 289s - loss: 0.1196 - accuracy: 0.6544 - 289s/epoch - 875ms/step
Validation cm: [[509  96  96  39]
 [ 22  35  15  20]
 [ 28   4  34  11]
 [ 13  13  52  52]]
Validation normalized_cm: [[0.688 0.13  0.13  0.053]
 [0.239 0.38  0.163 0.217]
 [0.364 0.052 0.442 0.143]
 [0.1   0.1   0.4   0.4  ]]
Validation acc: 0.6063522617901829
Validation class_accuracies: [0.6878378378378378, 0.3804347826086957, 0.44155844155844154, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47745776550124375
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 290s - loss: 0.0934 - accuracy: 0.6639 - 290s/epoch - 878ms/step
Validation cm: [[624  57  45  14]
 [ 42  25  20   5]
 [ 45   5  22   5]
 [ 39   8  63  20]]
Validation normalized_cm: [[0.843 0.077 0.061 0.019]
 [0.457 0.272 0.217 0.054]
 [0.584 0.065 0.286 0.065]
 [0.3   0.062 0.485 0.154]]
Validation acc: 0.6650625601539942
Validation class_accuracies: [0.8432432432432433, 0.2717391304347826, 0.2857142857142857, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3886357033096163
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.47745776550124375 hasn't increased by 0 in 1 epochs
330/330 - 292s - loss: 0.0768 - accuracy: 0.6599 - 292s/epoch - 886ms/step
Validation cm: [[579 106  22  33]
 [ 31  36  12  13]
 [ 41   7  17  12]
 [ 26  13  50  41]]
Validation normalized_cm: [[0.782 0.143 0.03  0.045]
 [0.337 0.391 0.13  0.141]
 [0.532 0.091 0.221 0.156]
 [0.2   0.1   0.385 0.315]]
Validation acc: 0.6477382098171318
Validation class_accuracies: [0.7824324324324324, 0.391304347826087, 0.22077922077922077, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4274751541055889
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.47745776550124375 hasn't increased by 0 in 2 epochs
330/330 - 291s - loss: 0.0608 - accuracy: 0.6646 - 291s/epoch - 883ms/step
Validation cm: [[624  65  36  15]
 [ 41  25  16  10]
 [ 44   9  17   7]
 [ 51  13  53  13]]
Validation normalized_cm: [[0.843 0.088 0.049 0.02 ]
 [0.446 0.272 0.174 0.109]
 [0.571 0.117 0.221 0.091]
 [0.392 0.1   0.408 0.1  ]]
Validation acc: 0.6535129932627527
Validation class_accuracies: [0.8432432432432433, 0.2717391304347826, 0.22077922077922077, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35894039861431165
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.47745776550124375 hasn't increased by 0 in 3 epochs
330/330 - 290s - loss: 0.0626 - accuracy: 0.6567 - 290s/epoch - 879ms/step
Validation cm: [[655  44  31  10]
 [ 51  22  13   6]
 [ 50   5  19   3]
 [ 49  10  53  18]]
Validation normalized_cm: [[0.885 0.059 0.042 0.014]
 [0.554 0.239 0.141 0.065]
 [0.649 0.065 0.247 0.039]
 [0.377 0.077 0.408 0.138]]
Validation acc: 0.687199230028874
Validation class_accuracies: [0.8851351351351351, 0.2391304347826087, 0.24675324675324675, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3773700887831322
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.47745776550124375 hasn't increased by 0 in 4 epochs
330/330 - 293s - loss: 0.0564 - accuracy: 0.6645 - 293s/epoch - 889ms/step
Validation cm: [[554 108  51  27]
 [ 30  38  13  11]
 [ 38   6  22  11]
 [ 23  11  61  35]]
Validation normalized_cm: [[0.749 0.146 0.069 0.036]
 [0.326 0.413 0.141 0.12 ]
 [0.494 0.078 0.286 0.143]
 [0.177 0.085 0.469 0.269]]
Validation acc: 0.6246390760346487
Validation class_accuracies: [0.7486486486486487, 0.41304347826086957, 0.2857142857142857, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4291592954636433
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.47745776550124375 hasn't increased by 0 in 5 epochs
330/330 - 290s - loss: 0.0505 - accuracy: 0.6741 - 290s/epoch - 879ms/step
Validation cm: [[647  39  35  19]
 [ 46  19  19   8]
 [ 52   5  16   4]
 [ 36   6  59  29]]
Validation normalized_cm: [[0.874 0.053 0.047 0.026]
 [0.5   0.207 0.207 0.087]
 [0.675 0.065 0.208 0.052]
 [0.277 0.046 0.454 0.223]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.8743243243243243, 0.20652173913043478, 0.2077922077922078, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3779287985809725
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 291s - loss: 0.0447 - accuracy: 0.6715 - 291s/epoch - 883ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.47745776550124375
Best cm: [[509  96  96  39]
 [ 22  35  15  20]
 [ 28   4  34  11]
 [ 13  13  52  52]]
Best normalized_cm: [[0.688 0.13  0.13  0.053]
 [0.239 0.38  0.163 0.217]
 [0.364 0.052 0.442 0.143]
 [0.1   0.1   0.4   0.4  ]]
Best acc: 0.6063522617901829
Best class_accuracies: [0.6878378378378378, 0.3804347826086957, 0.44155844155844154, 0.4]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 11
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Job id is 4.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model_3"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_3 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_3 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 795s - loss: 0.4289 - accuracy: 0.6326 - 795s/epoch - 2s/step
Validation cm: [[739   0   1   0]
 [ 90   0   2   0]
 [ 71   0   6   0]
 [ 75   0  50   5]]
Validation normalized_cm: [[0.999 0.    0.001 0.   ]
 [0.978 0.    0.022 0.   ]
 [0.922 0.    0.078 0.   ]
 [0.577 0.    0.385 0.038]]
Validation acc: 0.7218479307025987
Validation class_accuracies: [0.9986486486486487, 0.0, 0.07792207792207792, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.27875806625806626
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 789s - loss: 0.3422 - accuracy: 0.6159 - 789s/epoch - 2s/step
Validation cm: [[657  61  21   1]
 [ 66  19   5   2]
 [ 44   0  32   1]
 [ 32   9  69  20]]
Validation normalized_cm: [[0.888 0.082 0.028 0.001]
 [0.717 0.207 0.054 0.022]
 [0.571 0.    0.416 0.013]
 [0.246 0.069 0.531 0.154]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8878378378378379, 0.20652173913043478, 0.4155844155844156, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4159475365997105
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 785s - loss: 0.2996 - accuracy: 0.6386 - 785s/epoch - 2s/step
Validation cm: [[615 112  10   3]
 [ 32  54   5   1]
 [ 52   6  15   4]
 [ 23  25  48  34]]
Validation normalized_cm: [[0.831 0.151 0.014 0.004]
 [0.348 0.587 0.054 0.011]
 [0.675 0.078 0.195 0.052]
 [0.177 0.192 0.369 0.262]]
Validation acc: 0.6910490856592878
Validation class_accuracies: [0.831081081081081, 0.5869565217391305, 0.19480519480519481, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46859531479096694
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 787s - loss: 0.2699 - accuracy: 0.6445 - 787s/epoch - 2s/step
Validation cm: [[684  22  31   3]
 [ 61  10  20   1]
 [ 54   0  20   3]
 [ 32   5  75  18]]
Validation normalized_cm: [[0.924 0.03  0.042 0.004]
 [0.663 0.109 0.217 0.011]
 [0.701 0.    0.26  0.039]
 [0.246 0.038 0.577 0.138]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.9243243243243243, 0.10869565217391304, 0.2597402597402597, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3578054436750089
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.46859531479096694 hasn't increased by 0 in 1 epochs
330/330 - 784s - loss: 0.2473 - accuracy: 0.6460 - 784s/epoch - 2s/step
Validation cm: [[601 108  20  11]
 [ 21  49  14   8]
 [ 50   8  11   8]
 [ 20  22  48  40]]
Validation normalized_cm: [[0.812 0.146 0.027 0.015]
 [0.228 0.533 0.152 0.087]
 [0.649 0.104 0.143 0.104]
 [0.154 0.169 0.369 0.308]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8121621621621622, 0.532608695652174, 0.14285714285714285, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44883007709094663
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.46859531479096694 hasn't increased by 0 in 2 epochs
330/330 - 785s - loss: 0.2115 - accuracy: 0.6599 - 785s/epoch - 2s/step
Validation cm: [[544 164  16  16]
 [ 13  58  10  11]
 [ 38  13  16  10]
 [ 14  25  52  39]]
Validation normalized_cm: [[0.735 0.222 0.022 0.022]
 [0.141 0.63  0.109 0.12 ]
 [0.494 0.169 0.208 0.13 ]
 [0.108 0.192 0.4   0.3  ]]
Validation acc: 0.6323387872954764
Validation class_accuracies: [0.7351351351351352, 0.6304347826086957, 0.2077922077922078, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4683405313840097
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.46859531479096694 hasn't increased by 0 in 3 epochs
330/330 - 786s - loss: 0.1847 - accuracy: 0.6601 - 786s/epoch - 2s/step
Validation cm: [[686   7  45   2]
 [ 85   2   4   1]
 [ 31   0  45   1]
 [ 46   1  54  29]]
Validation normalized_cm: [[0.927 0.009 0.061 0.003]
 [0.924 0.022 0.043 0.011]
 [0.403 0.    0.584 0.013]
 [0.354 0.008 0.415 0.223]]
Validation acc: 0.7333974975938402
Validation class_accuracies: [0.927027027027027, 0.021739130434782608, 0.5844155844155844, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4390646662385793
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.46859531479096694 hasn't increased by 0 in 4 epochs
330/330 - 757s - loss: 0.1604 - accuracy: 0.6715 - 757s/epoch - 2s/step
Validation cm: [[600  88  31  21]
 [ 26  39  22   5]
 [ 34   5  35   3]
 [ 19   6  68  37]]
Validation normalized_cm: [[0.811 0.119 0.042 0.028]
 [0.283 0.424 0.239 0.054]
 [0.442 0.065 0.455 0.039]
 [0.146 0.046 0.523 0.285]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.8108108108108109, 0.42391304347826086, 0.45454545454545453, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4934711733624777
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 751s - loss: 0.1310 - accuracy: 0.6893 - 751s/epoch - 2s/step
Validation cm: [[699  35   4   2]
 [ 75  15   1   1]
 [ 69   2   6   0]
 [ 80  14  19  17]]
Validation normalized_cm: [[0.945 0.047 0.005 0.003]
 [0.815 0.163 0.011 0.011]
 [0.896 0.026 0.078 0.   ]
 [0.615 0.108 0.146 0.131]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.9445945945945946, 0.16304347826086957, 0.07792207792207792, 0.13076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32908234538669323
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.4934711733624777 hasn't increased by 0 in 1 epochs
330/330 - 752s - loss: 0.1117 - accuracy: 0.6726 - 752s/epoch - 2s/step
Validation cm: [[603  65  48  24]
 [ 27  33  13  19]
 [ 32   4  30  11]
 [ 17  11  55  47]]
Validation normalized_cm: [[0.815 0.088 0.065 0.032]
 [0.293 0.359 0.141 0.207]
 [0.416 0.052 0.39  0.143]
 [0.131 0.085 0.423 0.362]]
Validation acc: 0.6862367661212705
Validation class_accuracies: [0.8148648648648649, 0.358695652173913, 0.38961038961038963, 0.36153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4811773420469073
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.4934711733624777 hasn't increased by 0 in 2 epochs
330/330 - 749s - loss: 0.0973 - accuracy: 0.6775 - 749s/epoch - 2s/step
Validation cm: [[618  85  23  14]
 [ 28  35  11  18]
 [ 30   8  31   8]
 [ 25  17  39  49]]
Validation normalized_cm: [[0.835 0.115 0.031 0.019]
 [0.304 0.38  0.12  0.196]
 [0.39  0.104 0.403 0.104]
 [0.192 0.131 0.3   0.377]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.8351351351351352, 0.3804347826086957, 0.4025974025974026, 0.3769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4987725993160776
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 750s - loss: 0.0771 - accuracy: 0.6629 - 750s/epoch - 2s/step
Validation cm: [[570  92  59  19]
 [ 20  42  16  14]
 [ 24   5  37  11]
 [ 15  14  57  44]]
Validation normalized_cm: [[0.77  0.124 0.08  0.026]
 [0.217 0.457 0.174 0.152]
 [0.312 0.065 0.481 0.143]
 [0.115 0.108 0.438 0.338]]
Validation acc: 0.6669874879692012
Validation class_accuracies: [0.7702702702702703, 0.45652173913043476, 0.4805194805194805, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.511443257095431
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 749s - loss: 0.0651 - accuracy: 0.6960 - 749s/epoch - 2s/step
Validation cm: [[680  40  16   4]
 [ 49  29  12   2]
 [ 42   5  28   2]
 [ 44  10  50  26]]
Validation normalized_cm: [[0.919 0.054 0.022 0.005]
 [0.533 0.315 0.13  0.022]
 [0.545 0.065 0.364 0.026]
 [0.338 0.077 0.385 0.2  ]]
Validation acc: 0.7343599615014437
Validation class_accuracies: [0.918918918918919, 0.31521739130434784, 0.36363636363636365, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44944316846490756
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.511443257095431 hasn't increased by 0 in 1 epochs
330/330 - 748s - loss: 0.0568 - accuracy: 0.6734 - 748s/epoch - 2s/step
Validation cm: [[702  11  24   3]
 [ 74   7  11   0]
 [ 43   0  33   1]
 [ 39   4  74  13]]
Validation normalized_cm: [[0.949 0.015 0.032 0.004]
 [0.804 0.076 0.12  0.   ]
 [0.558 0.    0.429 0.013]
 [0.3   0.031 0.569 0.1  ]]
Validation acc: 0.726660250240616
Validation class_accuracies: [0.9486486486486486, 0.07608695652173914, 0.42857142857142855, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3883267584354541
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.511443257095431 hasn't increased by 0 in 2 epochs
330/330 - 751s - loss: 0.0527 - accuracy: 0.6719 - 751s/epoch - 2s/step
Validation cm: [[592  96  37  15]
 [ 29  36  12  15]
 [ 23   7  33  14]
 [ 21  20  49  40]]
Validation normalized_cm: [[0.8   0.13  0.05  0.02 ]
 [0.315 0.391 0.13  0.163]
 [0.299 0.091 0.429 0.182]
 [0.162 0.154 0.377 0.308]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8, 0.391304347826087, 0.42857142857142855, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4818920210224558
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.511443257095431 hasn't increased by 0 in 3 epochs
330/330 - 749s - loss: 0.0463 - accuracy: 0.6612 - 749s/epoch - 2s/step
Validation cm: [[598 109  19  14]
 [ 23  47  10  12]
 [ 37   9  24   7]
 [ 29  20  37  44]]
Validation normalized_cm: [[0.808 0.147 0.026 0.019]
 [0.25  0.511 0.109 0.13 ]
 [0.481 0.117 0.312 0.091]
 [0.223 0.154 0.285 0.338]]
Validation acc: 0.6862367661212705
Validation class_accuracies: [0.8081081081081081, 0.5108695652173914, 0.3116883116883117, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4922818808688374
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The validation tracker metric at 0.511443257095431 hasn't increased by 0 in 4 epochs
330/330 - 748s - loss: 0.0474 - accuracy: 0.6578 - 748s/epoch - 2s/step
Validation cm: [[596 107  21  16]
 [ 26  46   9  11]
 [ 38  11  18  10]
 [ 27  23  33  47]]
Validation normalized_cm: [[0.805 0.145 0.028 0.022]
 [0.283 0.5   0.098 0.12 ]
 [0.494 0.143 0.234 0.13 ]
 [0.208 0.177 0.254 0.362]]
Validation acc: 0.6804619826756496
Validation class_accuracies: [0.8054054054054054, 0.5, 0.23376623376623376, 0.36153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4751775251775252
Validation one_indexed_epoch: 18
Epoch 18/20
[[0. 0.]]
The validation tracker metric at 0.511443257095431 hasn't increased by 0 in 5 epochs
330/330 - 747s - loss: 0.0391 - accuracy: 0.6722 - 747s/epoch - 2s/step
Validation cm: [[696  33   8   3]
 [ 65  21   5   1]
 [ 55   1  21   0]
 [ 42  10  51  27]]
Validation normalized_cm: [[0.941 0.045 0.011 0.004]
 [0.707 0.228 0.054 0.011]
 [0.714 0.013 0.273 0.   ]
 [0.323 0.077 0.392 0.208]]
Validation acc: 0.7362848893166506
Validation class_accuracies: [0.9405405405405406, 0.22826086956521738, 0.2727272727272727, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4123052476313346
Validation one_indexed_epoch: 19
Epoch 19/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 752s - loss: 0.0314 - accuracy: 0.6491 - 752s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.511443257095431
Best cm: [[570  92  59  19]
 [ 20  42  16  14]
 [ 24   5  37  11]
 [ 15  14  57  44]]
Best normalized_cm: [[0.77  0.124 0.08  0.026]
 [0.217 0.457 0.174 0.152]
 [0.312 0.065 0.481 0.143]
 [0.115 0.108 0.438 0.338]]
Best acc: 0.6669874879692012
Best class_accuracies: [0.7702702702702703, 0.45652173913043476, 0.4805194805194805, 0.3384615384615385]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 13
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Job id is 5.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model_4"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_4 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_4 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 491s - loss: 0.4482 - accuracy: 0.5770 - 491s/epoch - 1s/step
Validation cm: [[648  87   5   0]
 [ 50  32  10   0]
 [ 62  12   2   1]
 [ 46  23  55   6]]
Validation normalized_cm: [[0.876 0.118 0.007 0.   ]
 [0.543 0.348 0.109 0.   ]
 [0.805 0.156 0.026 0.013]
 [0.354 0.177 0.423 0.046]]
Validation acc: 0.6621751684311838
Validation class_accuracies: [0.8756756756756757, 0.34782608695652173, 0.025974025974025976, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32390740869001744
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 488s - loss: 0.3530 - accuracy: 0.5984 - 488s/epoch - 1s/step
Validation cm: [[639  77  17   7]
 [ 38  40  13   1]
 [ 45   4  24   4]
 [ 35  12  48  35]]
Validation normalized_cm: [[0.864 0.104 0.023 0.009]
 [0.413 0.435 0.141 0.011]
 [0.584 0.052 0.312 0.052]
 [0.269 0.092 0.369 0.269]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8635135135135135, 0.43478260869565216, 0.3116883116883117, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46980380078206163
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 487s - loss: 0.3064 - accuracy: 0.6288 - 487s/epoch - 1s/step
Validation cm: [[686  39  14   1]
 [ 68  12  10   2]
 [ 40   3  24  10]
 [ 41  13  36  40]]
Validation normalized_cm: [[0.927 0.053 0.019 0.001]
 [0.739 0.13  0.109 0.022]
 [0.519 0.039 0.312 0.13 ]
 [0.315 0.1   0.277 0.308]]
Validation acc: 0.7333974975938402
Validation class_accuracies: [0.927027027027027, 0.13043478260869565, 0.3116883116883117, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4192106072540855
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
The validation tracker metric at 0.46980380078206163 hasn't increased by 0 in 1 epochs
330/330 - 487s - loss: 0.2651 - accuracy: 0.6227 - 487s/epoch - 1s/step
Validation cm: [[606  79  38  17]
 [ 39  27  14  12]
 [ 33   2  29  13]
 [ 13   5  51  61]]
Validation normalized_cm: [[0.819 0.107 0.051 0.023]
 [0.424 0.293 0.152 0.13 ]
 [0.429 0.026 0.377 0.169]
 [0.1   0.038 0.392 0.469]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.8189189189189189, 0.29347826086956524, 0.37662337662337664, 0.46923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4895628314106575
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 487s - loss: 0.2303 - accuracy: 0.6417 - 487s/epoch - 1s/step
Validation cm: [[560 167   8   5]
 [ 20  59   6   7]
 [ 49  11  12   5]
 [ 12  38  17  63]]
Validation normalized_cm: [[0.757 0.226 0.011 0.007]
 [0.217 0.641 0.065 0.076]
 [0.636 0.143 0.156 0.065]
 [0.092 0.292 0.131 0.485]]
Validation acc: 0.6679499518768046
Validation class_accuracies: [0.7567567567567568, 0.6413043478260869, 0.15584415584415584, 0.4846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.509630161260596
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 487s - loss: 0.1919 - accuracy: 0.6297 - 487s/epoch - 1s/step
Validation cm: [[634 104   2   0]
 [ 37  42  11   2]
 [ 60  12   3   2]
 [ 38  23  33  36]]
Validation normalized_cm: [[0.857 0.141 0.003 0.   ]
 [0.402 0.457 0.12  0.022]
 [0.779 0.156 0.039 0.026]
 [0.292 0.177 0.254 0.277]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.8567567567567568, 0.45652173913043476, 0.03896103896103896, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40729065294282685
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.509630161260596 hasn't increased by 0 in 1 epochs
330/330 - 486s - loss: 0.1529 - accuracy: 0.6417 - 486s/epoch - 1s/step
Validation cm: [[598 105  21  16]
 [ 39  28  13  12]
 [ 37   7  21  12]
 [ 32  20  24  54]]
Validation normalized_cm: [[0.808 0.142 0.028 0.022]
 [0.424 0.304 0.141 0.13 ]
 [0.481 0.091 0.273 0.156]
 [0.246 0.154 0.185 0.415]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8081081081081081, 0.30434782608695654, 0.2727272727272727, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4501419555767382
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.509630161260596 hasn't increased by 0 in 2 epochs
330/330 - 487s - loss: 0.1199 - accuracy: 0.6221 - 487s/epoch - 1s/step
Validation cm: [[680  44  10   6]
 [ 60  16  13   3]
 [ 48   4  22   3]
 [ 46   8  54  22]]
Validation normalized_cm: [[0.919 0.059 0.014 0.008]
 [0.652 0.174 0.141 0.033]
 [0.623 0.052 0.286 0.039]
 [0.354 0.062 0.415 0.169]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.918918918918919, 0.17391304347826086, 0.2857142857142857, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38694425433555873
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.509630161260596 hasn't increased by 0 in 3 epochs
330/330 - 487s - loss: 0.0982 - accuracy: 0.6440 - 487s/epoch - 1s/step
Validation cm: [[630  95   6   9]
 [ 41  35  11   5]
 [ 52   9  16   0]
 [ 45   8  64  13]]
Validation normalized_cm: [[0.851 0.128 0.008 0.012]
 [0.446 0.38  0.12  0.054]
 [0.675 0.117 0.208 0.   ]
 [0.346 0.062 0.492 0.1  ]]
Validation acc: 0.6679499518768046
Validation class_accuracies: [0.8513513513513513, 0.3804347826086957, 0.2077922077922078, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38489458543806376
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.509630161260596 hasn't increased by 0 in 4 epochs
330/330 - 487s - loss: 0.0782 - accuracy: 0.6292 - 487s/epoch - 1s/step
Validation cm: [[664  48  16  12]
 [ 48  19  18   7]
 [ 42   6  25   4]
 [ 35   6  58  31]]
Validation normalized_cm: [[0.897 0.065 0.022 0.016]
 [0.522 0.207 0.196 0.076]
 [0.545 0.078 0.325 0.052]
 [0.269 0.046 0.446 0.238]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.8972972972972973, 0.20652173913043478, 0.3246753246753247, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4167389748911488
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.509630161260596 hasn't increased by 0 in 5 epochs
330/330 - 487s - loss: 0.0645 - accuracy: 0.6385 - 487s/epoch - 1s/step
Validation cm: [[570 106  51  13]
 [ 29  36  15  12]
 [ 30   3  38   6]
 [ 17  15  65  33]]
Validation normalized_cm: [[0.77  0.143 0.069 0.018]
 [0.315 0.391 0.163 0.13 ]
 [0.39  0.039 0.494 0.078]
 [0.131 0.115 0.5   0.254]]
Validation acc: 0.6515880654475458
Validation class_accuracies: [0.7702702702702703, 0.391304347826087, 0.4935064935064935, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47723181636225115
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 487s - loss: 0.0573 - accuracy: 0.6303 - 487s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.509630161260596
Best cm: [[560 167   8   5]
 [ 20  59   6   7]
 [ 49  11  12   5]
 [ 12  38  17  63]]
Best normalized_cm: [[0.757 0.226 0.011 0.007]
 [0.217 0.641 0.065 0.076]
 [0.636 0.143 0.156 0.065]
 [0.092 0.292 0.131 0.485]]
Best acc: 0.6679499518768046
Best class_accuracies: [0.7567567567567568, 0.6413043478260869, 0.15584415584415584, 0.4846153846153846]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 6
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Job id is 6.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model_5"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_5 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_5 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 411s - loss: 0.4575 - accuracy: 0.5823 - 411s/epoch - 1s/step
Validation cm: [[717  19   4   0]
 [ 64  17  11   0]
 [ 62   2  13   0]
 [ 73   5  49   3]]
Validation normalized_cm: [[0.969 0.026 0.005 0.   ]
 [0.696 0.185 0.12  0.   ]
 [0.805 0.026 0.169 0.   ]
 [0.562 0.038 0.377 0.023]]
Validation acc: 0.7218479307025987
Validation class_accuracies: [0.9689189189189189, 0.18478260869565216, 0.16883116883116883, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3364024048806657
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 407s - loss: 0.3784 - accuracy: 0.5940 - 407s/epoch - 1s/step
Validation cm: [[725   3  12   0]
 [ 77   1  14   0]
 [ 63   0  14   0]
 [ 59   0  46  25]]
Validation normalized_cm: [[0.98  0.004 0.016 0.   ]
 [0.837 0.011 0.152 0.   ]
 [0.818 0.    0.182 0.   ]
 [0.454 0.    0.354 0.192]]
Validation acc: 0.7362848893166506
Validation class_accuracies: [0.9797297297297297, 0.010869565217391304, 0.18181818181818182, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3411812922682488
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 407s - loss: 0.3383 - accuracy: 0.6119 - 407s/epoch - 1s/step
Validation cm: [[589  54  74  23]
 [ 43  25  14  10]
 [ 35   3  29  10]
 [ 18   2  51  59]]
Validation normalized_cm: [[0.796 0.073 0.1   0.031]
 [0.467 0.272 0.152 0.109]
 [0.455 0.039 0.377 0.13 ]
 [0.138 0.015 0.392 0.454]]
Validation acc: 0.6756496631376323
Validation class_accuracies: [0.7959459459459459, 0.2717391304347826, 0.37662337662337664, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4745386517125647
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 408s - loss: 0.2991 - accuracy: 0.6297 - 408s/epoch - 1s/step
Validation cm: [[628  68  30  14]
 [ 39  34  13   6]
 [ 46   8  22   1]
 [ 24  11  71  24]]
Validation normalized_cm: [[0.849 0.092 0.041 0.019]
 [0.424 0.37  0.141 0.065]
 [0.597 0.104 0.286 0.013]
 [0.185 0.085 0.546 0.185]]
Validation acc: 0.6814244465832531
Validation class_accuracies: [0.8486486486486486, 0.3695652173913043, 0.2857142857142857, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4221358840924058
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.4745386517125647 hasn't increased by 0 in 1 epochs
330/330 - 408s - loss: 0.2691 - accuracy: 0.6290 - 408s/epoch - 1s/step
Validation cm: [[668  53  16   3]
 [ 55  20  12   5]
 [ 57   2  15   3]
 [ 35   8  62  25]]
Validation normalized_cm: [[0.903 0.072 0.022 0.004]
 [0.598 0.217 0.13  0.054]
 [0.74  0.026 0.195 0.039]
 [0.269 0.062 0.477 0.192]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.9027027027027027, 0.21739130434782608, 0.19480519480519481, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37680172354085395
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.4745386517125647 hasn't increased by 0 in 2 epochs
330/330 - 408s - loss: 0.2302 - accuracy: 0.6493 - 408s/epoch - 1s/step
Validation cm: [[541 125  52  22]
 [ 22  49  11  10]
 [ 31   6  29  11]
 [ 15  14  44  57]]
Validation normalized_cm: [[0.731 0.169 0.07  0.03 ]
 [0.239 0.533 0.12  0.109]
 [0.403 0.078 0.377 0.143]
 [0.115 0.108 0.338 0.438]]
Validation acc: 0.6506256015399422
Validation class_accuracies: [0.731081081081081, 0.532608695652174, 0.37662337662337664, 0.43846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5196936729545425
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 408s - loss: 0.1908 - accuracy: 0.6514 - 408s/epoch - 1s/step
Validation cm: [[672  38  18  12]
 [ 51  23  14   4]
 [ 56   2  17   2]
 [ 36   7  62  25]]
Validation normalized_cm: [[0.908 0.051 0.024 0.016]
 [0.554 0.25  0.152 0.043]
 [0.727 0.026 0.221 0.026]
 [0.277 0.054 0.477 0.192]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.9081081081081082, 0.25, 0.22077922077922077, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3927987552987553
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5196936729545425 hasn't increased by 0 in 1 epochs
330/330 - 408s - loss: 0.1658 - accuracy: 0.6485 - 408s/epoch - 1s/step
Validation cm: [[561 135  25  19]
 [ 30  45  11   6]
 [ 42  12  14   9]
 [ 25  16  41  48]]
Validation normalized_cm: [[0.758 0.182 0.034 0.026]
 [0.326 0.489 0.12  0.065]
 [0.545 0.156 0.182 0.117]
 [0.192 0.123 0.315 0.369]]
Validation acc: 0.6429258902791145
Validation class_accuracies: [0.7581081081081081, 0.4891304347826087, 0.18181818181818182, 0.36923076923076925]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.449571873484917
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5196936729545425 hasn't increased by 0 in 2 epochs
330/330 - 408s - loss: 0.1286 - accuracy: 0.6521 - 408s/epoch - 1s/step
Validation cm: [[542  28 120  50]
 [ 34  14  24  20]
 [ 29   2  34  12]
 [ 15   3  57  55]]
Validation normalized_cm: [[0.732 0.038 0.162 0.068]
 [0.37  0.152 0.261 0.217]
 [0.377 0.026 0.442 0.156]
 [0.115 0.023 0.438 0.423]]
Validation acc: 0.6207892204042348
Validation class_accuracies: [0.7324324324324324, 0.15217391304347827, 0.44155844155844154, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43731042752781885
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5196936729545425 hasn't increased by 0 in 3 epochs
330/330 - 408s - loss: 0.1024 - accuracy: 0.6629 - 408s/epoch - 1s/step
Validation cm: [[444 106 132  58]
 [ 21  38  14  19]
 [ 20   5  33  19]
 [ 13  11  37  69]]
Validation normalized_cm: [[0.6   0.143 0.178 0.078]
 [0.228 0.413 0.152 0.207]
 [0.26  0.065 0.429 0.247]
 [0.1   0.085 0.285 0.531]]
Validation acc: 0.5620789220404235
Validation class_accuracies: [0.6, 0.41304347826086957, 0.42857142857142855, 0.5307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4930960344003822
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 1.]]
The validation tracker metric at 0.5196936729545425 hasn't increased by 0 in 4 epochs
330/330 - 407s - loss: 0.0888 - accuracy: 0.6677 - 407s/epoch - 1s/step
Validation cm: [[541  64  81  54]
 [ 32  22  18  20]
 [ 30   4  26  17]
 [ 15   5  54  56]]
Validation normalized_cm: [[0.731 0.086 0.109 0.073]
 [0.348 0.239 0.196 0.217]
 [0.39  0.052 0.338 0.221]
 [0.115 0.038 0.415 0.431]]
Validation acc: 0.6207892204042348
Validation class_accuracies: [0.731081081081081, 0.2391304347826087, 0.33766233766233766, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43466077107381457
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5196936729545425 hasn't increased by 0 in 5 epochs
330/330 - 407s - loss: 0.0710 - accuracy: 0.6648 - 407s/epoch - 1s/step
Validation cm: [[628  80  23   9]
 [ 44  32  14   2]
 [ 52   3  16   6]
 [ 39  11  49  31]]
Validation normalized_cm: [[0.849 0.108 0.031 0.012]
 [0.478 0.348 0.152 0.022]
 [0.675 0.039 0.208 0.078]
 [0.3   0.085 0.377 0.238]]
Validation acc: 0.6804619826756496
Validation class_accuracies: [0.8486486486486486, 0.34782608695652173, 0.2077922077922078, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4106821204647292
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 408s - loss: 0.0714 - accuracy: 0.6386 - 408s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5196936729545425
Best cm: [[541 125  52  22]
 [ 22  49  11  10]
 [ 31   6  29  11]
 [ 15  14  44  57]]
Best normalized_cm: [[0.731 0.169 0.07  0.03 ]
 [0.239 0.533 0.12  0.109]
 [0.403 0.078 0.377 0.143]
 [0.115 0.108 0.338 0.438]]
Best acc: 0.6506256015399422
Best class_accuracies: [0.731081081081081, 0.532608695652174, 0.37662337662337664, 0.43846153846153846]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 7
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
