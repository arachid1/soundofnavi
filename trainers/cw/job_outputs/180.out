Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train180
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
training parameters
[('cache_root', '../cache/'), ('data_root', '../data/'), ('jordan_root', '../data/jwyy9np4gv-3/'), ('icbhi_root', '../data/raw_audios/icbhi_preprocessed_v2_cleaned_8000/'), ('bd_root', '../data/PCV_SEGMENTED_Processed_Files/'), ('excel_path', '../data/Bangladesh_PCV_onlyStudyPatients.xlsx'), ('perch_root', '../data/raw_audios/perch_8000_10seconds'), ('ant_root', '../data/raw_audios/Antwerp_Clinical_Complete'), ('description', ' effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,'), ('job_id', 0), ('mode', 'cw'), ('n_classes', 2), ('shape', (80, 500, 3)), ('n_epochs', 110), ('lr', 0.001), ('batch_size', 16), ('ll2_reg', 0), ('weight_decay', 0.01), ('label_smoothing', 0), ('epsilon', 1e-07), ('es_patience', 25), ('min_delta', 0), ('train_test_ratio', 0.8), ('kfold', False), ('clause', 0), ('epoch_start', 0), ('testing', 0), ('adaptive_lr', True), ('cuberooting', 1), ('normalizing', 1), ('class_weights', True), ('early_stopping', True), ('initial_channels', 1), ('factor', 0.5), ('lr_patience', 12), ('min_lr', 1e-05), ('sr', 4000), ('audio_length', 5), ('step_size', 2.5), ('n_fft', 1024), ('hop_length', 254), ('n_mels', 128), ('overlap_threshold', 0.3), ('trainable_fb', False), ('to_decibel', True), ('train_nn', False), ('train_mel', False), ('file_dir', '../cache/cw/train180'), ('n_sequences', 9), ('activate_spectral_loss', False), ('normalize', False), ('stacking', False), ('oversample', False), ('one_hot_encoding', False), ('activation', 'sigmoid'), ('n_filters', 80)]
Job id is 1.
Job dir: ../cache/cw/train180/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
turning the kfold from 90/10 to 80/20
100
12
to
90
22
-----------------------
--- Final training dataset went from 0 to 3969 elements, with 1889 none's, 991 crakles, 597 wheezes and 492 both ---
--- Final Validation dataset contains 2096 elements, with 989 none, 843 crackles, 120 wheezes and 144 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5252779248279513, 1: 1.0012613521695257, 2: 1.6620603015075377, 3: 2.0167682926829267}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 reshape (Reshape)           (None, 16, 6144)          0         
                                                                 
 bidirectional (Bidirectiona  (None, 16, 256)          6423552   
 l)                                                              
                                                                 
 bidirectional_1 (Bidirectio  (None, 16, 256)          394240    
 nal)                                                            
                                                                 
 dense (Dense)               (None, 16, 256)           65792     
                                                                 
 dropout (Dropout)           (None, 16, 256)           0         
                                                                 
 flatten (Flatten)           (None, 4096)              0         
                                                                 
 dense_1 (Dense)             (None, 2)                 8194      
                                                                 
=================================================================
Total params: 30,479,490
Trainable params: 30,426,370
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_174_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   30479490         
                                                                                                              
==============================================================================================================
Total params: 30,479,652
Trainable params: 11,357,604
Non-trainable params: 19,122,048
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[260 462  76 191]
 [ 62 627  20 134]
 [  6  53  14  47]
 [  9 109   5  21]]
Validation val_loss: 0.6280456375160063
Validation normalized_cm: [[0.263 0.467 0.077 0.193]
 [0.074 0.744 0.024 0.159]
 [0.05  0.442 0.117 0.392]
 [0.062 0.757 0.035 0.146]]
Validation acc: 0.4398854961832061
Validation class_accuracies: [0.26289180990899896, 0.7437722419928826, 0.11666666666666667, 0.14583333333333334]
Validation sensitivity: 0.5980126467931346
Validation specificity: 0.26289180990899896
Validation icbhi_score: 0.4304522283510668
Validation roc_auc: None
Validation avg_accuracy: 0.3172910129754704
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
249/249 - 168s - loss: 0.6591 - accuracy: 0.5669 - 168s/epoch - 676ms/step
Epoch 2/110
Validation cm: [[259 435  82 213]
 [ 65 585  23 170]
 [  7  32  28  53]
 [  9  89  11  35]]
Validation val_loss: 0.6595560512612112
Validation normalized_cm: [[0.262 0.44  0.083 0.215]
 [0.077 0.694 0.027 0.202]
 [0.058 0.267 0.233 0.442]
 [0.062 0.618 0.076 0.243]]
Validation acc: 0.4327290076335878
Validation class_accuracies: [0.26188068756319516, 0.693950177935943, 0.23333333333333334, 0.24305555555555555]
Validation sensitivity: 0.5853658536585366
Validation specificity: 0.26188068756319516
Validation icbhi_score: 0.42362327061086585
Validation roc_auc: None
Validation avg_accuracy: 0.35805493859700677
Validation one_indexed_epoch: 2
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 157s - loss: 0.5720 - accuracy: 0.6458 - 157s/epoch - 631ms/step
Epoch 3/110
Validation cm: [[238 311 152 288]
 [ 73 430  55 285]
 [ 15  18  37  50]
 [  6  57  15  66]]
Validation val_loss: 0.7558476489023057
Validation normalized_cm: [[0.241 0.314 0.154 0.291]
 [0.087 0.51  0.065 0.338]
 [0.125 0.15  0.308 0.417]
 [0.042 0.396 0.104 0.458]]
Validation acc: 0.3678435114503817
Validation class_accuracies: [0.24064711830131447, 0.5100830367734283, 0.30833333333333335, 0.4583333333333333]
Validation sensitivity: 0.48148148148148145
Validation specificity: 0.24064711830131447
Validation icbhi_score: 0.361064299891398
Validation roc_auc: None
Validation avg_accuracy: 0.37934920543535233
Validation one_indexed_epoch: 3
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 166s - loss: 0.4985 - accuracy: 0.7095 - 166s/epoch - 666ms/step
Epoch 4/110
Validation cm: [[194 345 168 282]
 [ 85 446  85 227]
 [ 10  16  33  61]
 [ 14  35  49  46]]
Validation val_loss: 0.8587003769868459
Validation normalized_cm: [[0.196 0.349 0.17  0.285]
 [0.101 0.529 0.101 0.269]
 [0.083 0.133 0.275 0.508]
 [0.097 0.243 0.34  0.319]]
Validation acc: 0.34303435114503816
Validation class_accuracies: [0.1961577350859454, 0.5290628706998813, 0.275, 0.3194444444444444]
Validation sensitivity: 0.4742547425474255
Validation specificity: 0.1961577350859454
Validation icbhi_score: 0.33520623881668543
Validation roc_auc: None
Validation avg_accuracy: 0.3299162625575678
Validation one_indexed_epoch: 4
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 160s - loss: 0.4428 - accuracy: 0.7186 - 160s/epoch - 644ms/step
Epoch 5/110
Validation cm: [[354 443  82 110]
 [193 498  44 108]
 [ 30  36  29  25]
 [ 38  69  24  13]]
Validation val_loss: 0.6910604639440946
Validation normalized_cm: [[0.358 0.448 0.083 0.111]
 [0.229 0.591 0.052 0.128]
 [0.25  0.3   0.242 0.208]
 [0.264 0.479 0.167 0.09 ]]
Validation acc: 0.4265267175572519
Validation class_accuracies: [0.3579373104145602, 0.5907473309608541, 0.24166666666666667, 0.09027777777777778]
Validation sensitivity: 0.4878048780487805
Validation specificity: 0.3579373104145602
Validation icbhi_score: 0.42287109423167035
Validation roc_auc: None
Validation avg_accuracy: 0.32015727145496464
Validation one_indexed_epoch: 5
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 159s - loss: 0.3862 - accuracy: 0.7390 - 159s/epoch - 638ms/step
Epoch 6/110
Validation cm: [[194 287 171 337]
 [116 303 103 321]
 [ 13  10  48  49]
 [ 11  38  44  51]]
Validation val_loss: 1.095230171963473
Validation normalized_cm: [[0.196 0.29  0.173 0.341]
 [0.138 0.359 0.122 0.381]
 [0.108 0.083 0.4   0.408]
 [0.076 0.264 0.306 0.354]]
Validation acc: 0.28435114503816794
Validation class_accuracies: [0.1961577350859454, 0.3594306049822064, 0.4, 0.3541666666666667]
Validation sensitivity: 0.36314363143631434
Validation specificity: 0.1961577350859454
Validation icbhi_score: 0.27965068326112985
Validation roc_auc: None
Validation avg_accuracy: 0.3274387516837046
Validation one_indexed_epoch: 6
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 159s - loss: 0.3220 - accuracy: 0.7591 - 159s/epoch - 638ms/step
Epoch 7/110
Validation cm: [[249 627  17  96]
 [156 638  12  37]
 [ 22  60  12  26]
 [ 31 104   4   5]]
Validation val_loss: 0.7993866231546645
Validation normalized_cm: [[0.252 0.634 0.017 0.097]
 [0.185 0.757 0.014 0.044]
 [0.183 0.5   0.1   0.217]
 [0.215 0.722 0.028 0.035]]
Validation acc: 0.4312977099236641
Validation class_accuracies: [0.2517694641051567, 0.7568208778173191, 0.1, 0.034722222222222224]
Validation sensitivity: 0.5916892502258356
Validation specificity: 0.2517694641051567
Validation icbhi_score: 0.4217293571654962
Validation roc_auc: None
Validation avg_accuracy: 0.28582814103617454
Validation one_indexed_epoch: 7
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 163s - loss: 0.2955 - accuracy: 0.7498 - 163s/epoch - 655ms/step
Epoch 8/110
Validation cm: [[190 650  21 128]
 [ 95 692   9  47]
 [ 18  59  12  31]
 [ 17 101   5  21]]
Validation val_loss: 0.8454615381970213
Validation normalized_cm: [[0.192 0.657 0.021 0.129]
 [0.113 0.821 0.011 0.056]
 [0.15  0.492 0.1   0.258]
 [0.118 0.701 0.035 0.146]]
Validation acc: 0.43654580152671757
Validation class_accuracies: [0.19211324570273003, 0.8208778173190985, 0.1, 0.14583333333333334]
Validation sensitivity: 0.6549232158988256
Validation specificity: 0.19211324570273003
Validation icbhi_score: 0.42351823080077783
Validation roc_auc: None
Validation avg_accuracy: 0.3147060990887905
Validation one_indexed_epoch: 8
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 162s - loss: 0.2454 - accuracy: 0.7770 - 162s/epoch - 650ms/step
Epoch 9/110
Validation cm: [[387 179 206 217]
 [265 240 137 201]
 [ 24   8  48  40]
 [ 29  19  52  44]]
Validation val_loss: 1.1495849331660917
Validation normalized_cm: [[0.391 0.181 0.208 0.219]
 [0.314 0.285 0.163 0.238]
 [0.2   0.067 0.4   0.333]
 [0.201 0.132 0.361 0.306]]
Validation acc: 0.34303435114503816
Validation class_accuracies: [0.391304347826087, 0.2846975088967972, 0.4, 0.3055555555555556]
Validation sensitivity: 0.2999096657633243
Validation specificity: 0.391304347826087
Validation icbhi_score: 0.34560700679470563
Validation roc_auc: None
Validation avg_accuracy: 0.34538935306960994
Validation one_indexed_epoch: 9
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 8 epochs
There is no such attribute
249/249 - 161s - loss: 0.1625 - accuracy: 0.7748 - 161s/epoch - 648ms/step
Epoch 10/110
Validation cm: [[527 174 230  58]
 [372 255 169  47]
 [ 35   8  67  10]
 [ 60  37  44   3]]
Validation val_loss: 1.2259069921576906
Validation normalized_cm: [[0.533 0.176 0.233 0.059]
 [0.441 0.302 0.2   0.056]
 [0.292 0.067 0.558 0.083]
 [0.417 0.257 0.306 0.021]]
Validation acc: 0.4064885496183206
Validation class_accuracies: [0.5328614762386249, 0.302491103202847, 0.5583333333333333, 0.020833333333333332]
Validation sensitivity: 0.2935862691960253
Validation specificity: 0.5328614762386249
Validation icbhi_score: 0.4132238727173251
Validation roc_auc: None
Validation avg_accuracy: 0.3536298115270346
Validation one_indexed_epoch: 10
The validation tracker metric at 0.4304522283510668 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 159s - loss: 0.1413 - accuracy: 0.7851 - 159s/epoch - 639ms/step
Epoch 11/110
Validation cm: [[646 187  68  88]
 [518 241  44  40]
 [ 51  14  23  32]
 [ 80  23  32   9]]
Validation val_loss: 1.0220989265061697
Validation normalized_cm: [[0.653 0.189 0.069 0.089]
 [0.614 0.286 0.052 0.047]
 [0.425 0.117 0.192 0.267]
 [0.556 0.16  0.222 0.062]]
Validation acc: 0.43845419847328243
Validation class_accuracies: [0.6531850353892821, 0.2858837485172005, 0.19166666666666668, 0.0625]
Validation sensitivity: 0.24661246612466126
Validation specificity: 0.6531850353892821
Validation icbhi_score: 0.44989875075697167
Validation roc_auc: None
Validation avg_accuracy: 0.2983088626432873
Validation one_indexed_epoch: 11
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 169s - loss: 0.1418 - accuracy: 0.7811 - 169s/epoch - 677ms/step
Epoch 12/110
Validation cm: [[478 312  96 103]
 [293 354 119  77]
 [ 37  15  40  28]
 [ 38  42  45  19]]
Validation val_loss: 1.1213531785570081
Validation normalized_cm: [[0.483 0.315 0.097 0.104]
 [0.348 0.42  0.141 0.091]
 [0.308 0.125 0.333 0.233]
 [0.264 0.292 0.312 0.132]]
Validation acc: 0.42509541984732824
Validation class_accuracies: [0.4833164812942366, 0.4199288256227758, 0.3333333333333333, 0.13194444444444445]
Validation sensitivity: 0.37308039747064137
Validation specificity: 0.4833164812942366
Validation icbhi_score: 0.42819843938243896
Validation roc_auc: None
Validation avg_accuracy: 0.3421307711736975
Validation one_indexed_epoch: 12
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 163s - loss: 0.1139 - accuracy: 0.7974 - 163s/epoch - 653ms/step
Epoch 13/110
Validation cm: [[576 216 107  90]
 [454 262  57  70]
 [ 52  12  27  29]
 [ 55  39  32  18]]
Validation val_loss: 1.0667810252508174
Validation normalized_cm: [[0.582 0.218 0.108 0.091]
 [0.539 0.311 0.068 0.083]
 [0.433 0.1   0.225 0.242]
 [0.382 0.271 0.222 0.125]]
Validation acc: 0.42127862595419846
Validation class_accuracies: [0.5824064711830131, 0.3107947805456702, 0.225, 0.125]
Validation sensitivity: 0.27732610659439927
Validation specificity: 0.5824064711830131
Validation icbhi_score: 0.4298662888887062
Validation roc_auc: None
Validation avg_accuracy: 0.31080031293217086
Validation one_indexed_epoch: 13
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 161s - loss: 0.1483 - accuracy: 0.7969 - 161s/epoch - 648ms/step
Epoch 14/110
Validation cm: [[544 285  74  86]
 [436 314  39  54]
 [ 48  15  37  20]
 [ 48  48  32  16]]
Validation val_loss: 1.121070179964403
Validation normalized_cm: [[0.55  0.288 0.075 0.087]
 [0.517 0.372 0.046 0.064]
 [0.4   0.125 0.308 0.167]
 [0.333 0.333 0.222 0.111]]
Validation acc: 0.43463740458015265
Validation class_accuracies: [0.5500505561172901, 0.37247924080664296, 0.30833333333333335, 0.1111111111111111]
Validation sensitivity: 0.33152664859981934
Validation specificity: 0.5500505561172901
Validation icbhi_score: 0.44078860235855477
Validation roc_auc: None
Validation avg_accuracy: 0.33549356034209443
Validation one_indexed_epoch: 14
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 160s - loss: 0.0732 - accuracy: 0.7926 - 160s/epoch - 643ms/step
Epoch 15/110
Validation cm: [[357 452  23 157]
 [250 514  13  66]
 [ 23  43  12  42]
 [ 41  62  15  26]]
Validation val_loss: 1.4246222335631369
Validation normalized_cm: [[0.361 0.457 0.023 0.159]
 [0.297 0.61  0.015 0.078]
 [0.192 0.358 0.1   0.35 ]
 [0.285 0.431 0.104 0.181]]
Validation acc: 0.4336832061068702
Validation class_accuracies: [0.3609706774519717, 0.6097271648873073, 0.1, 0.18055555555555555]
Validation sensitivity: 0.4986449864498645
Validation specificity: 0.3609706774519717
Validation icbhi_score: 0.4298078319509181
Validation roc_auc: None
Validation avg_accuracy: 0.31281334947370865
Validation one_indexed_epoch: 15
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 167s - loss: 0.0814 - accuracy: 0.7697 - 167s/epoch - 671ms/step
Epoch 16/110
Validation cm: [[340 381  79 189]
 [223 422  54 144]
 [ 25  27  16  52]
 [ 10  68  20  46]]
Validation val_loss: 1.1054927867306605
Validation normalized_cm: [[0.344 0.385 0.08  0.191]
 [0.265 0.501 0.064 0.171]
 [0.208 0.225 0.133 0.433]
 [0.069 0.472 0.139 0.319]]
Validation acc: 0.3931297709923664
Validation class_accuracies: [0.3437815975733064, 0.5005931198102017, 0.13333333333333333, 0.3194444444444444]
Validation sensitivity: 0.4372177055103884
Validation specificity: 0.3437815975733064
Validation icbhi_score: 0.3904996515418474
Validation roc_auc: None
Validation avg_accuracy: 0.32428812379032146
Validation one_indexed_epoch: 16
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 162s - loss: 0.3069 - accuracy: 0.7861 - 162s/epoch - 650ms/step
Epoch 17/110
Validation cm: [[559 295  78  57]
 [489 232  65  57]
 [ 50  16  31  23]
 [ 77  22  32  13]]
Validation val_loss: 1.2619383597879181
Validation normalized_cm: [[0.565 0.298 0.079 0.058]
 [0.58  0.275 0.077 0.068]
 [0.417 0.133 0.258 0.192]
 [0.535 0.153 0.222 0.09 ]]
Validation acc: 0.39837786259541985
Validation class_accuracies: [0.5652173913043478, 0.2752075919335706, 0.25833333333333336, 0.09027777777777778]
Validation sensitivity: 0.24932249322493225
Validation specificity: 0.5652173913043478
Validation icbhi_score: 0.40726994226464003
Validation roc_auc: None
Validation avg_accuracy: 0.29725902358725736
Validation one_indexed_epoch: 17
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 162s - loss: 0.1131 - accuracy: 0.7793 - 162s/epoch - 652ms/step
Epoch 18/110
Validation cm: [[196  14 761  18]
 [130   6 695  12]
 [  6   0 109   5]
 [  7   0 137   0]]
Validation val_loss: 3.8940663513375138
Validation normalized_cm: [[0.198 0.014 0.769 0.018]
 [0.154 0.007 0.824 0.014]
 [0.05  0.    0.908 0.042]
 [0.049 0.    0.951 0.   ]]
Validation acc: 0.14837786259541985
Validation class_accuracies: [0.19817997977755308, 0.0071174377224199285, 0.9083333333333333, 0.0]
Validation sensitivity: 0.10388437217705511
Validation specificity: 0.19817997977755308
Validation icbhi_score: 0.1510321759773041
Validation roc_auc: None
Validation avg_accuracy: 0.2784076877083266
Validation one_indexed_epoch: 18
The validation tracker metric at 0.44989875075697167 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 164s - loss: 0.1109 - accuracy: 0.7561 - 164s/epoch - 657ms/step
Epoch 19/110
Validation cm: [[336 510  26 117]
 [128 635   5  75]
 [ 30  36  23  31]
 [ 13  85  16  30]]
Validation val_loss: 0.6534242651581708
Validation normalized_cm: [[0.34  0.516 0.026 0.118]
 [0.152 0.753 0.006 0.089]
 [0.25  0.3   0.192 0.258]
 [0.09  0.59  0.111 0.208]]
Validation acc: 0.48854961832061067
Validation class_accuracies: [0.339737108190091, 0.7532621589561092, 0.19166666666666668, 0.20833333333333334]
Validation sensitivity: 0.6214995483288166
Validation specificity: 0.339737108190091
Validation icbhi_score: 0.48061832825945383
Validation roc_auc: None
Validation avg_accuracy: 0.37324981678655
Validation one_indexed_epoch: 19
-- New best results were achieved. --
There is no such attribute
249/249 - 168s - loss: 0.5644 - accuracy: 0.6830 - 168s/epoch - 673ms/step
Epoch 20/110
Validation cm: [[710  95 105  79]
 [608 101  92  42]
 [ 51   0  53  16]
 [ 89  16  34   5]]
Validation val_loss: 0.9372686958398122
Validation normalized_cm: [[0.718 0.096 0.106 0.08 ]
 [0.721 0.12  0.109 0.05 ]
 [0.425 0.    0.442 0.133]
 [0.618 0.111 0.236 0.035]]
Validation acc: 0.4145992366412214
Validation class_accuracies: [0.717896865520728, 0.11981020166073547, 0.44166666666666665, 0.034722222222222224]
Validation sensitivity: 0.14363143631436315
Validation specificity: 0.717896865520728
Validation icbhi_score: 0.43076415091754555
Validation roc_auc: None
Validation avg_accuracy: 0.3285239890175881
Validation one_indexed_epoch: 20
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 163s - loss: 0.2997 - accuracy: 0.7700 - 163s/epoch - 655ms/step
Epoch 21/110
Validation cm: [[ 97  94 215 583]
 [ 35 100 137 571]
 [  3   2  50  65]
 [  3   4  38  99]]
Validation val_loss: 2.309291308754684
Validation normalized_cm: [[0.098 0.095 0.217 0.589]
 [0.042 0.119 0.163 0.677]
 [0.025 0.017 0.417 0.542]
 [0.021 0.028 0.264 0.688]]
Validation acc: 0.1650763358778626
Validation class_accuracies: [0.0980788675429727, 0.11862396204033215, 0.4166666666666667, 0.6875]
Validation sensitivity: 0.22493224932249323
Validation specificity: 0.0980788675429727
Validation icbhi_score: 0.16150555843273295
Validation roc_auc: None
Validation avg_accuracy: 0.33021737406249285
Validation one_indexed_epoch: 21
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 2 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 162s - loss: 0.2285 - accuracy: 0.7768 - 162s/epoch - 652ms/step
Epoch 22/110
Validation cm: [[464 330  64 131]
 [369 357  33  84]
 [ 44  12  20  44]
 [ 52  56  24  12]]
Validation val_loss: 0.9674335338294934
Validation normalized_cm: [[0.469 0.334 0.065 0.132]
 [0.438 0.423 0.039 0.1  ]
 [0.367 0.1   0.167 0.367]
 [0.361 0.389 0.167 0.083]]
Validation acc: 0.40696564885496184
Validation class_accuracies: [0.4691607684529828, 0.4234875444839858, 0.16666666666666666, 0.08333333333333333]
Validation sensitivity: 0.35140018066847334
Validation specificity: 0.4691607684529828
Validation icbhi_score: 0.4102804745607281
Validation roc_auc: None
Validation avg_accuracy: 0.28566207823424217
Validation one_indexed_epoch: 22
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 161s - loss: 0.3881 - accuracy: 0.7309 - 161s/epoch - 648ms/step
Epoch 23/110
Validation cm: [[697  39 223  30]
 [604  48 165  26]
 [ 40   1  71   8]
 [ 77   6  56   5]]
Validation val_loss: 1.3494927782975752
Validation normalized_cm: [[0.705 0.039 0.225 0.03 ]
 [0.716 0.057 0.196 0.031]
 [0.333 0.008 0.592 0.067]
 [0.535 0.042 0.389 0.035]]
Validation acc: 0.3916984732824427
Validation class_accuracies: [0.704752275025278, 0.05693950177935943, 0.5916666666666667, 0.034722222222222224]
Validation sensitivity: 0.1120144534778681
Validation specificity: 0.704752275025278
Validation icbhi_score: 0.40838336425157307
Validation roc_auc: None
Validation avg_accuracy: 0.3470201664233816
Validation one_indexed_epoch: 23
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 165s - loss: 0.1741 - accuracy: 0.7773 - 165s/epoch - 664ms/step
Epoch 24/110
Validation cm: [[388 406  91 104]
 [259 450  59  75]
 [ 20  24  41  35]
 [ 11  84  16  33]]
Validation val_loss: 1.0801015834953682
Validation normalized_cm: [[0.392 0.411 0.092 0.105]
 [0.307 0.534 0.07  0.089]
 [0.167 0.2   0.342 0.292]
 [0.076 0.583 0.111 0.229]]
Validation acc: 0.4351145038167939
Validation class_accuracies: [0.3923154701718908, 0.5338078291814946, 0.3416666666666667, 0.22916666666666666]
Validation sensitivity: 0.47335140018066846
Validation specificity: 0.3923154701718908
Validation icbhi_score: 0.4328334351762796
Validation roc_auc: None
Validation avg_accuracy: 0.3742391581716797
Validation one_indexed_epoch: 24
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 162s - loss: 0.1875 - accuracy: 0.7874 - 162s/epoch - 652ms/step
Epoch 25/110
Validation cm: [[444 391  46 108]
 [312 449  27  55]
 [ 41  24  28  27]
 [ 40  68  27   9]]
Validation val_loss: 1.1987840390005144
Validation normalized_cm: [[0.449 0.395 0.047 0.109]
 [0.37  0.533 0.032 0.065]
 [0.342 0.2   0.233 0.225]
 [0.278 0.472 0.188 0.062]]
Validation acc: 0.4437022900763359
Validation class_accuracies: [0.448938321536906, 0.5326215895610913, 0.23333333333333334, 0.0625]
Validation sensitivity: 0.43902439024390244
Validation specificity: 0.448938321536906
Validation icbhi_score: 0.4439813558904042
Validation roc_auc: None
Validation avg_accuracy: 0.3193483111078327
Validation one_indexed_epoch: 25
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 161s - loss: 0.0912 - accuracy: 0.8007 - 161s/epoch - 645ms/step
Epoch 26/110
Validation cm: [[228 218 207 336]
 [ 99 238 147 359]
 [ 10   6  45  59]
 [ 11  23  45  65]]
Validation val_loss: 2.0385192276492052
Validation normalized_cm: [[0.231 0.22  0.209 0.34 ]
 [0.117 0.282 0.174 0.426]
 [0.083 0.05  0.375 0.492]
 [0.076 0.16  0.312 0.451]]
Validation acc: 0.2748091603053435
Validation class_accuracies: [0.23053589484327602, 0.2823250296559905, 0.375, 0.4513888888888889]
Validation sensitivity: 0.3143631436314363
Validation specificity: 0.23053589484327602
Validation icbhi_score: 0.27244951923735616
Validation roc_auc: None
Validation avg_accuracy: 0.33481245334703885
Validation one_indexed_epoch: 26
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 226s - loss: 0.0655 - accuracy: 0.7967 - 226s/epoch - 906ms/step
Epoch 27/110
Validation cm: [[247 545  53 144]
 [ 99 619  22 103]
 [ 18  41  20  41]
 [  8  92  11  33]]
Validation val_loss: 1.1358709111933312
Validation normalized_cm: [[0.25  0.551 0.054 0.146]
 [0.117 0.734 0.026 0.122]
 [0.15  0.342 0.167 0.342]
 [0.056 0.639 0.076 0.229]]
Validation acc: 0.43845419847328243
Validation class_accuracies: [0.24974721941354905, 0.734282325029656, 0.16666666666666666, 0.22916666666666666]
Validation sensitivity: 0.6070460704607046
Validation specificity: 0.24974721941354905
Validation icbhi_score: 0.4283966449371268
Validation roc_auc: None
Validation avg_accuracy: 0.3449657194441346
Validation one_indexed_epoch: 27
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 8 epochs
There is no such attribute
249/249 - 163s - loss: 0.2714 - accuracy: 0.7125 - 163s/epoch - 653ms/step
Epoch 28/110
Validation cm: [[234 529  34 192]
 [111 529  16 187]
 [ 13  29  16  62]
 [  7  71   6  60]]
Validation val_loss: 1.4373458691623537
Validation normalized_cm: [[0.237 0.535 0.034 0.194]
 [0.132 0.628 0.019 0.222]
 [0.108 0.242 0.133 0.517]
 [0.049 0.493 0.042 0.417]]
Validation acc: 0.4002862595419847
Validation class_accuracies: [0.23660262891809908, 0.627520759193357, 0.13333333333333333, 0.4166666666666667]
Validation sensitivity: 0.5465221318879856
Validation specificity: 0.23660262891809908
Validation icbhi_score: 0.39156238040304236
Validation roc_auc: None
Validation avg_accuracy: 0.353530847027864
Validation one_indexed_epoch: 28
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 162s - loss: 0.1383 - accuracy: 0.7803 - 162s/epoch - 652ms/step
Epoch 29/110
Validation cm: [[615 234 100  40]
 [467 269  74  33]
 [ 52   6  50  12]
 [ 72  28  38   6]]
Validation val_loss: 1.2044141059798448
Validation normalized_cm: [[0.622 0.237 0.101 0.04 ]
 [0.554 0.319 0.088 0.039]
 [0.433 0.05  0.417 0.1  ]
 [0.5   0.194 0.264 0.042]]
Validation acc: 0.4484732824427481
Validation class_accuracies: [0.621840242669363, 0.3190984578884935, 0.4166666666666667, 0.041666666666666664]
Validation sensitivity: 0.2935862691960253
Validation specificity: 0.621840242669363
Validation icbhi_score: 0.4577132559326942
Validation roc_auc: None
Validation avg_accuracy: 0.3498180084727975
Validation one_indexed_epoch: 29
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 10 epochs
There is no such attribute
249/249 - 164s - loss: 0.1222 - accuracy: 0.7798 - 164s/epoch - 658ms/step
Epoch 30/110
Validation cm: [[507 142 229 111]
 [399 186 182  76]
 [ 27   5  57  31]
 [ 51   7  72  14]]
Validation val_loss: 1.723802603540275
Validation normalized_cm: [[0.513 0.144 0.232 0.112]
 [0.473 0.221 0.216 0.09 ]
 [0.225 0.042 0.475 0.258]
 [0.354 0.049 0.5   0.097]]
Validation acc: 0.36450381679389315
Validation class_accuracies: [0.512639029322548, 0.2206405693950178, 0.475, 0.09722222222222222]
Validation sensitivity: 0.23215898825654924
Validation specificity: 0.512639029322548
Validation icbhi_score: 0.3723990087895486
Validation roc_auc: None
Validation avg_accuracy: 0.32637545523494704
Validation one_indexed_epoch: 30
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 11 epochs
There is no such attribute
249/249 - 165s - loss: 0.0583 - accuracy: 0.7715 - 165s/epoch - 663ms/step
Epoch 31/110
Validation cm: [[515 275  99 100]
 [357 346  60  80]
 [ 34  16  39  31]
 [ 41  41  45  17]]
Validation val_loss: 1.423156495180082
Validation normalized_cm: [[0.521 0.278 0.1   0.101]
 [0.423 0.41  0.071 0.095]
 [0.283 0.133 0.325 0.258]
 [0.285 0.285 0.312 0.118]]
Validation acc: 0.4375
Validation class_accuracies: [0.5207280080889788, 0.41043890865954924, 0.325, 0.11805555555555555]
Validation sensitivity: 0.36314363143631434
Validation specificity: 0.5207280080889788
Validation icbhi_score: 0.44193581976264656
Validation roc_auc: None
Validation avg_accuracy: 0.3435556180760209
Validation one_indexed_epoch: 31
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0005000000237487257
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 163s - loss: 0.0435 - accuracy: 0.7720 - 163s/epoch - 656ms/step
Epoch 32/110
Validation cm: [[629 225  57  78]
 [490 270  36  47]
 [ 52  12  33  23]
 [ 77  25  34   8]]
Validation val_loss: 1.4756277187007645
Validation normalized_cm: [[0.636 0.228 0.058 0.079]
 [0.581 0.32  0.043 0.056]
 [0.433 0.1   0.275 0.192]
 [0.535 0.174 0.236 0.056]]
Validation acc: 0.4484732824427481
Validation class_accuracies: [0.6359959555106168, 0.3202846975088968, 0.275, 0.05555555555555555]
Validation sensitivity: 0.2809394760614273
Validation specificity: 0.6359959555106168
Validation icbhi_score: 0.4584677157860221
Validation roc_auc: None
Validation avg_accuracy: 0.32170905214376727
Validation one_indexed_epoch: 32
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 13 epochs
There is no such attribute
249/249 - 160s - loss: 0.0133 - accuracy: 0.7707 - 160s/epoch - 642ms/step
Epoch 33/110
Validation cm: [[590 143 164  92]
 [464 177 123  79]
 [ 35   5  58  22]
 [ 62  14  60   8]]
Validation val_loss: 1.7729800475158846
Validation normalized_cm: [[0.597 0.145 0.166 0.093]
 [0.55  0.21  0.146 0.094]
 [0.292 0.042 0.483 0.183]
 [0.431 0.097 0.417 0.056]]
Validation acc: 0.3974236641221374
Validation class_accuracies: [0.596562184024267, 0.2099644128113879, 0.48333333333333334, 0.05555555555555555]
Validation sensitivity: 0.21951219512195122
Validation specificity: 0.596562184024267
Validation icbhi_score: 0.4080371895731091
Validation roc_auc: None
Validation avg_accuracy: 0.33635387143113593
Validation one_indexed_epoch: 33
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 14 epochs
There is no such attribute
249/249 - 168s - loss: 0.0119 - accuracy: 0.7677 - 168s/epoch - 676ms/step
Epoch 34/110
Validation cm: [[612 224  73  80]
 [457 285  41  60]
 [ 47  13  40  20]
 [ 65  32  38   9]]
Validation val_loss: 1.4389363670414113
Validation normalized_cm: [[0.619 0.226 0.074 0.081]
 [0.542 0.338 0.049 0.071]
 [0.392 0.108 0.333 0.167]
 [0.451 0.222 0.264 0.062]]
Validation acc: 0.45133587786259544
Validation class_accuracies: [0.6188068756319515, 0.33807829181494664, 0.3333333333333333, 0.0625]
Validation sensitivity: 0.3017163504968383
Validation specificity: 0.6188068756319515
Validation icbhi_score: 0.4602616130643949
Validation roc_auc: None
Validation avg_accuracy: 0.33817962519505784
Validation one_indexed_epoch: 34
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 15 epochs
There is no such attribute
249/249 - 159s - loss: 0.0621 - accuracy: 0.7536 - 159s/epoch - 638ms/step
Epoch 35/110
Validation cm: [[562 264  76  87]
 [401 329  43  70]
 [ 44  13  38  25]
 [ 52  41  42   9]]
Validation val_loss: 1.513479598255863
Validation normalized_cm: [[0.568 0.267 0.077 0.088]
 [0.476 0.39  0.051 0.083]
 [0.367 0.108 0.317 0.208]
 [0.361 0.285 0.292 0.062]]
Validation acc: 0.44751908396946566
Validation class_accuracies: [0.5682507583417593, 0.3902728351126928, 0.31666666666666665, 0.0625]
Validation sensitivity: 0.33965672990063234
Validation specificity: 0.5682507583417593
Validation icbhi_score: 0.4539537441211958
Validation roc_auc: None
Validation avg_accuracy: 0.3344225650302797
Validation one_indexed_epoch: 35
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 16 epochs
There is no such attribute
249/249 - 159s - loss: 0.0128 - accuracy: 0.7559 - 159s/epoch - 640ms/step
Epoch 36/110
Validation cm: [[653 196  60  80]
 [509 245  41  48]
 [ 53  13  37  17]
 [ 74  30  35   5]]
Validation val_loss: 1.6786280201755732
Validation normalized_cm: [[0.66  0.198 0.061 0.081]
 [0.604 0.291 0.049 0.057]
 [0.442 0.108 0.308 0.142]
 [0.514 0.208 0.243 0.035]]
Validation acc: 0.4484732824427481
Validation class_accuracies: [0.660262891809909, 0.29062870699881377, 0.30833333333333335, 0.034722222222222224]
Validation sensitivity: 0.25925925925925924
Validation specificity: 0.660262891809909
Validation icbhi_score: 0.4597610755345841
Validation roc_auc: None
Validation avg_accuracy: 0.3234867885910696
Validation one_indexed_epoch: 36
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 17 epochs
There is no such attribute
249/249 - 162s - loss: 0.0077 - accuracy: 0.7745 - 162s/epoch - 651ms/step
Epoch 37/110
Validation cm: [[603 226  73  87]
 [464 279  41  59]
 [ 44  16  34  26]
 [ 63  32  43   6]]
Validation val_loss: 1.6644745688790676
Validation normalized_cm: [[0.61  0.229 0.074 0.088]
 [0.55  0.331 0.049 0.07 ]
 [0.367 0.133 0.283 0.217]
 [0.438 0.222 0.299 0.042]]
Validation acc: 0.4398854961832061
Validation class_accuracies: [0.6097067745197169, 0.3309608540925267, 0.2833333333333333, 0.041666666666666664]
Validation sensitivity: 0.2881662149954833
Validation specificity: 0.6097067745197169
Validation icbhi_score: 0.4489364947576001
Validation roc_auc: None
Validation avg_accuracy: 0.31641690715306087
Validation one_indexed_epoch: 37
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 18 epochs
There is no such attribute
249/249 - 162s - loss: 0.0154 - accuracy: 0.7541 - 162s/epoch - 652ms/step
Epoch 38/110
Validation cm: [[610 237  64  78]
 [453 300  44  46]
 [ 48  16  35  21]
 [ 70  39  32   3]]
Validation val_loss: 1.7299883036256865
Validation normalized_cm: [[0.617 0.24  0.065 0.079]
 [0.537 0.356 0.052 0.055]
 [0.4   0.133 0.292 0.175]
 [0.486 0.271 0.222 0.021]]
Validation acc: 0.45229007633587787
Validation class_accuracies: [0.6167846309403437, 0.35587188612099646, 0.2916666666666667, 0.020833333333333332]
Validation sensitivity: 0.3053297199638663
Validation specificity: 0.6167846309403437
Validation icbhi_score: 0.461057175452105
Validation roc_auc: None
Validation avg_accuracy: 0.32128912926533504
Validation one_indexed_epoch: 38
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 19 epochs
There is no such attribute
249/249 - 144s - loss: 0.0070 - accuracy: 0.7758 - 144s/epoch - 580ms/step
Epoch 39/110
Validation cm: [[536 290  71  92]
 [399 338  39  67]
 [ 44  17  33  26]
 [ 52  49  37   6]]
Validation val_loss: 1.717644356944854
Validation normalized_cm: [[0.542 0.293 0.072 0.093]
 [0.473 0.401 0.046 0.079]
 [0.367 0.142 0.275 0.217]
 [0.361 0.34  0.257 0.042]]
Validation acc: 0.43559160305343514
Validation class_accuracies: [0.5419615773508595, 0.40094899169632264, 0.275, 0.041666666666666664]
Validation sensitivity: 0.3405600722673893
Validation specificity: 0.5419615773508595
Validation icbhi_score: 0.44126082480912443
Validation roc_auc: None
Validation avg_accuracy: 0.3148943089284622
Validation one_indexed_epoch: 39
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 20 epochs
There is no such attribute
249/249 - 149s - loss: 0.0030 - accuracy: 0.7579 - 149s/epoch - 597ms/step
Epoch 40/110
Validation cm: [[516 329  61  83]
 [376 382  30  55]
 [ 46  19  31  24]
 [ 52  55  29   8]]
Validation val_loss: 1.683438539041314
Validation normalized_cm: [[0.522 0.333 0.062 0.084]
 [0.446 0.453 0.036 0.065]
 [0.383 0.158 0.258 0.2  ]
 [0.361 0.382 0.201 0.056]]
Validation acc: 0.4470419847328244
Validation class_accuracies: [0.5217391304347826, 0.4531435349940688, 0.25833333333333336, 0.05555555555555555]
Validation sensitivity: 0.3803071364046974
Validation specificity: 0.5217391304347826
Validation icbhi_score: 0.45102313341974
Validation roc_auc: None
Validation avg_accuracy: 0.32219288857943507
Validation one_indexed_epoch: 40
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 21 epochs
There is no such attribute
249/249 - 154s - loss: 0.0034 - accuracy: 0.7574 - 154s/epoch - 620ms/step
Epoch 41/110
Validation cm: [[620 217  72  80]
 [471 272  46  54]
 [ 50  11  36  23]
 [ 70  28  41   5]]
Validation val_loss: 1.8243496324227837
Validation normalized_cm: [[0.627 0.219 0.073 0.081]
 [0.559 0.323 0.055 0.064]
 [0.417 0.092 0.3   0.192]
 [0.486 0.194 0.285 0.035]]
Validation acc: 0.44513358778625955
Validation class_accuracies: [0.6268958543983822, 0.32265717674970346, 0.3, 0.034722222222222224]
Validation sensitivity: 0.2827461607949413
Validation specificity: 0.6268958543983822
Validation icbhi_score: 0.4548210075966618
Validation roc_auc: None
Validation avg_accuracy: 0.32106881334257703
Validation one_indexed_epoch: 41
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 22 epochs
There is no such attribute
249/249 - 156s - loss: 0.0026 - accuracy: 0.7682 - 156s/epoch - 625ms/step
Epoch 42/110
Validation cm: [[590 251  66  82]
 [435 310  39  59]
 [ 49  14  36  21]
 [ 62  39  37   6]]
Validation val_loss: 1.7827283311097495
Validation normalized_cm: [[0.597 0.254 0.067 0.083]
 [0.516 0.368 0.046 0.07 ]
 [0.408 0.117 0.3   0.175]
 [0.431 0.271 0.257 0.042]]
Validation acc: 0.4494274809160305
Validation class_accuracies: [0.596562184024267, 0.36773428232502964, 0.3, 0.041666666666666664]
Validation sensitivity: 0.3179765130984643
Validation specificity: 0.596562184024267
Validation icbhi_score: 0.45726934856136564
Validation roc_auc: None
Validation avg_accuracy: 0.32649078325399084
Validation one_indexed_epoch: 42
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 23 epochs
There is no such attribute
249/249 - 155s - loss: 0.0041 - accuracy: 0.7470 - 155s/epoch - 622ms/step
Epoch 43/110
Validation cm: [[562 271  69  87]
 [394 342  42  65]
 [ 47  16  35  22]
 [ 52  41  43   8]]
Validation val_loss: 1.776521472344931
Validation normalized_cm: [[0.568 0.274 0.07  0.088]
 [0.467 0.406 0.05  0.077]
 [0.392 0.133 0.292 0.183]
 [0.361 0.285 0.299 0.056]]
Validation acc: 0.4518129770992366
Validation class_accuracies: [0.5682507583417593, 0.40569395017793597, 0.2916666666666667, 0.05555555555555555]
Validation sensitivity: 0.34778681120144533
Validation specificity: 0.5682507583417593
Validation icbhi_score: 0.4580187847716023
Validation roc_auc: None
Validation avg_accuracy: 0.3302917326854794
Validation one_indexed_epoch: 43
The validation tracker metric at 0.48061832825945383 hasn't increased by 0 in 24 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
249/249 - 155s - loss: 0.0021 - accuracy: 0.7518 - 155s/epoch - 623ms/step
Epoch 44/110
Validation cm: [[547 288  63  91]
 [386 357  37  63]
 [ 46  17  33  24]
 [ 51  46  38   9]]
Validation val_loss: 1.7856738858558792
Validation normalized_cm: [[0.553 0.291 0.064 0.092]
 [0.458 0.423 0.044 0.075]
 [0.383 0.142 0.275 0.2  ]
 [0.354 0.319 0.264 0.062]]
Validation acc: 0.45133587786259544
Validation class_accuracies: [0.5530839231547017, 0.4234875444839858, 0.275, 0.0625]
Validation sensitivity: 0.3604336043360434
Validation specificity: 0.5530839231547017
Validation icbhi_score: 0.4567587637453725
Validation roc_auc: None
Validation avg_accuracy: 0.3285178669096719
Validation one_indexed_epoch: 44
The number of epochs since last 1% equals the patience
There is no such attribute
249/249 - 155s - loss: 0.0018 - accuracy: 0.7538 - 155s/epoch - 624ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.48061832825945383
Best cm: [[336 510  26 117]
 [128 635   5  75]
 [ 30  36  23  31]
 [ 13  85  16  30]]
Best val_loss: 0.6534242651581708
Best normalized_cm: [[0.34  0.516 0.026 0.118]
 [0.152 0.753 0.006 0.089]
 [0.25  0.3   0.192 0.258]
 [0.09  0.59  0.111 0.208]]
Best acc: 0.48854961832061067
Best class_accuracies: [0.339737108190091, 0.7532621589561092, 0.19166666666666668, 0.20833333333333334]
Best sensitivity: 0.6214995483288166
Best specificity: 0.339737108190091
Best roc_auc: None
Best avg_accuracy: 0.37324981678655
Best one_indexed_epoch: 19
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6591404676437378, 0.5720479488372803, 0.49849626421928406, 0.4427858591079712, 0.38622990250587463, 0.32203996181488037, 0.29551345109939575, 0.2453600913286209, 0.16253630816936493, 0.14128249883651733, 0.141814187169075, 0.11394985020160675, 0.14828139543533325, 0.07324256747961044, 0.08139078319072723, 0.3068750500679016, 0.1130598708987236, 0.11086566746234894, 0.5644322633743286, 0.29967325925827026, 0.22845040261745453, 0.38805532455444336, 0.17412470281124115, 0.18746903538703918, 0.09124132245779037, 0.06549566239118576, 0.2714248299598694, 0.1382787972688675, 0.12222114205360413, 0.05825048312544823, 0.04347473382949829, 0.013317575678229332, 0.011892680078744888, 0.062112774699926376, 0.012805302627384663, 0.007710904348641634, 0.015449250116944313, 0.0070439730770885944, 0.003047359175980091, 0.003382294438779354, 0.0026319606695324183, 0.004092751070857048, 0.00205630948767066, 0.001786511391401291], 'accuracy': [0.5668933987617493, 0.6457545757293701, 0.7094986438751221, 0.7185689210891724, 0.7389770746231079, 0.7591332793235779, 0.749811053276062, 0.7770219445228577, 0.7747543454170227, 0.7850844264030457, 0.7810531854629517, 0.7974300980567932, 0.7969262003898621, 0.7926430106163025, 0.7697153091430664, 0.786092221736908, 0.7792894840240479, 0.7561098337173462, 0.6830435991287231, 0.769967257976532, 0.7767699956893921, 0.7309145927429199, 0.7772738933563232, 0.7873519659042358, 0.8007054924964905, 0.7966742515563965, 0.712522029876709, 0.7802972793579102, 0.779793381690979, 0.7714789509773254, 0.7719828486442566, 0.7707231044769287, 0.767699658870697, 0.7535903453826904, 0.7558578848838806, 0.7745023965835571, 0.7540942430496216, 0.775762140750885, 0.75787353515625, 0.7573696374893188, 0.7682035565376282, 0.7470395565032959, 0.7518266439437866, 0.753842294216156]}
End
####################################
Job dir: ../cache/cw/train180/2
Job id is 3.
Job dir: ../cache/cw/train180/3
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 4.
turning the kfold from 90/10 to 80/20
100
12
to
90
22
-----------------------
--- Final training dataset went from 0 to 3969 elements, with 1889 none's, 991 crakles, 597 wheezes and 492 both ---
--- Final Validation dataset contains 2096 elements, with 989 none, 843 crackles, 120 wheezes and 144 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.5252779248279513, 1: 1.0012613521695257, 2: 1.6620603015075377, 3: 2.0167682926829267}
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense_2 (Dense)             (None, 1024)              2098176   
                                                                 
 dropout_1 (Dropout)         (None, 1024)              0         
                                                                 
 dense_3 (Dense)             (None, 512)               524800    
                                                                 
 dropout_2 (Dropout)         (None, 512)               0         
                                                                 
 dense_4 (Dense)             (None, 2)                 1026      
                                                                 
=================================================================
Total params: 26,211,714
Trainable params: 26,158,594
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_174_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   26211714         
                                                                                                              
==============================================================================================================
Total params: 26,211,876
Trainable params: 7,089,828
Non-trainable params: 19,122,048
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[297 289 188 215]
 [ 96 489  35 223]
 [ 12  29  41  38]
 [ 10  63  19  52]]
Validation val_loss: 0.6607337575903489
Validation normalized_cm: [[0.3   0.292 0.19  0.217]
 [0.114 0.58  0.042 0.265]
 [0.1   0.242 0.342 0.317]
 [0.069 0.438 0.132 0.361]]
Validation acc: 0.4193702290076336
Validation class_accuracies: [0.30030333670374115, 0.5800711743772242, 0.3416666666666667, 0.3611111111111111]
Validation sensitivity: 0.5257452574525745
Validation specificity: 0.30030333670374115
Validation icbhi_score: 0.4130242970781578
Validation roc_auc: None
Validation avg_accuracy: 0.3957880722146858
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
249/249 - 143s - loss: 0.6757 - accuracy: 0.5450 - 143s/epoch - 575ms/step
Epoch 2/110
Validation cm: [[299 420  56 214]
 [ 80 591  15 157]
 [  9  37  20  54]
 [ 10  80  17  37]]
Validation val_loss: 0.646390258787797
Validation normalized_cm: [[0.302 0.425 0.057 0.216]
 [0.095 0.701 0.018 0.186]
 [0.075 0.308 0.167 0.45 ]
 [0.069 0.556 0.118 0.257]]
Validation acc: 0.4518129770992366
Validation class_accuracies: [0.3023255813953488, 0.701067615658363, 0.16666666666666666, 0.2569444444444444]
Validation sensitivity: 0.5853658536585366
Validation specificity: 0.3023255813953488
Validation icbhi_score: 0.4438457175269427
Validation roc_auc: None
Validation avg_accuracy: 0.35675107704120573
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
249/249 - 139s - loss: 0.5909 - accuracy: 0.6354 - 139s/epoch - 556ms/step
Epoch 3/110
Validation cm: [[347 273 173 196]
 [126 440  65 212]
 [ 17  16  36  51]
 [ 17  49  40  38]]
Validation val_loss: 0.7044395141068931
Validation normalized_cm: [[0.351 0.276 0.175 0.198]
 [0.149 0.522 0.077 0.251]
 [0.142 0.133 0.3   0.425]
 [0.118 0.34  0.278 0.264]]
Validation acc: 0.4107824427480916
Validation class_accuracies: [0.35085945399393326, 0.5219454329774614, 0.3, 0.2638888888888889]
Validation sensitivity: 0.4643179765130985
Validation specificity: 0.35085945399393326
Validation icbhi_score: 0.40758871525351587
Validation roc_auc: None
Validation avg_accuracy: 0.3591734439650709
Validation one_indexed_epoch: 3
The validation tracker metric at 0.4438457175269427 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 138s - loss: 0.5402 - accuracy: 0.6747 - 138s/epoch - 555ms/step
Epoch 4/110
Validation cm: [[608 213  83  85]
 [369 367  50  57]
 [ 41  15  46  18]
 [ 55  40  44   5]]
Validation val_loss: 0.5939031525698085
Validation normalized_cm: [[0.615 0.215 0.084 0.086]
 [0.438 0.435 0.059 0.068]
 [0.342 0.125 0.383 0.15 ]
 [0.382 0.278 0.306 0.035]]
Validation acc: 0.48950381679389315
Validation class_accuracies: [0.6147623862487361, 0.43534994068801897, 0.38333333333333336, 0.034722222222222224]
Validation sensitivity: 0.37759710930442636
Validation specificity: 0.6147623862487361
Validation icbhi_score: 0.49617974777658125
Validation roc_auc: None
Validation avg_accuracy: 0.3670419706230777
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
249/249 - 139s - loss: 0.5030 - accuracy: 0.7047 - 139s/epoch - 558ms/step
Epoch 5/110
Validation cm: [[466 171 237 115]
 [244 281 132 186]
 [ 25   6  70  19]
 [ 30  20  68  26]]
Validation val_loss: 0.7322547896423036
Validation normalized_cm: [[0.471 0.173 0.24  0.116]
 [0.289 0.333 0.157 0.221]
 [0.208 0.05  0.583 0.158]
 [0.208 0.139 0.472 0.181]]
Validation acc: 0.40219465648854963
Validation class_accuracies: [0.4711830131445905, 0.3333333333333333, 0.5833333333333334, 0.18055555555555555]
Validation sensitivity: 0.3405600722673893
Validation specificity: 0.4711830131445905
Validation icbhi_score: 0.4058715427059899
Validation roc_auc: None
Validation avg_accuracy: 0.3921013088417032
Validation one_indexed_epoch: 5
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 140s - loss: 0.4641 - accuracy: 0.7239 - 140s/epoch - 561ms/step
Epoch 6/110
Validation cm: [[332 432  80 145]
 [128 505  48 162]
 [ 26  23  39  32]
 [ 15  66  35  28]]
Validation val_loss: 0.6949528462135429
Validation normalized_cm: [[0.336 0.437 0.081 0.147]
 [0.152 0.599 0.057 0.192]
 [0.217 0.192 0.325 0.267]
 [0.104 0.458 0.243 0.194]]
Validation acc: 0.4312977099236641
Validation class_accuracies: [0.3356926188068756, 0.5990510083036773, 0.325, 0.19444444444444445]
Validation sensitivity: 0.5167118337850045
Validation specificity: 0.3356926188068756
Validation icbhi_score: 0.42620222629594007
Validation roc_auc: None
Validation avg_accuracy: 0.3635470178887493
Validation one_indexed_epoch: 6
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 139s - loss: 0.4403 - accuracy: 0.7322 - 139s/epoch - 560ms/step
Epoch 7/110
Validation cm: [[557 241 105  86]
 [406 334  54  49]
 [ 50  12  45  13]
 [ 59  45  33   7]]
Validation val_loss: 0.7122067026328518
Validation normalized_cm: [[0.563 0.244 0.106 0.087]
 [0.482 0.396 0.064 0.058]
 [0.417 0.1   0.375 0.108]
 [0.41  0.312 0.229 0.049]]
Validation acc: 0.44990458015267176
Validation class_accuracies: [0.5631951466127402, 0.3962040332147094, 0.375, 0.04861111111111111]
Validation sensitivity: 0.3486901535682023
Validation specificity: 0.5631951466127402
Validation icbhi_score: 0.45594265009047125
Validation roc_auc: None
Validation avg_accuracy: 0.34575257273464016
Validation one_indexed_epoch: 7
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 141s - loss: 0.4015 - accuracy: 0.7445 - 141s/epoch - 568ms/step
Epoch 8/110
Validation cm: [[548 281  54 106]
 [335 391  43  74]
 [ 53  14  27  26]
 [ 54  54  29   7]]
Validation val_loss: 0.7071916069226688
Validation normalized_cm: [[0.554 0.284 0.055 0.107]
 [0.397 0.464 0.051 0.088]
 [0.442 0.117 0.225 0.217]
 [0.375 0.375 0.201 0.049]]
Validation acc: 0.4642175572519084
Validation class_accuracies: [0.5540950455005056, 0.4638196915776987, 0.225, 0.04861111111111111]
Validation sensitivity: 0.3839205058717254
Validation specificity: 0.5540950455005056
Validation icbhi_score: 0.4690077756861155
Validation roc_auc: None
Validation avg_accuracy: 0.32288146204732887
Validation one_indexed_epoch: 8
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 140s - loss: 0.3790 - accuracy: 0.7503 - 140s/epoch - 561ms/step
Epoch 9/110
Validation cm: [[554 267  84  84]
 [418 309  46  70]
 [ 45  15  39  21]
 [ 44  48  42  10]]
Validation val_loss: 0.7100800752474479
Validation normalized_cm: [[0.56  0.27  0.085 0.085]
 [0.496 0.367 0.055 0.083]
 [0.375 0.125 0.325 0.175]
 [0.306 0.333 0.292 0.069]]
Validation acc: 0.4351145038167939
Validation class_accuracies: [0.5601617795753286, 0.3665480427046263, 0.325, 0.06944444444444445]
Validation sensitivity: 0.32339656729900634
Validation specificity: 0.5601617795753286
Validation icbhi_score: 0.4417791734371675
Validation roc_auc: None
Validation avg_accuracy: 0.33028856668109985
Validation one_indexed_epoch: 9
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 163s - loss: 0.3452 - accuracy: 0.7617 - 163s/epoch - 655ms/step
Epoch 10/110
Validation cm: [[189 189 204 407]
 [ 75 210 122 436]
 [ 10   5  36  69]
 [  5  14  38  87]]
Validation val_loss: 1.4391278746254157
Validation normalized_cm: [[0.191 0.191 0.206 0.412]
 [0.089 0.249 0.145 0.517]
 [0.083 0.042 0.3   0.575]
 [0.035 0.097 0.264 0.604]]
Validation acc: 0.24904580152671757
Validation class_accuracies: [0.1911021233569262, 0.2491103202846975, 0.3, 0.6041666666666666]
Validation sensitivity: 0.3008130081300813
Validation specificity: 0.1911021233569262
Validation icbhi_score: 0.24595756574350375
Validation roc_auc: None
Validation avg_accuracy: 0.3360947775770726
Validation one_indexed_epoch: 10
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 141s - loss: 0.3055 - accuracy: 0.7695 - 141s/epoch - 568ms/step
Epoch 11/110
Validation cm: [[421 445  40  83]
 [269 518  11  45]
 [ 37  38  25  20]
 [ 25  82  19  18]]
Validation val_loss: 0.7262218054989398
Validation normalized_cm: [[0.426 0.45  0.04  0.084]
 [0.319 0.614 0.013 0.053]
 [0.308 0.317 0.208 0.167]
 [0.174 0.569 0.132 0.125]]
Validation acc: 0.4685114503816794
Validation class_accuracies: [0.4256825075834176, 0.6144721233689205, 0.20833333333333334, 0.125]
Validation sensitivity: 0.5067750677506775
Validation specificity: 0.4256825075834176
Validation icbhi_score: 0.46622878766704756
Validation roc_auc: None
Validation avg_accuracy: 0.34337199107141786
Validation one_indexed_epoch: 11
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 146s - loss: 0.2912 - accuracy: 0.7503 - 146s/epoch - 588ms/step
Epoch 12/110
Validation cm: [[294 420  60 215]
 [151 475  41 176]
 [ 25  23  31  41]
 [ 15  66  29  34]]
Validation val_loss: 0.9752770155265554
Validation normalized_cm: [[0.297 0.425 0.061 0.217]
 [0.179 0.563 0.049 0.209]
 [0.208 0.192 0.258 0.342]
 [0.104 0.458 0.201 0.236]]
Validation acc: 0.3979007633587786
Validation class_accuracies: [0.2972699696663296, 0.5634638196915777, 0.25833333333333336, 0.2361111111111111]
Validation sensitivity: 0.4878048780487805
Validation specificity: 0.2972699696663296
Validation icbhi_score: 0.3925374238575551
Validation roc_auc: None
Validation avg_accuracy: 0.3387945584505879
Validation one_indexed_epoch: 12
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 8 epochs
There is no such attribute
249/249 - 144s - loss: 0.2749 - accuracy: 0.7591 - 144s/epoch - 578ms/step
Epoch 13/110
Validation cm: [[503 339  71  76]
 [336 429  27  51]
 [ 47  22  33  18]
 [ 39  70  22  13]]
Validation val_loss: 0.7351977707071143
Validation normalized_cm: [[0.509 0.343 0.072 0.077]
 [0.399 0.509 0.032 0.06 ]
 [0.392 0.183 0.275 0.15 ]
 [0.271 0.486 0.153 0.09 ]]
Validation acc: 0.4666030534351145
Validation class_accuracies: [0.5085945399393327, 0.5088967971530249, 0.275, 0.09027777777777778]
Validation sensitivity: 0.4290876242095754
Validation specificity: 0.5085945399393327
Validation icbhi_score: 0.4688410820744541
Validation roc_auc: None
Validation avg_accuracy: 0.34569227871753383
Validation one_indexed_epoch: 13
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 150s - loss: 0.2470 - accuracy: 0.7702 - 150s/epoch - 603ms/step
Epoch 14/110
Validation cm: [[485 211 176 117]
 [345 260 157  81]
 [ 30   9  58  23]
 [ 42  22  70  10]]
Validation val_loss: 1.1820446917517082
Validation normalized_cm: [[0.49  0.213 0.178 0.118]
 [0.409 0.308 0.186 0.096]
 [0.25  0.075 0.483 0.192]
 [0.292 0.153 0.486 0.069]]
Validation acc: 0.38788167938931295
Validation class_accuracies: [0.4903943377148635, 0.3084223013048636, 0.48333333333333334, 0.06944444444444445]
Validation sensitivity: 0.2962962962962963
Validation specificity: 0.4903943377148635
Validation icbhi_score: 0.3933453170055799
Validation roc_auc: None
Validation avg_accuracy: 0.33789860419937623
Validation one_indexed_epoch: 14
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 10 epochs
There is no such attribute
249/249 - 153s - loss: 0.2319 - accuracy: 0.7737 - 153s/epoch - 616ms/step
Epoch 15/110
Validation cm: [[666 199  73  51]
 [491 260  62  30]
 [ 55  14  32  19]
 [ 70  26  28  20]]
Validation val_loss: 0.7926228438031019
Validation normalized_cm: [[0.673 0.201 0.074 0.052]
 [0.582 0.308 0.074 0.036]
 [0.458 0.117 0.267 0.158]
 [0.486 0.181 0.194 0.139]]
Validation acc: 0.4666030534351145
Validation class_accuracies: [0.673407482305359, 0.3084223013048636, 0.26666666666666666, 0.1388888888888889]
Validation sensitivity: 0.28184281842818426
Validation specificity: 0.673407482305359
Validation icbhi_score: 0.4776251503667716
Validation roc_auc: None
Validation avg_accuracy: 0.3468463347914445
Validation one_indexed_epoch: 15
The validation tracker metric at 0.49617974777658125 hasn't increased by 0 in 11 epochs
There is no such attribute
249/249 - 153s - loss: 0.2183 - accuracy: 0.7818 - 153s/epoch - 615ms/step
Epoch 16/110
