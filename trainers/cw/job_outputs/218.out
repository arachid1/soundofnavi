Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train218
Description: kfold with all data
-----------------------
training parameters
[('cache_root', '../cache/'), ('data_root', '../data/'), ('jordan_root', '../data/jwyy9np4gv-3/'), ('icbhi_root', '../data/raw_audios/icbhi_preprocessed_v2_8000/'), ('bd_root', '../data/PCV_SEGMENTED_Processed_Files/'), ('excel_path', '../data/Bangladesh_PCV_onlyStudyPatients.xlsx'), ('perch_root', '../data/raw_audios/perch_8000_10seconds'), ('ant_root', '../data/raw_audios/Antwerp_Clinical_Complete'), ('description', 'kfold with all data'), ('job_id', 0), ('mode', 'cw'), ('n_classes', 2), ('shape', (80, 200, 3)), ('n_epochs', 100), ('lr', 0.005), ('batch_size', 64), ('ll2_reg', 0), ('weight_decay', 0.0001), ('label_smoothing', 0), ('epsilon', 1e-07), ('es_patience', 13), ('min_delta', 0), ('train_test_ratio', 0.8), ('kfold', True), ('clause', 0), ('epoch_start', 0), ('testing', 0), ('adaptive_lr', True), ('cuberooting', 1), ('normalizing', 1), ('class_weights', True), ('early_stopping', True), ('initial_channels', 1), ('factor', 0.25), ('lr_patience', 6), ('min_lr', 1e-05), ('sr', 8000), ('audio_length', 5), ('step_size', 2.5), ('n_fft', 2048), ('hop_length', 254), ('n_mels', 128), ('overlap_threshold', 0.3), ('trainable_fb', False), ('to_decibel', True), ('train_nn', False), ('train_mel', False), ('file_dir', '../cache/cw/train218'), ('n_sequences', 9), ('activate_spectral_loss', False), ('normalize', False), ('stacking', False), ('oversample', False), ('one_hot_encoding', False), ('activation', 'sigmoid'), ('n_filters', 80), ('code', -1), ('distillation', False), ('viz_count', 5), ('window_len', 100), ('window_stride', 25)]
Job id is 1.
Job dir: ../cache/cw/train218/1
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
920 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
126 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
len of icbhi
7857
len of train icbhi
4769
len of val icbhi
3080
before icbhi addition
11647
after icbhi addition
16416
-----------------------
--- Final training dataset went from 0 to 16416 elements, with 11726 none's, 1637 crakles, 2096 wheezes and 957 both ---
--- Final Validation dataset contains 2912 elements, with 2424 none, 60 crackles, 324 wheezes and 104 both ---
Initializing weights...
weights = {0: 0.3499914719426915, 1: 2.5070250458155163, 2: 1.9580152671755726, 3: 4.2884012539184955}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 7, 2048)        23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               204900    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_pretrained"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Target metric is icbhi_score
here
There is no such attribute
here2
Epoch 1/100
Validation cm: [[2351   57   10    6]
 [  59    1    0    0]
 [ 183   44   66   31]
 [  47   34   13   10]]
Validation val_loss: 0.3712114851403205
Validation normalized_cm: [[0.97  0.024 0.004 0.002]
 [0.983 0.017 0.    0.   ]
 [0.565 0.136 0.204 0.096]
 [0.452 0.327 0.125 0.096]]
Validation acc: 0.8337912087912088
Validation class_accuracies: [0.9698844884488449, 0.016666666666666666, 0.2037037037037037, 0.09615384615384616]
Validation sensitivity: 0.15778688524590165
Validation specificity: 0.9698844884488449
Validation icbhi_score: 0.5638356868473733
Validation roc_auc: None
Validation avg_accuracy: 0.32160217624326537
Validation one_indexed_epoch: 1
Validation cm: [[1180  357   30    7]
 [ 642  213    5    0]
 [ 289   98   13    4]
 [ 148   79   14    1]]
Validation val_loss: 0.6005363274486615
Validation normalized_cm: [[0.75  0.227 0.019 0.004]
 [0.747 0.248 0.006 0.   ]
 [0.715 0.243 0.032 0.01 ]
 [0.612 0.326 0.058 0.004]]
Validation acc: 0.45681818181818185
Validation class_accuracies: [0.7496823379923762, 0.24767441860465117, 0.03217821782178218, 0.004132231404958678]
Validation sensitivity: 0.150730411686587
Validation specificity: 0.7496823379923762
Validation icbhi_score: 0.45020637483948156
Validation roc_auc: None
Validation avg_accuracy: 0.2584168014559421
Validation one_indexed_epoch: 1
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 522s - loss: 0.5909 - accuracy: 0.4841 - 522s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 2/100
Validation cm: [[2411    4    8    1]
 [  60    0    0    0]
 [ 280    0   42    2]
 [  73    8    9   14]]
Validation val_loss: 0.2593676349051623
Validation normalized_cm: [[9.946e-01 1.650e-03 3.300e-03 4.125e-04]
 [1.000e+00 0.000e+00 0.000e+00 0.000e+00]
 [8.642e-01 0.000e+00 1.296e-01 6.173e-03]
 [7.019e-01 7.692e-02 8.654e-02 1.346e-01]]
Validation acc: 0.8471840659340659
Validation class_accuracies: [0.9946369636963697, 0.0, 0.12962962962962962, 0.1346153846153846]
Validation sensitivity: 0.11475409836065574
Validation specificity: 0.9946369636963697
Validation icbhi_score: 0.5546955310285127
Validation roc_auc: None
Validation avg_accuracy: 0.31472049448534595
Validation one_indexed_epoch: 2
Validation cm: [[1392  100   52   30]
 [ 783   69    4    4]
 [ 353   34   12    5]
 [ 209   25    3    5]]
Validation val_loss: 0.6096958601399772
Validation normalized_cm: [[0.884 0.064 0.033 0.019]
 [0.91  0.08  0.005 0.005]
 [0.874 0.084 0.03  0.012]
 [0.864 0.103 0.012 0.021]]
Validation acc: 0.4798701298701299
Validation class_accuracies: [0.8843710292249047, 0.08023255813953488, 0.0297029702970297, 0.02066115702479339]
Validation sensitivity: 0.057104913678618856
Validation specificity: 0.8843710292249047
Validation icbhi_score: 0.47073797145176177
Validation roc_auc: None
Validation avg_accuracy: 0.2537419286715657
Validation one_indexed_epoch: 2
-----------------------------
The validation tracker metric at 0.5638356868473733 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 524s - loss: 0.4633 - accuracy: 0.5352 - 524s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 3/100
Validation cm: [[2055    8  349   12]
 [  40    6    9    5]
 [  55    0  269    0]
 [   9    2   57   36]]
Validation val_loss: 0.31344371397392534
Validation normalized_cm: [[0.848 0.003 0.144 0.005]
 [0.667 0.1   0.15  0.083]
 [0.17  0.    0.83  0.   ]
 [0.087 0.019 0.548 0.346]]
Validation acc: 0.8125
Validation class_accuracies: [0.8477722772277227, 0.1, 0.8302469135802469, 0.34615384615384615]
Validation sensitivity: 0.6372950819672131
Validation specificity: 0.8477722772277227
Validation icbhi_score: 0.742533679597468
Validation roc_auc: None
Validation avg_accuracy: 0.5310432592404539
Validation one_indexed_epoch: 3
Validation cm: [[696 317 403 158]
 [263 242 146 209]
 [ 93  27 236  48]
 [ 54  19 113  56]]
Validation val_loss: 0.8829786706737273
Validation normalized_cm: [[0.442 0.201 0.256 0.1  ]
 [0.306 0.281 0.17  0.243]
 [0.23  0.067 0.584 0.119]
 [0.223 0.079 0.467 0.231]]
Validation acc: 0.39935064935064934
Validation class_accuracies: [0.44218551461245237, 0.2813953488372093, 0.5841584158415841, 0.23140495867768596]
Validation sensitivity: 0.3545816733067729
Validation specificity: 0.44218551461245237
Validation icbhi_score: 0.39838359395961265
Validation roc_auc: None
Validation avg_accuracy: 0.384786059492233
Validation one_indexed_epoch: 3
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.47073797145176177 hasn't increased by 0 in 1 epochs
-----------------------------
257/257 - 526s - loss: 0.4025 - accuracy: 0.5221 - 526s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 4/100
Validation cm: [[1721   70  340  293]
 [  20    3    6   31]
 [  45    6  215   58]
 [   3    0   46   55]]
Validation val_loss: 0.6553878464472597
Validation normalized_cm: [[0.71  0.029 0.14  0.121]
 [0.333 0.05  0.1   0.517]
 [0.139 0.019 0.664 0.179]
 [0.029 0.    0.442 0.529]]
Validation acc: 0.6847527472527473
Validation class_accuracies: [0.709983498349835, 0.05, 0.6635802469135802, 0.5288461538461539]
Validation sensitivity: 0.5594262295081968
Validation specificity: 0.709983498349835
Validation icbhi_score: 0.6347048639290158
Validation roc_auc: None
Validation avg_accuracy: 0.4881024747773922
Validation one_indexed_epoch: 4
Validation cm: [[413 352 647 162]
 [175 281 300 104]
 [ 23  31 303  47]
 [ 27  18 163  34]]
Validation val_loss: 1.09092009106149
Validation normalized_cm: [[0.262 0.224 0.411 0.103]
 [0.203 0.327 0.349 0.121]
 [0.057 0.077 0.75  0.116]
 [0.112 0.074 0.674 0.14 ]]
Validation acc: 0.3347402597402597
Validation class_accuracies: [0.2623888182973316, 0.3267441860465116, 0.75, 0.14049586776859505]
Validation sensitivity: 0.4103585657370518
Validation specificity: 0.2623888182973316
Validation icbhi_score: 0.3363736920171917
Validation roc_auc: None
Validation avg_accuracy: 0.36990721802810955
Validation one_indexed_epoch: 4
-----------------------------
The validation tracker metric at 0.742533679597468 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47073797145176177 hasn't increased by 0 in 2 epochs
-----------------------------
257/257 - 520s - loss: 0.3430 - accuracy: 0.4942 - 520s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 5/100
Validation cm: [[2307   10   90   17]
 [  48   10    2    0]
 [ 217    5   83   19]
 [  18    2   34   50]]
Validation val_loss: 0.2386923997055768
Validation normalized_cm: [[0.952 0.004 0.037 0.007]
 [0.8   0.167 0.033 0.   ]
 [0.67  0.015 0.256 0.059]
 [0.173 0.019 0.327 0.481]]
Validation acc: 0.8413461538461539
Validation class_accuracies: [0.9517326732673267, 0.16666666666666666, 0.25617283950617287, 0.4807692307692308]
Validation sensitivity: 0.2930327868852459
Validation specificity: 0.9517326732673267
Validation icbhi_score: 0.6223827300762863
Validation roc_auc: None
Validation avg_accuracy: 0.46383535255234926
Validation one_indexed_epoch: 5
Validation cm: [[842  67 661   4]
 [358 136 362   4]
 [142   0 261   1]
 [ 89   1 147   5]]
Validation val_loss: 0.9791941979755523
Validation normalized_cm: [[0.535 0.043 0.42  0.003]
 [0.416 0.158 0.421 0.005]
 [0.351 0.    0.646 0.002]
 [0.368 0.004 0.607 0.021]]
Validation acc: 0.4038961038961039
Validation class_accuracies: [0.5349428208386277, 0.15813953488372093, 0.6460396039603961, 0.02066115702479339]
Validation sensitivity: 0.26693227091633465
Validation specificity: 0.5349428208386277
Validation icbhi_score: 0.40093754587748115
Validation roc_auc: None
Validation avg_accuracy: 0.3399457791768845
Validation one_indexed_epoch: 5
-----------------------------
The validation tracker metric at 0.742533679597468 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47073797145176177 hasn't increased by 0 in 3 epochs
-----------------------------
257/257 - 517s - loss: 0.2844 - accuracy: 0.5044 - 517s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 6/100
Validation cm: [[1934  119  346   25]
 [  29   15    7    9]
 [  56    7  259    2]
 [   6    2   60   36]]
Validation val_loss: 0.3396226274006469
Validation normalized_cm: [[0.798 0.049 0.143 0.01 ]
 [0.483 0.25  0.117 0.15 ]
 [0.173 0.022 0.799 0.006]
 [0.058 0.019 0.577 0.346]]
Validation acc: 0.7706043956043956
Validation class_accuracies: [0.7978547854785478, 0.25, 0.7993827160493827, 0.34615384615384615]
Validation sensitivity: 0.6352459016393442
Validation specificity: 0.7978547854785478
Validation icbhi_score: 0.716550343558946
Validation roc_auc: None
Validation avg_accuracy: 0.5483478369204442
Validation one_indexed_epoch: 6
Validation cm: [[474 240 718 142]
 [228 296 226 110]
 [ 46  13 268  77]
 [ 30   9 153  50]]
Validation val_loss: 0.9783626350092659
Validation normalized_cm: [[0.301 0.152 0.456 0.09 ]
 [0.265 0.344 0.263 0.128]
 [0.114 0.032 0.663 0.191]
 [0.124 0.037 0.632 0.207]]
Validation acc: 0.35324675324675325
Validation class_accuracies: [0.301143583227446, 0.34418604651162793, 0.6633663366336634, 0.2066115702479339]
Validation sensitivity: 0.4077025232403719
Validation specificity: 0.301143583227446
Validation icbhi_score: 0.35442305323390894
Validation roc_auc: None
Validation avg_accuracy: 0.3788268841551678
Validation one_indexed_epoch: 6
-----------------------------
The validation tracker metric at 0.742533679597468 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47073797145176177 hasn't increased by 0 in 4 epochs
-----------------------------
257/257 - 513s - loss: 0.2519 - accuracy: 0.4747 - 513s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 7/100
Validation cm: [[1826  349   55  194]
 [  18   20    0   22]
 [ 113   23  144   44]
 [   6    5   55   38]]
Validation val_loss: 0.6922800775001611
Validation normalized_cm: [[0.753 0.144 0.023 0.08 ]
 [0.3   0.333 0.    0.367]
 [0.349 0.071 0.444 0.136]
 [0.058 0.048 0.529 0.365]]
Validation acc: 0.6964285714285714
Validation class_accuracies: [0.7533003300330033, 0.3333333333333333, 0.4444444444444444, 0.36538461538461536]
Validation sensitivity: 0.4139344262295082
Validation specificity: 0.7533003300330033
Validation icbhi_score: 0.5836173781312558
Validation roc_auc: None
Validation avg_accuracy: 0.47411568079884914
Validation one_indexed_epoch: 7
Validation cm: [[590 693 185 106]
 [227 604  12  17]
 [154 128  77  45]
 [ 92  74  31  45]]
Validation val_loss: 0.8257361925773682
Validation normalized_cm: [[0.375 0.44  0.118 0.067]
 [0.264 0.702 0.014 0.02 ]
 [0.381 0.317 0.191 0.111]
 [0.38  0.306 0.128 0.186]]
Validation acc: 0.42727272727272725
Validation class_accuracies: [0.3748411689961881, 0.7023255813953488, 0.1905940594059406, 0.1859504132231405]
Validation sensitivity: 0.4820717131474104
Validation specificity: 0.3748411689961881
Validation icbhi_score: 0.42845644107179925
Validation roc_auc: None
Validation avg_accuracy: 0.3634278057551545
Validation one_indexed_epoch: 7
-----------------------------
The validation tracker metric at 0.742533679597468 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47073797145176177 hasn't increased by 0 in 5 epochs
-----------------------------
257/257 - 510s - loss: 0.2249 - accuracy: 0.4732 - 510s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 8/100
Validation cm: [[2296    9   99   20]
 [  48    8    4    0]
 [ 109    1  212    2]
 [  23    3   69    9]]
Validation val_loss: 0.30078692858200134
Validation normalized_cm: [[0.947 0.004 0.041 0.008]
 [0.8   0.133 0.067 0.   ]
 [0.336 0.003 0.654 0.006]
 [0.221 0.029 0.663 0.087]]
Validation acc: 0.8671016483516484
Validation class_accuracies: [0.9471947194719472, 0.13333333333333333, 0.654320987654321, 0.08653846153846154]
Validation sensitivity: 0.4692622950819672
Validation specificity: 0.9471947194719472
Validation icbhi_score: 0.7082285072769572
Validation roc_auc: None
Validation avg_accuracy: 0.45534687549951575
Validation one_indexed_epoch: 8
Validation cm: [[879 337 350   8]
 [371 433  52   4]
 [140  65 193   6]
 [ 85  29 121   7]]
Validation val_loss: 0.8757870859115121
Validation normalized_cm: [[0.558 0.214 0.222 0.005]
 [0.431 0.503 0.06  0.005]
 [0.347 0.161 0.478 0.015]
 [0.351 0.12  0.5   0.029]]
Validation acc: 0.4909090909090909
Validation class_accuracies: [0.5584498094027954, 0.5034883720930232, 0.4777227722772277, 0.028925619834710745]
Validation sensitivity: 0.4203187250996016
Validation specificity: 0.5584498094027954
Validation icbhi_score: 0.48938426725119855
Validation roc_auc: None
Validation avg_accuracy: 0.3921466434019393
Validation one_indexed_epoch: 8
-----------------------------
The validation tracker metric at 0.742533679597468 hasn't increased by 0 in 5 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 508s - loss: 0.1923 - accuracy: 0.4779 - 508s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 9/100
Validation cm: [[2251   26  123   24]
 [  42   14    2    2]
 [ 102    3  193   26]
 [  11    5   54   34]]
Validation val_loss: 0.30698744101293196
Validation normalized_cm: [[0.929 0.011 0.051 0.01 ]
 [0.7   0.233 0.033 0.033]
 [0.315 0.009 0.596 0.08 ]
 [0.106 0.048 0.519 0.327]]
Validation acc: 0.8557692307692307
Validation class_accuracies: [0.9286303630363036, 0.23333333333333334, 0.595679012345679, 0.3269230769230769]
Validation sensitivity: 0.49385245901639346
Validation specificity: 0.9286303630363036
Validation icbhi_score: 0.7112414110263485
Validation roc_auc: None
Validation avg_accuracy: 0.5211414464095983
Validation one_indexed_epoch: 9
Validation cm: [[485 433 468 188]
 [144 398 110 208]
 [ 27  39 242  96]
 [ 18  28 136  60]]
Validation val_loss: 0.9816253379970258
Validation normalized_cm: [[0.308 0.275 0.297 0.119]
 [0.167 0.463 0.128 0.242]
 [0.067 0.097 0.599 0.238]
 [0.074 0.116 0.562 0.248]]
Validation acc: 0.3847402597402597
Validation class_accuracies: [0.30813214739517153, 0.4627906976744186, 0.599009900990099, 0.24793388429752067]
Validation sensitivity: 0.4648074369189907
Validation specificity: 0.30813214739517153
Validation icbhi_score: 0.3864697921570811
Validation roc_auc: None
Validation avg_accuracy: 0.40446665758930245
Validation one_indexed_epoch: 9
-----------------------------
The validation tracker metric at 0.742533679597468 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0012499999720603228
-----------------------------
-----------------------------
The validation tracker metric at 0.48938426725119855 hasn't increased by 0 in 1 epochs
-----------------------------
257/257 - 508s - loss: 0.1591 - accuracy: 0.4675 - 508s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 10/100
Validation cm: [[2151    5  242   26]
 [  44    7    7    2]
 [  57    0  263    4]
 [   7    3   47   47]]
Validation val_loss: 0.33087584888739957
Validation normalized_cm: [[0.887 0.002 0.1   0.011]
 [0.733 0.117 0.117 0.033]
 [0.176 0.    0.812 0.012]
 [0.067 0.029 0.452 0.452]]
Validation acc: 0.8475274725274725
Validation class_accuracies: [0.8873762376237624, 0.11666666666666667, 0.8117283950617284, 0.4519230769230769]
Validation sensitivity: 0.6495901639344263
Validation specificity: 0.8873762376237624
Validation icbhi_score: 0.7684832007790943
Validation roc_auc: None
Validation avg_accuracy: 0.5669235940688087
Validation one_indexed_epoch: 10
Validation cm: [[375 773 282 144]
 [122 650  39  49]
 [ 54  99 127 124]
 [ 22  57  51 112]]
Validation val_loss: 1.0801239812433339
Validation normalized_cm: [[0.238 0.491 0.179 0.091]
 [0.142 0.756 0.045 0.057]
 [0.134 0.245 0.314 0.307]
 [0.091 0.236 0.211 0.463]]
Validation acc: 0.4103896103896104
Validation class_accuracies: [0.23824650571791614, 0.7558139534883721, 0.31435643564356436, 0.4628099173553719]
Validation sensitivity: 0.5903054448871182
Validation specificity: 0.23824650571791614
Validation icbhi_score: 0.4142759753025172
Validation roc_auc: None
Validation avg_accuracy: 0.44280670305130615
Validation one_indexed_epoch: 10
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.48938426725119855 hasn't increased by 0 in 2 epochs
-----------------------------
257/257 - 503s - loss: 0.1072 - accuracy: 0.4722 - 503s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 11/100
Validation cm: [[2261   19  121   23]
 [  44   10    2    4]
 [  80    0  237    7]
 [   8    5   45   46]]
Validation val_loss: 0.3140166851658527
Validation normalized_cm: [[0.933 0.008 0.05  0.009]
 [0.733 0.167 0.033 0.067]
 [0.247 0.    0.731 0.022]
 [0.077 0.048 0.433 0.442]]
Validation acc: 0.8770604395604396
Validation class_accuracies: [0.9327557755775577, 0.16666666666666666, 0.7314814814814815, 0.4423076923076923]
Validation sensitivity: 0.6004098360655737
Validation specificity: 0.9327557755775577
Validation icbhi_score: 0.7665828058215658
Validation roc_auc: None
Validation avg_accuracy: 0.5683029040083496
Validation one_indexed_epoch: 11
Validation cm: [[843 318 347  66]
 [384 369  74  33]
 [106  36 190  72]
 [ 57  22  90  73]]
Validation val_loss: 1.0047846395183408
Validation normalized_cm: [[0.536 0.202 0.22  0.042]
 [0.447 0.429 0.086 0.038]
 [0.262 0.089 0.47  0.178]
 [0.236 0.091 0.372 0.302]]
Validation acc: 0.4788961038961039
Validation class_accuracies: [0.5355781448538754, 0.4290697674418605, 0.47029702970297027, 0.30165289256198347]
Validation sensitivity: 0.4196547144754316
Validation specificity: 0.5355781448538754
Validation icbhi_score: 0.47761642966465356
Validation roc_auc: None
Validation avg_accuracy: 0.4341494586401724
Validation one_indexed_epoch: 11
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.48938426725119855 hasn't increased by 0 in 3 epochs
-----------------------------
257/257 - 503s - loss: 0.0701 - accuracy: 0.4679 - 503s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 12/100
Validation cm: [[2308   16   80   20]
 [  47   11    1    1]
 [  92    0  228    4]
 [  10    5   46   43]]
Validation val_loss: 0.3279909362225004
Validation normalized_cm: [[0.952 0.007 0.033 0.008]
 [0.783 0.183 0.017 0.017]
 [0.284 0.    0.704 0.012]
 [0.096 0.048 0.442 0.413]]
Validation acc: 0.8894230769230769
Validation class_accuracies: [0.9521452145214522, 0.18333333333333332, 0.7037037037037037, 0.41346153846153844]
Validation sensitivity: 0.5778688524590164
Validation specificity: 0.9521452145214522
Validation icbhi_score: 0.7650070334902344
Validation roc_auc: None
Validation avg_accuracy: 0.5631609475050069
Validation one_indexed_epoch: 12
Validation cm: [[584 583 313  94]
 [219 558  45  38]
 [ 67  82 151 104]
 [ 49  39  68  86]]
Validation val_loss: 1.232999432044607
Validation normalized_cm: [[0.371 0.37  0.199 0.06 ]
 [0.255 0.649 0.052 0.044]
 [0.166 0.203 0.374 0.257]
 [0.202 0.161 0.281 0.355]]
Validation acc: 0.44772727272727275
Validation class_accuracies: [0.3710292249047014, 0.6488372093023256, 0.37376237623762376, 0.35537190082644626]
Validation sensitivity: 0.5278884462151394
Validation specificity: 0.3710292249047014
Validation icbhi_score: 0.4494588355599204
Validation roc_auc: None
Validation avg_accuracy: 0.4372501778177742
Validation one_indexed_epoch: 12
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.48938426725119855 hasn't increased by 0 in 4 epochs
-----------------------------
257/257 - 503s - loss: 0.0571 - accuracy: 0.4632 - 503s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 13/100
Validation cm: [[2317   19   71   17]
 [  48   10    0    2]
 [  97    1  223    3]
 [  10    8   47   39]]
Validation val_loss: 0.35824692769441363
Validation normalized_cm: [[0.956 0.008 0.029 0.007]
 [0.8   0.167 0.    0.033]
 [0.299 0.003 0.688 0.009]
 [0.096 0.077 0.452 0.375]]
Validation acc: 0.8890796703296703
Validation class_accuracies: [0.9558580858085809, 0.16666666666666666, 0.6882716049382716, 0.375]
Validation sensitivity: 0.5573770491803278
Validation specificity: 0.9558580858085809
Validation icbhi_score: 0.7566175674944544
Validation roc_auc: None
Validation avg_accuracy: 0.5464490893533798
Validation one_indexed_epoch: 13
Validation cm: [[763 400 341  70]
 [289 479  65  27]
 [106  43 182  73]
 [ 62  25  86  69]]
Validation val_loss: 1.149003503193771
Validation normalized_cm: [[0.485 0.254 0.217 0.044]
 [0.336 0.557 0.076 0.031]
 [0.262 0.106 0.45  0.181]
 [0.256 0.103 0.355 0.285]]
Validation acc: 0.48474025974025975
Validation class_accuracies: [0.48475222363405335, 0.5569767441860465, 0.4504950495049505, 0.28512396694214875]
Validation sensitivity: 0.4847277556440903
Validation specificity: 0.48475222363405335
Validation icbhi_score: 0.48473998963907183
Validation roc_auc: None
Validation avg_accuracy: 0.44433699606679977
Validation one_indexed_epoch: 13
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.48938426725119855 hasn't increased by 0 in 5 epochs
-----------------------------
257/257 - 502s - loss: 0.0494 - accuracy: 0.4698 - 502s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 14/100
Validation cm: [[2331   17   59   17]
 [  46   11    2    1]
 [ 100    0  219    5]
 [  10    6   46   42]]
Validation val_loss: 0.3612849946957149
Validation normalized_cm: [[0.962 0.007 0.024 0.007]
 [0.767 0.183 0.033 0.017]
 [0.309 0.    0.676 0.015]
 [0.096 0.058 0.442 0.404]]
Validation acc: 0.8938873626373627
Validation class_accuracies: [0.9616336633663366, 0.18333333333333332, 0.6759259259259259, 0.40384615384615385]
Validation sensitivity: 0.5573770491803278
Validation specificity: 0.9616336633663366
Validation icbhi_score: 0.7595053562733323
Validation roc_auc: None
Validation avg_accuracy: 0.5561847691179373
Validation one_indexed_epoch: 14
Validation cm: [[751 469 290  64]
 [290 501  46  23]
 [105  62 165  72]
 [ 58  35  77  72]]
Validation val_loss: 1.3263263739377749
Validation normalized_cm: [[0.477 0.298 0.184 0.041]
 [0.337 0.583 0.053 0.027]
 [0.26  0.153 0.408 0.178]
 [0.24  0.145 0.318 0.298]]
Validation acc: 0.48344155844155845
Validation class_accuracies: [0.4771283354510801, 0.5825581395348837, 0.4084158415841584, 0.2975206611570248]
Validation sensitivity: 0.4900398406374502
Validation specificity: 0.4771283354510801
Validation icbhi_score: 0.4835840880442651
Validation roc_auc: None
Validation avg_accuracy: 0.4414057444317867
Validation one_indexed_epoch: 14
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.48938426725119855 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0003124999930150807
-----------------------------
257/257 - 500s - loss: 0.0397 - accuracy: 0.4759 - 500s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 15/100
Validation cm: [[2313   16   78   17]
 [  45   11    2    2]
 [  93    0  227    4]
 [   9    5   47   43]]
Validation val_loss: 0.36991695604144326
Validation normalized_cm: [[0.954 0.007 0.032 0.007]
 [0.75  0.183 0.033 0.033]
 [0.287 0.    0.701 0.012]
 [0.087 0.048 0.452 0.413]]
Validation acc: 0.8907967032967034
Validation class_accuracies: [0.9542079207920792, 0.18333333333333332, 0.7006172839506173, 0.41346153846153844]
Validation sensitivity: 0.5758196721311475
Validation specificity: 0.9542079207920792
Validation icbhi_score: 0.7650137964616133
Validation roc_auc: None
Validation avg_accuracy: 0.5629050191343921
Validation one_indexed_epoch: 15
Validation cm: [[800 398 313  63]
 [311 469  56  24]
 [107  49 175  73]
 [ 65  27  79  71]]
Validation val_loss: 1.3156697191087758
Validation normalized_cm: [[0.508 0.253 0.199 0.04 ]
 [0.362 0.545 0.065 0.028]
 [0.265 0.121 0.433 0.181]
 [0.269 0.112 0.326 0.293]]
Validation acc: 0.49188311688311687
Validation class_accuracies: [0.5082592121982211, 0.5453488372093023, 0.43316831683168316, 0.29338842975206614]
Validation sensitivity: 0.4747675962815405
Validation specificity: 0.5082592121982211
Validation icbhi_score: 0.4915134042398808
Validation roc_auc: None
Validation avg_accuracy: 0.4450411989978182
Validation one_indexed_epoch: 15
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 5 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 501s - loss: 0.0337 - accuracy: 0.4705 - 501s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 16/100
Validation cm: [[2309   16   84   15]
 [  46   10    2    2]
 [  92    0  228    4]
 [   9    5   48   42]]
Validation val_loss: 0.3780293040305785
Validation normalized_cm: [[0.953 0.007 0.035 0.006]
 [0.767 0.167 0.033 0.033]
 [0.284 0.    0.704 0.012]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8890796703296703
Validation class_accuracies: [0.9525577557755776, 0.16666666666666666, 0.7037037037037037, 0.40384615384615385]
Validation sensitivity: 0.5737704918032787
Validation specificity: 0.9525577557755776
Validation icbhi_score: 0.7631641237894281
Validation roc_auc: None
Validation avg_accuracy: 0.5566935699980254
Validation one_indexed_epoch: 16
Validation cm: [[774 435 303  62]
 [296 487  55  22]
 [109  51 168  76]
 [ 61  28  81  72]]
Validation val_loss: 1.3589607942404989
Validation normalized_cm: [[0.492 0.276 0.193 0.039]
 [0.344 0.566 0.064 0.026]
 [0.27  0.126 0.416 0.188]
 [0.252 0.116 0.335 0.298]]
Validation acc: 0.48733766233766235
Validation class_accuracies: [0.49174078780177893, 0.5662790697674419, 0.4158415841584158, 0.2975206611570248]
Validation sensitivity: 0.48273572377158036
Validation specificity: 0.49174078780177893
Validation icbhi_score: 0.4872382557866797
Validation roc_auc: None
Validation avg_accuracy: 0.4428455257211653
Validation one_indexed_epoch: 16
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 7.812499825377017e-05
-----------------------------
-----------------------------
The validation tracker metric at 0.4915134042398808 hasn't increased by 0 in 1 epochs
-----------------------------
257/257 - 505s - loss: 0.0310 - accuracy: 0.4703 - 505s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 17/100
Validation cm: [[2314   15   81   14]
 [  47    9    2    2]
 [  94    0  225    5]
 [   9    5   48   42]]
Validation val_loss: 0.3744787509391578
Validation normalized_cm: [[0.955 0.006 0.033 0.006]
 [0.783 0.15  0.033 0.033]
 [0.29  0.    0.694 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8894230769230769
Validation class_accuracies: [0.9546204620462047, 0.15, 0.6944444444444444, 0.40384615384615385]
Validation sensitivity: 0.5655737704918032
Validation specificity: 0.9546204620462047
Validation icbhi_score: 0.760097116269004
Validation roc_auc: None
Validation avg_accuracy: 0.5507277650842007
Validation one_indexed_epoch: 17
Validation cm: [[805 420 290  59]
 [312 478  53  17]
 [112  48 172  72]
 [ 67  27  77  71]]
Validation val_loss: 1.3384261691847716
Validation normalized_cm: [[0.511 0.267 0.184 0.037]
 [0.363 0.556 0.062 0.02 ]
 [0.277 0.119 0.426 0.178]
 [0.277 0.112 0.318 0.293]]
Validation acc: 0.4954545454545455
Validation class_accuracies: [0.51143583227446, 0.5558139534883721, 0.42574257425742573, 0.29338842975206614]
Validation sensitivity: 0.47875166002656044
Validation specificity: 0.51143583227446
Validation icbhi_score: 0.4950937461505102
Validation roc_auc: None
Validation avg_accuracy: 0.44659519744308096
Validation one_indexed_epoch: 17
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 7 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 505s - loss: 0.0304 - accuracy: 0.4695 - 505s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 18/100
Validation cm: [[2312   14   84   14]
 [  47    9    2    2]
 [  94    0  225    5]
 [   9    5   48   42]]
Validation val_loss: 0.37485699388950094
Validation normalized_cm: [[0.954 0.006 0.035 0.006]
 [0.783 0.15  0.033 0.033]
 [0.29  0.    0.694 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8887362637362637
Validation class_accuracies: [0.9537953795379538, 0.15, 0.6944444444444444, 0.40384615384615385]
Validation sensitivity: 0.5655737704918032
Validation specificity: 0.9537953795379538
Validation icbhi_score: 0.7596845750148785
Validation roc_auc: None
Validation avg_accuracy: 0.550521494457138
Validation one_indexed_epoch: 18
Validation cm: [[808 401 306  59]
 [324 462  55  19]
 [112  46 172  74]
 [ 66  24  80  72]]
Validation val_loss: 1.3621410876158822
Validation normalized_cm: [[0.513 0.255 0.194 0.037]
 [0.377 0.537 0.064 0.022]
 [0.277 0.114 0.426 0.183]
 [0.273 0.099 0.331 0.298]]
Validation acc: 0.4915584415584416
Validation class_accuracies: [0.5133418043202033, 0.5372093023255814, 0.42574257425742573, 0.2975206611570248]
Validation sensitivity: 0.46879150066401065
Validation specificity: 0.5133418043202033
Validation icbhi_score: 0.49106665249210696
Validation roc_auc: None
Validation avg_accuracy: 0.44345358551505876
Validation one_indexed_epoch: 18
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 8 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4950937461505102 hasn't increased by 0 in 1 epochs
-----------------------------
257/257 - 503s - loss: 0.0293 - accuracy: 0.4698 - 503s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 19/100
Validation cm: [[2319   14   76   15]
 [  46   10    2    2]
 [  98    0  221    5]
 [   9    5   48   42]]
Validation val_loss: 0.37457818402481996
Validation normalized_cm: [[0.957 0.006 0.031 0.006]
 [0.767 0.167 0.033 0.033]
 [0.302 0.    0.682 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8901098901098901
Validation class_accuracies: [0.9566831683168316, 0.16666666666666666, 0.6820987654320988, 0.40384615384615385]
Validation sensitivity: 0.5594262295081968
Validation specificity: 0.9566831683168316
Validation icbhi_score: 0.7580546989125142
Validation roc_auc: None
Validation avg_accuracy: 0.5523236885654377
Validation one_indexed_epoch: 19
Validation cm: [[838 392 288  56]
 [335 456  51  18]
 [118  46 173  67]
 [ 71  24  78  69]]
Validation val_loss: 1.3626384012077581
Validation normalized_cm: [[0.532 0.249 0.183 0.036]
 [0.39  0.53  0.059 0.021]
 [0.292 0.114 0.428 0.166]
 [0.293 0.099 0.322 0.285]]
Validation acc: 0.4987012987012987
Validation class_accuracies: [0.5324015247776366, 0.5302325581395348, 0.4282178217821782, 0.28512396694214875]
Validation sensitivity: 0.4634794156706507
Validation specificity: 0.5324015247776366
Validation icbhi_score: 0.49794047022414367
Validation roc_auc: None
Validation avg_accuracy: 0.4439939679103746
Validation one_indexed_epoch: 19
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 9 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 502s - loss: 0.0282 - accuracy: 0.4720 - 502s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 20/100
Validation cm: [[2315   14   80   15]
 [  47    9    2    2]
 [  98    0  221    5]
 [   9    5   48   42]]
Validation val_loss: 0.3757592942280178
Validation normalized_cm: [[0.955 0.006 0.033 0.006]
 [0.783 0.15  0.033 0.033]
 [0.302 0.    0.682 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8883928571428571
Validation class_accuracies: [0.95503300330033, 0.15, 0.6820987654320988, 0.40384615384615385]
Validation sensitivity: 0.5573770491803278
Validation specificity: 0.95503300330033
Validation icbhi_score: 0.7562050262403289
Validation roc_auc: None
Validation avg_accuracy: 0.5477444806446456
Validation one_indexed_epoch: 20
Validation cm: [[812 409 292  61]
 [308 476  56  20]
 [109  51 169  75]
 [ 66  26  77  73]]
Validation val_loss: 1.3794367372117662
Validation normalized_cm: [[0.516 0.26  0.186 0.039]
 [0.358 0.553 0.065 0.023]
 [0.27  0.126 0.418 0.186]
 [0.273 0.107 0.318 0.302]]
Validation acc: 0.4967532467532468
Validation class_accuracies: [0.5158831003811944, 0.5534883720930233, 0.4183168316831683, 0.30165289256198347]
Validation sensitivity: 0.4767596281540505
Validation specificity: 0.5158831003811944
Validation icbhi_score: 0.49632136426762247
Validation roc_auc: None
Validation avg_accuracy: 0.4473352991798424
Validation one_indexed_epoch: 20
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 10 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.49794047022414367 hasn't increased by 0 in 1 epochs
-----------------------------
257/257 - 501s - loss: 0.0288 - accuracy: 0.4666 - 501s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 21/100
Validation cm: [[2318   14   78   14]
 [  46   10    2    2]
 [  98    0  221    5]
 [   9    5   48   42]]
Validation val_loss: 0.37524938310907197
Validation normalized_cm: [[0.956 0.006 0.032 0.006]
 [0.767 0.167 0.033 0.033]
 [0.302 0.    0.682 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8897664835164835
Validation class_accuracies: [0.9562706270627063, 0.16666666666666666, 0.6820987654320988, 0.40384615384615385]
Validation sensitivity: 0.5594262295081968
Validation specificity: 0.9562706270627063
Validation icbhi_score: 0.7578484282854515
Validation roc_auc: None
Validation avg_accuracy: 0.5522205532519063
Validation one_indexed_epoch: 21
Validation cm: [[836 392 287  59]
 [333 457  52  18]
 [113  47 171  73]
 [ 70  25  77  70]]
Validation val_loss: 1.3882978639394197
Validation normalized_cm: [[0.531 0.249 0.182 0.037]
 [0.387 0.531 0.06  0.021]
 [0.28  0.116 0.423 0.181]
 [0.289 0.103 0.318 0.289]]
Validation acc: 0.4980519480519481
Validation class_accuracies: [0.531130876747141, 0.5313953488372093, 0.42326732673267325, 0.2892561983471074]
Validation sensitivity: 0.4634794156706507
Validation specificity: 0.531130876747141
Validation icbhi_score: 0.4973051462088959
Validation roc_auc: None
Validation avg_accuracy: 0.44376243766603274
Validation one_indexed_epoch: 21
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 11 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.49794047022414367 hasn't increased by 0 in 2 epochs
-----------------------------
257/257 - 502s - loss: 0.0276 - accuracy: 0.4650 - 502s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 22/100
Validation cm: [[2317   14   78   15]
 [  47    9    2    2]
 [  98    0  221    5]
 [   9    5   48   42]]
Validation val_loss: 0.37521830311359233
Validation normalized_cm: [[0.956 0.006 0.032 0.006]
 [0.783 0.15  0.033 0.033]
 [0.302 0.    0.682 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8890796703296703
Validation class_accuracies: [0.9558580858085809, 0.15, 0.6820987654320988, 0.40384615384615385]
Validation sensitivity: 0.5573770491803278
Validation specificity: 0.9558580858085809
Validation icbhi_score: 0.7566175674944544
Validation roc_auc: None
Validation avg_accuracy: 0.5479507512717083
Validation one_indexed_epoch: 22
Validation cm: [[834 392 286  62]
 [335 452  53  20]
 [118  47 166  73]
 [ 70  25  75  72]]
Validation val_loss: 1.4077738202446137
Validation normalized_cm: [[0.53  0.249 0.182 0.039]
 [0.39  0.526 0.062 0.023]
 [0.292 0.116 0.411 0.181]
 [0.289 0.103 0.31  0.298]]
Validation acc: 0.4948051948051948
Validation class_accuracies: [0.5298602287166455, 0.5255813953488372, 0.41089108910891087, 0.2975206611570248]
Validation sensitivity: 0.4581673306772908
Validation specificity: 0.5298602287166455
Validation icbhi_score: 0.49401377969696814
Validation roc_auc: None
Validation avg_accuracy: 0.4409633435828546
Validation one_indexed_epoch: 22
-----------------------------
The validation tracker metric at 0.7684832007790943 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 1.9531249563442543e-05
-----------------------------
-----------------------------
The validation tracker metric at 0.49794047022414367 hasn't increased by 0 in 3 epochs
-----------------------------
257/257 - 506s - loss: 0.0280 - accuracy: 0.4655 - 506s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 23/100
Validation cm: [[2317   14   78   15]
 [  47    9    2    2]
 [  98    0  221    5]
 [   9    5   48   42]]
Validation val_loss: 0.376494502844797
Validation normalized_cm: [[0.956 0.006 0.032 0.006]
 [0.783 0.15  0.033 0.033]
 [0.302 0.    0.682 0.015]
 [0.087 0.048 0.462 0.404]]
Validation acc: 0.8890796703296703
Validation class_accuracies: [0.9558580858085809, 0.15, 0.6820987654320988, 0.40384615384615385]
Validation sensitivity: 0.5573770491803278
Validation specificity: 0.9558580858085809
Validation icbhi_score: 0.7566175674944544
Validation roc_auc: None
Validation avg_accuracy: 0.5479507512717083
Validation one_indexed_epoch: 23
Validation cm: [[828 396 291  59]
 [328 459  54  19]
 [115  50 168  71]
 [ 70  25  76  71]]
Validation val_loss: 1.4089100168734077
Validation normalized_cm: [[0.526 0.252 0.185 0.037]
 [0.381 0.534 0.063 0.022]
 [0.285 0.124 0.416 0.176]
 [0.289 0.103 0.314 0.293]]
Validation acc: 0.4954545454545455
Validation class_accuracies: [0.5260482846251588, 0.5337209302325582, 0.4158415841584158, 0.29338842975206614]
Validation sensitivity: 0.4634794156706507
Validation specificity: 0.5260482846251588
Validation icbhi_score: 0.4947638501479048
Validation roc_auc: None
Validation avg_accuracy: 0.44224980719204976
Validation one_indexed_epoch: 23
-----------------------------
The number of epochs since last 1% equals the patience
-----------------------------
-----------------------------
The validation tracker metric at 0.49794047022414367 hasn't increased by 0 in 4 epochs
-----------------------------
257/257 - 521s - loss: 0.0281 - accuracy: 0.4663 - 521s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.7684832007790943
Best cm: [[2151    5  242   26]
 [  44    7    7    2]
 [  57    0  263    4]
 [   7    3   47   47]]
Best val_loss: 0.33087584888739957
Best normalized_cm: [[0.887 0.002 0.1   0.011]
 [0.733 0.117 0.117 0.033]
 [0.176 0.    0.812 0.012]
 [0.067 0.029 0.452 0.452]]
Best acc: 0.8475274725274725
Best class_accuracies: [0.8873762376237624, 0.11666666666666667, 0.8117283950617284, 0.4519230769230769]
Best sensitivity: 0.6495901639344263
Best specificity: 0.8873762376237624
Best roc_auc: None
Best avg_accuracy: 0.5669235940688087
Best one_indexed_epoch: 10
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.49794047022414367
Best cm: [[838 392 288  56]
 [335 456  51  18]
 [118  46 173  67]
 [ 71  24  78  69]]
Best val_loss: 1.3626384012077581
Best normalized_cm: [[0.532 0.249 0.183 0.036]
 [0.39  0.53  0.059 0.021]
 [0.292 0.114 0.428 0.166]
 [0.293 0.099 0.322 0.285]]
Best acc: 0.4987012987012987
Best class_accuracies: [0.5324015247776366, 0.5302325581395348, 0.4282178217821782, 0.28512396694214875]
Best sensitivity: 0.4634794156706507
Best specificity: 0.5324015247776366
Best roc_auc: None
Best avg_accuracy: 0.4439939679103746
Best one_indexed_epoch: 19
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.5909141302108765, 0.4632572531700134, 0.40248993039131165, 0.3429727852344513, 0.28437092900276184, 0.2518552541732788, 0.22494207322597504, 0.19225019216537476, 0.1590983271598816, 0.10723165422677994, 0.07011067867279053, 0.05709364265203476, 0.04943316429853439, 0.03969789668917656, 0.033660028129816055, 0.03095928020775318, 0.030429325997829437, 0.029256075620651245, 0.02819940634071827, 0.028825759887695312, 0.027629336342215538, 0.02797798253595829, 0.02807379700243473], 'accuracy': [0.484100878238678, 0.5352095365524292, 0.5221125483512878, 0.49421295523643494, 0.5043859481811523, 0.47465887665748596, 0.4731968939304352, 0.47788742184638977, 0.467531681060791, 0.47216129302978516, 0.4678971767425537, 0.46320661902427673, 0.46978557109832764, 0.47587719559669495, 0.4704556465148926, 0.4703338146209717, 0.4694809913635254, 0.4698464870452881, 0.47203946113586426, 0.4666179418563843, 0.4650341272354126, 0.46546053886413574, 0.4662524461746216]}
End
####################################
Job id is 3.
len of icbhi
7857
len of train icbhi
4769
len of val icbhi
3080
before icbhi addition
11704
after icbhi addition
16473
-----------------------
--- Final training dataset went from 0 to 16473 elements, with 11825 none's, 1673 crakles, 1938 wheezes and 1037 both ---
--- Final Validation dataset contains 2855 elements, with 2325 none, 24 crackles, 482 wheezes and 24 both ---
Initializing weights...
weights = {0: 0.3482663847780127, 1: 2.461595935445308, 2: 2.125, 3: 3.971311475409836}
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 7, 2048)        23587712  
                                                                 
 global_average_pooling2d_1   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_3 (Dense)             (None, 100)               204900    
                                                                 
 dropout_2 (Dropout)         (None, 100)               0         
                                                                 
 dense_4 (Dense)             (None, 50)                5050      
                                                                 
 dropout_3 (Dropout)         (None, 50)                0         
                                                                 
 dense_5 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_pretrained_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Target metric is icbhi_score
here
There is no such attribute
here2
Epoch 1/100
Validation cm: [[2299    1   25    0]
 [  24    0    0    0]
 [ 298    0  184    0]
 [  24    0    0    0]]
Validation val_loss: 0.3143142520139547
Validation normalized_cm: [[9.888e-01 4.301e-04 1.075e-02 0.000e+00]
 [1.000e+00 0.000e+00 0.000e+00 0.000e+00]
 [6.183e-01 0.000e+00 3.817e-01 0.000e+00]
 [1.000e+00 0.000e+00 0.000e+00 0.000e+00]]
Validation acc: 0.8697022767075306
Validation class_accuracies: [0.9888172043010752, 0.0, 0.3817427385892116, 0.0]
Validation sensitivity: 0.3471698113207547
Validation specificity: 0.9888172043010752
Validation icbhi_score: 0.6679935078109149
Validation roc_auc: None
Validation avg_accuracy: 0.3426399857225717
Validation one_indexed_epoch: 1
Validation cm: [[628 926   7  13]
 [181 678   0   1]
 [129 271   2   2]
 [ 93 149   0   0]]
Validation val_loss: 0.6009726900171924
Validation normalized_cm: [[0.399 0.588 0.004 0.008]
 [0.21  0.788 0.    0.001]
 [0.319 0.671 0.005 0.005]
 [0.384 0.616 0.    0.   ]]
Validation acc: 0.42467532467532465
Validation class_accuracies: [0.39898348157560354, 0.7883720930232558, 0.0049504950495049506, 0.0]
Validation sensitivity: 0.45152722443559096
Validation specificity: 0.39898348157560354
Validation icbhi_score: 0.42525535300559725
Validation roc_auc: None
Validation avg_accuracy: 0.29807651741209107
Validation one_indexed_epoch: 1
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 503s - loss: 0.5811 - accuracy: 0.4934 - 503s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 2/100
Validation cm: [[2279    3   40    3]
 [  24    0    0    0]
 [ 266    1  209    6]
 [  24    0    0    0]]
Validation val_loss: 0.2774437560989037
Validation normalized_cm: [[0.98  0.001 0.017 0.001]
 [1.    0.    0.    0.   ]
 [0.552 0.002 0.434 0.012]
 [1.    0.    0.    0.   ]]
Validation acc: 0.8714535901926445
Validation class_accuracies: [0.9802150537634409, 0.0, 0.4336099585062241, 0.0]
Validation sensitivity: 0.39433962264150946
Validation specificity: 0.9802150537634409
Validation icbhi_score: 0.6872773382024752
Validation roc_auc: None
Validation avg_accuracy: 0.35345625306741624
Validation one_indexed_epoch: 2
Validation cm: [[462 945  51 116]
 [158 688   5   9]
 [114 247  14  29]
 [ 55 161   1  25]]
Validation val_loss: 0.6297739919758849
Validation normalized_cm: [[0.294 0.6   0.032 0.074]
 [0.184 0.8   0.006 0.01 ]
 [0.282 0.611 0.035 0.072]
 [0.227 0.665 0.004 0.103]]
Validation acc: 0.386038961038961
Validation class_accuracies: [0.2935196950444727, 0.8, 0.034653465346534656, 0.10330578512396695]
Validation sensitivity: 0.48273572377158036
Validation specificity: 0.2935196950444727
Validation icbhi_score: 0.38812770940802654
Validation roc_auc: None
Validation avg_accuracy: 0.3078697363787436
Validation one_indexed_epoch: 2
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.42525535300559725 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 496s - loss: 0.4612 - accuracy: 0.5535 - 496s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 3/100
Validation cm: [[1507   89  396  333]
 [  10    2    5    7]
 [  68    2   79  333]
 [   2    3    6   13]]
Validation val_loss: 0.7494176706579214
Validation normalized_cm: [[0.648 0.038 0.17  0.143]
 [0.417 0.083 0.208 0.292]
 [0.141 0.004 0.164 0.691]
 [0.083 0.125 0.25  0.542]]
Validation acc: 0.5607705779334501
Validation class_accuracies: [0.6481720430107527, 0.08333333333333333, 0.16390041493775934, 0.5416666666666666]
Validation sensitivity: 0.17735849056603772
Validation specificity: 0.6481720430107527
Validation icbhi_score: 0.4127652667883952
Validation roc_auc: None
Validation avg_accuracy: 0.35926811448712803
Validation one_indexed_epoch: 3
Validation cm: [[   8 1113  164  289]
 [   1  723   26  110]
 [   0  133   67  204]
 [   0   64   23  155]]
Validation val_loss: 0.9209977064178894
Validation normalized_cm: [[0.005 0.707 0.104 0.184]
 [0.001 0.841 0.03  0.128]
 [0.    0.329 0.166 0.505]
 [0.    0.264 0.095 0.64 ]]
Validation acc: 0.3094155844155844
Validation class_accuracies: [0.005082592121982211, 0.8406976744186047, 0.16584158415841585, 0.640495867768595]
Validation sensitivity: 0.6274900398406374
Validation specificity: 0.005082592121982211
Validation icbhi_score: 0.31628631598130985
Validation roc_auc: None
Validation avg_accuracy: 0.4130294296168994
Validation one_indexed_epoch: 3
-----------------------------
The validation tracker metric at 0.6872773382024752 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.42525535300559725 hasn't increased by 0 in 2 epochs
-----------------------------
258/258 - 497s - loss: 0.3899 - accuracy: 0.5721 - 497s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 4/100
Validation cm: [[1762  205  206  152]
 [  16    6    2    0]
 [ 105    5  341   31]
 [   7    6    2    9]]
Validation val_loss: 0.4089370559850373
Validation normalized_cm: [[0.758 0.088 0.089 0.065]
 [0.667 0.25  0.083 0.   ]
 [0.218 0.01  0.707 0.064]
 [0.292 0.25  0.083 0.375]]
Validation acc: 0.7418563922942206
Validation class_accuracies: [0.7578494623655914, 0.25, 0.7074688796680498, 0.375]
Validation sensitivity: 0.6716981132075471
Validation specificity: 0.7578494623655914
Validation icbhi_score: 0.7147737877865692
Validation roc_auc: None
Validation avg_accuracy: 0.5225795855084103
Validation one_indexed_epoch: 4
Validation cm: [[  15 1219   93  247]
 [   4  808   10   38]
 [   3  219   46  136]
 [   8  122   37   75]]
Validation val_loss: 1.163050780135684
Validation normalized_cm: [[0.01  0.774 0.059 0.157]
 [0.005 0.94  0.012 0.044]
 [0.007 0.542 0.114 0.337]
 [0.033 0.504 0.153 0.31 ]]
Validation acc: 0.3064935064935065
Validation class_accuracies: [0.009529860228716646, 0.9395348837209302, 0.11386138613861387, 0.30991735537190085]
Validation sensitivity: 0.6168658698539177
Validation specificity: 0.009529860228716646
Validation icbhi_score: 0.31319786504131714
Validation roc_auc: None
Validation avg_accuracy: 0.34321087136504036
Validation one_indexed_epoch: 4
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.42525535300559725 hasn't increased by 0 in 3 epochs
-----------------------------
258/258 - 504s - loss: 0.3347 - accuracy: 0.5513 - 504s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 5/100
Validation cm: [[1854  162  199  110]
 [  11    7    2    4]
 [ 131   87  171   93]
 [   2    5    7   10]]
Validation val_loss: 0.3919865429494186
Validation normalized_cm: [[0.797 0.07  0.086 0.047]
 [0.458 0.292 0.083 0.167]
 [0.272 0.18  0.355 0.193]
 [0.083 0.208 0.292 0.417]]
Validation acc: 0.7152364273204904
Validation class_accuracies: [0.7974193548387096, 0.2916666666666667, 0.35477178423236516, 0.4166666666666667]
Validation sensitivity: 0.35471698113207545
Validation specificity: 0.7974193548387096
Validation icbhi_score: 0.5760681679853925
Validation roc_auc: None
Validation avg_accuracy: 0.4651311181011021
Validation one_indexed_epoch: 5
Validation cm: [[ 111 1221   72  170]
 [  16  804    6   34]
 [  15  251   28  110]
 [  24  128    7   83]]
Validation val_loss: 0.9309606892429443
Validation normalized_cm: [[0.071 0.776 0.046 0.108]
 [0.019 0.935 0.007 0.04 ]
 [0.037 0.621 0.069 0.272]
 [0.099 0.529 0.029 0.343]]
Validation acc: 0.33311688311688314
Validation class_accuracies: [0.07052096569250317, 0.9348837209302325, 0.06930693069306931, 0.34297520661157027]
Validation sensitivity: 0.6075697211155379
Validation specificity: 0.07052096569250317
Validation icbhi_score: 0.33904534340402054
Validation roc_auc: None
Validation avg_accuracy: 0.35442170598184386
Validation one_indexed_epoch: 5
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.42525535300559725 hasn't increased by 0 in 4 epochs
-----------------------------
258/258 - 497s - loss: 0.2889 - accuracy: 0.5433 - 497s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 6/100
Validation cm: [[1888  139  156  142]
 [   7   12    2    3]
 [ 128   20  197  137]
 [   3    5    1   15]]
Validation val_loss: 0.41117355957754703
Validation normalized_cm: [[0.812 0.06  0.067 0.061]
 [0.292 0.5   0.083 0.125]
 [0.266 0.041 0.409 0.284]
 [0.125 0.208 0.042 0.625]]
Validation acc: 0.739754816112084
Validation class_accuracies: [0.8120430107526881, 0.5, 0.4087136929460581, 0.625]
Validation sensitivity: 0.4226415094339623
Validation specificity: 0.8120430107526881
Validation icbhi_score: 0.6173422600933252
Validation roc_auc: None
Validation avg_accuracy: 0.5864391759246865
Validation one_indexed_epoch: 6
Validation cm: [[ 224 1008   81  261]
 [  66  733    6   55]
 [  36  152   34  182]
 [  25   93   20  104]]
Validation val_loss: 0.9549904720454444
Validation normalized_cm: [[0.142 0.64  0.051 0.166]
 [0.077 0.852 0.007 0.064]
 [0.089 0.376 0.084 0.45 ]
 [0.103 0.384 0.083 0.43 ]]
Validation acc: 0.3555194805194805
Validation class_accuracies: [0.1423125794155019, 0.8523255813953489, 0.08415841584158416, 0.4297520661157025]
Validation sensitivity: 0.5783532536520585
Validation specificity: 0.1423125794155019
Validation icbhi_score: 0.3603329165337802
Validation roc_auc: None
Validation avg_accuracy: 0.3771371606920344
Validation one_indexed_epoch: 6
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.42525535300559725 hasn't increased by 0 in 5 epochs
-----------------------------
258/258 - 494s - loss: 0.2558 - accuracy: 0.5416 - 494s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 7/100
Validation cm: [[1324  157  809   35]
 [  12    1   11    0]
 [ 104   41  323   14]
 [   1    0   22    1]]
Validation val_loss: 0.4511416088462214
Validation normalized_cm: [[0.569 0.068 0.348 0.015]
 [0.5   0.042 0.458 0.   ]
 [0.216 0.085 0.67  0.029]
 [0.042 0.    0.917 0.042]]
Validation acc: 0.5775831873905429
Validation class_accuracies: [0.5694623655913978, 0.041666666666666664, 0.6701244813278008, 0.041666666666666664]
Validation sensitivity: 0.6132075471698113
Validation specificity: 0.5694623655913978
Validation icbhi_score: 0.5913349563806045
Validation roc_auc: None
Validation avg_accuracy: 0.330730045063133
Validation one_indexed_epoch: 7
Validation cm: [[115 638 524 297]
 [ 43 364 168 285]
 [ 33  54 153 164]
 [ 24  41  77 100]]
Validation val_loss: 0.8957984521150493
Validation normalized_cm: [[0.073 0.405 0.333 0.189]
 [0.05  0.423 0.195 0.331]
 [0.082 0.134 0.379 0.406]
 [0.099 0.169 0.318 0.413]]
Validation acc: 0.23766233766233766
Validation class_accuracies: [0.07306226175349428, 0.4232558139534884, 0.3787128712871287, 0.4132231404958678]
Validation sensitivity: 0.40969455511288183
Validation specificity: 0.07306226175349428
Validation icbhi_score: 0.24137840843318806
Validation roc_auc: None
Validation avg_accuracy: 0.32206352187249476
Validation one_indexed_epoch: 7
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.42525535300559725 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0012499999720603228
-----------------------------
258/258 - 492s - loss: 0.2203 - accuracy: 0.5507 - 492s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 8/100
Validation cm: [[2092   92  131   10]
 [  13    8    3    0]
 [ 189   46  221   26]
 [   7    6    4    7]]
Validation val_loss: 0.2959476098082027
Validation normalized_cm: [[0.9   0.04  0.056 0.004]
 [0.542 0.333 0.125 0.   ]
 [0.392 0.095 0.459 0.054]
 [0.292 0.25  0.167 0.292]]
Validation acc: 0.8154115586690017
Validation class_accuracies: [0.8997849462365591, 0.3333333333333333, 0.45850622406639, 0.2916666666666667]
Validation sensitivity: 0.44528301886792454
Validation specificity: 0.8997849462365591
Validation icbhi_score: 0.6725339825522418
Validation roc_auc: None
Validation avg_accuracy: 0.4958227925757373
Validation one_indexed_epoch: 8
Validation cm: [[528 673 277  96]
 [196 587  39  38]
 [ 84  87 177  56]
 [ 53  48  83  58]]
Validation val_loss: 0.8860639307386742
Validation normalized_cm: [[0.335 0.428 0.176 0.061]
 [0.228 0.683 0.045 0.044]
 [0.208 0.215 0.438 0.139]
 [0.219 0.198 0.343 0.24 ]]
Validation acc: 0.4383116883116883
Validation class_accuracies: [0.3354510800508259, 0.6825581395348838, 0.4381188118811881, 0.2396694214876033]
Validation sensitivity: 0.545816733067729
Validation specificity: 0.3354510800508259
Validation icbhi_score: 0.4406339065592775
Validation roc_auc: None
Validation avg_accuracy: 0.4239493632386253
Validation one_indexed_epoch: 8
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 498s - loss: 0.1522 - accuracy: 0.5486 - 498s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 9/100
Validation cm: [[2133   65  107   20]
 [  15    7    2    0]
 [ 141   54  145  142]
 [   9    5    5    5]]
Validation val_loss: 0.36578471192948636
Validation normalized_cm: [[0.917 0.028 0.046 0.009]
 [0.625 0.292 0.083 0.   ]
 [0.293 0.112 0.301 0.295]
 [0.375 0.208 0.208 0.208]]
Validation acc: 0.8021015761821366
Validation class_accuracies: [0.9174193548387096, 0.2916666666666667, 0.3008298755186722, 0.20833333333333334]
Validation sensitivity: 0.2962264150943396
Validation specificity: 0.9174193548387096
Validation icbhi_score: 0.6068228849665246
Validation roc_auc: None
Validation avg_accuracy: 0.42956230758934544
Validation one_indexed_epoch: 9
Validation cm: [[466 702 253 153]
 [172 585  35  68]
 [ 61  93 165  85]
 [ 50  43  69  80]]
Validation val_loss: 1.0218967570477004
Validation normalized_cm: [[0.296 0.446 0.161 0.097]
 [0.2   0.68  0.041 0.079]
 [0.151 0.23  0.408 0.21 ]
 [0.207 0.178 0.285 0.331]]
Validation acc: 0.42077922077922075
Validation class_accuracies: [0.2960609911054638, 0.6802325581395349, 0.4084158415841584, 0.3305785123966942]
Validation sensitivity: 0.5511288180610889
Validation specificity: 0.2960609911054638
Validation icbhi_score: 0.42359490458327637
Validation roc_auc: None
Validation avg_accuracy: 0.4288219758064628
Validation one_indexed_epoch: 9
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 5 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4406339065592775 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 501s - loss: 0.0987 - accuracy: 0.5640 - 501s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 10/100
Validation cm: [[2184   44   91    6]
 [  14    8    2    0]
 [ 187   20  220   55]
 [  11    5    4    4]]
Validation val_loss: 0.3477225982027392
Validation normalized_cm: [[0.939 0.019 0.039 0.003]
 [0.583 0.333 0.083 0.   ]
 [0.388 0.041 0.456 0.114]
 [0.458 0.208 0.167 0.167]]
Validation acc: 0.8462346760070053
Validation class_accuracies: [0.9393548387096774, 0.3333333333333333, 0.45643153526970953, 0.16666666666666666]
Validation sensitivity: 0.4377358490566038
Validation specificity: 0.9393548387096774
Validation icbhi_score: 0.6885453438831406
Validation roc_auc: None
Validation avg_accuracy: 0.47394659349484675
Validation one_indexed_epoch: 10
Validation cm: [[579 585 305 105]
 [200 536  51  73]
 [ 74  79 175  76]
 [ 54  39  73  76]]
Validation val_loss: 1.1158752337892666
Validation normalized_cm: [[0.368 0.372 0.194 0.067]
 [0.233 0.623 0.059 0.085]
 [0.183 0.196 0.433 0.188]
 [0.223 0.161 0.302 0.314]]
Validation acc: 0.4435064935064935
Validation class_accuracies: [0.3678526048284625, 0.6232558139534884, 0.43316831683168316, 0.3140495867768595]
Validation sensitivity: 0.5225763612217795
Validation specificity: 0.3678526048284625
Validation icbhi_score: 0.445214483025121
Validation roc_auc: None
Validation avg_accuracy: 0.4345815805976234
Validation one_indexed_epoch: 10
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0003124999930150807
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 504s - loss: 0.0747 - accuracy: 0.5914 - 504s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 11/100
Validation cm: [[2143   57  118    7]
 [  15    7    2    0]
 [ 184   31  237   30]
 [   8    4    6    6]]
Validation val_loss: 0.35587936032919903
Validation normalized_cm: [[0.922 0.025 0.051 0.003]
 [0.625 0.292 0.083 0.   ]
 [0.382 0.064 0.492 0.062]
 [0.333 0.167 0.25  0.25 ]]
Validation acc: 0.8381786339754816
Validation class_accuracies: [0.9217204301075269, 0.2916666666666667, 0.491701244813278, 0.25]
Validation sensitivity: 0.4716981132075472
Validation specificity: 0.9217204301075269
Validation icbhi_score: 0.696709271657537
Validation roc_auc: None
Validation avg_accuracy: 0.4887720853968679
Validation one_indexed_epoch: 11
Validation cm: [[658 524 259 133]
 [258 506  43  53]
 [ 86  69 157  92]
 [ 66  34  59  83]]
Validation val_loss: 1.1460883195428924
Validation normalized_cm: [[0.418 0.333 0.165 0.084]
 [0.3   0.588 0.05  0.062]
 [0.213 0.171 0.389 0.228]
 [0.273 0.14  0.244 0.343]]
Validation acc: 0.45584415584415583
Validation class_accuracies: [0.41804320203303685, 0.5883720930232558, 0.3886138613861386, 0.34297520661157027]
Validation sensitivity: 0.4953519256308101
Validation specificity: 0.41804320203303685
Validation icbhi_score: 0.4566975638319235
Validation roc_auc: None
Validation avg_accuracy: 0.43450109076350035
Validation one_indexed_epoch: 11
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 7 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 494s - loss: 0.0608 - accuracy: 0.5957 - 494s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 12/100
Validation cm: [[2137   53  124   11]
 [  15    7    2    0]
 [ 163   49  197   73]
 [   7    5    6    6]]
Validation val_loss: 0.4023047181981595
Validation normalized_cm: [[0.919 0.023 0.053 0.005]
 [0.625 0.292 0.083 0.   ]
 [0.338 0.102 0.409 0.151]
 [0.292 0.208 0.25  0.25 ]]
Validation acc: 0.8220665499124343
Validation class_accuracies: [0.9191397849462366, 0.2916666666666667, 0.4087136929460581, 0.25]
Validation sensitivity: 0.39622641509433965
Validation specificity: 0.9191397849462366
Validation icbhi_score: 0.6576831000202881
Validation roc_auc: None
Validation avg_accuracy: 0.46738003613974033
Validation one_indexed_epoch: 12
Validation cm: [[587 604 261 122]
 [205 550  43  62]
 [ 77  76 166  85]
 [ 56  40  71  75]]
Validation val_loss: 1.2217367379286632
Validation normalized_cm: [[0.373 0.384 0.166 0.078]
 [0.238 0.64  0.05  0.072]
 [0.191 0.188 0.411 0.21 ]
 [0.231 0.165 0.293 0.31 ]]
Validation acc: 0.4474025974025974
Validation class_accuracies: [0.37293519695044475, 0.6395348837209303, 0.41089108910891087, 0.30991735537190085]
Validation sensitivity: 0.5252324037184595
Validation specificity: 0.37293519695044475
Validation icbhi_score: 0.4490838003344521
Validation roc_auc: None
Validation avg_accuracy: 0.4333196312880466
Validation one_indexed_epoch: 12
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 8 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4566975638319235 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 496s - loss: 0.0528 - accuracy: 0.5913 - 496s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 13/100
Validation cm: [[2184   49   85    7]
 [  15    7    2    0]
 [ 193   34  228   27]
 [   9    6    4    5]]
Validation val_loss: 0.36787036034122
Validation normalized_cm: [[0.939 0.021 0.037 0.003]
 [0.625 0.292 0.083 0.   ]
 [0.4   0.071 0.473 0.056]
 [0.375 0.25  0.167 0.208]]
Validation acc: 0.8490367775831874
Validation class_accuracies: [0.9393548387096774, 0.2916666666666667, 0.4730290456431535, 0.20833333333333334]
Validation sensitivity: 0.4528301886792453
Validation specificity: 0.9393548387096774
Validation icbhi_score: 0.6960925136944613
Validation roc_auc: None
Validation avg_accuracy: 0.4780959710882077
Validation one_indexed_epoch: 13
Validation cm: [[637 562 241 134]
 [247 515  38  60]
 [ 86  81 156  81]
 [ 59  39  69  75]]
Validation val_loss: 1.2283174453774408
Validation normalized_cm: [[0.405 0.357 0.153 0.085]
 [0.287 0.599 0.044 0.07 ]
 [0.213 0.2   0.386 0.2  ]
 [0.244 0.161 0.285 0.31 ]]
Validation acc: 0.44902597402597405
Validation class_accuracies: [0.40470139771283353, 0.5988372093023255, 0.38613861386138615, 0.30991735537190085]
Validation sensitivity: 0.4953519256308101
Validation specificity: 0.40470139771283353
Validation icbhi_score: 0.4500266616718218
Validation roc_auc: None
Validation avg_accuracy: 0.42489864406211153
Validation one_indexed_epoch: 13
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 9 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4566975638319235 hasn't increased by 0 in 2 epochs
-----------------------------
258/258 - 492s - loss: 0.0507 - accuracy: 0.5845 - 492s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 14/100
Validation cm: [[2184   36   99    6]
 [  17    5    2    0]
 [ 195   27  227   33]
 [   8    5    6    5]]
Validation val_loss: 0.3732102179209845
Validation normalized_cm: [[0.939 0.015 0.043 0.003]
 [0.708 0.208 0.083 0.   ]
 [0.405 0.056 0.471 0.068]
 [0.333 0.208 0.25  0.208]]
Validation acc: 0.8479859894921191
Validation class_accuracies: [0.9393548387096774, 0.20833333333333334, 0.470954356846473, 0.20833333333333334]
Validation sensitivity: 0.44716981132075473
Validation specificity: 0.9393548387096774
Validation icbhi_score: 0.6932623250152161
Validation roc_auc: None
Validation avg_accuracy: 0.45674396555570423
Validation one_indexed_epoch: 14
Validation cm: [[690 509 247 128]
 [268 490  37  65]
 [ 91  71 160  82]
 [ 65  32  70  75]]
Validation val_loss: 1.2772718092391648
Validation normalized_cm: [[0.438 0.323 0.157 0.081]
 [0.312 0.57  0.043 0.076]
 [0.225 0.176 0.396 0.203]
 [0.269 0.132 0.289 0.31 ]]
Validation acc: 0.4594155844155844
Validation class_accuracies: [0.4383735705209657, 0.5697674418604651, 0.39603960396039606, 0.30991735537190085]
Validation sensitivity: 0.4814077025232404
Validation specificity: 0.4383735705209657
Validation icbhi_score: 0.45989063652210305
Validation roc_auc: None
Validation avg_accuracy: 0.42852449292843187
Validation one_indexed_epoch: 14
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 10 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 498s - loss: 0.0445 - accuracy: 0.5964 - 498s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 15/100
Validation cm: [[2193   36   92    4]
 [  17    5    2    0]
 [ 212   19  234   17]
 [   9    5    5    5]]
Validation val_loss: 0.37509413684520926
Validation normalized_cm: [[0.943 0.015 0.04  0.002]
 [0.708 0.208 0.083 0.   ]
 [0.44  0.039 0.485 0.035]
 [0.375 0.208 0.208 0.208]]
Validation acc: 0.8535901926444833
Validation class_accuracies: [0.9432258064516129, 0.20833333333333334, 0.4854771784232365, 0.20833333333333334]
Validation sensitivity: 0.46037735849056605
Validation specificity: 0.9432258064516129
Validation icbhi_score: 0.7018015824710895
Validation roc_auc: None
Validation avg_accuracy: 0.461342412885379
Validation one_indexed_epoch: 15
Validation cm: [[727 505 255  87]
 [286 488  39  47]
 [109  69 166  60]
 [ 72  36  72  62]]
Validation val_loss: 1.3144117457578786
Validation normalized_cm: [[0.462 0.321 0.162 0.055]
 [0.333 0.567 0.045 0.055]
 [0.27  0.171 0.411 0.149]
 [0.298 0.149 0.298 0.256]]
Validation acc: 0.4685064935064935
Validation class_accuracies: [0.4618805590851334, 0.5674418604651162, 0.41089108910891087, 0.256198347107438]
Validation sensitivity: 0.4754316069057105
Validation specificity: 0.4618805590851334
Validation icbhi_score: 0.46865608299542194
Validation roc_auc: None
Validation avg_accuracy: 0.42410296394164965
Validation one_indexed_epoch: 15
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 11 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 499s - loss: 0.0421 - accuracy: 0.5973 - 499s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 16/100
Validation cm: [[2180   34  103    8]
 [  16    6    2    0]
 [ 206   25  222   29]
 [   8    4    6    6]]
Validation val_loss: 0.3917304249337127
Validation normalized_cm: [[0.938 0.015 0.044 0.003]
 [0.667 0.25  0.083 0.   ]
 [0.427 0.052 0.461 0.06 ]
 [0.333 0.167 0.25  0.25 ]]
Validation acc: 0.8455341506129597
Validation class_accuracies: [0.9376344086021505, 0.25, 0.4605809128630705, 0.25]
Validation sensitivity: 0.44150943396226416
Validation specificity: 0.9376344086021505
Validation icbhi_score: 0.6895719212822073
Validation roc_auc: None
Validation avg_accuracy: 0.4745538303663052
Validation one_indexed_epoch: 16
Validation cm: [[685 522 241 126]
 [252 512  35  61]
 [102  73 151  78]
 [ 66  38  62  76]]
Validation val_loss: 1.3748071541361349
Validation normalized_cm: [[0.435 0.332 0.153 0.08 ]
 [0.293 0.595 0.041 0.071]
 [0.252 0.181 0.374 0.193]
 [0.273 0.157 0.256 0.314]]
Validation acc: 0.4623376623376623
Validation class_accuracies: [0.43519695044472684, 0.5953488372093023, 0.37376237623762376, 0.3140495867768595]
Validation sensitivity: 0.4907038512616202
Validation specificity: 0.43519695044472684
Validation icbhi_score: 0.4629504008531735
Validation roc_auc: None
Validation avg_accuracy: 0.42958943766712815
Validation one_indexed_epoch: 16
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 7.812499825377017e-05
-----------------------------
-----------------------------
The validation tracker metric at 0.46865608299542194 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 495s - loss: 0.0407 - accuracy: 0.5961 - 495s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 17/100
Validation cm: [[2194   33   90    8]
 [  16    6    2    0]
 [ 210   24  221   27]
 [   8    5    5    6]]
Validation val_loss: 0.3916610378328541
Validation normalized_cm: [[0.944 0.014 0.039 0.003]
 [0.667 0.25  0.083 0.   ]
 [0.436 0.05  0.459 0.056]
 [0.333 0.208 0.208 0.25 ]]
Validation acc: 0.8500875656742557
Validation class_accuracies: [0.9436559139784946, 0.25, 0.45850622406639, 0.25]
Validation sensitivity: 0.439622641509434
Validation specificity: 0.9436559139784946
Validation icbhi_score: 0.6916392777439643
Validation roc_auc: None
Validation avg_accuracy: 0.47554053451122114
Validation one_indexed_epoch: 17
Validation cm: [[771 435 249 119]
 [316 447  40  57]
 [107  62 164  71]
 [ 70  32  70  70]]
Validation val_loss: 1.333545751230376
Validation normalized_cm: [[0.49  0.276 0.158 0.076]
 [0.367 0.52  0.047 0.066]
 [0.265 0.153 0.406 0.176]
 [0.289 0.132 0.289 0.289]]
Validation acc: 0.4714285714285714
Validation class_accuracies: [0.4898348157560356, 0.5197674418604651, 0.40594059405940597, 0.2892561983471074]
Validation sensitivity: 0.45219123505976094
Validation specificity: 0.4898348157560356
Validation icbhi_score: 0.47101302540789824
Validation roc_auc: None
Validation avg_accuracy: 0.4261997625057535
Validation one_indexed_epoch: 17
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 13 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 497s - loss: 0.0385 - accuracy: 0.5901 - 497s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 18/100
Validation cm: [[2190   38   89    8]
 [  17    5    2    0]
 [ 206   26  220   30]
 [   9    5    4    6]]
Validation val_loss: 0.394073453262293
Validation normalized_cm: [[0.942 0.016 0.038 0.003]
 [0.708 0.208 0.083 0.   ]
 [0.427 0.054 0.456 0.062]
 [0.375 0.208 0.167 0.25 ]]
Validation acc: 0.8479859894921191
Validation class_accuracies: [0.9419354838709677, 0.20833333333333334, 0.45643153526970953, 0.25]
Validation sensitivity: 0.4358490566037736
Validation specificity: 0.9419354838709677
Validation icbhi_score: 0.6888922702373707
Validation roc_auc: None
Validation avg_accuracy: 0.4641750881185026
Validation one_indexed_epoch: 18
Validation cm: [[758 440 261 115]
 [317 442  44  57]
 [106  63 163  72]
 [ 69  32  69  72]]
Validation val_loss: 1.339241852692622
Validation normalized_cm: [[0.482 0.28  0.166 0.073]
 [0.369 0.514 0.051 0.066]
 [0.262 0.156 0.403 0.178]
 [0.285 0.132 0.285 0.298]]
Validation acc: 0.4659090909090909
Validation class_accuracies: [0.4815756035578145, 0.513953488372093, 0.4034653465346535, 0.2975206611570248]
Validation sensitivity: 0.449535192563081
Validation specificity: 0.4815756035578145
Validation icbhi_score: 0.46555539806044777
Validation roc_auc: None
Validation avg_accuracy: 0.42412877490539647
Validation one_indexed_epoch: 18
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 14 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47101302540789824 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 495s - loss: 0.0369 - accuracy: 0.5947 - 495s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 19/100
Validation cm: [[2195   33   88    9]
 [  16    6    2    0]
 [ 205   20  225   32]
 [   8    5    5    6]]
Validation val_loss: 0.3883129496026854
Validation normalized_cm: [[0.944 0.014 0.038 0.004]
 [0.667 0.25  0.083 0.   ]
 [0.425 0.041 0.467 0.066]
 [0.333 0.208 0.208 0.25 ]]
Validation acc: 0.8518388791593695
Validation class_accuracies: [0.9440860215053763, 0.25, 0.46680497925311204, 0.25]
Validation sensitivity: 0.44716981132075473
Validation specificity: 0.9440860215053763
Validation icbhi_score: 0.6956279164130655
Validation roc_auc: None
Validation avg_accuracy: 0.47772275018962207
Validation one_indexed_epoch: 19
Validation cm: [[752 452 253 117]
 [307 454  42  57]
 [106  65 163  70]
 [ 72  31  71  68]]
Validation val_loss: 1.3629928716088633
Validation normalized_cm: [[0.478 0.287 0.161 0.074]
 [0.357 0.528 0.049 0.066]
 [0.262 0.161 0.403 0.173]
 [0.298 0.128 0.293 0.281]]
Validation acc: 0.46655844155844156
Validation class_accuracies: [0.4777636594663278, 0.5279069767441861, 0.4034653465346535, 0.2809917355371901]
Validation sensitivity: 0.4548472775564409
Validation specificity: 0.4777636594663278
Validation icbhi_score: 0.4663054685113843
Validation roc_auc: None
Validation avg_accuracy: 0.4225319295705894
Validation one_indexed_epoch: 19
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 15 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47101302540789824 hasn't increased by 0 in 2 epochs
-----------------------------
258/258 - 497s - loss: 0.0376 - accuracy: 0.5930 - 497s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 20/100
Validation cm: [[2195   38   85    7]
 [  17    5    2    0]
 [ 208   25  219   30]
 [   9    5    4    6]]
Validation val_loss: 0.3957609786474819
Validation normalized_cm: [[0.944 0.016 0.037 0.003]
 [0.708 0.208 0.083 0.   ]
 [0.432 0.052 0.454 0.062]
 [0.375 0.208 0.167 0.25 ]]
Validation acc: 0.8493870402802102
Validation class_accuracies: [0.9440860215053763, 0.20833333333333334, 0.45435684647302904, 0.25]
Validation sensitivity: 0.4339622641509434
Validation specificity: 0.9440860215053763
Validation icbhi_score: 0.6890241428281598
Validation roc_auc: None
Validation avg_accuracy: 0.46419405032793465
Validation one_indexed_epoch: 20
Validation cm: [[799 416 245 114]
 [335 430  41  54]
 [116  61 159  68]
 [ 72  31  71  68]]
Validation val_loss: 1.3609322719766817
Validation normalized_cm: [[0.508 0.264 0.156 0.072]
 [0.39  0.5   0.048 0.063]
 [0.287 0.151 0.394 0.168]
 [0.298 0.128 0.293 0.281]]
Validation acc: 0.4727272727272727
Validation class_accuracies: [0.5076238881829733, 0.5, 0.3935643564356436, 0.2809917355371901]
Validation sensitivity: 0.4362549800796813
Validation specificity: 0.5076238881829733
Validation icbhi_score: 0.47193943413132733
Validation roc_auc: None
Validation avg_accuracy: 0.4205449950389517
Validation one_indexed_epoch: 20
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 16 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 494s - loss: 0.0361 - accuracy: 0.5915 - 494s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 21/100
Validation cm: [[2188   37   92    8]
 [  17    5    2    0]
 [ 197   26  221   38]
 [   8    5    5    6]]
Validation val_loss: 0.3954098975832454
Validation normalized_cm: [[0.941 0.016 0.04  0.003]
 [0.708 0.208 0.083 0.   ]
 [0.409 0.054 0.459 0.079]
 [0.333 0.208 0.208 0.25 ]]
Validation acc: 0.8476357267950964
Validation class_accuracies: [0.9410752688172043, 0.20833333333333334, 0.45850622406639, 0.25]
Validation sensitivity: 0.4377358490566038
Validation specificity: 0.9410752688172043
Validation icbhi_score: 0.689405558936904
Validation roc_auc: None
Validation avg_accuracy: 0.4644787065542319
Validation one_indexed_epoch: 21
Validation cm: [[761 435 259 119]
 [320 438  42  60]
 [102  64 163  75]
 [ 70  31  70  71]]
Validation val_loss: 1.38969956602759
Validation normalized_cm: [[0.483 0.276 0.165 0.076]
 [0.372 0.509 0.049 0.07 ]
 [0.252 0.158 0.403 0.186]
 [0.289 0.128 0.289 0.293]]
Validation acc: 0.46525974025974026
Validation class_accuracies: [0.4834815756035578, 0.5093023255813953, 0.4034653465346535, 0.29338842975206614]
Validation sensitivity: 0.44621513944223107
Validation specificity: 0.4834815756035578
Validation icbhi_score: 0.46484835752289444
Validation roc_auc: None
Validation avg_accuracy: 0.4224094193679182
Validation one_indexed_epoch: 21
-----------------------------
The validation tracker metric at 0.7147737877865692 hasn't increased by 0 in 17 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.47193943413132733 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 503s - loss: 0.0367 - accuracy: 0.5907 - 503s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 22/100
Validation cm: [[2193   35   90    7]
 [  17    5    2    0]
 [ 193   22  231   36]
 [   9    6    4    5]]
Validation val_loss: 0.3880082030676292
Validation normalized_cm: [[0.943 0.015 0.039 0.003]
 [0.708 0.208 0.083 0.   ]
 [0.4   0.046 0.479 0.075]
 [0.375 0.25  0.167 0.208]]
Validation acc: 0.852539404553415
Validation class_accuracies: [0.9432258064516129, 0.20833333333333334, 0.47925311203319504, 0.20833333333333334]
Validation sensitivity: 0.4547169811320755
Validation specificity: 0.9432258064516129
Validation icbhi_score: 0.6989713937918443
Validation roc_auc: None
Validation avg_accuracy: 0.45978639628786866
Validation one_indexed_epoch: 22
Validation cm: [[776 431 261 106]
 [324 440  42  54]
 [105  68 165  66]
 [ 72  32  71  67]]
Validation val_loss: 1.3990341336103005
Validation normalized_cm: [[0.493 0.274 0.166 0.067]
 [0.377 0.512 0.049 0.063]
 [0.26  0.168 0.408 0.163]
 [0.298 0.132 0.293 0.277]]
Validation acc: 0.4701298701298701
Validation class_accuracies: [0.49301143583227447, 0.5116279069767442, 0.4084158415841584, 0.2768595041322314]
Validation sensitivity: 0.44621513944223107
Validation specificity: 0.49301143583227447
Validation icbhi_score: 0.46961328763725274
Validation roc_auc: None
Validation avg_accuracy: 0.4224786721313521
Validation one_indexed_epoch: 22
-----------------------------
The number of epochs since last 1% equals the patience
Lr has been adjusted to 1.9531249563442543e-05
-----------------------------
-----------------------------
The validation tracker metric at 0.47193943413132733 hasn't increased by 0 in 2 epochs
-----------------------------
258/258 - 502s - loss: 0.0357 - accuracy: 0.5906 - 502s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.7147737877865692
Best cm: [[1762  205  206  152]
 [  16    6    2    0]
 [ 105    5  341   31]
 [   7    6    2    9]]
Best val_loss: 0.4089370559850373
Best normalized_cm: [[0.758 0.088 0.089 0.065]
 [0.667 0.25  0.083 0.   ]
 [0.218 0.01  0.707 0.064]
 [0.292 0.25  0.083 0.375]]
Best acc: 0.7418563922942206
Best class_accuracies: [0.7578494623655914, 0.25, 0.7074688796680498, 0.375]
Best sensitivity: 0.6716981132075471
Best specificity: 0.7578494623655914
Best roc_auc: None
Best avg_accuracy: 0.5225795855084103
Best one_indexed_epoch: 4
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.47193943413132733
Best cm: [[799 416 245 114]
 [335 430  41  54]
 [116  61 159  68]
 [ 72  31  71  68]]
Best val_loss: 1.3609322719766817
Best normalized_cm: [[0.508 0.264 0.156 0.072]
 [0.39  0.5   0.048 0.063]
 [0.287 0.151 0.394 0.168]
 [0.298 0.128 0.293 0.281]]
Best acc: 0.4727272727272727
Best class_accuracies: [0.5076238881829733, 0.5, 0.3935643564356436, 0.2809917355371901]
Best sensitivity: 0.4362549800796813
Best specificity: 0.5076238881829733
Best roc_auc: None
Best avg_accuracy: 0.4205449950389517
Best one_indexed_epoch: 20
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.5810649394989014, 0.4611935615539551, 0.3898657262325287, 0.33468401432037354, 0.28886502981185913, 0.25580257177352905, 0.2202521562576294, 0.15222269296646118, 0.09865295886993408, 0.07472141832113266, 0.060780081897974014, 0.052767254412174225, 0.050720226019620895, 0.04454107955098152, 0.04209956154227257, 0.040733207017183304, 0.0385296531021595, 0.036874741315841675, 0.03764764964580536, 0.03606065362691879, 0.036724552512168884, 0.03567591309547424], 'accuracy': [0.4933527708053589, 0.5534511208534241, 0.5720876455307007, 0.5513263940811157, 0.5433133244514465, 0.5415528416633606, 0.5507193803787231, 0.5485946536064148, 0.5640138387680054, 0.5913919806480408, 0.595702052116394, 0.5912705659866333, 0.584471583366394, 0.5964305400848389, 0.5973411202430725, 0.5960662961006165, 0.5901171565055847, 0.594730794429779, 0.5930310487747192, 0.5915133953094482, 0.5907242298126221, 0.5906028151512146]}
End
####################################
Job id is 4.
len of icbhi
7857
len of train icbhi
4769
len of val icbhi
3080
before icbhi addition
11752
after icbhi addition
16521
-----------------------
--- Final training dataset went from 0 to 16521 elements, with 11743 none's, 1633 crakles, 2164 wheezes and 981 both ---
--- Final Validation dataset contains 2807 elements, with 2407 none, 64 crackles, 256 wheezes and 80 both ---
Initializing weights...
weights = {0: 0.35172017372051434, 1: 2.529240661359461, 2: 1.9086182994454715, 3: 4.210244648318043}
Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 7, 2048)        23587712  
                                                                 
 global_average_pooling2d_2   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_6 (Dense)             (None, 100)               204900    
                                                                 
 dropout_4 (Dropout)         (None, 100)               0         
                                                                 
 dense_7 (Dense)             (None, 50)                5050      
                                                                 
 dropout_5 (Dropout)         (None, 50)                0         
                                                                 
 dense_8 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_pretrained_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential_2 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Target metric is icbhi_score
here
There is no such attribute
here2
Epoch 1/100
Validation cm: [[2294  113    0    0]
 [  64    0    0    0]
 [ 188   68    0    0]
 [  78    2    0    0]]
Validation val_loss: 0.3990510309318769
Validation normalized_cm: [[0.953 0.047 0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.734 0.266 0.    0.   ]
 [0.975 0.025 0.    0.   ]]
Validation acc: 0.8172426077662985
Validation class_accuracies: [0.9530535936850851, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 0.9530535936850851
Validation icbhi_score: 0.47652679684254257
Validation roc_auc: None
Validation avg_accuracy: 0.23826339842127128
Validation one_indexed_epoch: 1
Validation cm: [[  61 1513    0    0]
 [   9  851    0    0]
 [   8  396    0    0]
 [   4  238    0    0]]
Validation val_loss: 0.7800275121343794
Validation normalized_cm: [[0.039 0.961 0.    0.   ]
 [0.01  0.99  0.    0.   ]
 [0.02  0.98  0.    0.   ]
 [0.017 0.983 0.    0.   ]]
Validation acc: 0.2961038961038961
Validation class_accuracies: [0.03875476493011436, 0.9895348837209302, 0.0, 0.0]
Validation sensitivity: 0.5650730411686588
Validation specificity: 0.03875476493011436
Validation icbhi_score: 0.30191390304938653
Validation roc_auc: None
Validation avg_accuracy: 0.25707241216276117
Validation one_indexed_epoch: 1
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 501s - loss: 0.5667 - accuracy: 0.5176 - 501s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 2/100
Validation cm: [[2377   25    5    0]
 [  63    0    1    0]
 [ 221    0   34    1]
 [  62    6    5    7]]
Validation val_loss: 0.2879766495098314
Validation normalized_cm: [[0.988 0.01  0.002 0.   ]
 [0.984 0.    0.016 0.   ]
 [0.863 0.    0.133 0.004]
 [0.775 0.075 0.062 0.087]]
Validation acc: 0.8614178838617741
Validation class_accuracies: [0.9875363523057749, 0.0, 0.1328125, 0.0875]
Validation sensitivity: 0.1025
Validation specificity: 0.9875363523057749
Validation icbhi_score: 0.5450181761528874
Validation roc_auc: None
Validation avg_accuracy: 0.30196221307644366
Validation one_indexed_epoch: 2
Validation cm: [[  91 1324  102   57]
 [   7  839    4   10]
 [  27  309   19   49]
 [  16  196    7   23]]
Validation val_loss: 0.8694400767314961
Validation normalized_cm: [[0.058 0.841 0.065 0.036]
 [0.008 0.976 0.005 0.012]
 [0.067 0.765 0.047 0.121]
 [0.066 0.81  0.029 0.095]]
Validation acc: 0.3155844155844156
Validation class_accuracies: [0.05781448538754765, 0.9755813953488373, 0.04702970297029703, 0.09504132231404959]
Validation sensitivity: 0.5849933598937583
Validation specificity: 0.05781448538754765
Validation icbhi_score: 0.321403922640653
Validation roc_auc: None
Validation avg_accuracy: 0.2938667265051829
Validation one_indexed_epoch: 2
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 499s - loss: 0.4513 - accuracy: 0.5708 - 499s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 3/100
Validation cm: [[2138  103  149   17]
 [  46   10    7    1]
 [  86   10  145   15]
 [  23   21   20   16]]
Validation val_loss: 0.32200678887323664
Validation normalized_cm: [[0.888 0.043 0.062 0.007]
 [0.719 0.156 0.109 0.016]
 [0.336 0.039 0.566 0.059]
 [0.287 0.263 0.25  0.2  ]]
Validation acc: 0.8225863911649448
Validation class_accuracies: [0.8882426256751143, 0.15625, 0.56640625, 0.2]
Validation sensitivity: 0.4275
Validation specificity: 0.8882426256751143
Validation icbhi_score: 0.6578713128375571
Validation roc_auc: None
Validation avg_accuracy: 0.4527247189187786
Validation one_indexed_epoch: 3
Validation cm: [[ 153 1061  269   91]
 [  26  788   16   30]
 [  20  143  127  114]
 [  10  109   42   81]]
Validation val_loss: 0.7225577650132118
Validation normalized_cm: [[0.097 0.674 0.171 0.058]
 [0.03  0.916 0.019 0.035]
 [0.05  0.354 0.314 0.282]
 [0.041 0.45  0.174 0.335]]
Validation acc: 0.3730519480519481
Validation class_accuracies: [0.09720457433290978, 0.9162790697674419, 0.31435643564356436, 0.3347107438016529]
Validation sensitivity: 0.6613545816733067
Validation specificity: 0.09720457433290978
Validation icbhi_score: 0.37927957800310824
Validation roc_auc: None
Validation avg_accuracy: 0.41563770588639226
Validation one_indexed_epoch: 3
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 493s - loss: 0.3870 - accuracy: 0.5591 - 493s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 4/100
Validation cm: [[2159   23  187   38]
 [  46    2    8    8]
 [  65    0  181   10]
 [  21    2   31   26]]
Validation val_loss: 0.2514725931708363
Validation normalized_cm: [[0.897 0.01  0.078 0.016]
 [0.719 0.031 0.125 0.125]
 [0.254 0.    0.707 0.039]
 [0.263 0.025 0.388 0.325]]
Validation acc: 0.8436052725329534
Validation class_accuracies: [0.8969671790610719, 0.03125, 0.70703125, 0.325]
Validation sensitivity: 0.5225
Validation specificity: 0.8969671790610719
Validation icbhi_score: 0.7097335895305359
Validation roc_auc: None
Validation avg_accuracy: 0.49006210726526794
Validation one_indexed_epoch: 4
Validation cm: [[347 825 249 153]
 [127 642  25  66]
 [ 54  89 116 145]
 [ 29  50  43 120]]
Validation val_loss: 0.7068290919706516
Validation normalized_cm: [[0.22  0.524 0.158 0.097]
 [0.148 0.747 0.029 0.077]
 [0.134 0.22  0.287 0.359]
 [0.12  0.207 0.178 0.496]]
Validation acc: 0.3977272727272727
Validation class_accuracies: [0.2204574332909784, 0.7465116279069768, 0.2871287128712871, 0.49586776859504134]
Validation sensitivity: 0.5830013280212484
Validation specificity: 0.2204574332909784
Validation icbhi_score: 0.4017293806561134
Validation roc_auc: None
Validation avg_accuracy: 0.43749138566607093
Validation one_indexed_epoch: 4
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 495s - loss: 0.3381 - accuracy: 0.5390 - 495s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 5/100
Validation cm: [[1904  255  119  129]
 [  15   33    0   16]
 [  41   20  106   89]
 [  14   19   12   35]]
Validation val_loss: 0.45592030642317805
Validation normalized_cm: [[0.791 0.106 0.049 0.054]
 [0.234 0.516 0.    0.25 ]
 [0.16  0.078 0.414 0.348]
 [0.175 0.237 0.15  0.438]]
Validation acc: 0.7402921268257927
Validation class_accuracies: [0.7910261736601579, 0.515625, 0.4140625, 0.4375]
Validation sensitivity: 0.435
Validation specificity: 0.7910261736601579
Validation icbhi_score: 0.6130130868300789
Validation roc_auc: None
Validation avg_accuracy: 0.5395534184150395
Validation one_indexed_epoch: 5
Validation cm: [[640 621 108 205]
 [262 545  14  39]
 [ 85  92  76 151]
 [ 46  53  42 101]]
Validation val_loss: 0.7288939184610042
Validation normalized_cm: [[0.407 0.395 0.069 0.13 ]
 [0.305 0.634 0.016 0.045]
 [0.21  0.228 0.188 0.374]
 [0.19  0.219 0.174 0.417]]
Validation acc: 0.4422077922077922
Validation class_accuracies: [0.40660736975857686, 0.6337209302325582, 0.18811881188118812, 0.41735537190082644]
Validation sensitivity: 0.47941567065073043
Validation specificity: 0.40660736975857686
Validation icbhi_score: 0.4430115202046536
Validation roc_auc: None
Validation avg_accuracy: 0.4114506209432874
Validation one_indexed_epoch: 5
-----------------------------
The validation tracker metric at 0.7097335895305359 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 495s - loss: 0.2818 - accuracy: 0.5216 - 495s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 6/100
Validation cm: [[2138   20  245    4]
 [  48    3   13    0]
 [  55    1  198    2]
 [  19    3   33   25]]
Validation val_loss: 0.2633610525298452
Validation normalized_cm: [[0.888 0.008 0.102 0.002]
 [0.75  0.047 0.203 0.   ]
 [0.215 0.004 0.773 0.008]
 [0.237 0.037 0.412 0.312]]
Validation acc: 0.8421802636266477
Validation class_accuracies: [0.8882426256751143, 0.046875, 0.7734375, 0.3125]
Validation sensitivity: 0.565
Validation specificity: 0.8882426256751143
Validation icbhi_score: 0.7266213128375572
Validation roc_auc: None
Validation avg_accuracy: 0.5052637814187786
Validation one_indexed_epoch: 6
Validation cm: [[242 837 286 209]
 [ 54 658  32 116]
 [ 28  91  96 189]
 [ 14  48  57 123]]
Validation val_loss: 0.7548890414839767
Validation normalized_cm: [[0.154 0.532 0.182 0.133]
 [0.063 0.765 0.037 0.135]
 [0.069 0.225 0.238 0.468]
 [0.058 0.198 0.236 0.508]]
Validation acc: 0.3633116883116883
Validation class_accuracies: [0.15374841168996187, 0.7651162790697674, 0.2376237623762376, 0.5082644628099173]
Validation sensitivity: 0.5823373173970784
Validation specificity: 0.15374841168996187
Validation icbhi_score: 0.36804286454352014
Validation roc_auc: None
Validation avg_accuracy: 0.41618822898647106
Validation one_indexed_epoch: 6
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.4430115202046536 hasn't increased by 0 in 1 epochs
-----------------------------
259/259 - 495s - loss: 0.2484 - accuracy: 0.5026 - 495s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 7/100
Validation cm: [[1377  423  225  382]
 [   6   23    1   34]
 [  18    6   70  162]
 [   8    3    3   66]]
Validation val_loss: 0.8359062248458442
Validation normalized_cm: [[0.572 0.176 0.093 0.159]
 [0.094 0.359 0.016 0.531]
 [0.07  0.023 0.273 0.633]
 [0.1   0.037 0.037 0.825]]
Validation acc: 0.5472034200213751
Validation class_accuracies: [0.5720814291649357, 0.359375, 0.2734375, 0.825]
Validation sensitivity: 0.3975
Validation specificity: 0.5720814291649357
Validation icbhi_score: 0.4847907145824678
Validation roc_auc: None
Validation avg_accuracy: 0.5074734822912339
Validation one_indexed_epoch: 7
Validation cm: [[132 956 128 358]
 [ 31 694  27 108]
 [  8  87  79 230]
 [  7  62  30 143]]
Validation val_loss: 1.1453420094868603
Validation normalized_cm: [[0.084 0.607 0.081 0.227]
 [0.036 0.807 0.031 0.126]
 [0.02  0.215 0.196 0.569]
 [0.029 0.256 0.124 0.591]]
Validation acc: 0.34025974025974026
Validation class_accuracies: [0.08386277001270648, 0.8069767441860465, 0.19554455445544555, 0.5909090909090909]
Validation sensitivity: 0.6082337317397079
Validation specificity: 0.08386277001270648
Validation icbhi_score: 0.34604825087620716
Validation roc_auc: None
Validation avg_accuracy: 0.41932328989082235
Validation one_indexed_epoch: 7
-----------------------------
The validation tracker metric at 0.7266213128375572 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4430115202046536 hasn't increased by 0 in 2 epochs
-----------------------------
259/259 - 495s - loss: 0.2023 - accuracy: 0.5294 - 495s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 8/100
Validation cm: [[2175   37  165   30]
 [  42    8    8    6]
 [  63    4  151   38]
 [  33    7   20   20]]
Validation val_loss: 0.2541956271016441
Validation normalized_cm: [[0.904 0.015 0.069 0.012]
 [0.656 0.125 0.125 0.094]
 [0.246 0.016 0.59  0.148]
 [0.412 0.087 0.25  0.25 ]]
Validation acc: 0.8386177413608835
Validation class_accuracies: [0.9036144578313253, 0.125, 0.58984375, 0.25]
Validation sensitivity: 0.4475
Validation specificity: 0.9036144578313253
Validation icbhi_score: 0.6755572289156626
Validation roc_auc: None
Validation avg_accuracy: 0.46711455195783136
Validation one_indexed_epoch: 8
Validation cm: [[543 784 223  24]
 [199 623  27  11]
 [ 93 119 150  42]
 [ 74  67  69  32]]
Validation val_loss: 0.8394830873598299
Validation normalized_cm: [[0.345 0.498 0.142 0.015]
 [0.231 0.724 0.031 0.013]
 [0.23  0.295 0.371 0.104]
 [0.306 0.277 0.285 0.132]]
Validation acc: 0.43766233766233764
Validation class_accuracies: [0.34498094027954257, 0.7244186046511628, 0.3712871287128713, 0.1322314049586777]
Validation sensitivity: 0.5345285524568393
Validation specificity: 0.34498094027954257
Validation icbhi_score: 0.4397547463681909
Validation roc_auc: None
Validation avg_accuracy: 0.39322951965056363
Validation one_indexed_epoch: 8
-----------------------------
The validation tracker metric at 0.7266213128375572 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4430115202046536 hasn't increased by 0 in 3 epochs
-----------------------------
259/259 - 498s - loss: 0.1940 - accuracy: 0.5500 - 498s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 9/100
Validation cm: [[1852  276  170  109]
 [  17   31    5   11]
 [  49    7  110   90]
 [  14    5   12   49]]
Validation val_loss: 0.48503370360089043
Validation normalized_cm: [[0.769 0.115 0.071 0.045]
 [0.266 0.484 0.078 0.172]
 [0.191 0.027 0.43  0.352]
 [0.175 0.062 0.15  0.613]]
Validation acc: 0.7274670466690417
Validation class_accuracies: [0.7694225176568342, 0.484375, 0.4296875, 0.6125]
Validation sensitivity: 0.475
Validation specificity: 0.7694225176568342
Validation icbhi_score: 0.6222112588284171
Validation roc_auc: None
Validation avg_accuracy: 0.5739962544142085
Validation one_indexed_epoch: 9
Validation cm: [[315 835 153 271]
 [100 670  26  64]
 [ 29 133  69 173]
 [ 33  65  41 103]]
Validation val_loss: 1.0384602398645717
Validation normalized_cm: [[0.2   0.53  0.097 0.172]
 [0.116 0.779 0.03  0.074]
 [0.072 0.329 0.171 0.428]
 [0.136 0.269 0.169 0.426]]
Validation acc: 0.3756493506493506
Validation class_accuracies: [0.20012706480304956, 0.7790697674418605, 0.1707920792079208, 0.4256198347107438]
Validation sensitivity: 0.5590969455511288
Validation specificity: 0.20012706480304956
Validation icbhi_score: 0.37961200517708915
Validation roc_auc: None
Validation avg_accuracy: 0.39390218654089365
Validation one_indexed_epoch: 9
-----------------------------
The validation tracker metric at 0.7266213128375572 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4430115202046536 hasn't increased by 0 in 4 epochs
-----------------------------
259/259 - 499s - loss: 0.1586 - accuracy: 0.5480 - 499s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 10/100
Validation cm: [[2175   99  106   27]
 [  39   20    2    3]
 [  96    5  134   21]
 [  20    8   13   39]]
Validation val_loss: 0.27298067157926337
Validation normalized_cm: [[0.904 0.041 0.044 0.011]
 [0.609 0.312 0.031 0.047]
 [0.375 0.02  0.523 0.082]
 [0.25  0.1   0.163 0.487]]
Validation acc: 0.8436052725329534
Validation class_accuracies: [0.9036144578313253, 0.3125, 0.5234375, 0.4875]
Validation sensitivity: 0.4825
Validation specificity: 0.9036144578313253
Validation icbhi_score: 0.6930572289156627
Validation roc_auc: None
Validation avg_accuracy: 0.5567629894578313
Validation one_indexed_epoch: 10
Validation cm: [[483 863 112 116]
 [114 708  14  24]
 [ 98 141  53 112]
 [ 52  92  26  72]]
Validation val_loss: 0.718893542726314
Validation normalized_cm: [[0.307 0.548 0.071 0.074]
 [0.133 0.823 0.016 0.028]
 [0.243 0.349 0.131 0.277]
 [0.215 0.38  0.107 0.298]]
Validation acc: 0.42727272727272725
Validation class_accuracies: [0.306861499364676, 0.8232558139534883, 0.1311881188118812, 0.2975206611570248]
Validation sensitivity: 0.5531208499335989
Validation specificity: 0.306861499364676
Validation icbhi_score: 0.42999117464913744
Validation roc_auc: None
Validation avg_accuracy: 0.3897065233217676
Validation one_indexed_epoch: 10
-----------------------------
The validation tracker metric at 0.7266213128375572 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4430115202046536 hasn't increased by 0 in 5 epochs
-----------------------------
259/259 - 491s - loss: 0.2443 - accuracy: 0.5613 - 491s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 11/100
Validation cm: [[2146   19  220   22]
 [  48    3   10    3]
 [  77    0  146   33]
 [  27    3   14   36]]
Validation val_loss: 0.36041589233845445
Validation normalized_cm: [[0.892 0.008 0.091 0.009]
 [0.75  0.047 0.156 0.047]
 [0.301 0.    0.57  0.129]
 [0.338 0.037 0.175 0.45 ]]
Validation acc: 0.830423940149626
Validation class_accuracies: [0.891566265060241, 0.046875, 0.5703125, 0.45]
Validation sensitivity: 0.4625
Validation specificity: 0.891566265060241
Validation icbhi_score: 0.6770331325301204
Validation roc_auc: None
Validation avg_accuracy: 0.4896884412650602
Validation one_indexed_epoch: 11
Validation cm: [[734 464 212 164]
 [221 508  51  80]
 [ 87  67 119 131]
 [ 44  41  46 111]]
Validation val_loss: 0.8399470341126384
Validation normalized_cm: [[0.466 0.295 0.135 0.104]
 [0.257 0.591 0.059 0.093]
 [0.215 0.166 0.295 0.324]
 [0.182 0.169 0.19  0.459]]
Validation acc: 0.4779220779220779
Validation class_accuracies: [0.4663278271918678, 0.5906976744186047, 0.29455445544554454, 0.45867768595041325]
Validation sensitivity: 0.4900398406374502
Validation specificity: 0.4663278271918678
Validation icbhi_score: 0.478183833914659
Validation roc_auc: None
Validation avg_accuracy: 0.4525644107516076
Validation one_indexed_epoch: 11
-----------------------------
The validation tracker metric at 0.7266213128375572 hasn't increased by 0 in 5 epochs
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 489s - loss: 0.1353 - accuracy: 0.5606 - 489s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 12/100
Validation cm: [[2217   26  160    4]
 [  46   12    5    1]
 [  85    8  155    8]
 [  33    5   13   29]]
Validation val_loss: 0.3133084296682075
Validation normalized_cm: [[0.921 0.011 0.066 0.002]
 [0.719 0.188 0.078 0.016]
 [0.332 0.031 0.605 0.031]
 [0.412 0.062 0.163 0.362]]
Validation acc: 0.8596366227288921
Validation class_accuracies: [0.9210635646032406, 0.1875, 0.60546875, 0.3625]
Validation sensitivity: 0.49
Validation specificity: 0.9210635646032406
Validation icbhi_score: 0.7055317823016203
Validation roc_auc: None
Validation avg_accuracy: 0.5191330786508102
Validation one_indexed_epoch: 12
Validation cm: [[1159  129  226   60]
 [ 573   94  133   60]
 [ 171   16  179   38]
 [  88   12   93   49]]
Validation val_loss: 0.7849105585096082
Validation normalized_cm: [[0.736 0.082 0.144 0.038]
 [0.666 0.109 0.155 0.07 ]
 [0.423 0.04  0.443 0.094]
 [0.364 0.05  0.384 0.202]]
Validation acc: 0.48084415584415585
Validation class_accuracies: [0.7363405336721728, 0.10930232558139535, 0.4430693069306931, 0.2024793388429752]
Validation sensitivity: 0.21381142098273573
Validation specificity: 0.7363405336721728
Validation icbhi_score: 0.47507597732745427
Validation roc_auc: None
Validation avg_accuracy: 0.37279787625680905
Validation one_indexed_epoch: 12
-----------------------------
The validation tracker metric at 0.7266213128375572 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0012499999720603228
-----------------------------
-----------------------------
The validation tracker metric at 0.478183833914659 hasn't increased by 0 in 1 epochs
-----------------------------
259/259 - 493s - loss: 0.1121 - accuracy: 0.5617 - 493s/epoch - 2s/step
here
There is no such attribute
here2
Epoch 13/100
Validation cm: [[2223   51  122   11]
 [  39   18    5    2]
 [  78    6  166    6]
 [  27    9   17   27]]
Validation val_loss: 0.2992521418395729
Validation normalized_cm: [[0.924 0.021 0.051 0.005]
 [0.609 0.281 0.078 0.031]
 [0.305 0.023 0.648 0.023]
 [0.338 0.113 0.212 0.338]]
Validation acc: 0.8671179194869968
Validation class_accuracies: [0.9235562941420856, 0.28125, 0.6484375, 0.3375]
Validation sensitivity: 0.5275
Validation specificity: 0.9235562941420856
Validation icbhi_score: 0.7255281470710429
Validation roc_auc: None
Validation avg_accuracy: 0.5476859485355214
Validation one_indexed_epoch: 13
