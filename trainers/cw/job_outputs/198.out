Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train198
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
training parameters
[('cache_root', '../cache/'), ('data_root', '../data/'), ('jordan_root', '../data/jwyy9np4gv-3/'), ('icbhi_root', '../data/raw_audios/icbhi_preprocessed_v2_8000/'), ('bd_root', '../data/PCV_SEGMENTED_Processed_Files/'), ('excel_path', '../data/Bangladesh_PCV_onlyStudyPatients.xlsx'), ('perch_root', '../data/raw_audios/perch_8000_10seconds'), ('ant_root', '../data/raw_audios/Antwerp_Clinical_Complete'), ('description', ' effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,'), ('job_id', 0), ('mode', 'cw'), ('n_classes', 2), ('shape', (80, 500, 3)), ('n_epochs', 110), ('lr', 0.0002), ('batch_size', 16), ('ll2_reg', 0), ('weight_decay', 0.0001), ('label_smoothing', 0), ('epsilon', 1e-07), ('es_patience', 15), ('min_delta', 0), ('train_test_ratio', 0.8), ('kfold', False), ('clause', 0), ('epoch_start', 0), ('testing', 0), ('adaptive_lr', False), ('cuberooting', 1), ('normalizing', 1), ('class_weights', True), ('early_stopping', True), ('initial_channels', 1), ('factor', 0.5), ('lr_patience', 10), ('min_lr', 1e-05), ('sr', 8000), ('audio_length', 5), ('step_size', 2.5), ('n_fft', 1024), ('hop_length', 254), ('n_mels', 128), ('overlap_threshold', 0.3), ('trainable_fb', False), ('to_decibel', True), ('train_nn', False), ('train_mel', False), ('file_dir', '../cache/cw/train198'), ('n_sequences', 9), ('activate_spectral_loss', False), ('normalize', False), ('stacking', False), ('oversample', False), ('one_hot_encoding', False), ('activation', 'sigmoid'), ('n_filters', 80), ('code', -1), ('distillation', False)]
Job id is 1.
Job dir: ../cache/cw/train198/1
- Loading Icbhi.
920 Icbhi audios have been loaded.
- Preparing Icbhi.
126 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
len(_all_samples)
7857
-----------------------
--- Final training dataset went from 0 to 4769 elements, with 2299 none's, 1353 crakles, 554 wheezes and 563 both ---
--- Final Validation dataset contains 3080 elements, with 1574 none, 860 crackles, 404 wheezes and 242 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.518595041322314, 1: 0.881189948263119, 2: 2.152075812274368, 3: 2.1176731793960926}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               204900    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
here
There is no such attribute
here2
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 318 1029   83  144]
 [ 255  583    4   18]
 [  92  247   39   26]
 [  76  146   11    9]]
Validation val_loss: 0.6752595100406702
Validation normalized_cm: [[0.202 0.654 0.053 0.091]
 [0.297 0.678 0.005 0.021]
 [0.228 0.611 0.097 0.064]
 [0.314 0.603 0.045 0.037]]
Validation acc: 0.3081168831168831
Validation class_accuracies: [0.2020330368487929, 0.6779069767441861, 0.09653465346534654, 0.0371900826446281]
Validation sensitivity: 0.41899070385126164
Validation specificity: 0.2020330368487929
Validation icbhi_score: 0.31051187035002725
Validation roc_auc: None
Validation avg_accuracy: 0.2534161874257384
Validation one_indexed_epoch: 1
-- New best results were achieved. --
299/299 - 201s - loss: 0.7101 - accuracy: 0.6312 - 201s/epoch - 671ms/step
here
There is no such attribute
here2
Epoch 2/110
Validation cm: [[143  37 896 498]
 [ 76  17 427 340]
 [ 20   6 202 176]
 [ 15   1 133  93]]
Validation val_loss: 0.8752159486633616
Validation normalized_cm: [[0.091 0.024 0.569 0.316]
 [0.088 0.02  0.497 0.395]
 [0.05  0.015 0.5   0.436]
 [0.062 0.004 0.55  0.384]]
Validation acc: 0.14772727272727273
Validation class_accuracies: [0.09085133418043202, 0.019767441860465116, 0.5, 0.384297520661157]
Validation sensitivity: 0.20717131474103587
Validation specificity: 0.09085133418043202
Validation icbhi_score: 0.14901132446073395
Validation roc_auc: None
Validation avg_accuracy: 0.24872907417551354
Validation one_indexed_epoch: 2
The validation tracker metric at 0.31051187035002725 hasn't increased by 0 in 1 epochs
299/299 - 193s - loss: 0.6695 - accuracy: 0.6196 - 193s/epoch - 647ms/step
here
There is no such attribute
here2
Epoch 3/110
Validation cm: [[ 320   15 1022  217]
 [ 180   12  503  165]
 [  65    1  254   84]
 [  50    2  149   41]]
Validation val_loss: 0.8685746283451845
Validation normalized_cm: [[0.203 0.01  0.649 0.138]
 [0.209 0.014 0.585 0.192]
 [0.161 0.002 0.629 0.208]
 [0.207 0.008 0.616 0.169]]
Validation acc: 0.20357142857142857
Validation class_accuracies: [0.20330368487928843, 0.013953488372093023, 0.6287128712871287, 0.16942148760330578]
Validation sensitivity: 0.20385126162018594
Validation specificity: 0.20330368487928843
Validation icbhi_score: 0.20357747324973718
Validation roc_auc: None
Validation avg_accuracy: 0.25384788303545397
Validation one_indexed_epoch: 3
The validation tracker metric at 0.31051187035002725 hasn't increased by 0 in 2 epochs
299/299 - 200s - loss: 0.6297 - accuracy: 0.6303 - 200s/epoch - 668ms/step
here
There is no such attribute
here2
Epoch 4/110
Validation cm: [[858 284 397  35]
 [460 294  75  31]
 [136  51 182  35]
 [ 88  37  96  21]]
Validation val_loss: 0.6884099960133627
Validation normalized_cm: [[0.545 0.18  0.252 0.022]
 [0.535 0.342 0.087 0.036]
 [0.337 0.126 0.45  0.087]
 [0.364 0.153 0.397 0.087]]
Validation acc: 0.43993506493506496
Validation class_accuracies: [0.5451080050825922, 0.34186046511627904, 0.4504950495049505, 0.08677685950413223]
Validation sensitivity: 0.3300132802124834
Validation specificity: 0.5451080050825922
Validation icbhi_score: 0.4375606426475378
Validation roc_auc: None
Validation avg_accuracy: 0.35606009480198847
Validation one_indexed_epoch: 4
-- New best results were achieved. --
299/299 - 200s - loss: 0.5932 - accuracy: 0.7071 - 200s/epoch - 668ms/step
here
There is no such attribute
here2
Epoch 5/110
Validation cm: [[1040  145  380    9]
 [ 639  161   55    5]
 [ 188   20  193    3]
 [ 107   16  114    5]]
Validation val_loss: 0.6921288024634122
Validation normalized_cm: [[0.661 0.092 0.241 0.006]
 [0.743 0.187 0.064 0.006]
 [0.465 0.05  0.478 0.007]
 [0.442 0.066 0.471 0.021]]
Validation acc: 0.45422077922077925
Validation class_accuracies: [0.6607369758576874, 0.1872093023255814, 0.4777227722772277, 0.02066115702479339]
Validation sensitivity: 0.23837981407702524
Validation specificity: 0.6607369758576874
Validation icbhi_score: 0.44955839496735633
Validation roc_auc: None
Validation avg_accuracy: 0.3365825518713225
Validation one_indexed_epoch: 5
-- New best results were achieved. --
299/299 - 212s - loss: 0.5562 - accuracy: 0.7385 - 212s/epoch - 709ms/step
here
There is no such attribute
here2
Epoch 6/110
Validation cm: [[443 578 397 156]
 [176 466  72 146]
 [ 58  90 170  86]
 [ 36  66  78  62]]
Validation val_loss: 0.7499823421336613
Validation normalized_cm: [[0.281 0.367 0.252 0.099]
 [0.205 0.542 0.084 0.17 ]
 [0.144 0.223 0.421 0.213]
 [0.149 0.273 0.322 0.256]]
Validation acc: 0.3704545454545455
Validation class_accuracies: [0.28144853875476494, 0.541860465116279, 0.4207920792079208, 0.256198347107438]
Validation sensitivity: 0.4634794156706507
Validation specificity: 0.28144853875476494
Validation icbhi_score: 0.37246397721270785
Validation roc_auc: None
Validation avg_accuracy: 0.3750748575466007
Validation one_indexed_epoch: 6
The validation tracker metric at 0.44955839496735633 hasn't increased by 0 in 1 epochs
299/299 - 206s - loss: 0.5261 - accuracy: 0.7333 - 206s/epoch - 688ms/step
here
There is no such attribute
here2
Epoch 7/110
Validation cm: [[1020  213  311   30]
 [ 678  139   39    4]
 [ 219   15  148   22]
 [ 130   12   81   19]]
Validation val_loss: 0.7320813380877258
Validation normalized_cm: [[0.648 0.135 0.198 0.019]
 [0.788 0.162 0.045 0.005]
 [0.542 0.037 0.366 0.054]
 [0.537 0.05  0.335 0.079]]
Validation acc: 0.4305194805194805
Validation class_accuracies: [0.6480304955527318, 0.16162790697674417, 0.36633663366336633, 0.07851239669421488]
Validation sensitivity: 0.20318725099601595
Validation specificity: 0.6480304955527318
Validation icbhi_score: 0.4256088732743739
Validation roc_auc: None
Validation avg_accuracy: 0.31362685822176434
Validation one_indexed_epoch: 7
The validation tracker metric at 0.44955839496735633 hasn't increased by 0 in 2 epochs
299/299 - 194s - loss: 0.4990 - accuracy: 0.7631 - 194s/epoch - 650ms/step
here
There is no such attribute
here2
Epoch 8/110
Validation cm: [[516 640 308 110]
 [186 574  45  55]
 [ 67  88 130 119]
 [ 43  59  67  73]]
Validation val_loss: 0.7828631520972817
Validation normalized_cm: [[0.328 0.407 0.196 0.07 ]
 [0.216 0.667 0.052 0.064]
 [0.166 0.218 0.322 0.295]
 [0.178 0.244 0.277 0.302]]
Validation acc: 0.4198051948051948
Validation class_accuracies: [0.3278271918678526, 0.6674418604651163, 0.3217821782178218, 0.30165289256198347]
Validation sensitivity: 0.5159362549800797
Validation specificity: 0.3278271918678526
Validation icbhi_score: 0.4218817234239661
Validation roc_auc: None
Validation avg_accuracy: 0.40467603077819353
Validation one_indexed_epoch: 8
The validation tracker metric at 0.44955839496735633 hasn't increased by 0 in 3 epochs
299/299 - 196s - loss: 0.4621 - accuracy: 0.7771 - 196s/epoch - 656ms/step
here
There is no such attribute
here2
Epoch 9/110
Validation cm: [[398 723 351 102]
 [124 631  47  58]
 [ 48 119 166  71]
 [ 26  77  81  58]]
Validation val_loss: 0.8442341508640145
Validation normalized_cm: [[0.253 0.459 0.223 0.065]
 [0.144 0.734 0.055 0.067]
 [0.119 0.295 0.411 0.176]
 [0.107 0.318 0.335 0.24 ]]
Validation acc: 0.4068181818181818
Validation class_accuracies: [0.25285895806861497, 0.7337209302325581, 0.41089108910891087, 0.2396694214876033]
Validation sensitivity: 0.5677290836653387
Validation specificity: 0.25285895806861497
Validation icbhi_score: 0.41029402086697686
Validation roc_auc: None
Validation avg_accuracy: 0.40928509972442184
Validation one_indexed_epoch: 9
The validation tracker metric at 0.44955839496735633 hasn't increased by 0 in 4 epochs
299/299 - 197s - loss: 0.4135 - accuracy: 0.7951 - 197s/epoch - 658ms/step
here
There is no such attribute
here2
Epoch 10/110
Validation cm: [[991 240 320  23]
 [560 244  52   4]
 [184  45 161  14]
 [112  30  87  13]]
Validation val_loss: 0.7460105473818197
Validation normalized_cm: [[0.63  0.152 0.203 0.015]
 [0.651 0.284 0.06  0.005]
 [0.455 0.111 0.399 0.035]
 [0.463 0.124 0.36  0.054]]
Validation acc: 0.45746753246753247
Validation class_accuracies: [0.6296060991105463, 0.2837209302325581, 0.39851485148514854, 0.05371900826446281]
Validation sensitivity: 0.2775564409030544
Validation specificity: 0.6296060991105463
Validation icbhi_score: 0.4535812700068004
Validation roc_auc: None
Validation avg_accuracy: 0.3413902222731789
Validation one_indexed_epoch: 10
-- New best results were achieved. --
299/299 - 196s - loss: 0.3839 - accuracy: 0.8096 - 196s/epoch - 657ms/step
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
here
There is no such attribute
here2
Epoch 11/110
Validation cm: [[886 220 406  62]
 [489 239  90  42]
 [143  21 209  31]
 [ 90   8 112  32]]
Validation val_loss: 0.8440353931252869
Validation normalized_cm: [[0.563 0.14  0.258 0.039]
 [0.569 0.278 0.105 0.049]
 [0.354 0.052 0.517 0.077]
 [0.372 0.033 0.463 0.132]]
Validation acc: 0.4435064935064935
Validation class_accuracies: [0.5628970775095299, 0.2779069767441861, 0.5173267326732673, 0.1322314049586777]
Validation sensitivity: 0.3187250996015936
Validation specificity: 0.5628970775095299
Validation icbhi_score: 0.4408110885555617
Validation roc_auc: None
Validation avg_accuracy: 0.3725905479714152
Validation one_indexed_epoch: 11
The validation tracker metric at 0.4535812700068004 hasn't increased by 0 in 1 epochs
299/299 - 195s - loss: 0.3455 - accuracy: 0.8159 - 195s/epoch - 652ms/step
here
There is no such attribute
here2
Epoch 12/110
Validation cm: [[862 230 376 106]
 [427 275  84  74]
 [118  35 180  71]
 [ 72  14  95  61]]
Validation val_loss: 0.8985713419971637
Validation normalized_cm: [[0.548 0.146 0.239 0.067]
 [0.497 0.32  0.098 0.086]
 [0.292 0.087 0.446 0.176]
 [0.298 0.058 0.393 0.252]]
Validation acc: 0.4474025974025974
Validation class_accuracies: [0.5476493011435832, 0.31976744186046513, 0.44554455445544555, 0.25206611570247933]
Validation sensitivity: 0.3426294820717131
Validation specificity: 0.5476493011435832
Validation icbhi_score: 0.44513939160764815
Validation roc_auc: None
Validation avg_accuracy: 0.3912568532904933
Validation one_indexed_epoch: 12
The validation tracker metric at 0.4535812700068004 hasn't increased by 0 in 2 epochs
299/299 - 196s - loss: 0.3020 - accuracy: 0.8343 - 196s/epoch - 657ms/step
here
There is no such attribute
here2
Epoch 13/110
Validation cm: [[582 342 431 219]
 [229 357 103 171]
 [ 71  46 153 134]
 [ 56  22  73  91]]
Validation val_loss: 1.030770527153932
Validation normalized_cm: [[0.37  0.217 0.274 0.139]
 [0.266 0.415 0.12  0.199]
 [0.176 0.114 0.379 0.332]
 [0.231 0.091 0.302 0.376]]
Validation acc: 0.3840909090909091
Validation class_accuracies: [0.3697585768742058, 0.41511627906976745, 0.3787128712871287, 0.3760330578512397]
Validation sensitivity: 0.399070385126162
Validation specificity: 0.3697585768742058
Validation icbhi_score: 0.38441448100018394
Validation roc_auc: None
Validation avg_accuracy: 0.38490519627058545
Validation one_indexed_epoch: 13
The validation tracker metric at 0.4535812700068004 hasn't increased by 0 in 3 epochs
299/299 - 200s - loss: 0.2821 - accuracy: 0.8335 - 200s/epoch - 669ms/step
here
There is no such attribute
here2
Epoch 14/110
Validation cm: [[897 310 329  38]
 [449 328  54  29]
 [134  67 162  41]
 [ 98  39  76  29]]
Validation val_loss: 0.8365079219852175
Validation normalized_cm: [[0.57  0.197 0.209 0.024]
 [0.522 0.381 0.063 0.034]
 [0.332 0.166 0.401 0.101]
 [0.405 0.161 0.314 0.12 ]]
Validation acc: 0.4597402597402597
Validation class_accuracies: [0.5698856416772554, 0.3813953488372093, 0.400990099009901, 0.11983471074380166]
Validation sensitivity: 0.34462151394422313
Validation specificity: 0.5698856416772554
Validation icbhi_score: 0.4572535778107393
Validation roc_auc: None
Validation avg_accuracy: 0.3680264500670418
Validation one_indexed_epoch: 14
-- New best results were achieved. --
299/299 - 204s - loss: 0.2505 - accuracy: 0.8524 - 204s/epoch - 681ms/step
here
There is no such attribute
here2
Epoch 15/110
Validation cm: [[983 241 247 103]
 [459 344  24  33]
 [153  69  95  87]
 [101  36  33  72]]
Validation val_loss: 0.9084958671683078
Validation normalized_cm: [[0.625 0.153 0.157 0.065]
 [0.534 0.4   0.028 0.038]
 [0.379 0.171 0.235 0.215]
 [0.417 0.149 0.136 0.298]]
Validation acc: 0.4850649350649351
Validation class_accuracies: [0.6245235069885642, 0.4, 0.23514851485148514, 0.2975206611570248]
Validation sensitivity: 0.3393094289508632
Validation specificity: 0.6245235069885642
Validation icbhi_score: 0.48191646796971366
Validation roc_auc: None
Validation avg_accuracy: 0.38929817074926854
Validation one_indexed_epoch: 15
-- New best results were achieved. --
299/299 - 202s - loss: 0.2261 - accuracy: 0.8616 - 202s/epoch - 675ms/step
here
There is no such attribute
here2
Epoch 16/110
Validation cm: [[951 182 389  52]
 [527 221  75  37]
 [153  23 180  48]
 [ 91  14  92  45]]
Validation val_loss: 1.0762865602008316
Validation normalized_cm: [[0.604 0.116 0.247 0.033]
 [0.613 0.257 0.087 0.043]
 [0.379 0.057 0.446 0.119]
 [0.376 0.058 0.38  0.186]]
Validation acc: 0.45357142857142857
Validation class_accuracies: [0.6041931385006353, 0.2569767441860465, 0.44554455445544555, 0.1859504132231405]
Validation sensitivity: 0.2961487383798141
Validation specificity: 0.6041931385006353
Validation icbhi_score: 0.4501709384402247
Validation roc_auc: None
Validation avg_accuracy: 0.37316621259131694
Validation one_indexed_epoch: 16
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 1 epochs
299/299 - 191s - loss: 0.2026 - accuracy: 0.8606 - 191s/epoch - 640ms/step
here
There is no such attribute
here2
Epoch 17/110
Validation cm: [[485 706 298  85]
 [174 593  40  53]
 [ 69 126 112  97]
 [ 53  64  47  78]]
Validation val_loss: 1.153689455142678
Validation normalized_cm: [[0.308 0.449 0.189 0.054]
 [0.202 0.69  0.047 0.062]
 [0.171 0.312 0.277 0.24 ]
 [0.219 0.264 0.194 0.322]]
Validation acc: 0.4116883116883117
Validation class_accuracies: [0.30813214739517153, 0.6895348837209302, 0.27722772277227725, 0.32231404958677684]
Validation sensitivity: 0.5199203187250996
Validation specificity: 0.30813214739517153
Validation icbhi_score: 0.41402623306013553
Validation roc_auc: None
Validation avg_accuracy: 0.399302200868789
Validation one_indexed_epoch: 17
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 2 epochs
299/299 - 183s - loss: 0.1729 - accuracy: 0.8597 - 183s/epoch - 612ms/step
here
There is no such attribute
here2
Epoch 18/110
Validation cm: [[570 627 313  64]
 [231 570  32  27]
 [118 101 136  49]
 [ 67  60  62  53]]
Validation val_loss: 1.022473157354035
Validation normalized_cm: [[0.362 0.398 0.199 0.041]
 [0.269 0.663 0.037 0.031]
 [0.292 0.25  0.337 0.121]
 [0.277 0.248 0.256 0.219]]
Validation acc: 0.4314935064935065
Validation class_accuracies: [0.36213468869123255, 0.6627906976744186, 0.33663366336633666, 0.2190082644628099]
Validation sensitivity: 0.5039840637450199
Validation specificity: 0.36213468869123255
Validation icbhi_score: 0.43305937621812624
Validation roc_auc: None
Validation avg_accuracy: 0.39514182854869945
Validation one_indexed_epoch: 18
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 3 epochs
299/299 - 185s - loss: 0.1784 - accuracy: 0.8566 - 185s/epoch - 619ms/step
here
There is no such attribute
here2
Epoch 19/110
Validation cm: [[882 311 361  20]
 [462 336  52  10]
 [168  34 191  11]
 [100  29 103  10]]
Validation val_loss: 1.1800910133054134
Validation normalized_cm: [[0.56  0.198 0.229 0.013]
 [0.537 0.391 0.06  0.012]
 [0.416 0.084 0.473 0.027]
 [0.413 0.12  0.426 0.041]]
Validation acc: 0.4607142857142857
Validation class_accuracies: [0.5603557814485387, 0.39069767441860465, 0.47277227722772275, 0.04132231404958678]
Validation sensitivity: 0.3565737051792829
Validation specificity: 0.5603557814485387
Validation icbhi_score: 0.4584647433139108
Validation roc_auc: None
Validation avg_accuracy: 0.3662870117861132
Validation one_indexed_epoch: 19
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 4 epochs
299/299 - 202s - loss: 0.1617 - accuracy: 0.8587 - 202s/epoch - 675ms/step
here
There is no such attribute
here2
Epoch 20/110
Validation cm: [[861 374 267  72]
 [369 422  34  35]
 [114 104 115  71]
 [ 89  49  46  58]]
Validation val_loss: 0.9821382914262453
Validation normalized_cm: [[0.547 0.238 0.17  0.046]
 [0.429 0.491 0.04  0.041]
 [0.282 0.257 0.285 0.176]
 [0.368 0.202 0.19  0.24 ]]
Validation acc: 0.4727272727272727
Validation class_accuracies: [0.5470139771283354, 0.4906976744186046, 0.28465346534653463, 0.2396694214876033]
Validation sensitivity: 0.3950863213811421
Validation specificity: 0.5470139771283354
Validation icbhi_score: 0.47105014925473876
Validation roc_auc: None
Validation avg_accuracy: 0.3905086345952695
Validation one_indexed_epoch: 20
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 5 epochs
299/299 - 217s - loss: 0.1360 - accuracy: 0.8593 - 217s/epoch - 724ms/step
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
here
There is no such attribute
here2
Epoch 21/110
Validation cm: [[859 309 337  69]
 [393 373  57  37]
 [139  46 150  69]
 [ 73  31  85  53]]
Validation val_loss: 1.2501787514536764
Validation normalized_cm: [[0.546 0.196 0.214 0.044]
 [0.457 0.434 0.066 0.043]
 [0.344 0.114 0.371 0.171]
 [0.302 0.128 0.351 0.219]]
Validation acc: 0.4659090909090909
Validation class_accuracies: [0.5457433290978398, 0.43372093023255814, 0.3712871287128713, 0.2190082644628099]
Validation sensitivity: 0.38247011952191234
Validation specificity: 0.5457433290978398
Validation icbhi_score: 0.4641067243098761
Validation roc_auc: None
Validation avg_accuracy: 0.3924399131265198
Validation one_indexed_epoch: 21
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 6 epochs
299/299 - 235s - loss: 0.1261 - accuracy: 0.8578 - 235s/epoch - 787ms/step
here
There is no such attribute
here2
Epoch 22/110
Validation cm: [[1159   16  398    1]
 [ 756   31   72    1]
 [ 201    2  200    1]
 [ 125    0  117    0]]
Validation val_loss: 1.3605221198103197
Validation normalized_cm: [[7.363e-01 1.017e-02 2.529e-01 6.353e-04]
 [8.791e-01 3.605e-02 8.372e-02 1.163e-03]
 [4.975e-01 4.950e-03 4.950e-01 2.475e-03]
 [5.165e-01 0.000e+00 4.835e-01 0.000e+00]]
Validation acc: 0.4512987012987013
Validation class_accuracies: [0.7363405336721728, 0.03604651162790698, 0.49504950495049505, 0.0]
Validation sensitivity: 0.15338645418326693
Validation specificity: 0.7363405336721728
Validation icbhi_score: 0.44486349392771984
Validation roc_auc: None
Validation avg_accuracy: 0.3168591375626437
Validation one_indexed_epoch: 22
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 7 epochs
299/299 - 231s - loss: 0.1461 - accuracy: 0.8421 - 231s/epoch - 772ms/step
here
There is no such attribute
here2
Epoch 23/110
Validation cm: [[1165    8  372   29]
 [ 731    2  116   11]
 [ 177    7  203   17]
 [ 116    0  112   14]]
Validation val_loss: 1.649087975992846
Validation normalized_cm: [[0.74  0.005 0.236 0.018]
 [0.85  0.002 0.135 0.013]
 [0.438 0.017 0.502 0.042]
 [0.479 0.    0.463 0.058]]
Validation acc: 0.44935064935064933
Validation class_accuracies: [0.7401524777636594, 0.002325581395348837, 0.5024752475247525, 0.05785123966942149]
Validation sensitivity: 0.1454183266932271
Validation specificity: 0.7401524777636594
Validation icbhi_score: 0.44278540222844326
Validation roc_auc: None
Validation avg_accuracy: 0.3257011365882956
Validation one_indexed_epoch: 23
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 8 epochs
299/299 - 235s - loss: 0.1143 - accuracy: 0.8518 - 235s/epoch - 784ms/step
here
There is no such attribute
here2
Epoch 24/110
Validation cm: [[1215    7  334   18]
 [ 730   10  109   11]
 [ 208    2  186    8]
 [ 118    0  111   13]]
Validation val_loss: 1.6933643221015087
Validation normalized_cm: [[0.772 0.004 0.212 0.011]
 [0.849 0.012 0.127 0.013]
 [0.515 0.005 0.46  0.02 ]
 [0.488 0.    0.459 0.054]]
Validation acc: 0.4623376623376623
Validation class_accuracies: [0.7719186785260482, 0.011627906976744186, 0.4603960396039604, 0.05371900826446281]
Validation sensitivity: 0.1387782204515272
Validation specificity: 0.7719186785260482
Validation icbhi_score: 0.4553484494887877
Validation roc_auc: None
Validation avg_accuracy: 0.3244154083428039
Validation one_indexed_epoch: 24
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 9 epochs
299/299 - 229s - loss: 0.1007 - accuracy: 0.8528 - 229s/epoch - 765ms/step
here
There is no such attribute
here2
Epoch 25/110
Validation cm: [[1237    1  318   18]
 [ 808    1   49    2]
 [ 237    0  157   10]
 [ 147    0   89    6]]
Validation val_loss: 1.628599572033466
Validation normalized_cm: [[7.859e-01 6.353e-04 2.020e-01 1.144e-02]
 [9.395e-01 1.163e-03 5.698e-02 2.326e-03]
 [5.866e-01 0.000e+00 3.886e-01 2.475e-02]
 [6.074e-01 0.000e+00 3.678e-01 2.479e-02]]
Validation acc: 0.45487012987012987
Validation class_accuracies: [0.7858958068614994, 0.0011627906976744186, 0.3886138613861386, 0.024793388429752067]
Validation sensitivity: 0.10889774236387782
Validation specificity: 0.7858958068614994
Validation icbhi_score: 0.4473967746126886
Validation roc_auc: None
Validation avg_accuracy: 0.3001164618437661
Validation one_indexed_epoch: 25
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 10 epochs
299/299 - 224s - loss: 0.1258 - accuracy: 0.8211 - 224s/epoch - 750ms/step
here
There is no such attribute
here2
Epoch 26/110
Validation cm: [[1076  163  287   48]
 [ 600  198   31   31]
 [ 169   54  124   57]
 [ 116   28   54   44]]
Validation val_loss: 1.1177245867756609
Validation normalized_cm: [[0.684 0.104 0.182 0.03 ]
 [0.698 0.23  0.036 0.036]
 [0.418 0.134 0.307 0.141]
 [0.479 0.116 0.223 0.182]]
Validation acc: 0.4681818181818182
Validation class_accuracies: [0.6836086404066074, 0.2302325581395349, 0.3069306930693069, 0.18181818181818182]
Validation sensitivity: 0.24302788844621515
Validation specificity: 0.6836086404066074
Validation icbhi_score: 0.4633182644264113
Validation roc_auc: None
Validation avg_accuracy: 0.3506475183584078
Validation one_indexed_epoch: 26
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 11 epochs
299/299 - 230s - loss: 0.0796 - accuracy: 0.8383 - 230s/epoch - 770ms/step
here
There is no such attribute
here2
Epoch 27/110
Validation cm: [[1196    8  345   25]
 [ 718    4  121   17]
 [ 188    4  206    6]
 [ 120    0  112   10]]
Validation val_loss: 2.250952039567563
Validation normalized_cm: [[0.76  0.005 0.219 0.016]
 [0.835 0.005 0.141 0.02 ]
 [0.465 0.01  0.51  0.015]
 [0.496 0.    0.463 0.041]]
Validation acc: 0.4597402597402597
Validation class_accuracies: [0.7598475222363406, 0.004651162790697674, 0.5099009900990099, 0.04132231404958678]
Validation sensitivity: 0.1460823373173971
Validation specificity: 0.7598475222363406
Validation icbhi_score: 0.4529649297768688
Validation roc_auc: None
Validation avg_accuracy: 0.3289304972939088
Validation one_indexed_epoch: 27
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 12 epochs
299/299 - 229s - loss: 0.0746 - accuracy: 0.8371 - 229s/epoch - 766ms/step
here
There is no such attribute
here2
Epoch 28/110
Validation cm: [[618 537 370  49]
 [270 495  64  31]
 [102  72 168  62]
 [ 60  41  92  49]]
Validation val_loss: 1.6003565541998495
Validation normalized_cm: [[0.393 0.341 0.235 0.031]
 [0.314 0.576 0.074 0.036]
 [0.252 0.178 0.416 0.153]
 [0.248 0.169 0.38  0.202]]
Validation acc: 0.4318181818181818
Validation class_accuracies: [0.3926302414231258, 0.5755813953488372, 0.4158415841584158, 0.2024793388429752]
Validation sensitivity: 0.47277556440903057
Validation specificity: 0.3926302414231258
Validation icbhi_score: 0.43270290291607816
Validation roc_auc: None
Validation avg_accuracy: 0.3966331399433385
Validation one_indexed_epoch: 28
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 13 epochs
299/299 - 228s - loss: 0.0716 - accuracy: 0.8218 - 228s/epoch - 764ms/step
here
There is no such attribute
here2
Epoch 29/110
Validation cm: [[1198   25  316   35]
 [ 739   39   60   22]
 [ 209    5  168   22]
 [ 127    7   74   34]]
Validation val_loss: 1.7004408001226956
Validation normalized_cm: [[0.761 0.016 0.201 0.022]
 [0.859 0.045 0.07  0.026]
 [0.517 0.012 0.416 0.054]
 [0.525 0.029 0.306 0.14 ]]
Validation acc: 0.4672077922077922
Validation class_accuracies: [0.761118170266836, 0.04534883720930233, 0.4158415841584158, 0.14049586776859505]
Validation sensitivity: 0.1600265604249668
Validation specificity: 0.761118170266836
Validation icbhi_score: 0.4605723653459014
Validation roc_auc: None
Validation avg_accuracy: 0.3407011148507873
Validation one_indexed_epoch: 29
The validation tracker metric at 0.48191646796971366 hasn't increased by 0 in 14 epochs
299/299 - 230s - loss: 0.0618 - accuracy: 0.8373 - 230s/epoch - 770ms/step
here
There is no such attribute
here2
Epoch 30/110
Validation cm: [[882 341 305  46]
 [406 382  44  28]
 [154  44 146  60]
 [ 93  30  73  46]]
Validation val_loss: 1.4485012297309772
Validation normalized_cm: [[0.56  0.217 0.194 0.029]
 [0.472 0.444 0.051 0.033]
 [0.381 0.109 0.361 0.149]
 [0.384 0.124 0.302 0.19 ]]
Validation acc: 0.4727272727272727
Validation class_accuracies: [0.5603557814485387, 0.4441860465116279, 0.3613861386138614, 0.19008264462809918]
Validation sensitivity: 0.38114209827357237
Validation specificity: 0.5603557814485387
Validation icbhi_score: 0.47074893986105554
Validation roc_auc: None
Validation avg_accuracy: 0.3890026528005318
Validation one_indexed_epoch: 30
The number of epochs since last 1% equals the patience
299/299 - 235s - loss: 0.0578 - accuracy: 0.8402 - 235s/epoch - 786ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.48191646796971366
Best cm: [[983 241 247 103]
 [459 344  24  33]
 [153  69  95  87]
 [101  36  33  72]]
Best val_loss: 0.9084958671683078
Best normalized_cm: [[0.625 0.153 0.157 0.065]
 [0.534 0.4   0.028 0.038]
 [0.379 0.171 0.235 0.215]
 [0.417 0.149 0.136 0.298]]
Best acc: 0.4850649350649351
Best class_accuracies: [0.6245235069885642, 0.4, 0.23514851485148514, 0.2975206611570248]
Best sensitivity: 0.3393094289508632
Best specificity: 0.6245235069885642
Best roc_auc: None
Best avg_accuracy: 0.38929817074926854
Best one_indexed_epoch: 15
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7100971341133118, 0.6694532632827759, 0.6296510100364685, 0.5932139754295349, 0.5562306642532349, 0.5260553956031799, 0.4990178644657135, 0.46207916736602783, 0.4134742021560669, 0.3838967978954315, 0.34548619389533997, 0.3020380437374115, 0.2821439504623413, 0.2504690885543823, 0.22611352801322937, 0.2025652825832367, 0.1729060709476471, 0.17842622101306915, 0.16166482865810394, 0.13604086637496948, 0.126098170876503, 0.14607398211956024, 0.11427981406450272, 0.10071192681789398, 0.12582135200500488, 0.07956290990114212, 0.07457077503204346, 0.07164610922336578, 0.0618291012942791, 0.057787541300058365], 'accuracy': [0.6311595439910889, 0.6196267604827881, 0.6303208470344543, 0.7070664763450623, 0.7385196089744568, 0.733277440071106, 0.7630530595779419, 0.7771021127700806, 0.7951352596282959, 0.8096036911010742, 0.8158943057060242, 0.8343468308448792, 0.8335080742835999, 0.8523799777030945, 0.8616061806678772, 0.8605577945709229, 0.8597190380096436, 0.8565737009048462, 0.8586705923080444, 0.8592996597290039, 0.8578318357467651, 0.8421052694320679, 0.851750910282135, 0.8527993559837341, 0.8211365342140198, 0.838330864906311, 0.8370727896690369, 0.8217655420303345, 0.8372824788093567, 0.8402180671691895]}
End
####################################
Job dir: ../cache/cw/train198/2
Job id is 3.
Job dir: ../cache/cw/train198/3
- Loading Icbhi.
920 Icbhi audios have been loaded.
- Preparing Icbhi.
126 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 4.
len(_all_samples)
7857
-----------------------
--- Final training dataset went from 0 to 4769 elements, with 2299 none's, 1353 crakles, 554 wheezes and 563 both ---
--- Final Validation dataset contains 3080 elements, with 1574 none, 860 crackles, 404 wheezes and 242 both ---
GPUs
['/device:GPU:0']
Initializing weights...
weights = {0: 0.518595041322314, 1: 0.881189948263119, 2: 2.152075812274368, 3: 2.1176731793960926}
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 efficientnetb1 (Functional)  (None, 3, 16, 1280)      6575239   
                                                                 
 global_average_pooling2d_1   (None, 1280)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_3 (Dense)             (None, 100)               128100    
                                                                 
 dropout_2 (Dropout)         (None, 100)               0         
                                                                 
 dense_4 (Dense)             (None, 50)                5050      
                                                                 
 dropout_3 (Dropout)         (None, 50)                0         
                                                                 
 dense_5 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 6,708,491
Trainable params: 6,646,436
Non-trainable params: 62,055
_________________________________________________________________
Model: "leaf_model9_model_efnet1_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   6708491          
                                                                                                              
==============================================================================================================
Total params: 6,708,653
Trainable params: 6,646,598
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is icbhi_score
here
There is no such attribute
here2
Epoch 1/110
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[1291   14  266    3]
 [ 734    5  121    0]
 [ 314    7   83    0]
 [ 199    4   38    1]]
Validation val_loss: 0.6636096710702042
Validation normalized_cm: [[0.82  0.009 0.169 0.002]
 [0.853 0.006 0.141 0.   ]
 [0.777 0.017 0.205 0.   ]
 [0.822 0.017 0.157 0.004]]
Validation acc: 0.44805194805194803
Validation class_accuracies: [0.8202033036848793, 0.005813953488372093, 0.20544554455445543, 0.004132231404958678]
Validation sensitivity: 0.05909694555112882
Validation specificity: 0.8202033036848793
Validation icbhi_score: 0.439650124618004
Validation roc_auc: None
Validation avg_accuracy: 0.2588987582831664
Validation one_indexed_epoch: 1
-- New best results were achieved. --
299/299 - 286s - loss: 0.7099 - accuracy: 0.4993 - 286s/epoch - 958ms/step
here
There is no such attribute
here2
Epoch 2/110
Validation cm: [[556 163 620 235]
 [307  80 360 113]
 [126  36 195  47]
 [ 57  32 108  45]]
Validation val_loss: 0.6903716338532312
Validation normalized_cm: [[0.353 0.104 0.394 0.149]
 [0.357 0.093 0.419 0.131]
 [0.312 0.089 0.483 0.116]
 [0.236 0.132 0.446 0.186]]
Validation acc: 0.2844155844155844
Validation class_accuracies: [0.35324015247776364, 0.09302325581395349, 0.48267326732673266, 0.1859504132231405]
Validation sensitivity: 0.21248339973439576
Validation specificity: 0.35324015247776364
Validation icbhi_score: 0.2828617761060797
Validation roc_auc: None
Validation avg_accuracy: 0.27872177221039757
Validation one_indexed_epoch: 2
The validation tracker metric at 0.439650124618004 hasn't increased by 0 in 1 epochs
299/299 - 263s - loss: 0.6984 - accuracy: 0.4882 - 263s/epoch - 881ms/step
here
There is no such attribute
here2
Epoch 3/110
