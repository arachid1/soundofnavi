Validation cm: [[  0 740   0   0]
 [  0  92   0   0]
 [  0  77   0   0]
 [  0 130   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.08854667949951876
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train38
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization (BatchNormalization)        multiple                                    4                
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_3 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense (Dense)                                   multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[1. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 654s - loss: 0.5110 - accuracy: 0.5749 - 654s/epoch - 2s/step
Validation cm: [[701   9  30   0]
 [ 71   2  18   1]
 [ 63   0  14   0]
 [ 50   1  79   0]]
Validation normalized_cm: [[0.947 0.012 0.041 0.   ]
 [0.772 0.022 0.196 0.011]
 [0.818 0.    0.182 0.   ]
 [0.385 0.008 0.608 0.   ]]
Validation acc: 0.6900866217516843
Validation class_accuracies: [0.9472972972972973, 0.021739130434782608, 0.18181818181818182, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2877136523875654
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 672s - loss: 0.4057 - accuracy: 0.5994 - 672s/epoch - 2s/step
Validation cm: [[655  78   7   0]
 [ 55  35   2   0]
 [ 64  10   1   2]
 [ 61  16  52   1]]
Validation normalized_cm: [[0.885 0.105 0.009 0.   ]
 [0.598 0.38  0.022 0.   ]
 [0.831 0.13  0.013 0.026]
 [0.469 0.123 0.4   0.008]]
Validation acc: 0.6660250240615977
Validation class_accuracies: [0.8851351351351351, 0.3804347826086957, 0.012987012987012988, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32156230960578785
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 669s - loss: 0.3823 - accuracy: 0.6003 - 669s/epoch - 2s/step
Validation cm: [[624  39  71   6]
 [ 57  20  11   4]
 [ 31   1  35  10]
 [ 28   2  70  30]]
Validation normalized_cm: [[0.843 0.053 0.096 0.008]
 [0.62  0.217 0.12  0.043]
 [0.403 0.013 0.455 0.13 ]
 [0.215 0.015 0.538 0.231]]
Validation acc: 0.6823869104908566
Validation class_accuracies: [0.8432432432432433, 0.21739130434782608, 0.45454545454545453, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4364873082264387
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 671s - loss: 0.3609 - accuracy: 0.6248 - 671s/epoch - 2s/step
Validation cm: [[604 113  23   0]
 [ 28  41  23   0]
 [ 53   6  17   1]
 [ 20  22  81   7]]
Validation normalized_cm: [[0.816 0.153 0.031 0.   ]
 [0.304 0.446 0.25  0.   ]
 [0.688 0.078 0.221 0.013]
 [0.154 0.169 0.623 0.054]]
Validation acc: 0.643888354186718
Validation class_accuracies: [0.8162162162162162, 0.44565217391304346, 0.22077922077922077, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3841234411886586
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.4364873082264387 hasn't increased by 0 in 1 epochs
330/330 - 663s - loss: 0.3415 - accuracy: 0.5849 - 663s/epoch - 2s/step
Validation cm: [[600 127  12   1]
 [ 31  52   8   1]
 [ 36  16  18   7]
 [ 38  18  65   9]]
Validation normalized_cm: [[0.811 0.172 0.016 0.001]
 [0.337 0.565 0.087 0.011]
 [0.468 0.208 0.234 0.091]
 [0.292 0.138 0.5   0.069]]
Validation acc: 0.6535129932627527
Validation class_accuracies: [0.8108108108108109, 0.5652173913043478, 0.23376623376623376, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4197563012780404
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.4364873082264387 hasn't increased by 0 in 2 epochs
330/330 - 654s - loss: 0.3293 - accuracy: 0.5988 - 654s/epoch - 2s/step
Validation cm: [[537 127  65  11]
 [ 18  54  13   7]
 [ 29   8  38   2]
 [  5  15  80  30]]
Validation normalized_cm: [[0.726 0.172 0.088 0.015]
 [0.196 0.587 0.141 0.076]
 [0.377 0.104 0.494 0.026]
 [0.038 0.115 0.615 0.231]]
Validation acc: 0.6342637151106834
Validation class_accuracies: [0.7256756756756757, 0.5869565217391305, 0.4935064935064935, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5092269804226326
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 689s - loss: 0.3192 - accuracy: 0.6109 - 689s/epoch - 2s/step
Validation cm: [[593 100  34  13]
 [ 40  37  10   5]
 [ 30   6  34   7]
 [ 15  11  84  20]]
Validation normalized_cm: [[0.801 0.135 0.046 0.018]
 [0.435 0.402 0.109 0.054]
 [0.39  0.078 0.442 0.091]
 [0.115 0.085 0.646 0.154]]
Validation acc: 0.65832531280077
Validation class_accuracies: [0.8013513513513514, 0.40217391304347827, 0.44155844155844154, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4497324649498562
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5092269804226326 hasn't increased by 0 in 1 epochs
330/330 - 657s - loss: 0.3005 - accuracy: 0.6601 - 657s/epoch - 2s/step
Validation cm: [[621  55  48  16]
 [ 40  29   7  16]
 [ 36   2  29  10]
 [ 45  14  22  49]]
Validation normalized_cm: [[0.839 0.074 0.065 0.022]
 [0.435 0.315 0.076 0.174]
 [0.468 0.026 0.377 0.13 ]
 [0.346 0.108 0.169 0.377]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8391891891891892, 0.31521739130434784, 0.37662337662337664, 0.3769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47698825850999765
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5092269804226326 hasn't increased by 0 in 2 epochs
330/330 - 658s - loss: 0.2903 - accuracy: 0.6421 - 658s/epoch - 2s/step
Validation cm: [[457 255  20   8]
 [ 11  62  10   9]
 [ 26  19  13  19]
 [  5  24  56  45]]
Validation normalized_cm: [[0.618 0.345 0.027 0.011]
 [0.12  0.674 0.109 0.098]
 [0.338 0.247 0.169 0.247]
 [0.038 0.185 0.431 0.346]]
Validation acc: 0.5553416746871992
Validation class_accuracies: [0.6175675675675676, 0.6739130434782609, 0.16883116883116883, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45161640650771084
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5092269804226326 hasn't increased by 0 in 3 epochs
330/330 - 653s - loss: 0.2790 - accuracy: 0.6011 - 653s/epoch - 2s/step
Validation cm: [[645  84   5   6]
 [ 46  37   6   3]
 [ 47  12  11   7]
 [ 44  14  42  30]]
Validation normalized_cm: [[0.872 0.114 0.007 0.008]
 [0.5   0.402 0.065 0.033]
 [0.61  0.156 0.143 0.091]
 [0.338 0.108 0.323 0.231]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.8716216216216216, 0.40217391304347827, 0.14285714285714285, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4118554770728684
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.5092269804226326 hasn't increased by 0 in 4 epochs
330/330 - 656s - loss: 0.2622 - accuracy: 0.6394 - 656s/epoch - 2s/step
Validation cm: [[558 100  63  19]
 [ 35  33  14  10]
 [ 13   7  34  23]
 [  7  15  52  56]]
Validation normalized_cm: [[0.754 0.135 0.085 0.026]
 [0.38  0.359 0.152 0.109]
 [0.169 0.091 0.442 0.299]
 [0.054 0.115 0.4   0.431]]
Validation acc: 0.6554379210779596
Validation class_accuracies: [0.754054054054054, 0.358695652173913, 0.44155844155844154, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4962693446389098
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5092269804226326 hasn't increased by 0 in 5 epochs
330/330 - 652s - loss: 0.2577 - accuracy: 0.6143 - 652s/epoch - 2s/step
Validation cm: [[462  50 168  60]
 [ 18  24  15  35]
 [  9   2  36  30]
 [  2   4  18 106]]
Validation normalized_cm: [[0.624 0.068 0.227 0.081]
 [0.196 0.261 0.163 0.38 ]
 [0.117 0.026 0.468 0.39 ]
 [0.015 0.031 0.138 0.815]]
Validation acc: 0.6044273339749759
Validation class_accuracies: [0.6243243243243243, 0.2608695652173913, 0.4675324675324675, 0.8153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5420277431146996
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 618s - loss: 0.2487 - accuracy: 0.5999 - 618s/epoch - 2s/step
Validation cm: [[643  67  26   4]
 [ 54  25   8   5]
 [ 31   8  29   9]
 [ 29   9  43  49]]
Validation normalized_cm: [[0.869 0.091 0.035 0.005]
 [0.587 0.272 0.087 0.054]
 [0.403 0.104 0.377 0.117]
 [0.223 0.069 0.331 0.377]]
Validation acc: 0.7179980750721848
Validation class_accuracies: [0.8689189189189189, 0.2717391304347826, 0.37662337662337664, 0.3769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47355112572503877
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.5420277431146996 hasn't increased by 0 in 1 epochs
330/330 - 615s - loss: 0.2291 - accuracy: 0.6333 - 615s/epoch - 2s/step
Validation cm: [[639  69  21  11]
 [ 40  29  15   8]
 [ 34   3  32   8]
 [ 33  23  36  38]]
Validation normalized_cm: [[0.864 0.093 0.028 0.015]
 [0.435 0.315 0.163 0.087]
 [0.442 0.039 0.416 0.104]
 [0.254 0.177 0.277 0.292]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.8635135135135135, 0.31521739130434784, 0.4155844155844156, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47165575317749237
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.5420277431146996 hasn't increased by 0 in 2 epochs
330/330 - 617s - loss: 0.2208 - accuracy: 0.6341 - 617s/epoch - 2s/step
Validation cm: [[644  56  25  15]
 [ 50  31   5   6]
 [ 36   4  34   3]
 [ 40  29  35  26]]
Validation normalized_cm: [[0.87  0.076 0.034 0.02 ]
 [0.543 0.337 0.054 0.065]
 [0.468 0.052 0.442 0.039]
 [0.308 0.223 0.269 0.2  ]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.8702702702702703, 0.33695652173913043, 0.44155844155844154, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4621963083919605
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.5420277431146996 hasn't increased by 0 in 3 epochs
330/330 - 608s - loss: 0.2086 - accuracy: 0.6529 - 608s/epoch - 2s/step
Validation cm: [[622  70  29  19]
 [ 25  40  20   7]
 [ 48   6  21   2]
 [ 22  16  72  20]]
Validation normalized_cm: [[0.841 0.095 0.039 0.026]
 [0.272 0.435 0.217 0.076]
 [0.623 0.078 0.273 0.026]
 [0.169 0.123 0.554 0.154]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.8405405405405405, 0.43478260869565216, 0.2727272727272727, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4254741439524048
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The validation tracker metric at 0.5420277431146996 hasn't increased by 0 in 4 epochs
330/330 - 614s - loss: 0.2040 - accuracy: 0.6529 - 614s/epoch - 2s/step
Validation cm: [[627  82  22   9]
 [ 30  33  21   8]
 [ 33  11  25   8]
 [ 12  20  56  42]]
Validation normalized_cm: [[0.847 0.111 0.03  0.012]
 [0.326 0.359 0.228 0.087]
 [0.429 0.143 0.325 0.104]
 [0.092 0.154 0.431 0.323]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.8472972972972973, 0.358695652173913, 0.3246753246753247, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4634362993058645
Validation one_indexed_epoch: 18
Epoch 18/20
[[0. 0.]]
The validation tracker metric at 0.5420277431146996 hasn't increased by 0 in 5 epochs
330/330 - 599s - loss: 0.1810 - accuracy: 0.6367 - 599s/epoch - 2s/step
Validation cm: [[588  85  38  29]
 [ 30  33   9  20]
 [ 22   6  31  18]
 [ 12  29  26  63]]
Validation normalized_cm: [[0.795 0.115 0.051 0.039]
 [0.326 0.359 0.098 0.217]
 [0.286 0.078 0.403 0.234]
 [0.092 0.223 0.2   0.485]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.7945945945945946, 0.358695652173913, 0.4025974025974026, 0.4846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5101257584953237
Validation one_indexed_epoch: 19
Epoch 19/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 619s - loss: 0.1801 - accuracy: 0.6403 - 619s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5420277431146996
Best cm: [[462  50 168  60]
 [ 18  24  15  35]
 [  9   2  36  30]
 [  2   4  18 106]]
Best normalized_cm: [[0.624 0.068 0.227 0.081]
 [0.196 0.261 0.163 0.38 ]
 [0.117 0.026 0.468 0.39 ]
 [0.015 0.031 0.138 0.815]]
Best acc: 0.6044273339749759
Best class_accuracies: [0.6243243243243243, 0.2608695652173913, 0.4675324675324675, 0.8153846153846154]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 13
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_4 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_1 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 726s - accuracy: 0.6068 - student_loss: 0.2806 - distillation_loss: -4.1521e-03 - val_accuracy: 0.0847 - val_student_loss: 0.3140 - 726s/epoch - 2s/step
Validation cm: [[575 146  12   7]
 [ 20  56  11   5]
 [ 41  11  16   9]
 [ 18  28  71  13]]
Validation normalized_cm: [[0.777 0.197 0.016 0.009]
 [0.217 0.609 0.12  0.054]
 [0.532 0.143 0.208 0.117]
 [0.138 0.215 0.546 0.1  ]]
Validation acc: 0.6352261790182868
Validation class_accuracies: [0.777027027027027, 0.6086956521739131, 0.2077922077922078, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.423378721748287
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 711s - accuracy: 0.6517 - student_loss: 0.3966 - distillation_loss: 8.6148e-04 - val_accuracy: 0.7430 - val_student_loss: 0.6020 - 711s/epoch - 2s/step
Validation cm: [[634  87  17   2]
 [ 32  47  11   2]
 [ 63   4   9   1]
 [ 23  21  76  10]]
Validation normalized_cm: [[0.857 0.118 0.023 0.003]
 [0.348 0.511 0.12  0.022]
 [0.818 0.052 0.117 0.013]
 [0.177 0.162 0.585 0.077]]
Validation acc: 0.6737247353224254
Validation class_accuracies: [0.8567567567567568, 0.5108695652173914, 0.11688311688311688, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3903581289450855
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
The validation tracker metric at 0.423378721748287 hasn't increased by 0 in 1 epochs
330/330 - 730s - accuracy: 0.6533 - student_loss: 0.6601 - distillation_loss: 4.7994e-04 - val_accuracy: 0.7613 - val_student_loss: 1.0775 - 730s/epoch - 2s/step
Validation cm: [[547  86  55  52]
 [ 16  34  13  29]
 [ 20   3  37  17]
 [  3   9  64  54]]
Validation normalized_cm: [[0.739 0.116 0.074 0.07 ]
 [0.174 0.37  0.141 0.315]
 [0.26  0.039 0.481 0.221]
 [0.023 0.069 0.492 0.415]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.7391891891891892, 0.3695652173913043, 0.4805194805194805, 0.4153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5011646256211474
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 721s - accuracy: 0.6798 - student_loss: 0.2615 - distillation_loss: 0.0047 - val_accuracy: 0.6218 - val_student_loss: 1.7512 - 721s/epoch - 2s/step
Validation cm: [[643  87   6   4]
 [ 38  41   5   8]
 [ 40   9  14  14]
 [ 48  19  42  21]]
Validation normalized_cm: [[0.869 0.118 0.008 0.005]
 [0.413 0.446 0.054 0.087]
 [0.519 0.117 0.182 0.182]
 [0.369 0.146 0.323 0.162]]
Validation acc: 0.6920115495668913
Validation class_accuracies: [0.8689189189189189, 0.44565217391304346, 0.18181818181818182, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4144819340471515
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.5011646256211474 hasn't increased by 0 in 1 epochs
330/330 - 711s - accuracy: 0.6650 - student_loss: 0.1818 - distillation_loss: 0.0041 - val_accuracy: 0.7815 - val_student_loss: 0.1948 - 711s/epoch - 2s/step
Validation cm: [[559 165   9   7]
 [ 17  56  10   9]
 [ 48  12   9   8]
 [ 15  26  60  29]]
Validation normalized_cm: [[0.755 0.223 0.012 0.009]
 [0.185 0.609 0.109 0.098]
 [0.623 0.156 0.117 0.104]
 [0.115 0.2   0.462 0.223]]
Validation acc: 0.6284889316650626
Validation class_accuracies: [0.7554054054054054, 0.6086956521739131, 0.11688311688311688, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4260152743848396
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.5011646256211474 hasn't increased by 0 in 2 epochs
330/330 - 703s - accuracy: 0.6574 - student_loss: 0.2154 - distillation_loss: 0.0067 - val_accuracy: 0.7353 - val_student_loss: 1.6790 - 703s/epoch - 2s/step
Validation cm: [[553 135  34  18]
 [ 18  49  11  14]
 [ 21   8  24  24]
 [  8  18  62  42]]
Validation normalized_cm: [[0.747 0.182 0.046 0.024]
 [0.196 0.533 0.12  0.152]
 [0.273 0.104 0.312 0.312]
 [0.062 0.138 0.477 0.323]]
Validation acc: 0.6429258902791145
Validation class_accuracies: [0.7472972972972973, 0.532608695652174, 0.3116883116883117, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47866780692867655
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.5011646256211474 hasn't increased by 0 in 3 epochs
330/330 - 736s - accuracy: 0.6665 - student_loss: 0.1121 - distillation_loss: -3.5613e-05 - val_accuracy: 0.6506 - val_student_loss: 1.6964 - 736s/epoch - 2s/step
Validation cm: [[518  32 140  50]
 [ 23  11  28  30]
 [ 16   1  42  18]
 [  3   2  65  60]]
Validation normalized_cm: [[0.7   0.043 0.189 0.068]
 [0.25  0.12  0.304 0.326]
 [0.208 0.013 0.545 0.234]
 [0.023 0.015 0.5   0.462]]
Validation acc: 0.6073147256977863
Validation class_accuracies: [0.7, 0.11956521739130435, 0.5454545454545454, 0.46153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45663955609607787
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5011646256211474 hasn't increased by 0 in 4 epochs
330/330 - 716s - accuracy: 0.6595 - student_loss: 0.0816 - distillation_loss: 9.6031e-04 - val_accuracy: 0.2762 - val_student_loss: 2.4807 - 716s/epoch - 2s/step
Validation cm: [[513  98  59  70]
 [ 13  37  12  30]
 [ 16   4  25  32]
 [  4   7  50  69]]
Validation normalized_cm: [[0.693 0.132 0.08  0.095]
 [0.141 0.402 0.13  0.326]
 [0.208 0.052 0.325 0.416]
 [0.031 0.054 0.385 0.531]]
Validation acc: 0.6198267564966313
Validation class_accuracies: [0.6932432432432433, 0.40217391304347827, 0.3246753246753247, 0.5307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4877154279328193
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5011646256211474 hasn't increased by 0 in 5 epochs
330/330 - 704s - accuracy: 0.6779 - student_loss: 0.3696 - distillation_loss: -2.8783e-03 - val_accuracy: 0.5467 - val_student_loss: 2.1941 - 704s/epoch - 2s/step
Validation cm: [[658  77   5   0]
 [ 50  35   6   1]
 [ 55   5  15   2]
 [ 51  17  40  22]]
Validation normalized_cm: [[0.889 0.104 0.007 0.   ]
 [0.543 0.38  0.065 0.011]
 [0.714 0.065 0.195 0.026]
 [0.392 0.131 0.308 0.169]]
Validation acc: 0.7025986525505293
Validation class_accuracies: [0.8891891891891892, 0.3804347826086957, 0.19480519480519481, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40841498395846226
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 732s - accuracy: 0.6571 - student_loss: 0.3327 - distillation_loss: 0.0089 - val_accuracy: 0.6833 - val_student_loss: 0.1049 - 732s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5011646256211474
Best cm: [[547  86  55  52]
 [ 16  34  13  29]
 [ 20   3  37  17]
 [  3   9  64  54]]
Best normalized_cm: [[0.739 0.116 0.074 0.07 ]
 [0.174 0.37  0.141 0.315]
 [0.26  0.039 0.481 0.221]
 [0.023 0.069 0.492 0.415]]
Best acc: 0.6467757459095284
Best class_accuracies: [0.7391891891891892, 0.3695652173913043, 0.4805194805194805, 0.4153846153846154]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 4
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
