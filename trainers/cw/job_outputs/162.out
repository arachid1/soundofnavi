Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train162
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
Job id is 1.
Job dir: ../cache/cw/train162/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
-----------------------
--- Final training dataset went from 0 to 3969 elements, with 1889 none's, 991 crakles, 597 wheezes and 492 both ---
--- Final Validation dataset contains 2096 elements, with 989 none, 843 crackles, 120 wheezes and 144 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5252779248279513, 1: 1.0012613521695257, 2: 1.6620603015075377, 3: 2.0167682926829267}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_1[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               204900    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[710  14 181  84]
 [675  10 118  40]
 [ 78   0  32  10]
 [115   0  27   2]]
Validation normalized_cm: [[0.718 0.014 0.183 0.085]
 [0.801 0.012 0.14  0.047]
 [0.65  0.    0.267 0.083]
 [0.799 0.    0.188 0.014]]
Validation acc: 0.3597328244274809
Validation class_accuracies: [0.717896865520728, 0.011862396204033215, 0.26666666666666666, 0.013888888888888888]
Validation sensitivity: 0.03974706413730804
Validation specificity: 0.717896865520728
Validation icbhi_score: 0.378821964829018
Validation roc_auc: None
Validation avg_accuracy: 0.2525787043200792
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
249/249 - 164s - loss: 0.6678 - accuracy: 0.6410 - 164s/epoch - 660ms/step
Epoch 2/80
Validation cm: [[163 362  79 385]
 [ 68 321  67 387]
 [  4   8  46  62]
 [  1  25  27  91]]
Validation normalized_cm: [[0.165 0.366 0.08  0.389]
 [0.081 0.381 0.079 0.459]
 [0.033 0.067 0.383 0.517]
 [0.007 0.174 0.188 0.632]]
Validation acc: 0.29627862595419846
Validation class_accuracies: [0.16481294236602628, 0.3807829181494662, 0.38333333333333336, 0.6319444444444444]
Validation sensitivity: 0.4137308039747064
Validation specificity: 0.16481294236602628
Validation icbhi_score: 0.28927187317036634
Validation roc_auc: None
Validation avg_accuracy: 0.39021840957331755
Validation one_indexed_epoch: 2
The validation tracker metric at 0.378821964829018 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 157s - loss: 0.5647 - accuracy: 0.7317 - 157s/epoch - 630ms/step
Epoch 3/80
Validation cm: [[707 209  63  10]
 [492 317  23  11]
 [ 30  19  64   7]
 [ 61  39  39   5]]
Validation normalized_cm: [[0.715 0.211 0.064 0.01 ]
 [0.584 0.376 0.027 0.013]
 [0.25  0.158 0.533 0.058]
 [0.424 0.271 0.271 0.035]]
Validation acc: 0.521469465648855
Validation class_accuracies: [0.7148634984833164, 0.3760379596678529, 0.5333333333333333, 0.034722222222222224]
Validation sensitivity: 0.3486901535682023
Validation specificity: 0.7148634984833164
Validation icbhi_score: 0.5317768260257594
Validation roc_auc: None
Validation avg_accuracy: 0.4147392534266813
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
249/249 - 154s - loss: 0.4986 - accuracy: 0.7596 - 154s/epoch - 619ms/step
Epoch 4/80
Validation cm: [[842  46  71  30]
 [767  20  45  11]
 [ 54   2  60   4]
 [107   0  36   1]]
Validation normalized_cm: [[0.851 0.047 0.072 0.03 ]
 [0.91  0.024 0.053 0.013]
 [0.45  0.017 0.5   0.033]
 [0.743 0.    0.25  0.007]]
Validation acc: 0.44036259541984735
Validation class_accuracies: [0.8513650151668352, 0.02372479240806643, 0.5, 0.006944444444444444]
Validation sensitivity: 0.07317073170731707
Validation specificity: 0.8513650151668352
Validation icbhi_score: 0.4622678734370761
Validation roc_auc: None
Validation avg_accuracy: 0.3455085630048365
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 155s - loss: 0.4384 - accuracy: 0.7891 - 155s/epoch - 622ms/step
Epoch 5/80
Validation cm: [[688 116 155  30]
 [651  93  78  21]
 [ 26   5  83   6]
 [ 72   6  50  16]]
Validation normalized_cm: [[0.696 0.117 0.157 0.03 ]
 [0.772 0.11  0.093 0.025]
 [0.217 0.042 0.692 0.05 ]
 [0.5   0.042 0.347 0.111]]
Validation acc: 0.4198473282442748
Validation class_accuracies: [0.6956521739130435, 0.1103202846975089, 0.6916666666666667, 0.1111111111111111]
Validation sensitivity: 0.17344173441734417
Validation specificity: 0.6956521739130435
Validation icbhi_score: 0.43454695416519384
Validation roc_auc: None
Validation avg_accuracy: 0.40218755909708254
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 157s - loss: 0.3816 - accuracy: 0.8035 - 157s/epoch - 629ms/step
Epoch 6/80
Validation cm: [[173 564  63 189]
 [ 41 597  15 190]
 [  5  18  24  73]
 [  1  43  19  81]]
Validation normalized_cm: [[0.175 0.57  0.064 0.191]
 [0.049 0.708 0.018 0.225]
 [0.042 0.15  0.2   0.608]
 [0.007 0.299 0.132 0.562]]
Validation acc: 0.4174618320610687
Validation class_accuracies: [0.17492416582406473, 0.708185053380783, 0.2, 0.5625]
Validation sensitivity: 0.6341463414634146
Validation specificity: 0.17492416582406473
Validation icbhi_score: 0.40453525364373966
Validation roc_auc: None
Validation avg_accuracy: 0.4114023048012119
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 167s - loss: 0.3310 - accuracy: 0.8052 - 167s/epoch - 670ms/step
Epoch 7/80
Validation cm: [[250 580  93  66]
 [143 611  36  53]
 [ 15  23  67  15]
 [ 19  60  28  37]]
Validation normalized_cm: [[0.253 0.586 0.094 0.067]
 [0.17  0.725 0.043 0.063]
 [0.125 0.192 0.558 0.125]
 [0.132 0.417 0.194 0.257]]
Validation acc: 0.4604007633587786
Validation class_accuracies: [0.2527805864509606, 0.7247924080664294, 0.5583333333333333, 0.2569444444444444]
Validation sensitivity: 0.6458897922312556
Validation specificity: 0.2527805864509606
Validation icbhi_score: 0.4493351893411081
Validation roc_auc: None
Validation avg_accuracy: 0.4482126930737919
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 163s - loss: 0.2936 - accuracy: 0.8042 - 163s/epoch - 653ms/step
Epoch 8/80
Validation cm: [[383 399  29 178]
 [404 348  12  79]
 [ 21  15  10  74]
 [ 44  30  20  50]]
Validation normalized_cm: [[0.387 0.403 0.029 0.18 ]
 [0.479 0.413 0.014 0.094]
 [0.175 0.125 0.083 0.617]
 [0.306 0.208 0.139 0.347]]
Validation acc: 0.3773854961832061
Validation class_accuracies: [0.3872598584428716, 0.4128113879003559, 0.08333333333333333, 0.3472222222222222]
Validation sensitivity: 0.3685636856368564
Validation specificity: 0.3872598584428716
Validation icbhi_score: 0.377911772039864
Validation roc_auc: None
Validation avg_accuracy: 0.30765670047469573
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 164s - loss: 0.2260 - accuracy: 0.8017 - 164s/epoch - 657ms/step
Epoch 9/80
Validation cm: [[525 204 158 102]
 [512 116 132  83]
 [ 22   5  34  59]
 [ 45  28  32  39]]
Validation normalized_cm: [[0.531 0.206 0.16  0.103]
 [0.607 0.138 0.157 0.098]
 [0.183 0.042 0.283 0.492]
 [0.312 0.194 0.222 0.271]]
Validation acc: 0.34064885496183206
Validation class_accuracies: [0.5308392315470172, 0.1376037959667853, 0.2833333333333333, 0.2708333333333333]
Validation sensitivity: 0.17073170731707318
Validation specificity: 0.5308392315470172
Validation icbhi_score: 0.3507854694320452
Validation roc_auc: None
Validation avg_accuracy: 0.3056524235451173
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 154s - loss: 0.1929 - accuracy: 0.8050 - 154s/epoch - 619ms/step
Epoch 10/80
Validation cm: [[719 203  28  39]
 [645 169  16  13]
 [ 44  17  43  16]
 [ 87  23  29   5]]
Validation normalized_cm: [[0.727 0.205 0.028 0.039]
 [0.765 0.2   0.019 0.015]
 [0.367 0.142 0.358 0.133]
 [0.604 0.16  0.201 0.035]]
Validation acc: 0.44656488549618323
Validation class_accuracies: [0.7269969666329625, 0.20047449584816132, 0.35833333333333334, 0.034722222222222224]
Validation sensitivity: 0.1960252935862692
Validation specificity: 0.7269969666329625
Validation icbhi_score: 0.46151113010961586
Validation roc_auc: None
Validation avg_accuracy: 0.3301317545091699
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 139s - loss: 0.1889 - accuracy: 0.7811 - 139s/epoch - 560ms/step
Epoch 11/80
Validation cm: [[366 531  29  63]
 [188 594   9  52]
 [ 19  43  23  35]
 [ 27  69   9  39]]
Validation normalized_cm: [[0.37  0.537 0.029 0.064]
 [0.223 0.705 0.011 0.062]
 [0.158 0.358 0.192 0.292]
 [0.188 0.479 0.062 0.271]]
Validation acc: 0.48759541984732824
Validation class_accuracies: [0.3700707785642063, 0.7046263345195729, 0.19166666666666668, 0.2708333333333333]
Validation sensitivity: 0.5925925925925926
Validation specificity: 0.3700707785642063
Validation icbhi_score: 0.48133168557839945
Validation roc_auc: None
Validation avg_accuracy: 0.3842992782709448
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 131s - loss: 0.1480 - accuracy: 0.7906 - 131s/epoch - 527ms/step
Epoch 12/80
Validation cm: [[696 160 101  32]
 [561 194  60  28]
 [ 34   8  62  16]
 [ 66  15  54   9]]
Validation normalized_cm: [[0.704 0.162 0.102 0.032]
 [0.665 0.23  0.071 0.033]
 [0.283 0.067 0.517 0.133]
 [0.458 0.104 0.375 0.062]]
Validation acc: 0.45849236641221375
Validation class_accuracies: [0.7037411526794742, 0.23013048635824437, 0.5166666666666667, 0.0625]
Validation sensitivity: 0.23938572719060525
Validation specificity: 0.7037411526794742
Validation icbhi_score: 0.47156343993503974
Validation roc_auc: None
Validation avg_accuracy: 0.3782595764260963
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 135s - loss: 0.1079 - accuracy: 0.8025 - 135s/epoch - 544ms/step
Epoch 13/80
Validation cm: [[257 326 134 272]
 [110 290 109 334]
 [ 16   7  28  69]
 [ 12  32  38  62]]
Validation normalized_cm: [[0.26  0.33  0.135 0.275]
 [0.13  0.344 0.129 0.396]
 [0.133 0.058 0.233 0.575]
 [0.083 0.222 0.264 0.431]]
Validation acc: 0.303912213740458
Validation class_accuracies: [0.25985844287158744, 0.34400948991696323, 0.23333333333333334, 0.4305555555555556]
Validation sensitivity: 0.34327009936766034
Validation specificity: 0.25985844287158744
Validation icbhi_score: 0.3015642711196239
Validation roc_auc: None
Validation avg_accuracy: 0.3169392054193599
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 10 epochs
There is no such attribute
249/249 - 133s - loss: 0.0749 - accuracy: 0.7949 - 133s/epoch - 532ms/step
Epoch 14/80
Validation cm: [[751 144  59  35]
 [596 189  37  21]
 [ 47   6  53  14]
 [ 71  20  42  11]]
Validation normalized_cm: [[0.759 0.146 0.06  0.035]
 [0.707 0.224 0.044 0.025]
 [0.392 0.05  0.442 0.117]
 [0.493 0.139 0.292 0.076]]
Validation acc: 0.47900763358778625
Validation class_accuracies: [0.7593528816986855, 0.22419928825622776, 0.44166666666666665, 0.0763888888888889]
Validation sensitivity: 0.22854561878952123
Validation specificity: 0.7593528816986855
Validation icbhi_score: 0.4939492502441034
Validation roc_auc: None
Validation avg_accuracy: 0.3754019313776172
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 11 epochs
There is no such attribute
249/249 - 138s - loss: 0.0684 - accuracy: 0.7972 - 138s/epoch - 553ms/step
Epoch 15/80
Validation cm: [[312 501  48 128]
 [176 537  35  95]
 [ 17  17  36  50]
 [ 23  45  29  47]]
Validation normalized_cm: [[0.315 0.507 0.049 0.129]
 [0.209 0.637 0.042 0.113]
 [0.142 0.142 0.3   0.417]
 [0.16  0.312 0.201 0.326]]
Validation acc: 0.4446564885496183
Validation class_accuracies: [0.3154701718907988, 0.6370106761565836, 0.3, 0.3263888888888889]
Validation sensitivity: 0.5600722673893406
Validation specificity: 0.3154701718907988
Validation icbhi_score: 0.4377712196400697
Validation roc_auc: None
Validation avg_accuracy: 0.3947174342340678
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 12 epochs
There is no such attribute
249/249 - 152s - loss: 0.0555 - accuracy: 0.7937 - 152s/epoch - 610ms/step
Epoch 16/80
Validation cm: [[740 124  71  54]
 [661 100  48  34]
 [ 34   6  70  10]
 [ 83   8  28  25]]
Validation normalized_cm: [[0.748 0.125 0.072 0.055]
 [0.784 0.119 0.057 0.04 ]
 [0.283 0.05  0.583 0.083]
 [0.576 0.056 0.194 0.174]]
Validation acc: 0.446087786259542
Validation class_accuracies: [0.7482305358948432, 0.11862396204033215, 0.5833333333333334, 0.1736111111111111]
Validation sensitivity: 0.17615176151761516
Validation specificity: 0.7482305358948432
Validation icbhi_score: 0.4621911487062292
Validation roc_auc: None
Validation avg_accuracy: 0.405949735594905
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 13 epochs
There is no such attribute
249/249 - 167s - loss: 0.0908 - accuracy: 0.7866 - 167s/epoch - 672ms/step
Epoch 17/80
Validation cm: [[405 343  71 170]
 [235 403  51 154]
 [ 17   9  37  57]
 [ 14  46  27  57]]
Validation normalized_cm: [[0.41  0.347 0.072 0.172]
 [0.279 0.478 0.06  0.183]
 [0.142 0.075 0.308 0.475]
 [0.097 0.319 0.188 0.396]]
Validation acc: 0.4303435114503817
Validation class_accuracies: [0.40950455005055614, 0.47805456702253857, 0.30833333333333335, 0.3958333333333333]
Validation sensitivity: 0.44896115627822947
Validation specificity: 0.40950455005055614
Validation icbhi_score: 0.4292328531643928
Validation roc_auc: None
Validation avg_accuracy: 0.39793144593494034
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 14 epochs
There is no such attribute
249/249 - 161s - loss: 0.0760 - accuracy: 0.7430 - 161s/epoch - 646ms/step
Epoch 18/80
Validation cm: [[723 159  60  47]
 [595 173  46  29]
 [ 39   4  57  20]
 [ 81   6  44  13]]
Validation normalized_cm: [[0.731 0.161 0.061 0.048]
 [0.706 0.205 0.055 0.034]
 [0.325 0.033 0.475 0.167]
 [0.562 0.042 0.306 0.09 ]]
Validation acc: 0.46087786259541985
Validation class_accuracies: [0.731041456016178, 0.20521945432977462, 0.475, 0.09027777777777778]
Validation sensitivity: 0.21951219512195122
Validation specificity: 0.731041456016178
Validation icbhi_score: 0.4752768255690646
Validation roc_auc: None
Validation avg_accuracy: 0.37538467203093256
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 15 epochs
There is no such attribute
249/249 - 168s - loss: 0.0462 - accuracy: 0.7712 - 168s/epoch - 674ms/step
Epoch 19/80
Validation cm: [[504 290  68 127]
 [495 164  77 107]
 [ 24   6  33  57]
 [ 29  29  44  42]]
Validation normalized_cm: [[0.51  0.293 0.069 0.128]
 [0.587 0.195 0.091 0.127]
 [0.2   0.05  0.275 0.475]
 [0.201 0.201 0.306 0.292]]
Validation acc: 0.3544847328244275
Validation class_accuracies: [0.5096056622851365, 0.19454329774614473, 0.275, 0.2916666666666667]
Validation sensitivity: 0.21589882565492322
Validation specificity: 0.5096056622851365
Validation icbhi_score: 0.36275224397002986
Validation roc_auc: None
Validation avg_accuracy: 0.317703906674487
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
249/249 - 167s - loss: 0.0535 - accuracy: 0.7259 - 167s/epoch - 669ms/step
Epoch 20/80
Validation cm: [[671 215  60  43]
 [527 242  38  36]
 [ 32  12  59  17]
 [ 50  34  39  21]]
Validation normalized_cm: [[0.678 0.217 0.061 0.043]
 [0.625 0.287 0.045 0.043]
 [0.267 0.1   0.492 0.142]
 [0.347 0.236 0.271 0.146]]
Validation acc: 0.4737595419847328
Validation class_accuracies: [0.6784630940343782, 0.2870699881376038, 0.49166666666666664, 0.14583333333333334]
Validation sensitivity: 0.2908762420957543
Validation specificity: 0.6784630940343782
Validation icbhi_score: 0.4846696680650663
Validation roc_auc: None
Validation avg_accuracy: 0.4007582705429955
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 17 epochs
There is no such attribute
249/249 - 173s - loss: 0.0378 - accuracy: 0.7768 - 173s/epoch - 697ms/step
Epoch 21/80
Validation cm: [[685 182  41  81]
 [565 200  22  56]
 [ 31   6  39  44]
 [ 59  28  26  31]]
Validation normalized_cm: [[0.693 0.184 0.041 0.082]
 [0.67  0.237 0.026 0.066]
 [0.258 0.05  0.325 0.367]
 [0.41  0.194 0.181 0.215]]
Validation acc: 0.4556297709923664
Validation class_accuracies: [0.6926188068756319, 0.2372479240806643, 0.325, 0.2152777777777778]
Validation sensitivity: 0.24390243902439024
Validation specificity: 0.6926188068756319
Validation icbhi_score: 0.4682606229500111
Validation roc_auc: None
Validation avg_accuracy: 0.36753612718351847
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 18 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 166s - loss: 0.0323 - accuracy: 0.7632 - 166s/epoch - 668ms/step
Epoch 22/80
Validation cm: [[497 365  58  69]
 [261 472  47  63]
 [ 23  14  48  35]
 [ 35  46  35  28]]
Validation normalized_cm: [[0.503 0.369 0.059 0.07 ]
 [0.31  0.56  0.056 0.075]
 [0.192 0.117 0.4   0.292]
 [0.243 0.319 0.243 0.194]]
Validation acc: 0.4985687022900763
Validation class_accuracies: [0.5025278058645096, 0.5599051008303677, 0.4, 0.19444444444444445]
Validation sensitivity: 0.4950316169828365
Validation specificity: 0.5025278058645096
Validation icbhi_score: 0.49877971142367306
Validation roc_auc: None
Validation avg_accuracy: 0.4142193377848304
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5317768260257594 hasn't increased by 0 in 19 epochs
There is no such attribute
249/249 - 167s - loss: 0.0264 - accuracy: 0.7518 - 167s/epoch - 670ms/step
Epoch 23/80
Validation cm: [[505 337  57  90]
 [359 379  39  66]
 [ 28  17  44  31]
 [ 37  48  31  28]]
Validation normalized_cm: [[0.511 0.341 0.058 0.091]
 [0.426 0.45  0.046 0.078]
 [0.233 0.142 0.367 0.258]
 [0.257 0.333 0.215 0.194]]
Validation acc: 0.45610687022900764
Validation class_accuracies: [0.5106167846309403, 0.44958481613285883, 0.36666666666666664, 0.19444444444444445]
Validation sensitivity: 0.4074074074074074
Validation specificity: 0.5106167846309403
Validation icbhi_score: 0.4590120960191738
Validation roc_auc: None
Validation avg_accuracy: 0.38032817796872753
Validation one_indexed_epoch: 23
The number of epochs since last 1% equals the patience
There is no such attribute
249/249 - 167s - loss: 0.0280 - accuracy: 0.7496 - 167s/epoch - 672ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5317768260257594
Best cm: [[707 209  63  10]
 [492 317  23  11]
 [ 30  19  64   7]
 [ 61  39  39   5]]
Best normalized_cm: [[0.715 0.211 0.064 0.01 ]
 [0.584 0.376 0.027 0.013]
 [0.25  0.158 0.533 0.058]
 [0.424 0.271 0.271 0.035]]
Best acc: 0.521469465648855
Best class_accuracies: [0.7148634984833164, 0.3760379596678529, 0.5333333333333333, 0.034722222222222224]
Best sensitivity: 0.3486901535682023
Best specificity: 0.7148634984833164
Best roc_auc: None
Best avg_accuracy: 0.4147392534266813
Best one_indexed_epoch: 3
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6678032279014587, 0.5646577477455139, 0.4986402690410614, 0.43837204575538635, 0.38161635398864746, 0.3309742510318756, 0.2935512363910675, 0.22596414387226105, 0.19289106130599976, 0.18888317048549652, 0.14799879491329193, 0.1078762337565422, 0.07493512332439423, 0.06843721866607666, 0.0555085614323616, 0.0908016487956047, 0.07598543912172318, 0.04623746499419212, 0.053481701761484146, 0.03784246742725372, 0.03226248919963837, 0.02636445127427578, 0.02796260453760624], 'accuracy': [0.6409674882888794, 0.7316704392433167, 0.759637176990509, 0.7891156673431396, 0.8034769296646118, 0.8052406311035156, 0.8042327761650085, 0.8017132878303528, 0.80498868227005, 0.7810531854629517, 0.7906273603439331, 0.8024691343307495, 0.7949105501174927, 0.7971781492233276, 0.7936508059501648, 0.7865961194038391, 0.7430083155632019, 0.7712270021438599, 0.7258755564689636, 0.7767699956893921, 0.7631645202636719, 0.7518266439437866, 0.7495591044425964]}
Job id is 3.
-----------------------
--- Final training dataset went from 0 to 4342 elements, with 1949 none's, 1225 crakles, 605 wheezes and 563 both ---
--- Final Validation dataset contains 1723 elements, with 929 none, 609 crackles, 112 wheezes and 73 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5569522832221652, 1: 0.8861224489795918, 2: 1.7942148760330578, 3: 1.9280639431616342}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_2 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_2[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_1   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_3 (Dense)             (None, 100)               204900    
                                                                 
 dropout_2 (Dropout)         (None, 100)               0         
                                                                 
 dense_4 (Dense)             (None, 50)                5050      
                                                                 
 dropout_3 (Dropout)         (None, 50)                0         
                                                                 
 dense_5 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 20 909   0   0]
 [ 11 598   0   0]
 [  2 110   0   0]
 [  4  69   0   0]]
Validation normalized_cm: [[0.022 0.978 0.    0.   ]
 [0.018 0.982 0.    0.   ]
 [0.018 0.982 0.    0.   ]
 [0.055 0.945 0.    0.   ]]
Validation acc: 0.3586767266395821
Validation class_accuracies: [0.021528525296017224, 0.9819376026272578, 0.0, 0.0]
Validation sensitivity: 0.7531486146095718
Validation specificity: 0.021528525296017224
Validation icbhi_score: 0.38733856995279453
Validation roc_auc: None
Validation avg_accuracy: 0.25086653198081876
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
272/272 - 155s - loss: 0.6493 - accuracy: 0.5721 - 155s/epoch - 569ms/step
Epoch 2/80
Validation cm: [[254 375 120 180]
 [106 253  96 154]
 [ 24  14  41  33]
 [ 21  22  16  14]]
Validation normalized_cm: [[0.273 0.404 0.129 0.194]
 [0.174 0.415 0.158 0.253]
 [0.214 0.125 0.366 0.295]
 [0.288 0.301 0.219 0.192]]
Validation acc: 0.3261752756819501
Validation class_accuracies: [0.27341227125941875, 0.4154351395730706, 0.36607142857142855, 0.1917808219178082]
Validation sensitivity: 0.3879093198992443
Validation specificity: 0.27341227125941875
Validation icbhi_score: 0.33066079557933153
Validation roc_auc: None
Validation avg_accuracy: 0.31167491533043157
Validation one_indexed_epoch: 2
The validation tracker metric at 0.38733856995279453 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 139s - loss: 0.5362 - accuracy: 0.7190 - 139s/epoch - 512ms/step
Epoch 3/80
Validation cm: [[340 477  46  66]
 [ 67 482  12  48]
 [ 19  17  38  38]
 [  8  41  15   9]]
Validation normalized_cm: [[0.366 0.513 0.05  0.071]
 [0.11  0.791 0.02  0.079]
 [0.17  0.152 0.339 0.339]
 [0.11  0.562 0.205 0.123]]
Validation acc: 0.5043528728961114
Validation class_accuracies: [0.36598493003229277, 0.7914614121510674, 0.3392857142857143, 0.1232876712328767]
Validation sensitivity: 0.6662468513853904
Validation specificity: 0.36598493003229277
Validation icbhi_score: 0.5161158907088416
Validation roc_auc: None
Validation avg_accuracy: 0.4050049319254878
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
272/272 - 143s - loss: 0.4763 - accuracy: 0.7444 - 143s/epoch - 526ms/step
Epoch 4/80
Validation cm: [[755 148  10  16]
 [352 240   7  10]
 [ 57  26   9  20]
 [ 50  13   7   3]]
Validation normalized_cm: [[0.813 0.159 0.011 0.017]
 [0.578 0.394 0.011 0.016]
 [0.509 0.232 0.08  0.179]
 [0.685 0.178 0.096 0.041]]
Validation acc: 0.5844457341845618
Validation class_accuracies: [0.8127018299246501, 0.39408866995073893, 0.08035714285714286, 0.0410958904109589]
Validation sensitivity: 0.31738035264483627
Validation specificity: 0.8127018299246501
Validation icbhi_score: 0.5650410912847432
Validation roc_auc: None
Validation avg_accuracy: 0.3320608832858727
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
272/272 - 146s - loss: 0.4199 - accuracy: 0.7637 - 146s/epoch - 538ms/step
Epoch 5/80
Validation cm: [[249 351  37 292]
 [ 67 275  13 254]
 [ 15  16  11  70]
 [  8  34   9  22]]
Validation normalized_cm: [[0.268 0.378 0.04  0.314]
 [0.11  0.452 0.021 0.417]
 [0.134 0.143 0.098 0.625]
 [0.11  0.466 0.123 0.301]]
Validation acc: 0.3232733604178758
Validation class_accuracies: [0.2680301399354144, 0.451559934318555, 0.09821428571428571, 0.3013698630136986]
Validation sensitivity: 0.3879093198992443
Validation specificity: 0.2680301399354144
Validation icbhi_score: 0.32796972991732937
Validation roc_auc: None
Validation avg_accuracy: 0.2797935557454884
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 144s - loss: 0.3674 - accuracy: 0.7635 - 144s/epoch - 530ms/step
Epoch 6/80
Validation cm: [[119 682  22 106]
 [ 28 522   7  52]
 [  1  41  25  45]
 [  0  50   9  14]]
Validation normalized_cm: [[0.128 0.734 0.024 0.114]
 [0.046 0.857 0.011 0.085]
 [0.009 0.366 0.223 0.402]
 [0.    0.685 0.123 0.192]]
Validation acc: 0.3946604759141033
Validation class_accuracies: [0.12809472551130247, 0.8571428571428571, 0.22321428571428573, 0.1917808219178082]
Validation sensitivity: 0.7065491183879093
Validation specificity: 0.12809472551130247
Validation icbhi_score: 0.41732192194960593
Validation roc_auc: None
Validation avg_accuracy: 0.35005817257156335
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 143s - loss: 0.3303 - accuracy: 0.7720 - 143s/epoch - 527ms/step
Epoch 7/80
Validation cm: [[318 353  28 230]
 [ 99 313   9 188]
 [ 11   9  15  77]
 [ 11  22  10  30]]
Validation normalized_cm: [[0.342 0.38  0.03  0.248]
 [0.163 0.514 0.015 0.309]
 [0.098 0.08  0.134 0.688]
 [0.151 0.301 0.137 0.411]]
Validation acc: 0.3923389437028439
Validation class_accuracies: [0.34230355220667386, 0.5139573070607554, 0.13392857142857142, 0.410958904109589]
Validation sensitivity: 0.4508816120906801
Validation specificity: 0.34230355220667386
Validation icbhi_score: 0.396592582148677
Validation roc_auc: None
Validation avg_accuracy: 0.3502870837013974
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 139s - loss: 0.2835 - accuracy: 0.7897 - 139s/epoch - 510ms/step
Epoch 8/80
Validation cm: [[740 108  53  28]
 [383 187  17  22]
 [ 37   7  44  24]
 [ 32  15  23   3]]
Validation normalized_cm: [[0.797 0.116 0.057 0.03 ]
 [0.629 0.307 0.028 0.036]
 [0.33  0.062 0.393 0.214]
 [0.438 0.205 0.315 0.041]]
Validation acc: 0.5652930934416716
Validation class_accuracies: [0.7965554359526372, 0.3070607553366174, 0.39285714285714285, 0.0410958904109589]
Validation sensitivity: 0.2947103274559194
Validation specificity: 0.7965554359526372
Validation icbhi_score: 0.5456328817042784
Validation roc_auc: None
Validation avg_accuracy: 0.38439230613933906
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 4 epochs
There is no such attribute
272/272 - 147s - loss: 0.2263 - accuracy: 0.7911 - 147s/epoch - 540ms/step
Epoch 9/80
Validation cm: [[156 724   4  45]
 [ 42 529   1  37]
 [  6  63   3  40]
 [  8  51   3  11]]
Validation normalized_cm: [[0.168 0.779 0.004 0.048]
 [0.069 0.869 0.002 0.061]
 [0.054 0.562 0.027 0.357]
 [0.11  0.699 0.041 0.151]]
Validation acc: 0.4056877539175856
Validation class_accuracies: [0.16792249730893433, 0.8686371100164204, 0.026785714285714284, 0.1506849315068493]
Validation sensitivity: 0.6838790931989924
Validation specificity: 0.16792249730893433
Validation icbhi_score: 0.4259007952539634
Validation roc_auc: None
Validation avg_accuracy: 0.30350756327947953
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 5 epochs
There is no such attribute
272/272 - 153s - loss: 0.1998 - accuracy: 0.7941 - 153s/epoch - 562ms/step
Epoch 10/80
Validation cm: [[154 512  79 184]
 [ 37 361  29 182]
 [  8  20  35  49]
 [ 12  31  19  11]]
Validation normalized_cm: [[0.166 0.551 0.085 0.198]
 [0.061 0.593 0.048 0.299]
 [0.071 0.179 0.312 0.438]
 [0.164 0.425 0.26  0.151]]
Validation acc: 0.3255948926291352
Validation class_accuracies: [0.16576964477933262, 0.5927750410509032, 0.3125, 0.1506849315068493]
Validation sensitivity: 0.5125944584382871
Validation specificity: 0.16576964477933262
Validation icbhi_score: 0.3391820516088099
Validation roc_auc: None
Validation avg_accuracy: 0.30543240433427127
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 6 epochs
There is no such attribute
272/272 - 142s - loss: 0.1793 - accuracy: 0.7992 - 142s/epoch - 522ms/step
Epoch 11/80
Validation cm: [[341 121 250 217]
 [105 165 100 239]
 [ 17   2  50  43]
 [ 15  12  28  18]]
Validation normalized_cm: [[0.367 0.13  0.269 0.234]
 [0.172 0.271 0.164 0.392]
 [0.152 0.018 0.446 0.384]
 [0.205 0.164 0.384 0.247]]
Validation acc: 0.3331398723157284
Validation class_accuracies: [0.36706135629709363, 0.270935960591133, 0.44642857142857145, 0.2465753424657534]
Validation sensitivity: 0.29345088161209065
Validation specificity: 0.36706135629709363
Validation icbhi_score: 0.33025611895459217
Validation roc_auc: None
Validation avg_accuracy: 0.33275030769563785
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
272/272 - 143s - loss: 0.1576 - accuracy: 0.7805 - 143s/epoch - 525ms/step
Epoch 12/80
Validation cm: [[718 132  40  39]
 [379 192  12  26]
 [ 49  14  35  14]
 [ 32  19  19   3]]
Validation normalized_cm: [[0.773 0.142 0.043 0.042]
 [0.622 0.315 0.02  0.043]
 [0.438 0.125 0.312 0.125]
 [0.438 0.26  0.26  0.041]]
Validation acc: 0.5502031340684852
Validation class_accuracies: [0.7728740581270183, 0.31527093596059114, 0.3125, 0.0410958904109589]
Validation sensitivity: 0.28967254408060455
Validation specificity: 0.7728740581270183
Validation icbhi_score: 0.5312733011038114
Validation roc_auc: None
Validation avg_accuracy: 0.36043522112464205
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
272/272 - 175s - loss: 0.1538 - accuracy: 0.7642 - 175s/epoch - 642ms/step
Epoch 13/80
Validation cm: [[431 401  22  75]
 [155 398   8  48]
 [ 20  29  17  46]
 [ 21  29  17   6]]
Validation normalized_cm: [[0.464 0.432 0.024 0.081]
 [0.255 0.654 0.013 0.079]
 [0.179 0.259 0.152 0.411]
 [0.288 0.397 0.233 0.082]]
Validation acc: 0.4944863609982589
Validation class_accuracies: [0.4639397201291712, 0.6535303776683087, 0.15178571428571427, 0.0821917808219178]
Validation sensitivity: 0.5302267002518891
Validation specificity: 0.4639397201291712
Validation icbhi_score: 0.49708321019053014
Validation roc_auc: None
Validation avg_accuracy: 0.337861898226278
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 9 epochs
There is no such attribute
272/272 - 149s - loss: 0.0901 - accuracy: 0.7768 - 149s/epoch - 549ms/step
Epoch 14/80
Validation cm: [[588 235  43  63]
 [233 310  15  51]
 [ 30  13  37  32]
 [ 29  20  17   7]]
Validation normalized_cm: [[0.633 0.253 0.046 0.068]
 [0.383 0.509 0.025 0.084]
 [0.268 0.116 0.33  0.286]
 [0.397 0.274 0.233 0.096]]
Validation acc: 0.546720835751596
Validation class_accuracies: [0.6329386437029063, 0.5090311986863711, 0.33035714285714285, 0.0958904109589041]
Validation sensitivity: 0.44584382871536526
Validation specificity: 0.6329386437029063
Validation icbhi_score: 0.5393912362091358
Validation roc_auc: None
Validation avg_accuracy: 0.3920543490513311
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 10 epochs
There is no such attribute
272/272 - 142s - loss: 0.0589 - accuracy: 0.7821 - 142s/epoch - 521ms/step
Epoch 15/80
Validation cm: [[147  52 109 621]
 [ 32  50  31 496]
 [  4   4  17  87]
 [ 10   4   8  51]]
Validation normalized_cm: [[0.158 0.056 0.117 0.668]
 [0.053 0.082 0.051 0.814]
 [0.036 0.036 0.152 0.777]
 [0.137 0.055 0.11  0.699]]
Validation acc: 0.1538015089959373
Validation class_accuracies: [0.15823466092572658, 0.08210180623973727, 0.15178571428571427, 0.6986301369863014]
Validation sensitivity: 0.1486146095717884
Validation specificity: 0.15823466092572658
Validation icbhi_score: 0.1534246352487575
Validation roc_auc: None
Validation avg_accuracy: 0.2726880796093699
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 11 epochs
There is no such attribute
272/272 - 143s - loss: 0.0795 - accuracy: 0.7715 - 143s/epoch - 527ms/step
Epoch 16/80
Validation cm: [[498 280  57  94]
 [189 298  27  95]
 [ 30  11  39  32]
 [ 23  21  22   7]]
Validation normalized_cm: [[0.536 0.301 0.061 0.101]
 [0.31  0.489 0.044 0.156]
 [0.268 0.098 0.348 0.286]
 [0.315 0.288 0.301 0.096]]
Validation acc: 0.4886825304701103
Validation class_accuracies: [0.5360602798708288, 0.48932676518883417, 0.3482142857142857, 0.0958904109589041]
Validation sensitivity: 0.4332493702770781
Validation specificity: 0.5360602798708288
Validation icbhi_score: 0.48465482507395347
Validation roc_auc: None
Validation avg_accuracy: 0.36737293543321314
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 12 epochs
There is no such attribute
272/272 - 144s - loss: 0.0470 - accuracy: 0.7803 - 144s/epoch - 530ms/step
Epoch 17/80
Validation cm: [[520 357  14  38]
 [218 369   2  20]
 [ 35  31  23  23]
 [ 26  34   5   8]]
Validation normalized_cm: [[0.56  0.384 0.015 0.041]
 [0.358 0.606 0.003 0.033]
 [0.312 0.277 0.205 0.205]
 [0.356 0.466 0.068 0.11 ]]
Validation acc: 0.5339524085896692
Validation class_accuracies: [0.5597416576964478, 0.6059113300492611, 0.20535714285714285, 0.1095890410958904]
Validation sensitivity: 0.5037783375314862
Validation specificity: 0.5597416576964478
Validation icbhi_score: 0.531759997613967
Validation roc_auc: None
Validation avg_accuracy: 0.37014979292468553
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 13 epochs
There is no such attribute
272/272 - 153s - loss: 0.0507 - accuracy: 0.7807 - 153s/epoch - 562ms/step
Epoch 18/80
Validation cm: [[399 373  42 115]
 [144 346  24  95]
 [ 16  17  33  46]
 [ 18  26  18  11]]
Validation normalized_cm: [[0.429 0.402 0.045 0.124]
 [0.236 0.568 0.039 0.156]
 [0.143 0.152 0.295 0.411]
 [0.247 0.356 0.247 0.151]]
Validation acc: 0.4579222286709228
Validation class_accuracies: [0.4294940796555436, 0.5681444991789819, 0.29464285714285715, 0.1506849315068493]
Validation sensitivity: 0.491183879093199
Validation specificity: 0.4294940796555436
Validation icbhi_score: 0.4603389793743713
Validation roc_auc: None
Validation avg_accuracy: 0.360741591871058
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 14 epochs
There is no such attribute
272/272 - 143s - loss: 0.0415 - accuracy: 0.7821 - 143s/epoch - 526ms/step
Epoch 19/80
Validation cm: [[498 311  42  78]
 [194 335  15  65]
 [ 27  20  33  32]
 [ 28  26  14   5]]
Validation normalized_cm: [[0.536 0.335 0.045 0.084]
 [0.319 0.55  0.025 0.107]
 [0.241 0.179 0.295 0.286]
 [0.384 0.356 0.192 0.068]]
Validation acc: 0.5055136390017412
Validation class_accuracies: [0.5360602798708288, 0.5500821018062397, 0.29464285714285715, 0.0684931506849315]
Validation sensitivity: 0.46977329974811083
Validation specificity: 0.5360602798708288
Validation icbhi_score: 0.5029167898094699
Validation roc_auc: None
Validation avg_accuracy: 0.36231959737621433
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 15 epochs
There is no such attribute
272/272 - 148s - loss: 0.0400 - accuracy: 0.7584 - 148s/epoch - 542ms/step
Epoch 20/80
Validation cm: [[673 151  52  53]
 [311 222  21  55]
 [ 42  11  29  30]
 [ 36  18  15   4]]
Validation normalized_cm: [[0.724 0.163 0.056 0.057]
 [0.511 0.365 0.034 0.09 ]
 [0.375 0.098 0.259 0.268]
 [0.493 0.247 0.205 0.055]]
Validation acc: 0.538595473012188
Validation class_accuracies: [0.7244348762109796, 0.3645320197044335, 0.25892857142857145, 0.0547945205479452]
Validation sensitivity: 0.3211586901763224
Validation specificity: 0.7244348762109796
Validation icbhi_score: 0.522796783193651
Validation roc_auc: None
Validation avg_accuracy: 0.3506724969729824
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
272/272 - 145s - loss: 0.0312 - accuracy: 0.7814 - 145s/epoch - 532ms/step
Epoch 21/80
Validation cm: [[551 272  44  62]
 [239 288  20  62]
 [ 33  22  36  21]
 [ 26  27  13   7]]
Validation normalized_cm: [[0.593 0.293 0.047 0.067]
 [0.392 0.473 0.033 0.102]
 [0.295 0.196 0.321 0.188]
 [0.356 0.37  0.178 0.096]]
Validation acc: 0.5118978525827046
Validation class_accuracies: [0.5931108719052745, 0.4729064039408867, 0.32142857142857145, 0.0958904109589041]
Validation sensitivity: 0.4168765743073048
Validation specificity: 0.5931108719052745
Validation icbhi_score: 0.5049937231062896
Validation roc_auc: None
Validation avg_accuracy: 0.3708340645584091
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 17 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
272/272 - 155s - loss: 0.0224 - accuracy: 0.7821 - 155s/epoch - 571ms/step
Epoch 22/80
Validation cm: [[584 223  54  68]
 [267 265  25  52]
 [ 30  16  46  20]
 [ 30  19  17   7]]
Validation normalized_cm: [[0.629 0.24  0.058 0.073]
 [0.438 0.435 0.041 0.085]
 [0.268 0.143 0.411 0.179]
 [0.411 0.26  0.233 0.096]]
Validation acc: 0.5235055136390018
Validation class_accuracies: [0.628632938643703, 0.4351395730706076, 0.4107142857142857, 0.0958904109589041]
Validation sensitivity: 0.4005037783375315
Validation specificity: 0.628632938643703
Validation icbhi_score: 0.5145683584906172
Validation roc_auc: None
Validation avg_accuracy: 0.39259430209687507
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 18 epochs
There is no such attribute
272/272 - 146s - loss: 0.0243 - accuracy: 0.7683 - 146s/epoch - 538ms/step
Epoch 23/80
Validation cm: [[379 411  43  96]
 [120 397  18  74]
 [ 20  27  26  39]
 [ 21  30  11  11]]
Validation normalized_cm: [[0.408 0.442 0.046 0.103]
 [0.197 0.652 0.03  0.122]
 [0.179 0.241 0.232 0.348]
 [0.288 0.411 0.151 0.151]]
Validation acc: 0.4718514219384794
Validation class_accuracies: [0.40796555435952636, 0.6518883415435139, 0.23214285714285715, 0.1506849315068493]
Validation sensitivity: 0.5465994962216625
Validation specificity: 0.40796555435952636
Validation icbhi_score: 0.47728252529059445
Validation roc_auc: None
Validation avg_accuracy: 0.3606704211381867
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5650410912847432 hasn't increased by 0 in 19 epochs
There is no such attribute
272/272 - 148s - loss: 0.0232 - accuracy: 0.7704 - 148s/epoch - 546ms/step
Epoch 24/80
Validation cm: [[554 252  45  78]
 [226 295  17  71]
 [ 28  16  26  42]
 [ 26  26   9  12]]
Validation normalized_cm: [[0.596 0.271 0.048 0.084]
 [0.371 0.484 0.028 0.117]
 [0.25  0.143 0.232 0.375]
 [0.356 0.356 0.123 0.164]]
Validation acc: 0.5147997678467788
Validation class_accuracies: [0.596340150699677, 0.48440065681444994, 0.23214285714285715, 0.1643835616438356]
Validation sensitivity: 0.4193954659949622
Validation specificity: 0.596340150699677
Validation icbhi_score: 0.5078678083473196
Validation roc_auc: None
Validation avg_accuracy: 0.36931680657520494
Validation one_indexed_epoch: 24
The number of epochs since last 1% equals the patience
There is no such attribute
272/272 - 127s - loss: 0.0190 - accuracy: 0.7584 - 127s/epoch - 467ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5650410912847432
Best cm: [[755 148  10  16]
 [352 240   7  10]
 [ 57  26   9  20]
 [ 50  13   7   3]]
Best normalized_cm: [[0.813 0.159 0.011 0.017]
 [0.578 0.394 0.011 0.016]
 [0.509 0.232 0.08  0.179]
 [0.685 0.178 0.096 0.041]]
Best acc: 0.5844457341845618
Best class_accuracies: [0.8127018299246501, 0.39408866995073893, 0.08035714285714286, 0.0410958904109589]
Best sensitivity: 0.31738035264483627
Best specificity: 0.8127018299246501
Best roc_auc: None
Best avg_accuracy: 0.3320608832858727
Best one_indexed_epoch: 4
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6493239402770996, 0.5362337827682495, 0.47629475593566895, 0.41987767815589905, 0.36741745471954346, 0.3302782475948334, 0.28353968262672424, 0.22629429399967194, 0.1998033970594406, 0.17925284802913666, 0.1576024740934372, 0.15378700196743011, 0.09006191790103912, 0.05891477316617966, 0.07948918640613556, 0.04696226865053177, 0.050706006586551666, 0.04148130491375923, 0.03996417298913002, 0.031189031898975372, 0.02239811047911644, 0.02425839938223362, 0.023193372413516045, 0.019014624878764153], 'accuracy': [0.5720865726470947, 0.7190234661102295, 0.7443574666976929, 0.7637033462524414, 0.7634730339050293, 0.7719944715499878, 0.7897282242774963, 0.791110098361969, 0.7941040992736816, 0.7991709113121033, 0.7805159091949463, 0.7641639709472656, 0.7768309712409973, 0.7821280360221863, 0.7715338468551636, 0.7802855968475342, 0.7807462215423584, 0.7821280360221863, 0.7584062814712524, 0.78143709897995, 0.7821280360221863, 0.7683095335960388, 0.770382285118103, 0.7584062814712524]}
Job id is 4.
-----------------------
--- Final training dataset went from 0 to 4458 elements, with 2140 none's, 1245 crakles, 575 wheezes and 498 both ---
--- Final Validation dataset contains 1607 elements, with 738 none, 589 crackles, 142 wheezes and 138 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5207943925233645, 1: 0.8951807228915662, 2: 1.9382608695652175, 3: 2.2379518072289155}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_3 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_3[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_2   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_6 (Dense)             (None, 100)               204900    
                                                                 
 dropout_4 (Dropout)         (None, 100)               0         
                                                                 
 dense_7 (Dense)             (None, 50)                5050      
                                                                 
 dropout_5 (Dropout)         (None, 50)                0         
                                                                 
 dense_8 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_4 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_5 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_2 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[429  18 287   4]
 [368   6 215   0]
 [ 43   0  98   1]
 [ 95   3  40   0]]
Validation normalized_cm: [[0.581 0.024 0.389 0.005]
 [0.625 0.01  0.365 0.   ]
 [0.303 0.    0.69  0.007]
 [0.688 0.022 0.29  0.   ]]
Validation acc: 0.3316739265712508
Validation class_accuracies: [0.5813008130081301, 0.010186757215619695, 0.6901408450704225, 0.0]
Validation sensitivity: 0.11967779056386652
Validation specificity: 0.5813008130081301
Validation icbhi_score: 0.3504893017859983
Validation roc_auc: None
Validation avg_accuracy: 0.3204071038235431
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
279/279 - 116s - loss: 0.6637 - accuracy: 0.5891 - 116s/epoch - 416ms/step
Epoch 2/80
Validation cm: [[356 128 196  58]
 [158 146 155 130]
 [ 10   9 100  23]
 [  6   9  88  35]]
Validation normalized_cm: [[0.482 0.173 0.266 0.079]
 [0.268 0.248 0.263 0.221]
 [0.07  0.063 0.704 0.162]
 [0.043 0.065 0.638 0.254]]
Validation acc: 0.39639079029247043
Validation class_accuracies: [0.4823848238482385, 0.24787775891341257, 0.704225352112676, 0.2536231884057971]
Validation sensitivity: 0.3233601841196778
Validation specificity: 0.4823848238482385
Validation icbhi_score: 0.40287250398395813
Validation roc_auc: None
Validation avg_accuracy: 0.42202778082003106
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
279/279 - 110s - loss: 0.5621 - accuracy: 0.6929 - 110s/epoch - 394ms/step
Epoch 3/80
Validation cm: [[309 391  31   7]
 [119 450   9  11]
 [ 20  29  74  19]
 [ 13  36  72  17]]
Validation normalized_cm: [[0.419 0.53  0.042 0.009]
 [0.202 0.764 0.015 0.019]
 [0.141 0.204 0.521 0.134]
 [0.094 0.261 0.522 0.123]]
Validation acc: 0.5289359054138145
Validation class_accuracies: [0.4186991869918699, 0.7640067911714771, 0.5211267605633803, 0.12318840579710146]
Validation sensitivity: 0.622554660529344
Validation specificity: 0.4186991869918699
Validation icbhi_score: 0.5206269237606069
Validation roc_auc: None
Validation avg_accuracy: 0.4567552861309572
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
279/279 - 110s - loss: 0.4911 - accuracy: 0.7353 - 110s/epoch - 393ms/step
Epoch 4/80
Validation cm: [[460 177  95   6]
 [237 276  69   7]
 [ 16   9 100  17]
 [ 32   9  85  12]]
Validation normalized_cm: [[0.623 0.24  0.129 0.008]
 [0.402 0.469 0.117 0.012]
 [0.113 0.063 0.704 0.12 ]
 [0.232 0.065 0.616 0.087]]
Validation acc: 0.5276913503422527
Validation class_accuracies: [0.6233062330623306, 0.4685908319185059, 0.704225352112676, 0.08695652173913043]
Validation sensitivity: 0.44649021864211735
Validation specificity: 0.6233062330623306
Validation icbhi_score: 0.5348982258522239
Validation roc_auc: None
Validation avg_accuracy: 0.47076973470816075
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
279/279 - 110s - loss: 0.4236 - accuracy: 0.7642 - 110s/epoch - 394ms/step
Epoch 5/80
Validation cm: [[353  87 250  48]
 [170 182 149  88]
 [ 17   7  86  32]
 [ 22   5  97  14]]
Validation normalized_cm: [[0.478 0.118 0.339 0.065]
 [0.289 0.309 0.253 0.149]
 [0.12  0.049 0.606 0.225]
 [0.159 0.036 0.703 0.101]]
Validation acc: 0.3951462352209085
Validation class_accuracies: [0.47831978319783197, 0.3089983022071307, 0.6056338028169014, 0.10144927536231885]
Validation sensitivity: 0.3245109321058688
Validation specificity: 0.47831978319783197
Validation icbhi_score: 0.4014153576518504
Validation roc_auc: None
Validation avg_accuracy: 0.37360029089604574
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 111s - loss: 0.3867 - accuracy: 0.7773 - 111s/epoch - 396ms/step
Epoch 6/80
Validation cm: [[451 272   4  11]
 [337 246   2   4]
 [ 22  68  12  40]
 [ 44  55  11  28]]
Validation normalized_cm: [[0.611 0.369 0.005 0.015]
 [0.572 0.418 0.003 0.007]
 [0.155 0.479 0.085 0.282]
 [0.319 0.399 0.08  0.203]]
Validation acc: 0.4586185438705663
Validation class_accuracies: [0.6111111111111112, 0.41765704584040747, 0.08450704225352113, 0.2028985507246377]
Validation sensitivity: 0.3291139240506329
Validation specificity: 0.6111111111111112
Validation icbhi_score: 0.470112517580872
Validation roc_auc: None
Validation avg_accuracy: 0.3290434374824194
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 110s - loss: 0.3163 - accuracy: 0.8004 - 110s/epoch - 395ms/step
Epoch 7/80
Validation cm: [[691   4  38   5]
 [570   2  13   4]
 [ 60   0  77   5]
 [ 74   0  61   3]]
Validation normalized_cm: [[0.936 0.005 0.051 0.007]
 [0.968 0.003 0.022 0.007]
 [0.423 0.    0.542 0.035]
 [0.536 0.    0.442 0.022]]
Validation acc: 0.48102053515868076
Validation class_accuracies: [0.9363143631436315, 0.003395585738539898, 0.5422535211267606, 0.021739130434782608]
Validation sensitivity: 0.09436133486766399
Validation specificity: 0.9363143631436315
Validation icbhi_score: 0.5153378490056477
Validation roc_auc: None
Validation avg_accuracy: 0.3759256501109287
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 110s - loss: 0.2816 - accuracy: 0.8075 - 110s/epoch - 394ms/step
Epoch 8/80
Validation cm: [[290 350  25  73]
 [177 357   9  46]
 [ 21  31   5  85]
 [ 32  21  35  50]]
Validation normalized_cm: [[0.393 0.474 0.034 0.099]
 [0.301 0.606 0.015 0.078]
 [0.148 0.218 0.035 0.599]
 [0.232 0.152 0.254 0.362]]
Validation acc: 0.4368388301182327
Validation class_accuracies: [0.39295392953929537, 0.6061120543293718, 0.035211267605633804, 0.36231884057971014]
Validation sensitivity: 0.47410817031070196
Validation specificity: 0.39295392953929537
Validation icbhi_score: 0.4335310499249987
Validation roc_auc: None
Validation avg_accuracy: 0.34914902301350276
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 110s - loss: 0.2517 - accuracy: 0.8221 - 110s/epoch - 392ms/step
Epoch 9/80
Validation cm: [[386   5 344   3]
 [242   6 337   4]
 [ 11   0 125   6]
 [ 15   0 117   6]]
Validation normalized_cm: [[0.523 0.007 0.466 0.004]
 [0.411 0.01  0.572 0.007]
 [0.077 0.    0.88  0.042]
 [0.109 0.    0.848 0.043]]
Validation acc: 0.3254511512134412
Validation class_accuracies: [0.5230352303523035, 0.010186757215619695, 0.8802816901408451, 0.043478260869565216]
Validation sensitivity: 0.15765247410817032
Validation specificity: 0.5230352303523035
Validation icbhi_score: 0.3403438522302369
Validation roc_auc: None
Validation avg_accuracy: 0.36424548464458334
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 5 epochs
There is no such attribute
279/279 - 110s - loss: 0.2058 - accuracy: 0.8172 - 110s/epoch - 395ms/step
Epoch 10/80
Validation cm: [[386 230  88  34]
 [250 265  54  20]
 [ 11   9  97  25]
 [ 12  20  87  19]]
Validation normalized_cm: [[0.523 0.312 0.119 0.046]
 [0.424 0.45  0.092 0.034]
 [0.077 0.063 0.683 0.176]
 [0.087 0.145 0.63  0.138]]
Validation acc: 0.477286869943995
Validation class_accuracies: [0.5230352303523035, 0.44991511035653653, 0.6830985915492958, 0.13768115942028986]
Validation sensitivity: 0.43843498273878023
Validation specificity: 0.5230352303523035
Validation icbhi_score: 0.48073510654554186
Validation roc_auc: None
Validation avg_accuracy: 0.4484325229196064
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 6 epochs
There is no such attribute
279/279 - 109s - loss: 0.1885 - accuracy: 0.8125 - 109s/epoch - 390ms/step
Epoch 11/80
Validation cm: [[414 103 199  22]
 [328 110 147   4]
 [ 17   8 111   6]
 [ 27   5  99   7]]
Validation normalized_cm: [[0.561 0.14  0.27  0.03 ]
 [0.557 0.187 0.25  0.007]
 [0.12  0.056 0.782 0.042]
 [0.196 0.036 0.717 0.051]]
Validation acc: 0.3995021779713752
Validation class_accuracies: [0.5609756097560976, 0.1867572156196944, 0.7816901408450704, 0.050724637681159424]
Validation sensitivity: 0.26237054085155354
Validation specificity: 0.5609756097560976
Validation icbhi_score: 0.4116730753038256
Validation roc_auc: None
Validation avg_accuracy: 0.3950369009755054
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 109s - loss: 0.1840 - accuracy: 0.8071 - 109s/epoch - 392ms/step
Epoch 12/80
Validation cm: [[706   7  22   3]
 [570   9   9   1]
 [ 62   1  70   9]
 [ 59   1  71   7]]
Validation normalized_cm: [[0.957 0.009 0.03  0.004]
 [0.968 0.015 0.015 0.002]
 [0.437 0.007 0.493 0.063]
 [0.428 0.007 0.514 0.051]]
Validation acc: 0.492843808338519
Validation class_accuracies: [0.9566395663956639, 0.015280135823429542, 0.49295774647887325, 0.050724637681159424]
Validation sensitivity: 0.09896432681242807
Validation specificity: 0.9566395663956639
Validation icbhi_score: 0.527801946604046
Validation roc_auc: None
Validation avg_accuracy: 0.37890052159478155
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5348982258522239 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
279/279 - 111s - loss: 0.1642 - accuracy: 0.8089 - 111s/epoch - 399ms/step
Epoch 13/80
Validation cm: [[563  98  76   1]
 [319 236  28   6]
 [ 45  10  78   9]
 [ 54  10  70   4]]
Validation normalized_cm: [[0.763 0.133 0.103 0.001]
 [0.542 0.401 0.048 0.01 ]
 [0.317 0.07  0.549 0.063]
 [0.391 0.072 0.507 0.029]]
Validation acc: 0.5482265090230243
Validation class_accuracies: [0.7628726287262872, 0.400679117147708, 0.5492957746478874, 0.028985507246376812]
Validation sensitivity: 0.3659378596087457
Validation specificity: 0.7628726287262872
Validation icbhi_score: 0.5644052441675165
Validation roc_auc: None
Validation avg_accuracy: 0.4354582569420648
Validation one_indexed_epoch: 13
-- New best results were achieved. --
There is no such attribute
279/279 - 111s - loss: 0.0919 - accuracy: 0.8078 - 111s/epoch - 396ms/step
Epoch 14/80
Validation cm: [[665  60  12   1]
 [448 128   7   6]
 [ 55   7  63  17]
 [ 51  14  59  14]]
Validation normalized_cm: [[0.901 0.081 0.016 0.001]
 [0.761 0.217 0.012 0.01 ]
 [0.387 0.049 0.444 0.12 ]
 [0.37  0.101 0.428 0.101]]
Validation acc: 0.5413814561294338
Validation class_accuracies: [0.9010840108401084, 0.21731748726655348, 0.44366197183098594, 0.10144927536231885]
Validation sensitivity: 0.23590333716915995
Validation specificity: 0.9010840108401084
Validation icbhi_score: 0.5684936740046341
Validation roc_auc: None
Validation avg_accuracy: 0.4158781863249917
Validation one_indexed_epoch: 14
-- New best results were achieved. --
There is no such attribute
279/279 - 111s - loss: 0.0624 - accuracy: 0.7965 - 111s/epoch - 397ms/step
Epoch 15/80
Validation cm: [[386 282  39  31]
 [149 380  14  46]
 [ 27  18  58  39]
 [ 15  30  73  20]]
Validation normalized_cm: [[0.523 0.382 0.053 0.042]
 [0.253 0.645 0.024 0.078]
 [0.19  0.127 0.408 0.275]
 [0.109 0.217 0.529 0.145]]
Validation acc: 0.5252022401991289
Validation class_accuracies: [0.5230352303523035, 0.6451612903225806, 0.4084507042253521, 0.14492753623188406]
Validation sensitivity: 0.5270425776754891
Validation specificity: 0.5230352303523035
Validation icbhi_score: 0.5250389040138963
Validation roc_auc: None
Validation avg_accuracy: 0.43039369028303004
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 110s - loss: 0.0481 - accuracy: 0.7934 - 110s/epoch - 395ms/step
Epoch 16/80
Validation cm: [[510 133  50  45]
 [319 206  20  44]
 [ 42   6  68  26]
 [ 38  14  74  12]]
Validation normalized_cm: [[0.691 0.18  0.068 0.061]
 [0.542 0.35  0.034 0.075]
 [0.296 0.042 0.479 0.183]
 [0.275 0.101 0.536 0.087]]
Validation acc: 0.4953329184816428
Validation class_accuracies: [0.6910569105691057, 0.34974533106960953, 0.4788732394366197, 0.08695652173913043]
Validation sensitivity: 0.3291139240506329
Validation specificity: 0.6910569105691057
Validation icbhi_score: 0.5100854173098692
Validation roc_auc: None
Validation avg_accuracy: 0.40165800070361635
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 111s - loss: 0.0495 - accuracy: 0.7882 - 111s/epoch - 397ms/step
Epoch 17/80
Validation cm: [[586 126  14  12]
 [352 226   2   9]
 [ 58  21  15  48]
 [ 69  24  21  24]]
Validation normalized_cm: [[0.794 0.171 0.019 0.016]
 [0.598 0.384 0.003 0.015]
 [0.408 0.148 0.106 0.338]
 [0.5   0.174 0.152 0.174]]
Validation acc: 0.5295581829495956
Validation class_accuracies: [0.7940379403794038, 0.3837011884550085, 0.1056338028169014, 0.17391304347826086]
Validation sensitivity: 0.3049482163406214
Validation specificity: 0.7940379403794038
Validation icbhi_score: 0.5494930783600126
Validation roc_auc: None
Validation avg_accuracy: 0.36432149378239365
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 111s - loss: 0.0430 - accuracy: 0.8102 - 111s/epoch - 399ms/step
Epoch 18/80
Validation cm: [[543 102  83  10]
 [286 254  31  18]
 [ 41  11  73  17]
 [ 41  20  63  14]]
Validation normalized_cm: [[0.736 0.138 0.112 0.014]
 [0.486 0.431 0.053 0.031]
 [0.289 0.077 0.514 0.12 ]
 [0.297 0.145 0.457 0.101]]
Validation acc: 0.5500933416303672
Validation class_accuracies: [0.7357723577235772, 0.4312393887945671, 0.5140845070422535, 0.10144927536231885]
Validation sensitivity: 0.3924050632911392
Validation specificity: 0.7357723577235772
Validation icbhi_score: 0.5640887105073582
Validation roc_auc: None
Validation avg_accuracy: 0.44563638223067914
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 111s - loss: 0.0322 - accuracy: 0.7979 - 111s/epoch - 398ms/step
Epoch 19/80
Validation cm: [[596  99  41   2]
 [399 147  34   9]
 [ 48   6  83   5]
 [ 35  16  84   3]]
Validation normalized_cm: [[0.808 0.134 0.056 0.003]
 [0.677 0.25  0.058 0.015]
 [0.338 0.042 0.585 0.035]
 [0.254 0.116 0.609 0.022]]
Validation acc: 0.5158680771624145
Validation class_accuracies: [0.8075880758807588, 0.2495755517826825, 0.5845070422535211, 0.021739130434782608]
Validation sensitivity: 0.2681242807825086
Validation specificity: 0.8075880758807588
Validation icbhi_score: 0.5378561783316337
Validation roc_auc: None
Validation avg_accuracy: 0.41585245008793625
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 5 epochs
There is no such attribute
279/279 - 115s - loss: 0.0445 - accuracy: 0.7784 - 115s/epoch - 413ms/step
Epoch 20/80
Validation cm: [[458 228  47   5]
 [219 347  17   6]
 [ 39  16  59  28]
 [ 39  24  60  15]]
Validation normalized_cm: [[0.621 0.309 0.064 0.007]
 [0.372 0.589 0.029 0.01 ]
 [0.275 0.113 0.415 0.197]
 [0.283 0.174 0.435 0.109]]
Validation acc: 0.5469819539514623
Validation class_accuracies: [0.6205962059620597, 0.5891341256366723, 0.4154929577464789, 0.10869565217391304]
Validation sensitivity: 0.4844649021864212
Validation specificity: 0.6205962059620597
Validation icbhi_score: 0.5525305540742405
Validation roc_auc: None
Validation avg_accuracy: 0.433479735379781
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 6 epochs
There is no such attribute
279/279 - 116s - loss: 0.0330 - accuracy: 0.7813 - 116s/epoch - 415ms/step
Epoch 21/80
Validation cm: [[602  73  51  12]
 [389 137  31  32]
 [ 27   4  79  32]
 [ 32  10  74  22]]
Validation normalized_cm: [[0.816 0.099 0.069 0.016]
 [0.66  0.233 0.053 0.054]
 [0.19  0.028 0.556 0.225]
 [0.232 0.072 0.536 0.159]]
Validation acc: 0.522713130056005
Validation class_accuracies: [0.8157181571815718, 0.23259762308998302, 0.5563380281690141, 0.15942028985507245]
Validation sensitivity: 0.27387802071346373
Validation specificity: 0.8157181571815718
Validation icbhi_score: 0.5447980889475178
Validation roc_auc: None
Validation avg_accuracy: 0.4410185245739104
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 112s - loss: 0.0243 - accuracy: 0.7712 - 112s/epoch - 402ms/step
Epoch 22/80
Validation cm: [[595  75  56  12]
 [388 157  25  19]
 [ 31  11  79  21]
 [ 25  15  79  19]]
Validation normalized_cm: [[0.806 0.102 0.076 0.016]
 [0.659 0.267 0.042 0.032]
 [0.218 0.077 0.556 0.148]
 [0.181 0.109 0.572 0.138]]
Validation acc: 0.5289359054138145
Validation class_accuracies: [0.8062330623306233, 0.266553480475382, 0.5563380281690141, 0.13768115942028986]
Validation sensitivity: 0.29344073647871116
Validation specificity: 0.8062330623306233
Validation icbhi_score: 0.5498368994046672
Validation roc_auc: None
Validation avg_accuracy: 0.44170143259882727
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
279/279 - 113s - loss: 0.0236 - accuracy: 0.7793 - 113s/epoch - 405ms/step
Epoch 23/80
Validation cm: [[461 203  51  23]
 [221 303  23  42]
 [ 29  19  55  39]
 [ 17  25  70  26]]
Validation normalized_cm: [[0.625 0.275 0.069 0.031]
 [0.375 0.514 0.039 0.071]
 [0.204 0.134 0.387 0.275]
 [0.123 0.181 0.507 0.188]]
Validation acc: 0.5258245177349098
Validation class_accuracies: [0.6246612466124661, 0.5144312393887945, 0.3873239436619718, 0.18840579710144928]
Validation sensitivity: 0.44188722669735325
Validation specificity: 0.6246612466124661
Validation icbhi_score: 0.5332742366549097
Validation roc_auc: None
Validation avg_accuracy: 0.42870555669117044
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 9 epochs
There is no such attribute
279/279 - 116s - loss: 0.0212 - accuracy: 0.7847 - 116s/epoch - 415ms/step
Epoch 24/80
Validation cm: [[575  88  66   9]
 [369 177  33  10]
 [ 31   8  95   8]
 [ 27  11  94   6]]
Validation normalized_cm: [[0.779 0.119 0.089 0.012]
 [0.626 0.301 0.056 0.017]
 [0.218 0.056 0.669 0.056]
 [0.196 0.08  0.681 0.043]]
Validation acc: 0.5308027380211574
Validation class_accuracies: [0.7791327913279132, 0.300509337860781, 0.6690140845070423, 0.043478260869565216]
Validation sensitivity: 0.31990794016110474
Validation specificity: 0.7791327913279132
Validation icbhi_score: 0.549520365744509
Validation roc_auc: None
Validation avg_accuracy: 0.4480336186413254
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5684936740046341 hasn't increased by 0 in 10 epochs
There is no such attribute
279/279 - 115s - loss: 0.0199 - accuracy: 0.7873 - 115s/epoch - 411ms/step
Epoch 25/80
Validation cm: [[650  58  28   2]
 [423 149  14   3]
 [ 49  10  65  18]
 [ 41  18  66  13]]
Validation normalized_cm: [[0.881 0.079 0.038 0.003]
 [0.718 0.253 0.024 0.005]
 [0.345 0.07  0.458 0.127]
 [0.297 0.13  0.478 0.094]]
Validation acc: 0.5457373988799005
Validation class_accuracies: [0.8807588075880759, 0.2529711375212224, 0.45774647887323944, 0.09420289855072464]
Validation sensitivity: 0.2612197928653625
Validation specificity: 0.8807588075880759
Validation icbhi_score: 0.5709893002267192
Validation roc_auc: None
Validation avg_accuracy: 0.4214198306333156
Validation one_indexed_epoch: 25
-- New best results were achieved. --
There is no such attribute
279/279 - 115s - loss: 0.0192 - accuracy: 0.7817 - 115s/epoch - 412ms/step
Epoch 26/80
Validation cm: [[522 133  60  23]
 [275 255  29  30]
 [ 32  14  70  26]
 [ 33  18  72  15]]
Validation normalized_cm: [[0.707 0.18  0.081 0.031]
 [0.467 0.433 0.049 0.051]
 [0.225 0.099 0.493 0.183]
 [0.239 0.13  0.522 0.109]]
Validation acc: 0.536403235843186
Validation class_accuracies: [0.7073170731707317, 0.432937181663837, 0.49295774647887325, 0.10869565217391304]
Validation sensitivity: 0.3912543153049482
Validation specificity: 0.7073170731707317
Validation icbhi_score: 0.5492856942378399
Validation roc_auc: None
Validation avg_accuracy: 0.43547691337183875
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5709893002267192 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 115s - loss: 0.0177 - accuracy: 0.7730 - 115s/epoch - 411ms/step
Epoch 27/80
Validation cm: [[525 132  54  27]
 [294 231  31  33]
 [ 28  14  73  27]
 [ 31  17  75  15]]
Validation normalized_cm: [[0.711 0.179 0.073 0.037]
 [0.499 0.392 0.053 0.056]
 [0.197 0.099 0.514 0.19 ]
 [0.225 0.123 0.543 0.109]]
Validation acc: 0.5252022401991289
Validation class_accuracies: [0.7113821138211383, 0.3921901528013582, 0.5140845070422535, 0.10869565217391304]
Validation sensitivity: 0.3670886075949367
Validation specificity: 0.7113821138211383
Validation icbhi_score: 0.5392353607080375
Validation roc_auc: None
Validation avg_accuracy: 0.4315881064596658
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5709893002267192 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 113s - loss: 0.0142 - accuracy: 0.7804 - 113s/epoch - 405ms/step
Epoch 28/80
Validation cm: [[462 195  43  38]
 [234 289  23  43]
 [ 27  13  66  36]
 [ 16  23  75  24]]
Validation normalized_cm: [[0.626 0.264 0.058 0.051]
 [0.397 0.491 0.039 0.073]
 [0.19  0.092 0.465 0.254]
 [0.116 0.167 0.543 0.174]]
Validation acc: 0.523335407591786
Validation class_accuracies: [0.6260162601626016, 0.4906621392190153, 0.4647887323943662, 0.17391304347826086]
Validation sensitivity: 0.4361334867663982
Validation specificity: 0.6260162601626016
Validation icbhi_score: 0.5310748734644999
Validation roc_auc: None
Validation avg_accuracy: 0.43884504381356104
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5709893002267192 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 114s - loss: 0.0154 - accuracy: 0.7782 - 114s/epoch - 409ms/step
Epoch 29/80
Validation cm: [[567 117  36  18]
 [312 232  17  28]
 [ 32  16  66  28]
 [ 32  17  74  15]]
Validation normalized_cm: [[0.768 0.159 0.049 0.024]
 [0.53  0.394 0.029 0.048]
 [0.225 0.113 0.465 0.197]
 [0.232 0.123 0.536 0.109]]
Validation acc: 0.5476042314872434
Validation class_accuracies: [0.7682926829268293, 0.3938879456706282, 0.4647887323943662, 0.10869565217391304]
Validation sensitivity: 0.36018411967779057
Validation specificity: 0.7682926829268293
Validation icbhi_score: 0.56423840130231
Validation roc_auc: None
Validation avg_accuracy: 0.4339162532914342
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5709893002267192 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 111s - loss: 0.0114 - accuracy: 0.7743 - 111s/epoch - 399ms/step
Epoch 30/80
Validation cm: [[509 136  73  20]
 [268 261  29  31]
 [ 22  12  93  15]
 [ 24  15  92   7]]
Validation normalized_cm: [[0.69  0.184 0.099 0.027]
 [0.455 0.443 0.049 0.053]
 [0.155 0.085 0.655 0.106]
 [0.174 0.109 0.667 0.051]]
Validation acc: 0.5413814561294338
Validation class_accuracies: [0.6897018970189702, 0.4431239388794567, 0.6549295774647887, 0.050724637681159424]
Validation sensitivity: 0.4154200230149597
Validation specificity: 0.6897018970189702
Validation icbhi_score: 0.552560960016965
Validation roc_auc: None
Validation avg_accuracy: 0.45962001276109377
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5709893002267192 hasn't increased by 0 in 5 epochs
There is no such attribute
279/279 - 114s - loss: 0.0111 - accuracy: 0.7817 - 114s/epoch - 407ms/step
Epoch 31/80
Validation cm: [[531 145  41  21]
 [286 246  21  36]
 [ 29  17  70  26]
 [ 28  21  69  20]]
Validation normalized_cm: [[0.72  0.196 0.056 0.028]
 [0.486 0.418 0.036 0.061]
 [0.204 0.12  0.493 0.183]
 [0.203 0.152 0.5   0.145]]
Validation acc: 0.5395146235220909
Validation class_accuracies: [0.7195121951219512, 0.41765704584040747, 0.49295774647887325, 0.14492753623188406]
Validation sensitivity: 0.3866513233601841
Validation specificity: 0.7195121951219512
Validation icbhi_score: 0.5530817592410676
Validation roc_auc: None
Validation avg_accuracy: 0.443763630918279
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5709893002267192 hasn't increased by 0 in 6 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 108s - loss: 0.0138 - accuracy: 0.7891 - 108s/epoch - 386ms/step
Epoch 32/80
Validation cm: [[585 106  36  11]
 [313 242  17  17]
 [ 40   9  76  17]
 [ 31  19  75  13]]
Validation normalized_cm: [[0.793 0.144 0.049 0.015]
 [0.531 0.411 0.029 0.029]
 [0.282 0.063 0.535 0.12 ]
 [0.225 0.138 0.543 0.094]]
Validation acc: 0.5700062227753578
Validation class_accuracies: [0.7926829268292683, 0.41086587436332767, 0.5352112676056338, 0.09420289855072464]
Validation sensitivity: 0.380897583429229
Validation specificity: 0.7926829268292683
Validation icbhi_score: 0.5867902551292487
Validation roc_auc: None
Validation avg_accuracy: 0.45824074183723856
Validation one_indexed_epoch: 32
-- New best results were achieved. --
There is no such attribute
279/279 - 105s - loss: 0.0109 - accuracy: 0.7687 - 105s/epoch - 377ms/step
Epoch 33/80
Validation cm: [[609  89  31   9]
 [352 201  22  14]
 [ 41   9  77  15]
 [ 34  16  75  13]]
Validation normalized_cm: [[0.825 0.121 0.042 0.012]
 [0.598 0.341 0.037 0.024]
 [0.289 0.063 0.542 0.106]
 [0.246 0.116 0.543 0.094]]
Validation acc: 0.5600497822028625
Validation class_accuracies: [0.8252032520325203, 0.34125636672325976, 0.5422535211267606, 0.09420289855072464]
Validation sensitivity: 0.334867663981588
Validation specificity: 0.8252032520325203
Validation icbhi_score: 0.5800354580070541
Validation roc_auc: None
Validation avg_accuracy: 0.4507290096083163
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 108s - loss: 0.0114 - accuracy: 0.7777 - 108s/epoch - 389ms/step
Epoch 34/80
Validation cm: [[572 114  40  12]
 [303 235  20  31]
 [ 37   8  74  23]
 [ 25  20  79  14]]
Validation normalized_cm: [[0.775 0.154 0.054 0.016]
 [0.514 0.399 0.034 0.053]
 [0.261 0.056 0.521 0.162]
 [0.181 0.145 0.572 0.101]]
Validation acc: 0.5569383945239577
Validation class_accuracies: [0.7750677506775068, 0.398981324278438, 0.5211267605633803, 0.10144927536231885]
Validation sensitivity: 0.3716915995397008
Validation specificity: 0.7750677506775068
Validation icbhi_score: 0.5733796751086038
Validation roc_auc: None
Validation avg_accuracy: 0.44915627772041095
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 115s - loss: 0.0133 - accuracy: 0.7824 - 115s/epoch - 411ms/step
Epoch 35/80
Validation cm: [[601  77  45  15]
 [360 174  23  32]
 [ 35  11  73  23]
 [ 30  17  77  14]]
Validation normalized_cm: [[0.814 0.104 0.061 0.02 ]
 [0.611 0.295 0.039 0.054]
 [0.246 0.077 0.514 0.162]
 [0.217 0.123 0.558 0.101]]
Validation acc: 0.536403235843186
Validation class_accuracies: [0.8143631436314364, 0.29541595925297115, 0.5140845070422535, 0.10144927536231885]
Validation sensitivity: 0.3003452243958573
Validation specificity: 0.8143631436314364
Validation icbhi_score: 0.5573541840136469
Validation roc_auc: None
Validation avg_accuracy: 0.43132822132224496
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 112s - loss: 0.0113 - accuracy: 0.7804 - 112s/epoch - 400ms/step
Epoch 36/80
Validation cm: [[496 170  52  20]
 [265 255  22  47]
 [ 27  12  73  30]
 [ 17  22  80  19]]
Validation normalized_cm: [[0.672 0.23  0.07  0.027]
 [0.45  0.433 0.037 0.08 ]
 [0.19  0.085 0.514 0.211]
 [0.123 0.159 0.58  0.138]]
Validation acc: 0.5245799626633478
Validation class_accuracies: [0.6720867208672087, 0.432937181663837, 0.5140845070422535, 0.13768115942028986]
Validation sensitivity: 0.3993095512082854
Validation specificity: 0.6720867208672087
Validation icbhi_score: 0.5356981360377471
Validation roc_auc: None
Validation avg_accuracy: 0.4391973922483972
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 113s - loss: 0.0107 - accuracy: 0.7891 - 113s/epoch - 404ms/step
Epoch 37/80
Validation cm: [[585 125  25   3]
 [327 239  16   7]
 [ 48  13  75   6]
 [ 39  22  69   8]]
Validation normalized_cm: [[0.793 0.169 0.034 0.004]
 [0.555 0.406 0.027 0.012]
 [0.338 0.092 0.528 0.042]
 [0.283 0.159 0.5   0.058]]
Validation acc: 0.5644057249533292
Validation class_accuracies: [0.7926829268292683, 0.4057724957555178, 0.528169014084507, 0.057971014492753624]
Validation sensitivity: 0.3705408515535098
Validation specificity: 0.7926829268292683
Validation icbhi_score: 0.5816118891913891
Validation roc_auc: None
Validation avg_accuracy: 0.4461488627905117
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 5 epochs
There is no such attribute
279/279 - 111s - loss: 0.0115 - accuracy: 0.7840 - 111s/epoch - 398ms/step
Epoch 38/80
Validation cm: [[499 164  48  27]
 [250 270  27  42]
 [ 27  16  72  27]
 [ 23  21  78  16]]
Validation normalized_cm: [[0.676 0.222 0.065 0.037]
 [0.424 0.458 0.046 0.071]
 [0.19  0.113 0.507 0.19 ]
 [0.167 0.152 0.565 0.116]]
Validation acc: 0.5332918481642813
Validation class_accuracies: [0.6761517615176151, 0.45840407470288624, 0.5070422535211268, 0.11594202898550725]
Validation sensitivity: 0.41196777905638665
Validation specificity: 0.6761517615176151
Validation icbhi_score: 0.5440597702870009
Validation roc_auc: None
Validation avg_accuracy: 0.4393850296817839
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 6 epochs
There is no such attribute
279/279 - 115s - loss: 0.0105 - accuracy: 0.7799 - 115s/epoch - 413ms/step
Epoch 39/80
Validation cm: [[522 165  32  19]
 [254 287  19  29]
 [ 30  15  71  26]
 [ 28  26  68  16]]
Validation normalized_cm: [[0.707 0.224 0.043 0.026]
 [0.431 0.487 0.032 0.049]
 [0.211 0.106 0.5   0.183]
 [0.203 0.188 0.493 0.116]]
Validation acc: 0.5575606720597387
Validation class_accuracies: [0.7073170731707317, 0.4872665534804754, 0.5, 0.11594202898550725]
Validation sensitivity: 0.43037974683544306
Validation specificity: 0.7073170731707317
Validation icbhi_score: 0.5688484100030874
Validation roc_auc: None
Validation avg_accuracy: 0.4526314139091786
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 7 epochs
There is no such attribute
279/279 - 111s - loss: 0.0085 - accuracy: 0.7858 - 111s/epoch - 399ms/step
Epoch 40/80
Validation cm: [[481 176  54  27]
 [247 274  27  41]
 [ 26  13  75  28]
 [ 16  21  85  16]]
Validation normalized_cm: [[0.652 0.238 0.073 0.037]
 [0.419 0.465 0.046 0.07 ]
 [0.183 0.092 0.528 0.197]
 [0.116 0.152 0.616 0.116]]
Validation acc: 0.5264467952706907
Validation class_accuracies: [0.6517615176151762, 0.46519524617996605, 0.528169014084507, 0.11594202898550725]
Validation sensitivity: 0.42002301495972383
Validation specificity: 0.6517615176151762
Validation icbhi_score: 0.53589226628745
Validation roc_auc: None
Validation avg_accuracy: 0.44026695171628916
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
279/279 - 111s - loss: 0.0102 - accuracy: 0.7909 - 111s/epoch - 398ms/step
Epoch 41/80
Validation cm: [[506 174  42  16]
 [262 277  20  30]
 [ 30  14  69  29]
 [ 22  22  78  16]]
Validation normalized_cm: [[0.686 0.236 0.057 0.022]
 [0.445 0.47  0.034 0.051]
 [0.211 0.099 0.486 0.204]
 [0.159 0.159 0.565 0.116]]
Validation acc: 0.5401369010578718
Validation class_accuracies: [0.6856368563685636, 0.4702886247877759, 0.4859154929577465, 0.11594202898550725]
Validation sensitivity: 0.41657077100115075
Validation specificity: 0.6856368563685636
Validation icbhi_score: 0.5511038136848572
Validation roc_auc: None
Validation avg_accuracy: 0.43944575077489834
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 9 epochs
There is no such attribute
279/279 - 114s - loss: 0.0074 - accuracy: 0.7748 - 114s/epoch - 407ms/step
Epoch 42/80
Validation cm: [[543 136  44  15]
 [280 259  22  28]
 [ 32  12  72  26]
 [ 28  19  75  16]]
Validation normalized_cm: [[0.736 0.184 0.06  0.02 ]
 [0.475 0.44  0.037 0.048]
 [0.225 0.085 0.507 0.183]
 [0.203 0.138 0.543 0.116]]
Validation acc: 0.5538270068450529
Validation class_accuracies: [0.7357723577235772, 0.4397283531409168, 0.5070422535211268, 0.11594202898550725]
Validation sensitivity: 0.3993095512082854
Validation specificity: 0.7357723577235772
Validation icbhi_score: 0.5675409544659313
Validation roc_auc: None
Validation avg_accuracy: 0.449621248342782
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 10 epochs
There is no such attribute
279/279 - 113s - loss: 0.0063 - accuracy: 0.7712 - 113s/epoch - 407ms/step
Epoch 43/80
Validation cm: [[517 159  43  19]
 [268 272  22  27]
 [ 30  14  67  31]
 [ 25  21  76  16]]
Validation normalized_cm: [[0.701 0.215 0.058 0.026]
 [0.455 0.462 0.037 0.046]
 [0.211 0.099 0.472 0.218]
 [0.181 0.152 0.551 0.116]]
Validation acc: 0.5426260112009956
Validation class_accuracies: [0.7005420054200542, 0.4617996604414261, 0.47183098591549294, 0.11594202898550725]
Validation sensitivity: 0.4085155350978136
Validation specificity: 0.7005420054200542
Validation icbhi_score: 0.5545287702589339
Validation roc_auc: None
Validation avg_accuracy: 0.43752867019062014
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 11 epochs
There is no such attribute
279/279 - 113s - loss: 0.0061 - accuracy: 0.7728 - 113s/epoch - 405ms/step
Epoch 44/80
Validation cm: [[553 116  55  14]
 [293 241  24  31]
 [ 31  10  76  25]
 [ 25  19  79  15]]
Validation normalized_cm: [[0.749 0.157 0.075 0.019]
 [0.497 0.409 0.041 0.053]
 [0.218 0.07  0.535 0.176]
 [0.181 0.138 0.572 0.109]]
Validation acc: 0.5507156191661481
Validation class_accuracies: [0.7493224932249323, 0.4091680814940577, 0.5352112676056338, 0.10869565217391304]
Validation sensitivity: 0.38204833141542005
Validation specificity: 0.7493224932249323
Validation icbhi_score: 0.5656854123201762
Validation roc_auc: None
Validation avg_accuracy: 0.4505993736246342
Validation one_indexed_epoch: 44
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 12 epochs
There is no such attribute
279/279 - 112s - loss: 0.0059 - accuracy: 0.7777 - 112s/epoch - 401ms/step
Epoch 45/80
Validation cm: [[552 121  44  21]
 [298 231  23  37]
 [ 31  11  72  28]
 [ 25  20  76  17]]
Validation normalized_cm: [[0.748 0.164 0.06  0.028]
 [0.506 0.392 0.039 0.063]
 [0.218 0.077 0.507 0.197]
 [0.181 0.145 0.551 0.123]]
Validation acc: 0.5426260112009956
Validation class_accuracies: [0.7479674796747967, 0.3921901528013582, 0.5070422535211268, 0.12318840579710146]
Validation sensitivity: 0.36823935558112775
Validation specificity: 0.7479674796747967
Validation icbhi_score: 0.5581034176279622
Validation roc_auc: None
Validation avg_accuracy: 0.4425970729485958
Validation one_indexed_epoch: 45
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 13 epochs
There is no such attribute
279/279 - 116s - loss: 0.0060 - accuracy: 0.7613 - 116s/epoch - 416ms/step
Epoch 46/80
Validation cm: [[515 163  42  18]
 [260 278  21  30]
 [ 32  12  70  28]
 [ 29  19  73  17]]
Validation normalized_cm: [[0.698 0.221 0.057 0.024]
 [0.441 0.472 0.036 0.051]
 [0.225 0.085 0.493 0.197]
 [0.21  0.138 0.529 0.123]]
Validation acc: 0.5476042314872434
Validation class_accuracies: [0.6978319783197832, 0.47198641765704585, 0.49295774647887325, 0.12318840579710146]
Validation sensitivity: 0.42002301495972383
Validation specificity: 0.6978319783197832
Validation icbhi_score: 0.5589274966397535
Validation roc_auc: None
Validation avg_accuracy: 0.4464911370632009
Validation one_indexed_epoch: 46
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 14 epochs
There is no such attribute
279/279 - 116s - loss: 0.0067 - accuracy: 0.7782 - 116s/epoch - 414ms/step
Epoch 47/80
Validation cm: [[511 166  43  18]
 [250 287  21  31]
 [ 32  12  70  28]
 [ 25  23  75  15]]
Validation normalized_cm: [[0.692 0.225 0.058 0.024]
 [0.424 0.487 0.036 0.053]
 [0.225 0.085 0.493 0.197]
 [0.181 0.167 0.543 0.109]]
Validation acc: 0.5494710640945862
Validation class_accuracies: [0.6924119241192412, 0.4872665534804754, 0.49295774647887325, 0.10869565217391304]
Validation sensitivity: 0.428078250863061
Validation specificity: 0.6924119241192412
Validation icbhi_score: 0.5602450874911511
Validation roc_auc: None
Validation avg_accuracy: 0.44533296906312575
Validation one_indexed_epoch: 47
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 15 epochs
There is no such attribute
279/279 - 112s - loss: 0.0068 - accuracy: 0.7739 - 112s/epoch - 403ms/step
Epoch 48/80
Validation cm: [[560 115  46  17]
 [307 231  21  30]
 [ 33  12  73  24]
 [ 31  19  74  14]]
Validation normalized_cm: [[0.759 0.156 0.062 0.023]
 [0.521 0.392 0.036 0.051]
 [0.232 0.085 0.514 0.169]
 [0.225 0.138 0.536 0.101]]
Validation acc: 0.5463596764156814
Validation class_accuracies: [0.7588075880758808, 0.3921901528013582, 0.5140845070422535, 0.10144927536231885]
Validation sensitivity: 0.3659378596087457
Validation specificity: 0.7588075880758808
Validation icbhi_score: 0.5623727238423133
Validation roc_auc: None
Validation avg_accuracy: 0.4416328808204528
Validation one_indexed_epoch: 48
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
279/279 - 118s - loss: 0.0061 - accuracy: 0.7672 - 118s/epoch - 421ms/step
Epoch 49/80
Validation cm: [[525 155  41  17]
 [267 267  22  33]
 [ 33  12  69  28]
 [ 30  21  72  15]]
Validation normalized_cm: [[0.711 0.21  0.056 0.023]
 [0.453 0.453 0.037 0.056]
 [0.232 0.085 0.486 0.197]
 [0.217 0.152 0.522 0.109]]
Validation acc: 0.5451151213441194
Validation class_accuracies: [0.7113821138211383, 0.4533106960950764, 0.4859154929577465, 0.10869565217391304]
Validation sensitivity: 0.4039125431530495
Validation specificity: 0.7113821138211383
Validation icbhi_score: 0.5576473284870939
Validation roc_auc: None
Validation avg_accuracy: 0.43982598876196854
Validation one_indexed_epoch: 49
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 17 epochs
There is no such attribute
279/279 - 117s - loss: 0.0047 - accuracy: 0.7714 - 117s/epoch - 418ms/step
Epoch 50/80
Validation cm: [[532 140  46  20]
 [279 252  23  35]
 [ 33  12  71  26]
 [ 27  21  75  15]]
Validation normalized_cm: [[0.721 0.19  0.062 0.027]
 [0.474 0.428 0.039 0.059]
 [0.232 0.085 0.5   0.183]
 [0.196 0.152 0.543 0.109]]
Validation acc: 0.5413814561294338
Validation class_accuracies: [0.7208672086720868, 0.42784380305602715, 0.5, 0.10869565217391304]
Validation sensitivity: 0.38895281933256615
Validation specificity: 0.7208672086720868
Validation icbhi_score: 0.5549100140023264
Validation roc_auc: None
Validation avg_accuracy: 0.43935166597550673
Validation one_indexed_epoch: 50
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 18 epochs
There is no such attribute
279/279 - 125s - loss: 0.0076 - accuracy: 0.7712 - 125s/epoch - 449ms/step
Epoch 51/80
Validation cm: [[542 137  44  15]
 [287 254  20  28]
 [ 34  13  71  24]
 [ 29  20  74  15]]
Validation normalized_cm: [[0.734 0.186 0.06  0.02 ]
 [0.487 0.431 0.034 0.048]
 [0.239 0.092 0.5   0.169]
 [0.21  0.145 0.536 0.109]]
Validation acc: 0.5488487865588052
Validation class_accuracies: [0.7344173441734417, 0.4312393887945671, 0.5, 0.10869565217391304]
Validation sensitivity: 0.3912543153049482
Validation specificity: 0.7344173441734417
Validation icbhi_score: 0.562835829739195
Validation roc_auc: None
Validation avg_accuracy: 0.44358809628548046
Validation one_indexed_epoch: 51
The validation tracker metric at 0.5867902551292487 hasn't increased by 0 in 19 epochs
There is no such attribute
279/279 - 132s - loss: 0.0060 - accuracy: 0.7716 - 132s/epoch - 474ms/step
Epoch 52/80
Validation cm: [[535 146  41  16]
 [274 266  20  29]
 [ 35  12  68  27]
 [ 29  20  73  16]]
Validation normalized_cm: [[0.725 0.198 0.056 0.022]
 [0.465 0.452 0.034 0.049]
 [0.246 0.085 0.479 0.19 ]
 [0.21  0.145 0.529 0.116]]
Validation acc: 0.5507156191661481
Validation class_accuracies: [0.7249322493224932, 0.45161290322580644, 0.4788732394366197, 0.11594202898550725]
Validation sensitivity: 0.40276179516685845
Validation specificity: 0.7249322493224932
Validation icbhi_score: 0.5638470222446759
Validation roc_auc: None
Validation avg_accuracy: 0.4428401052426067
Validation one_indexed_epoch: 52
The number of epochs since last 1% equals the patience
There is no such attribute
279/279 - 112s - loss: 0.0040 - accuracy: 0.7728 - 112s/epoch - 403ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5867902551292487
Best cm: [[585 106  36  11]
 [313 242  17  17]
 [ 40   9  76  17]
 [ 31  19  75  13]]
Best normalized_cm: [[0.793 0.144 0.049 0.015]
 [0.531 0.411 0.029 0.029]
 [0.282 0.063 0.535 0.12 ]
 [0.225 0.138 0.543 0.094]]
Best acc: 0.5700062227753578
Best class_accuracies: [0.7926829268292683, 0.41086587436332767, 0.5352112676056338, 0.09420289855072464]
Best sensitivity: 0.380897583429229
Best specificity: 0.7926829268292683
Best roc_auc: None
Best avg_accuracy: 0.45824074183723856
Best one_indexed_epoch: 32
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6636695861816406, 0.5620511770248413, 0.49111104011535645, 0.4236345589160919, 0.38672953844070435, 0.31631240248680115, 0.2816101312637329, 0.25169050693511963, 0.20580850541591644, 0.1885412186384201, 0.18399512767791748, 0.16418127715587616, 0.09187911450862885, 0.06238345429301262, 0.048078447580337524, 0.049517922103405, 0.04300219193100929, 0.03217925503849983, 0.044488612562417984, 0.03297251835465431, 0.02431897073984146, 0.023625418543815613, 0.021185560151934624, 0.01991962268948555, 0.019181126728653908, 0.01774575375020504, 0.014177833683788776, 0.015449917875230312, 0.011365911923348904, 0.011066034436225891, 0.01384437270462513, 0.010870288126170635, 0.011390101164579391, 0.013313733972609043, 0.011257702484726906, 0.010712642222642899, 0.01147346943616867, 0.010454845614731312, 0.008528069593012333, 0.01018874254077673, 0.007381968665868044, 0.006328174378722906, 0.006095828488469124, 0.005946065299212933, 0.0059684813022613525, 0.006685607135295868, 0.006765954662114382, 0.006120902951806784, 0.004685812629759312, 0.007606339640915394, 0.006032711826264858, 0.003967535216361284], 'accuracy': [0.5890533924102783, 0.6929116249084473, 0.7353073358535767, 0.7642440795898438, 0.7772544026374817, 0.8003588914871216, 0.8075370192527771, 0.8221175670623779, 0.8171826004981995, 0.8124719858169556, 0.8070883750915527, 0.8088828921318054, 0.8077613115310669, 0.7965455651283264, 0.7934051156044006, 0.7882458567619324, 0.8102288246154785, 0.7978914380073547, 0.7783759236335754, 0.7812920808792114, 0.7711978554725647, 0.7792732119560242, 0.784656822681427, 0.7873485684394836, 0.781740665435791, 0.7729923725128174, 0.7803947925567627, 0.7781516313552856, 0.7743382453918457, 0.781740665435791, 0.7891430854797363, 0.7687304019927979, 0.7777029871940613, 0.78241366147995, 0.7803947925567627, 0.7891430854797363, 0.7839838266372681, 0.7799461483955383, 0.7857784032821655, 0.7909376621246338, 0.7747868895530701, 0.7711978554725647, 0.7727680802345276, 0.7777029871940613, 0.7613279223442078, 0.7781516313552856, 0.7738896608352661, 0.767160177230835, 0.7714221477508545, 0.7711978554725647, 0.7716464996337891, 0.7727680802345276]}
Job id is 5.
-----------------------
--- Final training dataset went from 0 to 4467 elements, with 2251 none's, 1179 crakles, 516 wheezes and 521 both ---
--- Final Validation dataset contains 1598 elements, with 627 none, 655 crackles, 201 wheezes and 115 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.4961128387383385, 1: 0.9472010178117048, 2: 2.1642441860465116, 3: 2.1434740882917467}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_4 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_4[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_3   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_9 (Dense)             (None, 100)               204900    
                                                                 
 dropout_6 (Dropout)         (None, 100)               0         
                                                                 
 dense_10 (Dense)            (None, 50)                5050      
                                                                 
 dropout_7 (Dropout)         (None, 50)                0         
                                                                 
 dense_11 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_3"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_6 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_7 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_3 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[596  28   3   0]
 [590  65   0   0]
 [177  24   0   0]
 [ 97  18   0   0]]
Validation normalized_cm: [[0.951 0.045 0.005 0.   ]
 [0.901 0.099 0.    0.   ]
 [0.881 0.119 0.    0.   ]
 [0.843 0.157 0.    0.   ]]
Validation acc: 0.41364205256570713
Validation class_accuracies: [0.9505582137161085, 0.09923664122137404, 0.0, 0.0]
Validation sensitivity: 0.06694129763130793
Validation specificity: 0.9505582137161085
Validation icbhi_score: 0.5087497556737082
Validation roc_auc: None
Validation avg_accuracy: 0.2624487137343706
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
280/280 - 123s - loss: 0.6600 - accuracy: 0.5997 - 123s/epoch - 438ms/step
Epoch 2/80
Validation cm: [[102 507   6  12]
 [ 25 625   0   5]
 [  8 142  21  30]
 [  2  86   6  21]]
Validation normalized_cm: [[0.163 0.809 0.01  0.019]
 [0.038 0.954 0.    0.008]
 [0.04  0.706 0.104 0.149]
 [0.017 0.748 0.052 0.183]]
Validation acc: 0.4812265331664581
Validation class_accuracies: [0.16267942583732056, 0.9541984732824428, 0.1044776119402985, 0.1826086956521739]
Validation sensitivity: 0.6869207003089598
Validation specificity: 0.16267942583732056
Validation icbhi_score: 0.42480006307314017
Validation roc_auc: None
Validation avg_accuracy: 0.350991051678059
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5087497556737082 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 116s - loss: 0.5648 - accuracy: 0.6922 - 116s/epoch - 414ms/step
Epoch 3/80
Validation cm: [[144  41 311 131]
 [ 51  93 157 354]
 [  5   4 110  82]
 [  0   3  59  53]]
Validation normalized_cm: [[0.23  0.065 0.496 0.209]
 [0.078 0.142 0.24  0.54 ]
 [0.025 0.02  0.547 0.408]
 [0.    0.026 0.513 0.461]]
Validation acc: 0.2503128911138924
Validation class_accuracies: [0.22966507177033493, 0.14198473282442747, 0.5472636815920398, 0.4608695652173913]
Validation sensitivity: 0.26364572605561276
Validation specificity: 0.22966507177033493
Validation icbhi_score: 0.24665539891297383
Validation roc_auc: None
Validation avg_accuracy: 0.3449457628510484
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5087497556737082 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 125s - loss: 0.5154 - accuracy: 0.7508 - 125s/epoch - 445ms/step
Epoch 4/80
Validation cm: [[274 291  17  45]
 [167 440   8  40]
 [ 29  64  48  60]
 [ 10  65  21  19]]
Validation normalized_cm: [[0.437 0.464 0.027 0.072]
 [0.255 0.672 0.012 0.061]
 [0.144 0.318 0.239 0.299]
 [0.087 0.565 0.183 0.165]]
Validation acc: 0.48873591989987486
Validation class_accuracies: [0.4370015948963317, 0.6717557251908397, 0.23880597014925373, 0.16521739130434782]
Validation sensitivity: 0.5221421215242018
Validation specificity: 0.4370015948963317
Validation icbhi_score: 0.47957185821026677
Validation roc_auc: None
Validation avg_accuracy: 0.37819517038519324
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5087497556737082 hasn't increased by 0 in 3 epochs
There is no such attribute
280/280 - 119s - loss: 0.4608 - accuracy: 0.7743 - 119s/epoch - 424ms/step
Epoch 5/80
Validation cm: [[449 122  49   7]
 [309 260  55  31]
 [ 56  42  62  41]
 [ 25  39  27  24]]
Validation normalized_cm: [[0.716 0.195 0.078 0.011]
 [0.472 0.397 0.084 0.047]
 [0.279 0.209 0.308 0.204]
 [0.217 0.339 0.235 0.209]]
Validation acc: 0.4974968710888611
Validation class_accuracies: [0.7161084529505582, 0.3969465648854962, 0.30845771144278605, 0.20869565217391303]
Validation sensitivity: 0.35633367662203913
Validation specificity: 0.7161084529505582
Validation icbhi_score: 0.5362210647862987
Validation roc_auc: None
Validation avg_accuracy: 0.40755209536318837
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
280/280 - 122s - loss: 0.4162 - accuracy: 0.7766 - 122s/epoch - 437ms/step
Epoch 6/80
Validation cm: [[451 159  15   2]
 [358 291   2   4]
 [ 84  50  48  19]
 [ 47  43  17   8]]
Validation normalized_cm: [[0.719 0.254 0.024 0.003]
 [0.547 0.444 0.003 0.006]
 [0.418 0.249 0.239 0.095]
 [0.409 0.374 0.148 0.07 ]]
Validation acc: 0.49937421777221525
Validation class_accuracies: [0.7192982456140351, 0.4442748091603053, 0.23880597014925373, 0.06956521739130435]
Validation sensitivity: 0.3573635427394439
Validation specificity: 0.7192982456140351
Validation icbhi_score: 0.5383308941767395
Validation roc_auc: None
Validation avg_accuracy: 0.3679860605787246
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
280/280 - 126s - loss: 0.3543 - accuracy: 0.7813 - 126s/epoch - 451ms/step
Epoch 7/80
Validation cm: [[357 167  41  62]
 [168 391  11  85]
 [ 52  38  32  79]
 [ 34  31   9  41]]
Validation normalized_cm: [[0.569 0.266 0.065 0.099]
 [0.256 0.597 0.017 0.13 ]
 [0.259 0.189 0.159 0.393]
 [0.296 0.27  0.078 0.357]]
Validation acc: 0.513767209011264
Validation class_accuracies: [0.569377990430622, 0.5969465648854961, 0.15920398009950248, 0.3565217391304348]
Validation sensitivity: 0.47785787847579814
Validation specificity: 0.569377990430622
Validation icbhi_score: 0.52361793445321
Validation roc_auc: None
Validation avg_accuracy: 0.4205125686365138
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5383308941767395 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 128s - loss: 0.3034 - accuracy: 0.8039 - 128s/epoch - 458ms/step
Epoch 8/80
Validation cm: [[127 496   0   4]
 [ 19 629   0   7]
 [ 10 160   8  23]
 [  1 104   0  10]]
Validation normalized_cm: [[0.203 0.791 0.    0.006]
 [0.029 0.96  0.    0.011]
 [0.05  0.796 0.04  0.114]
 [0.009 0.904 0.    0.087]]
Validation acc: 0.48435544430538174
Validation class_accuracies: [0.2025518341307815, 0.9603053435114504, 0.03980099502487562, 0.08695652173913043]
Validation sensitivity: 0.666323377960865
Validation specificity: 0.2025518341307815
Validation icbhi_score: 0.43443760604582327
Validation roc_auc: None
Validation avg_accuracy: 0.32240367360155947
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5383308941767395 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 128s - loss: 0.2560 - accuracy: 0.8057 - 128s/epoch - 456ms/step
Epoch 9/80
Validation cm: [[341 259  19   8]
 [130 511   5   9]
 [ 46  78  59  18]
 [ 29  58  19   9]]
Validation normalized_cm: [[0.544 0.413 0.03  0.013]
 [0.198 0.78  0.008 0.014]
 [0.229 0.388 0.294 0.09 ]
 [0.252 0.504 0.165 0.078]]
Validation acc: 0.5757196495619524
Validation class_accuracies: [0.543859649122807, 0.7801526717557252, 0.2935323383084577, 0.0782608695652174]
Validation sensitivity: 0.596292481977343
Validation specificity: 0.543859649122807
Validation icbhi_score: 0.570076065550075
Validation roc_auc: None
Validation avg_accuracy: 0.42395138218805184
Validation one_indexed_epoch: 9
-- New best results were achieved. --
There is no such attribute
280/280 - 123s - loss: 0.2205 - accuracy: 0.8052 - 123s/epoch - 438ms/step
Epoch 10/80
Validation cm: [[ 50 546   1  30]
 [  7 619   0  29]
 [  5 140  13  43]
 [  0  94   1  20]]
Validation normalized_cm: [[0.08  0.871 0.002 0.048]
 [0.011 0.945 0.    0.044]
 [0.025 0.697 0.065 0.214]
 [0.    0.817 0.009 0.174]]
Validation acc: 0.43929912390488113
Validation class_accuracies: [0.07974481658692185, 0.9450381679389313, 0.06467661691542288, 0.17391304347826086]
Validation sensitivity: 0.6714727085478888
Validation specificity: 0.07974481658692185
Validation icbhi_score: 0.37560876256740533
Validation roc_auc: None
Validation avg_accuracy: 0.3158431612298842
Validation one_indexed_epoch: 10
The validation tracker metric at 0.570076065550075 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 128s - loss: 0.1984 - accuracy: 0.8171 - 128s/epoch - 455ms/step
Epoch 11/80
Validation cm: [[412 158  39  18]
 [330 273  23  29]
 [ 54  51  40  56]
 [ 27  38  20  30]]
Validation normalized_cm: [[0.657 0.252 0.062 0.029]
 [0.504 0.417 0.035 0.044]
 [0.269 0.254 0.199 0.279]
 [0.235 0.33  0.174 0.261]]
Validation acc: 0.47246558197747185
Validation class_accuracies: [0.6570972886762361, 0.416793893129771, 0.19900497512437812, 0.2608695652173913]
Validation sensitivity: 0.3532440782698249
Validation specificity: 0.6570972886762361
Validation icbhi_score: 0.5051706834730305
Validation roc_auc: None
Validation avg_accuracy: 0.38344143053694413
Validation one_indexed_epoch: 11
The validation tracker metric at 0.570076065550075 hasn't increased by 0 in 2 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
280/280 - 129s - loss: 0.1798 - accuracy: 0.7990 - 129s/epoch - 462ms/step
Epoch 12/80
Validation cm: [[342 274   7   4]
 [182 466   4   3]
 [ 62  81  38  20]
 [ 19  71   5  20]]
Validation normalized_cm: [[0.545 0.437 0.011 0.006]
 [0.278 0.711 0.006 0.005]
 [0.308 0.403 0.189 0.1  ]
 [0.165 0.617 0.043 0.174]]
Validation acc: 0.541927409261577
Validation class_accuracies: [0.5454545454545454, 0.7114503816793893, 0.1890547263681592, 0.17391304347826086]
Validation sensitivity: 0.5396498455200824
Validation specificity: 0.5454545454545454
Validation icbhi_score: 0.5425521954873139
Validation roc_auc: None
Validation avg_accuracy: 0.4049681742450887
Validation one_indexed_epoch: 12
The validation tracker metric at 0.570076065550075 hasn't increased by 0 in 3 epochs
There is no such attribute
280/280 - 129s - loss: 0.1256 - accuracy: 0.8296 - 129s/epoch - 462ms/step
Epoch 13/80
Validation cm: [[412  87  59  69]
 [373 165  57  60]
 [ 53  16  60  72]
 [ 32  13  28  42]]
Validation normalized_cm: [[0.657 0.139 0.094 0.11 ]
 [0.569 0.252 0.087 0.092]
 [0.264 0.08  0.299 0.358]
 [0.278 0.113 0.243 0.365]]
Validation acc: 0.42490613266583227
Validation class_accuracies: [0.6570972886762361, 0.25190839694656486, 0.29850746268656714, 0.3652173913043478]
Validation sensitivity: 0.2749742533470649
Validation specificity: 0.6570972886762361
Validation icbhi_score: 0.4660357710116505
Validation roc_auc: None
Validation avg_accuracy: 0.393182634903429
Validation one_indexed_epoch: 13
The validation tracker metric at 0.570076065550075 hasn't increased by 0 in 4 epochs
There is no such attribute
280/280 - 129s - loss: 0.1465 - accuracy: 0.8068 - 129s/epoch - 460ms/step
Epoch 14/80
Validation cm: [[236 206  34 151]
 [127 289  16 223]
 [ 16  17  39 129]
 [  3  13  14  85]]
Validation normalized_cm: [[0.376 0.329 0.054 0.241]
 [0.194 0.441 0.024 0.34 ]
 [0.08  0.085 0.194 0.642]
 [0.026 0.113 0.122 0.739]]
Validation acc: 0.40613266583229035
Validation class_accuracies: [0.3763955342902711, 0.44122137404580153, 0.19402985074626866, 0.7391304347826086]
Validation sensitivity: 0.4253347064881565
Validation specificity: 0.3763955342902711
Validation icbhi_score: 0.40086512038921385
Validation roc_auc: None
Validation avg_accuracy: 0.4376942984662375
Validation one_indexed_epoch: 14
The validation tracker metric at 0.570076065550075 hasn't increased by 0 in 5 epochs
There is no such attribute
280/280 - 129s - loss: 0.1208 - accuracy: 0.8111 - 129s/epoch - 462ms/step
Epoch 15/80
Validation cm: [[378 223   2  24]
 [281 318   1  55]
 [ 51  55  12  83]
 [ 37  35   1  42]]
Validation normalized_cm: [[0.603 0.356 0.003 0.038]
 [0.429 0.485 0.002 0.084]
 [0.254 0.274 0.06  0.413]
 [0.322 0.304 0.009 0.365]]
Validation acc: 0.4693366708385482
Validation class_accuracies: [0.6028708133971292, 0.4854961832061069, 0.05970149253731343, 0.3652173913043478]
Validation sensitivity: 0.3831101956745623
Validation specificity: 0.6028708133971292
Validation icbhi_score: 0.49299050453584575
Validation roc_auc: None
Validation avg_accuracy: 0.3783214701112243
Validation one_indexed_epoch: 15
The validation tracker metric at 0.570076065550075 hasn't increased by 0 in 6 epochs
There is no such attribute
280/280 - 130s - loss: 0.1018 - accuracy: 0.8187 - 130s/epoch - 463ms/step
Epoch 16/80
Validation cm: [[465 127  33   2]
 [242 352  44  17]
 [ 55  37  90  19]
 [ 33  37  20  25]]
Validation normalized_cm: [[0.742 0.203 0.053 0.003]
 [0.369 0.537 0.067 0.026]
 [0.274 0.184 0.448 0.095]
 [0.287 0.322 0.174 0.217]]
Validation acc: 0.5832290362953693
Validation class_accuracies: [0.7416267942583732, 0.5374045801526718, 0.44776119402985076, 0.21739130434782608]
Validation sensitivity: 0.48094747682801237
Validation specificity: 0.7416267942583732
Validation icbhi_score: 0.6112871355431928
Validation roc_auc: None
Validation avg_accuracy: 0.4860459681971805
Validation one_indexed_epoch: 16
-- New best results were achieved. --
There is no such attribute
280/280 - 129s - loss: 0.1151 - accuracy: 0.8225 - 129s/epoch - 459ms/step
Epoch 17/80
Validation cm: [[400  95 119  13]
 [294 231  93  37]
 [ 47  19 120  15]
 [ 22  19  58  16]]
Validation normalized_cm: [[0.638 0.152 0.19  0.021]
 [0.449 0.353 0.142 0.056]
 [0.234 0.095 0.597 0.075]
 [0.191 0.165 0.504 0.139]]
Validation acc: 0.4799749687108886
Validation class_accuracies: [0.6379585326953748, 0.3526717557251908, 0.5970149253731343, 0.1391304347826087]
Validation sensitivity: 0.3779608650875386
Validation specificity: 0.6379585326953748
Validation icbhi_score: 0.5079596988914568
Validation roc_auc: None
Validation avg_accuracy: 0.43169391214407715
Validation one_indexed_epoch: 17
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 1 epochs
There is no such attribute
280/280 - 128s - loss: 0.0862 - accuracy: 0.8285 - 128s/epoch - 458ms/step
Epoch 18/80
Validation cm: [[145 439   2  41]
 [ 85 489   0  81]
 [ 30  81  10  80]
 [  9  73   0  33]]
Validation normalized_cm: [[0.231 0.7   0.003 0.065]
 [0.13  0.747 0.    0.124]
 [0.149 0.403 0.05  0.398]
 [0.078 0.635 0.    0.287]]
Validation acc: 0.4236545682102628
Validation class_accuracies: [0.23125996810207336, 0.7465648854961832, 0.04975124378109453, 0.28695652173913044]
Validation sensitivity: 0.5478887744593203
Validation specificity: 0.23125996810207336
Validation icbhi_score: 0.38957437128069683
Validation roc_auc: None
Validation avg_accuracy: 0.3286331547796204
Validation one_indexed_epoch: 18
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 2 epochs
There is no such attribute
280/280 - 129s - loss: 0.0564 - accuracy: 0.8198 - 129s/epoch - 460ms/step
Epoch 19/80
Validation cm: [[467 139  20   1]
 [402 247   5   1]
 [100  32  62   7]
 [ 46  45  16   8]]
Validation normalized_cm: [[0.745 0.222 0.032 0.002]
 [0.614 0.377 0.008 0.002]
 [0.498 0.159 0.308 0.035]
 [0.4   0.391 0.139 0.07 ]]
Validation acc: 0.490613266583229
Validation class_accuracies: [0.74481658692185, 0.37709923664122136, 0.30845771144278605, 0.06956521739130435]
Validation sensitivity: 0.32646755921730175
Validation specificity: 0.74481658692185
Validation icbhi_score: 0.5356420730695759
Validation roc_auc: None
Validation avg_accuracy: 0.3749846880992905
Validation one_indexed_epoch: 19
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 3 epochs
There is no such attribute
280/280 - 124s - loss: 0.0811 - accuracy: 0.8093 - 124s/epoch - 443ms/step
Epoch 20/80
Validation cm: [[346 262  16   3]
 [302 330   2  21]
 [ 83  63  38  17]
 [ 22  61   8  24]]
Validation normalized_cm: [[0.552 0.418 0.026 0.005]
 [0.461 0.504 0.003 0.032]
 [0.413 0.313 0.189 0.085]
 [0.191 0.53  0.07  0.209]]
Validation acc: 0.4618272841051314
Validation class_accuracies: [0.5518341307814992, 0.5038167938931297, 0.1890547263681592, 0.20869565217391303]
Validation sensitivity: 0.40370751802265703
Validation specificity: 0.5518341307814992
Validation icbhi_score: 0.47777082440207813
Validation roc_auc: None
Validation avg_accuracy: 0.36335032580417526
Validation one_indexed_epoch: 20
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 4 epochs
There is no such attribute
280/280 - 129s - loss: 0.0618 - accuracy: 0.8151 - 129s/epoch - 459ms/step
Epoch 21/80
Validation cm: [[476  65  72  14]
 [357 152  66  80]
 [ 59  13  90  39]
 [ 35  14  39  27]]
Validation normalized_cm: [[0.759 0.104 0.115 0.022]
 [0.545 0.232 0.101 0.122]
 [0.294 0.065 0.448 0.194]
 [0.304 0.122 0.339 0.235]]
Validation acc: 0.4662077596996245
Validation class_accuracies: [0.759170653907496, 0.23206106870229007, 0.44776119402985076, 0.23478260869565218]
Validation sensitivity: 0.27703398558187436
Validation specificity: 0.759170653907496
Validation icbhi_score: 0.5181023197446852
Validation roc_auc: None
Validation avg_accuracy: 0.41844388133382227
Validation one_indexed_epoch: 21
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 5 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
280/280 - 129s - loss: 0.0645 - accuracy: 0.7974 - 129s/epoch - 461ms/step
Epoch 22/80
Validation cm: [[ 98 313   4 212]
 [ 14 290   1 350]
 [ 10  39  12 140]
 [  2  21   3  89]]
Validation normalized_cm: [[0.156 0.499 0.006 0.338]
 [0.021 0.443 0.002 0.534]
 [0.05  0.194 0.06  0.697]
 [0.017 0.183 0.026 0.774]]
Validation acc: 0.30600750938673343
Validation class_accuracies: [0.15629984051036683, 0.44274809160305345, 0.05970149253731343, 0.7739130434782608]
Validation sensitivity: 0.40267765190525234
Validation specificity: 0.15629984051036683
Validation icbhi_score: 0.2794887462078096
Validation roc_auc: None
Validation avg_accuracy: 0.35816561703224864
Validation one_indexed_epoch: 22
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 6 epochs
There is no such attribute
280/280 - 125s - loss: 0.0491 - accuracy: 0.8133 - 125s/epoch - 446ms/step
Epoch 23/80
Validation cm: [[192 355  32  48]
 [ 71 513  13  58]
 [ 21  79  49  52]
 [  5  57  10  43]]
Validation normalized_cm: [[0.306 0.566 0.051 0.077]
 [0.108 0.783 0.02  0.089]
 [0.104 0.393 0.244 0.259]
 [0.043 0.496 0.087 0.374]]
Validation acc: 0.49874843554443055
Validation class_accuracies: [0.3062200956937799, 0.783206106870229, 0.24378109452736318, 0.3739130434782609]
Validation sensitivity: 0.6230690010298661
Validation specificity: 0.3062200956937799
Validation icbhi_score: 0.464644548361823
Validation roc_auc: None
Validation avg_accuracy: 0.4267800851424083
Validation one_indexed_epoch: 23
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 7 epochs
There is no such attribute
280/280 - 129s - loss: 0.0637 - accuracy: 0.8093 - 129s/epoch - 459ms/step
Epoch 24/80
Validation cm: [[484 127  12   4]
 [365 259   9  22]
 [ 74  30  58  39]
 [ 37  36  17  25]]
Validation normalized_cm: [[0.772 0.203 0.019 0.006]
 [0.557 0.395 0.014 0.034]
 [0.368 0.149 0.289 0.194]
 [0.322 0.313 0.148 0.217]]
Validation acc: 0.5168961201501877
Validation class_accuracies: [0.7719298245614035, 0.39541984732824426, 0.2885572139303483, 0.21739130434782608]
Validation sensitivity: 0.35221421215242016
Validation specificity: 0.7719298245614035
Validation icbhi_score: 0.5620720183569118
Validation roc_auc: None
Validation avg_accuracy: 0.4183245475419555
Validation one_indexed_epoch: 24
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
280/280 - 129s - loss: 0.0394 - accuracy: 0.8102 - 129s/epoch - 462ms/step
Epoch 25/80
Validation cm: [[534  35  49   9]
 [450 128  35  42]
 [ 67  14  75  45]
 [ 42  20  20  33]]
Validation normalized_cm: [[0.852 0.056 0.078 0.014]
 [0.687 0.195 0.053 0.064]
 [0.333 0.07  0.373 0.224]
 [0.365 0.174 0.174 0.287]]
Validation acc: 0.4818523153942428
Validation class_accuracies: [0.8516746411483254, 0.19541984732824427, 0.373134328358209, 0.28695652173913044]
Validation sensitivity: 0.243048403707518
Validation specificity: 0.8516746411483254
Validation icbhi_score: 0.5473615224279217
Validation roc_auc: None
Validation avg_accuracy: 0.4267963346434772
Validation one_indexed_epoch: 25
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 9 epochs
There is no such attribute
280/280 - 129s - loss: 0.0386 - accuracy: 0.8041 - 129s/epoch - 460ms/step
Epoch 26/80
Validation cm: [[505  76  39   7]
 [350 259  20  26]
 [ 67  18  77  39]
 [ 38  27  23  27]]
Validation normalized_cm: [[0.805 0.121 0.062 0.011]
 [0.534 0.395 0.031 0.04 ]
 [0.333 0.09  0.383 0.194]
 [0.33  0.235 0.2   0.235]]
Validation acc: 0.5431789737171464
Validation class_accuracies: [0.8054226475279107, 0.39541984732824426, 0.38308457711442784, 0.23478260869565218]
Validation sensitivity: 0.37384140061791965
Validation specificity: 0.8054226475279107
Validation icbhi_score: 0.5896320240729152
Validation roc_auc: None
Validation avg_accuracy: 0.4546774201665587
Validation one_indexed_epoch: 26
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 10 epochs
There is no such attribute
280/280 - 127s - loss: 0.0214 - accuracy: 0.7824 - 127s/epoch - 454ms/step
Epoch 27/80
Validation cm: [[124 424   5  74]
 [ 33 516   0 106]
 [ 16  71  13 101]
 [  5  59   1  50]]
Validation normalized_cm: [[0.198 0.676 0.008 0.118]
 [0.05  0.788 0.    0.162]
 [0.08  0.353 0.065 0.502]
 [0.043 0.513 0.009 0.435]]
Validation acc: 0.4399249061326658
Validation class_accuracies: [0.19776714513556617, 0.7877862595419848, 0.06467661691542288, 0.43478260869565216]
Validation sensitivity: 0.596292481977343
Validation specificity: 0.19776714513556617
Validation icbhi_score: 0.39702981355645456
Validation roc_auc: None
Validation avg_accuracy: 0.3712531575721565
Validation one_indexed_epoch: 27
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 11 epochs
There is no such attribute
280/280 - 128s - loss: 0.0196 - accuracy: 0.8068 - 128s/epoch - 459ms/step
Epoch 28/80
Validation cm: [[547  57  21   2]
 [460 178   8   9]
 [103  12  77   9]
 [ 52  24  15  24]]
Validation normalized_cm: [[0.872 0.091 0.033 0.003]
 [0.702 0.272 0.012 0.014]
 [0.512 0.06  0.383 0.045]
 [0.452 0.209 0.13  0.209]]
Validation acc: 0.5168961201501877
Validation class_accuracies: [0.8724082934609251, 0.2717557251908397, 0.38308457711442784, 0.20869565217391303]
Validation sensitivity: 0.28733264675592174
Validation specificity: 0.8724082934609251
Validation icbhi_score: 0.5798704701084234
Validation roc_auc: None
Validation avg_accuracy: 0.4339860619850264
Validation one_indexed_epoch: 28
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 12 epochs
There is no such attribute
280/280 - 128s - loss: 0.0194 - accuracy: 0.7954 - 128s/epoch - 458ms/step
Epoch 29/80
Validation cm: [[270 346  10   1]
 [110 530   4  11]
 [ 36  88  41  36]
 [ 16  79   7  13]]
Validation normalized_cm: [[0.431 0.552 0.016 0.002]
 [0.168 0.809 0.006 0.017]
 [0.179 0.438 0.204 0.179]
 [0.139 0.687 0.061 0.113]]
Validation acc: 0.5344180225281602
Validation class_accuracies: [0.430622009569378, 0.8091603053435115, 0.20398009950248755, 0.11304347826086956]
Validation sensitivity: 0.6014418125643667
Validation specificity: 0.430622009569378
Validation icbhi_score: 0.5160319110668723
Validation roc_auc: None
Validation avg_accuracy: 0.3892014731690617
Validation one_indexed_epoch: 29
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 13 epochs
There is no such attribute
280/280 - 129s - loss: 0.0138 - accuracy: 0.8084 - 129s/epoch - 462ms/step
Epoch 30/80
Validation cm: [[545  40  39   3]
 [460 161  16  18]
 [ 79   8  91  23]
 [ 45  17  26  27]]
Validation normalized_cm: [[0.869 0.064 0.062 0.005]
 [0.702 0.246 0.024 0.027]
 [0.393 0.04  0.453 0.114]
 [0.391 0.148 0.226 0.235]]
Validation acc: 0.5156445556946183
Validation class_accuracies: [0.8692185007974481, 0.24580152671755726, 0.4527363184079602, 0.23478260869565218]
Validation sensitivity: 0.28733264675592174
Validation specificity: 0.8692185007974481
Validation icbhi_score: 0.5782755737766849
Validation roc_auc: None
Validation avg_accuracy: 0.4506347386546544
Validation one_indexed_epoch: 30
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 14 epochs
There is no such attribute
280/280 - 129s - loss: 0.0173 - accuracy: 0.8169 - 129s/epoch - 461ms/step
Epoch 31/80
Validation cm: [[369 224  21  13]
 [168 465   5  17]
 [ 44  60  49  48]
 [ 21  53   8  33]]
Validation normalized_cm: [[0.589 0.357 0.033 0.021]
 [0.256 0.71  0.008 0.026]
 [0.219 0.299 0.244 0.239]
 [0.183 0.461 0.07  0.287]]
Validation acc: 0.5732165206508135
Validation class_accuracies: [0.5885167464114832, 0.7099236641221374, 0.24378109452736318, 0.28695652173913044]
Validation sensitivity: 0.5633367662203913
Validation specificity: 0.5885167464114832
Validation icbhi_score: 0.5759267563159373
Validation roc_auc: None
Validation avg_accuracy: 0.4572945067000286
Validation one_indexed_epoch: 31
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 15 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
280/280 - 129s - loss: 0.0188 - accuracy: 0.8126 - 129s/epoch - 460ms/step
Epoch 32/80
Validation cm: [[484 101  18  24]
 [273 336   7  39]
 [ 58  33  39  71]
 [ 33  29   9  44]]
Validation normalized_cm: [[0.772 0.161 0.029 0.038]
 [0.417 0.513 0.011 0.06 ]
 [0.289 0.164 0.194 0.353]
 [0.287 0.252 0.078 0.383]]
Validation acc: 0.565081351689612
Validation class_accuracies: [0.7719298245614035, 0.5129770992366413, 0.19402985074626866, 0.3826086956521739]
Validation sensitivity: 0.431513903192585
Validation specificity: 0.7719298245614035
Validation icbhi_score: 0.6017218638769942
Validation roc_auc: None
Validation avg_accuracy: 0.46538636754912177
Validation one_indexed_epoch: 32
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
280/280 - 124s - loss: 0.0241 - accuracy: 0.8008 - 124s/epoch - 444ms/step
Epoch 33/80
Validation cm: [[517  77  24   9]
 [346 277   8  24]
 [ 74  23  55  49]
 [ 40  26  19  30]]
Validation normalized_cm: [[0.825 0.123 0.038 0.014]
 [0.528 0.423 0.012 0.037]
 [0.368 0.114 0.274 0.244]
 [0.348 0.226 0.165 0.261]]
Validation acc: 0.5500625782227785
Validation class_accuracies: [0.8245614035087719, 0.42290076335877863, 0.2736318407960199, 0.2608695652173913]
Validation sensitivity: 0.3728115345005149
Validation specificity: 0.8245614035087719
Validation icbhi_score: 0.5986864690046434
Validation roc_auc: None
Validation avg_accuracy: 0.44549089322024044
Validation one_indexed_epoch: 33
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 17 epochs
There is no such attribute
280/280 - 129s - loss: 0.0124 - accuracy: 0.8169 - 129s/epoch - 462ms/step
Epoch 34/80
Validation cm: [[466 134  19   8]
 [273 350   4  28]
 [ 59  39  50  53]
 [ 33  33  19  30]]
Validation normalized_cm: [[0.743 0.214 0.03  0.013]
 [0.417 0.534 0.006 0.043]
 [0.294 0.194 0.249 0.264]
 [0.287 0.287 0.165 0.261]]
Validation acc: 0.5607008760951189
Validation class_accuracies: [0.7432216905901117, 0.5343511450381679, 0.24875621890547264, 0.2608695652173913]
Validation sensitivity: 0.4428424304840371
Validation specificity: 0.7432216905901117
Validation icbhi_score: 0.5930320605370744
Validation roc_auc: None
Validation avg_accuracy: 0.4467996549377859
Validation one_indexed_epoch: 34
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 18 epochs
There is no such attribute
280/280 - 130s - loss: 0.0106 - accuracy: 0.8171 - 130s/epoch - 465ms/step
Epoch 35/80
Validation cm: [[481 112  25   9]
 [299 320   6  30]
 [ 60  30  58  53]
 [ 33  32  19  31]]
Validation normalized_cm: [[0.767 0.179 0.04  0.014]
 [0.456 0.489 0.009 0.046]
 [0.299 0.149 0.289 0.264]
 [0.287 0.278 0.165 0.27 ]]
Validation acc: 0.5569461827284106
Validation class_accuracies: [0.7671451355661882, 0.48854961832061067, 0.2885572139303483, 0.26956521739130435]
Validation sensitivity: 0.4212152420185376
Validation specificity: 0.7671451355661882
Validation icbhi_score: 0.5941801887923629
Validation roc_auc: None
Validation avg_accuracy: 0.45345429630211287
Validation one_indexed_epoch: 35
The validation tracker metric at 0.6112871355431928 hasn't increased by 0 in 19 epochs
There is no such attribute
280/280 - 129s - loss: 0.0081 - accuracy: 0.8146 - 129s/epoch - 461ms/step
Epoch 36/80
Validation cm: [[527  76  18   6]
 [364 263   7  21]
 [ 81  18  54  48]
 [ 41  23  24  27]]
Validation normalized_cm: [[0.841 0.121 0.029 0.01 ]
 [0.556 0.402 0.011 0.032]
 [0.403 0.09  0.269 0.239]
 [0.357 0.2   0.209 0.235]]
Validation acc: 0.5450563204005007
Validation class_accuracies: [0.8405103668261563, 0.4015267175572519, 0.26865671641791045, 0.23478260869565218]
Validation sensitivity: 0.35427394438722964
Validation specificity: 0.8405103668261563
Validation icbhi_score: 0.597392155606693
Validation roc_auc: None
Validation avg_accuracy: 0.43636910237424265
Validation one_indexed_epoch: 36
The number of epochs since last 1% equals the patience
There is no such attribute
280/280 - 124s - loss: 0.0068 - accuracy: 0.8032 - 124s/epoch - 443ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.6112871355431928
Best cm: [[465 127  33   2]
 [242 352  44  17]
 [ 55  37  90  19]
 [ 33  37  20  25]]
Best normalized_cm: [[0.742 0.203 0.053 0.003]
 [0.369 0.537 0.067 0.026]
 [0.274 0.184 0.448 0.095]
 [0.287 0.322 0.174 0.217]]
Best acc: 0.5832290362953693
Best class_accuracies: [0.7416267942583732, 0.5374045801526718, 0.44776119402985076, 0.21739130434782608]
Best sensitivity: 0.48094747682801237
Best specificity: 0.7416267942583732
Best roc_auc: None
Best avg_accuracy: 0.4860459681971805
Best one_indexed_epoch: 16
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.659982442855835, 0.5648206472396851, 0.5153612494468689, 0.46080145239830017, 0.41617733240127563, 0.3543446660041809, 0.30339664220809937, 0.25603726506233215, 0.22049981355667114, 0.19842027127742767, 0.17981304228305817, 0.12563300132751465, 0.14654697477817535, 0.12080492824316025, 0.10179715603590012, 0.1150854155421257, 0.08620333671569824, 0.05637345835566521, 0.08107266575098038, 0.061828114092350006, 0.0644674152135849, 0.04909418523311615, 0.0636981800198555, 0.03936196491122246, 0.038557834923267365, 0.021425746381282806, 0.019562318921089172, 0.019382121041417122, 0.013756667263805866, 0.017305459827184677, 0.018812866881489754, 0.024115486070513725, 0.012377564795315266, 0.010591558180749416, 0.008112236857414246, 0.0068026259541511536], 'accuracy': [0.5997313857078552, 0.6921871304512024, 0.7508394718170166, 0.7743452191352844, 0.7765838503837585, 0.7812849879264832, 0.8038952350616455, 0.8056861162185669, 0.8052384257316589, 0.8171032071113586, 0.7989702224731445, 0.8296395540237427, 0.8068054914474487, 0.8110588788986206, 0.8186702728271484, 0.8224759101867676, 0.8285202383995056, 0.8197895884513855, 0.8092679381370544, 0.8150884509086609, 0.7974031567573547, 0.8132975101470947, 0.8092679381370544, 0.8101634383201599, 0.8041191101074219, 0.7824043035507202, 0.8068054914474487, 0.795388400554657, 0.8083724975585938, 0.8168793320655823, 0.8126259446144104, 0.8007611632347107, 0.8168793320655823, 0.8171032071113586, 0.8146407008171082, 0.8032236695289612]}
Job id is 6.
-----------------------
--- Final training dataset went from 0 to 4630 elements, with 2232 none's, 1328 crakles, 563 wheezes and 507 both ---
--- Final Validation dataset contains 1435 elements, with 646 none, 506 crackles, 154 wheezes and 129 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5185931899641577, 1: 0.8716114457831325, 2: 2.05595026642984, 3: 2.2830374753451674}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_5 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_5[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_4   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_12 (Dense)            (None, 100)               204900    
                                                                 
 dropout_8 (Dropout)         (None, 100)               0         
                                                                 
 dense_13 (Dense)            (None, 50)                5050      
                                                                 
 dropout_9 (Dropout)         (None, 50)                0         
                                                                 
 dense_14 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_4"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_8 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_9 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_4 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 49  40 125 432]
 [ 30  49  89 338]
 [ 17  15  18 104]
 [  5  26   7  91]]
Validation normalized_cm: [[0.076 0.062 0.193 0.669]
 [0.059 0.097 0.176 0.668]
 [0.11  0.097 0.117 0.675]
 [0.039 0.202 0.054 0.705]]
Validation acc: 0.14425087108013937
Validation class_accuracies: [0.07585139318885449, 0.09683794466403162, 0.11688311688311688, 0.7054263565891473]
Validation sensitivity: 0.2002534854245881
Validation specificity: 0.07585139318885449
Validation icbhi_score: 0.1380524393067213
Validation roc_auc: None
Validation avg_accuracy: 0.24874970283128756
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
290/290 - 126s - loss: 0.6748 - accuracy: 0.6026 - 126s/epoch - 433ms/step
Epoch 2/80
Validation cm: [[ 43  10 380 213]
 [ 44  28 201 233]
 [  3  12  92  47]
 [ 17  33  43  36]]
Validation normalized_cm: [[0.067 0.015 0.588 0.33 ]
 [0.087 0.055 0.397 0.46 ]
 [0.019 0.078 0.597 0.305]
 [0.132 0.256 0.333 0.279]]
Validation acc: 0.13867595818815331
Validation class_accuracies: [0.06656346749226007, 0.05533596837944664, 0.5974025974025974, 0.27906976744186046]
Validation sensitivity: 0.19771863117870722
Validation specificity: 0.06656346749226007
Validation icbhi_score: 0.13214104933548365
Validation roc_auc: None
Validation avg_accuracy: 0.24959295017904115
Validation one_indexed_epoch: 2
The validation tracker metric at 0.1380524393067213 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 119s - loss: 0.5766 - accuracy: 0.6814 - 119s/epoch - 410ms/step
Epoch 3/80
Validation cm: [[378 246  19   3]
 [118 354  13  21]
 [ 40  41  48  25]
 [ 56  41  27   5]]
Validation normalized_cm: [[0.585 0.381 0.029 0.005]
 [0.233 0.7   0.026 0.042]
 [0.26  0.266 0.312 0.162]
 [0.434 0.318 0.209 0.039]]
Validation acc: 0.5470383275261324
Validation class_accuracies: [0.5851393188854489, 0.6996047430830039, 0.3116883116883117, 0.03875968992248062]
Validation sensitivity: 0.5158428390367554
Validation specificity: 0.5851393188854489
Validation icbhi_score: 0.5504910789611022
Validation roc_auc: None
Validation avg_accuracy: 0.40879801589481135
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
290/290 - 120s - loss: 0.5233 - accuracy: 0.7214 - 120s/epoch - 412ms/step
Epoch 4/80
Validation cm: [[498 144   4   0]
 [303 203   0   0]
 [ 83  32  22  17]
 [ 87  17  23   2]]
Validation normalized_cm: [[0.771 0.223 0.006 0.   ]
 [0.599 0.401 0.    0.   ]
 [0.539 0.208 0.143 0.11 ]
 [0.674 0.132 0.178 0.016]]
Validation acc: 0.5052264808362369
Validation class_accuracies: [0.7708978328173375, 0.40118577075098816, 0.14285714285714285, 0.015503875968992248]
Validation sensitivity: 0.2877059569074778
Validation specificity: 0.7708978328173375
Validation icbhi_score: 0.5293018948624076
Validation roc_auc: None
Validation avg_accuracy: 0.3326111555986152
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5504910789611022 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 119s - loss: 0.4511 - accuracy: 0.7512 - 119s/epoch - 410ms/step
Epoch 5/80
Validation cm: [[440  85 115   6]
 [292 142  56  16]
 [ 45  10  95   4]
 [ 58  12  50   9]]
Validation normalized_cm: [[0.681 0.132 0.178 0.009]
 [0.577 0.281 0.111 0.032]
 [0.292 0.065 0.617 0.026]
 [0.45  0.093 0.388 0.07 ]]
Validation acc: 0.47804878048780486
Validation class_accuracies: [0.6811145510835913, 0.28063241106719367, 0.6168831168831169, 0.06976744186046512]
Validation sensitivity: 0.311787072243346
Validation specificity: 0.6811145510835913
Validation icbhi_score: 0.49645081166346866
Validation roc_auc: None
Validation avg_accuracy: 0.41209938022359177
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5504910789611022 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 113s - loss: 0.3992 - accuracy: 0.7708 - 113s/epoch - 390ms/step
Epoch 6/80
Validation cm: [[530 104   8   4]
 [297 209   0   0]
 [ 76  23  34  21]
 [106   4  18   1]]
Validation normalized_cm: [[0.82  0.161 0.012 0.006]
 [0.587 0.413 0.    0.   ]
 [0.494 0.149 0.221 0.136]
 [0.822 0.031 0.14  0.008]]
Validation acc: 0.5393728222996516
Validation class_accuracies: [0.8204334365325078, 0.41304347826086957, 0.22077922077922077, 0.007751937984496124]
Validation sensitivity: 0.30925221799746516
Validation specificity: 0.8204334365325078
Validation icbhi_score: 0.5648428272649865
Validation roc_auc: None
Validation avg_accuracy: 0.36550201838927354
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
290/290 - 119s - loss: 0.3529 - accuracy: 0.8006 - 119s/epoch - 409ms/step
Epoch 7/80
Validation cm: [[572  62  12   0]
 [381 109  14   2]
 [ 65  13  70   6]
 [ 60  12  56   1]]
Validation normalized_cm: [[0.885 0.096 0.019 0.   ]
 [0.753 0.215 0.028 0.004]
 [0.422 0.084 0.455 0.039]
 [0.465 0.093 0.434 0.008]]
Validation acc: 0.5240418118466899
Validation class_accuracies: [0.8854489164086687, 0.21541501976284586, 0.45454545454545453, 0.007751937984496124]
Validation sensitivity: 0.22813688212927757
Validation specificity: 0.8854489164086687
Validation icbhi_score: 0.5567928992689731
Validation roc_auc: None
Validation avg_accuracy: 0.39079033217536635
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 120s - loss: 0.3033 - accuracy: 0.8168 - 120s/epoch - 413ms/step
Epoch 8/80
Validation cm: [[273  10 300  63]
 [111  17 245 133]
 [ 36   1  73  44]
 [ 55   1  63  10]]
Validation normalized_cm: [[0.423 0.015 0.464 0.098]
 [0.219 0.034 0.484 0.263]
 [0.234 0.006 0.474 0.286]
 [0.426 0.008 0.488 0.078]]
Validation acc: 0.25993031358885016
Validation class_accuracies: [0.42260061919504643, 0.03359683794466403, 0.474025974025974, 0.07751937984496124]
Validation sensitivity: 0.1267427122940431
Validation specificity: 0.42260061919504643
Validation icbhi_score: 0.27467166574454477
Validation roc_auc: None
Validation avg_accuracy: 0.2519357027526614
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 119s - loss: 0.2655 - accuracy: 0.8136 - 119s/epoch - 411ms/step
Epoch 9/80
Validation cm: [[429 163  36  18]
 [248 213  22  23]
 [ 44  12  48  50]
 [ 37  39  16  37]]
Validation normalized_cm: [[0.664 0.252 0.056 0.028]
 [0.49  0.421 0.043 0.045]
 [0.286 0.078 0.312 0.325]
 [0.287 0.302 0.124 0.287]]
Validation acc: 0.5066202090592334
Validation class_accuracies: [0.6640866873065016, 0.4209486166007905, 0.3116883116883117, 0.2868217054263566]
Validation sensitivity: 0.3776932826362484
Validation specificity: 0.6640866873065016
Validation icbhi_score: 0.520889984971375
Validation roc_auc: None
Validation avg_accuracy: 0.42088633025549016
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 3 epochs
There is no such attribute
290/290 - 117s - loss: 0.2301 - accuracy: 0.8341 - 117s/epoch - 405ms/step
Epoch 10/80
Validation cm: [[530 105   8   3]
 [343 160   1   2]
 [ 73  38  20  23]
 [ 64  27  24  14]]
Validation normalized_cm: [[0.82  0.163 0.012 0.005]
 [0.678 0.316 0.002 0.004]
 [0.474 0.247 0.13  0.149]
 [0.496 0.209 0.186 0.109]]
Validation acc: 0.5045296167247387
Validation class_accuracies: [0.8204334365325078, 0.31620553359683795, 0.12987012987012986, 0.10852713178294573]
Validation sensitivity: 0.2458808618504436
Validation specificity: 0.8204334365325078
Validation icbhi_score: 0.5331571491914757
Validation roc_auc: None
Validation avg_accuracy: 0.34375905794560535
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 4 epochs
There is no such attribute
290/290 - 119s - loss: 0.2018 - accuracy: 0.8425 - 119s/epoch - 409ms/step
Epoch 11/80
Validation cm: [[553  45  40   8]
 [303 105  66  32]
 [ 54   6  65  29]
 [ 65  17  37  10]]
Validation normalized_cm: [[0.856 0.07  0.062 0.012]
 [0.599 0.208 0.13  0.063]
 [0.351 0.039 0.422 0.188]
 [0.504 0.132 0.287 0.078]]
Validation acc: 0.510801393728223
Validation class_accuracies: [0.8560371517027864, 0.2075098814229249, 0.42207792207792205, 0.07751937984496124]
Validation sensitivity: 0.22813688212927757
Validation specificity: 0.8560371517027864
Validation icbhi_score: 0.542087016916032
Validation roc_auc: None
Validation avg_accuracy: 0.39078608376214863
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 5 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
290/290 - 120s - loss: 0.1888 - accuracy: 0.8335 - 120s/epoch - 413ms/step
Epoch 12/80
Validation cm: [[147  60 351  88]
 [108  91 178 129]
 [ 16   2  99  37]
 [ 38   8  56  27]]
Validation normalized_cm: [[0.228 0.093 0.543 0.136]
 [0.213 0.18  0.352 0.255]
 [0.104 0.013 0.643 0.24 ]
 [0.295 0.062 0.434 0.209]]
Validation acc: 0.25365853658536586
Validation class_accuracies: [0.22755417956656346, 0.17984189723320157, 0.6428571428571429, 0.20930232558139536]
Validation sensitivity: 0.2750316856780735
Validation specificity: 0.22755417956656346
Validation icbhi_score: 0.2512929326223185
Validation roc_auc: None
Validation avg_accuracy: 0.3148888863095758
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 6 epochs
There is no such attribute
290/290 - 120s - loss: 0.1518 - accuracy: 0.8475 - 120s/epoch - 413ms/step
Epoch 13/80
Validation cm: [[494  29 121   2]
 [247  68 189   2]
 [ 53   2  91   8]
 [ 76  13  36   4]]
Validation normalized_cm: [[0.765 0.045 0.187 0.003]
 [0.488 0.134 0.374 0.004]
 [0.344 0.013 0.591 0.052]
 [0.589 0.101 0.279 0.031]]
Validation acc: 0.4578397212543554
Validation class_accuracies: [0.7647058823529411, 0.13438735177865613, 0.5909090909090909, 0.031007751937984496]
Validation sensitivity: 0.20659062103929024
Validation specificity: 0.7647058823529411
Validation icbhi_score: 0.4856482516961157
Validation roc_auc: None
Validation avg_accuracy: 0.3802525192446682
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 7 epochs
There is no such attribute
290/290 - 117s - loss: 0.1380 - accuracy: 0.8287 - 117s/epoch - 403ms/step
Epoch 14/80
Validation cm: [[262 128 215  41]
 [124 141 197  44]
 [ 22  13 110   9]
 [ 55  15  51   8]]
Validation normalized_cm: [[0.406 0.198 0.333 0.063]
 [0.245 0.279 0.389 0.087]
 [0.143 0.084 0.714 0.058]
 [0.426 0.116 0.395 0.062]]
Validation acc: 0.3630662020905923
Validation class_accuracies: [0.4055727554179567, 0.27865612648221344, 0.7142857142857143, 0.06201550387596899]
Validation sensitivity: 0.3282636248415716
Validation specificity: 0.4055727554179567
Validation icbhi_score: 0.3669181901297641
Validation roc_auc: None
Validation avg_accuracy: 0.36513252501546334
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
290/290 - 117s - loss: 0.1439 - accuracy: 0.8311 - 117s/epoch - 402ms/step
Epoch 15/80
Validation cm: [[420 177  27  22]
 [193 266  12  35]
 [ 47  17  53  37]
 [ 61  20  36  12]]
Validation normalized_cm: [[0.65  0.274 0.042 0.034]
 [0.381 0.526 0.024 0.069]
 [0.305 0.11  0.344 0.24 ]
 [0.473 0.155 0.279 0.093]]
Validation acc: 0.5233449477351917
Validation class_accuracies: [0.6501547987616099, 0.525691699604743, 0.34415584415584416, 0.09302325581395349]
Validation sensitivity: 0.41951837769328265
Validation specificity: 0.6501547987616099
Validation icbhi_score: 0.5348365882274463
Validation roc_auc: None
Validation avg_accuracy: 0.40325639958403764
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 9 epochs
There is no such attribute
290/290 - 121s - loss: 0.0812 - accuracy: 0.8525 - 121s/epoch - 417ms/step
Epoch 16/80
Validation cm: [[406 184  32  24]
 [201 247  26  32]
 [ 42  18  54  40]
 [ 58  17  45   9]]
Validation normalized_cm: [[0.628 0.285 0.05  0.037]
 [0.397 0.488 0.051 0.063]
 [0.273 0.117 0.351 0.26 ]
 [0.45  0.132 0.349 0.07 ]]
Validation acc: 0.4989547038327526
Validation class_accuracies: [0.628482972136223, 0.4881422924901186, 0.35064935064935066, 0.06976744186046512]
Validation sensitivity: 0.3929024081115336
Validation specificity: 0.628482972136223
Validation icbhi_score: 0.5106926901238783
Validation roc_auc: None
Validation avg_accuracy: 0.3842605142840393
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 10 epochs
There is no such attribute
290/290 - 130s - loss: 0.0508 - accuracy: 0.8419 - 130s/epoch - 449ms/step
Epoch 17/80
Validation cm: [[496 129  13   8]
 [277 207   7  15]
 [ 63  12  45  34]
 [ 59  20  42   8]]
Validation normalized_cm: [[0.768 0.2   0.02  0.012]
 [0.547 0.409 0.014 0.03 ]
 [0.409 0.078 0.292 0.221]
 [0.457 0.155 0.326 0.062]]
Validation acc: 0.526829268292683
Validation class_accuracies: [0.7678018575851393, 0.4090909090909091, 0.2922077922077922, 0.06201550387596899]
Validation sensitivity: 0.32953105196451205
Validation specificity: 0.7678018575851393
Validation icbhi_score: 0.5486664547748257
Validation roc_auc: None
Validation avg_accuracy: 0.38277901568995243
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 11 epochs
There is no such attribute
290/290 - 127s - loss: 0.0403 - accuracy: 0.8400 - 127s/epoch - 438ms/step
Epoch 18/80
Validation cm: [[534  84  20   8]
 [331 148  10  17]
 [ 74  11  46  23]
 [ 75   9  38   7]]
Validation normalized_cm: [[0.827 0.13  0.031 0.012]
 [0.654 0.292 0.02  0.034]
 [0.481 0.071 0.299 0.149]
 [0.581 0.07  0.295 0.054]]
Validation acc: 0.5121951219512195
Validation class_accuracies: [0.826625386996904, 0.2924901185770751, 0.2987012987012987, 0.05426356589147287]
Validation sensitivity: 0.25475285171102663
Validation specificity: 0.826625386996904
Validation icbhi_score: 0.5406891193539654
Validation roc_auc: None
Validation avg_accuracy: 0.36802009254168766
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 12 epochs
There is no such attribute
290/290 - 125s - loss: 0.0326 - accuracy: 0.8305 - 125s/epoch - 431ms/step
Epoch 19/80
Validation cm: [[545  84  13   4]
 [331 166   3   6]
 [ 62  16  49  27]
 [ 67  20  36   6]]
Validation normalized_cm: [[0.844 0.13  0.02  0.006]
 [0.654 0.328 0.006 0.012]
 [0.403 0.104 0.318 0.175]
 [0.519 0.155 0.279 0.047]]
Validation acc: 0.5337979094076655
Validation class_accuracies: [0.8436532507739938, 0.32806324110671936, 0.3181818181818182, 0.046511627906976744]
Validation sensitivity: 0.28010139416983526
Validation specificity: 0.8436532507739938
Validation icbhi_score: 0.5618773224719145
Validation roc_auc: None
Validation avg_accuracy: 0.384102484492377
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 13 epochs
There is no such attribute
290/290 - 130s - loss: 0.0374 - accuracy: 0.8274 - 130s/epoch - 448ms/step
Epoch 20/80
Validation cm: [[481 142  16   7]
 [257 229   9  11]
 [ 54  21  52  27]
 [ 65  20  38   6]]
Validation normalized_cm: [[0.745 0.22  0.025 0.011]
 [0.508 0.453 0.018 0.022]
 [0.351 0.136 0.338 0.175]
 [0.504 0.155 0.295 0.047]]
Validation acc: 0.535191637630662
Validation class_accuracies: [0.7445820433436533, 0.4525691699604743, 0.33766233766233766, 0.046511627906976744]
Validation sensitivity: 0.3637515842839037
Validation specificity: 0.7445820433436533
Validation icbhi_score: 0.5541668138137785
Validation roc_auc: None
Validation avg_accuracy: 0.3953312947183605
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 14 epochs
There is no such attribute
290/290 - 151s - loss: 0.0304 - accuracy: 0.8337 - 151s/epoch - 522ms/step
Epoch 21/80
Validation cm: [[396 185  38  27]
 [197 242  25  42]
 [ 47  16  46  45]
 [ 47  21  47  14]]
Validation normalized_cm: [[0.613 0.286 0.059 0.042]
 [0.389 0.478 0.049 0.083]
 [0.305 0.104 0.299 0.292]
 [0.364 0.163 0.364 0.109]]
Validation acc: 0.486411149825784
Validation class_accuracies: [0.6130030959752322, 0.4782608695652174, 0.2987012987012987, 0.10852713178294573]
Validation sensitivity: 0.38276299112801015
Validation specificity: 0.6130030959752322
Validation icbhi_score: 0.49788304355162116
Validation roc_auc: None
Validation avg_accuracy: 0.37462309900617347
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5648428272649865 hasn't increased by 0 in 15 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
290/290 - 129s - loss: 0.0248 - accuracy: 0.8261 - 129s/epoch - 444ms/step
Epoch 22/80
Validation cm: [[590  55   0   1]
 [359 142   1   4]
 [ 99   9  26  20]
 [ 87   7  27   8]]
Validation normalized_cm: [[0.913 0.085 0.    0.002]
 [0.709 0.281 0.002 0.008]
 [0.643 0.058 0.169 0.13 ]
 [0.674 0.054 0.209 0.062]]
Validation acc: 0.5337979094076655
Validation class_accuracies: [0.913312693498452, 0.28063241106719367, 0.16883116883116883, 0.06201550387596899]
Validation sensitivity: 0.22306717363751585
Validation specificity: 0.913312693498452
Validation icbhi_score: 0.568189933567984
Validation roc_auc: None
Validation avg_accuracy: 0.35619794431819585
Validation one_indexed_epoch: 22
-- New best results were achieved. --
There is no such attribute
290/290 - 128s - loss: 0.0393 - accuracy: 0.8320 - 128s/epoch - 440ms/step
Epoch 23/80
Validation cm: [[509 123  12   2]
 [270 225   5   6]
 [ 63  22  51  18]
 [ 61  23  35  10]]
Validation normalized_cm: [[0.788 0.19  0.019 0.003]
 [0.534 0.445 0.01  0.012]
 [0.409 0.143 0.331 0.117]
 [0.473 0.178 0.271 0.078]]
Validation acc: 0.554006968641115
Validation class_accuracies: [0.7879256965944272, 0.44466403162055335, 0.33116883116883117, 0.07751937984496124]
Validation sensitivity: 0.36248415716096327
Validation specificity: 0.7879256965944272
Validation icbhi_score: 0.5752049268776953
Validation roc_auc: None
Validation avg_accuracy: 0.41031948480719327
Validation one_indexed_epoch: 23
-- New best results were achieved. --
There is no such attribute
290/290 - 126s - loss: 0.0415 - accuracy: 0.8199 - 126s/epoch - 435ms/step
Epoch 24/80
Validation cm: [[495  56  92   3]
 [323 129  43  11]
 [ 53   8  78  15]
 [ 70  12  41   6]]
Validation normalized_cm: [[0.766 0.087 0.142 0.005]
 [0.638 0.255 0.085 0.022]
 [0.344 0.052 0.506 0.097]
 [0.543 0.093 0.318 0.047]]
Validation acc: 0.49337979094076656
Validation class_accuracies: [0.7662538699690402, 0.2549407114624506, 0.5064935064935064, 0.046511627906976744]
Validation sensitivity: 0.26996197718631176
Validation specificity: 0.7662538699690402
Validation icbhi_score: 0.518107923577676
Validation roc_auc: None
Validation avg_accuracy: 0.39354992895799357
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 1 epochs
There is no such attribute
290/290 - 130s - loss: 0.0274 - accuracy: 0.8253 - 130s/epoch - 448ms/step
Epoch 25/80
Validation cm: [[499 131  12   4]
 [265 226   7   8]
 [ 71  24  40  19]
 [ 59  24  37   9]]
Validation normalized_cm: [[0.772 0.203 0.019 0.006]
 [0.524 0.447 0.014 0.016]
 [0.461 0.156 0.26  0.123]
 [0.457 0.186 0.287 0.07 ]]
Validation acc: 0.5393728222996516
Validation class_accuracies: [0.7724458204334366, 0.44664031620553357, 0.2597402597402597, 0.06976744186046512]
Validation sensitivity: 0.3485424588086185
Validation specificity: 0.7724458204334366
Validation icbhi_score: 0.5604941396210276
Validation roc_auc: None
Validation avg_accuracy: 0.3871484595599238
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 2 epochs
There is no such attribute
290/290 - 129s - loss: 0.0234 - accuracy: 0.8246 - 129s/epoch - 446ms/step
Epoch 26/80
Validation cm: [[600  37   9   0]
 [426  68  10   2]
 [ 78  13  53  10]
 [ 78  16  30   5]]
Validation normalized_cm: [[0.929 0.057 0.014 0.   ]
 [0.842 0.134 0.02  0.004]
 [0.506 0.084 0.344 0.065]
 [0.605 0.124 0.233 0.039]]
Validation acc: 0.5059233449477352
Validation class_accuracies: [0.9287925696594427, 0.13438735177865613, 0.34415584415584416, 0.03875968992248062]
Validation sensitivity: 0.1596958174904943
Validation specificity: 0.9287925696594427
Validation icbhi_score: 0.5442441935749684
Validation roc_auc: None
Validation avg_accuracy: 0.3615238638791059
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 3 epochs
There is no such attribute
290/290 - 135s - loss: 0.0238 - accuracy: 0.8123 - 135s/epoch - 466ms/step
Epoch 27/80
Validation cm: [[483  64  67  32]
 [286 130  43  47]
 [ 54   6  55  39]
 [ 62   8  46  13]]
Validation normalized_cm: [[0.748 0.099 0.104 0.05 ]
 [0.565 0.257 0.085 0.093]
 [0.351 0.039 0.357 0.253]
 [0.481 0.062 0.357 0.101]]
Validation acc: 0.4745644599303136
Validation class_accuracies: [0.7476780185758514, 0.25691699604743085, 0.35714285714285715, 0.10077519379844961]
Validation sensitivity: 0.2509505703422053
Validation specificity: 0.7476780185758514
Validation icbhi_score: 0.4993142944590283
Validation roc_auc: None
Validation avg_accuracy: 0.36562826639114726
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 4 epochs
There is no such attribute
290/290 - 127s - loss: 0.0170 - accuracy: 0.8127 - 127s/epoch - 437ms/step
Epoch 28/80
Validation cm: [[442 181  14   9]
 [229 254  10  13]
 [ 56  22  35  41]
 [ 69  23  25  12]]
Validation normalized_cm: [[0.684 0.28  0.022 0.014]
 [0.453 0.502 0.02  0.026]
 [0.364 0.143 0.227 0.266]
 [0.535 0.178 0.194 0.093]]
Validation acc: 0.5177700348432056
Validation class_accuracies: [0.6842105263157895, 0.5019762845849802, 0.22727272727272727, 0.09302325581395349]
Validation sensitivity: 0.38149556400506973
Validation specificity: 0.6842105263157895
Validation icbhi_score: 0.5328530451604296
Validation roc_auc: None
Validation avg_accuracy: 0.37662069849686264
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 5 epochs
There is no such attribute
290/290 - 133s - loss: 0.0139 - accuracy: 0.8125 - 133s/epoch - 457ms/step
Epoch 29/80
Validation cm: [[311 310   8  17]
 [150 329   8  19]
 [ 47  31  38  38]
 [ 59  22  38  10]]
Validation normalized_cm: [[0.481 0.48  0.012 0.026]
 [0.296 0.65  0.016 0.038]
 [0.305 0.201 0.247 0.247]
 [0.457 0.171 0.295 0.078]]
Validation acc: 0.4794425087108014
Validation class_accuracies: [0.48142414860681115, 0.650197628458498, 0.24675324675324675, 0.07751937984496124]
Validation sensitivity: 0.47782002534854245
Validation specificity: 0.48142414860681115
Validation icbhi_score: 0.47962208697767683
Validation roc_auc: None
Validation avg_accuracy: 0.36397360091587927
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 6 epochs
There is no such attribute
290/290 - 137s - loss: 0.0122 - accuracy: 0.8071 - 137s/epoch - 473ms/step
Epoch 30/80
Validation cm: [[522  91  28   5]
 [337 154   9   6]
 [ 70  11  50  23]
 [ 68  15  40   6]]
Validation normalized_cm: [[0.808 0.141 0.043 0.008]
 [0.666 0.304 0.018 0.012]
 [0.455 0.071 0.325 0.149]
 [0.527 0.116 0.31  0.047]]
Validation acc: 0.5101045296167247
Validation class_accuracies: [0.8080495356037152, 0.30434782608695654, 0.3246753246753247, 0.046511627906976744]
Validation sensitivity: 0.2661596958174905
Validation specificity: 0.8080495356037152
Validation icbhi_score: 0.5371046157106029
Validation roc_auc: None
Validation avg_accuracy: 0.3708960785682433
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 7 epochs
There is no such attribute
290/290 - 136s - loss: 0.0213 - accuracy: 0.8063 - 136s/epoch - 468ms/step
Epoch 31/80
Validation cm: [[199 345  75  27]
 [ 83 386  25  12]
 [ 37  41  43  33]
 [ 51  33  31  14]]
Validation normalized_cm: [[0.308 0.534 0.116 0.042]
 [0.164 0.763 0.049 0.024]
 [0.24  0.266 0.279 0.214]
 [0.395 0.256 0.24  0.109]]
Validation acc: 0.4473867595818815
Validation class_accuracies: [0.3080495356037152, 0.7628458498023716, 0.2792207792207792, 0.10852713178294573]
Validation sensitivity: 0.5614702154626109
Validation specificity: 0.3080495356037152
Validation icbhi_score: 0.43475987553316303
Validation roc_auc: None
Validation avg_accuracy: 0.36466082410245293
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0002500000118743628
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
290/290 - 138s - loss: 0.0309 - accuracy: 0.8134 - 138s/epoch - 477ms/step
Epoch 32/80
Validation cm: [[423 209   8   6]
 [185 304   4  13]
 [ 56  23  37  38]
 [ 62  28  25  14]]
Validation normalized_cm: [[0.655 0.324 0.012 0.009]
 [0.366 0.601 0.008 0.026]
 [0.364 0.149 0.24  0.247]
 [0.481 0.217 0.194 0.109]]
Validation acc: 0.5421602787456447
Validation class_accuracies: [0.6547987616099071, 0.6007905138339921, 0.24025974025974026, 0.10852713178294573]
Validation sensitivity: 0.449936628643853
Validation specificity: 0.6547987616099071
Validation icbhi_score: 0.5523676951268801
Validation roc_auc: None
Validation avg_accuracy: 0.4010940368716463
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 9 epochs
There is no such attribute
290/290 - 134s - loss: 0.0268 - accuracy: 0.8024 - 134s/epoch - 461ms/step
Epoch 33/80
Validation cm: [[497 121  20   8]
 [279 204  11  12]
 [ 61  11  49  33]
 [ 59  21  39  10]]
Validation normalized_cm: [[0.769 0.187 0.031 0.012]
 [0.551 0.403 0.022 0.024]
 [0.396 0.071 0.318 0.214]
 [0.457 0.163 0.302 0.078]]
Validation acc: 0.5296167247386759
Validation class_accuracies: [0.7693498452012384, 0.4031620553359684, 0.3181818181818182, 0.07751937984496124]
Validation sensitivity: 0.3333333333333333
Validation specificity: 0.7693498452012384
Validation icbhi_score: 0.5513415892672858
Validation roc_auc: None
Validation avg_accuracy: 0.3920532746409965
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 10 epochs
There is no such attribute
290/290 - 132s - loss: 0.0256 - accuracy: 0.8063 - 132s/epoch - 454ms/step
Epoch 34/80
Validation cm: [[443 155  32  16]
 [207 255  21  23]
 [ 48  17  49  40]
 [ 61  19  39  10]]
Validation normalized_cm: [[0.686 0.24  0.05  0.025]
 [0.409 0.504 0.042 0.045]
 [0.312 0.11  0.318 0.26 ]
 [0.473 0.147 0.302 0.078]]
Validation acc: 0.5275261324041812
Validation class_accuracies: [0.6857585139318886, 0.5039525691699605, 0.3181818181818182, 0.07751937984496124]
Validation sensitivity: 0.3979721166032953
Validation specificity: 0.6857585139318886
Validation icbhi_score: 0.541865315267592
Validation roc_auc: None
Validation avg_accuracy: 0.39635307028215705
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 11 epochs
There is no such attribute
290/290 - 133s - loss: 0.0135 - accuracy: 0.7983 - 133s/epoch - 459ms/step
Epoch 35/80
Validation cm: [[434 181  17  14]
 [197 282   6  21]
 [ 63  11  43  37]
 [ 62  22  39   6]]
Validation normalized_cm: [[0.672 0.28  0.026 0.022]
 [0.389 0.557 0.012 0.042]
 [0.409 0.071 0.279 0.24 ]
 [0.481 0.171 0.302 0.047]]
Validation acc: 0.5331010452961672
Validation class_accuracies: [0.6718266253869969, 0.5573122529644269, 0.2792207792207792, 0.046511627906976744]
Validation sensitivity: 0.41951837769328265
Validation specificity: 0.6718266253869969
Validation icbhi_score: 0.5456725015401398
Validation roc_auc: None
Validation avg_accuracy: 0.388717821369795
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 12 epochs
There is no such attribute
290/290 - 135s - loss: 0.0130 - accuracy: 0.8127 - 135s/epoch - 467ms/step
Epoch 36/80
Validation cm: [[427 186  19  14]
 [201 276   8  21]
 [ 55  15  38  46]
 [ 62  19  36  12]]
Validation normalized_cm: [[0.661 0.288 0.029 0.022]
 [0.397 0.545 0.016 0.042]
 [0.357 0.097 0.247 0.299]
 [0.481 0.147 0.279 0.093]]
Validation acc: 0.5247386759581881
Validation class_accuracies: [0.6609907120743034, 0.5454545454545454, 0.24675324675324675, 0.09302325581395349]
Validation sensitivity: 0.4131812420785805
Validation specificity: 0.6609907120743034
Validation icbhi_score: 0.5370859770764419
Validation roc_auc: None
Validation avg_accuracy: 0.38655544002401226
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 13 epochs
There is no such attribute
290/290 - 136s - loss: 0.0091 - accuracy: 0.8147 - 136s/epoch - 468ms/step
Epoch 37/80
Validation cm: [[521 112  11   2]
 [301 187   9   9]
 [ 68  13  47  26]
 [ 66  18  38   7]]
Validation normalized_cm: [[0.807 0.173 0.017 0.003]
 [0.595 0.37  0.018 0.018]
 [0.442 0.084 0.305 0.169]
 [0.512 0.14  0.295 0.054]]
Validation acc: 0.5310104529616725
Validation class_accuracies: [0.8065015479876161, 0.3695652173913043, 0.3051948051948052, 0.05426356589147287]
Validation sensitivity: 0.30544993662864384
Validation specificity: 0.8065015479876161
Validation icbhi_score: 0.55597574230813
Validation roc_auc: None
Validation avg_accuracy: 0.3838812841162996
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 14 epochs
There is no such attribute
290/290 - 135s - loss: 0.0129 - accuracy: 0.7985 - 135s/epoch - 466ms/step
Epoch 38/80
Validation cm: [[485 128  20  13]
 [246 228  11  21]
 [ 58   9  50  37]
 [ 60  20  42   7]]
Validation normalized_cm: [[0.751 0.198 0.031 0.02 ]
 [0.486 0.451 0.022 0.042]
 [0.377 0.058 0.325 0.24 ]
 [0.465 0.155 0.326 0.054]]
Validation acc: 0.5365853658536586
Validation class_accuracies: [0.7507739938080495, 0.4505928853754941, 0.3246753246753247, 0.05426356589147287]
Validation sensitivity: 0.3612167300380228
Validation specificity: 0.7507739938080495
Validation icbhi_score: 0.5559953619230362
Validation roc_auc: None
Validation avg_accuracy: 0.39507644243758533
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 15 epochs
There is no such attribute
290/290 - 133s - loss: 0.0094 - accuracy: 0.8091 - 133s/epoch - 460ms/step
Epoch 39/80
Validation cm: [[418 198  20  10]
 [186 290   7  23]
 [ 51  21  43  39]
 [ 61  21  37  10]]
Validation normalized_cm: [[0.647 0.307 0.031 0.015]
 [0.368 0.573 0.014 0.045]
 [0.331 0.136 0.279 0.253]
 [0.473 0.163 0.287 0.078]]
Validation acc: 0.5303135888501742
Validation class_accuracies: [0.6470588235294118, 0.5731225296442688, 0.2792207792207792, 0.07751937984496124]
Validation sensitivity: 0.4347275031685678
Validation specificity: 0.6470588235294118
Validation icbhi_score: 0.5408931633489897
Validation roc_auc: None
Validation avg_accuracy: 0.3942303780598553
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
290/290 - 138s - loss: 0.0091 - accuracy: 0.8156 - 138s/epoch - 477ms/step
Epoch 40/80
Validation cm: [[469 149  18  10]
 [238 243   5  20]
 [ 59  14  45  36]
 [ 66  19  35   9]]
Validation normalized_cm: [[0.726 0.231 0.028 0.015]
 [0.47  0.48  0.01  0.04 ]
 [0.383 0.091 0.292 0.234]
 [0.512 0.147 0.271 0.07 ]]
Validation acc: 0.5337979094076655
Validation class_accuracies: [0.7260061919504643, 0.48023715415019763, 0.2922077922077922, 0.06976744186046512]
Validation sensitivity: 0.376425855513308
Validation specificity: 0.7260061919504643
Validation icbhi_score: 0.5512160237318862
Validation roc_auc: None
Validation avg_accuracy: 0.3920546450422298
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 17 epochs
There is no such attribute
290/290 - 135s - loss: 0.0087 - accuracy: 0.8089 - 135s/epoch - 466ms/step
Epoch 41/80
Validation cm: [[462 155  17  12]
 [225 253   6  22]
 [ 56  13  46  39]
 [ 61  19  37  12]]
Validation normalized_cm: [[0.715 0.24  0.026 0.019]
 [0.445 0.5   0.012 0.043]
 [0.364 0.084 0.299 0.253]
 [0.473 0.147 0.287 0.093]]
Validation acc: 0.5386759581881533
Validation class_accuracies: [0.7151702786377709, 0.5, 0.2987012987012987, 0.09302325581395349]
Validation sensitivity: 0.394169835234474
Validation specificity: 0.7151702786377709
Validation icbhi_score: 0.5546700569361225
Validation roc_auc: None
Validation avg_accuracy: 0.40172370828825577
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 18 epochs
There is no such attribute
290/290 - 137s - loss: 0.0080 - accuracy: 0.8114 - 137s/epoch - 473ms/step
Epoch 42/80
Validation cm: [[448 172  17   9]
 [211 272   7  16]
 [ 57  16  47  34]
 [ 62  18  40   9]]
Validation normalized_cm: [[0.693 0.266 0.026 0.014]
 [0.417 0.538 0.014 0.032]
 [0.37  0.104 0.305 0.221]
 [0.481 0.14  0.31  0.07 ]]
Validation acc: 0.5407665505226481
Validation class_accuracies: [0.6934984520123839, 0.5375494071146245, 0.3051948051948052, 0.06976744186046512]
Validation sensitivity: 0.4157160963244613
Validation specificity: 0.6934984520123839
Validation icbhi_score: 0.5546072741684226
Validation roc_auc: None
Validation avg_accuracy: 0.40150252654556967
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5752049268776953 hasn't increased by 0 in 19 epochs
There is no such attribute
290/290 - 133s - loss: 0.0054 - accuracy: 0.7996 - 133s/epoch - 460ms/step
Epoch 43/80
Validation cm: [[477 142  15  12]
 [235 244   7  20]
 [ 57  14  45  38]
 [ 62  19  38  10]]
Validation normalized_cm: [[0.738 0.22  0.023 0.019]
 [0.464 0.482 0.014 0.04 ]
 [0.37  0.091 0.292 0.247]
 [0.481 0.147 0.295 0.078]]
Validation acc: 0.5407665505226481
Validation class_accuracies: [0.7383900928792569, 0.48221343873517786, 0.2922077922077922, 0.07751937984496124]
Validation sensitivity: 0.37896070975918883
Validation specificity: 0.7383900928792569
Validation icbhi_score: 0.5586754013192229
Validation roc_auc: None
Validation avg_accuracy: 0.397582675916797
Validation one_indexed_epoch: 43
The number of epochs since last 1% equals the patience
There is no such attribute
290/290 - 135s - loss: 0.0081 - accuracy: 0.8002 - 135s/epoch - 464ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5752049268776953
Best cm: [[509 123  12   2]
 [270 225   5   6]
 [ 63  22  51  18]
 [ 61  23  35  10]]
Best normalized_cm: [[0.788 0.19  0.019 0.003]
 [0.534 0.445 0.01  0.012]
 [0.409 0.143 0.331 0.117]
 [0.473 0.178 0.271 0.078]]
Best acc: 0.554006968641115
Best class_accuracies: [0.7879256965944272, 0.44466403162055335, 0.33116883116883117, 0.07751937984496124]
Best sensitivity: 0.36248415716096327
Best specificity: 0.7879256965944272
Best roc_auc: None
Best avg_accuracy: 0.41031948480719327
Best one_indexed_epoch: 23
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6748048067092896, 0.5766479969024658, 0.5232915282249451, 0.4511392414569855, 0.3992157578468323, 0.352887898683548, 0.30328893661499023, 0.2655297815799713, 0.23008927702903748, 0.20176975429058075, 0.18879473209381104, 0.15182261168956757, 0.138047456741333, 0.14391671121120453, 0.08121524006128311, 0.05080530792474747, 0.0402931310236454, 0.03263084217905998, 0.037398092448711395, 0.03038511611521244, 0.024788295850157738, 0.03927892819046974, 0.041492562741041183, 0.027429817244410515, 0.02344285324215889, 0.023780815303325653, 0.017026178538799286, 0.01388890203088522, 0.012213283218443394, 0.021296612918376923, 0.030866675078868866, 0.026844123378396034, 0.02561289630830288, 0.013502845540642738, 0.01300481241196394, 0.009121724404394627, 0.012874819338321686, 0.009362276643514633, 0.009051728062331676, 0.008748797699809074, 0.007973033003509045, 0.005391381680965424, 0.008058372884988785], 'accuracy': [0.6025918126106262, 0.6814255118370056, 0.7213822603225708, 0.7511879205703735, 0.7708423137664795, 0.8006479740142822, 0.8168466687202454, 0.8136069178581238, 0.834125280380249, 0.8425486087799072, 0.8334773182868958, 0.8475161790847778, 0.8287256956100464, 0.8311015367507935, 0.8524838089942932, 0.841900646686554, 0.8399568200111389, 0.8304535746574402, 0.8274298310279846, 0.8336933255195618, 0.8261339068412781, 0.831965446472168, 0.8198704123497009, 0.8252699971199036, 0.8246220350265503, 0.8123109936714172, 0.8127430081367493, 0.8125270009040833, 0.8071274161338806, 0.8062635064125061, 0.8133909106254578, 0.8023757934570312, 0.8062635064125061, 0.7982721328735352, 0.8127430081367493, 0.8146868348121643, 0.7984881401062012, 0.8090713024139404, 0.8155507445335388, 0.8088552951812744, 0.8114470839500427, 0.7995680570602417, 0.8002159595489502]}
Job id is 7.
-----------------------
--- Final training dataset went from 0 to 4450 elements, with 2195 none's, 1234 crakles, 477 wheezes and 544 both ---
--- Final Validation dataset contains 1615 elements, with 683 none, 600 crackles, 240 wheezes and 92 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5068337129840547, 1: 0.9015397082658023, 2: 2.3322851153039834, 3: 2.0450367647058822}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_6 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_6[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_5   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_15 (Dense)            (None, 100)               204900    
                                                                 
 dropout_10 (Dropout)        (None, 100)               0         
                                                                 
 dense_16 (Dense)            (None, 50)                5050      
                                                                 
 dropout_11 (Dropout)        (None, 50)                0         
                                                                 
 dense_17 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_5"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_10 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_11 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_5 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  1 555   0 127]
 [  1 498   0 101]
 [  1 171   9  59]
 [  0  77   0  15]]
Validation normalized_cm: [[0.001 0.813 0.    0.186]
 [0.002 0.83  0.    0.168]
 [0.004 0.713 0.037 0.246]
 [0.    0.837 0.    0.163]]
Validation acc: 0.3238390092879257
Validation class_accuracies: [0.0014641288433382138, 0.83, 0.0375, 0.16304347826086957]
Validation sensitivity: 0.5600858369098712
Validation specificity: 0.0014641288433382138
Validation icbhi_score: 0.28077498287660474
Validation roc_auc: None
Validation avg_accuracy: 0.2580019017760519
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
279/279 - 162s - loss: 0.6960 - accuracy: 0.5364 - 162s/epoch - 579ms/step
Epoch 2/80
Validation cm: [[407 266   6   4]
 [159 432   2   7]
 [ 39  87  51  63]
 [ 19  45   5  23]]
Validation normalized_cm: [[0.596 0.389 0.009 0.006]
 [0.265 0.72  0.003 0.012]
 [0.163 0.362 0.212 0.263]
 [0.207 0.489 0.054 0.25 ]]
Validation acc: 0.5653250773993808
Validation class_accuracies: [0.595900439238653, 0.72, 0.2125, 0.25]
Validation sensitivity: 0.5429184549356223
Validation specificity: 0.595900439238653
Validation icbhi_score: 0.5694094470871376
Validation roc_auc: None
Validation avg_accuracy: 0.44460010980966325
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
279/279 - 148s - loss: 0.5933 - accuracy: 0.6611 - 148s/epoch - 532ms/step
Epoch 3/80
Validation cm: [[151 513   8  11]
 [ 56 532   2  10]
 [ 17 129  16  78]
 [  3  74   2  13]]
Validation normalized_cm: [[0.221 0.751 0.012 0.016]
 [0.093 0.887 0.003 0.017]
 [0.071 0.537 0.067 0.325]
 [0.033 0.804 0.022 0.141]]
Validation acc: 0.4408668730650155
Validation class_accuracies: [0.22108345534407028, 0.8866666666666667, 0.06666666666666667, 0.14130434782608695]
Validation sensitivity: 0.601931330472103
Validation specificity: 0.22108345534407028
Validation icbhi_score: 0.41150739290808663
Validation roc_auc: None
Validation avg_accuracy: 0.32893028412587266
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5694094470871376 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 149s - loss: 0.5290 - accuracy: 0.7121 - 149s/epoch - 536ms/step
Epoch 4/80
Validation cm: [[602  17  63   1]
 [481  16 102   1]
 [ 84   2 146   8]
 [ 54   4  32   2]]
Validation normalized_cm: [[0.881 0.025 0.092 0.001]
 [0.802 0.027 0.17  0.002]
 [0.35  0.008 0.608 0.033]
 [0.587 0.043 0.348 0.022]]
Validation acc: 0.4743034055727554
Validation class_accuracies: [0.8814055636896047, 0.02666666666666667, 0.6083333333333333, 0.021739130434782608]
Validation sensitivity: 0.1759656652360515
Validation specificity: 0.8814055636896047
Validation icbhi_score: 0.528685614462828
Validation roc_auc: None
Validation avg_accuracy: 0.3845361735310968
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5694094470871376 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 143s - loss: 0.4652 - accuracy: 0.7499 - 143s/epoch - 514ms/step
Epoch 5/80
Validation cm: [[ 38  76 225 344]
 [ 25  65 204 306]
 [  3   7  96 134]
 [  0   3  30  59]]
Validation normalized_cm: [[0.056 0.111 0.329 0.504]
 [0.042 0.108 0.34  0.51 ]
 [0.013 0.029 0.4   0.558]
 [0.    0.033 0.326 0.641]]
Validation acc: 0.15975232198142414
Validation class_accuracies: [0.055636896046852125, 0.10833333333333334, 0.4, 0.6413043478260869]
Validation sensitivity: 0.23605150214592274
Validation specificity: 0.055636896046852125
Validation icbhi_score: 0.14584419909638743
Validation roc_auc: None
Validation avg_accuracy: 0.3013186443015681
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5694094470871376 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 145s - loss: 0.4238 - accuracy: 0.7542 - 145s/epoch - 520ms/step
Epoch 6/80
Validation cm: [[ 15 239  29 400]
 [  1 282   1 316]
 [  0  33   8 199]
 [  0  25   0  67]]
Validation normalized_cm: [[0.022 0.35  0.042 0.586]
 [0.002 0.47  0.002 0.527]
 [0.    0.138 0.033 0.829]
 [0.    0.272 0.    0.728]]
Validation acc: 0.23034055727554179
Validation class_accuracies: [0.021961932650073207, 0.47, 0.03333333333333333, 0.7282608695652174]
Validation sensitivity: 0.3830472103004292
Validation specificity: 0.021961932650073207
Validation icbhi_score: 0.2025045714752512
Validation roc_auc: None
Validation avg_accuracy: 0.313389033887156
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5694094470871376 hasn't increased by 0 in 4 epochs
There is no such attribute
279/279 - 152s - loss: 0.3455 - accuracy: 0.7897 - 152s/epoch - 544ms/step
Epoch 7/80
Validation cm: [[474 184  25   0]
 [246 329  25   0]
 [ 74  16 140  10]
 [ 44  15  31   2]]
Validation normalized_cm: [[0.694 0.269 0.037 0.   ]
 [0.41  0.548 0.042 0.   ]
 [0.308 0.067 0.583 0.042]
 [0.478 0.163 0.337 0.022]]
Validation acc: 0.5851393188854489
Validation class_accuracies: [0.6939970717423133, 0.5483333333333333, 0.5833333333333334, 0.021739130434782608]
Validation sensitivity: 0.5053648068669528
Validation specificity: 0.6939970717423133
Validation icbhi_score: 0.5996809393046331
Validation roc_auc: None
Validation avg_accuracy: 0.46185071721094073
Validation one_indexed_epoch: 7
-- New best results were achieved. --
There is no such attribute
279/279 - 145s - loss: 0.3062 - accuracy: 0.8092 - 145s/epoch - 518ms/step
Epoch 8/80
Validation cm: [[427 201   7  48]
 [225 327   2  46]
 [ 65  30   8 137]
 [ 33  29   2  28]]
Validation normalized_cm: [[0.625 0.294 0.01  0.07 ]
 [0.375 0.545 0.003 0.077]
 [0.271 0.125 0.033 0.571]
 [0.359 0.315 0.022 0.304]]
Validation acc: 0.4891640866873065
Validation class_accuracies: [0.6251830161054173, 0.545, 0.03333333333333333, 0.30434782608695654]
Validation sensitivity: 0.3894849785407725
Validation specificity: 0.6251830161054173
Validation icbhi_score: 0.5073339973230949
Validation roc_auc: None
Validation avg_accuracy: 0.3769660438814268
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 1 epochs
There is no such attribute
279/279 - 149s - loss: 0.2548 - accuracy: 0.8146 - 149s/epoch - 533ms/step
Epoch 9/80
Validation cm: [[ 56 219   2 406]
 [  8 117   3 472]
 [  1  25  12 202]
 [  0   6   0  86]]
Validation normalized_cm: [[0.082 0.321 0.003 0.594]
 [0.013 0.195 0.005 0.787]
 [0.004 0.104 0.05  0.842]
 [0.    0.065 0.    0.935]]
Validation acc: 0.16780185758513932
Validation class_accuracies: [0.08199121522693997, 0.195, 0.05, 0.9347826086956522]
Validation sensitivity: 0.23068669527896996
Validation specificity: 0.08199121522693997
Validation icbhi_score: 0.15633895525295496
Validation roc_auc: None
Validation avg_accuracy: 0.31544345598064805
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 2 epochs
There is no such attribute
279/279 - 146s - loss: 0.2186 - accuracy: 0.8319 - 146s/epoch - 524ms/step
Epoch 10/80
Validation cm: [[ 57 324   0 302]
 [ 11 253   0 336]
 [  9  16   6 209]
 [  1  11   0  80]]
Validation normalized_cm: [[0.083 0.474 0.    0.442]
 [0.018 0.422 0.    0.56 ]
 [0.037 0.067 0.025 0.871]
 [0.011 0.12  0.    0.87 ]]
Validation acc: 0.2452012383900929
Validation class_accuracies: [0.08345534407027819, 0.4216666666666667, 0.025, 0.8695652173913043]
Validation sensitivity: 0.36373390557939916
Validation specificity: 0.08345534407027819
Validation icbhi_score: 0.22359462482483866
Validation roc_auc: None
Validation avg_accuracy: 0.3499218070320623
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 3 epochs
There is no such attribute
279/279 - 177s - loss: 0.1893 - accuracy: 0.8270 - 177s/epoch - 633ms/step
Epoch 11/80
Validation cm: [[650  28   1   4]
 [570  28   2   0]
 [130   8  41  61]
 [ 67   4  13   8]]
Validation normalized_cm: [[0.952 0.041 0.001 0.006]
 [0.95  0.047 0.003 0.   ]
 [0.542 0.033 0.171 0.254]
 [0.728 0.043 0.141 0.087]]
Validation acc: 0.4501547987616099
Validation class_accuracies: [0.9516837481698389, 0.04666666666666667, 0.17083333333333334, 0.08695652173913043]
Validation sensitivity: 0.08261802575107297
Validation specificity: 0.9516837481698389
Validation icbhi_score: 0.517150886960456
Validation roc_auc: None
Validation avg_accuracy: 0.3140350674772423
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 4 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 148s - loss: 0.1689 - accuracy: 0.8247 - 148s/epoch - 532ms/step
Epoch 12/80
Validation cm: [[648  28   4   3]
 [544  49   6   1]
 [117   8  38  77]
 [ 66   3   8  15]]
Validation normalized_cm: [[0.949 0.041 0.006 0.004]
 [0.907 0.082 0.01  0.002]
 [0.487 0.033 0.158 0.321]
 [0.717 0.033 0.087 0.163]]
Validation acc: 0.46439628482972134
Validation class_accuracies: [0.9487554904831625, 0.08166666666666667, 0.15833333333333333, 0.16304347826086957]
Validation sensitivity: 0.10944206008583691
Validation specificity: 0.9487554904831625
Validation icbhi_score: 0.5290987752844998
Validation roc_auc: None
Validation avg_accuracy: 0.33794974218600804
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 5 epochs
There is no such attribute
279/279 - 146s - loss: 0.1699 - accuracy: 0.8225 - 146s/epoch - 523ms/step
Epoch 13/80
Validation cm: [[619  60   1   3]
 [537  61   2   0]
 [138  24  29  49]
 [ 66   8   5  13]]
Validation normalized_cm: [[0.906 0.088 0.001 0.004]
 [0.895 0.102 0.003 0.   ]
 [0.575 0.1   0.121 0.204]
 [0.717 0.087 0.054 0.141]]
Validation acc: 0.4470588235294118
Validation class_accuracies: [0.9062957540263543, 0.10166666666666667, 0.12083333333333333, 0.14130434782608695]
Validation sensitivity: 0.11051502145922747
Validation specificity: 0.9062957540263543
Validation icbhi_score: 0.5084053877427909
Validation roc_auc: None
Validation avg_accuracy: 0.3175250254631103
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 6 epochs
There is no such attribute
279/279 - 137s - loss: 0.1360 - accuracy: 0.8157 - 137s/epoch - 491ms/step
Epoch 14/80
Validation cm: [[431  58 158  36]
 [315 122 136  27]
 [ 68   2 157  13]
 [ 38   7  42   5]]
Validation normalized_cm: [[0.631 0.085 0.231 0.053]
 [0.525 0.203 0.227 0.045]
 [0.283 0.008 0.654 0.054]
 [0.413 0.076 0.457 0.054]]
Validation acc: 0.44272445820433437
Validation class_accuracies: [0.6310395314787701, 0.20333333333333334, 0.6541666666666667, 0.05434782608695652]
Validation sensitivity: 0.30472103004291845
Validation specificity: 0.6310395314787701
Validation icbhi_score: 0.4678802807608443
Validation roc_auc: None
Validation avg_accuracy: 0.3857218393914317
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 7 epochs
There is no such attribute
279/279 - 146s - loss: 0.1493 - accuracy: 0.8022 - 146s/epoch - 523ms/step
Epoch 15/80
Validation cm: [[628  47   4   4]
 [496 103   0   1]
 [113  11  41  75]
 [ 61   4  12  15]]
Validation normalized_cm: [[0.919 0.069 0.006 0.006]
 [0.827 0.172 0.    0.002]
 [0.471 0.046 0.171 0.312]
 [0.663 0.043 0.13  0.163]]
Validation acc: 0.4873065015479876
Validation class_accuracies: [0.9194729136163983, 0.17166666666666666, 0.17083333333333334, 0.16304347826086957]
Validation sensitivity: 0.17060085836909872
Validation specificity: 0.9194729136163983
Validation icbhi_score: 0.5450368859927485
Validation roc_auc: None
Validation avg_accuracy: 0.356254097969317
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
279/279 - 142s - loss: 0.1143 - accuracy: 0.8009 - 142s/epoch - 508ms/step
Epoch 16/80
Validation cm: [[533 125   7  18]
 [429 157   4  10]
 [ 86  18  31 105]
 [ 48  18   8  18]]
Validation normalized_cm: [[0.78  0.183 0.01  0.026]
 [0.715 0.262 0.007 0.017]
 [0.358 0.075 0.129 0.438]
 [0.522 0.196 0.087 0.196]]
Validation acc: 0.45758513931888545
Validation class_accuracies: [0.780380673499268, 0.26166666666666666, 0.12916666666666668, 0.1956521739130435]
Validation sensitivity: 0.22103004291845493
Validation specificity: 0.780380673499268
Validation icbhi_score: 0.5007053582088614
Validation roc_auc: None
Validation avg_accuracy: 0.3417165451864112
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 9 epochs
There is no such attribute
279/279 - 176s - loss: 0.0846 - accuracy: 0.8135 - 176s/epoch - 629ms/step
Epoch 17/80
Validation cm: [[507 152  19   5]
 [341 234  21   4]
 [ 65  21 128  26]
 [ 33  21  28  10]]
Validation normalized_cm: [[0.742 0.223 0.028 0.007]
 [0.568 0.39  0.035 0.007]
 [0.271 0.087 0.533 0.108]
 [0.359 0.228 0.304 0.109]]
Validation acc: 0.5442724458204334
Validation class_accuracies: [0.7423133235724744, 0.39, 0.5333333333333333, 0.10869565217391304]
Validation sensitivity: 0.39914163090128757
Validation specificity: 0.7423133235724744
Validation icbhi_score: 0.570727477236881
Validation roc_auc: None
Validation avg_accuracy: 0.4435855772699302
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 10 epochs
There is no such attribute
279/279 - 140s - loss: 0.0563 - accuracy: 0.8065 - 140s/epoch - 502ms/step
Epoch 18/80
Validation cm: [[492  99  63  29]
 [272 264  31  33]
 [ 76  14 102  48]
 [ 40  12  25  15]]
Validation normalized_cm: [[0.72  0.145 0.092 0.042]
 [0.453 0.44  0.052 0.055]
 [0.317 0.058 0.425 0.2  ]
 [0.435 0.13  0.272 0.163]]
Validation acc: 0.5405572755417957
Validation class_accuracies: [0.7203513909224012, 0.44, 0.425, 0.16304347826086957]
Validation sensitivity: 0.40879828326180256
Validation specificity: 0.7203513909224012
Validation icbhi_score: 0.5645748370921019
Validation roc_auc: None
Validation avg_accuracy: 0.43709871729581773
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 11 epochs
There is no such attribute
279/279 - 140s - loss: 0.0444 - accuracy: 0.8002 - 140s/epoch - 502ms/step
Epoch 19/80
Validation cm: [[487  79  66  51]
 [295 188  59  58]
 [ 41  25 130  44]
 [ 29  13  35  15]]
Validation normalized_cm: [[0.713 0.116 0.097 0.075]
 [0.492 0.313 0.098 0.097]
 [0.171 0.104 0.542 0.183]
 [0.315 0.141 0.38  0.163]]
Validation acc: 0.5077399380804953
Validation class_accuracies: [0.7130307467057101, 0.31333333333333335, 0.5416666666666666, 0.16304347826086957]
Validation sensitivity: 0.3572961373390558
Validation specificity: 0.7130307467057101
Validation icbhi_score: 0.535163442022383
Validation roc_auc: None
Validation avg_accuracy: 0.4327685562416449
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 12 epochs
There is no such attribute
279/279 - 142s - loss: 0.0313 - accuracy: 0.7928 - 142s/epoch - 509ms/step
Epoch 20/80
Validation cm: [[406 232   6  39]
 [210 349   3  38]
 [ 42  45  24 129]
 [ 27  23  13  29]]
Validation normalized_cm: [[0.594 0.34  0.009 0.057]
 [0.35  0.582 0.005 0.063]
 [0.175 0.188 0.1   0.537]
 [0.293 0.25  0.141 0.315]]
Validation acc: 0.5003095975232198
Validation class_accuracies: [0.5944363103953147, 0.5816666666666667, 0.1, 0.31521739130434784]
Validation sensitivity: 0.4313304721030043
Validation specificity: 0.5944363103953147
Validation icbhi_score: 0.5128833912491595
Validation roc_auc: None
Validation avg_accuracy: 0.3978300920915823
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 13 epochs
There is no such attribute
279/279 - 141s - loss: 0.0746 - accuracy: 0.7488 - 141s/epoch - 504ms/step
Epoch 21/80
Validation cm: [[362 227  19  75]
 [176 348  10  66]
 [ 41  33  50 116]
 [ 18  25  17  32]]
Validation normalized_cm: [[0.53  0.332 0.028 0.11 ]
 [0.293 0.58  0.017 0.11 ]
 [0.171 0.138 0.208 0.483]
 [0.196 0.272 0.185 0.348]]
Validation acc: 0.4904024767801858
Validation class_accuracies: [0.5300146412884333, 0.58, 0.20833333333333334, 0.34782608695652173]
Validation sensitivity: 0.4613733905579399
Validation specificity: 0.5300146412884333
Validation icbhi_score: 0.4956940159231866
Validation roc_auc: None
Validation avg_accuracy: 0.4165435153945721
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 14 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
279/279 - 141s - loss: 0.0424 - accuracy: 0.7674 - 141s/epoch - 507ms/step
Epoch 22/80
Validation cm: [[663  12   2   6]
 [556  36   6   2]
 [117   4  60  59]
 [ 61   3  16  12]]
Validation normalized_cm: [[0.971 0.018 0.003 0.009]
 [0.927 0.06  0.01  0.003]
 [0.487 0.017 0.25  0.246]
 [0.663 0.033 0.174 0.13 ]]
Validation acc: 0.4773993808049536
Validation class_accuracies: [0.9707174231332357, 0.06, 0.25, 0.13043478260869565]
Validation sensitivity: 0.11587982832618025
Validation specificity: 0.9707174231332357
Validation icbhi_score: 0.543298625729708
Validation roc_auc: None
Validation avg_accuracy: 0.3527880514354828
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 15 epochs
There is no such attribute
279/279 - 139s - loss: 0.0335 - accuracy: 0.7820 - 139s/epoch - 499ms/step
Epoch 23/80
Validation cm: [[380 267  20  16]
 [205 378   7  10]
 [ 54  47  48  91]
 [ 30  29  14  19]]
Validation normalized_cm: [[0.556 0.391 0.029 0.023]
 [0.342 0.63  0.012 0.017]
 [0.225 0.196 0.2   0.379]
 [0.326 0.315 0.152 0.207]]
Validation acc: 0.5108359133126935
Validation class_accuracies: [0.5563689604685212, 0.63, 0.2, 0.20652173913043478]
Validation sensitivity: 0.47746781115879827
Validation specificity: 0.5563689604685212
Validation icbhi_score: 0.5169183858136598
Validation roc_auc: None
Validation avg_accuracy: 0.398222674899739
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
279/279 - 142s - loss: 0.0300 - accuracy: 0.7717 - 142s/epoch - 508ms/step
Epoch 24/80
Validation cm: [[583  77  10  13]
 [425 157  12   6]
 [ 81  23  63  73]
 [ 43  13  19  17]]
Validation normalized_cm: [[0.854 0.113 0.015 0.019]
 [0.708 0.262 0.02  0.01 ]
 [0.338 0.096 0.263 0.304]
 [0.467 0.141 0.207 0.185]]
Validation acc: 0.5077399380804953
Validation class_accuracies: [0.8535871156661786, 0.26166666666666666, 0.2625, 0.18478260869565216]
Validation sensitivity: 0.2542918454935622
Validation specificity: 0.8535871156661786
Validation icbhi_score: 0.5539394805798704
Validation roc_auc: None
Validation avg_accuracy: 0.3906340977571243
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 17 epochs
There is no such attribute
279/279 - 147s - loss: 0.0208 - accuracy: 0.7654 - 147s/epoch - 527ms/step
Epoch 25/80
Validation cm: [[549 115   4  15]
 [378 204   8  10]
 [ 75  29  45  91]
 [ 42  16  13  21]]
Validation normalized_cm: [[0.804 0.168 0.006 0.022]
 [0.63  0.34  0.013 0.017]
 [0.312 0.121 0.188 0.379]
 [0.457 0.174 0.141 0.228]]
Validation acc: 0.5071207430340557
Validation class_accuracies: [0.8038067349926794, 0.34, 0.1875, 0.22826086956521738]
Validation sensitivity: 0.28969957081545067
Validation specificity: 0.8038067349926794
Validation icbhi_score: 0.546753152904065
Validation roc_auc: None
Validation avg_accuracy: 0.3898919011394742
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 18 epochs
There is no such attribute
279/279 - 143s - loss: 0.0205 - accuracy: 0.7627 - 143s/epoch - 511ms/step
Epoch 26/80
Validation cm: [[489 122  34  38]
 [261 295  20  24]
 [ 51  32  80  77]
 [ 29  17  27  19]]
Validation normalized_cm: [[0.716 0.179 0.05  0.056]
 [0.435 0.492 0.033 0.04 ]
 [0.212 0.133 0.333 0.321]
 [0.315 0.185 0.293 0.207]]
Validation acc: 0.5467492260061919
Validation class_accuracies: [0.7159590043923866, 0.49166666666666664, 0.3333333333333333, 0.20652173913043478]
Validation sensitivity: 0.4227467811158798
Validation specificity: 0.7159590043923866
Validation icbhi_score: 0.5693528927541331
Validation roc_auc: None
Validation avg_accuracy: 0.4368701858807053
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5996809393046331 hasn't increased by 0 in 19 epochs
There is no such attribute
279/279 - 147s - loss: 0.0206 - accuracy: 0.7667 - 147s/epoch - 526ms/step
Epoch 27/80
Validation cm: [[556  65  25  37]
 [394 172  17  17]
 [ 71  17  57  95]
 [ 38  12  23  19]]
Validation normalized_cm: [[0.814 0.095 0.037 0.054]
 [0.657 0.287 0.028 0.028]
 [0.296 0.071 0.237 0.396]
 [0.413 0.13  0.25  0.207]]
Validation acc: 0.4978328173374613
Validation class_accuracies: [0.8140556368960469, 0.2866666666666667, 0.2375, 0.20652173913043478]
Validation sensitivity: 0.26609442060085836
Validation specificity: 0.8140556368960469
Validation icbhi_score: 0.5400750287484526
Validation roc_auc: None
Validation avg_accuracy: 0.3861860106732871
Validation one_indexed_epoch: 27
The number of epochs since last 1% equals the patience
There is no such attribute
279/279 - 143s - loss: 0.0245 - accuracy: 0.7258 - 143s/epoch - 514ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5996809393046331
Best cm: [[474 184  25   0]
 [246 329  25   0]
 [ 74  16 140  10]
 [ 44  15  31   2]]
Best normalized_cm: [[0.694 0.269 0.037 0.   ]
 [0.41  0.548 0.042 0.   ]
 [0.308 0.067 0.583 0.042]
 [0.478 0.163 0.337 0.022]]
Best acc: 0.5851393188854489
Best class_accuracies: [0.6939970717423133, 0.5483333333333333, 0.5833333333333334, 0.021739130434782608]
Best sensitivity: 0.5053648068669528
Best specificity: 0.6939970717423133
Best roc_auc: None
Best avg_accuracy: 0.46185071721094073
Best one_indexed_epoch: 7
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6959683895111084, 0.593329131603241, 0.52897709608078, 0.46521133184432983, 0.4237709939479828, 0.3454841077327728, 0.3062233030796051, 0.25484877824783325, 0.21858343482017517, 0.1893053501844406, 0.16892188787460327, 0.16987286508083344, 0.13599377870559692, 0.14927561581134796, 0.1143239438533783, 0.08459284156560898, 0.05628503859043121, 0.04439568519592285, 0.03131278231739998, 0.07458464801311493, 0.04238389432430267, 0.03354314714670181, 0.029960256069898605, 0.020795175805687904, 0.020515257492661476, 0.0205773264169693, 0.024502824991941452], 'accuracy': [0.5364044904708862, 0.6611235737800598, 0.712134838104248, 0.7498876452445984, 0.754157304763794, 0.7896628975868225, 0.8092134594917297, 0.8146067261695862, 0.8319101333618164, 0.8269662857055664, 0.8247190713882446, 0.8224719166755676, 0.8157303333282471, 0.802247166633606, 0.8008988499641418, 0.8134831190109253, 0.8065168261528015, 0.8002247214317322, 0.792809009552002, 0.7487640380859375, 0.7674157023429871, 0.7820224761962891, 0.7716854214668274, 0.7653932571411133, 0.7626966238021851, 0.7667415738105774, 0.7258427143096924]}
Job id is 8.
-----------------------
--- Final training dataset went from 0 to 4654 elements, with 2259 none's, 1302 crakles, 583 wheezes and 510 both ---
--- Final Validation dataset contains 1411 elements, with 619 none, 532 crackles, 134 wheezes and 126 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5150509074811863, 1: 0.8936251920122887, 2: 1.995711835334477, 3: 2.2813725490196077}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_7 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_7[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_6"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_6   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_18 (Dense)            (None, 100)               204900    
                                                                 
 dropout_12 (Dropout)        (None, 100)               0         
                                                                 
 dense_19 (Dense)            (None, 50)                5050      
                                                                 
 dropout_13 (Dropout)        (None, 50)                0         
                                                                 
 dense_20 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_6"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_12 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_13 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_6 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[134 415   0  70]
 [ 38 442   0  52]
 [ 14 110   0  10]
 [ 16  95   0  15]]
Validation normalized_cm: [[0.216 0.67  0.    0.113]
 [0.071 0.831 0.    0.098]
 [0.104 0.821 0.    0.075]
 [0.127 0.754 0.    0.119]]
Validation acc: 0.41885187810063784
Validation class_accuracies: [0.21647819063004847, 0.8308270676691729, 0.0, 0.11904761904761904]
Validation sensitivity: 0.577020202020202
Validation specificity: 0.21647819063004847
Validation icbhi_score: 0.39674919632512523
Validation roc_auc: None
Validation avg_accuracy: 0.2915882193367101
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
291/291 - 136s - loss: 0.6544 - accuracy: 0.5720 - 136s/epoch - 466ms/step
Epoch 2/80
Validation cm: [[286 255  12  66]
 [ 93 373   3  63]
 [ 28  25  10  71]
 [ 30  64   5  27]]
Validation normalized_cm: [[0.462 0.412 0.019 0.107]
 [0.175 0.701 0.006 0.118]
 [0.209 0.187 0.075 0.53 ]
 [0.238 0.508 0.04  0.214]]
Validation acc: 0.49326718639262934
Validation class_accuracies: [0.4620355411954766, 0.7011278195488722, 0.07462686567164178, 0.21428571428571427]
Validation sensitivity: 0.5176767676767676
Validation specificity: 0.4620355411954766
Validation icbhi_score: 0.48985615443612207
Validation roc_auc: None
Validation avg_accuracy: 0.3630189851754262
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
291/291 - 124s - loss: 0.5437 - accuracy: 0.7546 - 124s/epoch - 426ms/step
Epoch 3/80
Validation cm: [[214 276  65  64]
 [ 56 352  45  79]
 [ 20  31  52  31]
 [ 24  38  41  23]]
Validation normalized_cm: [[0.346 0.446 0.105 0.103]
 [0.105 0.662 0.085 0.148]
 [0.149 0.231 0.388 0.231]
 [0.19  0.302 0.325 0.183]]
Validation acc: 0.4542877391920624
Validation class_accuracies: [0.345718901453958, 0.6616541353383458, 0.3880597014925373, 0.18253968253968253]
Validation sensitivity: 0.5391414141414141
Validation specificity: 0.345718901453958
Validation icbhi_score: 0.4424301577976861
Validation roc_auc: None
Validation avg_accuracy: 0.3944931052061309
Validation one_indexed_epoch: 3
The validation tracker metric at 0.48985615443612207 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 126s - loss: 0.4803 - accuracy: 0.7759 - 126s/epoch - 432ms/step
Epoch 4/80
Validation cm: [[449  86  43  41]
 [313 163  24  32]
 [ 36   9  71  18]
 [ 61  14  43   8]]
Validation normalized_cm: [[0.725 0.139 0.069 0.066]
 [0.588 0.306 0.045 0.06 ]
 [0.269 0.067 0.53  0.134]
 [0.484 0.111 0.341 0.063]]
Validation acc: 0.4897236002834869
Validation class_accuracies: [0.7253634894991923, 0.30639097744360905, 0.5298507462686567, 0.06349206349206349]
Validation sensitivity: 0.3055555555555556
Validation specificity: 0.7253634894991923
Validation icbhi_score: 0.5154595225273739
Validation roc_auc: None
Validation avg_accuracy: 0.40627431917588036
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
291/291 - 122s - loss: 0.4126 - accuracy: 0.7985 - 122s/epoch - 421ms/step
Epoch 5/80
Validation cm: [[111 376   2 130]
 [ 44 387   1 100]
 [ 16  31   6  81]
 [ 12  67   6  41]]
Validation normalized_cm: [[0.179 0.607 0.003 0.21 ]
 [0.083 0.727 0.002 0.188]
 [0.119 0.231 0.045 0.604]
 [0.095 0.532 0.048 0.325]]
Validation acc: 0.3862508858965273
Validation class_accuracies: [0.17932148626817448, 0.7274436090225563, 0.04477611940298507, 0.3253968253968254]
Validation sensitivity: 0.547979797979798
Validation specificity: 0.17932148626817448
Validation icbhi_score: 0.36365064212398623
Validation roc_auc: None
Validation avg_accuracy: 0.3192345100226353
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5154595225273739 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 122s - loss: 0.3596 - accuracy: 0.8133 - 122s/epoch - 418ms/step
Epoch 6/80
Validation cm: [[334 163  17 105]
 [149 311   4  68]
 [ 31  29  18  56]
 [ 38  44  16  28]]
Validation normalized_cm: [[0.54  0.263 0.027 0.17 ]
 [0.28  0.585 0.008 0.128]
 [0.231 0.216 0.134 0.418]
 [0.302 0.349 0.127 0.222]]
Validation acc: 0.4897236002834869
Validation class_accuracies: [0.5395799676898223, 0.5845864661654135, 0.13432835820895522, 0.2222222222222222]
Validation sensitivity: 0.45075757575757575
Validation specificity: 0.5395799676898223
Validation icbhi_score: 0.495168771723699
Validation roc_auc: None
Validation avg_accuracy: 0.3701792535716033
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5154595225273739 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 123s - loss: 0.3081 - accuracy: 0.8365 - 123s/epoch - 424ms/step
Epoch 7/80
Validation cm: [[462  75  55  27]
 [382  99  19  32]
 [ 38   4  61  31]
 [ 76   6  37   7]]
Validation normalized_cm: [[0.746 0.121 0.089 0.044]
 [0.718 0.186 0.036 0.06 ]
 [0.284 0.03  0.455 0.231]
 [0.603 0.048 0.294 0.056]]
Validation acc: 0.4457831325301205
Validation class_accuracies: [0.7463651050080775, 0.18609022556390978, 0.4552238805970149, 0.05555555555555555]
Validation sensitivity: 0.21085858585858586
Validation specificity: 0.7463651050080775
Validation icbhi_score: 0.4786118454333317
Validation roc_auc: None
Validation avg_accuracy: 0.36080869168113944
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5154595225273739 hasn't increased by 0 in 3 epochs
There is no such attribute
291/291 - 121s - loss: 0.2811 - accuracy: 0.8367 - 121s/epoch - 415ms/step
Epoch 8/80
Validation cm: [[475  27  88  29]
 [405  55  49  23]
 [ 45   0  74  15]
 [ 72   0  52   2]]
Validation normalized_cm: [[0.767 0.044 0.142 0.047]
 [0.761 0.103 0.092 0.043]
 [0.336 0.    0.552 0.112]
 [0.571 0.    0.413 0.016]]
Validation acc: 0.4294826364280652
Validation class_accuracies: [0.7673667205169629, 0.10338345864661654, 0.5522388059701493, 0.015873015873015872]
Validation sensitivity: 0.16540404040404041
Validation specificity: 0.7673667205169629
Validation icbhi_score: 0.46638538046050165
Validation roc_auc: None
Validation avg_accuracy: 0.35971550025168614
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5154595225273739 hasn't increased by 0 in 4 epochs
There is no such attribute
291/291 - 127s - loss: 0.2147 - accuracy: 0.8509 - 127s/epoch - 438ms/step
Epoch 9/80
Validation cm: [[473  45  44  57]
 [403  80  20  29]
 [ 45   5  61  23]
 [ 84   6  29   7]]
Validation normalized_cm: [[0.764 0.073 0.071 0.092]
 [0.758 0.15  0.038 0.055]
 [0.336 0.037 0.455 0.172]
 [0.667 0.048 0.23  0.056]]
Validation acc: 0.44011339475549255
Validation class_accuracies: [0.7641357027463651, 0.15037593984962405, 0.4552238805970149, 0.05555555555555555]
Validation sensitivity: 0.18686868686868688
Validation specificity: 0.7641357027463651
Validation icbhi_score: 0.475502194807526
Validation roc_auc: None
Validation avg_accuracy: 0.3563227696871399
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5154595225273739 hasn't increased by 0 in 5 epochs
There is no such attribute
291/291 - 124s - loss: 0.1960 - accuracy: 0.8277 - 124s/epoch - 426ms/step
Epoch 10/80
Validation cm: [[327 260   2  30]
 [135 374   1  22]
 [ 45  37  35  17]
 [ 57  55  13   1]]
Validation normalized_cm: [[0.528 0.42  0.003 0.048]
 [0.254 0.703 0.002 0.041]
 [0.336 0.276 0.261 0.127]
 [0.452 0.437 0.103 0.008]]
Validation acc: 0.5223245924875974
Validation class_accuracies: [0.5282714054927302, 0.7030075187969925, 0.26119402985074625, 0.007936507936507936]
Validation sensitivity: 0.5176767676767676
Validation specificity: 0.5282714054927302
Validation icbhi_score: 0.522974086584749
Validation roc_auc: None
Validation avg_accuracy: 0.3751023655192442
Validation one_indexed_epoch: 10
-- New best results were achieved. --
There is no such attribute
291/291 - 122s - loss: 0.1924 - accuracy: 0.8356 - 122s/epoch - 419ms/step
Epoch 11/80
Validation cm: [[378 206   7  28]
 [207 298   2  25]
 [ 49  29  33  23]
 [ 56  44  22   4]]
Validation normalized_cm: [[0.611 0.333 0.011 0.045]
 [0.389 0.56  0.004 0.047]
 [0.366 0.216 0.246 0.172]
 [0.444 0.349 0.175 0.032]]
Validation acc: 0.5053153791637137
Validation class_accuracies: [0.6106623586429726, 0.5601503759398496, 0.2462686567164179, 0.031746031746031744]
Validation sensitivity: 0.42297979797979796
Validation specificity: 0.6106623586429726
Validation icbhi_score: 0.5168210783113852
Validation roc_auc: None
Validation avg_accuracy: 0.36220685576131795
Validation one_indexed_epoch: 11
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
291/291 - 131s - loss: 0.1552 - accuracy: 0.8421 - 131s/epoch - 450ms/step
Epoch 12/80
Validation cm: [[370  53 139  57]
 [315 104  70  43]
 [ 28   5  69  32]
 [ 59  17  36  14]]
Validation normalized_cm: [[0.598 0.086 0.225 0.092]
 [0.592 0.195 0.132 0.081]
 [0.209 0.037 0.515 0.239]
 [0.468 0.135 0.286 0.111]]
Validation acc: 0.39475549255846915
Validation class_accuracies: [0.5977382875605816, 0.19548872180451127, 0.5149253731343284, 0.1111111111111111]
Validation sensitivity: 0.2361111111111111
Validation specificity: 0.5977382875605816
Validation icbhi_score: 0.4169246993358463
Validation roc_auc: None
Validation avg_accuracy: 0.3548158734026331
Validation one_indexed_epoch: 12
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 124s - loss: 0.1357 - accuracy: 0.8464 - 124s/epoch - 426ms/step
Epoch 13/80
Validation cm: [[ 87 484   2  46]
 [ 27 475   0  30]
 [  4  91   7  32]
 [ 19  86   4  17]]
Validation normalized_cm: [[0.141 0.782 0.003 0.074]
 [0.051 0.893 0.    0.056]
 [0.03  0.679 0.052 0.239]
 [0.151 0.683 0.032 0.135]]
Validation acc: 0.4153082919914954
Validation class_accuracies: [0.14054927302100162, 0.8928571428571429, 0.05223880597014925, 0.1349206349206349]
Validation sensitivity: 0.6300505050505051
Validation specificity: 0.14054927302100162
Validation icbhi_score: 0.38529988903575335
Validation roc_auc: None
Validation avg_accuracy: 0.3051414641922322
Validation one_indexed_epoch: 13
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 3 epochs
There is no such attribute
291/291 - 110s - loss: 0.1394 - accuracy: 0.8530 - 110s/epoch - 378ms/step
Epoch 14/80
Validation cm: [[440  25 133  21]
 [377  48  82  25]
 [ 27   2  91  14]
 [ 52   3  68   3]]
Validation normalized_cm: [[0.711 0.04  0.215 0.034]
 [0.709 0.09  0.154 0.047]
 [0.201 0.015 0.679 0.104]
 [0.413 0.024 0.54  0.024]]
Validation acc: 0.41247342310418145
Validation class_accuracies: [0.7108239095315024, 0.09022556390977443, 0.6791044776119403, 0.023809523809523808]
Validation sensitivity: 0.17929292929292928
Validation specificity: 0.7108239095315024
Validation icbhi_score: 0.44505841941221586
Validation roc_auc: None
Validation avg_accuracy: 0.3759908687156852
Validation one_indexed_epoch: 14
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 4 epochs
There is no such attribute
291/291 - 102s - loss: 0.1403 - accuracy: 0.8410 - 102s/epoch - 349ms/step
Epoch 15/80
Validation cm: [[350 198  24  47]
 [234 263   4  31]
 [ 41  23  39  31]
 [ 59  30  26  11]]
Validation normalized_cm: [[0.565 0.32  0.039 0.076]
 [0.44  0.494 0.008 0.058]
 [0.306 0.172 0.291 0.231]
 [0.468 0.238 0.206 0.087]]
Validation acc: 0.46987951807228917
Validation class_accuracies: [0.5654281098546042, 0.4943609022556391, 0.291044776119403, 0.0873015873015873]
Validation sensitivity: 0.3952020202020202
Validation specificity: 0.5654281098546042
Validation icbhi_score: 0.4803150650283122
Validation roc_auc: None
Validation avg_accuracy: 0.3595338438828084
Validation one_indexed_epoch: 15
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 5 epochs
There is no such attribute
291/291 - 110s - loss: 0.1166 - accuracy: 0.8427 - 110s/epoch - 377ms/step
Epoch 16/80
Validation cm: [[295 276  13  35]
 [155 340   8  29]
 [ 27  50  28  29]
 [ 46  39  24  17]]
Validation normalized_cm: [[0.477 0.446 0.021 0.057]
 [0.291 0.639 0.015 0.055]
 [0.201 0.373 0.209 0.216]
 [0.365 0.31  0.19  0.135]]
Validation acc: 0.4819277108433735
Validation class_accuracies: [0.4765751211631664, 0.6390977443609023, 0.208955223880597, 0.1349206349206349]
Validation sensitivity: 0.4861111111111111
Validation specificity: 0.4765751211631664
Validation icbhi_score: 0.48134311613713876
Validation roc_auc: None
Validation avg_accuracy: 0.3648871810813251
Validation one_indexed_epoch: 16
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 6 epochs
There is no such attribute
291/291 - 105s - loss: 0.0906 - accuracy: 0.8328 - 105s/epoch - 362ms/step
Epoch 17/80
Validation cm: [[387  20 168  44]
 [397  33  57  45]
 [ 48   1  70  15]
 [ 63   3  57   3]]
Validation normalized_cm: [[0.625 0.032 0.271 0.071]
 [0.746 0.062 0.107 0.085]
 [0.358 0.007 0.522 0.112]
 [0.5   0.024 0.452 0.024]]
Validation acc: 0.3493975903614458
Validation class_accuracies: [0.6252019386106623, 0.06203007518796992, 0.5223880597014925, 0.023809523809523808]
Validation sensitivity: 0.13383838383838384
Validation specificity: 0.6252019386106623
Validation icbhi_score: 0.3795201612245231
Validation roc_auc: None
Validation avg_accuracy: 0.30835739932741213
Validation one_indexed_epoch: 17
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 7 epochs
There is no such attribute
291/291 - 106s - loss: 0.0695 - accuracy: 0.8272 - 106s/epoch - 363ms/step
Epoch 18/80
Validation cm: [[161 404  14  40]
 [ 92 411   2  27]
 [ 24  44  15  51]
 [ 35  67  10  14]]
Validation normalized_cm: [[0.26  0.653 0.023 0.065]
 [0.173 0.773 0.004 0.051]
 [0.179 0.328 0.112 0.381]
 [0.278 0.532 0.079 0.111]]
Validation acc: 0.42593905031892276
Validation class_accuracies: [0.26009693053311794, 0.7725563909774437, 0.11194029850746269, 0.1111111111111111]
Validation sensitivity: 0.5555555555555556
Validation specificity: 0.26009693053311794
Validation icbhi_score: 0.4078262430443368
Validation roc_auc: None
Validation avg_accuracy: 0.31392618278228385
Validation one_indexed_epoch: 18
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
291/291 - 101s - loss: 0.0938 - accuracy: 0.8255 - 101s/epoch - 347ms/step
Epoch 19/80
Validation cm: [[454  56  60  49]
 [363 105  28  36]
 [ 43   4  63  24]
 [ 65  10  39  12]]
Validation normalized_cm: [[0.733 0.09  0.097 0.079]
 [0.682 0.197 0.053 0.068]
 [0.321 0.03  0.47  0.179]
 [0.516 0.079 0.31  0.095]]
Validation acc: 0.44932671863926293
Validation class_accuracies: [0.7334410339256866, 0.19736842105263158, 0.4701492537313433, 0.09523809523809523]
Validation sensitivity: 0.22727272727272727
Validation specificity: 0.7334410339256866
Validation icbhi_score: 0.48035688059920695
Validation roc_auc: None
Validation avg_accuracy: 0.37404920098693917
Validation one_indexed_epoch: 19
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 9 epochs
There is no such attribute
291/291 - 104s - loss: 0.0492 - accuracy: 0.8197 - 104s/epoch - 358ms/step
Epoch 20/80
Validation cm: [[468  92  13  46]
 [346 157   3  26]
 [ 54  15  45  20]
 [ 74  12  32   8]]
Validation normalized_cm: [[0.756 0.149 0.021 0.074]
 [0.65  0.295 0.006 0.049]
 [0.403 0.112 0.336 0.149]
 [0.587 0.095 0.254 0.063]]
Validation acc: 0.4805102763997165
Validation class_accuracies: [0.7560581583198708, 0.2951127819548872, 0.3358208955223881, 0.06349206349206349]
Validation sensitivity: 0.26515151515151514
Validation specificity: 0.7560581583198708
Validation icbhi_score: 0.510604836735693
Validation roc_auc: None
Validation avg_accuracy: 0.3626209748223024
Validation one_indexed_epoch: 20
The validation tracker metric at 0.522974086584749 hasn't increased by 0 in 10 epochs
There is no such attribute
291/291 - 103s - loss: 0.0316 - accuracy: 0.8135 - 103s/epoch - 353ms/step
Epoch 21/80
Validation cm: [[437 115  20  47]
 [277 220   5  30]
 [ 51  13  38  32]
 [ 49  20  45  12]]
Validation normalized_cm: [[0.706 0.186 0.032 0.076]
 [0.521 0.414 0.009 0.056]
 [0.381 0.097 0.284 0.239]
 [0.389 0.159 0.357 0.095]]
Validation acc: 0.5010630758327428
Validation class_accuracies: [0.7059773828756059, 0.41353383458646614, 0.2835820895522388, 0.09523809523809523]
Validation sensitivity: 0.3409090909090909
Validation specificity: 0.7059773828756059
Validation icbhi_score: 0.5234432368923484
Validation roc_auc: None
Validation avg_accuracy: 0.3745828505631015
Validation one_indexed_epoch: 21
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
291/291 - 101s - loss: 0.0287 - accuracy: 0.8217 - 101s/epoch - 348ms/step
Epoch 22/80
Validation cm: [[361 103  78  77]
 [206 164  66  96]
 [ 22   7  49  56]
 [ 33   4  59  30]]
Validation normalized_cm: [[0.583 0.166 0.126 0.124]
 [0.387 0.308 0.124 0.18 ]
 [0.164 0.052 0.366 0.418]
 [0.262 0.032 0.468 0.238]]
Validation acc: 0.42806520198440823
Validation class_accuracies: [0.5831987075928917, 0.3082706766917293, 0.3656716417910448, 0.23809523809523808]
Validation sensitivity: 0.3068181818181818
Validation specificity: 0.5831987075928917
Validation icbhi_score: 0.4450084447055368
Validation roc_auc: None
Validation avg_accuracy: 0.373809066042726
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5234432368923484 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 101s - loss: 0.0256 - accuracy: 0.8032 - 101s/epoch - 348ms/step
Epoch 23/80
Validation cm: [[510  36  28  45]
 [448  40  16  28]
 [ 55   4  49  26]
 [ 72   1  46   7]]
Validation normalized_cm: [[0.824 0.058 0.045 0.073]
 [0.842 0.075 0.03  0.053]
 [0.41  0.03  0.366 0.194]
 [0.571 0.008 0.365 0.056]]
Validation acc: 0.4294826364280652
Validation class_accuracies: [0.8239095315024233, 0.07518796992481203, 0.3656716417910448, 0.05555555555555555]
Validation sensitivity: 0.12121212121212122
Validation specificity: 0.8239095315024233
Validation icbhi_score: 0.47256082635727226
Validation roc_auc: None
Validation avg_accuracy: 0.33008117469345893
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5234432368923484 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 103s - loss: 0.0205 - accuracy: 0.8081 - 103s/epoch - 354ms/step
Epoch 24/80
Validation cm: [[411 150  50   8]
 [265 238  24   5]
 [ 48  10  66  10]
 [ 69  18  36   3]]
Validation normalized_cm: [[0.664 0.242 0.081 0.013]
 [0.498 0.447 0.045 0.009]
 [0.358 0.075 0.493 0.075]
 [0.548 0.143 0.286 0.024]]
Validation acc: 0.5088589652728561
Validation class_accuracies: [0.6639741518578353, 0.4473684210526316, 0.4925373134328358, 0.023809523809523808]
Validation sensitivity: 0.38762626262626265
Validation specificity: 0.6639741518578353
Validation icbhi_score: 0.5258002072420489
Validation roc_auc: None
Validation avg_accuracy: 0.40692235253820663
Validation one_indexed_epoch: 24
-- New best results were achieved. --
There is no such attribute
291/291 - 104s - loss: 0.0225 - accuracy: 0.7961 - 104s/epoch - 359ms/step
Epoch 25/80
Validation cm: [[506  57  23  33]
 [408  85  12  27]
 [ 61   2  53  18]
 [ 75   6  39   6]]
Validation normalized_cm: [[0.817 0.092 0.037 0.053]
 [0.767 0.16  0.023 0.051]
 [0.455 0.015 0.396 0.134]
 [0.595 0.048 0.31  0.048]]
Validation acc: 0.4606661941885188
Validation class_accuracies: [0.8174474959612278, 0.15977443609022557, 0.39552238805970147, 0.047619047619047616]
Validation sensitivity: 0.18181818181818182
Validation specificity: 0.8174474959612278
Validation icbhi_score: 0.4996328388897048
Validation roc_auc: None
Validation avg_accuracy: 0.35509084193255064
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 1 epochs
There is no such attribute
291/291 - 106s - loss: 0.0216 - accuracy: 0.7976 - 106s/epoch - 363ms/step
Epoch 26/80
Validation cm: [[236 332  14  37]
 [102 396   6  28]
 [ 31  31  33  39]
 [ 31  48  33  14]]
Validation normalized_cm: [[0.381 0.536 0.023 0.06 ]
 [0.192 0.744 0.011 0.053]
 [0.231 0.231 0.246 0.291]
 [0.246 0.381 0.262 0.111]]
Validation acc: 0.481218993621545
Validation class_accuracies: [0.38126009693053314, 0.7443609022556391, 0.2462686567164179, 0.1111111111111111]
Validation sensitivity: 0.5593434343434344
Validation specificity: 0.38126009693053314
Validation icbhi_score: 0.4703017656369838
Validation roc_auc: None
Validation avg_accuracy: 0.37075019175342533
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 2 epochs
There is no such attribute
291/291 - 104s - loss: 0.0195 - accuracy: 0.7995 - 104s/epoch - 358ms/step
Epoch 27/80
Validation cm: [[484  75  24  36]
 [350 145   9  28]
 [ 54   6  53  21]
 [ 71   9  37   9]]
Validation normalized_cm: [[0.782 0.121 0.039 0.058]
 [0.658 0.273 0.017 0.053]
 [0.403 0.045 0.396 0.157]
 [0.563 0.071 0.294 0.071]]
Validation acc: 0.4897236002834869
Validation class_accuracies: [0.7819063004846527, 0.2725563909774436, 0.39552238805970147, 0.07142857142857142]
Validation sensitivity: 0.26136363636363635
Validation specificity: 0.7819063004846527
Validation icbhi_score: 0.5216349684241446
Validation roc_auc: None
Validation avg_accuracy: 0.38035341273759227
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 3 epochs
There is no such attribute
291/291 - 106s - loss: 0.0124 - accuracy: 0.7916 - 106s/epoch - 363ms/step
Epoch 28/80
Validation cm: [[496  60  27  36]
 [396  98  11  27]
 [ 56   4  57  17]
 [ 64  10  46   6]]
Validation normalized_cm: [[0.801 0.097 0.044 0.058]
 [0.744 0.184 0.021 0.051]
 [0.418 0.03  0.425 0.127]
 [0.508 0.079 0.365 0.048]]
Validation acc: 0.46562721474131824
Validation class_accuracies: [0.8012924071082391, 0.18421052631578946, 0.4253731343283582, 0.047619047619047616]
Validation sensitivity: 0.2032828282828283
Validation specificity: 0.8012924071082391
Validation icbhi_score: 0.5022876176955338
Validation roc_auc: None
Validation avg_accuracy: 0.3646237788428586
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 4 epochs
There is no such attribute
291/291 - 104s - loss: 0.0223 - accuracy: 0.8058 - 104s/epoch - 356ms/step
Epoch 29/80
Validation cm: [[517  29  42  31]
 [460  35  12  25]
 [ 52   0  60  22]
 [ 79   2  39   6]]
Validation normalized_cm: [[0.835 0.047 0.068 0.05 ]
 [0.865 0.066 0.023 0.047]
 [0.388 0.    0.448 0.164]
 [0.627 0.016 0.31  0.048]]
Validation acc: 0.4379872430900071
Validation class_accuracies: [0.8352180936995154, 0.06578947368421052, 0.44776119402985076, 0.047619047619047616]
Validation sensitivity: 0.1275252525252525
Validation specificity: 0.8352180936995154
Validation icbhi_score: 0.48137167311238394
Validation roc_auc: None
Validation avg_accuracy: 0.34909695225815607
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 5 epochs
There is no such attribute
291/291 - 106s - loss: 0.0214 - accuracy: 0.7813 - 106s/epoch - 364ms/step
Epoch 30/80
Validation cm: [[473  89  17  40]
 [361 134   8  29]
 [ 56   7  45  26]
 [ 74  11  38   3]]
Validation normalized_cm: [[0.764 0.144 0.027 0.065]
 [0.679 0.252 0.015 0.055]
 [0.418 0.052 0.336 0.194]
 [0.587 0.087 0.302 0.024]]
Validation acc: 0.46420978029766125
Validation class_accuracies: [0.7641357027463651, 0.2518796992481203, 0.3358208955223881, 0.023809523809523808]
Validation sensitivity: 0.2297979797979798
Validation specificity: 0.7641357027463651
Validation icbhi_score: 0.49696684127217244
Validation roc_auc: None
Validation avg_accuracy: 0.3439114553315993
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 6 epochs
There is no such attribute
291/291 - 106s - loss: 0.0108 - accuracy: 0.7903 - 106s/epoch - 364ms/step
Epoch 31/80
Validation cm: [[467  69  54  29]
 [385  98  21  28]
 [ 44   4  73  13]
 [ 67  11  42   6]]
Validation normalized_cm: [[0.754 0.111 0.087 0.047]
 [0.724 0.184 0.039 0.053]
 [0.328 0.03  0.545 0.097]
 [0.532 0.087 0.333 0.048]]
Validation acc: 0.45641389085754785
Validation class_accuracies: [0.7544426494345718, 0.18421052631578946, 0.5447761194029851, 0.047619047619047616]
Validation sensitivity: 0.22348484848484848
Validation specificity: 0.7544426494345718
Validation icbhi_score: 0.4889637489597102
Validation roc_auc: None
Validation avg_accuracy: 0.3827620856930985
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
291/291 - 104s - loss: 0.0172 - accuracy: 0.7828 - 104s/epoch - 357ms/step
Epoch 32/80
Validation cm: [[406 168  12  33]
 [297 202   6  27]
 [ 52  18  39  25]
 [ 57  26  35   8]]
Validation normalized_cm: [[0.656 0.271 0.019 0.053]
 [0.558 0.38  0.011 0.051]
 [0.388 0.134 0.291 0.187]
 [0.452 0.206 0.278 0.063]]
Validation acc: 0.46420978029766125
Validation class_accuracies: [0.6558966074313409, 0.37969924812030076, 0.291044776119403, 0.06349206349206349]
Validation sensitivity: 0.3143939393939394
Validation specificity: 0.6558966074313409
Validation icbhi_score: 0.48514527341264013
Validation roc_auc: None
Validation avg_accuracy: 0.3475331737907771
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
291/291 - 104s - loss: 0.0130 - accuracy: 0.7969 - 104s/epoch - 356ms/step
Epoch 33/80
Validation cm: [[397 157  23  42]
 [264 229  10  29]
 [ 45  12  46  31]
 [ 51  15  43  17]]
Validation normalized_cm: [[0.641 0.254 0.037 0.068]
 [0.496 0.43  0.019 0.055]
 [0.336 0.09  0.343 0.231]
 [0.405 0.119 0.341 0.135]]
Validation acc: 0.4883061658398299
Validation class_accuracies: [0.6413570274636511, 0.43045112781954886, 0.34328358208955223, 0.1349206349206349]
Validation sensitivity: 0.3686868686868687
Validation specificity: 0.6413570274636511
Validation icbhi_score: 0.5050219480752599
Validation roc_auc: None
Validation avg_accuracy: 0.38750309307334674
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 9 epochs
There is no such attribute
291/291 - 105s - loss: 0.0102 - accuracy: 0.7989 - 105s/epoch - 362ms/step
Epoch 34/80
Validation cm: [[424 119  32  44]
 [292 192  16  32]
 [ 44   8  58  24]
 [ 52  13  47  14]]
Validation normalized_cm: [[0.685 0.192 0.052 0.071]
 [0.549 0.361 0.03  0.06 ]
 [0.328 0.06  0.433 0.179]
 [0.413 0.103 0.373 0.111]]
Validation acc: 0.4875974486180014
Validation class_accuracies: [0.6849757673667205, 0.3609022556390977, 0.43283582089552236, 0.1111111111111111]
Validation sensitivity: 0.3333333333333333
Validation specificity: 0.6849757673667205
Validation icbhi_score: 0.5091545503500269
Validation roc_auc: None
Validation avg_accuracy: 0.3974562387531129
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 10 epochs
There is no such attribute
291/291 - 103s - loss: 0.0100 - accuracy: 0.7826 - 103s/epoch - 353ms/step
Epoch 35/80
Validation cm: [[480  32  53  54]
 [378  69  34  51]
 [ 34   4  58  38]
 [ 48   6  56  16]]
Validation normalized_cm: [[0.775 0.052 0.086 0.087]
 [0.711 0.13  0.064 0.096]
 [0.254 0.03  0.433 0.284]
 [0.381 0.048 0.444 0.127]]
Validation acc: 0.44153082919914954
Validation class_accuracies: [0.7754442649434572, 0.12969924812030076, 0.43283582089552236, 0.12698412698412698]
Validation sensitivity: 0.18055555555555555
Validation specificity: 0.7754442649434572
Validation icbhi_score: 0.4779999102495064
Validation roc_auc: None
Validation avg_accuracy: 0.3662408652358518
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 11 epochs
There is no such attribute
291/291 - 106s - loss: 0.0147 - accuracy: 0.8010 - 106s/epoch - 365ms/step
Epoch 36/80
Validation cm: [[366 185  16  52]
 [230 255  12  35]
 [ 39  13  33  49]
 [ 48  22  36  20]]
Validation normalized_cm: [[0.591 0.299 0.026 0.084]
 [0.432 0.479 0.023 0.066]
 [0.291 0.097 0.246 0.366]
 [0.381 0.175 0.286 0.159]]
Validation acc: 0.47767540751240256
Validation class_accuracies: [0.5912762520193862, 0.4793233082706767, 0.2462686567164179, 0.15873015873015872]
Validation sensitivity: 0.3888888888888889
Validation specificity: 0.5912762520193862
Validation icbhi_score: 0.4900825704541375
Validation roc_auc: None
Validation avg_accuracy: 0.36889959393415983
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 12 epochs
There is no such attribute
291/291 - 103s - loss: 0.0103 - accuracy: 0.7735 - 103s/epoch - 354ms/step
Epoch 37/80
Validation cm: [[406 138  28  47]
 [286 195  13  38]
 [ 42   9  43  40]
 [ 52  10  42  22]]
Validation normalized_cm: [[0.656 0.223 0.045 0.076]
 [0.538 0.367 0.024 0.071]
 [0.313 0.067 0.321 0.299]
 [0.413 0.079 0.333 0.175]]
Validation acc: 0.47200566973777464
Validation class_accuracies: [0.6558966074313409, 0.36654135338345867, 0.3208955223880597, 0.1746031746031746]
Validation sensitivity: 0.3282828282828283
Validation specificity: 0.6558966074313409
Validation icbhi_score: 0.4920897178570846
Validation roc_auc: None
Validation avg_accuracy: 0.37948416445150845
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 13 epochs
There is no such attribute
291/291 - 102s - loss: 0.0071 - accuracy: 0.7922 - 102s/epoch - 350ms/step
Epoch 38/80
Validation cm: [[386 164  25  44]
 [259 228  15  30]
 [ 40  13  36  45]
 [ 50  19  39  18]]
Validation normalized_cm: [[0.624 0.265 0.04  0.071]
 [0.487 0.429 0.028 0.056]
 [0.299 0.097 0.269 0.336]
 [0.397 0.151 0.31  0.143]]
Validation acc: 0.47342310418143163
Validation class_accuracies: [0.6235864297253635, 0.42857142857142855, 0.26865671641791045, 0.14285714285714285]
Validation sensitivity: 0.3560606060606061
Validation specificity: 0.6235864297253635
Validation icbhi_score: 0.4898235178929848
Validation roc_auc: None
Validation avg_accuracy: 0.3659179293929613
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 14 epochs
There is no such attribute
291/291 - 101s - loss: 0.0094 - accuracy: 0.7838 - 101s/epoch - 346ms/step
Epoch 39/80
Validation cm: [[460  91  25  43]
 [340 151   9  32]
 [ 51   4  45  34]
 [ 57  11  43  15]]
Validation normalized_cm: [[0.743 0.147 0.04  0.069]
 [0.639 0.284 0.017 0.06 ]
 [0.381 0.03  0.336 0.254]
 [0.452 0.087 0.341 0.119]]
Validation acc: 0.4755492558469171
Validation class_accuracies: [0.7431340872374798, 0.28383458646616544, 0.3358208955223881, 0.11904761904761904]
Validation sensitivity: 0.26641414141414144
Validation specificity: 0.7431340872374798
Validation icbhi_score: 0.5047741143258107
Validation roc_auc: None
Validation avg_accuracy: 0.3704592970684131
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 15 epochs
There is no such attribute
291/291 - 103s - loss: 0.0078 - accuracy: 0.7879 - 103s/epoch - 352ms/step
Epoch 40/80
Validation cm: [[404 156  17  42]
 [265 231   7  29]
 [ 44  13  37  40]
 [ 52  24  38  12]]
Validation normalized_cm: [[0.653 0.252 0.027 0.068]
 [0.498 0.434 0.013 0.055]
 [0.328 0.097 0.276 0.299]
 [0.413 0.19  0.302 0.095]]
Validation acc: 0.4847625797306875
Validation class_accuracies: [0.6526655896607432, 0.4342105263157895, 0.27611940298507465, 0.09523809523809523]
Validation sensitivity: 0.35353535353535354
Validation specificity: 0.6526655896607432
Validation icbhi_score: 0.5031004715980484
Validation roc_auc: None
Validation avg_accuracy: 0.36455840354992564
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
291/291 - 110s - loss: 0.0073 - accuracy: 0.7871 - 110s/epoch - 378ms/step
Epoch 41/80
Validation cm: [[462  89  27  41]
 [323 166  14  29]
 [ 50   5  48  31]
 [ 54  11  46  15]]
Validation normalized_cm: [[0.746 0.144 0.044 0.066]
 [0.607 0.312 0.026 0.055]
 [0.373 0.037 0.358 0.231]
 [0.429 0.087 0.365 0.119]]
Validation acc: 0.4897236002834869
Validation class_accuracies: [0.7463651050080775, 0.31203007518796994, 0.3582089552238806, 0.11904761904761904]
Validation sensitivity: 0.28914141414141414
Validation specificity: 0.7463651050080775
Validation icbhi_score: 0.5177532595747458
Validation roc_auc: None
Validation avg_accuracy: 0.38391293861688675
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 17 epochs
There is no such attribute
291/291 - 102s - loss: 0.0060 - accuracy: 0.7931 - 102s/epoch - 351ms/step
Epoch 42/80
Validation cm: [[375 175  25  44]
 [238 250  12  32]
 [ 42  12  29  51]
 [ 46  21  41  18]]
Validation normalized_cm: [[0.606 0.283 0.04  0.071]
 [0.447 0.47  0.023 0.06 ]
 [0.313 0.09  0.216 0.381]
 [0.365 0.167 0.325 0.143]]
Validation acc: 0.47625797306874557
Validation class_accuracies: [0.6058158319870759, 0.4699248120300752, 0.21641791044776118, 0.14285714285714285]
Validation sensitivity: 0.375
Validation specificity: 0.6058158319870759
Validation icbhi_score: 0.49040791599353795
Validation roc_auc: None
Validation avg_accuracy: 0.3587539243305138
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 18 epochs
There is no such attribute
291/291 - 105s - loss: 0.0085 - accuracy: 0.7813 - 105s/epoch - 361ms/step
Epoch 43/80
Validation cm: [[418 132  25  44]
 [291 195  15  31]
 [ 43  12  39  40]
 [ 53  15  44  14]]
Validation normalized_cm: [[0.675 0.213 0.04  0.071]
 [0.547 0.367 0.028 0.058]
 [0.321 0.09  0.291 0.299]
 [0.421 0.119 0.349 0.111]]
Validation acc: 0.47200566973777464
Validation class_accuracies: [0.6752827140549273, 0.36654135338345867, 0.291044776119403, 0.1111111111111111]
Validation sensitivity: 0.31313131313131315
Validation specificity: 0.6752827140549273
Validation icbhi_score: 0.49420701359312025
Validation roc_auc: None
Validation avg_accuracy: 0.36099498866722507
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5258002072420489 hasn't increased by 0 in 19 epochs
There is no such attribute
291/291 - 108s - loss: 0.0063 - accuracy: 0.7972 - 108s/epoch - 371ms/step
Epoch 44/80
Validation cm: [[426 121  28  44]
 [287 202  12  31]
 [ 43  11  41  39]
 [ 52  13  46  15]]
Validation normalized_cm: [[0.688 0.195 0.045 0.071]
 [0.539 0.38  0.023 0.058]
 [0.321 0.082 0.306 0.291]
 [0.413 0.103 0.365 0.119]]
Validation acc: 0.4847625797306875
Validation class_accuracies: [0.6882067851373183, 0.37969924812030076, 0.30597014925373134, 0.11904761904761904]
Validation sensitivity: 0.32575757575757575
Validation specificity: 0.6882067851373183
Validation icbhi_score: 0.506982180447447
Validation roc_auc: None
Validation avg_accuracy: 0.3732309503897424
Validation one_indexed_epoch: 44
The number of epochs since last 1% equals the patience
There is no such attribute
291/291 - 110s - loss: 0.0054 - accuracy: 0.7866 - 110s/epoch - 378ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5258002072420489
Best cm: [[411 150  50   8]
 [265 238  24   5]
 [ 48  10  66  10]
 [ 69  18  36   3]]
Best normalized_cm: [[0.664 0.242 0.081 0.013]
 [0.498 0.447 0.045 0.009]
 [0.358 0.075 0.493 0.075]
 [0.548 0.143 0.286 0.024]]
Best acc: 0.5088589652728561
Best class_accuracies: [0.6639741518578353, 0.4473684210526316, 0.4925373134328358, 0.023809523809523808]
Best sensitivity: 0.38762626262626265
Best specificity: 0.6639741518578353
Best roc_auc: None
Best avg_accuracy: 0.40692235253820663
Best one_indexed_epoch: 24
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6543512940406799, 0.5436548590660095, 0.48030734062194824, 0.41257086396217346, 0.3596327602863312, 0.30807065963745117, 0.2810729444026947, 0.21469485759735107, 0.19603939354419708, 0.1923896223306656, 0.15515287220478058, 0.13573972880840302, 0.13942278921604156, 0.1402522772550583, 0.1165793240070343, 0.09060031920671463, 0.0695289820432663, 0.09384026378393173, 0.04915624484419823, 0.03164109215140343, 0.028712617233395576, 0.02564910054206848, 0.020498426631093025, 0.02251405455172062, 0.021638944745063782, 0.01949784904718399, 0.012364285066723824, 0.02229934185743332, 0.021365448832511902, 0.01078371237963438, 0.017214300110936165, 0.01295479852706194, 0.010171784088015556, 0.010011497884988785, 0.014673777855932713, 0.010333397425711155, 0.007131857797503471, 0.009354263544082642, 0.007833723910152912, 0.007315979339182377, 0.006032655481249094, 0.00854548905044794, 0.006297318730503321, 0.005428791511803865], 'accuracy': [0.5719810724258423, 0.7546196579933167, 0.7758917212486267, 0.7984529733657837, 0.8132789134979248, 0.8364847302436829, 0.8366996049880981, 0.8508809804916382, 0.8276751041412354, 0.8356252908706665, 0.8420713543891907, 0.8463687300682068, 0.8530296683311462, 0.8409969806671143, 0.8427159190177917, 0.8328319787979126, 0.8272453546524048, 0.8255264163017273, 0.819724977016449, 0.8134937882423401, 0.8216587901115417, 0.8031800389289856, 0.8081220388412476, 0.7960894107818604, 0.7975934743881226, 0.7995272874832153, 0.791577160358429, 0.8057584762573242, 0.7812634110450745, 0.7902879118919373, 0.7827675342559814, 0.7969488501548767, 0.7988826632499695, 0.7825526595115662, 0.8010313510894775, 0.7735281586647034, 0.79222172498703, 0.7838418483734131, 0.7879243493080139, 0.7870649099349976, 0.7930812239646912, 0.7812634110450745, 0.797163724899292, 0.786635160446167]}
Job id is 9.
-----------------------
--- Final training dataset went from 0 to 4515 elements, with 2060 none's, 1314 crakles, 567 wheezes and 574 both ---
--- Final Validation dataset contains 1550 elements, with 818 none, 520 crackles, 150 wheezes and 62 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5479368932038835, 1: 0.8590182648401826, 2: 1.9907407407407407, 3: 1.9664634146341464}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_8 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_8[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_7   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_21 (Dense)            (None, 100)               204900    
                                                                 
 dropout_14 (Dropout)        (None, 100)               0         
                                                                 
 dense_22 (Dense)            (None, 50)                5050      
                                                                 
 dropout_15 (Dropout)        (None, 50)                0         
                                                                 
 dense_23 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_7"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_14 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_15 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_7 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 86 112 185 435]
 [ 14 121  66 319]
 [  8  28  21  93]
 [  2   3  12  45]]
Validation normalized_cm: [[0.105 0.137 0.226 0.532]
 [0.027 0.233 0.127 0.613]
 [0.053 0.187 0.14  0.62 ]
 [0.032 0.048 0.194 0.726]]
Validation acc: 0.1761290322580645
Validation class_accuracies: [0.10513447432762836, 0.2326923076923077, 0.14, 0.7258064516129032]
Validation sensitivity: 0.25546448087431695
Validation specificity: 0.10513447432762836
Validation icbhi_score: 0.18029947760097265
Validation roc_auc: None
Validation avg_accuracy: 0.3009083084082098
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
283/283 - 116s - loss: 0.6703 - accuracy: 0.5519 - 116s/epoch - 411ms/step
Epoch 2/80
Validation cm: [[255 171 216 176]
 [ 69 216  83 152]
 [  4   1  86  59]
 [  3   9  32  18]]
Validation normalized_cm: [[0.312 0.209 0.264 0.215]
 [0.133 0.415 0.16  0.292]
 [0.027 0.007 0.573 0.393]
 [0.048 0.145 0.516 0.29 ]]
Validation acc: 0.3709677419354839
Validation class_accuracies: [0.3117359413202934, 0.4153846153846154, 0.5733333333333334, 0.2903225806451613]
Validation sensitivity: 0.4371584699453552
Validation specificity: 0.3117359413202934
Validation icbhi_score: 0.3744472056328243
Validation roc_auc: None
Validation avg_accuracy: 0.3976941176708509
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
283/283 - 119s - loss: 0.5801 - accuracy: 0.6884 - 119s/epoch - 420ms/step
Epoch 3/80
Validation cm: [[420 173 118 107]
 [125 132  90 173]
 [ 11   6  41  92]
 [  7   6  15  34]]
Validation normalized_cm: [[0.513 0.211 0.144 0.131]
 [0.24  0.254 0.173 0.333]
 [0.073 0.04  0.273 0.613]
 [0.113 0.097 0.242 0.548]]
Validation acc: 0.4045161290322581
Validation class_accuracies: [0.5134474327628362, 0.25384615384615383, 0.2733333333333333, 0.5483870967741935]
Validation sensitivity: 0.2827868852459016
Validation specificity: 0.5134474327628362
Validation icbhi_score: 0.39811715900436895
Validation roc_auc: None
Validation avg_accuracy: 0.3972535041791292
Validation one_indexed_epoch: 3
-- New best results were achieved. --
There is no such attribute
283/283 - 136s - loss: 0.5122 - accuracy: 0.7431 - 136s/epoch - 482ms/step
Epoch 4/80
Validation cm: [[312 469   4  33]
 [143 320   1  56]
 [  5  57   1  87]
 [  2  36   3  21]]
Validation normalized_cm: [[0.381 0.573 0.005 0.04 ]
 [0.275 0.615 0.002 0.108]
 [0.033 0.38  0.007 0.58 ]
 [0.032 0.581 0.048 0.339]]
Validation acc: 0.42193548387096774
Validation class_accuracies: [0.38141809290953543, 0.6153846153846154, 0.006666666666666667, 0.3387096774193548]
Validation sensitivity: 0.4672131147540984
Validation specificity: 0.38141809290953543
Validation icbhi_score: 0.4243156038318169
Validation roc_auc: None
Validation avg_accuracy: 0.33554476309504305
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
283/283 - 127s - loss: 0.4565 - accuracy: 0.7688 - 127s/epoch - 451ms/step
Epoch 5/80
Validation cm: [[232 404  64 118]
 [ 39 314  16 151]
 [ 10  17  46  77]
 [  7  14  18  23]]
Validation normalized_cm: [[0.284 0.494 0.078 0.144]
 [0.075 0.604 0.031 0.29 ]
 [0.067 0.113 0.307 0.513]
 [0.113 0.226 0.29  0.371]]
Validation acc: 0.3967741935483871
Validation class_accuracies: [0.28361858190709044, 0.6038461538461538, 0.30666666666666664, 0.3709677419354839]
Validation sensitivity: 0.523224043715847
Validation specificity: 0.28361858190709044
Validation icbhi_score: 0.4034213128114687
Validation roc_auc: None
Validation avg_accuracy: 0.3912747860888487
Validation one_indexed_epoch: 5
The validation tracker metric at 0.4243156038318169 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 132s - loss: 0.4091 - accuracy: 0.7856 - 132s/epoch - 468ms/step
Epoch 6/80
Validation cm: [[494 195  37  92]
 [149 209  16 146]
 [ 21  10  24  95]
 [ 20   8  16  18]]
Validation normalized_cm: [[0.604 0.238 0.045 0.112]
 [0.287 0.402 0.031 0.281]
 [0.14  0.067 0.16  0.633]
 [0.323 0.129 0.258 0.29 ]]
Validation acc: 0.4806451612903226
Validation class_accuracies: [0.6039119804400978, 0.40192307692307694, 0.16, 0.2903225806451613]
Validation sensitivity: 0.34289617486338797
Validation specificity: 0.6039119804400978
Validation icbhi_score: 0.47340407765174286
Validation roc_auc: None
Validation avg_accuracy: 0.36403940950208397
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
283/283 - 132s - loss: 0.3442 - accuracy: 0.7949 - 132s/epoch - 468ms/step
Epoch 7/80
Validation cm: [[150 465  21 182]
 [ 12 322   1 185]
 [  3  15  18 114]
 [  0  13   4  45]]
Validation normalized_cm: [[0.183 0.568 0.026 0.222]
 [0.023 0.619 0.002 0.356]
 [0.02  0.1   0.12  0.76 ]
 [0.    0.21  0.065 0.726]]
Validation acc: 0.34516129032258064
Validation class_accuracies: [0.18337408312958436, 0.6192307692307693, 0.12, 0.7258064516129032]
Validation sensitivity: 0.5259562841530054
Validation specificity: 0.18337408312958436
Validation icbhi_score: 0.3546651836412949
Validation roc_auc: None
Validation avg_accuracy: 0.4121028259933142
Validation one_indexed_epoch: 7
The validation tracker metric at 0.47340407765174286 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 129s - loss: 0.2957 - accuracy: 0.8002 - 129s/epoch - 456ms/step
Epoch 8/80
Validation cm: [[724  51  42   1]
 [421  54  44   1]
 [ 36   5  92  17]
 [ 27   5  30   0]]
Validation normalized_cm: [[0.885 0.062 0.051 0.001]
 [0.81  0.104 0.085 0.002]
 [0.24  0.033 0.613 0.113]
 [0.435 0.081 0.484 0.   ]]
Validation acc: 0.5612903225806452
Validation class_accuracies: [0.8850855745721271, 0.10384615384615385, 0.6133333333333333, 0.0]
Validation sensitivity: 0.1994535519125683
Validation specificity: 0.8850855745721271
Validation icbhi_score: 0.5422695632423478
Validation roc_auc: None
Validation avg_accuracy: 0.4005662654379035
Validation one_indexed_epoch: 8
-- New best results were achieved. --
There is no such attribute
283/283 - 137s - loss: 0.2623 - accuracy: 0.8131 - 137s/epoch - 485ms/step
Epoch 9/80
Validation cm: [[391 341  12  74]
 [113 337   9  61]
 [ 14  23  21  92]
 [  5  25   6  26]]
Validation normalized_cm: [[0.478 0.417 0.015 0.09 ]
 [0.217 0.648 0.017 0.117]
 [0.093 0.153 0.14  0.613]
 [0.081 0.403 0.097 0.419]]
Validation acc: 0.5
Validation class_accuracies: [0.4779951100244499, 0.6480769230769231, 0.14, 0.41935483870967744]
Validation sensitivity: 0.5245901639344263
Validation specificity: 0.4779951100244499
Validation icbhi_score: 0.501292636979438
Validation roc_auc: None
Validation avg_accuracy: 0.42135671795276264
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5422695632423478 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 133s - loss: 0.2310 - accuracy: 0.8060 - 133s/epoch - 468ms/step
Epoch 10/80
Validation cm: [[707  12  98   1]
 [378  48  85   9]
 [ 43   0 100   7]
 [ 27   2  33   0]]
Validation normalized_cm: [[0.864 0.015 0.12  0.001]
 [0.727 0.092 0.163 0.017]
 [0.287 0.    0.667 0.047]
 [0.435 0.032 0.532 0.   ]]
Validation acc: 0.5516129032258065
Validation class_accuracies: [0.8643031784841075, 0.09230769230769231, 0.6666666666666666, 0.0]
Validation sensitivity: 0.20218579234972678
Validation specificity: 0.8643031784841075
Validation icbhi_score: 0.5332444854169172
Validation roc_auc: None
Validation avg_accuracy: 0.4058193843646166
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5422695632423478 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 130s - loss: 0.1888 - accuracy: 0.8100 - 130s/epoch - 461ms/step
Epoch 11/80
Validation cm: [[580 208  23   7]
 [213 278  12  17]
 [ 36   9  74  31]
 [ 17  21  14  10]]
Validation normalized_cm: [[0.709 0.254 0.028 0.009]
 [0.41  0.535 0.023 0.033]
 [0.24  0.06  0.493 0.207]
 [0.274 0.339 0.226 0.161]]
Validation acc: 0.607741935483871
Validation class_accuracies: [0.7090464547677262, 0.5346153846153846, 0.49333333333333335, 0.16129032258064516]
Validation sensitivity: 0.49453551912568305
Validation specificity: 0.7090464547677262
Validation icbhi_score: 0.6017909869467046
Validation roc_auc: None
Validation avg_accuracy: 0.4745713738242724
Validation one_indexed_epoch: 11
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 132s - loss: 0.1721 - accuracy: 0.8248 - 132s/epoch - 467ms/step
Epoch 12/80
Validation cm: [[ 44 158  28 588]
 [  9  26   9 476]
 [  0   7   3 140]
 [  0   0   0  62]]
Validation normalized_cm: [[0.054 0.193 0.034 0.719]
 [0.017 0.05  0.017 0.915]
 [0.    0.047 0.02  0.933]
 [0.    0.    0.    1.   ]]
Validation acc: 0.08709677419354839
Validation class_accuracies: [0.05378973105134474, 0.05, 0.02, 1.0]
Validation sensitivity: 0.12431693989071038
Validation specificity: 0.05378973105134474
Validation icbhi_score: 0.08905333547102756
Validation roc_auc: None
Validation avg_accuracy: 0.2809474327628362
Validation one_indexed_epoch: 12
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 133s - loss: 0.1456 - accuracy: 0.8113 - 133s/epoch - 471ms/step
Epoch 13/80
Validation cm: [[594 158  42  24]
 [244 211  35  30]
 [ 30   4  78  38]
 [ 16  12  29   5]]
Validation normalized_cm: [[0.726 0.193 0.051 0.029]
 [0.469 0.406 0.067 0.058]
 [0.2   0.027 0.52  0.253]
 [0.258 0.194 0.468 0.081]]
Validation acc: 0.5729032258064516
Validation class_accuracies: [0.726161369193154, 0.40576923076923077, 0.52, 0.08064516129032258]
Validation sensitivity: 0.4016393442622951
Validation specificity: 0.726161369193154
Validation icbhi_score: 0.5639003567277245
Validation roc_auc: None
Validation avg_accuracy: 0.4331439403131768
Validation one_indexed_epoch: 13
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 136s - loss: 0.1322 - accuracy: 0.8164 - 136s/epoch - 481ms/step
Epoch 14/80
Validation cm: [[557 157  72  32]
 [282 120  57  61]
 [ 14   9  50  77]
 [  9  13  17  23]]
Validation normalized_cm: [[0.681 0.192 0.088 0.039]
 [0.542 0.231 0.11  0.117]
 [0.093 0.06  0.333 0.513]
 [0.145 0.21  0.274 0.371]]
Validation acc: 0.4838709677419355
Validation class_accuracies: [0.6809290953545232, 0.23076923076923078, 0.3333333333333333, 0.3709677419354839]
Validation sensitivity: 0.26366120218579236
Validation specificity: 0.6809290953545232
Validation icbhi_score: 0.47229514877015777
Validation roc_auc: None
Validation avg_accuracy: 0.4039998503481428
Validation one_indexed_epoch: 14
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 134s - loss: 0.1095 - accuracy: 0.7880 - 134s/epoch - 473ms/step
Epoch 15/80
Validation cm: [[437 335  21  25]
 [127 360   7  26]
 [ 23  18  24  85]
 [ 12  21  11  18]]
Validation normalized_cm: [[0.534 0.41  0.026 0.031]
 [0.244 0.692 0.013 0.05 ]
 [0.153 0.12  0.16  0.567]
 [0.194 0.339 0.177 0.29 ]]
Validation acc: 0.5412903225806451
Validation class_accuracies: [0.5342298288508558, 0.6923076923076923, 0.16, 0.2903225806451613]
Validation sensitivity: 0.5491803278688525
Validation specificity: 0.5342298288508558
Validation icbhi_score: 0.5417050783598542
Validation roc_auc: None
Validation avg_accuracy: 0.4192150254509273
Validation one_indexed_epoch: 15
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 4 epochs
There is no such attribute
283/283 - 134s - loss: 0.1150 - accuracy: 0.7852 - 134s/epoch - 475ms/step
Epoch 16/80
Validation cm: [[357 420  16  25]
 [ 87 395   7  31]
 [ 16  25  26  83]
 [  6  29   6  21]]
Validation normalized_cm: [[0.436 0.513 0.02  0.031]
 [0.167 0.76  0.013 0.06 ]
 [0.107 0.167 0.173 0.553]
 [0.097 0.468 0.097 0.339]]
Validation acc: 0.515483870967742
Validation class_accuracies: [0.43643031784841074, 0.7596153846153846, 0.17333333333333334, 0.3387096774193548]
Validation sensitivity: 0.6038251366120219
Validation specificity: 0.43643031784841074
Validation icbhi_score: 0.5201277272302163
Validation roc_auc: None
Validation avg_accuracy: 0.42702217830412087
Validation one_indexed_epoch: 16
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 5 epochs
There is no such attribute
283/283 - 133s - loss: 0.0925 - accuracy: 0.7982 - 133s/epoch - 471ms/step
Epoch 17/80
Validation cm: [[249 459  58  52]
 [ 52 357  31  80]
 [ 10  26  40  74]
 [  9  20  10  23]]
Validation normalized_cm: [[0.304 0.561 0.071 0.064]
 [0.1   0.687 0.06  0.154]
 [0.067 0.173 0.267 0.493]
 [0.145 0.323 0.161 0.371]]
Validation acc: 0.4316129032258065
Validation class_accuracies: [0.30440097799511, 0.6865384615384615, 0.26666666666666666, 0.3709677419354839]
Validation sensitivity: 0.5737704918032787
Validation specificity: 0.30440097799511
Validation icbhi_score: 0.43908573489919434
Validation roc_auc: None
Validation avg_accuracy: 0.4071434620339305
Validation one_indexed_epoch: 17
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 6 epochs
There is no such attribute
283/283 - 132s - loss: 0.0785 - accuracy: 0.7976 - 132s/epoch - 465ms/step
Epoch 18/80
Validation cm: [[359 416   1  42]
 [102 369   0  49]
 [ 19  47   4  80]
 [ 16  23   2  21]]
Validation normalized_cm: [[0.439 0.509 0.001 0.051]
 [0.196 0.71  0.    0.094]
 [0.127 0.313 0.027 0.533]
 [0.258 0.371 0.032 0.339]]
Validation acc: 0.4858064516129032
Validation class_accuracies: [0.4388753056234719, 0.7096153846153846, 0.02666666666666667, 0.3387096774193548]
Validation sensitivity: 0.5382513661202186
Validation specificity: 0.4388753056234719
Validation icbhi_score: 0.48856333587184525
Validation roc_auc: None
Validation avg_accuracy: 0.3784667585812195
Validation one_indexed_epoch: 18
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 7 epochs
There is no such attribute
283/283 - 143s - loss: 0.0898 - accuracy: 0.7991 - 143s/epoch - 506ms/step
Epoch 19/80
Validation cm: [[395 399   2  22]
 [164 325   4  27]
 [ 25  17  25  83]
 [  9  27   8  18]]
Validation normalized_cm: [[0.483 0.488 0.002 0.027]
 [0.315 0.625 0.008 0.052]
 [0.167 0.113 0.167 0.553]
 [0.145 0.435 0.129 0.29 ]]
Validation acc: 0.492258064516129
Validation class_accuracies: [0.4828850855745721, 0.625, 0.16666666666666666, 0.2903225806451613]
Validation sensitivity: 0.5027322404371585
Validation specificity: 0.4828850855745721
Validation icbhi_score: 0.4928086630058653
Validation roc_auc: None
Validation avg_accuracy: 0.3912185832216
Validation one_indexed_epoch: 19
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
283/283 - 140s - loss: 0.0909 - accuracy: 0.7938 - 140s/epoch - 494ms/step
Epoch 20/80
Validation cm: [[297 358  59 104]
 [ 80 256  22 162]
 [  7  14  37  92]
 [  8  17  12  25]]
Validation normalized_cm: [[0.363 0.438 0.072 0.127]
 [0.154 0.492 0.042 0.312]
 [0.047 0.093 0.247 0.613]
 [0.129 0.274 0.194 0.403]]
Validation acc: 0.3967741935483871
Validation class_accuracies: [0.363080684596577, 0.49230769230769234, 0.24666666666666667, 0.4032258064516129]
Validation sensitivity: 0.4344262295081967
Validation specificity: 0.363080684596577
Validation icbhi_score: 0.39875345705238685
Validation roc_auc: None
Validation avg_accuracy: 0.3763202125056372
Validation one_indexed_epoch: 20
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 9 epochs
There is no such attribute
283/283 - 139s - loss: 0.0561 - accuracy: 0.7663 - 139s/epoch - 490ms/step
Epoch 21/80
Validation cm: [[528 272  15   3]
 [191 312   7  10]
 [ 38  14  53  45]
 [ 14  17  19  12]]
Validation normalized_cm: [[0.645 0.333 0.018 0.004]
 [0.367 0.6   0.013 0.019]
 [0.253 0.093 0.353 0.3  ]
 [0.226 0.274 0.306 0.194]]
Validation acc: 0.5838709677419355
Validation class_accuracies: [0.6454767726161369, 0.6, 0.35333333333333333, 0.1935483870967742]
Validation sensitivity: 0.5150273224043715
Validation specificity: 0.6454767726161369
Validation icbhi_score: 0.5802520475102542
Validation roc_auc: None
Validation avg_accuracy: 0.4480896232615611
Validation one_indexed_epoch: 21
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 10 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 137s - loss: 0.0313 - accuracy: 0.7849 - 137s/epoch - 485ms/step
Epoch 22/80
Validation cm: [[523 276  10   9]
 [159 339   2  20]
 [ 37  17  34  62]
 [ 18  19   6  19]]
Validation normalized_cm: [[0.639 0.337 0.012 0.011]
 [0.306 0.652 0.004 0.038]
 [0.247 0.113 0.227 0.413]
 [0.29  0.306 0.097 0.306]]
Validation acc: 0.5903225806451613
Validation class_accuracies: [0.6393643031784841, 0.6519230769230769, 0.22666666666666666, 0.3064516129032258]
Validation sensitivity: 0.5355191256830601
Validation specificity: 0.6393643031784841
Validation icbhi_score: 0.5874417144307722
Validation roc_auc: None
Validation avg_accuracy: 0.4561014149178633
Validation one_indexed_epoch: 22
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 11 epochs
There is no such attribute
283/283 - 138s - loss: 0.0290 - accuracy: 0.7734 - 138s/epoch - 487ms/step
Epoch 23/80
Validation cm: [[628 138  23  29]
 [234 199  11  76]
 [ 37   4  42  67]
 [ 15  12  13  22]]
Validation normalized_cm: [[0.768 0.169 0.028 0.035]
 [0.45  0.383 0.021 0.146]
 [0.247 0.027 0.28  0.447]
 [0.242 0.194 0.21  0.355]]
Validation acc: 0.5748387096774193
Validation class_accuracies: [0.7677261613691931, 0.38269230769230766, 0.28, 0.3548387096774194]
Validation sensitivity: 0.3592896174863388
Validation specificity: 0.7677261613691931
Validation icbhi_score: 0.563507889427766
Validation roc_auc: None
Validation avg_accuracy: 0.44631429468473005
Validation one_indexed_epoch: 23
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 12 epochs
There is no such attribute
283/283 - 142s - loss: 0.0194 - accuracy: 0.7623 - 142s/epoch - 501ms/step
Epoch 24/80
Validation cm: [[584 207  16  11]
 [290 201  13  16]
 [ 42  11  31  66]
 [ 16  16  14  16]]
Validation normalized_cm: [[0.714 0.253 0.02  0.013]
 [0.558 0.387 0.025 0.031]
 [0.28  0.073 0.207 0.44 ]
 [0.258 0.258 0.226 0.258]]
Validation acc: 0.5367741935483871
Validation class_accuracies: [0.7139364303178484, 0.38653846153846155, 0.20666666666666667, 0.25806451612903225]
Validation sensitivity: 0.33879781420765026
Validation specificity: 0.7139364303178484
Validation icbhi_score: 0.5263671222627493
Validation roc_auc: None
Validation avg_accuracy: 0.39130151866300217
Validation one_indexed_epoch: 24
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 13 epochs
There is no such attribute
283/283 - 140s - loss: 0.0304 - accuracy: 0.7482 - 140s/epoch - 493ms/step
Epoch 25/80
Validation cm: [[483 291  21  23]
 [195 245  17  63]
 [ 25  12  47  66]
 [  9  18  10  25]]
Validation normalized_cm: [[0.59  0.356 0.026 0.028]
 [0.375 0.471 0.033 0.121]
 [0.167 0.08  0.313 0.44 ]
 [0.145 0.29  0.161 0.403]]
Validation acc: 0.5161290322580645
Validation class_accuracies: [0.5904645476772616, 0.47115384615384615, 0.31333333333333335, 0.4032258064516129]
Validation sensitivity: 0.43306010928961747
Validation specificity: 0.5904645476772616
Validation icbhi_score: 0.5117623284834396
Validation roc_auc: None
Validation avg_accuracy: 0.4445443834040136
Validation one_indexed_epoch: 25
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 14 epochs
There is no such attribute
283/283 - 138s - loss: 0.0229 - accuracy: 0.7779 - 138s/epoch - 489ms/step
Epoch 26/80
Validation cm: [[631 112  65  10]
 [295 161  28  36]
 [ 30   5  70  45]
 [ 21   7  28   6]]
Validation normalized_cm: [[0.771 0.137 0.079 0.012]
 [0.567 0.31  0.054 0.069]
 [0.2   0.033 0.467 0.3  ]
 [0.339 0.113 0.452 0.097]]
Validation acc: 0.56
Validation class_accuracies: [0.7713936430317848, 0.3096153846153846, 0.4666666666666667, 0.0967741935483871]
Validation sensitivity: 0.3237704918032787
Validation specificity: 0.7713936430317848
Validation icbhi_score: 0.5475820674175318
Validation roc_auc: None
Validation avg_accuracy: 0.4111124719655558
Validation one_indexed_epoch: 26
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 15 epochs
There is no such attribute
283/283 - 139s - loss: 0.0236 - accuracy: 0.7790 - 139s/epoch - 493ms/step
Epoch 27/80
Validation cm: [[543 233  29  13]
 [230 249  14  27]
 [ 31  14  43  62]
 [ 17  12  16  17]]
Validation normalized_cm: [[0.664 0.285 0.035 0.016]
 [0.442 0.479 0.027 0.052]
 [0.207 0.093 0.287 0.413]
 [0.274 0.194 0.258 0.274]]
Validation acc: 0.5496774193548387
Validation class_accuracies: [0.6638141809290954, 0.47884615384615387, 0.2866666666666667, 0.27419354838709675]
Validation sensitivity: 0.42213114754098363
Validation specificity: 0.6638141809290954
Validation icbhi_score: 0.5429726642350395
Validation roc_auc: None
Validation avg_accuracy: 0.42588013745725317
Validation one_indexed_epoch: 27
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
283/283 - 132s - loss: 0.0210 - accuracy: 0.7812 - 132s/epoch - 468ms/step
Epoch 28/80
Validation cm: [[555 248   2  13]
 [299 210   3   8]
 [ 35  18  22  75]
 [ 13  24   5  20]]
Validation normalized_cm: [[0.678 0.303 0.002 0.016]
 [0.575 0.404 0.006 0.015]
 [0.233 0.12  0.147 0.5  ]
 [0.21  0.387 0.081 0.323]]
Validation acc: 0.5206451612903226
Validation class_accuracies: [0.6784841075794621, 0.40384615384615385, 0.14666666666666667, 0.3225806451612903]
Validation sensitivity: 0.3442622950819672
Validation specificity: 0.6784841075794621
Validation icbhi_score: 0.5113732013307146
Validation roc_auc: None
Validation avg_accuracy: 0.38789439331339326
Validation one_indexed_epoch: 28
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 17 epochs
There is no such attribute
283/283 - 137s - loss: 0.0143 - accuracy: 0.7710 - 137s/epoch - 483ms/step
Epoch 29/80
Validation cm: [[477 309  14  18]
 [161 311   9  39]
 [ 26  15  40  69]
 [ 11  20   7  24]]
Validation normalized_cm: [[0.583 0.378 0.017 0.022]
 [0.31  0.598 0.017 0.075]
 [0.173 0.1   0.267 0.46 ]
 [0.177 0.323 0.113 0.387]]
Validation acc: 0.5496774193548387
Validation class_accuracies: [0.5831295843520783, 0.5980769230769231, 0.26666666666666666, 0.3870967741935484]
Validation sensitivity: 0.5122950819672131
Validation specificity: 0.5831295843520783
Validation icbhi_score: 0.5477123331596456
Validation roc_auc: None
Validation avg_accuracy: 0.45874248707230414
Validation one_indexed_epoch: 29
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 18 epochs
There is no such attribute
283/283 - 143s - loss: 0.0145 - accuracy: 0.7801 - 143s/epoch - 504ms/step
Epoch 30/80
Validation cm: [[508 266  24  20]
 [178 285  12  45]
 [ 32  14  47  57]
 [ 12  18  14  18]]
Validation normalized_cm: [[0.621 0.325 0.029 0.024]
 [0.342 0.548 0.023 0.087]
 [0.213 0.093 0.313 0.38 ]
 [0.194 0.29  0.226 0.29 ]]
Validation acc: 0.5535483870967742
Validation class_accuracies: [0.6210268948655256, 0.5480769230769231, 0.31333333333333335, 0.2903225806451613]
Validation sensitivity: 0.4781420765027322
Validation specificity: 0.6210268948655256
Validation icbhi_score: 0.549584485684129
Validation roc_auc: None
Validation avg_accuracy: 0.44318993298023585
Validation one_indexed_epoch: 30
The validation tracker metric at 0.6017909869467046 hasn't increased by 0 in 19 epochs
There is no such attribute
283/283 - 138s - loss: 0.0126 - accuracy: 0.7688 - 138s/epoch - 488ms/step
Epoch 31/80
Validation cm: [[545 237  24  12]
 [249 240  11  20]
 [ 38  13  42  57]
 [ 17  16  15  14]]
Validation normalized_cm: [[0.666 0.29  0.029 0.015]
 [0.479 0.462 0.021 0.038]
 [0.253 0.087 0.28  0.38 ]
 [0.274 0.258 0.242 0.226]]
Validation acc: 0.5425806451612903
Validation class_accuracies: [0.6662591687041565, 0.46153846153846156, 0.28, 0.22580645161290322]
Validation sensitivity: 0.40437158469945356
Validation specificity: 0.6662591687041565
Validation icbhi_score: 0.5353153767018051
Validation roc_auc: None
Validation avg_accuracy: 0.4084010204638803
Validation one_indexed_epoch: 31
The number of epochs since last 1% equals the patience
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 137s - loss: 0.0090 - accuracy: 0.7637 - 137s/epoch - 485ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.6017909869467046
Best cm: [[580 208  23   7]
 [213 278  12  17]
 [ 36   9  74  31]
 [ 17  21  14  10]]
Best normalized_cm: [[0.709 0.254 0.028 0.009]
 [0.41  0.535 0.023 0.033]
 [0.24  0.06  0.493 0.207]
 [0.274 0.339 0.226 0.161]]
Best acc: 0.607741935483871
Best class_accuracies: [0.7090464547677262, 0.5346153846153846, 0.49333333333333335, 0.16129032258064516]
Best sensitivity: 0.49453551912568305
Best specificity: 0.7090464547677262
Best roc_auc: None
Best avg_accuracy: 0.4745713738242724
Best one_indexed_epoch: 11
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6703422665596008, 0.5800673365592957, 0.5122230648994446, 0.4565180838108063, 0.4091145694255829, 0.344203919172287, 0.29568278789520264, 0.2623372972011566, 0.23099739849567413, 0.18884886801242828, 0.17210640013217926, 0.1455652415752411, 0.13224920630455017, 0.10945447534322739, 0.11495698243379593, 0.0925118550658226, 0.07850857824087143, 0.08979204297065735, 0.09086306393146515, 0.056088484823703766, 0.031301986426115036, 0.02897680178284645, 0.01941678859293461, 0.030435843393206596, 0.02292931266129017, 0.023610064759850502, 0.020962245762348175, 0.014273721724748611, 0.01454140618443489, 0.012600541114807129, 0.008979653008282185], 'accuracy': [0.551937997341156, 0.6883720755577087, 0.7430786490440369, 0.7687707543373108, 0.7856035232543945, 0.7949058413505554, 0.8002215027809143, 0.8130675554275513, 0.8059800863265991, 0.8099668025970459, 0.8248062133789062, 0.8112956881523132, 0.816389799118042, 0.7880398631095886, 0.7851606011390686, 0.7982281446456909, 0.7975636720657349, 0.7991140484809875, 0.7937984466552734, 0.7663344144821167, 0.7849391102790833, 0.7734219431877136, 0.7623477578163147, 0.7481727600097656, 0.7778515815734863, 0.7789590358734131, 0.7811738848686218, 0.7709856033325195, 0.7800664305686951, 0.7687707543373108, 0.763676643371582]}
Job id is 10.
-----------------------
--- Final training dataset went from 0 to 4755 elements, with 2174 none's, 1360 crakles, 632 wheezes and 589 both ---
--- Final Validation dataset contains 1310 elements, with 704 none, 474 crackles, 85 wheezes and 47 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.546803127874885, 1: 0.8740808823529411, 2: 1.8809335443037976, 3: 2.018251273344652}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_9 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_9[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_8   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_24 (Dense)            (None, 100)               204900    
                                                                 
 dropout_16 (Dropout)        (None, 100)               0         
                                                                 
 dense_25 (Dense)            (None, 50)                5050      
                                                                 
 dropout_17 (Dropout)        (None, 50)                0         
                                                                 
 dense_26 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_8"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_16 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_17 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_8 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  6   0 690   8]
 [  0   0 471   3]
 [  0   0  84   1]
 [  0   0  47   0]]
Validation normalized_cm: [[0.009 0.    0.98  0.011]
 [0.    0.    0.994 0.006]
 [0.    0.    0.988 0.012]
 [0.    0.    1.    0.   ]]
Validation acc: 0.06870229007633588
Validation class_accuracies: [0.008522727272727272, 0.0, 0.9882352941176471, 0.0]
Validation sensitivity: 0.13861386138613863
Validation specificity: 0.008522727272727272
Validation icbhi_score: 0.07356829432943295
Validation roc_auc: None
Validation avg_accuracy: 0.2491895053475936
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
298/298 - 137s - loss: 0.6593 - accuracy: 0.5359 - 137s/epoch - 460ms/step
Epoch 2/80
Validation cm: [[326 288  20  70]
 [ 66 343  10  55]
 [  7  12  18  48]
 [  3  26  12   6]]
Validation normalized_cm: [[0.463 0.409 0.028 0.099]
 [0.139 0.724 0.021 0.116]
 [0.082 0.141 0.212 0.565]
 [0.064 0.553 0.255 0.128]]
Validation acc: 0.5290076335877862
Validation class_accuracies: [0.4630681818181818, 0.7236286919831224, 0.21176470588235294, 0.1276595744680851]
Validation sensitivity: 0.6056105610561056
Validation specificity: 0.4630681818181818
Validation icbhi_score: 0.5343393714371437
Validation roc_auc: None
Validation avg_accuracy: 0.3815302885379355
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
298/298 - 135s - loss: 0.5649 - accuracy: 0.6698 - 135s/epoch - 453ms/step
Epoch 3/80
Validation cm: [[339 260  53  52]
 [120 285  15  54]
 [  9  15  21  40]
 [  6  20  14   7]]
Validation normalized_cm: [[0.482 0.369 0.075 0.074]
 [0.253 0.601 0.032 0.114]
 [0.106 0.176 0.247 0.471]
 [0.128 0.426 0.298 0.149]]
Validation acc: 0.49770992366412214
Validation class_accuracies: [0.4815340909090909, 0.6012658227848101, 0.24705882352941178, 0.14893617021276595]
Validation sensitivity: 0.5165016501650165
Validation specificity: 0.4815340909090909
Validation icbhi_score: 0.4990178705370537
Validation roc_auc: None
Validation avg_accuracy: 0.3696987268590197
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5343393714371437 hasn't increased by 0 in 1 epochs
There is no such attribute
298/298 - 131s - loss: 0.5066 - accuracy: 0.7174 - 131s/epoch - 439ms/step
Epoch 4/80
Validation cm: [[460 196  15  33]
 [284 183   3   4]
 [ 33  28   9  15]
 [ 13  26   5   3]]
Validation normalized_cm: [[0.653 0.278 0.021 0.047]
 [0.599 0.386 0.006 0.008]
 [0.388 0.329 0.106 0.176]
 [0.277 0.553 0.106 0.064]]
Validation acc: 0.5
Validation class_accuracies: [0.6534090909090909, 0.3860759493670886, 0.10588235294117647, 0.06382978723404255]
Validation sensitivity: 0.3217821782178218
Validation specificity: 0.6534090909090909
Validation icbhi_score: 0.48759563456345634
Validation roc_auc: None
Validation avg_accuracy: 0.30229929511284964
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5343393714371437 hasn't increased by 0 in 2 epochs
There is no such attribute
298/298 - 128s - loss: 0.4450 - accuracy: 0.7388 - 128s/epoch - 428ms/step
Epoch 5/80
Validation cm: [[431 237  11  25]
 [143 323   1   7]
 [ 24  34   8  19]
 [ 15  26   0   6]]
Validation normalized_cm: [[0.612 0.337 0.016 0.036]
 [0.302 0.681 0.002 0.015]
 [0.282 0.4   0.094 0.224]
 [0.319 0.553 0.    0.128]]
Validation acc: 0.5862595419847328
Validation class_accuracies: [0.6122159090909091, 0.6814345991561181, 0.09411764705882353, 0.1276595744680851]
Validation sensitivity: 0.5561056105610561
Validation specificity: 0.6122159090909091
Validation icbhi_score: 0.5841607598259826
Validation roc_auc: None
Validation avg_accuracy: 0.37885693244348395
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
298/298 - 129s - loss: 0.3969 - accuracy: 0.7706 - 129s/epoch - 434ms/step
Epoch 6/80
Validation cm: [[229 407   7  61]
 [ 53 391   3  27]
 [  5  32   7  41]
 [  2  25   6  14]]
Validation normalized_cm: [[0.325 0.578 0.01  0.087]
 [0.112 0.825 0.006 0.057]
 [0.059 0.376 0.082 0.482]
 [0.043 0.532 0.128 0.298]]
Validation acc: 0.48931297709923666
Validation class_accuracies: [0.3252840909090909, 0.8248945147679325, 0.08235294117647059, 0.2978723404255319]
Validation sensitivity: 0.6798679867986799
Validation specificity: 0.3252840909090909
Validation icbhi_score: 0.5025760388538854
Validation roc_auc: None
Validation avg_accuracy: 0.38260097181975644
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 1 epochs
There is no such attribute
298/298 - 128s - loss: 0.3481 - accuracy: 0.7638 - 128s/epoch - 431ms/step
Epoch 7/80
Validation cm: [[598  54  23  29]
 [311 141   4  18]
 [ 25   3  33  24]
 [ 29   3  11   4]]
Validation normalized_cm: [[0.849 0.077 0.033 0.041]
 [0.656 0.297 0.008 0.038]
 [0.294 0.035 0.388 0.282]
 [0.617 0.064 0.234 0.085]]
Validation acc: 0.5923664122137404
Validation class_accuracies: [0.8494318181818182, 0.2974683544303797, 0.38823529411764707, 0.0851063829787234]
Validation sensitivity: 0.29372937293729373
Validation specificity: 0.8494318181818182
Validation icbhi_score: 0.571580595559556
Validation roc_auc: None
Validation avg_accuracy: 0.40506046242714205
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 2 epochs
There is no such attribute
298/298 - 178s - loss: 0.3120 - accuracy: 0.7680 - 178s/epoch - 597ms/step
Epoch 8/80
Validation cm: [[360 228  12 104]
 [183 216   4  71]
 [ 13   8  19  45]
 [  3  24   2  18]]
Validation normalized_cm: [[0.511 0.324 0.017 0.148]
 [0.386 0.456 0.008 0.15 ]
 [0.153 0.094 0.224 0.529]
 [0.064 0.511 0.043 0.383]]
Validation acc: 0.4679389312977099
Validation class_accuracies: [0.5113636363636364, 0.45569620253164556, 0.2235294117647059, 0.3829787234042553]
Validation sensitivity: 0.4174917491749175
Validation specificity: 0.5113636363636364
Validation icbhi_score: 0.4644276927692769
Validation roc_auc: None
Validation avg_accuracy: 0.3933919935160608
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 3 epochs
There is no such attribute
298/298 - 129s - loss: 0.2775 - accuracy: 0.7758 - 129s/epoch - 431ms/step
Epoch 9/80
Validation cm: [[282 293  20 109]
 [ 57 302  11 104]
 [ 10  15  14  46]
 [  7  23   8   9]]
Validation normalized_cm: [[0.401 0.416 0.028 0.155]
 [0.12  0.637 0.023 0.219]
 [0.118 0.176 0.165 0.541]
 [0.149 0.489 0.17  0.191]]
Validation acc: 0.4633587786259542
Validation class_accuracies: [0.4005681818181818, 0.6371308016877637, 0.16470588235294117, 0.19148936170212766]
Validation sensitivity: 0.5363036303630363
Validation specificity: 0.4005681818181818
Validation icbhi_score: 0.46843590609060903
Validation roc_auc: None
Validation avg_accuracy: 0.3484735568902536
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 4 epochs
There is no such attribute
298/298 - 128s - loss: 0.2308 - accuracy: 0.7878 - 128s/epoch - 431ms/step
Epoch 10/80
Validation cm: [[270 351   3  80]
 [ 87 360   3  24]
 [  7  24   4  50]
 [  3  25   1  18]]
Validation normalized_cm: [[0.384 0.499 0.004 0.114]
 [0.184 0.759 0.006 0.051]
 [0.082 0.282 0.047 0.588]
 [0.064 0.532 0.021 0.383]]
Validation acc: 0.49770992366412214
Validation class_accuracies: [0.3835227272727273, 0.759493670886076, 0.047058823529411764, 0.3829787234042553]
Validation sensitivity: 0.6303630363036303
Validation specificity: 0.3835227272727273
Validation icbhi_score: 0.5069428817881788
Validation roc_auc: None
Validation avg_accuracy: 0.3932634862731176
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 5 epochs
There is no such attribute
298/298 - 128s - loss: 0.2056 - accuracy: 0.7668 - 128s/epoch - 430ms/step
Epoch 11/80
Validation cm: [[250 355  58  41]
 [127 282  38  27]
 [  7  13  44  21]
 [  5  27  12   3]]
Validation normalized_cm: [[0.355 0.504 0.082 0.058]
 [0.268 0.595 0.08  0.057]
 [0.082 0.153 0.518 0.247]
 [0.106 0.574 0.255 0.064]]
Validation acc: 0.44198473282442746
Validation class_accuracies: [0.35511363636363635, 0.5949367088607594, 0.5176470588235295, 0.06382978723404255]
Validation sensitivity: 0.5429042904290429
Validation specificity: 0.35511363636363635
Validation icbhi_score: 0.4490089633963396
Validation roc_auc: None
Validation avg_accuracy: 0.3828817978204919
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 6 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
298/298 - 121s - loss: 0.1784 - accuracy: 0.7748 - 121s/epoch - 408ms/step
Epoch 12/80
Validation cm: [[164 493  10  37]
 [ 42 408   4  20]
 [  6  39  15  25]
 [  3  31   3  10]]
Validation normalized_cm: [[0.233 0.7   0.014 0.053]
 [0.089 0.861 0.008 0.042]
 [0.071 0.459 0.176 0.294]
 [0.064 0.66  0.064 0.213]]
Validation acc: 0.45572519083969465
Validation class_accuracies: [0.23295454545454544, 0.8607594936708861, 0.17647058823529413, 0.2127659574468085]
Validation sensitivity: 0.7145214521452146
Validation specificity: 0.23295454545454544
Validation icbhi_score: 0.47373799879988
Validation roc_auc: None
Validation avg_accuracy: 0.3707376462018836
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 7 epochs
There is no such attribute
298/298 - 136s - loss: 0.1530 - accuracy: 0.7750 - 136s/epoch - 456ms/step
Epoch 13/80
Validation cm: [[565  98   1  40]
 [314 146   0  14]
 [ 37  12  10  26]
 [ 24  13   3   7]]
Validation normalized_cm: [[0.803 0.139 0.001 0.057]
 [0.662 0.308 0.    0.03 ]
 [0.435 0.141 0.118 0.306]
 [0.511 0.277 0.064 0.149]]
Validation acc: 0.5557251908396946
Validation class_accuracies: [0.8025568181818182, 0.3080168776371308, 0.11764705882352941, 0.14893617021276595]
Validation sensitivity: 0.26897689768976896
Validation specificity: 0.8025568181818182
Validation icbhi_score: 0.5357668579357936
Validation roc_auc: None
Validation avg_accuracy: 0.34428923121381116
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
298/298 - 131s - loss: 0.1454 - accuracy: 0.7817 - 131s/epoch - 438ms/step
Epoch 14/80
Validation cm: [[325 273  38  68]
 [138 268  14  54]
 [ 16  12  18  39]
 [  6  22  13   6]]
Validation normalized_cm: [[0.462 0.388 0.054 0.097]
 [0.291 0.565 0.03  0.114]
 [0.188 0.141 0.212 0.459]
 [0.128 0.468 0.277 0.128]]
Validation acc: 0.47099236641221376
Validation class_accuracies: [0.4616477272727273, 0.5654008438818565, 0.21176470588235294, 0.1276595744680851]
Validation sensitivity: 0.48184818481848185
Validation specificity: 0.4616477272727273
Validation icbhi_score: 0.4717479560456046
Validation roc_auc: None
Validation avg_accuracy: 0.34161821287625543
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 9 epochs
There is no such attribute
298/298 - 129s - loss: 0.1083 - accuracy: 0.7771 - 129s/epoch - 433ms/step
Epoch 15/80
Validation cm: [[534  87  27  56]
 [280 158   9  27]
 [ 29   7  16  33]
 [ 25   9   8   5]]
Validation normalized_cm: [[0.759 0.124 0.038 0.08 ]
 [0.591 0.333 0.019 0.057]
 [0.341 0.082 0.188 0.388]
 [0.532 0.191 0.17  0.106]]
Validation acc: 0.5442748091603054
Validation class_accuracies: [0.7585227272727273, 0.3333333333333333, 0.18823529411764706, 0.10638297872340426]
Validation sensitivity: 0.2953795379537954
Validation specificity: 0.7585227272727273
Validation icbhi_score: 0.5269511326132613
Validation roc_auc: None
Validation avg_accuracy: 0.346618583361778
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 10 epochs
There is no such attribute
298/298 - 130s - loss: 0.0637 - accuracy: 0.7739 - 130s/epoch - 435ms/step
Epoch 16/80
Validation cm: [[489 123  25  67]
 [239 164  16  55]
 [ 17  10  17  41]
 [ 11  17  11   8]]
Validation normalized_cm: [[0.695 0.175 0.036 0.095]
 [0.504 0.346 0.034 0.116]
 [0.2   0.118 0.2   0.482]
 [0.234 0.362 0.234 0.17 ]]
Validation acc: 0.517557251908397
Validation class_accuracies: [0.6946022727272727, 0.3459915611814346, 0.2, 0.1702127659574468]
Validation sensitivity: 0.3118811881188119
Validation specificity: 0.6946022727272727
Validation icbhi_score: 0.5032417304230423
Validation roc_auc: None
Validation avg_accuracy: 0.3527016499665385
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 11 epochs
There is no such attribute
298/298 - 130s - loss: 0.0484 - accuracy: 0.7666 - 130s/epoch - 436ms/step
Epoch 17/80
Validation cm: [[522  81  25  76]
 [264 146   5  59]
 [ 24   4  17  40]
 [ 22  11   9   5]]
Validation normalized_cm: [[0.741 0.115 0.036 0.108]
 [0.557 0.308 0.011 0.124]
 [0.282 0.047 0.2   0.471]
 [0.468 0.234 0.191 0.106]]
Validation acc: 0.5267175572519084
Validation class_accuracies: [0.7414772727272727, 0.3080168776371308, 0.2, 0.10638297872340426]
Validation sensitivity: 0.27722772277227725
Validation specificity: 0.7414772727272727
Validation icbhi_score: 0.509352497749775
Validation roc_auc: None
Validation avg_accuracy: 0.33896928227195194
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 12 epochs
There is no such attribute
298/298 - 131s - loss: 0.0435 - accuracy: 0.7579 - 131s/epoch - 441ms/step
Epoch 18/80
Validation cm: [[382 238  23  61]
 [170 251   4  49]
 [ 14  12  18  41]
 [ 10  20  11   6]]
Validation normalized_cm: [[0.543 0.338 0.033 0.087]
 [0.359 0.53  0.008 0.103]
 [0.165 0.141 0.212 0.482]
 [0.213 0.426 0.234 0.128]]
Validation acc: 0.5015267175572519
Validation class_accuracies: [0.5426136363636364, 0.5295358649789029, 0.21176470588235294, 0.1276595744680851]
Validation sensitivity: 0.4537953795379538
Validation specificity: 0.5426136363636364
Validation icbhi_score: 0.4982045079507951
Validation roc_auc: None
Validation avg_accuracy: 0.3528934454232443
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 13 epochs
There is no such attribute
298/298 - 134s - loss: 0.0464 - accuracy: 0.7502 - 134s/epoch - 449ms/step
Epoch 19/80
Validation cm: [[268 363   8  65]
 [ 99 330   3  42]
 [  9  20   7  49]
 [  4  28   3  12]]
Validation normalized_cm: [[0.381 0.516 0.011 0.092]
 [0.209 0.696 0.006 0.089]
 [0.106 0.235 0.082 0.576]
 [0.085 0.596 0.064 0.255]]
Validation acc: 0.47099236641221376
Validation class_accuracies: [0.3806818181818182, 0.6962025316455697, 0.08235294117647059, 0.2553191489361702]
Validation sensitivity: 0.5759075907590759
Validation specificity: 0.3806818181818182
Validation icbhi_score: 0.4782947044704471
Validation roc_auc: None
Validation avg_accuracy: 0.35363910998500714
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 14 epochs
There is no such attribute
298/298 - 130s - loss: 0.0391 - accuracy: 0.7344 - 130s/epoch - 436ms/step
Epoch 20/80
Validation cm: [[277 301  17 109]
 [ 69 298   6 101]
 [  9  12   6  58]
 [  4  23   5  15]]
Validation normalized_cm: [[0.393 0.428 0.024 0.155]
 [0.146 0.629 0.013 0.213]
 [0.106 0.141 0.071 0.682]
 [0.085 0.489 0.106 0.319]]
Validation acc: 0.4549618320610687
Validation class_accuracies: [0.3934659090909091, 0.6286919831223629, 0.07058823529411765, 0.3191489361702128]
Validation sensitivity: 0.5264026402640264
Validation specificity: 0.3934659090909091
Validation icbhi_score: 0.4599342746774677
Validation roc_auc: None
Validation avg_accuracy: 0.35297376591940055
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 15 epochs
There is no such attribute
298/298 - 127s - loss: 0.0363 - accuracy: 0.7453 - 127s/epoch - 427ms/step
Epoch 21/80
Validation cm: [[407 176  34  87]
 [158 244  15  57]
 [ 15  11  14  45]
 [ 12  17   8  10]]
Validation normalized_cm: [[0.578 0.25  0.048 0.124]
 [0.333 0.515 0.032 0.12 ]
 [0.176 0.129 0.165 0.529]
 [0.255 0.362 0.17  0.213]]
Validation acc: 0.5152671755725191
Validation class_accuracies: [0.578125, 0.5147679324894515, 0.16470588235294117, 0.2127659574468085]
Validation sensitivity: 0.44224422442244227
Validation specificity: 0.578125
Validation icbhi_score: 0.5101846122112211
Validation roc_auc: None
Validation avg_accuracy: 0.3675911930723003
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
298/298 - 131s - loss: 0.0293 - accuracy: 0.7274 - 131s/epoch - 440ms/step
Epoch 22/80
Validation cm: [[534  89  38  43]
 [275 157  13  29]
 [ 28   4  38  15]
 [ 17  13  12   5]]
Validation normalized_cm: [[0.759 0.126 0.054 0.061]
 [0.58  0.331 0.027 0.061]
 [0.329 0.047 0.447 0.176]
 [0.362 0.277 0.255 0.106]]
Validation acc: 0.5603053435114503
Validation class_accuracies: [0.7585227272727273, 0.33122362869198313, 0.4470588235294118, 0.10638297872340426]
Validation sensitivity: 0.33003300330033003
Validation specificity: 0.7585227272727273
Validation icbhi_score: 0.5442778652865287
Validation roc_auc: None
Validation avg_accuracy: 0.4107970395543816
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 17 epochs
There is no such attribute
298/298 - 111s - loss: 0.0220 - accuracy: 0.7348 - 111s/epoch - 372ms/step
Epoch 23/80
Validation cm: [[473 155  17  59]
 [216 206  11  41]
 [ 24   9  29  23]
 [ 15  17   9   6]]
Validation normalized_cm: [[0.672 0.22  0.024 0.084]
 [0.456 0.435 0.023 0.086]
 [0.282 0.106 0.341 0.271]
 [0.319 0.362 0.191 0.128]]
Validation acc: 0.5450381679389313
Validation class_accuracies: [0.671875, 0.4345991561181435, 0.3411764705882353, 0.1276595744680851]
Validation sensitivity: 0.3976897689768977
Validation specificity: 0.671875
Validation icbhi_score: 0.5347823844884488
Validation roc_auc: None
Validation avg_accuracy: 0.39382755029361594
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 18 epochs
There is no such attribute
298/298 - 97s - loss: 0.0194 - accuracy: 0.7308 - 97s/epoch - 327ms/step
Epoch 24/80
Validation cm: [[454 154  31  65]
 [179 244  13  38]
 [ 14   8  35  28]
 [ 11  19   9   8]]
Validation normalized_cm: [[0.645 0.219 0.044 0.092]
 [0.378 0.515 0.027 0.08 ]
 [0.165 0.094 0.412 0.329]
 [0.234 0.404 0.191 0.17 ]]
Validation acc: 0.565648854961832
Validation class_accuracies: [0.6448863636363636, 0.5147679324894515, 0.4117647058823529, 0.1702127659574468]
Validation sensitivity: 0.4735973597359736
Validation specificity: 0.6448863636363636
Validation icbhi_score: 0.5592418616861686
Validation roc_auc: None
Validation avg_accuracy: 0.4354079419914037
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5841607598259826 hasn't increased by 0 in 19 epochs
There is no such attribute
298/298 - 97s - loss: 0.0210 - accuracy: 0.7317 - 97s/epoch - 326ms/step
Epoch 25/80
Validation cm: [[419 196  23  66]
 [181 233   8  52]
 [ 14  13  19  39]
 [ 15  19   6   7]]
Validation normalized_cm: [[0.595 0.278 0.033 0.094]
 [0.382 0.492 0.017 0.11 ]
 [0.165 0.153 0.224 0.459]
 [0.319 0.404 0.128 0.149]]
Validation acc: 0.517557251908397
Validation class_accuracies: [0.5951704545454546, 0.49156118143459915, 0.2235294117647059, 0.14893617021276595]
Validation sensitivity: 0.4273927392739274
Validation specificity: 0.5951704545454546
Validation icbhi_score: 0.511281596909691
Validation roc_auc: None
Validation avg_accuracy: 0.36479930448938147
Validation one_indexed_epoch: 25
The number of epochs since last 1% equals the patience
There is no such attribute
298/298 - 98s - loss: 0.0247 - accuracy: 0.7321 - 98s/epoch - 327ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5841607598259826
Best cm: [[431 237  11  25]
 [143 323   1   7]
 [ 24  34   8  19]
 [ 15  26   0   6]]
Best normalized_cm: [[0.612 0.337 0.016 0.036]
 [0.302 0.681 0.002 0.015]
 [0.282 0.4   0.094 0.224]
 [0.319 0.553 0.    0.128]]
Best acc: 0.5862595419847328
Best class_accuracies: [0.6122159090909091, 0.6814345991561181, 0.09411764705882353, 0.1276595744680851]
Best sensitivity: 0.5561056105610561
Best specificity: 0.6122159090909091
Best roc_auc: None
Best avg_accuracy: 0.37885693244348395
Best one_indexed_epoch: 5
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6593450903892517, 0.5648738145828247, 0.5065526962280273, 0.4450465440750122, 0.3969372510910034, 0.34807828068733215, 0.3120015561580658, 0.27753856778144836, 0.23082338273525238, 0.20559562742710114, 0.17842629551887512, 0.15302293002605438, 0.14541390538215637, 0.10830699652433395, 0.0637437179684639, 0.0484452098608017, 0.04348212480545044, 0.04635924845933914, 0.03909330442547798, 0.036317046731710434, 0.029270024970173836, 0.02204524166882038, 0.019400328397750854, 0.021004747599363327, 0.024698475375771523], 'accuracy': [0.5358570218086243, 0.6698212623596191, 0.71735018491745, 0.7388012409210205, 0.7705572843551636, 0.7638275623321533, 0.7680336236953735, 0.775814950466156, 0.7878023386001587, 0.7667717933654785, 0.7747634053230286, 0.7749736905097961, 0.7817034721374512, 0.777076780796051, 0.7739222049713135, 0.7665615081787109, 0.7579390406608582, 0.7501577138900757, 0.7343848347663879, 0.745320737361908, 0.7274447679519653, 0.7348054647445679, 0.7308096885681152, 0.7316508889198303, 0.7320715188980103]}
Job id is 11.
-----------------------
--- Final training dataset went from 0 to 4522 elements, with 2123 none's, 1260 crakles, 622 wheezes and 517 both ---
--- Final Validation dataset contains 1543 elements, with 755 none, 574 crackles, 95 wheezes and 119 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5325011775788978, 1: 0.8972222222222223, 2: 1.817524115755627, 3: 2.1866537717601546}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_10 (InputLayer)          [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_10[0][0]']               
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_9   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_27 (Dense)            (None, 100)               204900    
                                                                 
 dropout_18 (Dropout)        (None, 100)               0         
                                                                 
 dense_28 (Dense)            (None, 50)                5050      
                                                                 
 dropout_19 (Dropout)        (None, 50)                0         
                                                                 
 dense_29 (Dense)            (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_9"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_18 (MelFilterbanks)             multiple                                    0                
                                                                                                              
 mel_filterbanks_19 (MelFilterbanks)             multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_9 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  1   0 422 332]
 [  0   1 237 336]
 [  0   0  50  45]
 [  0   0  42  77]]
Validation normalized_cm: [[0.001 0.    0.559 0.44 ]
 [0.    0.002 0.413 0.585]
 [0.    0.    0.526 0.474]
 [0.    0.    0.353 0.647]]
Validation acc: 0.08360337005832794
Validation class_accuracies: [0.0013245033112582781, 0.0017421602787456446, 0.5263157894736842, 0.6470588235294118]
Validation sensitivity: 0.16243654822335024
Validation specificity: 0.0013245033112582781
Validation icbhi_score: 0.08188052576730426
Validation roc_auc: None
Validation avg_accuracy: 0.294110319148275
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
283/283 - 119s - loss: 0.6598 - accuracy: 0.5686 - 119s/epoch - 422ms/step
Epoch 2/80
Validation cm: [[688   4  63   0]
 [506  11  55   2]
 [ 36   0  59   0]
 [ 54   1  64   0]]
Validation normalized_cm: [[0.911 0.005 0.083 0.   ]
 [0.882 0.019 0.096 0.003]
 [0.379 0.    0.621 0.   ]
 [0.454 0.008 0.538 0.   ]]
Validation acc: 0.49125081011017496
Validation class_accuracies: [0.9112582781456954, 0.01916376306620209, 0.6210526315789474, 0.0]
Validation sensitivity: 0.08883248730964467
Validation specificity: 0.9112582781456954
Validation icbhi_score: 0.5000453827276701
Validation roc_auc: None
Validation avg_accuracy: 0.3878686681977112
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
283/283 - 110s - loss: 0.5501 - accuracy: 0.6884 - 110s/epoch - 390ms/step
Epoch 3/80
Validation cm: [[404  89 165  97]
 [204 185  89  96]
 [ 10   3  66  16]
 [ 17  15  58  29]]
Validation normalized_cm: [[0.535 0.118 0.219 0.128]
 [0.355 0.322 0.155 0.167]
 [0.105 0.032 0.695 0.168]
 [0.143 0.126 0.487 0.244]]
Validation acc: 0.44329228775113416
Validation class_accuracies: [0.5350993377483444, 0.32229965156794427, 0.6947368421052632, 0.24369747899159663]
Validation sensitivity: 0.3553299492385787
Validation specificity: 0.5350993377483444
Validation icbhi_score: 0.4452146434934615
Validation roc_auc: None
Validation avg_accuracy: 0.44895832760328713
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5000453827276701 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 121s - loss: 0.4841 - accuracy: 0.7450 - 121s/epoch - 427ms/step
Epoch 4/80
Validation cm: [[545  10 189  11]
 [367  44 146  17]
 [ 21   0  73   1]
 [ 43   1  70   5]]
Validation normalized_cm: [[0.722 0.013 0.25  0.015]
 [0.639 0.077 0.254 0.03 ]
 [0.221 0.    0.768 0.011]
 [0.361 0.008 0.588 0.042]]
Validation acc: 0.4322747893713545
Validation class_accuracies: [0.7218543046357616, 0.07665505226480836, 0.7684210526315789, 0.04201680672268908]
Validation sensitivity: 0.1548223350253807
Validation specificity: 0.7218543046357616
Validation icbhi_score: 0.43833831983057114
Validation roc_auc: None
Validation avg_accuracy: 0.4022368040637095
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5000453827276701 hasn't increased by 0 in 2 epochs
There is no such attribute
283/283 - 125s - loss: 0.4315 - accuracy: 0.7603 - 125s/epoch - 440ms/step
Epoch 5/80
Validation cm: [[231 398  52  74]
 [ 70 409  31  64]
 [  7  22  26  40]
 [ 10  41  36  32]]
Validation normalized_cm: [[0.306 0.527 0.069 0.098]
 [0.122 0.713 0.054 0.111]
 [0.074 0.232 0.274 0.421]
 [0.084 0.345 0.303 0.269]]
Validation acc: 0.4523655217109527
Validation class_accuracies: [0.30596026490066225, 0.7125435540069687, 0.2736842105263158, 0.2689075630252101]
Validation sensitivity: 0.5926395939086294
Validation specificity: 0.30596026490066225
Validation icbhi_score: 0.4492999294046458
Validation roc_auc: None
Validation avg_accuracy: 0.3902738981147892
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5000453827276701 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 125s - loss: 0.3614 - accuracy: 0.7910 - 125s/epoch - 442ms/step
Epoch 6/80
Validation cm: [[591  62  96   6]
 [353 128  72  21]
 [ 25   9  40  21]
 [ 46   9  55   9]]
Validation normalized_cm: [[0.783 0.082 0.127 0.008]
 [0.615 0.223 0.125 0.037]
 [0.263 0.095 0.421 0.221]
 [0.387 0.076 0.462 0.076]]
Validation acc: 0.49773169151004537
Validation class_accuracies: [0.7827814569536424, 0.2229965156794425, 0.42105263157894735, 0.07563025210084033]
Validation sensitivity: 0.22461928934010153
Validation specificity: 0.7827814569536424
Validation icbhi_score: 0.503700373146872
Validation roc_auc: None
Validation avg_accuracy: 0.37561521407821813
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
283/283 - 126s - loss: 0.3161 - accuracy: 0.7979 - 126s/epoch - 444ms/step
Epoch 7/80
Validation cm: [[270  48 260 177]
 [149  49 118 258]
 [  5   3  37  50]
 [ 10   4  56  49]]
Validation normalized_cm: [[0.358 0.064 0.344 0.234]
 [0.26  0.085 0.206 0.449]
 [0.053 0.032 0.389 0.526]
 [0.084 0.034 0.471 0.412]]
Validation acc: 0.26247569669475046
Validation class_accuracies: [0.3576158940397351, 0.08536585365853659, 0.3894736842105263, 0.4117647058823529]
Validation sensitivity: 0.1713197969543147
Validation specificity: 0.3576158940397351
Validation icbhi_score: 0.2644678454970249
Validation roc_auc: None
Validation avg_accuracy: 0.3110550344477877
Validation one_indexed_epoch: 7
The validation tracker metric at 0.503700373146872 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 127s - loss: 0.2760 - accuracy: 0.8169 - 127s/epoch - 447ms/step
Epoch 8/80
Validation cm: [[461 168  88  38]
 [223 254  47  50]
 [ 19  15  50  11]
 [ 31  28  48  12]]
Validation normalized_cm: [[0.611 0.223 0.117 0.05 ]
 [0.389 0.443 0.082 0.087]
 [0.2   0.158 0.526 0.116]
 [0.261 0.235 0.403 0.101]]
Validation acc: 0.5035644847699287
Validation class_accuracies: [0.6105960264900663, 0.4425087108013937, 0.5263157894736842, 0.10084033613445378]
Validation sensitivity: 0.4010152284263959
Validation specificity: 0.6105960264900663
Validation icbhi_score: 0.5058056274582311
Validation roc_auc: None
Validation avg_accuracy: 0.4200652157248995
Validation one_indexed_epoch: 8
-- New best results were achieved. --
There is no such attribute
283/283 - 122s - loss: 0.2250 - accuracy: 0.8083 - 122s/epoch - 431ms/step
Epoch 9/80
Validation cm: [[600  66  60  29]
 [289 189  67  29]
 [ 31   5  42  17]
 [ 36  17  44  22]]
Validation normalized_cm: [[0.795 0.087 0.079 0.038]
 [0.503 0.329 0.117 0.051]
 [0.326 0.053 0.442 0.179]
 [0.303 0.143 0.37  0.185]]
Validation acc: 0.5528191834089436
Validation class_accuracies: [0.7947019867549668, 0.32926829268292684, 0.4421052631578947, 0.18487394957983194]
Validation sensitivity: 0.3210659898477157
Validation specificity: 0.7947019867549668
Validation icbhi_score: 0.5578839883013413
Validation roc_auc: None
Validation avg_accuracy: 0.4377373730439051
Validation one_indexed_epoch: 9
-- New best results were achieved. --
There is no such attribute
283/283 - 126s - loss: 0.2151 - accuracy: 0.8140 - 126s/epoch - 444ms/step
Epoch 10/80
Validation cm: [[419 232  33  71]
 [151 318  21  84]
 [  9  17  42  27]
 [ 26  28  38  27]]
Validation normalized_cm: [[0.555 0.307 0.044 0.094]
 [0.263 0.554 0.037 0.146]
 [0.095 0.179 0.442 0.284]
 [0.218 0.235 0.319 0.227]]
Validation acc: 0.5223590408295529
Validation class_accuracies: [0.5549668874172186, 0.554006968641115, 0.4421052631578947, 0.226890756302521]
Validation sensitivity: 0.49111675126903553
Validation specificity: 0.5549668874172186
Validation icbhi_score: 0.523041819343127
Validation roc_auc: None
Validation avg_accuracy: 0.44449246887968735
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 1 epochs
There is no such attribute
283/283 - 126s - loss: 0.1921 - accuracy: 0.8103 - 126s/epoch - 444ms/step
Epoch 11/80
Validation cm: [[200 476  27  52]
 [ 53 481   9  31]
 [  3  29  18  45]
 [  9  53  36  21]]
Validation normalized_cm: [[0.265 0.63  0.036 0.069]
 [0.092 0.838 0.016 0.054]
 [0.032 0.305 0.189 0.474]
 [0.076 0.445 0.303 0.176]]
Validation acc: 0.4666234607906675
Validation class_accuracies: [0.26490066225165565, 0.837979094076655, 0.18947368421052632, 0.17647058823529413]
Validation sensitivity: 0.6598984771573604
Validation specificity: 0.26490066225165565
Validation icbhi_score: 0.462399569704508
Validation roc_auc: None
Validation avg_accuracy: 0.3672060071935328
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 2 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 128s - loss: 0.1643 - accuracy: 0.8063 - 128s/epoch - 451ms/step
Epoch 12/80
Validation cm: [[374 245 118  18]
 [142 284  95  53]
 [ 16   8  66   5]
 [ 21  18  72   8]]
Validation normalized_cm: [[0.495 0.325 0.156 0.024]
 [0.247 0.495 0.166 0.092]
 [0.168 0.084 0.695 0.053]
 [0.176 0.151 0.605 0.067]]
Validation acc: 0.474400518470512
Validation class_accuracies: [0.495364238410596, 0.49477351916376305, 0.6947368421052632, 0.06722689075630252]
Validation sensitivity: 0.4543147208121827
Validation specificity: 0.495364238410596
Validation icbhi_score: 0.4748394796113894
Validation roc_auc: None
Validation avg_accuracy: 0.43802537260898117
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 3 epochs
There is no such attribute
283/283 - 128s - loss: 0.1301 - accuracy: 0.8021 - 128s/epoch - 452ms/step
Epoch 13/80
Validation cm: [[345 285  73  52]
 [177 308  39  50]
 [ 30  18  33  14]
 [ 35  32  38  14]]
Validation normalized_cm: [[0.457 0.377 0.097 0.069]
 [0.308 0.537 0.068 0.087]
 [0.316 0.189 0.347 0.147]
 [0.294 0.269 0.319 0.118]]
Validation acc: 0.45366169799092676
Validation class_accuracies: [0.45695364238410596, 0.5365853658536586, 0.3473684210526316, 0.11764705882352941]
Validation sensitivity: 0.45050761421319796
Validation specificity: 0.45695364238410596
Validation icbhi_score: 0.45373062829865196
Validation roc_auc: None
Validation avg_accuracy: 0.3646386220284814
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 4 epochs
There is no such attribute
283/283 - 127s - loss: 0.1335 - accuracy: 0.8012 - 127s/epoch - 448ms/step
Epoch 14/80
Validation cm: [[297 176  86 196]
 [175 165  83 151]
 [  8   9  32  46]
 [ 17  13  34  55]]
Validation normalized_cm: [[0.393 0.233 0.114 0.26 ]
 [0.305 0.287 0.145 0.263]
 [0.084 0.095 0.337 0.484]
 [0.143 0.109 0.286 0.462]]
Validation acc: 0.355800388852884
Validation class_accuracies: [0.3933774834437086, 0.2874564459930314, 0.3368421052631579, 0.46218487394957986]
Validation sensitivity: 0.3197969543147208
Validation specificity: 0.3933774834437086
Validation icbhi_score: 0.35658721887921474
Validation roc_auc: None
Validation avg_accuracy: 0.36996522716236946
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 5 epochs
There is no such attribute
283/283 - 124s - loss: 0.1161 - accuracy: 0.7937 - 124s/epoch - 439ms/step
Epoch 15/80
Validation cm: [[377 269  40  69]
 [185 282  19  88]
 [ 19   9  31  36]
 [ 21  28  42  28]]
Validation normalized_cm: [[0.499 0.356 0.053 0.091]
 [0.322 0.491 0.033 0.153]
 [0.2   0.095 0.326 0.379]
 [0.176 0.235 0.353 0.235]]
Validation acc: 0.46532728451069344
Validation class_accuracies: [0.49933774834437084, 0.4912891986062718, 0.3263157894736842, 0.23529411764705882]
Validation sensitivity: 0.43274111675126903
Validation specificity: 0.49933774834437084
Validation icbhi_score: 0.46603943254781993
Validation roc_auc: None
Validation avg_accuracy: 0.38805921351784645
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 6 epochs
There is no such attribute
283/283 - 126s - loss: 0.0976 - accuracy: 0.8016 - 126s/epoch - 446ms/step
Epoch 16/80
Validation cm: [[121 565   5  64]
 [ 19 529   3  23]
 [  4  36   2  53]
 [  9  72   3  35]]
Validation normalized_cm: [[0.16  0.748 0.007 0.085]
 [0.033 0.922 0.005 0.04 ]
 [0.042 0.379 0.021 0.558]
 [0.076 0.605 0.025 0.294]]
Validation acc: 0.44523655217109526
Validation class_accuracies: [0.16026490066225166, 0.921602787456446, 0.021052631578947368, 0.29411764705882354]
Validation sensitivity: 0.7182741116751269
Validation specificity: 0.16026490066225166
Validation icbhi_score: 0.43926950616868926
Validation roc_auc: None
Validation avg_accuracy: 0.3492594916891172
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 7 epochs
There is no such attribute
283/283 - 128s - loss: 0.1067 - accuracy: 0.7990 - 128s/epoch - 453ms/step
Epoch 17/80
Validation cm: [[133 547  16  59]
 [ 33 513   3  25]
 [  0  46  12  37]
 [ 16  67  12  24]]
Validation normalized_cm: [[0.176 0.725 0.021 0.078]
 [0.057 0.894 0.005 0.044]
 [0.    0.484 0.126 0.389]
 [0.134 0.563 0.101 0.202]]
Validation acc: 0.4419961114711601
Validation class_accuracies: [0.176158940397351, 0.8937282229965157, 0.12631578947368421, 0.20168067226890757]
Validation sensitivity: 0.6967005076142132
Validation specificity: 0.176158940397351
Validation icbhi_score: 0.4364297240057821
Validation roc_auc: None
Validation avg_accuracy: 0.3494709062841146
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
283/283 - 128s - loss: 0.0799 - accuracy: 0.8054 - 128s/epoch - 451ms/step
Epoch 18/80
Validation cm: [[310 177 198  70]
 [119 262 103  90]
 [ 13   5  64  13]
 [ 12  22  69  16]]
Validation normalized_cm: [[0.411 0.234 0.262 0.093]
 [0.207 0.456 0.179 0.157]
 [0.137 0.053 0.674 0.137]
 [0.101 0.185 0.58  0.134]]
Validation acc: 0.4225534672715489
Validation class_accuracies: [0.4105960264900662, 0.4564459930313589, 0.6736842105263158, 0.13445378151260504]
Validation sensitivity: 0.434010152284264
Validation specificity: 0.4105960264900662
Validation icbhi_score: 0.4223030893871651
Validation roc_auc: None
Validation avg_accuracy: 0.4187950028900865
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 9 epochs
There is no such attribute
283/283 - 129s - loss: 0.0627 - accuracy: 0.7877 - 129s/epoch - 457ms/step
Epoch 19/80
Validation cm: [[441 232  49  33]
 [215 313  20  26]
 [ 24  11  49  11]
 [ 33  37  42   7]]
Validation normalized_cm: [[0.584 0.307 0.065 0.044]
 [0.375 0.545 0.035 0.045]
 [0.253 0.116 0.516 0.116]
 [0.277 0.311 0.353 0.059]]
Validation acc: 0.5249513933895009
Validation class_accuracies: [0.5841059602649007, 0.5452961672473867, 0.5157894736842106, 0.058823529411764705]
Validation sensitivity: 0.4682741116751269
Validation specificity: 0.5841059602649007
Validation icbhi_score: 0.5261900359700138
Validation roc_auc: None
Validation avg_accuracy: 0.4260037826520657
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 10 epochs
There is no such attribute
283/283 - 123s - loss: 0.0395 - accuracy: 0.7895 - 123s/epoch - 434ms/step
Epoch 20/80
Validation cm: [[430 221  35  69]
 [179 323  20  52]
 [ 17  11  27  40]
 [ 26  29  39  25]]
Validation normalized_cm: [[0.57  0.293 0.046 0.091]
 [0.312 0.563 0.035 0.091]
 [0.179 0.116 0.284 0.421]
 [0.218 0.244 0.328 0.21 ]]
Validation acc: 0.5217109526895658
Validation class_accuracies: [0.5695364238410596, 0.5627177700348432, 0.28421052631578947, 0.21008403361344538]
Validation sensitivity: 0.47588832487309646
Validation specificity: 0.5695364238410596
Validation icbhi_score: 0.5227123743570781
Validation roc_auc: None
Validation avg_accuracy: 0.40663718845128444
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 11 epochs
There is no such attribute
283/283 - 127s - loss: 0.0301 - accuracy: 0.7954 - 127s/epoch - 448ms/step
Epoch 21/80
Validation cm: [[471 201  39  44]
 [219 308  13  34]
 [ 19  16  35  25]
 [ 39  28  38  14]]
Validation normalized_cm: [[0.624 0.266 0.052 0.058]
 [0.382 0.537 0.023 0.059]
 [0.2   0.168 0.368 0.263]
 [0.328 0.235 0.319 0.118]]
Validation acc: 0.5366169799092677
Validation class_accuracies: [0.623841059602649, 0.5365853658536586, 0.3684210526315789, 0.11764705882352941]
Validation sensitivity: 0.4530456852791878
Validation specificity: 0.623841059602649
Validation icbhi_score: 0.5384433724409184
Validation roc_auc: None
Validation avg_accuracy: 0.41162363422785403
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 12 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
283/283 - 126s - loss: 0.0257 - accuracy: 0.7851 - 126s/epoch - 447ms/step
Epoch 22/80
Validation cm: [[201 461  27  66]
 [ 63 449  13  49]
 [  7  24  18  46]
 [ 23  42  32  22]]
Validation normalized_cm: [[0.266 0.611 0.036 0.087]
 [0.11  0.782 0.023 0.085]
 [0.074 0.253 0.189 0.484]
 [0.193 0.353 0.269 0.185]]
Validation acc: 0.4471808165910564
Validation class_accuracies: [0.2662251655629139, 0.7822299651567944, 0.18947368421052632, 0.18487394957983194]
Validation sensitivity: 0.6205583756345178
Validation specificity: 0.2662251655629139
Validation icbhi_score: 0.4433917705987158
Validation roc_auc: None
Validation avg_accuracy: 0.3557006911275166
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 13 epochs
There is no such attribute
283/283 - 127s - loss: 0.0207 - accuracy: 0.7820 - 127s/epoch - 450ms/step
Epoch 23/80
Validation cm: [[388 271  47  49]
 [181 310  28  55]
 [ 18  12  34  31]
 [ 32  28  41  18]]
Validation normalized_cm: [[0.514 0.359 0.062 0.065]
 [0.315 0.54  0.049 0.096]
 [0.189 0.126 0.358 0.326]
 [0.269 0.235 0.345 0.151]]
Validation acc: 0.4860661049902787
Validation class_accuracies: [0.5139072847682119, 0.5400696864111498, 0.35789473684210527, 0.15126050420168066]
Validation sensitivity: 0.4593908629441624
Validation specificity: 0.5139072847682119
Validation icbhi_score: 0.48664907385618716
Validation roc_auc: None
Validation avg_accuracy: 0.3907830530557869
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 14 epochs
There is no such attribute
283/283 - 127s - loss: 0.0205 - accuracy: 0.7744 - 127s/epoch - 448ms/step
Epoch 24/80
Validation cm: [[592  44  70  49]
 [360 131  48  35]
 [ 25   2  46  22]
 [ 39  12  55  13]]
Validation normalized_cm: [[0.784 0.058 0.093 0.065]
 [0.627 0.228 0.084 0.061]
 [0.263 0.021 0.484 0.232]
 [0.328 0.101 0.462 0.109]]
Validation acc: 0.5068049254698639
Validation class_accuracies: [0.7841059602649006, 0.22822299651567945, 0.4842105263157895, 0.1092436974789916]
Validation sensitivity: 0.24111675126903553
Validation specificity: 0.7841059602649006
Validation icbhi_score: 0.512611355766968
Validation roc_auc: None
Validation avg_accuracy: 0.4014457951438403
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 15 epochs
There is no such attribute
283/283 - 128s - loss: 0.0223 - accuracy: 0.7755 - 128s/epoch - 451ms/step
Epoch 25/80
Validation cm: [[566 114  52  23]
 [337 193  25  19]
 [ 32   7  41  15]
 [ 54  19  40   6]]
Validation normalized_cm: [[0.75  0.151 0.069 0.03 ]
 [0.587 0.336 0.044 0.033]
 [0.337 0.074 0.432 0.158]
 [0.454 0.16  0.336 0.05 ]]
Validation acc: 0.5223590408295529
Validation class_accuracies: [0.7496688741721854, 0.3362369337979094, 0.43157894736842106, 0.05042016806722689]
Validation sensitivity: 0.30456852791878175
Validation specificity: 0.7496688741721854
Validation icbhi_score: 0.5271187010454836
Validation roc_auc: None
Validation avg_accuracy: 0.3919762308514357
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
283/283 - 127s - loss: 0.0203 - accuracy: 0.7494 - 127s/epoch - 449ms/step
Epoch 26/80
Validation cm: [[501 167  65  22]
 [254 264  21  35]
 [ 24  10  44  17]
 [ 38  29  43   9]]
Validation normalized_cm: [[0.664 0.221 0.086 0.029]
 [0.443 0.46  0.037 0.061]
 [0.253 0.105 0.463 0.179]
 [0.319 0.244 0.361 0.076]]
Validation acc: 0.5301360985093972
Validation class_accuracies: [0.6635761589403973, 0.45993031358885017, 0.4631578947368421, 0.07563025210084033]
Validation sensitivity: 0.4022842639593909
Validation specificity: 0.6635761589403973
Validation icbhi_score: 0.5329302114498942
Validation roc_auc: None
Validation avg_accuracy: 0.41557365484173253
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 17 epochs
There is no such attribute
283/283 - 127s - loss: 0.0129 - accuracy: 0.7689 - 127s/epoch - 450ms/step
Epoch 27/80
Validation cm: [[441 228  50  36]
 [206 321  17  30]
 [ 23  14  40  18]
 [ 39  32  34  14]]
Validation normalized_cm: [[0.584 0.302 0.066 0.048]
 [0.359 0.559 0.03  0.052]
 [0.242 0.147 0.421 0.189]
 [0.328 0.269 0.286 0.118]]
Validation acc: 0.5288399222294232
Validation class_accuracies: [0.5841059602649007, 0.5592334494773519, 0.42105263157894735, 0.11764705882352941]
Validation sensitivity: 0.47588832487309646
Validation specificity: 0.5841059602649007
Validation icbhi_score: 0.5299971425689985
Validation roc_auc: None
Validation avg_accuracy: 0.42050977503618236
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 18 epochs
There is no such attribute
283/283 - 125s - loss: 0.0152 - accuracy: 0.7727 - 125s/epoch - 442ms/step
Epoch 28/80
Validation cm: [[468 190  36  61]
 [211 300  20  43]
 [ 17  12  33  33]
 [ 33  29  37  20]]
Validation normalized_cm: [[0.62  0.252 0.048 0.081]
 [0.368 0.523 0.035 0.075]
 [0.179 0.126 0.347 0.347]
 [0.277 0.244 0.311 0.168]]
Validation acc: 0.5320803629293583
Validation class_accuracies: [0.6198675496688741, 0.5226480836236934, 0.3473684210526316, 0.16806722689075632]
Validation sensitivity: 0.4479695431472081
Validation specificity: 0.6198675496688741
Validation icbhi_score: 0.5339185464080412
Validation roc_auc: None
Validation avg_accuracy: 0.4144878203089889
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5578839883013413 hasn't increased by 0 in 19 epochs
There is no such attribute
283/283 - 126s - loss: 0.0150 - accuracy: 0.7753 - 126s/epoch - 445ms/step
Epoch 29/80
Validation cm: [[510 166  57  22]
 [243 284  27  20]
 [ 26  11  44  14]
 [ 40  27  45   7]]
Validation normalized_cm: [[0.675 0.22  0.075 0.029]
 [0.423 0.495 0.047 0.035]
 [0.274 0.116 0.463 0.147]
 [0.336 0.227 0.378 0.059]]
Validation acc: 0.5476344782890473
Validation class_accuracies: [0.6754966887417219, 0.49477351916376305, 0.4631578947368421, 0.058823529411764705]
Validation sensitivity: 0.4251269035532995
Validation specificity: 0.6754966887417219
Validation icbhi_score: 0.5503117961475107
Validation roc_auc: None
Validation avg_accuracy: 0.4230629080135229
Validation one_indexed_epoch: 29
The number of epochs since last 1% equals the patience
There is no such attribute
283/283 - 127s - loss: 0.0146 - accuracy: 0.7687 - 127s/epoch - 447ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5578839883013413
Best cm: [[600  66  60  29]
 [289 189  67  29]
 [ 31   5  42  17]
 [ 36  17  44  22]]
Best normalized_cm: [[0.795 0.087 0.079 0.038]
 [0.503 0.329 0.117 0.051]
 [0.326 0.053 0.442 0.179]
 [0.303 0.143 0.37  0.185]]
Best acc: 0.5528191834089436
Best class_accuracies: [0.7947019867549668, 0.32926829268292684, 0.4421052631578947, 0.18487394957983194]
Best sensitivity: 0.3210659898477157
Best specificity: 0.7947019867549668
Best roc_auc: None
Best avg_accuracy: 0.4377373730439051
Best one_indexed_epoch: 9
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6597599983215332, 0.5501362681388855, 0.4841296672821045, 0.43148085474967957, 0.3613549470901489, 0.31605052947998047, 0.27597564458847046, 0.2249772697687149, 0.21506333351135254, 0.19209912419319153, 0.16433273255825043, 0.1301429569721222, 0.13346120715141296, 0.1161019578576088, 0.0975852981209755, 0.10673145949840546, 0.07989691942930222, 0.06266555190086365, 0.039517708122730255, 0.030078645795583725, 0.025735441595315933, 0.02067975327372551, 0.020549967885017395, 0.02232181653380394, 0.02032829262316227, 0.012871144339442253, 0.01524436753243208, 0.015000445768237114, 0.014600563794374466], 'accuracy': [0.5685537457466125, 0.6884121894836426, 0.7450243234634399, 0.7602830529212952, 0.7910216450691223, 0.7978770732879639, 0.8168951869010925, 0.8082706928253174, 0.8140203356742859, 0.8102609515190125, 0.8062804341316223, 0.8020787239074707, 0.8011941909790039, 0.7936753630638123, 0.8016364574432373, 0.7989827394485474, 0.8053958415985107, 0.7877045273780823, 0.7894737124443054, 0.7954444885253906, 0.7850508689880371, 0.7819548845291138, 0.7744361162185669, 0.7755417823791504, 0.7494471669197083, 0.7689075469970703, 0.7726669907569885, 0.7753206491470337, 0.7686864137649536]}
Job dir: ../cache/cw/train162/11
