Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train53
Description: viz
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
4055
1214
817
222
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 4055 0's, 1214 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 817 0's and 222 1's ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/4
Validation cm: [[792  25]
 [204  18]]
Validation normalized_cm: [[0.969 0.031]
 [0.919 0.081]]
Validation acc: 0.7795957651588066
Validation class_accuracies: [0.9694002447980417, 0.08108108108108109]
Validation precision: 0.4186046511627907
Validation recall: 0.08108108108108109
Validation f1: 0.13584905660377358
Validation roc_auc: 0.7760924939627509
Validation avg_accuracy: 0.5252406629395614
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[600  19]
 [ 30   3]] 
Patient Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.909 0.091]] 
Patient Validation accuracy: 
 92.48 
Patient Validation class accuracies: 
 [0.9693053311793215, 0.09090909090909091] 
Saving model...
330/330 - 502s - loss: 0.4893 - accuracy: 0.7586 - 502s/epoch - 2s/step
Epoch 2/4
Validation cm: [[  0 817]
 [  0 222]]
Validation normalized_cm: [[0. 1.]
 [0. 1.]]
Validation acc: 0.2136669874879692
Validation class_accuracies: [0.0, 1.0]
Validation precision: 0.2136669874879692
Validation recall: 1.0
Validation f1: 0.352101506740682
Validation roc_auc: 0.7631303273898132
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5252406629395614 hasn't increased by 0 in 1 epochs
330/330 - 487s - loss: 0.4887 - accuracy: 0.7724 - 487s/epoch - 1s/step
Epoch 3/4
Validation cm: [[357 460]
 [134  88]]
Validation normalized_cm: [[0.437 0.563]
 [0.604 0.396]]
Validation acc: 0.42829643888354185
Validation class_accuracies: [0.4369645042839657, 0.3963963963963964]
Validation precision: 0.16058394160583941
Validation recall: 0.3963963963963964
Validation f1: 0.2285714285714286
Validation roc_auc: 0.38196764696152696
Validation avg_accuracy: 0.4166804503401811
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5252406629395614 hasn't increased by 0 in 2 epochs
330/330 - 488s - loss: 0.4755 - accuracy: 0.7762 - 488s/epoch - 1s/step
Epoch 4/4
Validation cm: [[729  88]
 [163  59]]
Validation normalized_cm: [[0.892 0.108]
 [0.734 0.266]]
Validation acc: 0.7584215591915303
Validation class_accuracies: [0.8922888616891065, 0.26576576576576577]
Validation precision: 0.4013605442176871
Validation recall: 0.26576576576576577
Validation f1: 0.31978319783197834
Validation roc_auc: 0.7476926130536901
Validation avg_accuracy: 0.5790273137274361
Validation one_indexed_epoch: 4
-- New best results were achieved. --
Patient Confusion matrix: 
 [[593  26]
 [ 25   8]] 
Patient Normalized Confusion matrix: 
 [[0.958 0.042]
 [0.758 0.242]] 
Patient Validation accuracy: 
 92.18 
Patient Validation class accuracies: 
 [0.9579967689822294, 0.24242424242424243] 
Saving model...
330/330 - 487s - loss: 0.4618 - accuracy: 0.7793 - 487s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5790273137274361
Best cm: [[729  88]
 [163  59]]
Best normalized_cm: [[0.892 0.108]
 [0.734 0.266]]
Best acc: 0.7584215591915303
Best class_accuracies: [0.8922888616891065, 0.26576576576576577]
Best precision: 0.4013605442176871
Best recall: 0.26576576576576577
Best f1: 0.31978319783197834
Best roc_auc: 0.7476926130536901
Best one_indexed_epoch: 4
Best patient_cm: [[593  26]
 [ 25   8]]
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
Job id is 2.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
3933
1336
832
207
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3933 0's, 1336 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 832 0's and 207 1's ---
Model: "leaf_mixednet_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_1 (Sequential)                       (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/4
Validation cm: [[825   7]
 [204   3]]
Validation normalized_cm: [[0.992 0.008]
 [0.986 0.014]]
Validation acc: 0.7969201154956689
Validation class_accuracies: [0.9915865384615384, 0.014492753623188406]
Validation precision: 0.3
Validation recall: 0.014492753623188406
Validation f1: 0.027649769585253458
Validation roc_auc: 0.6494826505016722
Validation avg_accuracy: 0.5030396460423634
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[573   7]
 [ 69   3]] 
Patient Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.958 0.042]] 
Patient Validation accuracy: 
 88.34 
Patient Validation class accuracies: 
 [0.9879310344827587, 0.041666666666666664] 
Saving model...
330/330 - 491s - loss: 0.5427 - accuracy: 0.7425 - 491s/epoch - 1s/step
Epoch 2/4
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.4139173402081011
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5030396460423634 hasn't increased by 0 in 1 epochs
330/330 - 484s - loss: 0.5371 - accuracy: 0.7464 - 484s/epoch - 1s/step
Epoch 3/4
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.6694972826086956
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5030396460423634 hasn't increased by 0 in 2 epochs
330/330 - 486s - loss: 0.5415 - accuracy: 0.7455 - 486s/epoch - 1s/step
Epoch 4/4
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.51642918524712
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5030396460423634 hasn't increased by 0 in 3 epochs
330/330 - 485s - loss: 0.5091 - accuracy: 0.7548 - 485s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5030396460423634
Best cm: [[825   7]
 [204   3]]
Best normalized_cm: [[0.992 0.008]
 [0.986 0.014]]
Best acc: 0.7969201154956689
Best class_accuracies: [0.9915865384615384, 0.014492753623188406]
Best precision: 0.3
Best recall: 0.014492753623188406
Best f1: 0.027649769585253458
Best roc_auc: 0.6494826505016722
Best one_indexed_epoch: 1
Best patient_cm: [[573   7]
 [ 69   3]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
