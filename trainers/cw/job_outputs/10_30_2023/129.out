Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train129
Description:  debugging, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.15, 4 one hot encoder, softmax, oversampling, no spectral loss
-----------------------
Job id is 1.
Job dir: ../cache/cw/train129/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_bis"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 1)                          4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 4)                                   6193348          
                                                                                                              
==============================================================================================================
Total params: 6,202,346
Trainable params: 6,160,840
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 153s - loss: 1.6651 - accuracy: 0.3937 - 153s/epoch - 2s/step
Epoch 2/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 1.2002 - accuracy: 0.4500 - 143s/epoch - 2s/step
Epoch 3/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 1.1521 - accuracy: 0.4822 - 140s/epoch - 2s/step
Epoch 4/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 1.0841 - accuracy: 0.5158 - 141s/epoch - 2s/step
Epoch 5/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 4 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.9955 - accuracy: 0.5574 - 141s/epoch - 2s/step
Epoch 6/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 138s - loss: 0.9171 - accuracy: 0.5965 - 138s/epoch - 2s/step
Epoch 7/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 7
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 6 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 139s - loss: 0.7956 - accuracy: 0.6648 - 139s/epoch - 2s/step
Epoch 8/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 7 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.7367 - accuracy: 0.6880 - 140s/epoch - 2s/step
Epoch 9/60
Validation cm: [[331 560   0   0]
 [344 245   0   0]
 [ 26  54   0   0]
 [ 85  71   0   0]]
Validation normalized_cm: [[0.371 0.629 0.    0.   ]
 [0.584 0.416 0.    0.   ]
 [0.325 0.675 0.    0.   ]
 [0.545 0.455 0.    0.   ]]
Validation acc: 0.3356643356643357
Validation class_accuracies: [0.37149270482603813, 0.4159592529711375, 0.0, 0.0]
Validation sensitivity: 0.296969696969697
Validation specificity: 0.37149270482603813
Validation icbhi_score: 0.33423120089786756
Validation roc_auc: None
Validation avg_accuracy: 0.19686298944929392
Validation one_indexed_epoch: 9
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 8 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.7008 - accuracy: 0.7094 - 141s/epoch - 2s/step
Epoch 10/60
Validation cm: [[688 200   2   1]
 [509  79   1   0]
 [ 63  13   1   3]
 [119  27   5   5]]
Validation normalized_cm: [[0.772 0.224 0.002 0.001]
 [0.864 0.134 0.002 0.   ]
 [0.787 0.163 0.013 0.037]
 [0.763 0.173 0.032 0.032]]
Validation acc: 0.45046620046620045
Validation class_accuracies: [0.7721661054994389, 0.13412563667232597, 0.0125, 0.03205128205128205]
Validation sensitivity: 0.10303030303030303
Validation specificity: 0.7721661054994389
Validation icbhi_score: 0.43759820426487095
Validation roc_auc: None
Validation avg_accuracy: 0.23771075605576172
Validation one_indexed_epoch: 10
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 138s - loss: 0.6647 - accuracy: 0.7278 - 138s/epoch - 2s/step
Epoch 11/60
Validation cm: [[222 662   6   1]
 [ 58 527   4   0]
 [ 29  46   4   1]
 [ 15 137   1   3]]
Validation normalized_cm: [[0.249 0.743 0.007 0.001]
 [0.098 0.895 0.007 0.   ]
 [0.362 0.575 0.05  0.013]
 [0.096 0.878 0.006 0.019]]
Validation acc: 0.4405594405594406
Validation class_accuracies: [0.24915824915824916, 0.8947368421052632, 0.05, 0.019230769230769232]
Validation sensitivity: 0.6472727272727272
Validation specificity: 0.24915824915824916
Validation icbhi_score: 0.4482154882154882
Validation roc_auc: None
Validation avg_accuracy: 0.3032814651235704
Validation one_indexed_epoch: 11
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.6331 - accuracy: 0.7388 - 140s/epoch - 2s/step
Epoch 12/60
Validation cm: [[827   6  58   0]
 [585   0   4   0]
 [ 69   0  11   0]
 [128   0  28   0]]
Validation normalized_cm: [[0.928 0.007 0.065 0.   ]
 [0.993 0.    0.007 0.   ]
 [0.863 0.    0.138 0.   ]
 [0.821 0.    0.179 0.   ]]
Validation acc: 0.48834498834498835
Validation class_accuracies: [0.9281705948372615, 0.0, 0.1375, 0.0]
Validation sensitivity: 0.013333333333333334
Validation specificity: 0.9281705948372615
Validation icbhi_score: 0.4707519640852974
Validation roc_auc: None
Validation avg_accuracy: 0.2664176487093154
Validation one_indexed_epoch: 12
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.5939 - accuracy: 0.7576 - 140s/epoch - 2s/step
Epoch 13/60
Validation cm: [[728  68  92   3]
 [535  19  28   7]
 [ 51   7  22   0]
 [ 99  10  45   2]]
Validation normalized_cm: [[0.817 0.076 0.103 0.003]
 [0.908 0.032 0.048 0.012]
 [0.637 0.087 0.275 0.   ]
 [0.635 0.064 0.288 0.013]]
Validation acc: 0.4493006993006993
Validation class_accuracies: [0.8170594837261503, 0.03225806451612903, 0.275, 0.01282051282051282]
Validation sensitivity: 0.052121212121212124
Validation specificity: 0.8170594837261503
Validation icbhi_score: 0.43459034792368123
Validation roc_auc: None
Validation avg_accuracy: 0.28428451526569803
Validation one_indexed_epoch: 13
The validation tracker metric at 0.4707519640852974 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.5513 - accuracy: 0.7806 - 140s/epoch - 2s/step
Epoch 14/60
Validation cm: [[267   0 573  51]
 [221   2 294  72]
 [ 12   0  66   2]
 [ 19   0 129   8]]
Validation normalized_cm: [[0.3   0.    0.643 0.057]
 [0.375 0.003 0.499 0.122]
 [0.15  0.    0.825 0.025]
 [0.122 0.    0.827 0.051]]
Validation acc: 0.1998834498834499
Validation class_accuracies: [0.2996632996632997, 0.003395585738539898, 0.825, 0.05128205128205128]
Validation sensitivity: 0.09212121212121212
Validation specificity: 0.2996632996632997
Validation icbhi_score: 0.1958922558922559
Validation roc_auc: None
Validation avg_accuracy: 0.29483523417097274
Validation one_indexed_epoch: 14
The validation tracker metric at 0.4707519640852974 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 138s - loss: 0.5206 - accuracy: 0.7891 - 138s/epoch - 2s/step
Epoch 15/60
Validation cm: [[294 434  29 134]
 [190 355  18  26]
 [ 11  34   6  29]
 [ 29  60   5  62]]
Validation normalized_cm: [[0.33  0.487 0.033 0.15 ]
 [0.323 0.603 0.031 0.044]
 [0.138 0.425 0.075 0.362]
 [0.186 0.385 0.032 0.397]]
Validation acc: 0.4178321678321678
Validation class_accuracies: [0.32996632996632996, 0.6027164685908319, 0.075, 0.3974358974358974]
Validation sensitivity: 0.5127272727272727
Validation specificity: 0.32996632996632996
Validation icbhi_score: 0.42134680134680136
Validation roc_auc: None
Validation avg_accuracy: 0.3512796739982648
Validation one_indexed_epoch: 15
The validation tracker metric at 0.4707519640852974 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.4865 - accuracy: 0.8043 - 142s/epoch - 2s/step
Epoch 16/60
Validation cm: [[828   9  44  10]
 [540  19  23   7]
 [ 55   3  20   2]
 [114   1  38   3]]
Validation normalized_cm: [[0.929 0.01  0.049 0.011]
 [0.917 0.032 0.039 0.012]
 [0.688 0.037 0.25  0.025]
 [0.731 0.006 0.244 0.019]]
Validation acc: 0.506993006993007
Validation class_accuracies: [0.9292929292929293, 0.03225806451612903, 0.25, 0.019230769230769232]
Validation sensitivity: 0.05090909090909091
Validation specificity: 0.9292929292929293
Validation icbhi_score: 0.4901010101010101
Validation roc_auc: None
Validation avg_accuracy: 0.30769544075995686
Validation one_indexed_epoch: 16
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.4373 - accuracy: 0.8257 - 143s/epoch - 2s/step
Epoch 17/60
Validation cm: [[660 148  17  66]
 [391 180   9   9]
 [ 53   8  13   6]
 [105  22  18  11]]
Validation normalized_cm: [[0.741 0.166 0.019 0.074]
 [0.664 0.306 0.015 0.015]
 [0.662 0.1   0.163 0.075]
 [0.673 0.141 0.115 0.071]]
Validation acc: 0.5034965034965035
Validation class_accuracies: [0.7407407407407407, 0.30560271646859083, 0.1625, 0.07051282051282051]
Validation sensitivity: 0.24727272727272728
Validation specificity: 0.7407407407407407
Validation icbhi_score: 0.494006734006734
Validation roc_auc: None
Validation avg_accuracy: 0.319839069430538
Validation one_indexed_epoch: 17
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.4271 - accuracy: 0.8356 - 142s/epoch - 2s/step
Epoch 18/60
Validation cm: [[699  62  78  52]
 [536  14  20  19]
 [ 46   3  23   8]
 [100   4  32  20]]
Validation normalized_cm: [[0.785 0.07  0.088 0.058]
 [0.91  0.024 0.034 0.032]
 [0.575 0.037 0.287 0.1  ]
 [0.641 0.026 0.205 0.128]]
Validation acc: 0.4405594405594406
Validation class_accuracies: [0.7845117845117845, 0.023769100169779286, 0.2875, 0.1282051282051282]
Validation sensitivity: 0.06909090909090909
Validation specificity: 0.7845117845117845
Validation icbhi_score: 0.4268013468013468
Validation roc_auc: None
Validation avg_accuracy: 0.305996503221673
Validation one_indexed_epoch: 18
The validation tracker metric at 0.494006734006734 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.3965 - accuracy: 0.8388 - 140s/epoch - 2s/step
Epoch 19/60
Validation cm: [[236 435  35 185]
 [141 356   9  83]
 [  5  29   6  40]
 [ 11  61   9  75]]
Validation normalized_cm: [[0.265 0.488 0.039 0.208]
 [0.239 0.604 0.015 0.141]
 [0.062 0.362 0.075 0.5  ]
 [0.071 0.391 0.058 0.481]]
Validation acc: 0.3921911421911422
Validation class_accuracies: [0.2648709315375982, 0.6044142614601019, 0.075, 0.4807692307692308]
Validation sensitivity: 0.5296969696969697
Validation specificity: 0.2648709315375982
Validation icbhi_score: 0.39728395061728394
Validation roc_auc: None
Validation avg_accuracy: 0.35626360594173273
Validation one_indexed_epoch: 19
The validation tracker metric at 0.494006734006734 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.3892 - accuracy: 0.8446 - 148s/epoch - 2s/step
Epoch 20/60
Validation cm: [[423 141 201 126]
 [279 116  64 130]
 [ 12  10  47  11]
 [ 41  11  71  33]]
Validation normalized_cm: [[0.475 0.158 0.226 0.141]
 [0.474 0.197 0.109 0.221]
 [0.15  0.125 0.588 0.138]
 [0.263 0.071 0.455 0.212]]
Validation acc: 0.36072261072261075
Validation class_accuracies: [0.47474747474747475, 0.1969439728353141, 0.5875, 0.21153846153846154]
Validation sensitivity: 0.23757575757575758
Validation specificity: 0.47474747474747475
Validation icbhi_score: 0.3561616161616162
Validation roc_auc: None
Validation avg_accuracy: 0.3676824772803126
Validation one_indexed_epoch: 20
The validation tracker metric at 0.494006734006734 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.3482 - accuracy: 0.8666 - 141s/epoch - 2s/step
Epoch 21/60
Validation cm: [[467 358  13  53]
 [341 221   7  20]
 [ 41  26   2  11]
 [ 64  63   7  22]]
Validation normalized_cm: [[0.524 0.402 0.015 0.059]
 [0.579 0.375 0.012 0.034]
 [0.512 0.325 0.025 0.138]
 [0.41  0.404 0.045 0.141]]
Validation acc: 0.4149184149184149
Validation class_accuracies: [0.5241301907968574, 0.37521222410865873, 0.025, 0.14102564102564102]
Validation sensitivity: 0.296969696969697
Validation specificity: 0.5241301907968574
Validation icbhi_score: 0.4105499438832772
Validation roc_auc: None
Validation avg_accuracy: 0.2663420139827893
Validation one_indexed_epoch: 21
The validation tracker metric at 0.494006734006734 hasn't increased by 0 in 4 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.3388 - accuracy: 0.8676 - 146s/epoch - 2s/step
Epoch 22/60
Validation cm: [[746   0 145   0]
 [540   0  49   0]
 [ 52   0  28   0]
 [118   0  38   0]]
Validation normalized_cm: [[0.837 0.    0.163 0.   ]
 [0.917 0.    0.083 0.   ]
 [0.65  0.    0.35  0.   ]
 [0.756 0.    0.244 0.   ]]
Validation acc: 0.45104895104895104
Validation class_accuracies: [0.8372615039281706, 0.0, 0.35, 0.0]
Validation sensitivity: 0.03393939393939394
Validation specificity: 0.8372615039281706
Validation icbhi_score: 0.43560044893378225
Validation roc_auc: None
Validation avg_accuracy: 0.29681537598204266
Validation one_indexed_epoch: 22
The validation tracker metric at 0.494006734006734 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.3009 - accuracy: 0.8853 - 141s/epoch - 2s/step
Epoch 23/60
Validation cm: [[159 304 307 121]
 [ 76 338  82  93]
 [  6  16  32  26]
 [  8  38  38  72]]
Validation normalized_cm: [[0.178 0.341 0.345 0.136]
 [0.129 0.574 0.139 0.158]
 [0.075 0.2   0.4   0.325]
 [0.051 0.244 0.244 0.462]]
Validation acc: 0.3502331002331002
Validation class_accuracies: [0.17845117845117844, 0.5738539898132428, 0.4, 0.46153846153846156]
Validation sensitivity: 0.5357575757575758
Validation specificity: 0.17845117845117844
Validation icbhi_score: 0.3571043771043771
Validation roc_auc: None
Validation avg_accuracy: 0.4034609074507207
Validation one_indexed_epoch: 23
The validation tracker metric at 0.494006734006734 hasn't increased by 0 in 6 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.2100 - accuracy: 0.9239 - 146s/epoch - 2s/step
Epoch 24/60
Validation cm: [[786  45   6  54]
 [428 142   4  15]
 [ 62   4   7   7]
 [ 91  26  17  22]]
Validation normalized_cm: [[0.882 0.051 0.007 0.061]
 [0.727 0.241 0.007 0.025]
 [0.775 0.05  0.087 0.087]
 [0.583 0.167 0.109 0.141]]
Validation acc: 0.5576923076923077
Validation class_accuracies: [0.8821548821548821, 0.24108658743633277, 0.0875, 0.14102564102564102]
Validation sensitivity: 0.20727272727272728
Validation specificity: 0.8821548821548821
Validation icbhi_score: 0.5447138047138047
Validation roc_auc: None
Validation avg_accuracy: 0.33794177765421396
Validation one_indexed_epoch: 24
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.1628 - accuracy: 0.9407 - 140s/epoch - 2s/step
Epoch 25/60
Validation cm: [[647 177  61   6]
 [356 226   6   1]
 [ 44  19  17   0]
 [ 79  39  23  15]]
Validation normalized_cm: [[0.726 0.199 0.068 0.007]
 [0.604 0.384 0.01  0.002]
 [0.55  0.237 0.212 0.   ]
 [0.506 0.25  0.147 0.096]]
Validation acc: 0.5273892773892774
Validation class_accuracies: [0.7261503928170595, 0.3837011884550085, 0.2125, 0.09615384615384616]
Validation sensitivity: 0.31272727272727274
Validation specificity: 0.7261503928170595
Validation icbhi_score: 0.5194388327721662
Validation roc_auc: None
Validation avg_accuracy: 0.35462635685647853
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.1559 - accuracy: 0.9437 - 144s/epoch - 2s/step
Epoch 26/60
Validation cm: [[562 272  20  37]
 [269 302   4  14]
 [ 45  21   5   9]
 [ 49  69   6  32]]
Validation normalized_cm: [[0.631 0.305 0.022 0.042]
 [0.457 0.513 0.007 0.024]
 [0.562 0.263 0.062 0.113]
 [0.314 0.442 0.038 0.205]]
Validation acc: 0.5250582750582751
Validation class_accuracies: [0.6307519640852974, 0.5127334465195246, 0.0625, 0.20512820512820512]
Validation sensitivity: 0.4109090909090909
Validation specificity: 0.6307519640852974
Validation icbhi_score: 0.5208305274971942
Validation roc_auc: None
Validation avg_accuracy: 0.35277840393325677
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.1636 - accuracy: 0.9356 - 143s/epoch - 2s/step
Epoch 27/60
Validation cm: [[487 372  16  16]
 [295 290   3   1]
 [ 45  23   5   7]
 [ 82  43  16  15]]
Validation normalized_cm: [[0.547 0.418 0.018 0.018]
 [0.501 0.492 0.005 0.002]
 [0.562 0.287 0.062 0.087]
 [0.526 0.276 0.103 0.096]]
Validation acc: 0.46445221445221446
Validation class_accuracies: [0.5465768799102132, 0.4923599320882852, 0.0625, 0.09615384615384616]
Validation sensitivity: 0.37575757575757573
Validation specificity: 0.5465768799102132
Validation icbhi_score: 0.46116722783389447
Validation roc_auc: None
Validation avg_accuracy: 0.29939766453808614
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.1339 - accuracy: 0.9496 - 142s/epoch - 2s/step
Epoch 28/60
Validation cm: [[736  67  59  29]
 [377 174  26  12]
 [ 50   7  14   9]
 [ 72  27  31  26]]
Validation normalized_cm: [[0.826 0.075 0.066 0.033]
 [0.64  0.295 0.044 0.02 ]
 [0.625 0.087 0.175 0.113]
 [0.462 0.173 0.199 0.167]]
Validation acc: 0.5536130536130536
Validation class_accuracies: [0.8260381593714927, 0.29541595925297115, 0.175, 0.16666666666666666]
Validation sensitivity: 0.2593939393939394
Validation specificity: 0.8260381593714927
Validation icbhi_score: 0.5427160493827161
Validation roc_auc: None
Validation avg_accuracy: 0.3657801963227827
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 4 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.1232 - accuracy: 0.9540 - 144s/epoch - 2s/step
Epoch 29/60
Validation cm: [[596 204  34  57]
 [285 281   5  18]
 [ 35  21  11  13]
 [ 62  50   9  35]]
Validation normalized_cm: [[0.669 0.229 0.038 0.064]
 [0.484 0.477 0.008 0.031]
 [0.438 0.263 0.138 0.163]
 [0.397 0.321 0.058 0.224]]
Validation acc: 0.5378787878787878
Validation class_accuracies: [0.6689113355780022, 0.4770797962648557, 0.1375, 0.22435897435897437]
Validation sensitivity: 0.39636363636363636
Validation specificity: 0.6689113355780022
Validation icbhi_score: 0.5326374859708193
Validation roc_auc: None
Validation avg_accuracy: 0.3769625265504581
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0001250000059371814
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.1163 - accuracy: 0.9577 - 141s/epoch - 2s/step
Epoch 30/60
Validation cm: [[416 414  33  28]
 [142 425   4  18]
 [ 25  39   8   8]
 [ 28  91  15  22]]
Validation normalized_cm: [[0.467 0.465 0.037 0.031]
 [0.241 0.722 0.007 0.031]
 [0.312 0.487 0.1   0.1  ]
 [0.179 0.583 0.096 0.141]]
Validation acc: 0.5075757575757576
Validation class_accuracies: [0.4668911335578002, 0.7215619694397284, 0.1, 0.14102564102564102]
Validation sensitivity: 0.5515151515151515
Validation specificity: 0.4668911335578002
Validation icbhi_score: 0.5092031425364758
Validation roc_auc: None
Validation avg_accuracy: 0.35736968600579244
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 6 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 149s - loss: 0.0700 - accuracy: 0.9763 - 149s/epoch - 2s/step
Epoch 31/60
Validation cm: [[497 304  60  30]
 [227 329  21  12]
 [ 25  34  16   5]
 [ 42  68  33  13]]
Validation normalized_cm: [[0.558 0.341 0.067 0.034]
 [0.385 0.559 0.036 0.02 ]
 [0.312 0.425 0.2   0.062]
 [0.269 0.436 0.212 0.083]]
Validation acc: 0.4982517482517482
Validation class_accuracies: [0.5578002244668911, 0.5585738539898133, 0.2, 0.08333333333333333]
Validation sensitivity: 0.43393939393939396
Validation specificity: 0.5578002244668911
Validation icbhi_score: 0.49586980920314255
Validation roc_auc: None
Validation avg_accuracy: 0.3499268529475094
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.0532 - accuracy: 0.9841 - 142s/epoch - 2s/step
Epoch 32/60
Validation cm: [[439 349  73  30]
 [221 338  15  15]
 [ 26  29  18   7]
 [ 36  62  29  29]]
Validation normalized_cm: [[0.493 0.392 0.082 0.034]
 [0.375 0.574 0.025 0.025]
 [0.325 0.362 0.225 0.087]
 [0.231 0.397 0.186 0.186]]
Validation acc: 0.4801864801864802
Validation class_accuracies: [0.49270482603815935, 0.5738539898132428, 0.225, 0.1858974358974359]
Validation sensitivity: 0.4666666666666667
Validation specificity: 0.49270482603815935
Validation icbhi_score: 0.479685746352413
Validation roc_auc: None
Validation avg_accuracy: 0.3693640629372095
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 8 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.0413 - accuracy: 0.9857 - 148s/epoch - 2s/step
Epoch 33/60
Validation cm: [[522 302  24  43]
 [224 343   3  19]
 [ 40  27   9   4]
 [ 49  69  20  18]]
Validation normalized_cm: [[0.586 0.339 0.027 0.048]
 [0.38  0.582 0.005 0.032]
 [0.5   0.338 0.113 0.05 ]
 [0.314 0.442 0.128 0.115]]
Validation acc: 0.5198135198135199
Validation class_accuracies: [0.5858585858585859, 0.5823429541595926, 0.1125, 0.11538461538461539]
Validation sensitivity: 0.4484848484848485
Validation specificity: 0.5858585858585859
Validation icbhi_score: 0.5171717171717172
Validation roc_auc: None
Validation avg_accuracy: 0.3490215388506985
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 9 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.0569 - accuracy: 0.9791 - 142s/epoch - 2s/step
Epoch 34/60
Validation cm: [[534 265  63  29]
 [268 293  13  15]
 [ 38  17  15  10]
 [ 57  40  33  26]]
Validation normalized_cm: [[0.599 0.297 0.071 0.033]
 [0.455 0.497 0.022 0.025]
 [0.475 0.212 0.188 0.125]
 [0.365 0.256 0.212 0.167]]
Validation acc: 0.5058275058275058
Validation class_accuracies: [0.5993265993265994, 0.49745331069609505, 0.1875, 0.16666666666666666]
Validation sensitivity: 0.40484848484848485
Validation specificity: 0.5993265993265994
Validation icbhi_score: 0.5020875420875421
Validation roc_auc: None
Validation avg_accuracy: 0.3627366441723403
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 6.25000029685907e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 149s - loss: 0.0412 - accuracy: 0.9851 - 149s/epoch - 2s/step
Epoch 35/60
Validation cm: [[582 242  48  19]
 [286 287   6  10]
 [ 41  23  11   5]
 [ 59  48  30  19]]
Validation normalized_cm: [[0.653 0.272 0.054 0.021]
 [0.486 0.487 0.01  0.017]
 [0.512 0.287 0.138 0.062]
 [0.378 0.308 0.192 0.122]]
Validation acc: 0.5238927738927739
Validation class_accuracies: [0.6531986531986532, 0.4872665534804754, 0.1375, 0.12179487179487179]
Validation sensitivity: 0.3842424242424242
Validation specificity: 0.6531986531986532
Validation icbhi_score: 0.5187205387205387
Validation roc_auc: None
Validation avg_accuracy: 0.3499400196185001
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 11 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.0253 - accuracy: 0.9922 - 142s/epoch - 2s/step
Epoch 36/60
Validation cm: [[546 265  61  19]
 [250 316  13  10]
 [ 41  23  14   2]
 [ 54  52  32  18]]
Validation normalized_cm: [[0.613 0.297 0.068 0.021]
 [0.424 0.537 0.022 0.017]
 [0.512 0.287 0.175 0.025]
 [0.346 0.333 0.205 0.115]]
Validation acc: 0.5209790209790209
Validation class_accuracies: [0.6127946127946128, 0.5365025466893039, 0.175, 0.11538461538461539]
Validation sensitivity: 0.4218181818181818
Validation specificity: 0.6127946127946128
Validation icbhi_score: 0.5173063973063973
Validation roc_auc: None
Validation avg_accuracy: 0.359920443717133
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 12 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 145s - loss: 0.0205 - accuracy: 0.9940 - 145s/epoch - 2s/step
Epoch 37/60
Validation cm: [[580 248  40  23]
 [279 292   3  15]
 [ 47  20   9   4]
 [ 67  43  24  22]]
Validation normalized_cm: [[0.651 0.278 0.045 0.026]
 [0.474 0.496 0.005 0.025]
 [0.588 0.25  0.113 0.05 ]
 [0.429 0.276 0.154 0.141]]
Validation acc: 0.5262237762237763
Validation class_accuracies: [0.6509539842873177, 0.49575551782682514, 0.1125, 0.14102564102564102]
Validation sensitivity: 0.39151515151515154
Validation specificity: 0.6509539842873177
Validation icbhi_score: 0.5212345679012346
Validation roc_auc: None
Validation avg_accuracy: 0.3500587857849459
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 13 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.0200 - accuracy: 0.9938 - 144s/epoch - 2s/step
Epoch 38/60
Validation cm: [[639 188  41  23]
 [341 232   2  14]
 [ 49  17   8   6]
 [ 69  43  20  24]]
Validation normalized_cm: [[0.717 0.211 0.046 0.026]
 [0.579 0.394 0.003 0.024]
 [0.613 0.212 0.1   0.075]
 [0.442 0.276 0.128 0.154]]
Validation acc: 0.5262237762237763
Validation class_accuracies: [0.7171717171717171, 0.3938879456706282, 0.1, 0.15384615384615385]
Validation sensitivity: 0.32
Validation specificity: 0.7171717171717171
Validation icbhi_score: 0.5185858585858586
Validation roc_auc: None
Validation avg_accuracy: 0.3412264541721248
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 14 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 145s - loss: 0.0121 - accuracy: 0.9970 - 145s/epoch - 2s/step
Epoch 39/60
Validation cm: [[512 316  25  38]
 [238 331   2  18]
 [ 37  26   5  12]
 [ 48  66  16  26]]
Validation normalized_cm: [[0.575 0.355 0.028 0.043]
 [0.404 0.562 0.003 0.031]
 [0.463 0.325 0.062 0.15 ]
 [0.308 0.423 0.103 0.167]]
Validation acc: 0.5093240093240093
Validation class_accuracies: [0.574635241301908, 0.5619694397283531, 0.0625, 0.16666666666666666]
Validation sensitivity: 0.4387878787878788
Validation specificity: 0.574635241301908
Validation icbhi_score: 0.5067115600448934
Validation roc_auc: None
Validation avg_accuracy: 0.341442836924232
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 3.125000148429535e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 145s - loss: 0.0120 - accuracy: 0.9961 - 145s/epoch - 2s/step
Epoch 40/60
Validation cm: [[600 227  32  32]
 [307 259   5  18]
 [ 41  21   7  11]
 [ 62  45  19  30]]
Validation normalized_cm: [[0.673 0.255 0.036 0.036]
 [0.521 0.44  0.008 0.031]
 [0.512 0.263 0.087 0.138]
 [0.397 0.288 0.122 0.192]]
Validation acc: 0.5221445221445221
Validation class_accuracies: [0.6734006734006734, 0.4397283531409168, 0.0875, 0.19230769230769232]
Validation sensitivity: 0.35878787878787877
Validation specificity: 0.6734006734006734
Validation icbhi_score: 0.5160942760942762
Validation roc_auc: None
Validation avg_accuracy: 0.3482341797123206
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 16 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.0088 - accuracy: 0.9982 - 143s/epoch - 2s/step
Epoch 41/60
Validation cm: [[530 270  54  37]
 [268 293  10  18]
 [ 35  21  13  11]
 [ 50  51  25  30]]
Validation normalized_cm: [[0.595 0.303 0.061 0.042]
 [0.455 0.497 0.017 0.031]
 [0.438 0.263 0.163 0.138]
 [0.321 0.327 0.16  0.192]]
Validation acc: 0.5046620046620046
Validation class_accuracies: [0.5948372615039281, 0.49745331069609505, 0.1625, 0.19230769230769232]
Validation sensitivity: 0.4072727272727273
Validation specificity: 0.5948372615039281
Validation icbhi_score: 0.5010549943883277
Validation roc_auc: None
Validation avg_accuracy: 0.3617745661269289
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 17 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.0134 - accuracy: 0.9968 - 147s/epoch - 2s/step
Epoch 42/60
Validation cm: [[536 268  50  37]
 [277 290   4  18]
 [ 38  21  10  11]
 [ 50  55  25  26]]
Validation normalized_cm: [[0.602 0.301 0.056 0.042]
 [0.47  0.492 0.007 0.031]
 [0.475 0.263 0.125 0.138]
 [0.321 0.353 0.16  0.167]]
Validation acc: 0.5023310023310024
Validation class_accuracies: [0.6015712682379349, 0.4923599320882852, 0.125, 0.16666666666666666]
Validation sensitivity: 0.39515151515151514
Validation specificity: 0.6015712682379349
Validation icbhi_score: 0.49836139169472504
Validation roc_auc: None
Validation avg_accuracy: 0.3463994667482217
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 18 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.0087 - accuracy: 0.9977 - 143s/epoch - 2s/step
Epoch 43/60
Validation cm: [[507 287  56  41]
 [251 315   5  18]
 [ 37  20  12  11]
 [ 47  53  24  32]]
Validation normalized_cm: [[0.569 0.322 0.063 0.046]
 [0.426 0.535 0.008 0.031]
 [0.463 0.25  0.15  0.138]
 [0.301 0.34  0.154 0.205]]
Validation acc: 0.5046620046620046
Validation class_accuracies: [0.569023569023569, 0.534804753820034, 0.15, 0.20512820512820512]
Validation sensitivity: 0.4351515151515152
Validation specificity: 0.569023569023569
Validation icbhi_score: 0.5020875420875421
Validation roc_auc: None
Validation avg_accuracy: 0.364739131992952
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 19 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 149s - loss: 0.0090 - accuracy: 0.9977 - 149s/epoch - 2s/step
Epoch 44/60
Validation cm: [[531 265  56  39]
 [263 295  11  20]
 [ 38  18  14  10]
 [ 53  47  24  32]]
Validation normalized_cm: [[0.596 0.297 0.063 0.044]
 [0.447 0.501 0.019 0.034]
 [0.475 0.225 0.175 0.125]
 [0.34  0.301 0.154 0.205]]
Validation acc: 0.5081585081585082
Validation class_accuracies: [0.5959595959595959, 0.5008488964346349, 0.175, 0.20512820512820512]
Validation sensitivity: 0.41333333333333333
Validation specificity: 0.5959595959595959
Validation icbhi_score: 0.5046464646464646
Validation roc_auc: None
Validation avg_accuracy: 0.369234174380609
Validation one_indexed_epoch: 44
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 1.5625000742147677e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.0084 - accuracy: 0.9982 - 144s/epoch - 2s/step
Epoch 45/60
Validation cm: [[532 266  56  37]
 [276 288   8  17]
 [ 38  19  12  11]
 [ 52  50  24  30]]
Validation normalized_cm: [[0.597 0.299 0.063 0.042]
 [0.469 0.489 0.014 0.029]
 [0.475 0.237 0.15  0.138]
 [0.333 0.321 0.154 0.192]]
Validation acc: 0.5023310023310024
Validation class_accuracies: [0.5970819304152637, 0.48896434634974534, 0.15, 0.19230769230769232]
Validation sensitivity: 0.4
Validation specificity: 0.5970819304152637
Validation icbhi_score: 0.49854096520763186
Validation roc_auc: None
Validation avg_accuracy: 0.3570884922681753
Validation one_indexed_epoch: 45
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 21 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.0044 - accuracy: 0.9993 - 148s/epoch - 2s/step
Epoch 46/60
Validation cm: [[550 255  45  41]
 [275 289   6  19]
 [ 42  20   8  10]
 [ 53  47  23  33]]
Validation normalized_cm: [[0.617 0.286 0.051 0.046]
 [0.467 0.491 0.01  0.032]
 [0.525 0.25  0.1   0.125]
 [0.34  0.301 0.147 0.212]]
Validation acc: 0.5128205128205128
Validation class_accuracies: [0.6172839506172839, 0.4906621392190153, 0.1, 0.21153846153846154]
Validation sensitivity: 0.4
Validation specificity: 0.6172839506172839
Validation icbhi_score: 0.508641975308642
Validation roc_auc: None
Validation avg_accuracy: 0.3548711378436902
Validation one_indexed_epoch: 46
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 22 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.0062 - accuracy: 0.9986 - 141s/epoch - 2s/step
Epoch 47/60
Validation cm: [[613 205  28  45]
 [299 264   3  23]
 [ 45  18   5  12]
 [ 62  41  17  36]]
Validation normalized_cm: [[0.688 0.23  0.031 0.051]
 [0.508 0.448 0.005 0.039]
 [0.562 0.225 0.062 0.15 ]
 [0.397 0.263 0.109 0.231]]
Validation acc: 0.534965034965035
Validation class_accuracies: [0.6879910213243546, 0.44821731748726656, 0.0625, 0.23076923076923078]
Validation sensitivity: 0.3696969696969697
Validation specificity: 0.6879910213243546
Validation icbhi_score: 0.5288439955106622
Validation roc_auc: None
Validation avg_accuracy: 0.35736939239521304
Validation one_indexed_epoch: 47
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 23 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.0056 - accuracy: 0.9979 - 147s/epoch - 2s/step
Epoch 48/60
Validation cm: [[603 209  41  38]
 [304 261   5  19]
 [ 46  17   8   9]
 [ 63  38  22  33]]
Validation normalized_cm: [[0.677 0.235 0.046 0.043]
 [0.516 0.443 0.008 0.032]
 [0.575 0.212 0.1   0.113]
 [0.404 0.244 0.141 0.212]]
Validation acc: 0.5273892773892774
Validation class_accuracies: [0.6767676767676768, 0.4431239388794567, 0.1, 0.21153846153846154]
Validation sensitivity: 0.3660606060606061
Validation specificity: 0.6767676767676768
Validation icbhi_score: 0.5214141414141414
Validation roc_auc: None
Validation avg_accuracy: 0.35785751929639875
Validation one_indexed_epoch: 48
The validation tracker metric at 0.5447138047138047 hasn't increased by 0 in 24 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.0073 - accuracy: 0.9984 - 143s/epoch - 2s/step
Epoch 49/60
Validation cm: [[609 205  36  41]
 [305 258   4  22]
 [ 46  17   7  10]
 [ 60  43  21  32]]
Validation normalized_cm: [[0.684 0.23  0.04  0.046]
 [0.518 0.438 0.007 0.037]
 [0.575 0.212 0.087 0.125]
 [0.385 0.276 0.135 0.205]]
Validation acc: 0.527972027972028
Validation class_accuracies: [0.6835016835016835, 0.4380305602716469, 0.0875, 0.20512820512820512]
Validation sensitivity: 0.36
Validation specificity: 0.6835016835016835
Validation icbhi_score: 0.5217508417508417
Validation roc_auc: None
Validation avg_accuracy: 0.35354011222538384
Validation one_indexed_epoch: 49
The number of epochs since last 1% equals the patience
Lr has been adjusted to 7.812500371073838e-06
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 149s - loss: 0.0064 - accuracy: 0.9984 - 149s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5447138047138047
Best cm: [[786  45   6  54]
 [428 142   4  15]
 [ 62   4   7   7]
 [ 91  26  17  22]]
Best normalized_cm: [[0.882 0.051 0.007 0.061]
 [0.727 0.241 0.007 0.025]
 [0.775 0.05  0.087 0.087]
 [0.583 0.167 0.109 0.141]]
Best acc: 0.5576923076923077
Best class_accuracies: [0.8821548821548821, 0.24108658743633277, 0.0875, 0.14102564102564102]
Best sensitivity: 0.20727272727272728
Best specificity: 0.8821548821548821
Best roc_auc: None
Best avg_accuracy: 0.33794177765421396
Best one_indexed_epoch: 24
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [1.6650874614715576, 1.2002288103103638, 1.1521203517913818, 1.0841107368469238, 0.9955414533615112, 0.9170552492141724, 0.7955940365791321, 0.7367054224014282, 0.7007670402526855, 0.664727509021759, 0.6330896615982056, 0.5939299464225769, 0.5512677431106567, 0.5205802321434021, 0.4865281283855438, 0.43734660744667053, 0.42705237865448, 0.39651578664779663, 0.38920989632606506, 0.34819239377975464, 0.3388463258743286, 0.30085134506225586, 0.21003885567188263, 0.16281162202358246, 0.1558595597743988, 0.16357581317424774, 0.13392744958400726, 0.12320007383823395, 0.1163465604186058, 0.0700431540608406, 0.05316548049449921, 0.04134248197078705, 0.05691542476415634, 0.04117705300450325, 0.025336645543575287, 0.020478421822190285, 0.019966067746281624, 0.01207742840051651, 0.011983996257185936, 0.008758893236517906, 0.013366387225687504, 0.008739071898162365, 0.009004740044474602, 0.00839196890592575, 0.004447627812623978, 0.006176501512527466, 0.005589711479842663, 0.0073425425216555595, 0.0063576302491128445], 'accuracy': [0.3936537206172943, 0.4499885141849518, 0.48217982053756714, 0.5157507658004761, 0.5573695302009583, 0.5964589715003967, 0.6647505164146423, 0.6879742741584778, 0.7093584537506104, 0.7277535200119019, 0.7387905120849609, 0.7576454281806946, 0.7806392312049866, 0.7891469597816467, 0.8043228387832642, 0.8257070779800415, 0.8355944156646729, 0.8388135433197021, 0.8445619940757751, 0.8666360378265381, 0.8675557374954224, 0.8852609992027283, 0.9238905310630798, 0.9406760334968567, 0.9436652064323425, 0.9356173872947693, 0.949643611907959, 0.954012393951416, 0.9576914310455322, 0.9763163924217224, 0.9841342568397522, 0.9857438206672668, 0.9790756702423096, 0.9850540161132812, 0.9921821355819702, 0.9940215945243835, 0.9937916994094849, 0.9970108270645142, 0.9960910677909851, 0.9981604814529419, 0.9967808723449707, 0.9977006316184998, 0.9977006316184998, 0.9981604814529419, 0.9993101954460144, 0.9986203908920288, 0.9979305863380432, 0.9983904361724854, 0.9983904361724854]}
Job dir: ../cache/cw/train129/2
Job id is 3.
Job dir: ../cache/cw/train129/3
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 4.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_bis_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_5 (Sequential)                       (None, 80, 500, 1)                          4                
                                                                                                              
 sequential_6 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_7 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_8 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate_1 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_9 (Sequential)                       (None, 4)                                   6193348          
                                                                                                              
==============================================================================================================
Total params: 6,202,346
Trainable params: 6,160,840
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 1.5921 - accuracy: 0.4026 - 146s/epoch - 2s/step
Epoch 2/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 1.1947 - accuracy: 0.4755 - 142s/epoch - 2s/step
Epoch 3/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 1.1064 - accuracy: 0.5084 - 142s/epoch - 2s/step
Epoch 4/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 139s - loss: 1.0442 - accuracy: 0.5443 - 139s/epoch - 2s/step
Epoch 5/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.9535 - accuracy: 0.5854 - 141s/epoch - 2s/step
Epoch 6/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.8938 - accuracy: 0.6068 - 141s/epoch - 2s/step
Epoch 7/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.7579 - accuracy: 0.6797 - 144s/epoch - 2s/step
Epoch 8/60
Validation cm: [[891   0   0   0]
 [587   2   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1.    0.    0.    0.   ]
 [0.997 0.003 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.5203962703962703
Validation class_accuracies: [1.0, 0.003395585738539898, 0.0, 0.0]
Validation sensitivity: 0.0024242424242424242
Validation specificity: 1.0
Validation icbhi_score: 0.5012121212121212
Validation roc_auc: None
Validation avg_accuracy: 0.250848896434635
Validation one_indexed_epoch: 8
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.7054 - accuracy: 0.7066 - 140s/epoch - 2s/step
Epoch 9/60
Validation cm: [[833  58   0   0]
 [535  54   0   0]
 [ 73   7   0   0]
 [103  53   0   0]]
Validation normalized_cm: [[0.935 0.065 0.    0.   ]
 [0.908 0.092 0.    0.   ]
 [0.912 0.087 0.    0.   ]
 [0.66  0.34  0.    0.   ]]
Validation acc: 0.5168997668997669
Validation class_accuracies: [0.9349046015712682, 0.09168081494057725, 0.0, 0.0]
Validation sensitivity: 0.06545454545454546
Validation specificity: 0.9349046015712682
Validation icbhi_score: 0.5001795735129069
Validation roc_auc: None
Validation avg_accuracy: 0.2566463541279614
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.6485 - accuracy: 0.7445 - 143s/epoch - 2s/step
Epoch 10/60
Validation cm: [[700 191   0   0]
 [521  67   0   1]
 [ 54  26   0   0]
 [131  24   1   0]]
Validation normalized_cm: [[0.786 0.214 0.    0.   ]
 [0.885 0.114 0.    0.002]
 [0.675 0.325 0.    0.   ]
 [0.84  0.154 0.006 0.   ]]
Validation acc: 0.44696969696969696
Validation class_accuracies: [0.7856341189674523, 0.11375212224108659, 0.0, 0.0]
Validation sensitivity: 0.08121212121212121
Validation specificity: 0.7856341189674523
Validation icbhi_score: 0.43342312008978673
Validation roc_auc: None
Validation avg_accuracy: 0.2248465603021347
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.6014 - accuracy: 0.7586 - 143s/epoch - 2s/step
Epoch 11/60
Validation cm: [[555 333   3   0]
 [304 285   0   0]
 [ 46  30   4   0]
 [ 54  98   3   1]]
Validation normalized_cm: [[0.623 0.374 0.003 0.   ]
 [0.516 0.484 0.    0.   ]
 [0.575 0.375 0.05  0.   ]
 [0.346 0.628 0.019 0.006]]
Validation acc: 0.49242424242424243
Validation class_accuracies: [0.622895622895623, 0.4838709677419355, 0.05, 0.00641025641025641]
Validation sensitivity: 0.3515151515151515
Validation specificity: 0.622895622895623
Validation icbhi_score: 0.4872053872053872
Validation roc_auc: None
Validation avg_accuracy: 0.2907942117619537
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 3 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 145s - loss: 0.5742 - accuracy: 0.7671 - 145s/epoch - 2s/step
Epoch 12/60
Validation cm: [[773  97  20   1]
 [544  42   3   0]
 [ 65  10   5   0]
 [104  28  24   0]]
Validation normalized_cm: [[0.868 0.109 0.022 0.001]
 [0.924 0.071 0.005 0.   ]
 [0.812 0.125 0.062 0.   ]
 [0.667 0.179 0.154 0.   ]]
Validation acc: 0.47785547785547783
Validation class_accuracies: [0.867564534231201, 0.07130730050933787, 0.0625, 0.0]
Validation sensitivity: 0.05696969696969697
Validation specificity: 0.867564534231201
Validation icbhi_score: 0.462267115600449
Validation roc_auc: None
Validation avg_accuracy: 0.2503429586851347
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 4 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.5253 - accuracy: 0.7988 - 141s/epoch - 2s/step
Epoch 13/60
Validation cm: [[686 159  33  13]
 [413 164  12   0]
 [ 63   8   5   4]
 [103  19  32   2]]
Validation normalized_cm: [[0.77  0.178 0.037 0.015]
 [0.701 0.278 0.02  0.   ]
 [0.787 0.1   0.062 0.05 ]
 [0.66  0.122 0.205 0.013]]
Validation acc: 0.4994172494172494
Validation class_accuracies: [0.7699214365881033, 0.27843803056027167, 0.0625, 0.01282051282051282]
Validation sensitivity: 0.20727272727272728
Validation specificity: 0.7699214365881033
Validation icbhi_score: 0.4885970819304153
Validation roc_auc: None
Validation avg_accuracy: 0.2809199949922219
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.4753 - accuracy: 0.8172 - 144s/epoch - 2s/step
Epoch 14/60
Validation cm: [[207 680   2   2]
 [168 420   0   1]
 [ 12  61   1   6]
 [ 34 116   0   6]]
Validation normalized_cm: [[0.232 0.763 0.002 0.002]
 [0.285 0.713 0.    0.002]
 [0.15  0.762 0.013 0.075]
 [0.218 0.744 0.    0.038]]
Validation acc: 0.36946386946386944
Validation class_accuracies: [0.23232323232323232, 0.7130730050933786, 0.0125, 0.038461538461538464]
Validation sensitivity: 0.5175757575757576
Validation specificity: 0.23232323232323232
Validation icbhi_score: 0.3749494949494949
Validation roc_auc: None
Validation avg_accuracy: 0.24908944396953733
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 6 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.3762 - accuracy: 0.8508 - 143s/epoch - 2s/step
Epoch 15/60
Validation cm: [[162 709  12   8]
 [ 55 532   1   1]
 [ 10  62   8   0]
 [ 14 116   4  22]]
Validation normalized_cm: [[0.182 0.796 0.013 0.009]
 [0.093 0.903 0.002 0.002]
 [0.125 0.775 0.1   0.   ]
 [0.09  0.744 0.026 0.141]]
Validation acc: 0.4219114219114219
Validation class_accuracies: [0.18181818181818182, 0.9032258064516129, 0.1, 0.14102564102564102]
Validation sensitivity: 0.6812121212121212
Validation specificity: 0.18181818181818182
Validation icbhi_score: 0.4315151515151515
Validation roc_auc: None
Validation avg_accuracy: 0.3315174073238589
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 7 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.3423 - accuracy: 0.8646 - 146s/epoch - 2s/step
Epoch 16/60
Validation cm: [[353 503   6  29]
 [312 269   2   6]
 [ 20  49   4   7]
 [ 44  77   4  31]]
Validation normalized_cm: [[0.396 0.565 0.007 0.033]
 [0.53  0.457 0.003 0.01 ]
 [0.25  0.613 0.05  0.087]
 [0.282 0.494 0.026 0.199]]
Validation acc: 0.38286713286713286
Validation class_accuracies: [0.3961840628507295, 0.4567062818336163, 0.05, 0.1987179487179487]
Validation sensitivity: 0.36848484848484847
Validation specificity: 0.3961840628507295
Validation icbhi_score: 0.382334455667789
Validation roc_auc: None
Validation avg_accuracy: 0.27540207335057365
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 8 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.3229 - accuracy: 0.8761 - 140s/epoch - 2s/step
Epoch 17/60
Validation cm: [[459 395  31   6]
 [372 207   9   1]
 [ 35  34   9   2]
 [ 56  65  23  12]]
Validation normalized_cm: [[0.515 0.443 0.035 0.007]
 [0.632 0.351 0.015 0.002]
 [0.438 0.425 0.113 0.025]
 [0.359 0.417 0.147 0.077]]
Validation acc: 0.40034965034965037
Validation class_accuracies: [0.5151515151515151, 0.35144312393887944, 0.1125, 0.07692307692307693]
Validation sensitivity: 0.27636363636363637
Validation specificity: 0.5151515151515151
Validation icbhi_score: 0.39575757575757575
Validation roc_auc: None
Validation avg_accuracy: 0.2640044290033679
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 9 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.2972 - accuracy: 0.8860 - 146s/epoch - 2s/step
Epoch 18/60
Validation cm: [[560 226  86  19]
 [413 163   9   4]
 [ 40  12  19   9]
 [ 64  37  21  34]]
Validation normalized_cm: [[0.629 0.254 0.097 0.021]
 [0.701 0.277 0.015 0.007]
 [0.5   0.15  0.237 0.113]
 [0.41  0.237 0.135 0.218]]
Validation acc: 0.4522144522144522
Validation class_accuracies: [0.6285072951739619, 0.2767402376910017, 0.2375, 0.21794871794871795]
Validation sensitivity: 0.26181818181818184
Validation specificity: 0.6285072951739619
Validation icbhi_score: 0.44516273849607185
Validation roc_auc: None
Validation avg_accuracy: 0.34017406270342043
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0001250000059371814
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.2774 - accuracy: 0.8963 - 142s/epoch - 2s/step
Epoch 19/60
Validation cm: [[524 346   7  14]
 [324 258   2   5]
 [ 38  34   7   1]
 [ 70  54   9  23]]
Validation normalized_cm: [[0.588 0.388 0.008 0.016]
 [0.55  0.438 0.003 0.008]
 [0.475 0.425 0.087 0.013]
 [0.449 0.346 0.058 0.147]]
Validation acc: 0.4731934731934732
Validation class_accuracies: [0.5881032547699214, 0.4380305602716469, 0.0875, 0.14743589743589744]
Validation sensitivity: 0.3490909090909091
Validation specificity: 0.5881032547699214
Validation icbhi_score: 0.46859708193041527
Validation roc_auc: None
Validation avg_accuracy: 0.31526742811936637
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 11 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.2170 - accuracy: 0.9119 - 148s/epoch - 2s/step
Epoch 20/60
Validation cm: [[637 223  26   5]
 [427 159   1   2]
 [ 55  21   4   0]
 [ 75  54  11  16]]
Validation normalized_cm: [[0.715 0.25  0.029 0.006]
 [0.725 0.27  0.002 0.003]
 [0.688 0.263 0.05  0.   ]
 [0.481 0.346 0.071 0.103]]
Validation acc: 0.4755244755244755
Validation class_accuracies: [0.7149270482603816, 0.2699490662139219, 0.05, 0.10256410256410256]
Validation sensitivity: 0.21696969696969698
Validation specificity: 0.7149270482603816
Validation icbhi_score: 0.4659483726150393
Validation roc_auc: None
Validation avg_accuracy: 0.28436005425960154
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 12 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.1913 - accuracy: 0.9248 - 142s/epoch - 2s/step
Epoch 21/60
Validation cm: [[405 458  12  16]
 [234 351   1   3]
 [ 24  48   4   4]
 [ 47  83   3  23]]
Validation normalized_cm: [[0.455 0.514 0.013 0.018]
 [0.397 0.596 0.002 0.005]
 [0.3   0.6   0.05  0.05 ]
 [0.301 0.532 0.019 0.147]]
Validation acc: 0.4562937062937063
Validation class_accuracies: [0.45454545454545453, 0.5959252971137521, 0.05, 0.14743589743589744]
Validation sensitivity: 0.4581818181818182
Validation specificity: 0.45454545454545453
Validation icbhi_score: 0.45636363636363636
Validation roc_auc: None
Validation avg_accuracy: 0.311976662273776
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 13 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.1910 - accuracy: 0.9260 - 147s/epoch - 2s/step
Epoch 22/60
Validation cm: [[249 628  12   2]
 [162 425   2   0]
 [ 14  59   7   0]
 [ 36  96  14  10]]
Validation normalized_cm: [[0.279 0.705 0.013 0.002]
 [0.275 0.722 0.003 0.   ]
 [0.175 0.738 0.087 0.   ]
 [0.231 0.615 0.09  0.064]]
Validation acc: 0.4026806526806527
Validation class_accuracies: [0.27946127946127947, 0.7215619694397284, 0.0875, 0.0641025641025641]
Validation sensitivity: 0.5357575757575758
Validation specificity: 0.27946127946127947
Validation icbhi_score: 0.40760942760942764
Validation roc_auc: None
Validation avg_accuracy: 0.28815645325089295
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 14 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.1839 - accuracy: 0.9299 - 143s/epoch - 2s/step
Epoch 23/60
Validation cm: [[455 412  11  13]
 [278 304   2   5]
 [ 28  41   9   2]
 [ 57  64  12  23]]
Validation normalized_cm: [[0.511 0.462 0.012 0.015]
 [0.472 0.516 0.003 0.008]
 [0.35  0.512 0.113 0.025]
 [0.365 0.41  0.077 0.147]]
Validation acc: 0.460955710955711
Validation class_accuracies: [0.510662177328844, 0.5161290322580645, 0.1125, 0.14743589743589744]
Validation sensitivity: 0.4072727272727273
Validation specificity: 0.510662177328844
Validation icbhi_score: 0.4589674523007856
Validation roc_auc: None
Validation avg_accuracy: 0.3216817767557015
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 6.25000029685907e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.1604 - accuracy: 0.9370 - 148s/epoch - 2s/step
Epoch 24/60
Validation cm: [[482 387  11  11]
 [364 218   4   3]
 [ 34  35   7   4]
 [ 68  59  11  18]]
Validation normalized_cm: [[0.541 0.434 0.012 0.012]
 [0.618 0.37  0.007 0.005]
 [0.425 0.438 0.087 0.05 ]
 [0.436 0.378 0.071 0.115]]
Validation acc: 0.4224941724941725
Validation class_accuracies: [0.5409652076318743, 0.3701188455008489, 0.0875, 0.11538461538461539]
Validation sensitivity: 0.29454545454545455
Validation specificity: 0.5409652076318743
Validation icbhi_score: 0.4177553310886644
Validation roc_auc: None
Validation avg_accuracy: 0.2784921671293346
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 16 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.1331 - accuracy: 0.9506 - 142s/epoch - 2s/step
Epoch 25/60
Validation cm: [[455 417  14   5]
 [306 280   2   1]
 [ 33  40   6   1]
 [ 60  71   8  17]]
Validation normalized_cm: [[0.511 0.468 0.016 0.006]
 [0.52  0.475 0.003 0.002]
 [0.412 0.5   0.075 0.013]
 [0.385 0.455 0.051 0.109]]
Validation acc: 0.4417249417249417
Validation class_accuracies: [0.510662177328844, 0.47538200339558573, 0.075, 0.10897435897435898]
Validation sensitivity: 0.36727272727272725
Validation specificity: 0.510662177328844
Validation icbhi_score: 0.4389674523007856
Validation roc_auc: None
Validation avg_accuracy: 0.2925046349246972
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 17 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.1220 - accuracy: 0.9538 - 147s/epoch - 2s/step
Epoch 26/60
Validation cm: [[375 506   8   2]
 [223 363   3   0]
 [ 26  47   7   0]
 [ 56  86   6   8]]
Validation normalized_cm: [[0.421 0.568 0.009 0.002]
 [0.379 0.616 0.005 0.   ]
 [0.325 0.588 0.087 0.   ]
 [0.359 0.551 0.038 0.051]]
Validation acc: 0.4388111888111888
Validation class_accuracies: [0.4208754208754209, 0.6162988115449916, 0.0875, 0.05128205128205128]
Validation sensitivity: 0.4581818181818182
Validation specificity: 0.4208754208754209
Validation icbhi_score: 0.43952861952861955
Validation roc_auc: None
Validation avg_accuracy: 0.29398907092561594
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 18 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.1242 - accuracy: 0.9540 - 142s/epoch - 2s/step
Epoch 27/60
Validation cm: [[531 289  55  16]
 [356 220   3  10]
 [ 40  25  11   4]
 [ 68  50  15  23]]
Validation normalized_cm: [[0.596 0.324 0.062 0.018]
 [0.604 0.374 0.005 0.017]
 [0.5   0.312 0.138 0.05 ]
 [0.436 0.321 0.096 0.147]]
Validation acc: 0.4574592074592075
Validation class_accuracies: [0.5959595959595959, 0.3735144312393888, 0.1375, 0.14743589743589744]
Validation sensitivity: 0.30787878787878786
Validation specificity: 0.5959595959595959
Validation icbhi_score: 0.4519191919191919
Validation roc_auc: None
Validation avg_accuracy: 0.3136024811587205
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 19 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.1094 - accuracy: 0.9600 - 147s/epoch - 2s/step
Epoch 28/60
Validation cm: [[474 384  29   4]
 [355 227   5   2]
 [ 36  31  13   0]
 [ 72  56  21   7]]
Validation normalized_cm: [[0.532 0.431 0.033 0.004]
 [0.603 0.385 0.008 0.003]
 [0.45  0.388 0.163 0.   ]
 [0.462 0.359 0.135 0.045]]
Validation acc: 0.4201631701631702
Validation class_accuracies: [0.531986531986532, 0.3853989813242784, 0.1625, 0.04487179487179487]
Validation sensitivity: 0.2993939393939394
Validation specificity: 0.531986531986532
Validation icbhi_score: 0.41569023569023567
Validation roc_auc: None
Validation avg_accuracy: 0.28118932704565136
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 3.125000148429535e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.1135 - accuracy: 0.9563 - 141s/epoch - 2s/step
Epoch 29/60
Validation cm: [[595 236  43  17]
 [447 131   4   7]
 [ 47  16  12   5]
 [ 73  40  17  26]]
Validation normalized_cm: [[0.668 0.265 0.048 0.019]
 [0.759 0.222 0.007 0.012]
 [0.588 0.2   0.15  0.062]
 [0.468 0.256 0.109 0.167]]
Validation acc: 0.44522144522144524
Validation class_accuracies: [0.6677890011223344, 0.22241086587436332, 0.15, 0.16666666666666666]
Validation sensitivity: 0.20484848484848484
Validation specificity: 0.6677890011223344
Validation icbhi_score: 0.4363187429854096
Validation roc_auc: None
Validation avg_accuracy: 0.3017166334158411
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 21 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.0958 - accuracy: 0.9669 - 146s/epoch - 2s/step
Epoch 30/60
Validation cm: [[538 270  64  19]
 [398 175   8   8]
 [ 46  16  15   3]
 [ 67  40  27  22]]
Validation normalized_cm: [[0.604 0.303 0.072 0.021]
 [0.676 0.297 0.014 0.014]
 [0.575 0.2   0.188 0.037]
 [0.429 0.256 0.173 0.141]]
Validation acc: 0.4370629370629371
Validation class_accuracies: [0.6038159371492705, 0.29711375212224106, 0.1875, 0.14102564102564102]
Validation sensitivity: 0.25696969696969696
Validation specificity: 0.6038159371492705
Validation icbhi_score: 0.43039281705948373
Validation roc_auc: None
Validation avg_accuracy: 0.3073638325742881
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 22 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.0842 - accuracy: 0.9694 - 143s/epoch - 2s/step
Epoch 31/60
Validation cm: [[531 292  54  14]
 [377 203   4   5]
 [ 41  25  12   2]
 [ 70  44  20  22]]
Validation normalized_cm: [[0.596 0.328 0.061 0.016]
 [0.64  0.345 0.007 0.008]
 [0.512 0.312 0.15  0.025]
 [0.449 0.282 0.128 0.141]]
Validation acc: 0.44755244755244755
Validation class_accuracies: [0.5959595959595959, 0.34465195246179964, 0.15, 0.14102564102564102]
Validation sensitivity: 0.2872727272727273
Validation specificity: 0.5959595959595959
Validation icbhi_score: 0.4416161616161616
Validation roc_auc: None
Validation avg_accuracy: 0.3079092973617591
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 23 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.0860 - accuracy: 0.9655 - 147s/epoch - 2s/step
Epoch 32/60
Validation cm: [[552 264  56  19]
 [387 190   7   5]
 [ 42  22  12   4]
 [ 69  39  24  24]]
Validation normalized_cm: [[0.62  0.296 0.063 0.021]
 [0.657 0.323 0.012 0.008]
 [0.525 0.275 0.15  0.05 ]
 [0.442 0.25  0.154 0.154]]
Validation acc: 0.4533799533799534
Validation class_accuracies: [0.6195286195286195, 0.3225806451612903, 0.15, 0.15384615384615385]
Validation sensitivity: 0.2739393939393939
Validation specificity: 0.6195286195286195
Validation icbhi_score: 0.4467340067340067
Validation roc_auc: None
Validation avg_accuracy: 0.3114888546340159
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5012121212121212 hasn't increased by 0 in 24 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.0850 - accuracy: 0.9680 - 143s/epoch - 2s/step
Epoch 33/60
Validation cm: [[492 354  33  12]
 [318 263   3   5]
 [ 38  31   9   2]
 [ 64  52  14  26]]
Validation normalized_cm: [[0.552 0.397 0.037 0.013]
 [0.54  0.447 0.005 0.008]
 [0.475 0.388 0.113 0.025]
 [0.41  0.333 0.09  0.167]]
Validation acc: 0.4603729603729604
Validation class_accuracies: [0.5521885521885522, 0.4465195246179966, 0.1125, 0.16666666666666666]
Validation sensitivity: 0.3612121212121212
Validation specificity: 0.5521885521885522
Validation icbhi_score: 0.4567003367003367
Validation roc_auc: None
Validation avg_accuracy: 0.3194686858683039
Validation one_indexed_epoch: 33
The number of epochs since last 1% equals the patience
Lr has been adjusted to 1.5625000742147677e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.0804 - accuracy: 0.9719 - 146s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5012121212121212
Best cm: [[891   0   0   0]
 [587   2   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Best normalized_cm: [[1.    0.    0.    0.   ]
 [0.997 0.003 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Best acc: 0.5203962703962703
Best class_accuracies: [1.0, 0.003395585738539898, 0.0, 0.0]
Best sensitivity: 0.0024242424242424242
Best specificity: 1.0
Best roc_auc: None
Best avg_accuracy: 0.250848896434635
Best one_indexed_epoch: 8
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [1.5920639038085938, 1.194686770439148, 1.1063858270645142, 1.0442441701889038, 0.9534571170806885, 0.893793523311615, 0.7578526139259338, 0.7053688168525696, 0.6484614610671997, 0.6014171242713928, 0.574203372001648, 0.5253120064735413, 0.47532203793525696, 0.3761647045612335, 0.34230825304985046, 0.3228893578052521, 0.29721540212631226, 0.2774293124675751, 0.21703103184700012, 0.19128434360027313, 0.1909974366426468, 0.18392837047576904, 0.16037146747112274, 0.13305076956748962, 0.12201159447431564, 0.12422094494104385, 0.10943951457738876, 0.11347745358943939, 0.09576112031936646, 0.08417893946170807, 0.08600804209709167, 0.08500472456216812, 0.08039655536413193], 'accuracy': [0.4026212990283966, 0.4755116105079651, 0.5083927512168884, 0.5442630648612976, 0.5854219198226929, 0.6068061590194702, 0.6796965003013611, 0.706599235534668, 0.7445389628410339, 0.7585651874542236, 0.7670729160308838, 0.7988043427467346, 0.8171993494033813, 0.8507702946662903, 0.8645665645599365, 0.8760634660720825, 0.8859508037567139, 0.8962979912757874, 0.9119337797164917, 0.9248102903366089, 0.9259600043296814, 0.9298689365386963, 0.9369969964027405, 0.950563371181488, 0.9537824988365173, 0.954012393951416, 0.9599907994270325, 0.956311821937561, 0.966888964176178, 0.9694182276725769, 0.965509295463562, 0.9680386185646057, 0.9719475507736206]}
Job dir: ../cache/cw/train129/4
Job id is 5.
Job dir: ../cache/cw/train129/5
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 6.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_bis_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_4 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_5 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_10 (Sequential)                      (None, 80, 500, 1)                          4                
                                                                                                              
 sequential_11 (Sequential)                      (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_12 (Sequential)                      (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_13 (Sequential)                      (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate_2 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_14 (Sequential)                      (None, 4)                                   6193348          
                                                                                                              
==============================================================================================================
Total params: 6,202,346
Trainable params: 6,160,840
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 1.5477 - accuracy: 0.4130 - 143s/epoch - 2s/step
Epoch 2/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 138s - loss: 1.2120 - accuracy: 0.4732 - 138s/epoch - 2s/step
Epoch 3/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 2 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 1.1446 - accuracy: 0.4999 - 141s/epoch - 2s/step
Epoch 4/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 139s - loss: 1.0442 - accuracy: 0.5590 - 139s/epoch - 2s/step
Epoch 5/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 4 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.9665 - accuracy: 0.5882 - 140s/epoch - 2s/step
Epoch 6/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.8821 - accuracy: 0.6339 - 140s/epoch - 2s/step
Epoch 7/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 7
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.7542 - accuracy: 0.6917 - 142s/epoch - 2s/step
Epoch 8/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 141s - loss: 0.6692 - accuracy: 0.7248 - 141s/epoch - 2s/step
Epoch 9/60
Validation cm: [[876  15   0   0]
 [569  20   0   0]
 [ 76   4   0   0]
 [146  10   0   0]]
Validation normalized_cm: [[0.983 0.017 0.    0.   ]
 [0.966 0.034 0.    0.   ]
 [0.95  0.05  0.    0.   ]
 [0.936 0.064 0.    0.   ]]
Validation acc: 0.5221445221445221
Validation class_accuracies: [0.9831649831649831, 0.03395585738539898, 0.0, 0.0]
Validation sensitivity: 0.024242424242424242
Validation specificity: 0.9831649831649831
Validation icbhi_score: 0.5037037037037037
Validation roc_auc: None
Validation avg_accuracy: 0.25428021013759555
Validation one_indexed_epoch: 9
-- New best results were achieved. --
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.6292 - accuracy: 0.7386 - 140s/epoch - 2s/step
Epoch 10/60
Validation cm: [[746 145   0   0]
 [519  70   0   0]
 [ 67  11   0   2]
 [125  31   0   0]]
Validation normalized_cm: [[0.837 0.163 0.    0.   ]
 [0.881 0.119 0.    0.   ]
 [0.838 0.138 0.    0.025]
 [0.801 0.199 0.    0.   ]]
Validation acc: 0.4755244755244755
Validation class_accuracies: [0.8372615039281706, 0.11884550084889643, 0.0, 0.0]
Validation sensitivity: 0.08484848484848485
Validation specificity: 0.8372615039281706
Validation icbhi_score: 0.4610549943883277
Validation roc_auc: None
Validation avg_accuracy: 0.23902675119426675
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 1 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.5954 - accuracy: 0.7650 - 142s/epoch - 2s/step
Epoch 11/60
Validation cm: [[610 234  25  22]
 [399 179   3   8]
 [ 56  14   6   4]
 [ 93  30  22  11]]
Validation normalized_cm: [[0.685 0.263 0.028 0.025]
 [0.677 0.304 0.005 0.014]
 [0.7   0.175 0.075 0.05 ]
 [0.596 0.192 0.141 0.071]]
Validation acc: 0.4696969696969697
Validation class_accuracies: [0.6846240179573513, 0.30390492359932086, 0.075, 0.07051282051282051]
Validation sensitivity: 0.23757575757575758
Validation specificity: 0.6846240179573513
Validation icbhi_score: 0.4610998877665544
Validation roc_auc: None
Validation avg_accuracy: 0.2835104405173732
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 2 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 140s - loss: 0.5375 - accuracy: 0.7864 - 140s/epoch - 2s/step
Epoch 12/60
Validation cm: [[538 256  81  16]
 [323 180  70  16]
 [ 38  15  26   1]
 [ 69  29  49   9]]
Validation normalized_cm: [[0.604 0.287 0.091 0.018]
 [0.548 0.306 0.119 0.027]
 [0.475 0.188 0.325 0.013]
 [0.442 0.186 0.314 0.058]]
Validation acc: 0.4388111888111888
Validation class_accuracies: [0.6038159371492705, 0.30560271646859083, 0.325, 0.057692307692307696]
Validation sensitivity: 0.2606060606060606
Validation specificity: 0.6038159371492705
Validation icbhi_score: 0.43221099887766556
Validation roc_auc: None
Validation avg_accuracy: 0.3230277403275423
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 3 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.4912 - accuracy: 0.8041 - 143s/epoch - 2s/step
Epoch 13/60
Validation cm: [[707 109  64  11]
 [430 118  31  10]
 [ 48   3  27   2]
 [ 74  34  47   1]]
Validation normalized_cm: [[0.793 0.122 0.072 0.012]
 [0.73  0.2   0.053 0.017]
 [0.6   0.037 0.338 0.025]
 [0.474 0.218 0.301 0.006]]
Validation acc: 0.4970862470862471
Validation class_accuracies: [0.7934904601571269, 0.200339558573854, 0.3375, 0.00641025641025641]
Validation sensitivity: 0.17696969696969697
Validation specificity: 0.7934904601571269
Validation icbhi_score: 0.48523007856341194
Validation roc_auc: None
Validation avg_accuracy: 0.3344350687853093
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 4 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 137s - loss: 0.4613 - accuracy: 0.8275 - 137s/epoch - 2s/step
Epoch 14/60
Validation cm: [[353 434  54  50]
 [212 324  37  16]
 [ 21  38  15   6]
 [ 24  82  28  22]]
Validation normalized_cm: [[0.396 0.487 0.061 0.056]
 [0.36  0.55  0.063 0.027]
 [0.263 0.475 0.188 0.075]
 [0.154 0.526 0.179 0.141]]
Validation acc: 0.4160839160839161
Validation class_accuracies: [0.3961840628507295, 0.5500848896434635, 0.1875, 0.14102564102564102]
Validation sensitivity: 0.43757575757575756
Validation specificity: 0.3961840628507295
Validation icbhi_score: 0.41687991021324355
Validation roc_auc: None
Validation avg_accuracy: 0.3186986483799585
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0002500000118743628
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 145s - loss: 0.4504 - accuracy: 0.8255 - 145s/epoch - 2s/step
Epoch 15/60
Validation cm: [[449 411   3  28]
 [397 180   1  11]
 [ 37  37   4   2]
 [ 64  76   6  10]]
Validation normalized_cm: [[0.504 0.461 0.003 0.031]
 [0.674 0.306 0.002 0.019]
 [0.463 0.463 0.05  0.025]
 [0.41  0.487 0.038 0.064]]
Validation acc: 0.3747086247086247
Validation class_accuracies: [0.5039281705948373, 0.30560271646859083, 0.05, 0.0641025641025641]
Validation sensitivity: 0.23515151515151514
Validation specificity: 0.5039281705948373
Validation icbhi_score: 0.3695398428731762
Validation roc_auc: None
Validation avg_accuracy: 0.23090836279149807
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 6 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 138s - loss: 0.3391 - accuracy: 0.8733 - 138s/epoch - 2s/step
Epoch 16/60
Validation cm: [[547 266  57  21]
 [378 168  31  12]
 [ 36  21  22   1]
 [ 53  38  44  21]]
Validation normalized_cm: [[0.614 0.299 0.064 0.024]
 [0.642 0.285 0.053 0.02 ]
 [0.45  0.263 0.275 0.013]
 [0.34  0.244 0.282 0.135]]
Validation acc: 0.4417249417249417
Validation class_accuracies: [0.6139169472502806, 0.28522920203735147, 0.275, 0.1346153846153846]
Validation sensitivity: 0.25575757575757574
Validation specificity: 0.6139169472502806
Validation icbhi_score: 0.43483726150392815
Validation roc_auc: None
Validation avg_accuracy: 0.32719038347575413
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 7 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.3184 - accuracy: 0.8774 - 144s/epoch - 2s/step
Epoch 17/60
Validation cm: [[735  99  27  30]
 [509  62   7  11]
 [ 62  10   6   2]
 [118  16  22   0]]
Validation normalized_cm: [[0.825 0.111 0.03  0.034]
 [0.864 0.105 0.012 0.019]
 [0.775 0.125 0.075 0.025]
 [0.756 0.103 0.141 0.   ]]
Validation acc: 0.46794871794871795
Validation class_accuracies: [0.8249158249158249, 0.10526315789473684, 0.075, 0.0]
Validation sensitivity: 0.08242424242424243
Validation specificity: 0.8249158249158249
Validation icbhi_score: 0.45367003367003367
Validation roc_auc: None
Validation avg_accuracy: 0.25129474570264043
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 8 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 136s - loss: 0.2780 - accuracy: 0.9007 - 136s/epoch - 2s/step
Epoch 18/60
Validation cm: [[510 266  30  85]
 [427 137  11  14]
 [ 28  32   7  13]
 [ 67  41  10  38]]
Validation normalized_cm: [[0.572 0.299 0.034 0.095]
 [0.725 0.233 0.019 0.024]
 [0.35  0.4   0.087 0.163]
 [0.429 0.263 0.064 0.244]]
Validation acc: 0.40326340326340326
Validation class_accuracies: [0.5723905723905723, 0.23259762308998302, 0.0875, 0.24358974358974358]
Validation sensitivity: 0.2206060606060606
Validation specificity: 0.5723905723905723
Validation icbhi_score: 0.39649831649831646
Validation roc_auc: None
Validation avg_accuracy: 0.2840194847675747
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 9 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.2593 - accuracy: 0.8970 - 144s/epoch - 2s/step
Epoch 19/60
Validation cm: [[540 221  61  69]
 [379 172  20  18]
 [ 43  11  21   5]
 [ 61  37  33  25]]
Validation normalized_cm: [[0.606 0.248 0.068 0.077]
 [0.643 0.292 0.034 0.031]
 [0.537 0.138 0.263 0.062]
 [0.391 0.237 0.212 0.16 ]]
Validation acc: 0.4417249417249417
Validation class_accuracies: [0.6060606060606061, 0.2920203735144312, 0.2625, 0.16025641025641027]
Validation sensitivity: 0.2642424242424242
Validation specificity: 0.6060606060606061
Validation icbhi_score: 0.4351515151515152
Validation roc_auc: None
Validation avg_accuracy: 0.3302093474578619
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0001250000059371814
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 136s - loss: 0.2320 - accuracy: 0.9124 - 136s/epoch - 2s/step
Epoch 20/60
Validation cm: [[620 185  29  57]
 [387 165  13  24]
 [ 43  21  12   4]
 [ 67  39  20  30]]
Validation normalized_cm: [[0.696 0.208 0.033 0.064]
 [0.657 0.28  0.022 0.041]
 [0.537 0.263 0.15  0.05 ]
 [0.429 0.25  0.128 0.192]]
Validation acc: 0.4819347319347319
Validation class_accuracies: [0.6958473625140292, 0.2801358234295416, 0.15, 0.19230769230769232]
Validation sensitivity: 0.2509090909090909
Validation specificity: 0.6958473625140292
Validation icbhi_score: 0.47337822671156005
Validation roc_auc: None
Validation avg_accuracy: 0.32957271956281575
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 11 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.1765 - accuracy: 0.9391 - 143s/epoch - 2s/step
Epoch 21/60
Validation cm: [[576 266  31  18]
 [361 183  32  13]
 [ 44  23  11   2]
 [ 72  31  36  17]]
Validation normalized_cm: [[0.646 0.299 0.035 0.02 ]
 [0.613 0.311 0.054 0.022]
 [0.55  0.287 0.138 0.025]
 [0.462 0.199 0.231 0.109]]
Validation acc: 0.4586247086247086
Validation class_accuracies: [0.6464646464646465, 0.31069609507640067, 0.1375, 0.10897435897435898]
Validation sensitivity: 0.25575757575757574
Validation specificity: 0.6464646464646465
Validation icbhi_score: 0.45111111111111113
Validation roc_auc: None
Validation avg_accuracy: 0.30090877512885156
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 12 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 136s - loss: 0.1440 - accuracy: 0.9471 - 136s/epoch - 2s/step
Epoch 22/60
Validation cm: [[417 354  77  43]
 [205 343  23  18]
 [ 22  20  30   8]
 [ 41  62  26  27]]
Validation normalized_cm: [[0.468 0.397 0.086 0.048]
 [0.348 0.582 0.039 0.031]
 [0.275 0.25  0.375 0.1  ]
 [0.263 0.397 0.167 0.173]]
Validation acc: 0.4761072261072261
Validation class_accuracies: [0.468013468013468, 0.5823429541595926, 0.375, 0.17307692307692307]
Validation sensitivity: 0.48484848484848486
Validation specificity: 0.468013468013468
Validation icbhi_score: 0.4764309764309764
Validation roc_auc: None
Validation avg_accuracy: 0.3996083363124959
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 13 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.1267 - accuracy: 0.9529 - 144s/epoch - 2s/step
Epoch 23/60
Validation cm: [[509 379   3   0]
 [338 243   0   8]
 [ 41  34   5   0]
 [ 70  65   7  14]]
Validation normalized_cm: [[0.571 0.425 0.003 0.   ]
 [0.574 0.413 0.    0.014]
 [0.512 0.425 0.062 0.   ]
 [0.449 0.417 0.045 0.09 ]]
Validation acc: 0.4493006993006993
Validation class_accuracies: [0.5712682379349046, 0.41256366723259763, 0.0625, 0.08974358974358974]
Validation sensitivity: 0.31757575757575757
Validation specificity: 0.5712682379349046
Validation icbhi_score: 0.4444219977553311
Validation roc_auc: None
Validation avg_accuracy: 0.28401887372777296
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 14 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 136s - loss: 0.1133 - accuracy: 0.9552 - 136s/epoch - 2s/step
Epoch 24/60
Validation cm: [[479 377  11  24]
 [264 309   3  13]
 [ 35  37   6   2]
 [ 52  71   8  25]]
Validation normalized_cm: [[0.538 0.423 0.012 0.027]
 [0.448 0.525 0.005 0.022]
 [0.438 0.463 0.075 0.025]
 [0.333 0.455 0.051 0.16 ]]
Validation acc: 0.4772727272727273
Validation class_accuracies: [0.5375982042648709, 0.5246179966044142, 0.075, 0.16025641025641027]
Validation sensitivity: 0.4121212121212121
Validation specificity: 0.5375982042648709
Validation icbhi_score: 0.4748597081930415
Validation roc_auc: None
Validation avg_accuracy: 0.32436815278142384
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 6.25000029685907e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.1170 - accuracy: 0.9536 - 143s/epoch - 2s/step
Epoch 25/60
Validation cm: [[579 294  11   7]
 [379 183  16  11]
 [ 41  32   7   0]
 [ 75  52  17  12]]
Validation normalized_cm: [[0.65  0.33  0.012 0.008]
 [0.643 0.311 0.027 0.019]
 [0.512 0.4   0.087 0.   ]
 [0.481 0.333 0.109 0.077]]
Validation acc: 0.4551282051282051
Validation class_accuracies: [0.6498316498316499, 0.31069609507640067, 0.0875, 0.07692307692307693]
Validation sensitivity: 0.24484848484848484
Validation specificity: 0.6498316498316499
Validation icbhi_score: 0.44734006734006737
Validation roc_auc: None
Validation avg_accuracy: 0.2812377054577818
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 16 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 142s - loss: 0.0812 - accuracy: 0.9694 - 142s/epoch - 2s/step
Epoch 26/60
Validation cm: [[610 223  29  29]
 [437 120  14  18]
 [ 39  30   9   2]
 [ 69  47  18  22]]
Validation normalized_cm: [[0.685 0.25  0.033 0.033]
 [0.742 0.204 0.024 0.031]
 [0.487 0.375 0.113 0.025]
 [0.442 0.301 0.115 0.141]]
Validation acc: 0.44347319347319347
Validation class_accuracies: [0.6846240179573513, 0.2037351443123939, 0.1125, 0.14102564102564102]
Validation sensitivity: 0.18303030303030304
Validation specificity: 0.6846240179573513
Validation icbhi_score: 0.4338271604938272
Validation roc_auc: None
Validation avg_accuracy: 0.2854712008238465
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 17 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.0682 - accuracy: 0.9768 - 148s/epoch - 2s/step
Epoch 27/60
Validation cm: [[534 290  29  38]
 [340 200  26  23]
 [ 30  34  13   3]
 [ 56  51  23  26]]
Validation normalized_cm: [[0.599 0.325 0.033 0.043]
 [0.577 0.34  0.044 0.039]
 [0.375 0.425 0.163 0.037]
 [0.359 0.327 0.147 0.167]]
Validation acc: 0.45046620046620045
Validation class_accuracies: [0.5993265993265994, 0.3395585738539898, 0.1625, 0.16666666666666666]
Validation sensitivity: 0.2896969696969697
Validation specificity: 0.5993265993265994
Validation icbhi_score: 0.4445117845117845
Validation roc_auc: None
Validation avg_accuracy: 0.317012959961814
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 18 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 144s - loss: 0.0591 - accuracy: 0.9782 - 144s/epoch - 2s/step
Epoch 28/60
Validation cm: [[468 344  42  37]
 [264 269  40  16]
 [ 32  33  13   2]
 [ 44  60  34  18]]
Validation normalized_cm: [[0.525 0.386 0.047 0.042]
 [0.448 0.457 0.068 0.027]
 [0.4   0.412 0.163 0.025]
 [0.282 0.385 0.218 0.115]]
Validation acc: 0.44755244755244755
Validation class_accuracies: [0.5252525252525253, 0.4567062818336163, 0.1625, 0.11538461538461539]
Validation sensitivity: 0.36363636363636365
Validation specificity: 0.5252525252525253
Validation icbhi_score: 0.4444444444444445
Validation roc_auc: None
Validation avg_accuracy: 0.3149608556176893
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 19 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 151s - loss: 0.0519 - accuracy: 0.9807 - 151s/epoch - 2s/step
Epoch 29/60
Validation cm: [[584 269  13  25]
 [402 161  19   7]
 [ 45  21  11   3]
 [ 84  31  24  17]]
Validation normalized_cm: [[0.655 0.302 0.015 0.028]
 [0.683 0.273 0.032 0.012]
 [0.562 0.263 0.138 0.037]
 [0.538 0.199 0.154 0.109]]
Validation acc: 0.45046620046620045
Validation class_accuracies: [0.6554433221099888, 0.2733446519524618, 0.1375, 0.10897435897435898]
Validation sensitivity: 0.2290909090909091
Validation specificity: 0.6554433221099888
Validation icbhi_score: 0.44226711560044896
Validation roc_auc: None
Validation avg_accuracy: 0.29381558325920243
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 3.125000148429535e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 146s - loss: 0.0497 - accuracy: 0.9818 - 146s/epoch - 2s/step
Epoch 30/60
Validation cm: [[547 252  47  45]
 [355 171  48  15]
 [ 35  21  18   6]
 [ 53  37  45  21]]
Validation normalized_cm: [[0.614 0.283 0.053 0.051]
 [0.603 0.29  0.081 0.025]
 [0.438 0.263 0.225 0.075]
 [0.34  0.237 0.288 0.135]]
Validation acc: 0.44114219114219116
Validation class_accuracies: [0.6139169472502806, 0.2903225806451613, 0.225, 0.1346153846153846]
Validation sensitivity: 0.2545454545454545
Validation specificity: 0.6139169472502806
Validation icbhi_score: 0.43423120089786754
Validation roc_auc: None
Validation avg_accuracy: 0.3159637281277066
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 21 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 153s - loss: 0.0417 - accuracy: 0.9855 - 153s/epoch - 2s/step
Epoch 31/60
Validation cm: [[599 248  22  22]
 [397 154  29   9]
 [ 40  24  14   2]
 [ 70  42  26  18]]
Validation normalized_cm: [[0.672 0.278 0.025 0.025]
 [0.674 0.261 0.049 0.015]
 [0.5   0.3   0.175 0.025]
 [0.449 0.269 0.167 0.115]]
Validation acc: 0.4574592074592075
Validation class_accuracies: [0.6722783389450057, 0.2614601018675722, 0.175, 0.11538461538461539]
Validation sensitivity: 0.22545454545454546
Validation specificity: 0.6722783389450057
Validation icbhi_score: 0.44886644219977556
Validation roc_auc: None
Validation avg_accuracy: 0.3060307640492983
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 22 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 148s - loss: 0.0332 - accuracy: 0.9894 - 148s/epoch - 2s/step
Epoch 32/60
Validation cm: [[552 283  23  33]
 [352 196  26  15]
 [ 35  35   9   1]
 [ 64  47  26  19]]
Validation normalized_cm: [[0.62  0.318 0.026 0.037]
 [0.598 0.333 0.044 0.025]
 [0.438 0.438 0.113 0.013]
 [0.41  0.301 0.167 0.122]]
Validation acc: 0.4522144522144522
Validation class_accuracies: [0.6195286195286195, 0.33276740237691, 0.1125, 0.12179487179487179]
Validation sensitivity: 0.27151515151515154
Validation specificity: 0.6195286195286195
Validation icbhi_score: 0.44552188552188554
Validation roc_auc: None
Validation avg_accuracy: 0.2966477234251003
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 23 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 147s - loss: 0.0346 - accuracy: 0.9880 - 147s/epoch - 2s/step
Epoch 33/60
Validation cm: [[552 282  20  37]
 [357 197  20  15]
 [ 38  31  10   1]
 [ 64  49  23  20]]
Validation normalized_cm: [[0.62  0.316 0.022 0.042]
 [0.606 0.334 0.034 0.025]
 [0.475 0.388 0.125 0.013]
 [0.41  0.314 0.147 0.128]]
Validation acc: 0.45396270396270394
Validation class_accuracies: [0.6195286195286195, 0.33446519524617996, 0.125, 0.1282051282051282]
Validation sensitivity: 0.27515151515151515
Validation specificity: 0.6195286195286195
Validation icbhi_score: 0.4473400673400673
Validation roc_auc: None
Validation avg_accuracy: 0.3017997357449819
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5037037037037037 hasn't increased by 0 in 24 epochs
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 143s - loss: 0.0262 - accuracy: 0.9920 - 143s/epoch - 2s/step
Epoch 34/60
Validation cm: [[587 259  13  32]
 [406 161  11  11]
 [ 42  28   8   2]
 [ 72  51  19  14]]
Validation normalized_cm: [[0.659 0.291 0.015 0.036]
 [0.689 0.273 0.019 0.019]
 [0.525 0.35  0.1   0.025]
 [0.462 0.327 0.122 0.09 ]]
Validation acc: 0.44871794871794873
Validation class_accuracies: [0.6588103254769921, 0.2733446519524618, 0.1, 0.08974358974358974]
Validation sensitivity: 0.22181818181818183
Validation specificity: 0.6588103254769921
Validation icbhi_score: 0.440314253647587
Validation roc_auc: None
Validation avg_accuracy: 0.2804746417932609
Validation one_indexed_epoch: 34
The number of epochs since last 1% equals the patience
Lr has been adjusted to 1.5625000742147677e-05
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
68/68 - 145s - loss: 0.0340 - accuracy: 0.9890 - 145s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5037037037037037
Best cm: [[876  15   0   0]
 [569  20   0   0]
 [ 76   4   0   0]
 [146  10   0   0]]
Best normalized_cm: [[0.983 0.017 0.    0.   ]
 [0.966 0.034 0.    0.   ]
 [0.95  0.05  0.    0.   ]
 [0.936 0.064 0.    0.   ]]
Best acc: 0.5221445221445221
Best class_accuracies: [0.9831649831649831, 0.03395585738539898, 0.0, 0.0]
Best sensitivity: 0.024242424242424242
Best specificity: 0.9831649831649831
Best roc_auc: None
Best avg_accuracy: 0.25428021013759555
Best one_indexed_epoch: 9
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [1.547684669494629, 1.211982011795044, 1.1445882320404053, 1.0442179441452026, 0.9664652347564697, 0.8820915818214417, 0.7541614770889282, 0.6691803932189941, 0.6291865706443787, 0.5954053997993469, 0.5375222563743591, 0.49124976992607117, 0.46126821637153625, 0.4504186511039734, 0.3391173183917999, 0.31843599677085876, 0.2780016362667084, 0.2593452036380768, 0.23197925090789795, 0.17653799057006836, 0.14397116005420685, 0.12669737637043, 0.1132906898856163, 0.1169603168964386, 0.08119280636310577, 0.06818800419569016, 0.05912446230649948, 0.05187691003084183, 0.04965849220752716, 0.04170496016740799, 0.033196691423654556, 0.0346355102956295, 0.026150936260819435, 0.03400221839547157], 'accuracy': [0.4129684865474701, 0.47321224212646484, 0.49988502264022827, 0.5589790940284729, 0.58818119764328, 0.6339388489723206, 0.6916532516479492, 0.7247642874717712, 0.7385606169700623, 0.7650034427642822, 0.7863876819610596, 0.8040928840637207, 0.8275465369224548, 0.825477123260498, 0.8733041882514954, 0.8774430751800537, 0.9006668329238892, 0.896987795829773, 0.9123936295509338, 0.939066469669342, 0.9471142888069153, 0.9528627395629883, 0.9551621079444885, 0.9535525441169739, 0.9694182276725769, 0.9767762422561646, 0.9781559109687805, 0.9806852340698242, 0.981834888458252, 0.9855139255523682, 0.9894228577613831, 0.9880432486534119, 0.9919521808624268, 0.9889630079269409]}
Job dir: ../cache/cw/train129/6
Job id is 7.
Job dir: ../cache/cw/train129/7
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 8.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_106"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_6 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_7 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_15 (Sequential)                      (None, 80, 500, 1)                          4                
                                                                                                              
 sequential_16 (Sequential)                      (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_17 (Sequential)                      (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_18 (Sequential)                      (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate_3 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_19 (Sequential)                      (None, 15, 1024)                            6191296          
                                                                                                              
 sequential_20 (Sequential)                      (None, 4)                                   675288           
                                                                                                              
==============================================================================================================
Total params: 6,875,582
Trainable params: 6,834,076
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
68/68 - 158s - loss: 1.2661 - accuracy: 0.3992 - 158s/epoch - 2s/step
Epoch 2/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 147s - loss: 1.2282 - accuracy: 0.4134 - 147s/epoch - 2s/step
Epoch 3/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.356969696969697 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 146s - loss: 1.2183 - accuracy: 0.4288 - 146s/epoch - 2s/step
Epoch 4/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
-- New best results were achieved. --
There is no such attribute
68/68 - 147s - loss: 1.1608 - accuracy: 0.4677 - 147s/epoch - 2s/step
Epoch 5/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 150s - loss: 1.1053 - accuracy: 0.4691 - 150s/epoch - 2s/step
Epoch 6/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 147s - loss: 1.0553 - accuracy: 0.4983 - 147s/epoch - 2s/step
Epoch 7/60
Validation cm: [[890   1   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[0.999 0.001 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.5186480186480187
Validation class_accuracies: [0.9988776655443322, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 0.9988776655443322
Validation icbhi_score: 0.4994388327721661
Validation roc_auc: None
Validation avg_accuracy: 0.24971941638608305
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 151s - loss: 1.0405 - accuracy: 0.4964 - 151s/epoch - 2s/step
Epoch 8/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 148s - loss: 1.0125 - accuracy: 0.5158 - 148s/epoch - 2s/step
Epoch 9/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
68/68 - 152s - loss: 0.9900 - accuracy: 0.5312 - 152s/epoch - 2s/step
Epoch 10/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
There is no such attribute
68/68 - 147s - loss: 0.9379 - accuracy: 0.5583 - 147s/epoch - 2s/step
Epoch 11/60
Validation cm: [[398 398  91   4]
 [181 381  27   0]
 [ 35  23  20   2]
 [ 27  71  58   0]]
Validation normalized_cm: [[0.447 0.447 0.102 0.004]
 [0.307 0.647 0.046 0.   ]
 [0.438 0.287 0.25  0.025]
 [0.173 0.455 0.372 0.   ]]
Validation acc: 0.46561771561771564
Validation class_accuracies: [0.44668911335578004, 0.6468590831918506, 0.25, 0.0]
Validation sensitivity: 0.4860606060606061
Validation specificity: 0.44668911335578004
Validation icbhi_score: 0.46637485970819303
Validation roc_auc: None
Validation avg_accuracy: 0.33588704913690764
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 152s - loss: 0.8902 - accuracy: 0.5827 - 152s/epoch - 2s/step
Epoch 12/60
Validation cm: [[  0 886   1   4]
 [  1 583   1   4]
 [  0  77   3   0]
 [  0 146   5   5]]
Validation normalized_cm: [[0.    0.994 0.001 0.004]
 [0.002 0.99  0.002 0.007]
 [0.    0.963 0.037 0.   ]
 [0.    0.936 0.032 0.032]]
Validation acc: 0.34440559440559443
Validation class_accuracies: [0.0, 0.9898132427843803, 0.0375, 0.03205128205128205]
Validation sensitivity: 0.7163636363636363
Validation specificity: 0.0
Validation icbhi_score: 0.35818181818181816
Validation roc_auc: None
Validation avg_accuracy: 0.2648411312089156
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
There is no such attribute
68/68 - 147s - loss: 0.8629 - accuracy: 0.6066 - 147s/epoch - 2s/step
Epoch 13/60
Validation cm: [[  0 886   0   5]
 [  0 586   0   3]
 [  0  77   0   3]
 [  0 148   0   8]]
Validation normalized_cm: [[0.    0.994 0.    0.006]
 [0.    0.995 0.    0.005]
 [0.    0.963 0.    0.037]
 [0.    0.949 0.    0.051]]
Validation acc: 0.34615384615384615
Validation class_accuracies: [0.0, 0.9949066213921901, 0.0, 0.05128205128205128]
Validation sensitivity: 0.72
Validation specificity: 0.0
Validation icbhi_score: 0.36
Validation roc_auc: None
Validation avg_accuracy: 0.26154716816856033
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
There is no such attribute
68/68 - 154s - loss: 0.8284 - accuracy: 0.6346 - 154s/epoch - 2s/step
Epoch 14/60
Validation cm: [[  0 879  12   0]
 [  0 580   6   3]
 [  0  77   3   0]
 [  0 132  20   4]]
Validation normalized_cm: [[0.    0.987 0.013 0.   ]
 [0.    0.985 0.01  0.005]
 [0.    0.963 0.037 0.   ]
 [0.    0.846 0.128 0.026]]
Validation acc: 0.34207459207459207
Validation class_accuracies: [0.0, 0.9847198641765704, 0.0375, 0.02564102564102564]
Validation sensitivity: 0.7115151515151515
Validation specificity: 0.0
Validation icbhi_score: 0.3557575757575758
Validation roc_auc: None
Validation avg_accuracy: 0.261965222454399
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
68/68 - 148s - loss: 0.7844 - accuracy: 0.6574 - 148s/epoch - 2s/step
Epoch 15/60
Validation cm: [[  0 886   0   5]
 [  0 585   0   4]
 [  0  79   0   1]
 [  0 147   0   9]]
Validation normalized_cm: [[0.    0.994 0.    0.006]
 [0.    0.993 0.    0.007]
 [0.    0.988 0.    0.013]
 [0.    0.942 0.    0.058]]
Validation acc: 0.34615384615384615
Validation class_accuracies: [0.0, 0.9932088285229203, 0.0, 0.057692307692307696]
Validation sensitivity: 0.72
Validation specificity: 0.0
Validation icbhi_score: 0.36
Validation roc_auc: None
Validation avg_accuracy: 0.26272528405380696
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
There is no such attribute
68/68 - 153s - loss: 0.7214 - accuracy: 0.6967 - 153s/epoch - 2s/step
Epoch 16/60
Validation cm: [[  0 888   0   3]
 [  1 579   1   8]
 [  0  77   0   3]
 [  0 147   0   9]]
Validation normalized_cm: [[0.    0.997 0.    0.003]
 [0.002 0.983 0.002 0.014]
 [0.    0.963 0.    0.037]
 [0.    0.942 0.    0.058]]
Validation acc: 0.34265734265734266
Validation class_accuracies: [0.0, 0.9830220713073005, 0.0, 0.057692307692307696]
Validation sensitivity: 0.7127272727272728
Validation specificity: 0.0
Validation icbhi_score: 0.3563636363636364
Validation roc_auc: None
Validation avg_accuracy: 0.260178594749902
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
There is no such attribute
68/68 - 147s - loss: 0.6783 - accuracy: 0.7172 - 147s/epoch - 2s/step
Epoch 17/60
Validation cm: [[ 87 786   2  16]
 [123 444  11  11]
 [ 11  64   3   2]
 [ 47  78   4  27]]
Validation normalized_cm: [[0.098 0.882 0.002 0.018]
 [0.209 0.754 0.019 0.019]
 [0.138 0.8   0.037 0.025]
 [0.301 0.5   0.026 0.173]]
Validation acc: 0.3269230769230769
Validation class_accuracies: [0.09764309764309764, 0.7538200339558574, 0.0375, 0.17307692307692307]
Validation sensitivity: 0.5745454545454546
Validation specificity: 0.09764309764309764
Validation icbhi_score: 0.3360942760942761
Validation roc_auc: None
Validation avg_accuracy: 0.26551001366896954
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
There is no such attribute
68/68 - 153s - loss: 0.6465 - accuracy: 0.7413 - 153s/epoch - 2s/step
Epoch 18/60
Validation cm: [[479 369   0  43]
 [403 167  13   6]
 [ 37  38   0   5]
 [ 82  45   4  25]]
Validation normalized_cm: [[0.538 0.414 0.    0.048]
 [0.684 0.284 0.022 0.01 ]
 [0.463 0.475 0.    0.062]
 [0.526 0.288 0.026 0.16 ]]
Validation acc: 0.391025641025641
Validation class_accuracies: [0.5375982042648709, 0.2835314091680815, 0.0, 0.16025641025641027]
Validation sensitivity: 0.23272727272727273
Validation specificity: 0.5375982042648709
Validation icbhi_score: 0.38516273849607185
Validation roc_auc: None
Validation avg_accuracy: 0.24534650592234067
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
There is no such attribute
68/68 - 148s - loss: 0.6151 - accuracy: 0.7563 - 148s/epoch - 2s/step
Epoch 19/60
Validation cm: [[692  83  37  79]
 [469  88  12  20]
 [ 52  13   6   9]
 [ 82  28  30  16]]
Validation normalized_cm: [[0.777 0.093 0.042 0.089]
 [0.796 0.149 0.02  0.034]
 [0.65  0.163 0.075 0.113]
 [0.526 0.179 0.192 0.103]]
Validation acc: 0.46736596736596736
Validation class_accuracies: [0.77665544332211, 0.1494057724957555, 0.075, 0.10256410256410256]
Validation sensitivity: 0.13333333333333333
Validation specificity: 0.77665544332211
Validation icbhi_score: 0.45499438832772165
Validation roc_auc: None
Validation avg_accuracy: 0.27590632959549205
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
68/68 - 154s - loss: 0.5714 - accuracy: 0.7724 - 154s/epoch - 2s/step
Epoch 20/60
Validation cm: [[676 106  32  77]
 [477  84   7  21]
 [ 46  14  12   8]
 [ 74  35  32  15]]
Validation normalized_cm: [[0.759 0.119 0.036 0.086]
 [0.81  0.143 0.012 0.036]
 [0.575 0.175 0.15  0.1  ]
 [0.474 0.224 0.205 0.096]]
Validation acc: 0.4586247086247086
Validation class_accuracies: [0.7586980920314254, 0.14261460101867574, 0.15, 0.09615384615384616]
Validation sensitivity: 0.13454545454545455
Validation specificity: 0.7586980920314254
Validation icbhi_score: 0.44662177328843994
Validation roc_auc: None
Validation avg_accuracy: 0.28686663480098684
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5 hasn't increased by 0 in 16 epochs
There is no such attribute
68/68 - 147s - loss: 0.5030 - accuracy: 0.8073 - 147s/epoch - 2s/step
Epoch 21/60
Validation cm: [[300 590   0   1]
 [235 343   7   4]
 [ 11  63   0   6]
 [ 52  75   0  29]]
Validation normalized_cm: [[0.337 0.662 0.    0.001]
 [0.399 0.582 0.012 0.007]
 [0.138 0.787 0.    0.075]
 [0.333 0.481 0.    0.186]]
Validation acc: 0.3916083916083916
Validation class_accuracies: [0.3367003367003367, 0.5823429541595926, 0.0, 0.1858974358974359]
Validation sensitivity: 0.4509090909090909
Validation specificity: 0.3367003367003367
Validation icbhi_score: 0.3938047138047138
Validation roc_auc: None
Validation avg_accuracy: 0.2762351816893413
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5 hasn't increased by 0 in 17 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
68/68 - 153s - loss: 0.4717 - accuracy: 0.8220 - 153s/epoch - 2s/step
Epoch 22/60
Validation cm: [[603 197  31  60]
 [411 151  19   8]
 [ 37  25  10   8]
 [ 62  48  17  29]]
Validation normalized_cm: [[0.677 0.221 0.035 0.067]
 [0.698 0.256 0.032 0.014]
 [0.463 0.312 0.125 0.1  ]
 [0.397 0.308 0.109 0.186]]
Validation acc: 0.4621212121212121
Validation class_accuracies: [0.6767676767676768, 0.2563667232597623, 0.125, 0.1858974358974359]
Validation sensitivity: 0.23030303030303031
Validation specificity: 0.6767676767676768
Validation icbhi_score: 0.45353535353535357
Validation roc_auc: None
Validation avg_accuracy: 0.31100795898121875
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5 hasn't increased by 0 in 18 epochs
There is no such attribute
68/68 - 147s - loss: 0.4492 - accuracy: 0.8298 - 147s/epoch - 2s/step
Epoch 23/60
Validation cm: [[615 233  26  17]
 [387 182  16   4]
 [ 49  17   7   7]
 [ 55  59  18  24]]
Validation normalized_cm: [[0.69  0.262 0.029 0.019]
 [0.657 0.309 0.027 0.007]
 [0.613 0.212 0.087 0.087]
 [0.353 0.378 0.115 0.154]]
Validation acc: 0.4825174825174825
Validation class_accuracies: [0.6902356902356902, 0.3089983022071307, 0.0875, 0.15384615384615385]
Validation sensitivity: 0.2581818181818182
Validation specificity: 0.6902356902356902
Validation icbhi_score: 0.4742087542087542
Validation roc_auc: None
Validation avg_accuracy: 0.3101450365722437
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5 hasn't increased by 0 in 19 epochs
There is no such attribute
68/68 - 153s - loss: 0.4122 - accuracy: 0.8473 - 153s/epoch - 2s/step
Epoch 24/60
Validation cm: [[547 223  49  72]
 [375 180  16  18]
 [ 40  21   5  14]
 [ 55  54  18  29]]
Validation normalized_cm: [[0.614 0.25  0.055 0.081]
 [0.637 0.306 0.027 0.031]
 [0.5   0.263 0.062 0.175]
 [0.353 0.346 0.115 0.186]]
Validation acc: 0.44347319347319347
Validation class_accuracies: [0.6139169472502806, 0.30560271646859083, 0.0625, 0.1858974358974359]
Validation sensitivity: 0.2593939393939394
Validation specificity: 0.6139169472502806
Validation icbhi_score: 0.43665544332211
Validation roc_auc: None
Validation avg_accuracy: 0.2919792749040768
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5 hasn't increased by 0 in 20 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
68/68 - 148s - loss: 0.4132 - accuracy: 0.8416 - 148s/epoch - 2s/step
Epoch 25/60
Validation cm: [[ 30 854   0   7]
 [ 27 552   0  10]
 [  0  73   0   7]
 [  9 118   0  29]]
Validation normalized_cm: [[0.034 0.958 0.    0.008]
 [0.046 0.937 0.    0.017]
 [0.    0.912 0.    0.087]
 [0.058 0.756 0.    0.186]]
Validation acc: 0.3560606060606061
Validation class_accuracies: [0.03367003367003367, 0.9371816638370118, 0.0, 0.1858974358974359]
Validation sensitivity: 0.7042424242424242
Validation specificity: 0.03367003367003367
Validation icbhi_score: 0.3689562289562289
Validation roc_auc: None
Validation avg_accuracy: 0.2891872833511203
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5 hasn't increased by 0 in 21 epochs
There is no such attribute
68/68 - 154s - loss: 0.3477 - accuracy: 0.8731 - 154s/epoch - 2s/step
Epoch 26/60
Validation cm: [[531 244  41  75]
 [329 235  13  12]
 [ 33  28   6  13]
 [ 54  55  18  29]]
Validation normalized_cm: [[0.596 0.274 0.046 0.084]
 [0.559 0.399 0.022 0.02 ]
 [0.412 0.35  0.075 0.163]
 [0.346 0.353 0.115 0.186]]
Validation acc: 0.46678321678321677
Validation class_accuracies: [0.5959595959595959, 0.398981324278438, 0.075, 0.1858974358974359]
Validation sensitivity: 0.32727272727272727
Validation specificity: 0.5959595959595959
Validation icbhi_score: 0.4616161616161616
Validation roc_auc: None
Validation avg_accuracy: 0.31395958903386745
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5 hasn't increased by 0 in 22 epochs
There is no such attribute
68/68 - 166s - loss: 0.3430 - accuracy: 0.8710 - 166s/epoch - 2s/step
Epoch 27/60
Validation cm: [[526 292  21  52]
 [368 197  17   7]
 [ 35  34   5   6]
 [ 78  32  20  26]]
Validation normalized_cm: [[0.59  0.328 0.024 0.058]
 [0.625 0.334 0.029 0.012]
 [0.438 0.425 0.062 0.075]
 [0.5   0.205 0.128 0.167]]
Validation acc: 0.4393939393939394
Validation class_accuracies: [0.590347923681257, 0.33446519524617996, 0.0625, 0.16666666666666666]
Validation sensitivity: 0.27636363636363637
Validation specificity: 0.590347923681257
Validation icbhi_score: 0.4333557800224467
Validation roc_auc: None
Validation avg_accuracy: 0.2884949463985259
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5 hasn't increased by 0 in 23 epochs
There is no such attribute
68/68 - 156s - loss: 0.3185 - accuracy: 0.8846 - 156s/epoch - 2s/step
Epoch 28/60
Validation cm: [[512 251  56  72]
 [331 225  18  15]
 [ 32  19  14  15]
 [ 48  55  27  26]]
Validation normalized_cm: [[0.575 0.282 0.063 0.081]
 [0.562 0.382 0.031 0.025]
 [0.4   0.237 0.175 0.188]
 [0.308 0.353 0.173 0.167]]
Validation acc: 0.4527972027972028
Validation class_accuracies: [0.574635241301908, 0.38200339558573854, 0.175, 0.16666666666666666]
Validation sensitivity: 0.3212121212121212
Validation specificity: 0.574635241301908
Validation icbhi_score: 0.44792368125701465
Validation roc_auc: None
Validation avg_accuracy: 0.3245763258885783
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5 hasn't increased by 0 in 24 epochs
There is no such attribute
68/68 - 151s - loss: 0.3126 - accuracy: 0.8866 - 151s/epoch - 2s/step
Epoch 29/60
Validation cm: [[542 240  51  58]
 [322 235  20  12]
 [ 42  21   5  12]
 [ 67  40  34  15]]
Validation normalized_cm: [[0.608 0.269 0.057 0.065]
 [0.547 0.399 0.034 0.02 ]
 [0.525 0.263 0.062 0.15 ]
 [0.429 0.256 0.218 0.096]]
Validation acc: 0.46445221445221446
Validation class_accuracies: [0.6083052749719416, 0.398981324278438, 0.0625, 0.09615384615384616]
Validation sensitivity: 0.3090909090909091
Validation specificity: 0.6083052749719416
Validation icbhi_score: 0.45869809203142536
Validation roc_auc: None
Validation avg_accuracy: 0.2914851113510565
Validation one_indexed_epoch: 29
The number of epochs since last 1% equals the patience
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
68/68 - 155s - loss: 0.3078 - accuracy: 0.8887 - 155s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5
Best cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Best normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Best acc: 0.5192307692307693
Best class_accuracies: [1.0, 0.0, 0.0, 0.0]
Best sensitivity: 0.0
Best specificity: 1.0
Best roc_auc: None
Best avg_accuracy: 0.25
Best one_indexed_epoch: 4
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
{'loss': [1.266072392463684, 1.2282464504241943, 1.2183074951171875, 1.1608483791351318, 1.1053168773651123, 1.0553257465362549, 1.0405282974243164, 1.012545108795166, 0.9900032877922058, 0.9378672242164612, 0.8902296423912048, 0.8628535866737366, 0.8284241557121277, 0.7843611836433411, 0.7213602066040039, 0.6783061027526855, 0.6464536786079407, 0.6150555610656738, 0.5714374780654907, 0.5030146837234497, 0.4716789126396179, 0.4491901099681854, 0.4121844470500946, 0.41322776675224304, 0.3476991057395935, 0.3429591655731201, 0.3184746503829956, 0.31257930397987366, 0.30782970786094666], 'accuracy': [0.39917221665382385, 0.4134283661842346, 0.4288341999053955, 0.4676937162876129, 0.4690733551979065, 0.4982754588127136, 0.4964359700679779, 0.5157507658004761, 0.531156599521637, 0.5582892894744873, 0.5826627016067505, 0.6065762042999268, 0.6346286535263062, 0.6573925018310547, 0.6967118978500366, 0.7171763777732849, 0.7413198351860046, 0.7562658190727234, 0.7723614573478699, 0.80731201171875, 0.8220280408859253, 0.8298459649085999, 0.8473212122917175, 0.8415727615356445, 0.8730742931365967, 0.8710048198699951, 0.8845711946487427, 0.8866406083106995, 0.8887100219726562]}
Job dir: ../cache/cw/train129/8
Job id is 9.
Job dir: ../cache/cw/train129/9
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 10.
lengths
4349
1716
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 0 none's, 0 crakles, 0 wheezes and 0 both ---
--- Final Validation dataset contains 1716 elements, with 0 none, 0 crackles, 0 wheezes and 0 both ---
Initializing weights...
Model: "leaf_model9_model_129"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_8 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_9 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_21 (Sequential)                      (None, 80, 500, 1)                          4                
                                                                                                              
 sequential_22 (Sequential)                      (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_23 (Sequential)                      (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_24 (Sequential)                      (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate_4 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_25 (Sequential)                      (None, 15, 1024)                            6191296          
                                                                                                              
 sequential_26 (Sequential)                      (None, 4)                                   1365978          
                                                                                                              
==============================================================================================================
Total params: 7,566,272
Trainable params: 7,524,766
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/60
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
68/68 - 160s - loss: 1.2963 - accuracy: 0.3702 - 160s/epoch - 2s/step
Epoch 2/60
Validation cm: [[891   0   0   0]
 [589   0   0   0]
 [ 80   0   0   0]
 [156   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5192307692307693
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
-- New best results were achieved. --
There is no such attribute
68/68 - 152s - loss: 1.2504 - accuracy: 0.3863 - 152s/epoch - 2s/step
Epoch 3/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
There is no such attribute
68/68 - 147s - loss: 1.1956 - accuracy: 0.4235 - 147s/epoch - 2s/step
Epoch 4/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
There is no such attribute
68/68 - 152s - loss: 1.1255 - accuracy: 0.4606 - 152s/epoch - 2s/step
Epoch 5/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
There is no such attribute
68/68 - 148s - loss: 1.0676 - accuracy: 0.4934 - 148s/epoch - 2s/step
Epoch 6/60
Validation cm: [[  0 891   0   0]
 [  0 589   0   0]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.34324009324009325
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation sensitivity: 0.713939393939394
Validation specificity: 0.0
Validation icbhi_score: 0.356969696969697
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 6
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
There is no such attribute
68/68 - 151s - loss: 1.0542 - accuracy: 0.4932 - 151s/epoch - 2s/step
Epoch 7/60
Validation cm: [[  0 890   0   1]
 [  0 588   0   1]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0.    0.999 0.    0.001]
 [0.    0.998 0.    0.002]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.34265734265734266
Validation class_accuracies: [0.0, 0.99830220713073, 0.0, 0.0]
Validation sensitivity: 0.7127272727272728
Validation specificity: 0.0
Validation icbhi_score: 0.3563636363636364
Validation roc_auc: None
Validation avg_accuracy: 0.2495755517826825
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
68/68 - 152s - loss: 1.0289 - accuracy: 0.4879 - 152s/epoch - 2s/step
Epoch 8/60
Validation cm: [[263 628   0   0]
 [ 83 505   0   1]
 [ 26  54   0   0]
 [ 19 137   0   0]]
Validation normalized_cm: [[0.295 0.705 0.    0.   ]
 [0.141 0.857 0.    0.002]
 [0.325 0.675 0.    0.   ]
 [0.122 0.878 0.    0.   ]]
Validation acc: 0.44755244755244755
Validation class_accuracies: [0.2951739618406285, 0.8573853989813243, 0.0, 0.0]
Validation sensitivity: 0.6121212121212121
Validation specificity: 0.2951739618406285
Validation icbhi_score: 0.4536475869809203
Validation roc_auc: None
Validation avg_accuracy: 0.2881398402054882
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
There is no such attribute
68/68 - 151s - loss: 0.9706 - accuracy: 0.5358 - 151s/epoch - 2s/step
Epoch 9/60
Validation cm: [[  7 884   0   0]
 [  2 586   0   1]
 [  0  80   0   0]
 [  0 156   0   0]]
Validation normalized_cm: [[0.008 0.992 0.    0.   ]
 [0.003 0.995 0.    0.002]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.34557109557109555
Validation class_accuracies: [0.007856341189674524, 0.9949066213921901, 0.0, 0.0]
Validation sensitivity: 0.7103030303030303
Validation specificity: 0.007856341189674524
Validation icbhi_score: 0.3590796857463524
Validation roc_auc: None
Validation avg_accuracy: 0.25069074064546615
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
There is no such attribute
68/68 - 152s - loss: 0.9250 - accuracy: 0.5542 - 152s/epoch - 2s/step
Epoch 10/60
Validation cm: [[868  18   5   0]
 [573  15   1   0]
 [ 75   1   4   0]
 [146   6   4   0]]
Validation normalized_cm: [[0.974 0.02  0.006 0.   ]
 [0.973 0.025 0.002 0.   ]
 [0.938 0.013 0.05  0.   ]
 [0.936 0.038 0.026 0.   ]]
Validation acc: 0.5168997668997669
Validation class_accuracies: [0.9741863075196409, 0.025466893039049237, 0.05, 0.0]
Validation sensitivity: 0.02303030303030303
Validation specificity: 0.9741863075196409
Validation icbhi_score: 0.49860830527497196
Validation roc_auc: None
Validation avg_accuracy: 0.2624133001396725
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
There is no such attribute
68/68 - 153s - loss: 0.9147 - accuracy: 0.5636 - 153s/epoch - 2s/step
Epoch 11/60
