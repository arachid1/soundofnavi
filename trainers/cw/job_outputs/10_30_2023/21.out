Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train21
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 sincnet (SincNet)                               multiple                                    320              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,272
Trainable params: 105,776
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 179s - loss: 0.4405 - accuracy: 0.5874 - 179s/epoch - 543ms/step
Validation cm: [[686   7  37  10]
 [ 69   0  10  13]
 [ 37   0  31   9]
 [ 51   0  70   9]]
Validation normalized_cm: [[0.927 0.009 0.05  0.014]
 [0.75  0.    0.109 0.141]
 [0.481 0.    0.403 0.117]
 [0.392 0.    0.538 0.069]]
Validation acc: 0.6987487969201155
Validation class_accuracies: [0.927027027027027, 0.0, 0.4025974025974026, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.34971379971379973
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 174s - loss: 0.3684 - accuracy: 0.6003 - 174s/epoch - 527ms/step
Validation cm: [[664  29  42   5]
 [ 61   8  16   7]
 [ 36   0  32   9]
 [ 36   1  86   7]]
Validation normalized_cm: [[0.897 0.039 0.057 0.007]
 [0.663 0.087 0.174 0.076]
 [0.468 0.    0.416 0.117]
 [0.277 0.008 0.662 0.054]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.8972972972972973, 0.08695652173913043, 0.4155844155844156, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36342109711674936
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 174s - loss: 0.3387 - accuracy: 0.6307 - 174s/epoch - 527ms/step
Validation cm: [[598 110  24   8]
 [ 29  40   9  14]
 [ 45   8  14  10]
 [ 18  29  64  19]]
Validation normalized_cm: [[0.808 0.149 0.032 0.011]
 [0.315 0.435 0.098 0.152]
 [0.584 0.104 0.182 0.13 ]
 [0.138 0.223 0.492 0.146]]
Validation acc: 0.6458132820019249
Validation class_accuracies: [0.8081081081081081, 0.43478260869565216, 0.18181818181818182, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39271568619394703
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 175s - loss: 0.3173 - accuracy: 0.6345 - 175s/epoch - 529ms/step
Validation cm: [[615 114   9   2]
 [ 31  52   6   3]
 [ 48   9  14   6]
 [ 32  23  47  28]]
Validation normalized_cm: [[0.831 0.154 0.012 0.003]
 [0.337 0.565 0.065 0.033]
 [0.623 0.117 0.182 0.078]
 [0.246 0.177 0.362 0.215]]
Validation acc: 0.6823869104908566
Validation class_accuracies: [0.831081081081081, 0.5652173913043478, 0.18181818181818182, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4483753173970565
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 174s - loss: 0.2948 - accuracy: 0.6445 - 174s/epoch - 528ms/step
Validation cm: [[529  61  66  84]
 [ 26  14   4  48]
 [ 22   5  26  24]
 [  8   8  51  63]]
Validation normalized_cm: [[0.715 0.082 0.089 0.114]
 [0.283 0.152 0.043 0.522]
 [0.286 0.065 0.338 0.312]
 [0.062 0.062 0.392 0.485]]
Validation acc: 0.6082771896053898
Validation class_accuracies: [0.7148648648648649, 0.15217391304347827, 0.33766233766233766, 0.4846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4223291250465164
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.4483753173970565 hasn't increased by 0 in 1 epochs
330/330 - 174s - loss: 0.2735 - accuracy: 0.6498 - 174s/epoch - 528ms/step
Validation cm: [[599 104  27  10]
 [ 33  36   5  18]
 [ 34   3  31   9]
 [ 24  23  53  30]]
Validation normalized_cm: [[0.809 0.141 0.036 0.014]
 [0.359 0.391 0.054 0.196]
 [0.442 0.039 0.403 0.117]
 [0.185 0.177 0.408 0.231]]
Validation acc: 0.6698748796920115
Validation class_accuracies: [0.8094594594594594, 0.391304347826087, 0.4025974025974026, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.458532610163045
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 174s - loss: 0.2567 - accuracy: 0.6975 - 174s/epoch - 528ms/step
Validation cm: [[545  42  83  70]
 [ 21  25   5  41]
 [ 26   3  32  16]
 [ 17   3  37  73]]
Validation normalized_cm: [[0.736 0.057 0.112 0.095]
 [0.228 0.272 0.054 0.446]
 [0.338 0.039 0.416 0.208]
 [0.131 0.023 0.285 0.562]]
Validation acc: 0.6496631376323387
Validation class_accuracies: [0.7364864864864865, 0.2717391304347826, 0.4155844155844156, 0.5615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4963371235110366
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 174s - loss: 0.2329 - accuracy: 0.6999 - 174s/epoch - 527ms/step
Validation cm: [[600  58  72  10]
 [ 40  27  11  14]
 [ 31   2  37   7]
 [ 28  12  63  27]]
Validation normalized_cm: [[0.811 0.078 0.097 0.014]
 [0.435 0.293 0.12  0.152]
 [0.403 0.026 0.481 0.091]
 [0.215 0.092 0.485 0.208]]
Validation acc: 0.6650625601539942
Validation class_accuracies: [0.8108108108108109, 0.29347826086956524, 0.4805194805194805, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4481252149730411
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.4963371235110366 hasn't increased by 0 in 1 epochs
330/330 - 174s - loss: 0.2150 - accuracy: 0.6813 - 174s/epoch - 528ms/step
Validation cm: [[633  70  27  10]
 [ 44  24  11  13]
 [ 38   2  29   8]
 [ 30  12  68  20]]
Validation normalized_cm: [[0.855 0.095 0.036 0.014]
 [0.478 0.261 0.12  0.141]
 [0.494 0.026 0.377 0.104]
 [0.231 0.092 0.523 0.154]]
Validation acc: 0.6794995187680462
Validation class_accuracies: [0.8554054054054054, 0.2608695652173913, 0.37662337662337664, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4116861252730818
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.4963371235110366 hasn't increased by 0 in 2 epochs
330/330 - 174s - loss: 0.1881 - accuracy: 0.7180 - 174s/epoch - 528ms/step
Validation cm: [[610 102  17  11]
 [ 34  32   7  19]
 [ 46   8  13  10]
 [ 21  24  54  31]]
Validation normalized_cm: [[0.824 0.138 0.023 0.015]
 [0.37  0.348 0.076 0.207]
 [0.597 0.104 0.169 0.13 ]
 [0.162 0.185 0.415 0.238]]
Validation acc: 0.6602502406159769
Validation class_accuracies: [0.8243243243243243, 0.34782608695652173, 0.16883116883116883, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39486077964338834
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.4963371235110366 hasn't increased by 0 in 3 epochs
Lr has been adjusted to 0.0005000000237487257
330/330 - 174s - loss: 0.1762 - accuracy: 0.7066 - 174s/epoch - 529ms/step
Validation cm: [[662  45  15  18]
 [ 44  26   8  14]
 [ 50   5  17   5]
 [ 41  10  52  27]]
Validation normalized_cm: [[0.895 0.061 0.02  0.024]
 [0.478 0.283 0.087 0.152]
 [0.649 0.065 0.221 0.065]
 [0.315 0.077 0.4   0.208]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.8945945945945946, 0.2826086956521739, 0.22077922077922077, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4014187046795742
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The validation tracker metric at 0.4963371235110366 hasn't increased by 0 in 4 epochs
330/330 - 175s - loss: 0.1315 - accuracy: 0.7070 - 175s/epoch - 529ms/step
Validation cm: [[648  61  23   8]
 [ 43  27   6  16]
 [ 37   5  28   7]
 [ 30  16  54  30]]
Validation normalized_cm: [[0.876 0.082 0.031 0.011]
 [0.467 0.293 0.065 0.174]
 [0.481 0.065 0.364 0.091]
 [0.231 0.123 0.415 0.231]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.8756756756756757, 0.29347826086956524, 0.36363636363636365, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4408898827377089
Validation one_indexed_epoch: 13
Epoch 13/17
[[0. 0.]]
The validation tracker metric at 0.4963371235110366 hasn't increased by 0 in 5 epochs
330/330 - 174s - loss: 0.1079 - accuracy: 0.7001 - 174s/epoch - 528ms/step
Validation cm: [[655  67   9   9]
 [ 39  34   7  12]
 [ 48   5  19   5]
 [ 53  15  40  22]]
Validation normalized_cm: [[0.885 0.091 0.012 0.012]
 [0.424 0.37  0.076 0.13 ]
 [0.623 0.065 0.247 0.065]
 [0.408 0.115 0.308 0.169]]
Validation acc: 0.7025986525505293
Validation class_accuracies: [0.8851351351351351, 0.3695652173913043, 0.24675324675324675, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41767109212761383
Validation one_indexed_epoch: 14
Epoch 14/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
Lr has been adjusted to 0.0002500000118743628
330/330 - 174s - loss: 0.0949 - accuracy: 0.7039 - 174s/epoch - 528ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4963371235110366
Best cm: [[545  42  83  70]
 [ 21  25   5  41]
 [ 26   3  32  16]
 [ 17   3  37  73]]
Best normalized_cm: [[0.736 0.057 0.112 0.095]
 [0.228 0.272 0.054 0.446]
 [0.338 0.039 0.416 0.208]
 [0.131 0.023 0.285 0.562]]
Best acc: 0.6496631376323387
Best class_accuracies: [0.7364864864864865, 0.2717391304347826, 0.4155844155844156, 0.5615384615384615]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 8
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
