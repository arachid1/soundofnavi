Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train30
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    840              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,792
Trainable params: 106,296
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 731s - loss: 0.4376 - accuracy: 0.5711 - 731s/epoch - 2s/step
Validation cm: [[679  49   9   3]
 [ 52  24  11   5]
 [ 46   4  25   2]
 [ 54   2  67   7]]
Validation normalized_cm: [[0.918 0.066 0.012 0.004]
 [0.565 0.261 0.12  0.054]
 [0.597 0.052 0.325 0.026]
 [0.415 0.015 0.515 0.054]]
Validation acc: 0.7074109720885466
Validation class_accuracies: [0.9175675675675675, 0.2608695652173913, 0.3246753246753247, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38923965282660933
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 724s - loss: 0.3484 - accuracy: 0.6493 - 724s/epoch - 2s/step
Validation cm: [[713  18   4   5]
 [ 70   8  13   1]
 [ 66   0  10   1]
 [ 56   0  69   5]]
Validation normalized_cm: [[0.964 0.024 0.005 0.007]
 [0.761 0.087 0.141 0.011]
 [0.857 0.    0.13  0.013]
 [0.431 0.    0.531 0.038]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.9635135135135136, 0.08695652173913043, 0.12987012987012986, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3047004258960781
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
The validation tracker metric at 0.38923965282660933 hasn't increased by 0 in 1 epochs
330/330 - 725s - loss: 0.3178 - accuracy: 0.6831 - 725s/epoch - 2s/step
Validation cm: [[663  59   6  12]
 [ 46  35   9   2]
 [ 52   4  20   1]
 [ 53   1  66  10]]
Validation normalized_cm: [[0.896 0.08  0.008 0.016]
 [0.5   0.38  0.098 0.022]
 [0.675 0.052 0.26  0.013]
 [0.408 0.008 0.508 0.077]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8959459459459459, 0.3804347826086957, 0.2597402597402597, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40326101630449457
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 724s - loss: 0.2839 - accuracy: 0.6774 - 724s/epoch - 2s/step
Validation cm: [[641  87   4   8]
 [ 41  47   1   3]
 [ 52   6  15   4]
 [ 79   2  39  10]]
Validation normalized_cm: [[0.866 0.118 0.005 0.011]
 [0.446 0.511 0.011 0.033]
 [0.675 0.078 0.195 0.052]
 [0.608 0.015 0.3   0.077]]
Validation acc: 0.6862367661212705
Validation class_accuracies: [0.8662162162162163, 0.5108695652173914, 0.19480519480519481, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41220351329046984
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 722s - loss: 0.2559 - accuracy: 0.6848 - 722s/epoch - 2s/step
Validation cm: [[589 115  10  26]
 [ 15  51   6  20]
 [ 30  15  20  12]
 [ 25  21  42  42]]
Validation normalized_cm: [[0.796 0.155 0.014 0.035]
 [0.163 0.554 0.065 0.217]
 [0.39  0.195 0.26  0.156]
 [0.192 0.162 0.323 0.323]]
Validation acc: 0.6756496631376323
Validation class_accuracies: [0.7959459459459459, 0.5543478260869565, 0.2597402597402597, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4832777387125213
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 720s - loss: 0.2241 - accuracy: 0.6806 - 720s/epoch - 2s/step
Validation cm: [[600  74  46  20]
 [ 23  36  17  16]
 [ 24   6  41   6]
 [ 33  11  74  12]]
Validation normalized_cm: [[0.811 0.1   0.062 0.027]
 [0.25  0.391 0.185 0.174]
 [0.312 0.078 0.532 0.078]
 [0.254 0.085 0.569 0.092]]
Validation acc: 0.6631376323387873
Validation class_accuracies: [0.8108108108108109, 0.391304347826087, 0.5324675324675324, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.45672259585303066
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.4832777387125213 hasn't increased by 0 in 1 epochs
330/330 - 721s - loss: 0.1932 - accuracy: 0.7110 - 721s/epoch - 2s/step
Validation cm: [[617  68  33  22]
 [ 31  40   9  12]
 [ 31   4  32  10]
 [ 54  13  37  26]]
Validation normalized_cm: [[0.834 0.092 0.045 0.03 ]
 [0.337 0.435 0.098 0.13 ]
 [0.403 0.052 0.416 0.13 ]
 [0.415 0.1   0.285 0.2  ]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.8337837837837838, 0.43478260869565216, 0.4155844155844156, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4710377020159629
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.4832777387125213 hasn't increased by 0 in 2 epochs
330/330 - 721s - loss: 0.1636 - accuracy: 0.7094 - 721s/epoch - 2s/step
Validation cm: [[537 108  60  35]
 [ 21  41   8  22]
 [ 17   7  29  24]
 [ 24   9  45  52]]
Validation normalized_cm: [[0.726 0.146 0.081 0.047]
 [0.228 0.446 0.087 0.239]
 [0.221 0.091 0.377 0.312]
 [0.185 0.069 0.346 0.4  ]]
Validation acc: 0.6342637151106834
Validation class_accuracies: [0.7256756756756757, 0.44565217391304346, 0.37662337662337664, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.486987806553024
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 722s - loss: 0.1396 - accuracy: 0.6867 - 722s/epoch - 2s/step
Validation cm: [[579  94  44  23]
 [ 20  49   7  16]
 [ 17   8  29  23]
 [ 22   7  75  26]]
Validation normalized_cm: [[0.782 0.127 0.059 0.031]
 [0.217 0.533 0.076 0.174]
 [0.221 0.104 0.377 0.299]
 [0.169 0.054 0.577 0.2  ]]
Validation acc: 0.6573628488931665
Validation class_accuracies: [0.7824324324324324, 0.532608695652174, 0.37662337662337664, 0.2]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47291612617699574
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.486987806553024 hasn't increased by 0 in 1 epochs
330/330 - 716s - loss: 0.1137 - accuracy: 0.6956 - 716s/epoch - 2s/step
Validation cm: [[573 108  42  17]
 [ 28  43   8  13]
 [ 23   7  34  13]
 [ 24  12  62  32]]
Validation normalized_cm: [[0.774 0.146 0.057 0.023]
 [0.304 0.467 0.087 0.141]
 [0.299 0.091 0.442 0.169]
 [0.185 0.092 0.477 0.246]]
Validation acc: 0.6564003849855631
Validation class_accuracies: [0.7743243243243243, 0.4673913043478261, 0.44155844155844154, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48235697909610953
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.486987806553024 hasn't increased by 0 in 2 epochs
330/330 - 715s - loss: 0.0999 - accuracy: 0.6929 - 715s/epoch - 2s/step
Validation cm: [[596  91  28  25]
 [ 22  43   8  19]
 [ 27   8  32  10]
 [ 21  16  54  39]]
Validation normalized_cm: [[0.805 0.123 0.038 0.034]
 [0.239 0.467 0.087 0.207]
 [0.351 0.104 0.416 0.13 ]
 [0.162 0.123 0.415 0.3  ]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.8054054054054054, 0.4673913043478261, 0.4155844155844156, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4970952813344118
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 714s - loss: 0.0918 - accuracy: 0.6808 - 714s/epoch - 2s/step
Validation cm: [[659  52  18  11]
 [ 47  29   9   7]
 [ 38   8  25   6]
 [ 51   5  60  14]]
Validation normalized_cm: [[0.891 0.07  0.024 0.015]
 [0.511 0.315 0.098 0.076]
 [0.494 0.104 0.325 0.078]
 [0.392 0.038 0.462 0.108]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.8905405405405405, 0.31521739130434784, 0.3246753246753247, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4095313910531302
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.4970952813344118 hasn't increased by 0 in 1 epochs
330/330 - 716s - loss: 0.0656 - accuracy: 0.6730 - 716s/epoch - 2s/step
Validation cm: [[565  93  58  24]
 [ 31  36  11  14]
 [ 28   7  25  17]
 [ 21  11  48  50]]
Validation normalized_cm: [[0.764 0.126 0.078 0.032]
 [0.337 0.391 0.12  0.152]
 [0.364 0.091 0.325 0.221]
 [0.162 0.085 0.369 0.385]]
Validation acc: 0.6506256015399422
Validation class_accuracies: [0.7635135135135135, 0.391304347826087, 0.3246753246753247, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46602714265757744
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.4970952813344118 hasn't increased by 0 in 2 epochs
330/330 - 713s - loss: 0.0554 - accuracy: 0.6734 - 713s/epoch - 2s/step
Validation cm: [[498 138  42  62]
 [ 13  44   7  28]
 [ 20   9  17  31]
 [ 12  18  33  67]]
Validation normalized_cm: [[0.673 0.186 0.057 0.084]
 [0.141 0.478 0.076 0.304]
 [0.26  0.117 0.221 0.403]
 [0.092 0.138 0.254 0.515]]
Validation acc: 0.602502406159769
Validation class_accuracies: [0.672972972972973, 0.4782608695652174, 0.22077922077922077, 0.5153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4718494196755066
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.4970952813344118 hasn't increased by 0 in 3 epochs
330/330 - 709s - loss: 0.0560 - accuracy: 0.6709 - 709s/epoch - 2s/step
Validation cm: [[588  64  68  20]
 [ 30  28  10  24]
 [ 22   5  39  11]
 [ 22   6  88  14]]
Validation normalized_cm: [[0.795 0.086 0.092 0.027]
 [0.326 0.304 0.109 0.261]
 [0.286 0.065 0.506 0.143]
 [0.169 0.046 0.677 0.108]]
Validation acc: 0.643888354186718
Validation class_accuracies: [0.7945945945945946, 0.30434782608695654, 0.5064935064935064, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42828205871684133
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.4970952813344118 hasn't increased by 0 in 4 epochs
330/330 - 707s - loss: 0.0528 - accuracy: 0.6777 - 707s/epoch - 2s/step
Validation cm: [[534 108  68  30]
 [ 19  44   8  21]
 [ 18  11  30  18]
 [ 24  17  39  50]]
Validation normalized_cm: [[0.722 0.146 0.092 0.041]
 [0.207 0.478 0.087 0.228]
 [0.234 0.143 0.39  0.234]
 [0.185 0.131 0.3   0.385]]
Validation acc: 0.6333012512030799
Validation class_accuracies: [0.7216216216216216, 0.4782608695652174, 0.38961038961038963, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49352706635315324
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The validation tracker metric at 0.4970952813344118 hasn't increased by 0 in 5 epochs
330/330 - 705s - loss: 0.0416 - accuracy: 0.6762 - 705s/epoch - 2s/step
Validation cm: [[653  66  11  10]
 [ 37  37   9   9]
 [ 50   7  17   3]
 [ 40  14  61  15]]
Validation normalized_cm: [[0.882 0.089 0.015 0.014]
 [0.402 0.402 0.098 0.098]
 [0.649 0.091 0.221 0.039]
 [0.308 0.108 0.469 0.115]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.8824324324324324, 0.40217391304347827, 0.22077922077922077, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4051925454099367
Validation one_indexed_epoch: 18
Epoch 18/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 706s - loss: 0.0410 - accuracy: 0.6825 - 706s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4970952813344118
Best cm: [[596  91  28  25]
 [ 22  43   8  19]
 [ 27   8  32  10]
 [ 21  16  54  39]]
Best normalized_cm: [[0.805 0.123 0.038 0.034]
 [0.239 0.467 0.087 0.207]
 [0.351 0.104 0.416 0.13 ]
 [0.162 0.123 0.415 0.3  ]]
Best acc: 0.6833493743984601
Best class_accuracies: [0.8054054054054054, 0.4673913043478261, 0.4155844155844156, 0.3]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 12
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Job id is 2.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    840              
                                                                                                              
 sequential_1 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_1 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,792
Trainable params: 106,296
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 811s - loss: 0.4400 - accuracy: 0.6119 - 811s/epoch - 2s/step
Validation cm: [[715  17   7   1]
 [ 77   9   2   4]
 [ 59   4  14   0]
 [ 76   0  51   3]]
Validation normalized_cm: [[0.966 0.023 0.009 0.001]
 [0.837 0.098 0.022 0.043]
 [0.766 0.052 0.182 0.   ]
 [0.585 0.    0.392 0.023]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.9662162162162162, 0.09782608695652174, 0.18181818181818182, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3172343520169607
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 804s - loss: 0.3647 - accuracy: 0.6498 - 804s/epoch - 2s/step
Validation cm: [[713  27   0   0]
 [ 79  12   0   1]
 [ 76   0   1   0]
 [108   0  22   0]]
Validation normalized_cm: [[0.964 0.036 0.    0.   ]
 [0.859 0.13  0.    0.011]
 [0.987 0.    0.013 0.   ]
 [0.831 0.    0.169 0.   ]]
Validation acc: 0.6987487969201155
Validation class_accuracies: [0.9635135135135136, 0.13043478260869565, 0.012987012987012988, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2767338272773055
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
The validation tracker metric at 0.3172343520169607 hasn't increased by 0 in 1 epochs
330/330 - 800s - loss: 0.3249 - accuracy: 0.6295 - 800s/epoch - 2s/step
Validation cm: [[610  69  38  23]
 [ 27  37  13  15]
 [ 28   2  40   7]
 [ 19   5  75  31]]
Validation normalized_cm: [[0.824 0.093 0.051 0.031]
 [0.293 0.402 0.141 0.163]
 [0.364 0.026 0.519 0.091]
 [0.146 0.038 0.577 0.238]]
Validation acc: 0.6910490856592878
Validation class_accuracies: [0.8243243243243243, 0.40217391304347827, 0.5194805194805194, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49611007382746514
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 816s - loss: 0.2982 - accuracy: 0.6504 - 816s/epoch - 2s/step
Validation cm: [[419  42 231  48]
 [ 20  18  33  21]
 [ 11   1  52  13]
 [  7   6  89  28]]
Validation normalized_cm: [[0.566 0.057 0.312 0.065]
 [0.217 0.196 0.359 0.228]
 [0.143 0.013 0.675 0.169]
 [0.054 0.046 0.685 0.215]]
Validation acc: 0.49759384023099135
Validation class_accuracies: [0.5662162162162162, 0.1956521739130435, 0.6753246753246753, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4131444202096376
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.49611007382746514 hasn't increased by 0 in 1 epochs
330/330 - 814s - loss: 0.2725 - accuracy: 0.6571 - 814s/epoch - 2s/step
Validation cm: [[625  88  19   8]
 [ 29  40   9  14]
 [ 42   6  19  10]
 [ 26  16  61  27]]
Validation normalized_cm: [[0.845 0.119 0.026 0.011]
 [0.315 0.435 0.098 0.152]
 [0.545 0.078 0.247 0.13 ]
 [0.2   0.123 0.469 0.208]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.8445945945945946, 0.43478260869565216, 0.24675324675324675, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4334556894339503
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.49611007382746514 hasn't increased by 0 in 2 epochs
330/330 - 813s - loss: 0.2368 - accuracy: 0.6679 - 813s/epoch - 2s/step
Validation cm: [[538  46 116  40]
 [ 30  22  19  21]
 [ 18   0  47  12]
 [ 12   2  74  42]]
Validation normalized_cm: [[0.727 0.062 0.157 0.054]
 [0.326 0.239 0.207 0.228]
 [0.234 0.    0.61  0.156]
 [0.092 0.015 0.569 0.323]]
Validation acc: 0.6246390760346487
Validation class_accuracies: [0.727027027027027, 0.2391304347826087, 0.6103896103896104, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47490599881904233
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.49611007382746514 hasn't increased by 0 in 3 epochs
330/330 - 812s - loss: 0.1996 - accuracy: 0.6531 - 812s/epoch - 2s/step
Validation cm: [[616  94  16  14]
 [ 31  40  11  10]
 [ 49   5  20   3]
 [ 25   8  78  19]]
Validation normalized_cm: [[0.832 0.127 0.022 0.019]
 [0.337 0.435 0.12  0.109]
 [0.636 0.065 0.26  0.039]
 [0.192 0.062 0.6   0.146]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.8324324324324325, 0.43478260869565216, 0.2597402597402597, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41827728675554765
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.49611007382746514 hasn't increased by 0 in 4 epochs
330/330 - 812s - loss: 0.1702 - accuracy: 0.6542 - 812s/epoch - 2s/step
Validation cm: [[695  42   3   0]
 [ 70  16   4   2]
 [ 63   3  11   0]
 [ 54   7  68   1]]
Validation normalized_cm: [[0.939 0.057 0.004 0.   ]
 [0.761 0.174 0.043 0.022]
 [0.818 0.039 0.143 0.   ]
 [0.415 0.054 0.523 0.008]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.9391891891891891, 0.17391304347826086, 0.14285714285714285, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3159129208042251
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.49611007382746514 hasn't increased by 0 in 5 epochs
330/330 - 812s - loss: 0.1424 - accuracy: 0.6586 - 812s/epoch - 2s/step
Validation cm: [[546  79 105  10]
 [ 36  30  15  11]
 [ 25   2  41   9]
 [ 22  10  88  10]]
Validation normalized_cm: [[0.738 0.107 0.142 0.014]
 [0.391 0.326 0.163 0.12 ]
 [0.325 0.026 0.532 0.117]
 [0.169 0.077 0.677 0.077]]
Validation acc: 0.6034648700673725
Validation class_accuracies: [0.7378378378378379, 0.32608695652173914, 0.5324675324675324, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4183288509375465
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 816s - loss: 0.1260 - accuracy: 0.6411 - 816s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.49611007382746514
Best cm: [[610  69  38  23]
 [ 27  37  13  15]
 [ 28   2  40   7]
 [ 19   5  75  31]]
Best normalized_cm: [[0.824 0.093 0.051 0.031]
 [0.293 0.402 0.141 0.163]
 [0.364 0.026 0.519 0.091]
 [0.146 0.038 0.577 0.238]]
Best acc: 0.6910490856592878
Best class_accuracies: [0.8243243243243243, 0.40217391304347827, 0.5194805194805194, 0.23846153846153847]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 4
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
