Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train52
Description: abornmal solo
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
3136
2133
740
299
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3136 0's, 2133 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 740 0's and 299 1's ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
Validation cm: [[725  15]
 [266  33]]
Validation normalized_cm: [[0.98 0.02]
 [0.89 0.11]]
Validation acc: 0.7295476419634264
Validation class_accuracies: [0.9797297297297297, 0.11036789297658862]
Validation precision: 0.6875
Validation recall: 0.11036789297658862
Validation f1: 0.19020172910662822
Validation roc_auc: 0.7581058483232397
Validation avg_accuracy: 0.5450488113531592
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[561   2]
 [ 87   2]] 
Patient Normalized Confusion matrix: 
 [[0.996 0.004]
 [0.978 0.022]] 
Patient Validation accuracy: 
 86.35 
Patient Validation class accuracies: 
 [0.9964476021314387, 0.02247191011235955] 
Saving model...
330/330 - 544s - loss: 0.5258 - accuracy: 0.7440 - 544s/epoch - 2s/step
Epoch 2/40
Validation cm: [[739   1]
 [280  19]]
Validation normalized_cm: [[0.999 0.001]
 [0.936 0.064]]
Validation acc: 0.7295476419634264
Validation class_accuracies: [0.9986486486486487, 0.06354515050167224]
Validation precision: 0.95
Validation recall: 0.06354515050167224
Validation f1: 0.11912225705329153
Validation roc_auc: 0.6943076019162975
Validation avg_accuracy: 0.5310968995751605
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5450488113531592 hasn't increased by 0 in 1 epochs
330/330 - 534s - loss: 0.4601 - accuracy: 0.7800 - 534s/epoch - 2s/step
Epoch 3/40
Validation cm: [[740   0]
 [295   4]]
Validation normalized_cm: [[1.    0.   ]
 [0.987 0.013]]
Validation acc: 0.7160731472569779
Validation class_accuracies: [1.0, 0.013377926421404682]
Validation precision: 1.0
Validation recall: 0.013377926421404682
Validation f1: 0.026402640264026403
Validation roc_auc: 0.5972091656874265
Validation avg_accuracy: 0.5066889632107023
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5450488113531592 hasn't increased by 0 in 2 epochs
330/330 - 535s - loss: 0.4380 - accuracy: 0.8002 - 535s/epoch - 2s/step
Epoch 4/40
Validation cm: [[731   9]
 [253  46]]
Validation normalized_cm: [[0.988 0.012]
 [0.846 0.154]]
Validation acc: 0.7478344562078922
Validation class_accuracies: [0.9878378378378379, 0.15384615384615385]
Validation precision: 0.8363636363636363
Validation recall: 0.15384615384615385
Validation f1: 0.2598870056497175
Validation roc_auc: 0.658182681008768
Validation avg_accuracy: 0.5708419958419959
Validation one_indexed_epoch: 4
-- New best results were achieved. --
Patient Confusion matrix: 
 [[561   2]
 [ 80   9]] 
Patient Normalized Confusion matrix: 
 [[0.996 0.004]
 [0.899 0.101]] 
Patient Validation accuracy: 
 87.42 
Patient Validation class accuracies: 
 [0.9964476021314387, 0.10112359550561797] 
Saving model...
330/330 - 540s - loss: 0.4070 - accuracy: 0.8167 - 540s/epoch - 2s/step
Epoch 5/40
Validation cm: [[543 197]
 [119 180]]
Validation normalized_cm: [[0.734 0.266]
 [0.398 0.602]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.7337837837837838, 0.6020066889632107]
Validation precision: 0.47745358090185674
Validation recall: 0.6020066889632107
Validation f1: 0.5325443786982248
Validation roc_auc: 0.7177686884208623
Validation avg_accuracy: 0.6678952363734973
Validation one_indexed_epoch: 5
-- New best results were achieved. --
Patient Confusion matrix: 
 [[422 141]
 [ 37  52]] 
Patient Normalized Confusion matrix: 
 [[0.75  0.25 ]
 [0.416 0.584]] 
Patient Validation accuracy: 
 72.70 
Patient Validation class accuracies: 
 [0.7495559502664298, 0.5842696629213483] 
Saving model...
330/330 - 534s - loss: 0.3933 - accuracy: 0.8239 - 534s/epoch - 2s/step
Epoch 6/40
Validation cm: [[735   5]
 [293   6]]
Validation normalized_cm: [[0.993 0.007]
 [0.98  0.02 ]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.9932432432432432, 0.020066889632107024]
Validation precision: 0.5454545454545454
Validation recall: 0.020066889632107024
Validation f1: 0.03870967741935484
Validation roc_auc: 0.5973854289071681
Validation avg_accuracy: 0.5066550664376751
Validation one_indexed_epoch: 6
The validation tracker metric at 0.6678952363734973 hasn't increased by 0 in 1 epochs
330/330 - 540s - loss: 0.4128 - accuracy: 0.8125 - 540s/epoch - 2s/step
Epoch 7/40
Validation cm: [[612 128]
 [235  64]]
Validation normalized_cm: [[0.827 0.173]
 [0.786 0.214]]
Validation acc: 0.6506256015399422
Validation class_accuracies: [0.827027027027027, 0.2140468227424749]
Validation precision: 0.3333333333333333
Validation recall: 0.2140468227424749
Validation f1: 0.2606924643584521
Validation roc_auc: 0.5135971255536473
Validation avg_accuracy: 0.520536924884751
Validation one_indexed_epoch: 7
The validation tracker metric at 0.6678952363734973 hasn't increased by 0 in 2 epochs
330/330 - 546s - loss: 0.4032 - accuracy: 0.8157 - 546s/epoch - 2s/step
Epoch 8/40
Validation cm: [[624 116]
 [194 105]]
Validation normalized_cm: [[0.843 0.157]
 [0.649 0.351]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.8432432432432433, 0.3511705685618729]
Validation precision: 0.4751131221719457
Validation recall: 0.3511705685618729
Validation f1: 0.4038461538461538
Validation roc_auc: 0.6173664467142728
Validation avg_accuracy: 0.5972069059025581
Validation one_indexed_epoch: 8
The validation tracker metric at 0.6678952363734973 hasn't increased by 0 in 3 epochs
330/330 - 570s - loss: 0.3627 - accuracy: 0.8328 - 570s/epoch - 2s/step
Epoch 9/40
Validation cm: [[670  70]
 [146 153]]
Validation normalized_cm: [[0.905 0.095]
 [0.488 0.512]]
Validation acc: 0.7921077959576516
Validation class_accuracies: [0.9054054054054054, 0.5117056856187291]
Validation precision: 0.6860986547085202
Validation recall: 0.5117056856187291
Validation f1: 0.5862068965517242
Validation roc_auc: 0.8251220283828979
Validation avg_accuracy: 0.7085555455120672
Validation one_indexed_epoch: 9
-- New best results were achieved. --
Patient Confusion matrix: 
 [[555   8]
 [ 63  26]] 
Patient Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.708 0.292]] 
Patient Validation accuracy: 
 89.11 
Patient Validation class accuracies: 
 [0.9857904085257548, 0.29213483146067415] 
Saving model...
330/330 - 564s - loss: 0.3471 - accuracy: 0.8436 - 564s/epoch - 2s/step
Epoch 10/40
Validation cm: [[393 347]
 [121 178]]
Validation normalized_cm: [[0.531 0.469]
 [0.405 0.595]]
Validation acc: 0.5495668912415784
Validation class_accuracies: [0.5310810810810811, 0.5953177257525084]
Validation precision: 0.33904761904761904
Validation recall: 0.5953177257525084
Validation f1: 0.43203883495145634
Validation roc_auc: 0.6188217481695742
Validation avg_accuracy: 0.5631994034167948
Validation one_indexed_epoch: 10
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 1 epochs
330/330 - 566s - loss: 0.3163 - accuracy: 0.8594 - 566s/epoch - 2s/step
Epoch 11/40
Validation cm: [[725  15]
 [272  27]]
Validation normalized_cm: [[0.98 0.02]
 [0.91 0.09]]
Validation acc: 0.7237728585178056
Validation class_accuracies: [0.9797297297297297, 0.0903010033444816]
Validation precision: 0.6428571428571429
Validation recall: 0.0903010033444816
Validation f1: 0.15835777126099704
Validation roc_auc: 0.6175833860616469
Validation avg_accuracy: 0.5350153665371057
Validation one_indexed_epoch: 11
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 2 epochs
330/330 - 562s - loss: 0.3101 - accuracy: 0.8675 - 562s/epoch - 2s/step
Epoch 12/40
Validation cm: [[740   0]
 [299   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.5152829250655337
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 12
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 3 epochs
330/330 - 562s - loss: 0.2845 - accuracy: 0.8783 - 562s/epoch - 2s/step
Epoch 13/40
Validation cm: [[716  24]
 [235  64]]
Validation normalized_cm: [[0.968 0.032]
 [0.786 0.214]]
Validation acc: 0.7507218479307026
Validation class_accuracies: [0.9675675675675676, 0.2140468227424749]
Validation precision: 0.7272727272727273
Validation recall: 0.2140468227424749
Validation f1: 0.330749354005168
Validation roc_auc: 0.6564064901021422
Validation avg_accuracy: 0.5908071951550212
Validation one_indexed_epoch: 13
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 4 epochs
330/330 - 550s - loss: 0.2603 - accuracy: 0.8933 - 550s/epoch - 2s/step
Epoch 14/40
Validation cm: [[652  88]
 [150 149]]
Validation normalized_cm: [[0.881 0.119]
 [0.502 0.498]]
Validation acc: 0.7709335899903753
Validation class_accuracies: [0.8810810810810811, 0.4983277591973244]
Validation precision: 0.6286919831223629
Validation recall: 0.4983277591973244
Validation f1: 0.5559701492537313
Validation roc_auc: 0.7988045738045738
Validation avg_accuracy: 0.6897044201392027
Validation one_indexed_epoch: 14
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 5 epochs
330/330 - 544s - loss: 0.2475 - accuracy: 0.8969 - 544s/epoch - 2s/step
Epoch 15/40
Validation cm: [[453 287]
 [ 80 219]]
Validation normalized_cm: [[0.612 0.388]
 [0.268 0.732]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.6121621621621621, 0.7324414715719063]
Validation precision: 0.43280632411067194
Validation recall: 0.7324414715719063
Validation f1: 0.5440993788819876
Validation roc_auc: 0.7330086775738949
Validation avg_accuracy: 0.6723018168670343
Validation one_indexed_epoch: 15
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 6 epochs
330/330 - 534s - loss: 0.2298 - accuracy: 0.9045 - 534s/epoch - 2s/step
Epoch 16/40
Validation cm: [[175 565]
 [116 183]]
Validation normalized_cm: [[0.236 0.764]
 [0.388 0.612]]
Validation acc: 0.34456207892204044
Validation class_accuracies: [0.23648648648648649, 0.6120401337792643]
Validation precision: 0.2446524064171123
Validation recall: 0.6120401337792643
Validation f1: 0.3495702005730659
Validation roc_auc: 0.38565262587001714
Validation avg_accuracy: 0.4242633101328754
Validation one_indexed_epoch: 16
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 7 epochs
330/330 - 535s - loss: 0.4469 - accuracy: 0.7836 - 535s/epoch - 2s/step
Epoch 17/40
Validation cm: [[540 200]
 [ 94 205]]
Validation normalized_cm: [[0.73  0.27 ]
 [0.314 0.686]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [0.7297297297297297, 0.68561872909699]
Validation precision: 0.5061728395061729
Validation recall: 0.68561872909699
Validation f1: 0.5823863636363636
Validation roc_auc: 0.7592041037693211
Validation avg_accuracy: 0.7076742294133598
Validation one_indexed_epoch: 17
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 8 epochs
330/330 - 533s - loss: 0.5400 - accuracy: 0.7415 - 533s/epoch - 2s/step
Epoch 18/40
Validation cm: [[318 422]
 [ 76 223]]
Validation normalized_cm: [[0.43  0.57 ]
 [0.254 0.746]]
Validation acc: 0.5206929740134745
Validation class_accuracies: [0.4297297297297297, 0.745819397993311]
Validation precision: 0.3457364341085271
Validation recall: 0.745819397993311
Validation f1: 0.4724576271186441
Validation roc_auc: 0.6551229322968453
Validation avg_accuracy: 0.5877745638615204
Validation one_indexed_epoch: 18
The validation tracker metric at 0.7085555455120672 hasn't increased by 0 in 9 epochs
330/330 - 535s - loss: 0.5009 - accuracy: 0.7559 - 535s/epoch - 2s/step
Epoch 19/40
Validation cm: [[  7 733]
 [  4 295]]
Validation normalized_cm: [[0.009 0.991]
 [0.013 0.987]]
Validation acc: 0.2906641000962464
Validation class_accuracies: [0.00945945945945946, 0.9866220735785953]
Validation precision: 0.28696498054474706
Validation recall: 0.9866220735785953
Validation f1: 0.44461190655614174
Validation roc_auc: 0.6819217210521558
Validation avg_accuracy: 0.4980407665190274
Validation one_indexed_epoch: 19
The number of epochs since last 1% equals the patience
330/330 - 532s - loss: 0.4784 - accuracy: 0.7726 - 532s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.7085555455120672
Best cm: [[670  70]
 [146 153]]
Best normalized_cm: [[0.905 0.095]
 [0.488 0.512]]
Best acc: 0.7921077959576516
Best class_accuracies: [0.9054054054054054, 0.5117056856187291]
Best precision: 0.6860986547085202
Best recall: 0.5117056856187291
Best f1: 0.5862068965517242
Best roc_auc: 0.8251220283828979
Best one_indexed_epoch: 9
Best patient_cm: [[555   8]
 [ 63  26]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
