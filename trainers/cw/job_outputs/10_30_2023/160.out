Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train160
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
Job id is 1.
Job dir: ../cache/cw/train160/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
-----------------------
--- Final training dataset went from 0 to 4976 elements, with 2331 none's, 1432 crakles, 678 wheezes and 535 both ---
--- Final Validation dataset contains 1089 elements, with 547 none, 402 crackles, 39 wheezes and 101 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5336765336765337, 1: 0.8687150837988827, 2: 1.8348082595870205, 3: 2.325233644859813}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_1[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               204900    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 sincnet (SincNet)                               multiple                                    320              
                                                                                                              
 mel_filterbanks (MelFilterbanks)                multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,798,246
Trainable params: 23,745,126
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 64 297 109  77]
 [ 20 246  38  98]
 [  6  21   1  11]
 [  0  75   4  22]]
Validation normalized_cm: [[0.117 0.543 0.199 0.141]
 [0.05  0.612 0.095 0.244]
 [0.154 0.538 0.026 0.282]
 [0.    0.743 0.04  0.218]]
Validation acc: 0.30578512396694213
Validation class_accuracies: [0.1170018281535649, 0.6119402985074627, 0.02564102564102564, 0.21782178217821782]
Validation sensitivity: 0.496309963099631
Validation specificity: 0.1170018281535649
Validation icbhi_score: 0.30665589562659795
Validation roc_auc: None
Validation avg_accuracy: 0.24310123362006775
Validation one_indexed_epoch: 1
-- New best results were achieved. --
311/311 - 110s - loss: 0.6896 - accuracy: 0.5619 - 110s/epoch - 353ms/step
Epoch 2/80
Validation cm: [[531   1  15   0]
 [399   0   3   0]
 [ 36   0   3   0]
 [101   0   0   0]]
Validation normalized_cm: [[0.971 0.002 0.027 0.   ]
 [0.993 0.    0.007 0.   ]
 [0.923 0.    0.077 0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.4903581267217631
Validation class_accuracies: [0.9707495429616088, 0.0, 0.07692307692307693, 0.0]
Validation sensitivity: 0.005535055350553505
Validation specificity: 0.9707495429616088
Validation icbhi_score: 0.48814229915608115
Validation roc_auc: None
Validation avg_accuracy: 0.26191815497117144
Validation one_indexed_epoch: 2
-- New best results were achieved. --
311/311 - 97s - loss: 0.6370 - accuracy: 0.6863 - 97s/epoch - 313ms/step
Epoch 3/80
Validation cm: [[310 225  12   0]
 [182 215   0   5]
 [ 24  13   2   0]
 [ 37  63   1   0]]
Validation normalized_cm: [[0.567 0.411 0.022 0.   ]
 [0.453 0.535 0.    0.012]
 [0.615 0.333 0.051 0.   ]
 [0.366 0.624 0.01  0.   ]]
Validation acc: 0.4839302112029385
Validation class_accuracies: [0.56672760511883, 0.5348258706467661, 0.05128205128205128, 0.0]
Validation sensitivity: 0.4003690036900369
Validation specificity: 0.56672760511883
Validation icbhi_score: 0.48354830440443347
Validation roc_auc: None
Validation avg_accuracy: 0.2882088817619119
Validation one_indexed_epoch: 3
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 1 epochs
311/311 - 103s - loss: 0.5975 - accuracy: 0.7472 - 103s/epoch - 332ms/step
Epoch 4/80
Validation cm: [[168 252  32  95]
 [ 88 244   8  62]
 [ 10   8   6  15]
 [ 10  42   2  47]]
Validation normalized_cm: [[0.307 0.461 0.059 0.174]
 [0.219 0.607 0.02  0.154]
 [0.256 0.205 0.154 0.385]
 [0.099 0.416 0.02  0.465]]
Validation acc: 0.42699724517906334
Validation class_accuracies: [0.3071297989031079, 0.6069651741293532, 0.15384615384615385, 0.46534653465346537]
Validation sensitivity: 0.5479704797047971
Validation specificity: 0.3071297989031079
Validation icbhi_score: 0.42755013930395247
Validation roc_auc: None
Validation avg_accuracy: 0.3833219153830201
Validation one_indexed_epoch: 4
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 2 epochs
311/311 - 99s - loss: 0.5677 - accuracy: 0.7600 - 99s/epoch - 319ms/step
Epoch 5/80
Validation cm: [[ 82 406  27  32]
 [ 41 341   3  17]
 [  4  23   4   8]
 [ 10  69   8  14]]
Validation normalized_cm: [[0.15  0.742 0.049 0.059]
 [0.102 0.848 0.007 0.042]
 [0.103 0.59  0.103 0.205]
 [0.099 0.683 0.079 0.139]]
Validation acc: 0.4049586776859504
Validation class_accuracies: [0.14990859232175502, 0.8482587064676617, 0.10256410256410256, 0.13861386138613863]
Validation sensitivity: 0.6623616236162362
Validation specificity: 0.14990859232175502
Validation icbhi_score: 0.4061351079689956
Validation roc_auc: None
Validation avg_accuracy: 0.30983631568491443
Validation one_indexed_epoch: 5
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 3 epochs
311/311 - 101s - loss: 0.5229 - accuracy: 0.7801 - 101s/epoch - 324ms/step
Epoch 6/80
Validation cm: [[412  57  41  37]
 [288  81  18  15]
 [ 28   3   8   0]
 [ 66  12  23   0]]
Validation normalized_cm: [[0.753 0.104 0.075 0.068]
 [0.716 0.201 0.045 0.037]
 [0.718 0.077 0.205 0.   ]
 [0.653 0.119 0.228 0.   ]]
Validation acc: 0.46005509641873277
Validation class_accuracies: [0.753199268738574, 0.20149253731343283, 0.20512820512820512, 0.0]
Validation sensitivity: 0.16420664206642066
Validation specificity: 0.753199268738574
Validation icbhi_score: 0.45870295540249734
Validation roc_auc: None
Validation avg_accuracy: 0.289955002795053
Validation one_indexed_epoch: 6
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 4 epochs
311/311 - 96s - loss: 0.4857 - accuracy: 0.7910 - 96s/epoch - 308ms/step
Epoch 7/80
Validation cm: [[165 355  13  14]
 [ 69 329   4   0]
 [ 11  23   3   2]
 [  6  94   1   0]]
Validation normalized_cm: [[0.302 0.649 0.024 0.026]
 [0.172 0.818 0.01  0.   ]
 [0.282 0.59  0.077 0.051]
 [0.059 0.931 0.01  0.   ]]
Validation acc: 0.4563820018365473
Validation class_accuracies: [0.3016453382084095, 0.818407960199005, 0.07692307692307693, 0.0]
Validation sensitivity: 0.6125461254612546
Validation specificity: 0.3016453382084095
Validation icbhi_score: 0.4570957318348321
Validation roc_auc: None
Validation avg_accuracy: 0.29924409383262285
Validation one_indexed_epoch: 7
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 5 epochs
311/311 - 109s - loss: 0.4509 - accuracy: 0.7998 - 109s/epoch - 352ms/step
Epoch 8/80
Validation cm: [[297 158  63  29]
 [217 147  18  20]
 [ 12   8  15   4]
 [ 42  28  21  10]]
Validation normalized_cm: [[0.543 0.289 0.115 0.053]
 [0.54  0.366 0.045 0.05 ]
 [0.308 0.205 0.385 0.103]
 [0.416 0.277 0.208 0.099]]
Validation acc: 0.43067033976124885
Validation class_accuracies: [0.5429616087751371, 0.3656716417910448, 0.38461538461538464, 0.09900990099009901]
Validation sensitivity: 0.3173431734317343
Validation specificity: 0.5429616087751371
Validation icbhi_score: 0.4301523911034357
Validation roc_auc: None
Validation avg_accuracy: 0.3480646340429164
Validation one_indexed_epoch: 8
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 6 epochs
311/311 - 105s - loss: 0.4040 - accuracy: 0.8137 - 105s/epoch - 337ms/step
Epoch 9/80
Validation cm: [[180 270  45  52]
 [ 73 291  10  28]
 [ 10  12   5  12]
 [  9  61   4  27]]
Validation normalized_cm: [[0.329 0.494 0.082 0.095]
 [0.182 0.724 0.025 0.07 ]
 [0.256 0.308 0.128 0.308]
 [0.089 0.604 0.04  0.267]]
Validation acc: 0.46189164370982555
Validation class_accuracies: [0.3290676416819013, 0.7238805970149254, 0.1282051282051282, 0.26732673267326734]
Validation sensitivity: 0.5959409594095941
Validation specificity: 0.3290676416819013
Validation icbhi_score: 0.4625043005457477
Validation roc_auc: None
Validation avg_accuracy: 0.3621200248938055
Validation one_indexed_epoch: 9
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 7 epochs
311/311 - 103s - loss: 0.3666 - accuracy: 0.8308 - 103s/epoch - 330ms/step
Epoch 10/80
Validation cm: [[217 212  51  67]
 [129 206  32  35]
 [  9   8  10  12]
 [ 24  33  20  24]]
Validation normalized_cm: [[0.397 0.388 0.093 0.122]
 [0.321 0.512 0.08  0.087]
 [0.231 0.205 0.256 0.308]
 [0.238 0.327 0.198 0.238]]
Validation acc: 0.4196510560146924
Validation class_accuracies: [0.396709323583181, 0.5124378109452736, 0.2564102564102564, 0.2376237623762376]
Validation sensitivity: 0.44280442804428044
Validation specificity: 0.396709323583181
Validation icbhi_score: 0.4197568758137307
Validation roc_auc: None
Validation avg_accuracy: 0.35079528832873713
Validation one_indexed_epoch: 10
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
311/311 - 100s - loss: 0.3255 - accuracy: 0.8324 - 100s/epoch - 321ms/step
Epoch 11/80
Validation cm: [[200 305  27  15]
 [ 80 312   3   7]
 [ 13  16   2   8]
 [ 16  81   1   3]]
Validation normalized_cm: [[0.366 0.558 0.049 0.027]
 [0.199 0.776 0.007 0.017]
 [0.333 0.41  0.051 0.205]
 [0.158 0.802 0.01  0.03 ]]
Validation acc: 0.47474747474747475
Validation class_accuracies: [0.3656307129798903, 0.7761194029850746, 0.05128205128205128, 0.0297029702970297]
Validation sensitivity: 0.584870848708487
Validation specificity: 0.3656307129798903
Validation icbhi_score: 0.4752507808441887
Validation roc_auc: None
Validation avg_accuracy: 0.3056837843860115
Validation one_indexed_epoch: 11
The validation tracker metric at 0.48814229915608115 hasn't increased by 0 in 9 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
311/311 - 111s - loss: 0.2564 - accuracy: 0.8499 - 111s/epoch - 357ms/step
Epoch 12/80
Validation cm: [[270 234  28  15]
 [139 255   5   3]
 [ 14  11   8   6]
 [ 35  58   7   1]]
Validation normalized_cm: [[0.494 0.428 0.051 0.027]
 [0.346 0.634 0.012 0.007]
 [0.359 0.282 0.205 0.154]
 [0.347 0.574 0.069 0.01 ]]
Validation acc: 0.4903581267217631
Validation class_accuracies: [0.4936014625228519, 0.6343283582089553, 0.20512820512820512, 0.009900990099009901]
Validation sensitivity: 0.4870848708487085
Validation specificity: 0.4936014625228519
Validation icbhi_score: 0.4903431666857802
Validation roc_auc: None
Validation avg_accuracy: 0.33573975398975553
Validation one_indexed_epoch: 12
-- New best results were achieved. --
311/311 - 107s - loss: 0.2003 - accuracy: 0.8625 - 107s/epoch - 344ms/step
Epoch 13/80
Validation cm: [[404  88  40  15]
 [275 102  13  12]
 [ 21   3  10   5]
 [ 68  21  10   2]]
Validation normalized_cm: [[0.739 0.161 0.073 0.027]
 [0.684 0.254 0.032 0.03 ]
 [0.538 0.077 0.256 0.128]
 [0.673 0.208 0.099 0.02 ]]
Validation acc: 0.4756657483930211
Validation class_accuracies: [0.7385740402193784, 0.2537313432835821, 0.2564102564102564, 0.019801980198019802]
Validation sensitivity: 0.21033210332103322
Validation specificity: 0.7385740402193784
Validation icbhi_score: 0.47445307177020585
Validation roc_auc: None
Validation avg_accuracy: 0.3171294050278092
Validation one_indexed_epoch: 13
The validation tracker metric at 0.4903431666857802 hasn't increased by 0 in 1 epochs
311/311 - 104s - loss: 0.1658 - accuracy: 0.8621 - 104s/epoch - 334ms/step
Epoch 14/80
Validation cm: [[275 222  33  17]
 [165 207  10  20]
 [ 17  10   8   4]
 [ 51  39   5   6]]
Validation normalized_cm: [[0.503 0.406 0.06  0.031]
 [0.41  0.515 0.025 0.05 ]
 [0.436 0.256 0.205 0.103]
 [0.505 0.386 0.05  0.059]]
Validation acc: 0.4554637281910009
Validation class_accuracies: [0.5027422303473492, 0.5149253731343284, 0.20512820512820512, 0.0594059405940594]
Validation sensitivity: 0.4077490774907749
Validation specificity: 0.5027422303473492
Validation icbhi_score: 0.455245653919062
Validation roc_auc: None
Validation avg_accuracy: 0.32055043730098554
Validation one_indexed_epoch: 14
The validation tracker metric at 0.4903431666857802 hasn't increased by 0 in 2 epochs
311/311 - 106s - loss: 0.1420 - accuracy: 0.8631 - 106s/epoch - 342ms/step
Epoch 15/80
Validation cm: [[228 245  37  37]
 [102 250  34  16]
 [ 12  12   6   9]
 [ 18  46  20  17]]
Validation normalized_cm: [[0.417 0.448 0.068 0.068]
 [0.254 0.622 0.085 0.04 ]
 [0.308 0.308 0.154 0.231]
 [0.178 0.455 0.198 0.168]]
Validation acc: 0.46005509641873277
Validation class_accuracies: [0.41681901279707495, 0.6218905472636815, 0.15384615384615385, 0.16831683168316833]
Validation sensitivity: 0.503690036900369
Validation specificity: 0.41681901279707495
Validation icbhi_score: 0.460254524848722
Validation roc_auc: None
Validation avg_accuracy: 0.3402181363975197
Validation one_indexed_epoch: 15
The validation tracker metric at 0.4903431666857802 hasn't increased by 0 in 3 epochs
311/311 - 112s - loss: 0.1212 - accuracy: 0.8617 - 112s/epoch - 359ms/step
Epoch 16/80
Validation cm: [[338 150  51   8]
 [183 200  15   4]
 [ 18   8   8   5]
 [ 51  36  10   4]]
Validation normalized_cm: [[0.618 0.274 0.093 0.015]
 [0.455 0.498 0.037 0.01 ]
 [0.462 0.205 0.205 0.128]
 [0.505 0.356 0.099 0.04 ]]
Validation acc: 0.5050505050505051
Validation class_accuracies: [0.6179159049360147, 0.4975124378109453, 0.20512820512820512, 0.039603960396039604]
Validation sensitivity: 0.39114391143911437
Validation specificity: 0.6179159049360147
Validation icbhi_score: 0.5045299081875645
Validation roc_auc: None
Validation avg_accuracy: 0.3400401270678012
Validation one_indexed_epoch: 16
-- New best results were achieved. --
311/311 - 111s - loss: 0.0945 - accuracy: 0.8485 - 111s/epoch - 358ms/step
Epoch 17/80
Validation cm: [[289 177  44  37]
 [175 192  16  19]
 [ 14  10   9   6]
 [ 43  36   9  13]]
Validation normalized_cm: [[0.528 0.324 0.08  0.068]
 [0.435 0.478 0.04  0.047]
 [0.359 0.256 0.231 0.154]
 [0.426 0.356 0.089 0.129]]
Validation acc: 0.46189164370982555
Validation class_accuracies: [0.5283363802559415, 0.47761194029850745, 0.23076923076923078, 0.12871287128712872]
Validation sensitivity: 0.3948339483394834
Validation specificity: 0.5283363802559415
Validation icbhi_score: 0.46158516429771246
Validation roc_auc: None
Validation avg_accuracy: 0.3413576056527021
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 1 epochs
311/311 - 107s - loss: 0.0879 - accuracy: 0.8428 - 107s/epoch - 344ms/step
Epoch 18/80
Validation cm: [[132 340  24  51]
 [ 70 300  12  20]
 [  8  17   5   9]
 [ 15  70   5  11]]
Validation normalized_cm: [[0.241 0.622 0.044 0.093]
 [0.174 0.746 0.03  0.05 ]
 [0.205 0.436 0.128 0.231]
 [0.149 0.693 0.05  0.109]]
Validation acc: 0.411386593204775
Validation class_accuracies: [0.2413162705667276, 0.746268656716418, 0.1282051282051282, 0.10891089108910891]
Validation sensitivity: 0.5830258302583026
Validation specificity: 0.2413162705667276
Validation icbhi_score: 0.4121710504125151
Validation roc_auc: None
Validation avg_accuracy: 0.3061752366443457
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 2 epochs
311/311 - 108s - loss: 0.0889 - accuracy: 0.8334 - 108s/epoch - 346ms/step
Epoch 19/80
Validation cm: [[173 305  33  36]
 [ 97 264  13  28]
 [  5  14   8  12]
 [ 15  60  13  13]]
Validation normalized_cm: [[0.316 0.558 0.06  0.066]
 [0.241 0.657 0.032 0.07 ]
 [0.128 0.359 0.205 0.308]
 [0.149 0.594 0.129 0.129]]
Validation acc: 0.42056932966023874
Validation class_accuracies: [0.3162705667276051, 0.6567164179104478, 0.20512820512820512, 0.12871287128712872]
Validation sensitivity: 0.525830258302583
Validation specificity: 0.3162705667276051
Validation icbhi_score: 0.42105041251509406
Validation roc_auc: None
Validation avg_accuracy: 0.32670701526334667
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 3 epochs
311/311 - 107s - loss: 0.1193 - accuracy: 0.8402 - 107s/epoch - 346ms/step
Epoch 20/80
Validation cm: [[154 298  49  46]
 [104 245  22  31]
 [  4  12   9  14]
 [ 17  43  15  26]]
Validation normalized_cm: [[0.282 0.545 0.09  0.084]
 [0.259 0.609 0.055 0.077]
 [0.103 0.308 0.231 0.359]
 [0.168 0.426 0.149 0.257]]
Validation acc: 0.3985307621671258
Validation class_accuracies: [0.28153564899451555, 0.6094527363184079, 0.23076923076923078, 0.25742574257425743]
Validation sensitivity: 0.5166051660516605
Validation specificity: 0.28153564899451555
Validation icbhi_score: 0.39907040752308803
Validation roc_auc: None
Validation avg_accuracy: 0.34479583966410293
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 4 epochs
311/311 - 112s - loss: 0.0806 - accuracy: 0.8390 - 112s/epoch - 359ms/step
Epoch 21/80
Validation cm: [[439  61  47   0]
 [342  43  17   0]
 [ 28   0  11   0]
 [ 74  13  14   0]]
Validation normalized_cm: [[0.803 0.112 0.086 0.   ]
 [0.851 0.107 0.042 0.   ]
 [0.718 0.    0.282 0.   ]
 [0.733 0.129 0.139 0.   ]]
Validation acc: 0.4527089072543618
Validation class_accuracies: [0.8025594149908593, 0.10696517412935323, 0.28205128205128205, 0.0]
Validation sensitivity: 0.0996309963099631
Validation specificity: 0.8025594149908593
Validation icbhi_score: 0.45109520565041117
Validation roc_auc: None
Validation avg_accuracy: 0.29789396779287364
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 5 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
311/311 - 110s - loss: 0.0613 - accuracy: 0.8193 - 110s/epoch - 353ms/step
Epoch 22/80
Validation cm: [[219 268  33  27]
 [148 232   8  14]
 [  9  17   4   9]
 [ 24  60   7  10]]
Validation normalized_cm: [[0.4   0.49  0.06  0.049]
 [0.368 0.577 0.02  0.035]
 [0.231 0.436 0.103 0.231]
 [0.238 0.594 0.069 0.099]]
Validation acc: 0.42699724517906334
Validation class_accuracies: [0.40036563071297987, 0.5771144278606966, 0.10256410256410256, 0.09900990099009901]
Validation sensitivity: 0.45387453874538747
Validation specificity: 0.40036563071297987
Validation icbhi_score: 0.42712008472918367
Validation roc_auc: None
Validation avg_accuracy: 0.29476351553196956
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 6 epochs
311/311 - 103s - loss: 0.0713 - accuracy: 0.8131 - 103s/epoch - 330ms/step
Epoch 23/80
Validation cm: [[243 247  19  38]
 [141 247   4  10]
 [ 17  13   1   8]
 [ 43  49   4   5]]
Validation normalized_cm: [[0.444 0.452 0.035 0.069]
 [0.351 0.614 0.01  0.025]
 [0.436 0.333 0.026 0.205]
 [0.426 0.485 0.04  0.05 ]]
Validation acc: 0.4554637281910009
Validation class_accuracies: [0.44424131627056673, 0.6144278606965174, 0.02564102564102564, 0.04950495049504951]
Validation sensitivity: 0.466789667896679
Validation specificity: 0.44424131627056673
Validation icbhi_score: 0.45551549208362285
Validation roc_auc: None
Validation avg_accuracy: 0.2834537882757898
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 7 epochs
311/311 - 106s - loss: 0.0689 - accuracy: 0.8141 - 106s/epoch - 340ms/step
Epoch 24/80
Validation cm: [[257 195  54  41]
 [122 232  24  24]
 [ 12   8  10   9]
 [ 24  46  22   9]]
Validation normalized_cm: [[0.47  0.356 0.099 0.075]
 [0.303 0.577 0.06  0.06 ]
 [0.308 0.205 0.256 0.231]
 [0.238 0.455 0.218 0.089]]
Validation acc: 0.46648301193755737
Validation class_accuracies: [0.46983546617915906, 0.5771144278606966, 0.2564102564102564, 0.0891089108910891]
Validation sensitivity: 0.46309963099630996
Validation specificity: 0.46983546617915906
Validation icbhi_score: 0.46646754858773454
Validation roc_auc: None
Validation avg_accuracy: 0.3481172653353003
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5045299081875645 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0002500000118743628
311/311 - 111s - loss: 0.0747 - accuracy: 0.8145 - 111s/epoch - 357ms/step
Epoch 25/80
Validation cm: [[304 204  17  22]
 [147 247   2   6]
 [ 14  16   4   5]
 [ 45  51   2   3]]
Validation normalized_cm: [[0.556 0.373 0.031 0.04 ]
 [0.366 0.614 0.005 0.015]
 [0.359 0.41  0.103 0.128]
 [0.446 0.505 0.02  0.03 ]]
Validation acc: 0.512396694214876
Validation class_accuracies: [0.5557586837294333, 0.6144278606965174, 0.10256410256410256, 0.0297029702970297]
Validation sensitivity: 0.46863468634686345
Validation specificity: 0.5557586837294333
Validation icbhi_score: 0.5121966850381483
Validation roc_auc: None
Validation avg_accuracy: 0.32561340432177077
Validation one_indexed_epoch: 25
-- New best results were achieved. --
311/311 - 112s - loss: 0.0484 - accuracy: 0.8029 - 112s/epoch - 360ms/step
Epoch 26/80
Validation cm: [[297 175  33  42]
 [151 223  14  14]
 [ 14  11   3  11]
 [ 32  40  12  17]]
Validation normalized_cm: [[0.543 0.32  0.06  0.077]
 [0.376 0.555 0.035 0.035]
 [0.359 0.282 0.077 0.282]
 [0.317 0.396 0.119 0.168]]
Validation acc: 0.49586776859504134
Validation class_accuracies: [0.5429616087751371, 0.554726368159204, 0.07692307692307693, 0.16831683168316833]
Validation sensitivity: 0.4483394833948339
Validation specificity: 0.5429616087751371
Validation icbhi_score: 0.4956505460849855
Validation roc_auc: None
Validation avg_accuracy: 0.33573197138514654
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5121966850381483 hasn't increased by 0 in 1 epochs
311/311 - 108s - loss: 0.0359 - accuracy: 0.8043 - 108s/epoch - 348ms/step
Epoch 27/80
Validation cm: [[330 180  19  18]
 [175 219   2   6]
 [ 12  15   7   5]
 [ 41  51   5   4]]
Validation normalized_cm: [[0.603 0.329 0.035 0.033]
 [0.435 0.545 0.005 0.015]
 [0.308 0.385 0.179 0.128]
 [0.406 0.505 0.05  0.04 ]]
Validation acc: 0.5142332415059688
Validation class_accuracies: [0.603290676416819, 0.5447761194029851, 0.1794871794871795, 0.039603960396039604]
Validation sensitivity: 0.42435424354243545
Validation specificity: 0.603290676416819
Validation icbhi_score: 0.5138224599796273
Validation roc_auc: None
Validation avg_accuracy: 0.3417894839257558
Validation one_indexed_epoch: 27
-- New best results were achieved. --
311/311 - 106s - loss: 0.0284 - accuracy: 0.7950 - 106s/epoch - 340ms/step
Epoch 28/80
Validation cm: [[291 220  29   7]
 [155 239   3   5]
 [ 12  12   8   7]
 [ 29  57   8   7]]
Validation normalized_cm: [[0.532 0.402 0.053 0.013]
 [0.386 0.595 0.007 0.012]
 [0.308 0.308 0.205 0.179]
 [0.287 0.564 0.079 0.069]]
Validation acc: 0.5004591368227732
Validation class_accuracies: [0.5319926873857403, 0.5945273631840796, 0.20512820512820512, 0.06930693069306931]
Validation sensitivity: 0.46863468634686345
Validation specificity: 0.5319926873857403
Validation icbhi_score: 0.5003136868663018
Validation roc_auc: None
Validation avg_accuracy: 0.3502387965977736
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5138224599796273 hasn't increased by 0 in 1 epochs
311/311 - 105s - loss: 0.0286 - accuracy: 0.7882 - 105s/epoch - 338ms/step
Epoch 29/80
Validation cm: [[261 235  40  11]
 [151 240   3   8]
 [ 10  14   6   9]
 [ 30  54  10   7]]
Validation normalized_cm: [[0.477 0.43  0.073 0.02 ]
 [0.376 0.597 0.007 0.02 ]
 [0.256 0.359 0.154 0.231]
 [0.297 0.535 0.099 0.069]]
Validation acc: 0.4719926538108356
Validation class_accuracies: [0.47714808043875684, 0.5970149253731343, 0.15384615384615385, 0.06930693069306931]
Validation sensitivity: 0.466789667896679
Validation specificity: 0.47714808043875684
Validation icbhi_score: 0.47196887416771793
Validation roc_auc: None
Validation avg_accuracy: 0.3243290225877786
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5138224599796273 hasn't increased by 0 in 2 epochs
311/311 - 113s - loss: 0.0202 - accuracy: 0.7858 - 113s/epoch - 363ms/step
Epoch 30/80
Validation cm: [[258 253  22  14]
 [120 274   2   6]
 [ 12  16   4   7]
 [ 20  71   3   7]]
Validation normalized_cm: [[0.472 0.463 0.04  0.026]
 [0.299 0.682 0.005 0.015]
 [0.308 0.41  0.103 0.179]
 [0.198 0.703 0.03  0.069]]
Validation acc: 0.4986225895316804
Validation class_accuracies: [0.4716636197440585, 0.681592039800995, 0.10256410256410256, 0.06930693069306931]
Validation sensitivity: 0.525830258302583
Validation specificity: 0.4716636197440585
Validation icbhi_score: 0.4987469390233208
Validation roc_auc: None
Validation avg_accuracy: 0.3312816732005564
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5138224599796273 hasn't increased by 0 in 3 epochs
311/311 - 110s - loss: 0.0201 - accuracy: 0.7914 - 110s/epoch - 353ms/step
Epoch 31/80
Validation cm: [[322 187  25  13]
 [160 236   2   4]
 [ 19  11   5   4]
 [ 48  46   4   3]]
Validation normalized_cm: [[0.589 0.342 0.046 0.024]
 [0.398 0.587 0.005 0.01 ]
 [0.487 0.282 0.128 0.103]
 [0.475 0.455 0.04  0.03 ]]
Validation acc: 0.519742883379247
Validation class_accuracies: [0.5886654478976234, 0.5870646766169154, 0.1282051282051282, 0.0297029702970297]
Validation sensitivity: 0.45018450184501846
Validation specificity: 0.5886654478976234
Validation icbhi_score: 0.5194249748713209
Validation roc_auc: None
Validation avg_accuracy: 0.3334095557541742
Validation one_indexed_epoch: 31
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
311/311 - 108s - loss: 0.0198 - accuracy: 0.7852 - 108s/epoch - 348ms/step
Epoch 32/80
Validation cm: [[302 197  29  19]
 [174 218   4   6]
 [ 18  11   5   5]
 [ 43  47   9   2]]
Validation normalized_cm: [[0.552 0.36  0.053 0.035]
 [0.433 0.542 0.01  0.015]
 [0.462 0.282 0.128 0.128]
 [0.426 0.465 0.089 0.02 ]]
Validation acc: 0.4839302112029385
Validation class_accuracies: [0.5521023765996343, 0.5422885572139303, 0.1282051282051282, 0.019801980198019802]
Validation sensitivity: 0.4151291512915129
Validation specificity: 0.5521023765996343
Validation icbhi_score: 0.4836157639455736
Validation roc_auc: None
Validation avg_accuracy: 0.31059951055417817
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 1 epochs
311/311 - 106s - loss: 0.0166 - accuracy: 0.7797 - 106s/epoch - 342ms/step
Epoch 33/80
Validation cm: [[221 189  83  54]
 [119 201  34  48]
 [  6   7  14  12]
 [ 15  34  18  34]]
Validation normalized_cm: [[0.404 0.346 0.152 0.099]
 [0.296 0.5   0.085 0.119]
 [0.154 0.179 0.359 0.308]
 [0.149 0.337 0.178 0.337]]
Validation acc: 0.4315886134067952
Validation class_accuracies: [0.4040219378427788, 0.5, 0.358974358974359, 0.33663366336633666]
Validation sensitivity: 0.45940959409594095
Validation specificity: 0.4040219378427788
Validation icbhi_score: 0.4317157659693599
Validation roc_auc: None
Validation avg_accuracy: 0.3999074900458686
Validation one_indexed_epoch: 33
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 2 epochs
311/311 - 121s - loss: 0.0177 - accuracy: 0.7753 - 121s/epoch - 389ms/step
Epoch 34/80
Validation cm: [[317 191  26  13]
 [167 228   1   6]
 [ 18  12   5   4]
 [ 41  53   3   4]]
Validation normalized_cm: [[0.58  0.349 0.048 0.024]
 [0.415 0.567 0.002 0.015]
 [0.462 0.308 0.128 0.103]
 [0.406 0.525 0.03  0.04 ]]
Validation acc: 0.5087235996326905
Validation class_accuracies: [0.5795246800731262, 0.5671641791044776, 0.1282051282051282, 0.039603960396039604]
Validation sensitivity: 0.43726937269372695
Validation specificity: 0.5795246800731262
Validation icbhi_score: 0.5083970263834265
Validation roc_auc: None
Validation avg_accuracy: 0.32862448694469293
Validation one_indexed_epoch: 34
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 3 epochs
311/311 - 108s - loss: 0.0183 - accuracy: 0.7759 - 108s/epoch - 348ms/step
Epoch 35/80
Validation cm: [[304 203  25  15]
 [151 240   4   7]
 [ 16  12   7   4]
 [ 42  49   6   4]]
Validation normalized_cm: [[0.556 0.371 0.046 0.027]
 [0.376 0.597 0.01  0.017]
 [0.41  0.308 0.179 0.103]
 [0.416 0.485 0.059 0.04 ]]
Validation acc: 0.509641873278237
Validation class_accuracies: [0.5557586837294333, 0.5970149253731343, 0.1794871794871795, 0.039603960396039604]
Validation sensitivity: 0.46309963099630996
Validation specificity: 0.5557586837294333
Validation icbhi_score: 0.5094291573628716
Validation roc_auc: None
Validation avg_accuracy: 0.3429661872464467
Validation one_indexed_epoch: 35
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 4 epochs
311/311 - 109s - loss: 0.0161 - accuracy: 0.7733 - 109s/epoch - 349ms/step
Epoch 36/80
Validation cm: [[340 134  59  14]
 [191 183  14  14]
 [ 16   5  14   4]
 [ 54  27  15   5]]
Validation normalized_cm: [[0.622 0.245 0.108 0.026]
 [0.475 0.455 0.035 0.035]
 [0.41  0.128 0.359 0.103]
 [0.535 0.267 0.149 0.05 ]]
Validation acc: 0.49770431588613406
Validation class_accuracies: [0.6215722120658135, 0.4552238805970149, 0.358974358974359, 0.04950495049504951]
Validation sensitivity: 0.3726937269372694
Validation specificity: 0.6215722120658135
Validation icbhi_score: 0.4971329695015414
Validation roc_auc: None
Validation avg_accuracy: 0.37131885053305924
Validation one_indexed_epoch: 36
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 5 epochs
311/311 - 107s - loss: 0.0179 - accuracy: 0.7701 - 107s/epoch - 343ms/step
Epoch 37/80
Validation cm: [[209 292  16  30]
 [110 284   2   6]
 [ 10  18   4   7]
 [ 25  65   4   7]]
Validation normalized_cm: [[0.382 0.534 0.029 0.055]
 [0.274 0.706 0.005 0.015]
 [0.256 0.462 0.103 0.179]
 [0.248 0.644 0.04  0.069]]
Validation acc: 0.4628099173553719
Validation class_accuracies: [0.3820840950639854, 0.7064676616915423, 0.10256410256410256, 0.06930693069306931]
Validation sensitivity: 0.544280442804428
Validation specificity: 0.3820840950639854
Validation icbhi_score: 0.46318226893420666
Validation roc_auc: None
Validation avg_accuracy: 0.3151056975031749
Validation one_indexed_epoch: 37
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 6 epochs
311/311 - 112s - loss: 0.0190 - accuracy: 0.7703 - 112s/epoch - 360ms/step
Epoch 38/80
Validation cm: [[324 165  33  25]
 [174 203   5  20]
 [ 14  13   9   3]
 [ 41  42   7  11]]
Validation normalized_cm: [[0.592 0.302 0.06  0.046]
 [0.433 0.505 0.012 0.05 ]
 [0.359 0.333 0.231 0.077]
 [0.406 0.416 0.069 0.109]]
Validation acc: 0.5022956841138659
Validation class_accuracies: [0.5923217550274223, 0.5049751243781094, 0.23076923076923078, 0.10891089108910891]
Validation sensitivity: 0.4114391143911439
Validation specificity: 0.5923217550274223
Validation icbhi_score: 0.5018804347092831
Validation roc_auc: None
Validation avg_accuracy: 0.3592442503159679
Validation one_indexed_epoch: 38
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 7 epochs
311/311 - 111s - loss: 0.0166 - accuracy: 0.7787 - 111s/epoch - 358ms/step
Epoch 39/80
Validation cm: [[290 189  43  25]
 [176 204  11  11]
 [ 11  11  11   6]
 [ 53  25  14   9]]
Validation normalized_cm: [[0.53  0.346 0.079 0.046]
 [0.438 0.507 0.027 0.027]
 [0.282 0.282 0.282 0.154]
 [0.525 0.248 0.139 0.089]]
Validation acc: 0.4719926538108356
Validation class_accuracies: [0.5301645338208409, 0.5074626865671642, 0.28205128205128205, 0.0891089108910891]
Validation sensitivity: 0.4132841328413284
Validation specificity: 0.5301645338208409
Validation icbhi_score: 0.47172433333108466
Validation roc_auc: None
Validation avg_accuracy: 0.3521968533325941
Validation one_indexed_epoch: 39
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0001250000059371814
311/311 - 109s - loss: 0.0200 - accuracy: 0.7822 - 109s/epoch - 351ms/step
Epoch 40/80
Validation cm: [[257 255  23  12]
 [126 269   2   5]
 [ 15  13   6   5]
 [ 23  63   6   9]]
Validation normalized_cm: [[0.47  0.466 0.042 0.022]
 [0.313 0.669 0.005 0.012]
 [0.385 0.333 0.154 0.128]
 [0.228 0.624 0.059 0.089]]
Validation acc: 0.4967860422405877
Validation class_accuracies: [0.46983546617915906, 0.6691542288557214, 0.15384615384615385, 0.0891089108910891]
Validation sensitivity: 0.5239852398523985
Validation specificity: 0.46983546617915906
Validation icbhi_score: 0.4969103530157788
Validation roc_auc: None
Validation avg_accuracy: 0.3454861899430308
Validation one_indexed_epoch: 40
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 9 epochs
311/311 - 109s - loss: 0.0198 - accuracy: 0.7659 - 109s/epoch - 350ms/step
Epoch 41/80
Validation cm: [[301 196  32  18]
 [160 228   5   9]
 [ 14  12   7   6]
 [ 40  45   9   7]]
Validation normalized_cm: [[0.55  0.358 0.059 0.033]
 [0.398 0.567 0.012 0.022]
 [0.359 0.308 0.179 0.154]
 [0.396 0.446 0.089 0.069]]
Validation acc: 0.4986225895316804
Validation class_accuracies: [0.5502742230347349, 0.5671641791044776, 0.1794871794871795, 0.06930693069306931]
Validation sensitivity: 0.44649446494464945
Validation specificity: 0.5502742230347349
Validation icbhi_score: 0.4983843439896922
Validation roc_auc: None
Validation avg_accuracy: 0.34155812807986535
Validation one_indexed_epoch: 41
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 10 epochs
311/311 - 108s - loss: 0.0137 - accuracy: 0.7657 - 108s/epoch - 349ms/step
Epoch 42/80
Validation cm: [[269 229  31  18]
 [154 239   3   6]
 [ 12  15   6   6]
 [ 42  45   6   8]]
Validation normalized_cm: [[0.492 0.419 0.057 0.033]
 [0.383 0.595 0.007 0.015]
 [0.308 0.385 0.154 0.154]
 [0.416 0.446 0.059 0.079]]
Validation acc: 0.4793388429752066
Validation class_accuracies: [0.49177330895795246, 0.5945273631840796, 0.15384615384615385, 0.07920792079207921]
Validation sensitivity: 0.466789667896679
Validation specificity: 0.49177330895795246
Validation icbhi_score: 0.4792814884273157
Validation roc_auc: None
Validation avg_accuracy: 0.32983868669506633
Validation one_indexed_epoch: 42
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 11 epochs
311/311 - 110s - loss: 0.0113 - accuracy: 0.7697 - 110s/epoch - 353ms/step
Epoch 43/80
Validation cm: [[277 216  36  18]
 [164 227   3   8]
 [ 12  13   7   7]
 [ 33  51   9   8]]
Validation normalized_cm: [[0.506 0.395 0.066 0.033]
 [0.408 0.565 0.007 0.02 ]
 [0.308 0.333 0.179 0.179]
 [0.327 0.505 0.089 0.079]]
Validation acc: 0.4765840220385675
Validation class_accuracies: [0.506398537477148, 0.5646766169154229, 0.1794871794871795, 0.07920792079207921]
Validation sensitivity: 0.44649446494464945
Validation specificity: 0.506398537477148
Validation icbhi_score: 0.4764465012108987
Validation roc_auc: None
Validation avg_accuracy: 0.33244256366795744
Validation one_indexed_epoch: 43
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 12 epochs
311/311 - 110s - loss: 0.0123 - accuracy: 0.7876 - 110s/epoch - 355ms/step
Epoch 44/80
Validation cm: [[284 216  31  16]
 [152 240   4   6]
 [ 13  13   7   6]
 [ 36  51   8   6]]
Validation normalized_cm: [[0.519 0.395 0.057 0.029]
 [0.378 0.597 0.01  0.015]
 [0.333 0.333 0.179 0.154]
 [0.356 0.505 0.079 0.059]]
Validation acc: 0.4931129476584022
Validation class_accuracies: [0.5191956124314442, 0.5970149253731343, 0.1794871794871795, 0.0594059405940594]
Validation sensitivity: 0.466789667896679
Validation specificity: 0.5191956124314442
Validation icbhi_score: 0.4929926401640616
Validation roc_auc: None
Validation avg_accuracy: 0.33877591447145433
Validation one_indexed_epoch: 44
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 13 epochs
311/311 - 109s - loss: 0.0090 - accuracy: 0.7723 - 109s/epoch - 351ms/step
Epoch 45/80
Validation cm: [[257 243  31  16]
 [144 248   4   6]
 [ 11  14   6   8]
 [ 31  57   6   7]]
Validation normalized_cm: [[0.47  0.444 0.057 0.029]
 [0.358 0.617 0.01  0.015]
 [0.282 0.359 0.154 0.205]
 [0.307 0.564 0.059 0.069]]
Validation acc: 0.4756657483930211
Validation class_accuracies: [0.46983546617915906, 0.6169154228855721, 0.15384615384615385, 0.06930693069306931]
Validation sensitivity: 0.48154981549815495
Validation specificity: 0.46983546617915906
Validation icbhi_score: 0.47569264083865703
Validation roc_auc: None
Validation avg_accuracy: 0.32747599340098854
Validation one_indexed_epoch: 45
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 14 epochs
311/311 - 107s - loss: 0.0102 - accuracy: 0.7699 - 107s/epoch - 345ms/step
Epoch 46/80
Validation cm: [[284 208  38  17]
 [152 237   4   9]
 [ 10  15   9   5]
 [ 35  46   9  11]]
Validation normalized_cm: [[0.519 0.38  0.069 0.031]
 [0.378 0.59  0.01  0.022]
 [0.256 0.385 0.231 0.128]
 [0.347 0.455 0.089 0.109]]
Validation acc: 0.4967860422405877
Validation class_accuracies: [0.5191956124314442, 0.5895522388059702, 0.23076923076923078, 0.10891089108910891]
Validation sensitivity: 0.474169741697417
Validation specificity: 0.5191956124314442
Validation icbhi_score: 0.4966826770644306
Validation roc_auc: None
Validation avg_accuracy: 0.3621069932739386
Validation one_indexed_epoch: 46
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 15 epochs
311/311 - 112s - loss: 0.0073 - accuracy: 0.7570 - 112s/epoch - 361ms/step
Epoch 47/80
Validation cm: [[316 165  43  23]
 [172 202  12  16]
 [ 10  11  11   7]
 [ 41  32  14  14]]
Validation normalized_cm: [[0.578 0.302 0.079 0.042]
 [0.428 0.502 0.03  0.04 ]
 [0.256 0.282 0.282 0.179]
 [0.406 0.317 0.139 0.139]]
Validation acc: 0.4986225895316804
Validation class_accuracies: [0.5776965265082267, 0.5024875621890548, 0.28205128205128205, 0.13861386138613863]
Validation sensitivity: 0.4188191881918819
Validation specificity: 0.5776965265082267
Validation icbhi_score: 0.4982578573500543
Validation roc_auc: None
Validation avg_accuracy: 0.37521230803367556
Validation one_indexed_epoch: 47
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 6.25000029685907e-05
311/311 - 111s - loss: 0.0110 - accuracy: 0.7713 - 111s/epoch - 357ms/step
Epoch 48/80
Validation cm: [[278 216  33  20]
 [146 241   5  10]
 [ 11  15   8   5]
 [ 37  42   7  15]]
Validation normalized_cm: [[0.508 0.395 0.06  0.037]
 [0.363 0.6   0.012 0.025]
 [0.282 0.385 0.205 0.128]
 [0.366 0.416 0.069 0.149]]
Validation acc: 0.49770431588613406
Validation class_accuracies: [0.5082266910420475, 0.599502487562189, 0.20512820512820512, 0.1485148514851485]
Validation sensitivity: 0.4870848708487085
Validation specificity: 0.5082266910420475
Validation icbhi_score: 0.497655780945378
Validation roc_auc: None
Validation avg_accuracy: 0.36534305880439755
Validation one_indexed_epoch: 48
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 17 epochs
311/311 - 109s - loss: 0.0087 - accuracy: 0.7713 - 109s/epoch - 350ms/step
Epoch 49/80
Validation cm: [[303 198  29  17]
 [158 233   5   6]
 [ 13  11   7   8]
 [ 43  42   7   9]]
Validation normalized_cm: [[0.554 0.362 0.053 0.031]
 [0.393 0.58  0.012 0.015]
 [0.333 0.282 0.179 0.205]
 [0.426 0.416 0.069 0.089]]
Validation acc: 0.5068870523415978
Validation class_accuracies: [0.5539305301645339, 0.5796019900497512, 0.1794871794871795, 0.0891089108910891]
Validation sensitivity: 0.45940959409594095
Validation specificity: 0.5539305301645339
Validation icbhi_score: 0.5066700621302374
Validation roc_auc: None
Validation avg_accuracy: 0.3505321526481385
Validation one_indexed_epoch: 49
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 18 epochs
311/311 - 108s - loss: 0.0078 - accuracy: 0.7709 - 108s/epoch - 349ms/step
Epoch 50/80
Validation cm: [[266 232  28  21]
 [132 260   5   5]
 [ 11  12   7   9]
 [ 39  47   7   8]]
Validation normalized_cm: [[0.486 0.424 0.051 0.038]
 [0.328 0.647 0.012 0.012]
 [0.282 0.308 0.179 0.231]
 [0.386 0.465 0.069 0.079]]
Validation acc: 0.4967860422405877
Validation class_accuracies: [0.48628884826325414, 0.6467661691542289, 0.1794871794871795, 0.07920792079207921]
Validation sensitivity: 0.507380073800738
Validation specificity: 0.48628884826325414
Validation icbhi_score: 0.4968344610319961
Validation roc_auc: None
Validation avg_accuracy: 0.3479375294241855
Validation one_indexed_epoch: 50
The validation tracker metric at 0.5194249748713209 hasn't increased by 0 in 19 epochs
311/311 - 113s - loss: 0.0075 - accuracy: 0.7747 - 113s/epoch - 364ms/step
Epoch 51/80
Validation cm: [[265 231  33  18]
 [132 258   5   7]
 [ 11  12   8   8]
 [ 34  51   7   9]]
Validation normalized_cm: [[0.484 0.422 0.06  0.033]
 [0.328 0.642 0.012 0.017]
 [0.282 0.308 0.205 0.205]
 [0.337 0.505 0.069 0.089]]
Validation acc: 0.49586776859504134
Validation class_accuracies: [0.4844606946983547, 0.6417910447761194, 0.20512820512820512, 0.0891089108910891]
Validation sensitivity: 0.507380073800738
Validation specificity: 0.4844606946983547
Validation icbhi_score: 0.4959203842495463
Validation roc_auc: None
Validation avg_accuracy: 0.35512221387344206
Validation one_indexed_epoch: 51
The number of epochs since last 1% equals the patience
311/311 - 110s - loss: 0.0086 - accuracy: 0.7735 - 110s/epoch - 355ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5194249748713209
Best cm: [[322 187  25  13]
 [160 236   2   4]
 [ 19  11   5   4]
 [ 48  46   4   3]]
Best normalized_cm: [[0.589 0.342 0.046 0.024]
 [0.398 0.587 0.005 0.01 ]
 [0.487 0.282 0.128 0.103]
 [0.475 0.455 0.04  0.03 ]]
Best acc: 0.519742883379247
Best class_accuracies: [0.5886654478976234, 0.5870646766169154, 0.1282051282051282, 0.0297029702970297]
Best sensitivity: 0.45018450184501846
Best specificity: 0.5886654478976234
Best roc_auc: None
Best avg_accuracy: 0.3334095557541742
Best one_indexed_epoch: 31
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/callbacks/visualizationCallback.py:32: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  print(np.array(self.model._frontend.weights) - np.array(self.first_weights))
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train160.py", line 382, in <module>
    launch_job({"Bd": 0, "Jordan": 0, "Icbhi": 1, "Perch": 0, "Ant": 0, "SimAnt": 0,}, leaf_model9_model_efnet1, spec_aug_params, audio_aug_params, None, [1,0])
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train160.py", line 302, in launch_job
    train_model(datasets, model, spec_aug_params, audio_aug_params, parse_function, label_passed)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train160.py", line 284, in train_model
    callbacks=[metrics_callback, viz_callback, tensorboard_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/alirachidi/classification_algorithm/trainers/modules/callbacks/visualizationCallback.py", line 32, in on_train_end
    print(np.array(self.model._frontend.weights) - np.array(self.first_weights))
ValueError: could not broadcast input array from shape (80,2) into shape (80,)
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[<tf.Variable 'kernel:0' shape=(80, 2) dtype=float32, numpy=
array([[  49.999,   23.222],
       [  73.222,   23.941],
       [  97.163,   24.682],
       [ 121.846,   25.447],
       [ 147.292,   26.234],
       [ 173.526,   27.047],
       [ 200.574,   27.885],
       [ 228.457,   28.747],
       [ 257.205,   29.638],
       [ 286.843,   30.556],
       [ 317.398,   31.501],
       [ 348.9  ,   32.477],
       [ 381.376,   33.482],
       [ 414.859,   34.519],
       [ 449.378,   35.588],
       [ 484.966,   36.69 ],
       [ 521.655,   37.826],
       [ 559.481,   38.997],
       [ 598.478,   40.204],
       [ 638.683,   41.449],
       [ 680.132,   42.733],
       [ 722.864,   44.056],
       [ 766.92 ,   45.42 ],
       [ 812.34 ,   46.826],
       [ 859.166,   48.276],
       [ 907.442,   49.771],
       [ 957.213,   51.312],
       [1008.525,   52.901],
       [1061.426,   54.539],
       [1115.964,   56.227],
       [1172.191,   57.968],
       [1230.159,   59.763],
       [1289.922,   61.613],
       [1351.536,   63.521],
       [1415.057,   65.488],
       [1480.545,   67.516],
       [1548.061,   69.606],
       [1617.667,   71.761],
       [1689.428,   73.983],
       [1763.411,   76.274],
       [1839.685,   78.636],
       [1918.321,   81.07 ],
       [1999.391,   83.581],
       [2082.971,   86.168],
       [2169.14 ,   88.836],
       [2257.976,   91.587],
       [2349.563,   94.423],
       [2443.986,   97.346],
       [2541.333,  100.36 ],
       [2641.693,  103.468],
       [2745.161,  106.672],
       [2851.833,  109.974],
       [2961.807,  113.38 ],
       [3075.187,  116.89 ],
       [3192.076,  120.509],
       [3312.586,  124.241],
       [3436.826,  128.087],
       [3564.914,  132.053],
       [3696.967,  136.142],
       [3833.109,  140.357],
       [3973.467,  144.703],
       [4118.17 ,  149.184],
       [4267.354,  153.803],
       [4421.157,  158.565],
       [4579.722,  163.475],
       [4743.196,  168.536],
       [4911.732,  173.755],
       [5085.487,  179.134],
       [5264.621,  184.681],
       [5449.302,  190.399],
       [5639.701,  196.294],
       [5835.996,  202.372],
       [6038.368,  208.638],
       [6247.006,  215.098],
       [6462.104,  221.758],
       [6683.863,  228.625],
       [6912.487,  235.703],
       [7148.191,  243.001],
       [7391.192,  250.525],
       [7641.718,  258.282]], dtype=float32)>, <tf.Variable 'sincnet/layer_normalization/gamma:0' shape=(80,) dtype=float32, numpy=
array([0.938, 0.99 , 1.052, 0.886, 0.933, 1.018, 1.074, 0.993, 0.97 ,
       0.939, 0.992, 1.08 , 1.013, 1.002, 1.055, 0.97 , 0.994, 1.   ,
       1.008, 1.067, 1.016, 1.011, 1.022, 0.993, 0.995, 1.054, 1.034,
       1.008, 1.008, 1.02 , 1.032, 1.017, 0.99 , 1.025, 1.022, 1.033,
       1.026, 0.991, 0.995, 1.023, 1.087, 1.012, 0.97 , 0.992, 0.991,
       0.964, 0.999, 0.979, 0.97 , 1.033, 0.987, 0.97 , 1.021, 1.004,
       0.959, 1.009, 1.05 , 1.005, 0.983, 1.029, 1.018, 0.98 , 0.993,
       0.994, 1.033, 0.969, 0.934, 1.032, 1.03 , 0.932, 1.009, 1.1  ,
       0.988, 0.967, 1.022, 0.999, 0.987, 0.994, 1.006, 1.001],
      dtype=float32)>, <tf.Variable 'sincnet/layer_normalization/beta:0' shape=(80,) dtype=float32, numpy=
array([-0.013, -0.006,  0.   , -0.063, -0.043,  0.021,  0.035,  0.016,
       -0.002, -0.11 , -0.048,  0.013, -0.041,  0.038,  0.078, -0.121,
       -0.092,  0.065,  0.057,  0.008, -0.032,  0.005,  0.011,  0.002,
        0.089, -0.052, -0.059,  0.02 ,  0.011, -0.028,  0.003,  0.076,
        0.012, -0.007, -0.012, -0.021,  0.036,  0.034,  0.022, -0.042,
       -0.125, -0.038,  0.019,  0.012, -0.016,  0.03 , -0.011,  0.08 ,
        0.038, -0.088,  0.004,  0.097, -0.032, -0.014,  0.097, -0.004,
       -0.076,  0.003,  0.099, -0.047, -0.092,  0.098,  0.021, -0.019,
       -0.018,  0.07 ,  0.139, -0.077, -0.091,  0.159,  0.005, -0.19 ,
        0.036,  0.059, -0.036,  0.011,  0.004,  0.015,  0.002, -0.002],
      dtype=float32)>]
Post training weights
[<tf.Variable 'kernel:0' shape=(80, 2) dtype=float32, numpy=
array([[  49.999,   23.222],
       [  73.222,   23.941],
       [  97.163,   24.682],
       [ 121.846,   25.447],
       [ 147.292,   26.234],
       [ 173.526,   27.047],
       [ 200.574,   27.885],
       [ 228.457,   28.747],
       [ 257.205,   29.638],
       [ 286.843,   30.556],
       [ 317.398,   31.501],
       [ 348.9  ,   32.477],
       [ 381.376,   33.482],
       [ 414.859,   34.519],
       [ 449.378,   35.588],
       [ 484.966,   36.69 ],
       [ 521.655,   37.826],
       [ 559.481,   38.997],
       [ 598.478,   40.204],
       [ 638.683,   41.449],
       [ 680.132,   42.733],
       [ 722.864,   44.056],
       [ 766.92 ,   45.42 ],
       [ 812.34 ,   46.826],
       [ 859.166,   48.276],
       [ 907.442,   49.771],
       [ 957.213,   51.312],
       [1008.525,   52.901],
       [1061.426,   54.539],
       [1115.964,   56.227],
       [1172.191,   57.968],
       [1230.159,   59.763],
       [1289.922,   61.613],
       [1351.536,   63.521],
       [1415.057,   65.488],
       [1480.545,   67.516],
       [1548.061,   69.606],
       [1617.667,   71.761],
       [1689.428,   73.983],
       [1763.411,   76.274],
       [1839.685,   78.636],
       [1918.321,   81.07 ],
       [1999.391,   83.581],
       [2082.971,   86.168],
       [2169.14 ,   88.836],
       [2257.976,   91.587],
       [2349.563,   94.423],
       [2443.986,   97.346],
       [2541.333,  100.36 ],
       [2641.693,  103.468],
       [2745.161,  106.672],
       [2851.833,  109.974],
       [2961.807,  113.38 ],
       [3075.187,  116.89 ],
       [3192.076,  120.509],
       [3312.586,  124.241],
       [3436.826,  128.087],
       [3564.914,  132.053],
       [3696.967,  136.142],
       [3833.109,  140.357],
       [3973.467,  144.703],
       [4118.17 ,  149.184],
       [4267.354,  153.803],
       [4421.157,  158.565],
       [4579.722,  163.475],
       [4743.196,  168.536],
       [4911.732,  173.755],
       [5085.487,  179.134],
       [5264.621,  184.681],
       [5449.302,  190.399],
       [5639.701,  196.294],
       [5835.996,  202.372],
       [6038.368,  208.638],
       [6247.006,  215.098],
       [6462.104,  221.758],
       [6683.863,  228.625],
       [6912.487,  235.703],
       [7148.191,  243.001],
       [7391.192,  250.525],
       [7641.718,  258.282]], dtype=float32)>, <tf.Variable 'sincnet/layer_normalization/gamma:0' shape=(80,) dtype=float32, numpy=
array([0.938, 0.99 , 1.052, 0.886, 0.933, 1.018, 1.074, 0.993, 0.97 ,
       0.939, 0.992, 1.08 , 1.013, 1.002, 1.055, 0.97 , 0.994, 1.   ,
       1.008, 1.067, 1.016, 1.011, 1.022, 0.993, 0.995, 1.054, 1.034,
       1.008, 1.008, 1.02 , 1.032, 1.017, 0.99 , 1.025, 1.022, 1.033,
       1.026, 0.991, 0.995, 1.023, 1.087, 1.012, 0.97 , 0.992, 0.991,
       0.964, 0.999, 0.979, 0.97 , 1.033, 0.987, 0.97 , 1.021, 1.004,
       0.959, 1.009, 1.05 , 1.005, 0.983, 1.029, 1.018, 0.98 , 0.993,
       0.994, 1.033, 0.969, 0.934, 1.032, 1.03 , 0.932, 1.009, 1.1  ,
       0.988, 0.967, 1.022, 0.999, 0.987, 0.994, 1.006, 1.001],
      dtype=float32)>, <tf.Variable 'sincnet/layer_normalization/beta:0' shape=(80,) dtype=float32, numpy=
array([-0.013, -0.006,  0.   , -0.063, -0.043,  0.021,  0.035,  0.016,
       -0.002, -0.11 , -0.048,  0.013, -0.041,  0.038,  0.078, -0.121,
       -0.092,  0.065,  0.057,  0.008, -0.032,  0.005,  0.011,  0.002,
        0.089, -0.052, -0.059,  0.02 ,  0.011, -0.028,  0.003,  0.076,
        0.012, -0.007, -0.012, -0.021,  0.036,  0.034,  0.022, -0.042,
       -0.125, -0.038,  0.019,  0.012, -0.016,  0.03 , -0.011,  0.08 ,
        0.038, -0.088,  0.004,  0.097, -0.032, -0.014,  0.097, -0.004,
       -0.076,  0.003,  0.099, -0.047, -0.092,  0.098,  0.021, -0.019,
       -0.018,  0.07 ,  0.139, -0.077, -0.091,  0.159,  0.005, -0.19 ,
        0.036,  0.059, -0.036,  0.011,  0.004,  0.015,  0.002, -0.002],
      dtype=float32)>]
Weight difference
