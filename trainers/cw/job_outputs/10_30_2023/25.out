Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train25
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 547s - loss: 0.4397 - accuracy: 0.5984 - 547s/epoch - 2s/step
Validation cm: [[719  14   7   0]
 [ 77   4  11   0]
 [ 70   1   6   0]
 [ 66   2  58   4]]
Validation normalized_cm: [[0.972 0.019 0.009 0.   ]
 [0.837 0.043 0.12  0.   ]
 [0.909 0.013 0.078 0.   ]
 [0.508 0.015 0.446 0.031]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.9716216216216216, 0.043478260869565216, 0.07792207792207792, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28094779779562384
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 540s - loss: 0.3449 - accuracy: 0.6544 - 540s/epoch - 2s/step
Validation cm: [[612  88  35   5]
 [ 20  52  13   7]
 [ 26   6  42   3]
 [ 18  13  78  21]]
Validation normalized_cm: [[0.827 0.119 0.047 0.007]
 [0.217 0.565 0.141 0.076]
 [0.338 0.078 0.545 0.039]
 [0.138 0.1   0.6   0.162]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.827027027027027, 0.5652173913043478, 0.5454545454545454, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5248093563310954
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 540s - loss: 0.3095 - accuracy: 0.6500 - 540s/epoch - 2s/step
Validation cm: [[584 133  12  11]
 [ 23  52  12   5]
 [ 36   6  28   7]
 [ 20  13  59  38]]
Validation normalized_cm: [[0.789 0.18  0.016 0.015]
 [0.25  0.565 0.13  0.054]
 [0.468 0.078 0.364 0.091]
 [0.154 0.1   0.454 0.292]]
Validation acc: 0.6756496631376323
Validation class_accuracies: [0.7891891891891892, 0.5652173913043478, 0.36363636363636365, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5025876591093982
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
The validation tracker metric at 0.5248093563310954 hasn't increased by 0 in 1 epochs
330/330 - 540s - loss: 0.2693 - accuracy: 0.6622 - 540s/epoch - 2s/step
Validation cm: [[634  50  43  13]
 [ 49  20  12  11]
 [ 30   1  36  10]
 [ 54   0  47  29]]
Validation normalized_cm: [[0.857 0.068 0.058 0.018]
 [0.533 0.217 0.13  0.12 ]
 [0.39  0.013 0.468 0.13 ]
 [0.415 0.    0.362 0.223]]
Validation acc: 0.6920115495668913
Validation class_accuracies: [0.8567567567567568, 0.21739130434782608, 0.4675324675324675, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44118936292849337
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
The validation tracker metric at 0.5248093563310954 hasn't increased by 0 in 2 epochs
330/330 - 540s - loss: 0.2408 - accuracy: 0.6572 - 540s/epoch - 2s/step
Validation cm: [[645  94   1   0]
 [ 38  49   4   1]
 [ 64   3  10   0]
 [ 60  18  34  18]]
Validation normalized_cm: [[0.872 0.127 0.001 0.   ]
 [0.413 0.533 0.043 0.011]
 [0.831 0.039 0.13  0.   ]
 [0.462 0.138 0.262 0.138]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.8716216216216216, 0.532608695652174, 0.12987012987012986, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41814049640136597
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.5248093563310954 hasn't increased by 0 in 3 epochs
330/330 - 505s - loss: 0.2039 - accuracy: 0.6626 - 505s/epoch - 2s/step
Validation cm: [[657  69   9   5]
 [ 44  38   6   4]
 [ 47   4  25   1]
 [ 45   6  63  16]]
Validation normalized_cm: [[0.888 0.093 0.012 0.007]
 [0.478 0.413 0.065 0.043]
 [0.61  0.052 0.325 0.013]
 [0.346 0.046 0.485 0.123]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.8878378378378379, 0.41304347826086957, 0.3246753246753247, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4371583909627388
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
The validation tracker metric at 0.5248093563310954 hasn't increased by 0 in 4 epochs
330/330 - 489s - loss: 0.1768 - accuracy: 0.6834 - 489s/epoch - 1s/step
Validation cm: [[585  70  59  26]
 [ 31  33  18  10]
 [ 17   5  40  15]
 [ 15   6  48  61]]
Validation normalized_cm: [[0.791 0.095 0.08  0.035]
 [0.337 0.359 0.196 0.109]
 [0.221 0.065 0.519 0.195]
 [0.115 0.046 0.369 0.469]]
Validation acc: 0.6920115495668913
Validation class_accuracies: [0.7905405405405406, 0.358695652173913, 0.5194805194805194, 0.46923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5344868703564356
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 489s - loss: 0.1505 - accuracy: 0.6747 - 489s/epoch - 1s/step
Validation cm: [[614  77  30  19]
 [ 28  35  13  16]
 [ 28   3  31  15]
 [ 25   6  57  42]]
Validation normalized_cm: [[0.83  0.104 0.041 0.026]
 [0.304 0.38  0.141 0.174]
 [0.364 0.039 0.403 0.195]
 [0.192 0.046 0.438 0.323]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.8297297297297297, 0.3804347826086957, 0.4025974025974026, 0.3230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48395970950318773
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.5344868703564356 hasn't increased by 0 in 1 epochs
330/330 - 488s - loss: 0.1295 - accuracy: 0.6656 - 488s/epoch - 1s/step
Validation cm: [[593  77  62   8]
 [ 32  37  13  10]
 [ 26   2  41   8]
 [ 26   5  60  39]]
Validation normalized_cm: [[0.801 0.104 0.084 0.011]
 [0.348 0.402 0.141 0.109]
 [0.338 0.026 0.532 0.104]
 [0.2   0.038 0.462 0.3  ]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.8013513513513514, 0.40217391304347827, 0.5324675324675324, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5089981992155904
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.5344868703564356 hasn't increased by 0 in 2 epochs
330/330 - 489s - loss: 0.1020 - accuracy: 0.6728 - 489s/epoch - 1s/step
Validation cm: [[635  78  16  11]
 [ 36  39  13   4]
 [ 40   5  26   6]
 [ 29   6  64  31]]
Validation normalized_cm: [[0.858 0.105 0.022 0.015]
 [0.391 0.424 0.141 0.043]
 [0.519 0.065 0.338 0.078]
 [0.223 0.046 0.492 0.238]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.8581081081081081, 0.42391304347826086, 0.33766233766233766, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4645362569275613
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.5344868703564356 hasn't increased by 0 in 3 epochs
330/330 - 488s - loss: 0.0936 - accuracy: 0.6777 - 488s/epoch - 1s/step
Validation cm: [[640  79  16   5]
 [ 39  35  12   6]
 [ 43   4  24   6]
 [ 32   8  61  29]]
Validation normalized_cm: [[0.865 0.107 0.022 0.007]
 [0.424 0.38  0.13  0.065]
 [0.558 0.052 0.312 0.078]
 [0.246 0.062 0.469 0.223]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8648648648648649, 0.3804347826086957, 0.3116883116883117, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4450162205596989
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The validation tracker metric at 0.5344868703564356 hasn't increased by 0 in 4 epochs
330/330 - 489s - loss: 0.0822 - accuracy: 0.6614 - 489s/epoch - 1s/step
Validation cm: [[574 133  17  16]
 [ 27  43  11  11]
 [ 23  14  18  22]
 [ 13  22  33  62]]
Validation normalized_cm: [[0.776 0.18  0.023 0.022]
 [0.293 0.467 0.12  0.12 ]
 [0.299 0.182 0.234 0.286]
 [0.1   0.169 0.254 0.477]]
Validation acc: 0.670837343599615
Validation class_accuracies: [0.7756756756756756, 0.4673913043478261, 0.23376623376623376, 0.47692307692307695]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48843907267820313
Validation one_indexed_epoch: 13
Epoch 13/17
[[0. 0.]]
The validation tracker metric at 0.5344868703564356 hasn't increased by 0 in 5 epochs
330/330 - 498s - loss: 0.0611 - accuracy: 0.6515 - 498s/epoch - 2s/step
Validation cm: [[703  34   2   1]
 [ 68  19   5   0]
 [ 63   3  10   1]
 [ 64   6  35  25]]
Validation normalized_cm: [[0.95  0.046 0.003 0.001]
 [0.739 0.207 0.054 0.   ]
 [0.818 0.039 0.13  0.013]
 [0.492 0.046 0.269 0.192]]
Validation acc: 0.7285851780558229
Validation class_accuracies: [0.95, 0.20652173913043478, 0.12987012987012986, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36967489032706424
Validation one_indexed_epoch: 14
Epoch 14/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 522s - loss: 0.0504 - accuracy: 0.6527 - 522s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5344868703564356
Best cm: [[585  70  59  26]
 [ 31  33  18  10]
 [ 17   5  40  15]
 [ 15   6  48  61]]
Best normalized_cm: [[0.791 0.095 0.08  0.035]
 [0.337 0.359 0.196 0.109]
 [0.221 0.065 0.519 0.195]
 [0.115 0.046 0.369 0.469]]
Best acc: 0.6920115495668913
Best class_accuracies: [0.7905405405405406, 0.358695652173913, 0.5194805194805194, 0.46923076923076923]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 8
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
