Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train219
Description: kfold with all data
-----------------------
training parameters
[('cache_root', '../cache/'), ('data_root', '../data/'), ('jordan_root', '../data/jwyy9np4gv-3/'), ('icbhi_root', '../data/raw_audios/icbhi_preprocessed_v2_8000/'), ('bd_root', '../data/PCV_SEGMENTED_Processed_Files/'), ('excel_path', '../data/Bangladesh_PCV_onlyStudyPatients.xlsx'), ('perch_root', '../data/raw_audios/perch_8000_10seconds'), ('ant_root', '../data/raw_audios/Antwerp_Clinical_Complete'), ('description', 'kfold with all data'), ('job_id', 0), ('mode', 'cw'), ('n_classes', 2), ('shape', (80, 200, 3)), ('n_epochs', 100), ('lr', 0.005), ('batch_size', 64), ('ll2_reg', 0), ('weight_decay', 0.0001), ('label_smoothing', 0), ('epsilon', 1e-07), ('es_patience', 13), ('min_delta', 0), ('train_test_ratio', 0.8), ('kfold', True), ('clause', 0), ('epoch_start', 0), ('testing', 0), ('adaptive_lr', True), ('cuberooting', 1), ('normalizing', 1), ('class_weights', True), ('early_stopping', True), ('initial_channels', 1), ('factor', 0.25), ('lr_patience', 6), ('min_lr', 1e-05), ('sr', 8000), ('audio_length', 5), ('step_size', 2.5), ('n_fft', 2048), ('hop_length', 254), ('n_mels', 128), ('overlap_threshold', 0.3), ('trainable_fb', False), ('to_decibel', True), ('train_nn', False), ('train_mel', False), ('file_dir', '../cache/cw/train219'), ('n_sequences', 9), ('activate_spectral_loss', False), ('normalize', False), ('stacking', False), ('oversample', False), ('one_hot_encoding', False), ('activation', 'sigmoid'), ('n_filters', 80), ('code', -1), ('distillation', False), ('viz_count', 5), ('window_len', 100), ('window_stride', 25)]
Job id is 1.
Job dir: ../cache/cw/train219/1
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
920 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
126 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
len of icbhi
7857
len of train icbhi
4769
len of val icbhi
3080
before icbhi addition
11647
after icbhi addition
16416
-----------------------
--- Final training dataset went from 0 to 16416 elements, with 11726 none's, 1637 crakles, 2096 wheezes and 957 both ---
--- Final Validation dataset contains 2912 elements, with 2424 none, 60 crackles, 324 wheezes and 104 both ---
Initializing weights...
weights = {0: 0.3499914719426915, 1: 2.5070250458155163, 2: 1.9580152671755726, 3: 4.2884012539184955}
Model: "leaf_model9"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 80, 200, 1)                          4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 200, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 200, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 200, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 2)                                   6192322          
                                                                                                              
==============================================================================================================
Total params: 6,201,318
Trainable params: 6,159,812
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Target metric is icbhi_score
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 1/100
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[2424    0    0    0]
 [  60    0    0    0]
 [ 324    0    0    0]
 [ 104    0    0    0]]
Validation val_loss: 0.5454052970591154
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.8324175824175825
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Validation cm: [[1574    0    0    0]
 [ 860    0    0    0]
 [ 404    0    0    0]
 [ 242    0    0    0]]
Validation val_loss: 0.6448433879908029
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5110389610389611
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
257/257 - 490s - loss: 0.6539 - accuracy: 0.4599 - 490s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 2/100
Validation cm: [[2366    0   58    0]
 [  58    0    2    0]
 [ 173    0  151    0]
 [  28    0   76    0]]
Validation val_loss: 0.4174561475475247
Validation normalized_cm: [[0.976 0.    0.024 0.   ]
 [0.967 0.    0.033 0.   ]
 [0.534 0.    0.466 0.   ]
 [0.269 0.    0.731 0.   ]]
Validation acc: 0.8643543956043956
Validation class_accuracies: [0.9760726072607261, 0.0, 0.4660493827160494, 0.0]
Validation sensitivity: 0.3094262295081967
Validation specificity: 0.9760726072607261
Validation icbhi_score: 0.6427494183844614
Validation roc_auc: None
Validation avg_accuracy: 0.36053049749419386
Validation one_indexed_epoch: 2
Validation cm: [[1377  189    8    0]
 [ 680  175    5    0]
 [ 381   21    2    0]
 [ 215   26    1    0]]
Validation val_loss: 0.6232434362850406
Validation normalized_cm: [[0.875 0.12  0.005 0.   ]
 [0.791 0.203 0.006 0.   ]
 [0.943 0.052 0.005 0.   ]
 [0.888 0.107 0.004 0.   ]]
Validation acc: 0.5045454545454545
Validation class_accuracies: [0.874841168996188, 0.20348837209302326, 0.0049504950495049506, 0.0]
Validation sensitivity: 0.11752988047808766
Validation specificity: 0.874841168996188
Validation icbhi_score: 0.49618552473713784
Validation roc_auc: None
Validation avg_accuracy: 0.27082000903467907
Validation one_indexed_epoch: 2
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
-----------------------------
257/257 - 475s - loss: 0.5558 - accuracy: 0.4365 - 475s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 3/100
Validation cm: [[2142   37  130  115]
 [  42    4    2   12]
 [ 137    4   26  157]
 [  17    3   18   66]]
Validation val_loss: 0.4047598645500749
Validation normalized_cm: [[0.884 0.015 0.054 0.047]
 [0.7   0.067 0.033 0.2  ]
 [0.423 0.012 0.08  0.485]
 [0.163 0.029 0.173 0.635]]
Validation acc: 0.7685439560439561
Validation class_accuracies: [0.8836633663366337, 0.06666666666666667, 0.08024691358024691, 0.6346153846153846]
Validation sensitivity: 0.19672131147540983
Validation specificity: 0.8836633663366337
Validation icbhi_score: 0.5401923389060217
Validation roc_auc: None
Validation avg_accuracy: 0.41629808279973296
Validation one_indexed_epoch: 3
Validation cm: [[  35 1346    1  192]
 [   2  836    0   22]
 [   2  353    0   49]
 [   0  207    0   35]]
Validation val_loss: 0.7920331677421928
Validation normalized_cm: [[2.224e-02 8.551e-01 6.353e-04 1.220e-01]
 [2.326e-03 9.721e-01 0.000e+00 2.558e-02]
 [4.950e-03 8.738e-01 0.000e+00 1.213e-01]
 [0.000e+00 8.554e-01 0.000e+00 1.446e-01]]
Validation acc: 0.29415584415584417
Validation class_accuracies: [0.022236340533672173, 0.9720930232558139, 0.0, 0.1446280991735537]
Validation sensitivity: 0.5783532536520585
Validation specificity: 0.022236340533672173
Validation icbhi_score: 0.30029479709286533
Validation roc_auc: None
Validation avg_accuracy: 0.28473936574076
Validation one_indexed_epoch: 3
-----------------------------
The validation tracker metric at 0.6427494183844614 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
-----------------------------
257/257 - 471s - loss: 0.5284 - accuracy: 0.4322 - 471s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 4/100
Validation cm: [[1685   44  601   94]
 [  35    6   19    0]
 [  65    3  124  132]
 [   8    0   28   68]]
Validation val_loss: 0.44655176650425404
Validation normalized_cm: [[0.695 0.018 0.248 0.039]
 [0.583 0.1   0.317 0.   ]
 [0.201 0.009 0.383 0.407]
 [0.077 0.    0.269 0.654]]
Validation acc: 0.6466346153846154
Validation class_accuracies: [0.6951320132013201, 0.1, 0.38271604938271603, 0.6538461538461539]
Validation sensitivity: 0.4057377049180328
Validation specificity: 0.6951320132013201
Validation icbhi_score: 0.5504348590596765
Validation roc_auc: None
Validation avg_accuracy: 0.4579235541075475
Validation one_indexed_epoch: 4
Validation cm: [[245 588 315 426]
 [ 74 394 112 280]
 [ 26  56 108 214]
 [ 51  66  31  94]]
Validation val_loss: 0.8680147421255998
Validation normalized_cm: [[0.156 0.374 0.2   0.271]
 [0.086 0.458 0.13  0.326]
 [0.064 0.139 0.267 0.53 ]
 [0.211 0.273 0.128 0.388]]
Validation acc: 0.27305194805194805
Validation class_accuracies: [0.1556543837357052, 0.45813953488372094, 0.26732673267326734, 0.3884297520661157]
Validation sensitivity: 0.39575033200531207
Validation specificity: 0.1556543837357052
Validation icbhi_score: 0.2757023578705086
Validation roc_auc: None
Validation avg_accuracy: 0.3173876008397023
Validation one_indexed_epoch: 4
-----------------------------
The validation tracker metric at 0.6427494183844614 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
-----------------------------
257/257 - 468s - loss: 0.5048 - accuracy: 0.4575 - 468s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 5/100
Validation cm: [[1296    2 1113   13]
 [  23    0   37    0]
 [  56    0  192   76]
 [  18    0   74   12]]
Validation val_loss: 0.5595557584296159
Validation normalized_cm: [[0.535 0.001 0.459 0.005]
 [0.383 0.    0.617 0.   ]
 [0.173 0.    0.593 0.235]
 [0.173 0.    0.712 0.115]]
Validation acc: 0.5151098901098901
Validation class_accuracies: [0.5346534653465347, 0.0, 0.5925925925925926, 0.11538461538461539]
Validation sensitivity: 0.4180327868852459
Validation specificity: 0.5346534653465347
Validation icbhi_score: 0.4763431261158903
Validation roc_auc: None
Validation avg_accuracy: 0.31065766833093567
Validation one_indexed_epoch: 5
Validation cm: [[ 101    4  251 1218]
 [  19    3   50  788]
 [  44    0   57  303]
 [  34    1   46  161]]
Validation val_loss: 1.893183392056844
Validation normalized_cm: [[0.064 0.003 0.159 0.774]
 [0.022 0.003 0.058 0.916]
 [0.109 0.    0.141 0.75 ]
 [0.14  0.004 0.19  0.665]]
Validation acc: 0.10454545454545454
Validation class_accuracies: [0.06416772554002541, 0.0034883720930232558, 0.14108910891089108, 0.6652892561983471]
Validation sensitivity: 0.14674634794156707
Validation specificity: 0.06416772554002541
Validation icbhi_score: 0.10545703674079623
Validation roc_auc: None
Validation avg_accuracy: 0.21850861568557173
Validation one_indexed_epoch: 5
-----------------------------
The validation tracker metric at 0.6427494183844614 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
-----------------------------
257/257 - 465s - loss: 0.4842 - accuracy: 0.4529 - 465s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 6/100
Validation cm: [[1374  104  762  184]
 [  21    3   19   17]
 [  43    6  237   38]
 [   3    0   52   49]]
Validation val_loss: 0.5663880576690784
Validation normalized_cm: [[0.567 0.043 0.314 0.076]
 [0.35  0.05  0.317 0.283]
 [0.133 0.019 0.731 0.117]
 [0.029 0.    0.5   0.471]]
Validation acc: 0.5710851648351648
Validation class_accuracies: [0.5668316831683168, 0.05, 0.7314814814814815, 0.47115384615384615]
Validation sensitivity: 0.5922131147540983
Validation specificity: 0.5668316831683168
Validation icbhi_score: 0.5795223989612075
Validation roc_auc: None
Validation avg_accuracy: 0.45486675270091115
Validation one_indexed_epoch: 6
Validation cm: [[ 51 742  84 697]
 [ 10 503  31 316]
 [  3 104  32 265]
 [  7  86  18 131]]
Validation val_loss: 0.9978885338218375
Validation normalized_cm: [[0.032 0.471 0.053 0.443]
 [0.012 0.585 0.036 0.367]
 [0.007 0.257 0.079 0.656]
 [0.029 0.355 0.074 0.541]]
Validation acc: 0.2327922077922078
Validation class_accuracies: [0.032401524777636595, 0.5848837209302326, 0.07920792079207921, 0.5413223140495868]
Validation sensitivity: 0.44223107569721115
Validation specificity: 0.032401524777636595
Validation icbhi_score: 0.23731630023742387
Validation roc_auc: None
Validation avg_accuracy: 0.3094538701373838
Validation one_indexed_epoch: 6
-----------------------------
The validation tracker metric at 0.6427494183844614 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
-----------------------------
257/257 - 461s - loss: 0.4677 - accuracy: 0.4644 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 7/100
Validation cm: [[2201    2  202   19]
 [  42    1   14    3]
 [ 121    0  203    0]
 [  13    4   70   17]]
Validation val_loss: 0.2763876786900328
Validation normalized_cm: [[9.080e-01 8.251e-04 8.333e-02 7.838e-03]
 [7.000e-01 1.667e-02 2.333e-01 5.000e-02]
 [3.735e-01 0.000e+00 6.265e-01 0.000e+00]
 [1.250e-01 3.846e-02 6.731e-01 1.635e-01]]
Validation acc: 0.8317307692307693
Validation class_accuracies: [0.908003300330033, 0.016666666666666666, 0.6265432098765432, 0.16346153846153846]
Validation sensitivity: 0.45286885245901637
Validation specificity: 0.908003300330033
Validation icbhi_score: 0.6804360763945246
Validation roc_auc: None
Validation avg_accuracy: 0.42866867883369536
Validation one_indexed_epoch: 7
Validation cm: [[ 168 1061  151  194]
 [  29  705   16  110]
 [  38  197   43  126]
 [  27  128   13   74]]
Validation val_loss: 0.83414410438824
Validation normalized_cm: [[0.107 0.674 0.096 0.123]
 [0.034 0.82  0.019 0.128]
 [0.094 0.488 0.106 0.312]
 [0.112 0.529 0.054 0.306]]
Validation acc: 0.32142857142857145
Validation class_accuracies: [0.10673443456162643, 0.8197674418604651, 0.10643564356435643, 0.30578512396694213]
Validation sensitivity: 0.545816733067729
Validation specificity: 0.10673443456162643
Validation icbhi_score: 0.32627558381467775
Validation roc_auc: None
Validation avg_accuracy: 0.3346806609883476
Validation one_indexed_epoch: 7
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0012499999720603228
-----------------------------
257/257 - 461s - loss: 0.4499 - accuracy: 0.4732 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 8/100
Validation cm: [[1958   58  370   38]
 [  31    6   10   13]
 [  57    5  244   18]
 [   2    0   49   53]]
Validation val_loss: 0.3600103714945742
Validation normalized_cm: [[0.808 0.024 0.153 0.016]
 [0.517 0.1   0.167 0.217]
 [0.176 0.015 0.753 0.056]
 [0.019 0.    0.471 0.51 ]]
Validation acc: 0.7764423076923077
Validation class_accuracies: [0.8077557755775577, 0.1, 0.7530864197530864, 0.5096153846153846]
Validation sensitivity: 0.6209016393442623
Validation specificity: 0.8077557755775577
Validation icbhi_score: 0.71432870746091
Validation roc_auc: None
Validation avg_accuracy: 0.5426143949865072
Validation one_indexed_epoch: 8
Validation cm: [[ 212 1086  135  141]
 [  65  755   14   26]
 [  27  241   40   96]
 [  14  156   15   57]]
Validation val_loss: 0.8333077823945817
Validation normalized_cm: [[0.135 0.69  0.086 0.09 ]
 [0.076 0.878 0.016 0.03 ]
 [0.067 0.597 0.099 0.238]
 [0.058 0.645 0.062 0.236]]
Validation acc: 0.34545454545454546
Validation class_accuracies: [0.13468869123252858, 0.877906976744186, 0.09900990099009901, 0.23553719008264462]
Validation sensitivity: 0.5657370517928287
Validation specificity: 0.13468869123252858
Validation icbhi_score: 0.35021287151267866
Validation roc_auc: None
Validation avg_accuracy: 0.33678568976236456
Validation one_indexed_epoch: 8
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
-----------------------------
257/257 - 461s - loss: 0.3984 - accuracy: 0.4816 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 9/100
Validation cm: [[2247   67   85   25]
 [  39   13    1    7]
 [ 110    1  198   15]
 [  17    7   71    9]]
Validation val_loss: 0.26419802099253803
Validation normalized_cm: [[0.927 0.028 0.035 0.01 ]
 [0.65  0.217 0.017 0.117]
 [0.34  0.003 0.611 0.046]
 [0.163 0.067 0.683 0.087]]
Validation acc: 0.8471840659340659
Validation class_accuracies: [0.926980198019802, 0.21666666666666667, 0.6111111111111112, 0.08653846153846154]
Validation sensitivity: 0.45081967213114754
Validation specificity: 0.926980198019802
Validation icbhi_score: 0.6888999350754748
Validation roc_auc: None
Validation avg_accuracy: 0.4603241093340103
Validation one_indexed_epoch: 9
Validation cm: [[ 267 1085  116  106]
 [  75  747   15   23]
 [  54  255   43   52]
 [  39  162   11   30]]
Validation val_loss: 0.8636900205277027
Validation normalized_cm: [[0.17  0.689 0.074 0.067]
 [0.087 0.869 0.017 0.027]
 [0.134 0.631 0.106 0.129]
 [0.161 0.669 0.045 0.124]]
Validation acc: 0.3529220779220779
Validation class_accuracies: [0.1696315120711563, 0.8686046511627907, 0.10643564356435643, 0.12396694214876033]
Validation sensitivity: 0.5444887118193891
Validation specificity: 0.1696315120711563
Validation icbhi_score: 0.35706011194527265
Validation roc_auc: None
Validation avg_accuracy: 0.31715968723676596
Validation one_indexed_epoch: 9
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
-----------------------------
257/257 - 461s - loss: 0.3726 - accuracy: 0.5090 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 10/100
Validation cm: [[1989   83  276   76]
 [  29   10    5   16]
 [  67    4  240   13]
 [   6    9   64   25]]
Validation val_loss: 0.36883929019111017
Validation normalized_cm: [[0.821 0.034 0.114 0.031]
 [0.483 0.167 0.083 0.267]
 [0.207 0.012 0.741 0.04 ]
 [0.058 0.087 0.615 0.24 ]]
Validation acc: 0.7774725274725275
Validation class_accuracies: [0.8205445544554455, 0.16666666666666666, 0.7407407407407407, 0.2403846153846154]
Validation sensitivity: 0.5635245901639344
Validation specificity: 0.8205445544554455
Validation icbhi_score: 0.6920345723096899
Validation roc_auc: None
Validation avg_accuracy: 0.4920841443118671
Validation one_indexed_epoch: 10
Validation cm: [[ 159 1077  132  206]
 [  74  727   12   47]
 [  18  199   49  138]
 [  17  138   16   71]]
Validation val_loss: 0.933040906706078
Validation normalized_cm: [[0.101 0.684 0.084 0.131]
 [0.086 0.845 0.014 0.055]
 [0.045 0.493 0.121 0.342]
 [0.07  0.57  0.066 0.293]]
Validation acc: 0.32662337662337665
Validation class_accuracies: [0.10101651842439645, 0.8453488372093023, 0.12128712871287128, 0.29338842975206614]
Validation sensitivity: 0.5624169986719787
Validation specificity: 0.10101651842439645
Validation icbhi_score: 0.33171675854818755
Validation roc_auc: None
Validation avg_accuracy: 0.34026022852465904
Validation one_indexed_epoch: 10
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
-----------------------------
257/257 - 461s - loss: 0.3578 - accuracy: 0.5038 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 11/100
Validation cm: [[1966   42  355   61]
 [  32    8    7   13]
 [  63    1  235   25]
 [   0    4   50   50]]
Validation val_loss: 0.34910793133910906
Validation normalized_cm: [[0.811 0.017 0.146 0.025]
 [0.533 0.133 0.117 0.217]
 [0.194 0.003 0.725 0.077]
 [0.    0.038 0.481 0.481]]
Validation acc: 0.7757554945054945
Validation class_accuracies: [0.8110561056105611, 0.13333333333333333, 0.7253086419753086, 0.4807692307692308]
Validation sensitivity: 0.6004098360655737
Validation specificity: 0.8110561056105611
Validation icbhi_score: 0.7057329708380674
Validation roc_auc: None
Validation avg_accuracy: 0.5376168279221084
Validation one_indexed_epoch: 11
Validation cm: [[ 244 1068   66  196]
 [  98  712    4   46]
 [  34  250   22   98]
 [  13  168    8   53]]
Validation val_loss: 0.8944190467433027
Validation normalized_cm: [[0.155 0.679 0.042 0.125]
 [0.114 0.828 0.005 0.053]
 [0.084 0.619 0.054 0.243]
 [0.054 0.694 0.033 0.219]]
Validation acc: 0.3347402597402597
Validation class_accuracies: [0.15501905972045743, 0.827906976744186, 0.054455445544554455, 0.2190082644628099]
Validation sensitivity: 0.5225763612217795
Validation specificity: 0.15501905972045743
Validation icbhi_score: 0.3387977104711185
Validation roc_auc: None
Validation avg_accuracy: 0.314097436618002
Validation one_indexed_epoch: 11
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
-----------------------------
257/257 - 463s - loss: 0.3480 - accuracy: 0.5199 - 463s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 12/100
Validation cm: [[1837   48  467   72]
 [  24    8   11   17]
 [  47    3  251   23]
 [   1    2   46   55]]
Validation val_loss: 0.3894989414696353
Validation normalized_cm: [[0.758 0.02  0.193 0.03 ]
 [0.4   0.133 0.183 0.283]
 [0.145 0.009 0.775 0.071]
 [0.01  0.019 0.442 0.529]]
Validation acc: 0.7386675824175825
Validation class_accuracies: [0.7578382838283828, 0.13333333333333333, 0.7746913580246914, 0.5288461538461539]
Validation sensitivity: 0.6434426229508197
Validation specificity: 0.7578382838283828
Validation icbhi_score: 0.7006404533896012
Validation roc_auc: None
Validation avg_accuracy: 0.5486772822581403
Validation one_indexed_epoch: 12
Validation cm: [[297 802 289 186]
 [ 93 622 105  40]
 [ 39 138 115 112]
 [ 46 101  38  57]]
Validation val_loss: 0.9057433536183996
Validation normalized_cm: [[0.189 0.51  0.184 0.118]
 [0.108 0.723 0.122 0.047]
 [0.097 0.342 0.285 0.277]
 [0.19  0.417 0.157 0.236]]
Validation acc: 0.3542207792207792
Validation class_accuracies: [0.18869123252858958, 0.7232558139534884, 0.28465346534653463, 0.23553719008264462]
Validation sensitivity: 0.5272244355909694
Validation specificity: 0.18869123252858958
Validation icbhi_score: 0.3579578340597795
Validation roc_auc: None
Validation avg_accuracy: 0.3580344254778143
Validation one_indexed_epoch: 12
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
-----------------------------
257/257 - 462s - loss: 0.3378 - accuracy: 0.5194 - 462s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 13/100
Validation cm: [[2056  287   57   24]
 [  31   22    2    5]
 [  98   36  186    4]
 [  13   15   59   17]]
Validation val_loss: 0.3511486565413428
Validation normalized_cm: [[0.848 0.118 0.024 0.01 ]
 [0.517 0.367 0.033 0.083]
 [0.302 0.111 0.574 0.012]
 [0.125 0.144 0.567 0.163]]
Validation acc: 0.7833104395604396
Validation class_accuracies: [0.8481848184818482, 0.36666666666666664, 0.5740740740740741, 0.16346153846153846]
Validation sensitivity: 0.4610655737704918
Validation specificity: 0.8481848184818482
Validation icbhi_score: 0.65462519612617
Validation roc_auc: None
Validation avg_accuracy: 0.4880967744210319
Validation one_indexed_epoch: 13
Validation cm: [[ 143 1136   74  221]
 [  41  756    5   58]
 [  22  230   28  124]
 [  28  136    6   72]]
Validation val_loss: 1.0075348646549716
Validation normalized_cm: [[0.091 0.722 0.047 0.14 ]
 [0.048 0.879 0.006 0.067]
 [0.054 0.569 0.069 0.307]
 [0.116 0.562 0.025 0.298]]
Validation acc: 0.32435064935064933
Validation class_accuracies: [0.09085133418043202, 0.8790697674418605, 0.06930693069306931, 0.2975206611570248]
Validation sensitivity: 0.5683930942895087
Validation specificity: 0.09085133418043202
Validation icbhi_score: 0.32962221423497035
Validation roc_auc: None
Validation avg_accuracy: 0.33418717336809667
Validation one_indexed_epoch: 13
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 5 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0003124999930150807
-----------------------------
257/257 - 463s - loss: 0.3308 - accuracy: 0.5160 - 463s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 14/100
Validation cm: [[2164   96  130   34]
 [  33   15    5    7]
 [  86    8  212   18]
 [   9   11   51   33]]
Validation val_loss: 0.28421716062997066
Validation normalized_cm: [[0.893 0.04  0.054 0.014]
 [0.55  0.25  0.083 0.117]
 [0.265 0.025 0.654 0.056]
 [0.087 0.106 0.49  0.317]]
Validation acc: 0.8324175824175825
Validation class_accuracies: [0.8927392739273927, 0.25, 0.654320987654321, 0.3173076923076923]
Validation sensitivity: 0.5327868852459017
Validation specificity: 0.8927392739273927
Validation icbhi_score: 0.7127630795866472
Validation roc_auc: None
Validation avg_accuracy: 0.5285919884723516
Validation one_indexed_epoch: 14
Validation cm: [[ 232 1046  119  177]
 [  73  735   12   40]
 [  37  242   34   91]
 [  37  135   14   56]]
Validation val_loss: 0.9665138616926995
Validation normalized_cm: [[0.147 0.665 0.076 0.112]
 [0.085 0.855 0.014 0.047]
 [0.092 0.599 0.084 0.225]
 [0.153 0.558 0.058 0.231]]
Validation acc: 0.3431818181818182
Validation class_accuracies: [0.1473951715374841, 0.8546511627906976, 0.08415841584158416, 0.23140495867768596]
Validation sensitivity: 0.547808764940239
Validation specificity: 0.1473951715374841
Validation icbhi_score: 0.3476019682388616
Validation roc_auc: None
Validation avg_accuracy: 0.32940242721186297
Validation one_indexed_epoch: 14
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 7.812499825377017e-05
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
-----------------------------
257/257 - 462s - loss: 0.2915 - accuracy: 0.5311 - 462s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 15/100
Validation cm: [[2064   66  241   53]
 [  29   16    6    9]
 [  69    7  233   15]
 [   5    8   59   32]]
Validation val_loss: 0.3215328442462263
Validation normalized_cm: [[0.851 0.027 0.099 0.022]
 [0.483 0.267 0.1   0.15 ]
 [0.213 0.022 0.719 0.046]
 [0.048 0.077 0.567 0.308]]
Validation acc: 0.8052884615384616
Validation class_accuracies: [0.8514851485148515, 0.26666666666666666, 0.7191358024691358, 0.3076923076923077]
Validation sensitivity: 0.5758196721311475
Validation specificity: 0.8514851485148515
Validation icbhi_score: 0.7136524103229995
Validation roc_auc: None
Validation avg_accuracy: 0.5362449813357404
Validation one_indexed_epoch: 15
Validation cm: [[ 255 1002  120  197]
 [  94  715    8   43]
 [  40  218   42  104]
 [  40  130   11   61]]
Validation val_loss: 0.9771090547841265
Validation normalized_cm: [[0.162 0.637 0.076 0.125]
 [0.109 0.831 0.009 0.05 ]
 [0.099 0.54  0.104 0.257]
 [0.165 0.537 0.045 0.252]]
Validation acc: 0.3483766233766234
Validation class_accuracies: [0.16200762388818296, 0.8313953488372093, 0.10396039603960396, 0.25206611570247933]
Validation sensitivity: 0.5431606905710491
Validation specificity: 0.16200762388818296
Validation icbhi_score: 0.352584157229616
Validation roc_auc: None
Validation avg_accuracy: 0.3373573711168689
Validation one_indexed_epoch: 15
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 7 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
-----------------------------
257/257 - 463s - loss: 0.2781 - accuracy: 0.5366 - 463s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 16/100
Validation cm: [[2139   82  163   40]
 [  34   12    6    8]
 [  88    6  218   12]
 [   9   10   58   27]]
Validation val_loss: 0.29952273078153346
Validation normalized_cm: [[0.882 0.034 0.067 0.017]
 [0.567 0.2   0.1   0.133]
 [0.272 0.019 0.673 0.037]
 [0.087 0.096 0.558 0.26 ]]
Validation acc: 0.8228021978021978
Validation class_accuracies: [0.8824257425742574, 0.2, 0.6728395061728395, 0.25961538461538464]
Validation sensitivity: 0.5266393442622951
Validation specificity: 0.8824257425742574
Validation icbhi_score: 0.7045325434182763
Validation roc_auc: None
Validation avg_accuracy: 0.5037201583406203
Validation one_indexed_epoch: 16
Validation cm: [[285 993 116 180]
 [ 89 723   8  40]
 [ 53 219  42  90]
 [ 40 135  12  55]]
Validation val_loss: 0.9830161543624807
Validation normalized_cm: [[0.181 0.631 0.074 0.114]
 [0.103 0.841 0.009 0.047]
 [0.131 0.542 0.104 0.223]
 [0.165 0.558 0.05  0.227]]
Validation acc: 0.3587662337662338
Validation class_accuracies: [0.18106734434561628, 0.8406976744186047, 0.10396039603960396, 0.22727272727272727]
Validation sensitivity: 0.5444887118193891
Validation specificity: 0.18106734434561628
Validation icbhi_score: 0.3627780280825027
Validation roc_auc: None
Validation avg_accuracy: 0.33824953551913806
Validation one_indexed_epoch: 16
-----------------------------
The validation tracker metric at 0.71432870746091 hasn't increased by 0 in 8 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
-----------------------------
257/257 - 458s - loss: 0.2748 - accuracy: 0.5389 - 458s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 17/100
Validation cm: [[2116   68  198   42]
 [  33   13    6    8]
 [  69    9  236   10]
 [   8   10   53   33]]
Validation val_loss: 0.30195809416272823
Validation normalized_cm: [[0.873 0.028 0.082 0.017]
 [0.55  0.217 0.1   0.133]
 [0.213 0.028 0.728 0.031]
 [0.077 0.096 0.51  0.317]]
Validation acc: 0.823489010989011
Validation class_accuracies: [0.8729372937293729, 0.21666666666666667, 0.7283950617283951, 0.3173076923076923]
Validation sensitivity: 0.5778688524590164
Validation specificity: 0.8729372937293729
Validation icbhi_score: 0.7254030730941947
Validation roc_auc: None
Validation avg_accuracy: 0.5338266786080317
Validation one_indexed_epoch: 17
Validation cm: [[284 958 138 194]
 [102 703   9  46]
 [ 52 202  45 105]
 [ 40 123  20  59]]
Validation val_loss: 0.96920591931871
Validation normalized_cm: [[0.18  0.609 0.088 0.123]
 [0.119 0.817 0.01  0.053]
 [0.129 0.5   0.111 0.26 ]
 [0.165 0.508 0.083 0.244]]
Validation acc: 0.3542207792207792
Validation class_accuracies: [0.18043202033036848, 0.8174418604651162, 0.11138613861386139, 0.24380165289256198]
Validation sensitivity: 0.5358565737051793
Validation specificity: 0.18043202033036848
Validation icbhi_score: 0.35814429701777384
Validation roc_auc: None
Validation avg_accuracy: 0.33826541807547705
Validation one_indexed_epoch: 17
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 16 epochs
-----------------------------
257/257 - 458s - loss: 0.2746 - accuracy: 0.5331 - 458s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 18/100
Validation cm: [[2098   70  214   42]
 [  32   14    6    8]
 [  73    8  233   10]
 [   8   10   55   31]]
Validation val_loss: 0.3090843023538772
Validation normalized_cm: [[0.866 0.029 0.088 0.017]
 [0.533 0.233 0.1   0.133]
 [0.225 0.025 0.719 0.031]
 [0.077 0.096 0.529 0.298]]
Validation acc: 0.8159340659340659
Validation class_accuracies: [0.8655115511551155, 0.23333333333333334, 0.7191358024691358, 0.2980769230769231]
Validation sensitivity: 0.569672131147541
Validation specificity: 0.8655115511551155
Validation icbhi_score: 0.7175918411513282
Validation roc_auc: None
Validation avg_accuracy: 0.5290144025086269
Validation one_indexed_epoch: 18
Validation cm: [[ 283 1016   97  178]
 [  92  730    7   31]
 [  43  230   38   93]
 [  40  139   17   46]]
Validation val_loss: 1.00369570141459
Validation normalized_cm: [[0.18  0.645 0.062 0.113]
 [0.107 0.849 0.008 0.036]
 [0.106 0.569 0.094 0.23 ]
 [0.165 0.574 0.07  0.19 ]]
Validation acc: 0.3561688311688312
Validation class_accuracies: [0.1797966963151207, 0.8488372093023255, 0.09405940594059406, 0.19008264462809918]
Validation sensitivity: 0.5405046480743692
Validation specificity: 0.1797966963151207
Validation icbhi_score: 0.36015067219474495
Validation roc_auc: None
Validation avg_accuracy: 0.3281939890465349
Validation one_indexed_epoch: 18
-----------------------------
The validation tracker metric at 0.7254030730941947 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 17 epochs
-----------------------------
257/257 - 459s - loss: 0.2712 - accuracy: 0.5408 - 459s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 19/100
Validation cm: [[2091   62  223   48]
 [  32   13    8    7]
 [  65    8  242    9]
 [   8    9   52   35]]
Validation val_loss: 0.30897630843920415
Validation normalized_cm: [[0.863 0.026 0.092 0.02 ]
 [0.533 0.217 0.133 0.117]
 [0.201 0.025 0.747 0.028]
 [0.077 0.087 0.5   0.337]]
Validation acc: 0.8176510989010989
Validation class_accuracies: [0.8626237623762376, 0.21666666666666667, 0.7469135802469136, 0.33653846153846156]
Validation sensitivity: 0.5942622950819673
Validation specificity: 0.8626237623762376
Validation icbhi_score: 0.7284430287291024
Validation roc_auc: None
Validation avg_accuracy: 0.5406856177070698
Validation one_indexed_epoch: 19
Validation cm: [[ 254 1012  134  174]
 [  92  725    7   36]
 [  39  226   44   95]
 [  38  135   17   52]]
Validation val_loss: 1.0266881861710635
Validation normalized_cm: [[0.161 0.643 0.085 0.111]
 [0.107 0.843 0.008 0.042]
 [0.097 0.559 0.109 0.235]
 [0.157 0.558 0.07  0.215]]
Validation acc: 0.349025974025974
Validation class_accuracies: [0.1613722998729352, 0.8430232558139535, 0.10891089108910891, 0.21487603305785125]
Validation sensitivity: 0.5451527224435591
Validation specificity: 0.1613722998729352
Validation icbhi_score: 0.35326251115824714
Validation roc_auc: None
Validation avg_accuracy: 0.3320456199584622
Validation one_indexed_epoch: 19
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 1.9531249563442543e-05
-----------------------------
257/257 - 459s - loss: 0.2713 - accuracy: 0.5400 - 459s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 20/100
Validation cm: [[2136   84  164   40]
 [  34   13    6    7]
 [  83    8  223   10]
 [  10   10   56   28]]
Validation val_loss: 0.2974002488098959
Validation normalized_cm: [[0.881 0.035 0.068 0.017]
 [0.567 0.217 0.1   0.117]
 [0.256 0.025 0.688 0.031]
 [0.096 0.096 0.538 0.269]]
Validation acc: 0.8241758241758241
Validation class_accuracies: [0.8811881188118812, 0.21666666666666667, 0.6882716049382716, 0.2692307692307692]
Validation sensitivity: 0.5409836065573771
Validation specificity: 0.8811881188118812
Validation icbhi_score: 0.7110858626846291
Validation roc_auc: None
Validation avg_accuracy: 0.5138392899118972
Validation one_indexed_epoch: 20
Validation cm: [[ 285 1007  109  173]
 [  87  727    6   40]
 [  50  231   34   89]
 [  39  139   14   50]]
Validation val_loss: 0.9986101442030646
Validation normalized_cm: [[0.181 0.64  0.069 0.11 ]
 [0.101 0.845 0.007 0.047]
 [0.124 0.572 0.084 0.22 ]
 [0.161 0.574 0.058 0.207]]
Validation acc: 0.35584415584415585
Validation class_accuracies: [0.18106734434561628, 0.8453488372093023, 0.08415841584158416, 0.2066115702479339]
Validation sensitivity: 0.5385126162018592
Validation specificity: 0.18106734434561628
Validation icbhi_score: 0.35978998027373776
Validation roc_auc: None
Validation avg_accuracy: 0.3292965419111092
Validation one_indexed_epoch: 20
-----------------------------
The validation tracker metric at 0.7284430287291024 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 19 epochs
-----------------------------
257/257 - 458s - loss: 0.2650 - accuracy: 0.5404 - 458s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 21/100
Validation cm: [[2102   63  211   48]
 [  32   14    6    8]
 [  68    7  238   11]
 [   8   10   50   36]]
Validation val_loss: 0.3060932577733023
Validation normalized_cm: [[0.867 0.026 0.087 0.02 ]
 [0.533 0.233 0.1   0.133]
 [0.21  0.022 0.735 0.034]
 [0.077 0.096 0.481 0.346]]
Validation acc: 0.8207417582417582
Validation class_accuracies: [0.8671617161716172, 0.23333333333333334, 0.7345679012345679, 0.34615384615384615]
Validation sensitivity: 0.5901639344262295
Validation specificity: 0.8671617161716172
Validation icbhi_score: 0.7286628252989233
Validation roc_auc: None
Validation avg_accuracy: 0.5453041992233412
Validation one_indexed_epoch: 21
Validation cm: [[278 971 124 201]
 [ 93 720   6  41]
 [ 45 214  43 102]
 [ 39 130  18  55]]
Validation val_loss: 1.0084732172542021
Validation normalized_cm: [[0.177 0.617 0.079 0.128]
 [0.108 0.837 0.007 0.048]
 [0.111 0.53  0.106 0.252]
 [0.161 0.537 0.074 0.227]]
Validation acc: 0.35584415584415585
Validation class_accuracies: [0.17662007623888182, 0.8372093023255814, 0.10643564356435643, 0.22727272727272727]
Validation sensitivity: 0.5431606905710491
Validation specificity: 0.17662007623888182
Validation icbhi_score: 0.3598903834049655
Validation roc_auc: None
Validation avg_accuracy: 0.33688443735038676
Validation one_indexed_epoch: 21
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 20 epochs
-----------------------------
257/257 - 460s - loss: 0.2635 - accuracy: 0.5415 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 22/100
Validation cm: [[2119   75  187   43]
 [  33   12    6    9]
 [  75    7  232   10]
 [  10   10   51   33]]
Validation val_loss: 0.3017111479207665
Validation normalized_cm: [[0.874 0.031 0.077 0.018]
 [0.55  0.2   0.1   0.15 ]
 [0.231 0.022 0.716 0.031]
 [0.096 0.096 0.49  0.317]]
Validation acc: 0.8228021978021978
Validation class_accuracies: [0.8741749174917491, 0.2, 0.7160493827160493, 0.3173076923076923]
Validation sensitivity: 0.5676229508196722
Validation specificity: 0.8741749174917491
Validation icbhi_score: 0.7208989341557106
Validation roc_auc: None
Validation avg_accuracy: 0.5268829981288727
Validation one_indexed_epoch: 22
Validation cm: [[282 976 130 186]
 [ 96 718   7  39]
 [ 50 215  43  96]
 [ 39 128  18  57]]
Validation val_loss: 0.995341907248274
Validation normalized_cm: [[0.179 0.62  0.083 0.118]
 [0.112 0.835 0.008 0.045]
 [0.124 0.532 0.106 0.238]
 [0.161 0.529 0.074 0.236]]
Validation acc: 0.35714285714285715
Validation class_accuracies: [0.17916137229987295, 0.8348837209302326, 0.10643564356435643, 0.23553719008264462]
Validation sensitivity: 0.5431606905710491
Validation specificity: 0.17916137229987295
Validation icbhi_score: 0.361161031435461
Validation roc_auc: None
Validation avg_accuracy: 0.33900448171927666
Validation one_indexed_epoch: 22
-----------------------------
The validation tracker metric at 0.7286628252989233 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The number of epochs since last 1% equals the patience
-----------------------------
257/257 - 461s - loss: 0.2654 - accuracy: 0.5406 - 461s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.7286628252989233
Best cm: [[2102   63  211   48]
 [  32   14    6    8]
 [  68    7  238   11]
 [   8   10   50   36]]
Best val_loss: 0.3060932577733023
Best normalized_cm: [[0.867 0.026 0.087 0.02 ]
 [0.533 0.233 0.1   0.133]
 [0.21  0.022 0.735 0.034]
 [0.077 0.096 0.481 0.346]]
Best acc: 0.8207417582417582
Best class_accuracies: [0.8671617161716172, 0.23333333333333334, 0.7345679012345679, 0.34615384615384615]
Best sensitivity: 0.5901639344262295
Best specificity: 0.8671617161716172
Best roc_auc: None
Best avg_accuracy: 0.5453041992233412
Best one_indexed_epoch: 21
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5
Best cm: [[1574    0    0    0]
 [ 860    0    0    0]
 [ 404    0    0    0]
 [ 242    0    0    0]]
Best val_loss: 0.6448433879908029
Best normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Best acc: 0.5110389610389611
Best class_accuracies: [1.0, 0.0, 0.0, 0.0]
Best sensitivity: 0.0
Best specificity: 1.0
Best roc_auc: None
Best avg_accuracy: 0.25
Best one_indexed_epoch: 1
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6538806557655334, 0.5557902455329895, 0.5283873081207275, 0.5048055052757263, 0.48419928550720215, 0.4677373468875885, 0.449883371591568, 0.39836838841438293, 0.3726094663143158, 0.3577585816383362, 0.34798797965049744, 0.33781668543815613, 0.33076179027557373, 0.2914820611476898, 0.27813127636909485, 0.2748262584209442, 0.2745542824268341, 0.27119550108909607, 0.2713412642478943, 0.26502883434295654, 0.2635255753993988, 0.26537397503852844], 'accuracy': [0.4599171578884125, 0.4365253448486328, 0.43220028281211853, 0.4574805200099945, 0.452850878238678, 0.4644249379634857, 0.4731968939304352, 0.48160332441329956, 0.5090156197547913, 0.5038377046585083, 0.5199195742607117, 0.5193713307380676, 0.5160209536552429, 0.5310672521591187, 0.5366106033325195, 0.5389254093170166, 0.5331383943557739, 0.5407529473304749, 0.539961040019989, 0.5404483675956726, 0.5415448546409607, 0.540631115436554]}
End
####################################
Job id is 3.
len of icbhi
7857
len of train icbhi
4769
len of val icbhi
3080
before icbhi addition
11704
after icbhi addition
16473
-----------------------
--- Final training dataset went from 0 to 16473 elements, with 11825 none's, 1673 crakles, 1938 wheezes and 1037 both ---
--- Final Validation dataset contains 2855 elements, with 2325 none, 24 crackles, 482 wheezes and 24 both ---
Initializing weights...
weights = {0: 0.3482663847780127, 1: 2.461595935445308, 2: 2.125, 3: 3.971311475409836}
Model: "leaf_model9_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_5 (Sequential)                       (None, 80, 200, 1)                          4                
                                                                                                              
 sequential_6 (Sequential)                       (None, 80, 200, 16)                         2352             
                                                                                                              
 sequential_7 (Sequential)                       (None, 80, 200, 16)                         6448             
                                                                                                              
 sequential_8 (Sequential)                       (None, 80, 200, 16)                         32               
                                                                                                              
 concatenate_1 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_9 (Sequential)                       (None, 2)                                   6192322          
                                                                                                              
==============================================================================================================
Total params: 6,201,318
Trainable params: 6,159,812
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Target metric is icbhi_score
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 1/100
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[   0    0 2325    0]
 [   0    0   24    0]
 [   0    0  482    0]
 [   0    0   24    0]]
Validation val_loss: 0.5858577735996079
Validation normalized_cm: [[0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]]
Validation acc: 0.16882661996497372
Validation class_accuracies: [0.0, 0.0, 1.0, 0.0]
Validation sensitivity: 0.909433962264151
Validation specificity: 0.0
Validation icbhi_score: 0.4547169811320755
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Validation cm: [[   0    0 1574    0]
 [   0    0  860    0]
 [   0    0  404    0]
 [   0    0  242    0]]
Validation val_loss: 0.6783822184259242
Validation normalized_cm: [[0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]]
Validation acc: 0.13116883116883116
Validation class_accuracies: [0.0, 0.0, 1.0, 0.0]
Validation sensitivity: 0.2682602921646746
Validation specificity: 0.0
Validation icbhi_score: 0.1341301460823373
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 478s - loss: 0.6507 - accuracy: 0.4811 - 478s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 2/100
Validation cm: [[2251    0   74    0]
 [  24    0    0    0]
 [ 198    0  284    0]
 [  24    0    0    0]]
Validation val_loss: 0.4611773097890897
Validation normalized_cm: [[0.968 0.    0.032 0.   ]
 [1.    0.    0.    0.   ]
 [0.411 0.    0.589 0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.8879159369527145
Validation class_accuracies: [0.9681720430107527, 0.0, 0.5892116182572614, 0.0]
Validation sensitivity: 0.5358490566037736
Validation specificity: 0.9681720430107527
Validation icbhi_score: 0.7520105498072631
Validation roc_auc: None
Validation avg_accuracy: 0.3893459153170035
Validation one_indexed_epoch: 2
Validation cm: [[1558    0   16    0]
 [ 847    0   13    0]
 [ 402    0    2    0]
 [ 237    0    5    0]]
Validation val_loss: 0.6463024694907975
Validation normalized_cm: [[0.99  0.    0.01  0.   ]
 [0.985 0.    0.015 0.   ]
 [0.995 0.    0.005 0.   ]
 [0.979 0.    0.021 0.   ]]
Validation acc: 0.5064935064935064
Validation class_accuracies: [0.9898348157560356, 0.0, 0.0049504950495049506, 0.0]
Validation sensitivity: 0.0013280212483399733
Validation specificity: 0.9898348157560356
Validation icbhi_score: 0.4955814185021878
Validation roc_auc: None
Validation avg_accuracy: 0.24869632770138514
Validation one_indexed_epoch: 2
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
258/258 - 458s - loss: 0.5538 - accuracy: 0.4456 - 458s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 3/100
Validation cm: [[2207    3   93   22]
 [  24    0    0    0]
 [ 184    0  253   45]
 [  21    0    2    1]]
Validation val_loss: 0.3241146398530849
Validation normalized_cm: [[0.949 0.001 0.04  0.009]
 [1.    0.    0.    0.   ]
 [0.382 0.    0.525 0.093]
 [0.875 0.    0.083 0.042]]
Validation acc: 0.8619964973730297
Validation class_accuracies: [0.949247311827957, 0.0, 0.524896265560166, 0.041666666666666664]
Validation sensitivity: 0.47924528301886793
Validation specificity: 0.949247311827957
Validation icbhi_score: 0.7142462974234125
Validation roc_auc: None
Validation avg_accuracy: 0.3789525610136974
Validation one_indexed_epoch: 3
Validation cm: [[1388   16  151   19]
 [ 801    4   54    1]
 [ 335    8   58    3]
 [ 198    1   35    8]]
Validation val_loss: 0.6212264344241325
Validation normalized_cm: [[0.882 0.01  0.096 0.012]
 [0.931 0.005 0.063 0.001]
 [0.829 0.02  0.144 0.007]
 [0.818 0.004 0.145 0.033]]
Validation acc: 0.4733766233766234
Validation class_accuracies: [0.8818297331639136, 0.004651162790697674, 0.14356435643564355, 0.03305785123966942]
Validation sensitivity: 0.04648074369189907
Validation specificity: 0.8818297331639136
Validation icbhi_score: 0.4641552384279063
Validation roc_auc: None
Validation avg_accuracy: 0.265775775907481
Validation one_indexed_epoch: 3
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 1 epochs
-----------------------------
258/258 - 461s - loss: 0.5244 - accuracy: 0.4505 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 4/100
Validation cm: [[1902   50  277   96]
 [  19    0    5    0]
 [ 146    4  263   69]
 [  15    0    6    3]]
Validation val_loss: 0.4108676533604566
Validation normalized_cm: [[0.818 0.022 0.119 0.041]
 [0.792 0.    0.208 0.   ]
 [0.303 0.008 0.546 0.143]
 [0.625 0.    0.25  0.125]]
Validation acc: 0.759369527145359
Validation class_accuracies: [0.8180645161290323, 0.0, 0.5456431535269709, 0.125]
Validation sensitivity: 0.5018867924528302
Validation specificity: 0.8180645161290323
Validation icbhi_score: 0.6599756542909312
Validation roc_auc: None
Validation avg_accuracy: 0.37217691741400083
Validation one_indexed_epoch: 4
Validation cm: [[ 175 1210   76  113]
 [  47  702   53   58]
 [  41  276   31   56]
 [  25  191   12   14]]
Validation val_loss: 0.7509558754017601
Validation normalized_cm: [[0.111 0.769 0.048 0.072]
 [0.055 0.816 0.062 0.067]
 [0.101 0.683 0.077 0.139]
 [0.103 0.789 0.05  0.058]]
Validation acc: 0.29935064935064937
Validation class_accuracies: [0.11118170266836086, 0.8162790697674419, 0.07673267326732673, 0.05785123966942149]
Validation sensitivity: 0.4960159362549801
Validation specificity: 0.11118170266836086
Validation icbhi_score: 0.30359881946167044
Validation roc_auc: None
Validation avg_accuracy: 0.2655111713431378
Validation one_indexed_epoch: 4
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 2 epochs
-----------------------------
258/258 - 460s - loss: 0.5001 - accuracy: 0.4584 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 5/100
Validation cm: [[1784   67  223  251]
 [  18    0    6    0]
 [ 119    4  224  135]
 [   6    0    6   12]]
Validation val_loss: 0.4816019673096163
Validation normalized_cm: [[0.767 0.029 0.096 0.108]
 [0.75  0.    0.25  0.   ]
 [0.247 0.008 0.465 0.28 ]
 [0.25  0.    0.25  0.5  ]]
Validation acc: 0.7075306479859895
Validation class_accuracies: [0.7673118279569893, 0.0, 0.46473029045643155, 0.5]
Validation sensitivity: 0.44528301886792454
Validation specificity: 0.7673118279569893
Validation icbhi_score: 0.606297423412457
Validation roc_auc: None
Validation avg_accuracy: 0.4330105296033552
Validation one_indexed_epoch: 5
Validation cm: [[ 148 1161   38  227]
 [  25  800    7   28]
 [  30  290   12   72]
 [   5  166   16   55]]
Validation val_loss: 0.8187054306419881
Validation normalized_cm: [[0.094 0.738 0.024 0.144]
 [0.029 0.93  0.008 0.033]
 [0.074 0.718 0.03  0.178]
 [0.021 0.686 0.066 0.227]]
Validation acc: 0.32954545454545453
Validation class_accuracies: [0.0940279542566709, 0.9302325581395349, 0.0297029702970297, 0.22727272727272727]
Validation sensitivity: 0.5756972111553785
Validation specificity: 0.0940279542566709
Validation icbhi_score: 0.3348625827060247
Validation roc_auc: None
Validation avg_accuracy: 0.3203090524914907
Validation one_indexed_epoch: 5
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 3 epochs
-----------------------------
258/258 - 460s - loss: 0.4823 - accuracy: 0.4896 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 6/100
Validation cm: [[2073   70  104   78]
 [  24    0    0    0]
 [ 188   12  139  143]
 [  21    1    0    2]]
Validation val_loss: 0.38876636799825715
Validation normalized_cm: [[0.892 0.03  0.045 0.034]
 [1.    0.    0.    0.   ]
 [0.39  0.025 0.288 0.297]
 [0.875 0.042 0.    0.083]]
Validation acc: 0.7754816112084063
Validation class_accuracies: [0.8916129032258064, 0.0, 0.2883817427385892, 0.08333333333333333]
Validation sensitivity: 0.2660377358490566
Validation specificity: 0.8916129032258064
Validation icbhi_score: 0.5788253195374315
Validation roc_auc: None
Validation avg_accuracy: 0.3158319948244322
Validation one_indexed_epoch: 6
Validation cm: [[  20 1330   38  186]
 [   9  809   18   24]
 [   7  324    6   67]
 [  29  172    7   34]]
Validation val_loss: 0.8660072365945036
Validation normalized_cm: [[0.013 0.845 0.024 0.118]
 [0.01  0.941 0.021 0.028]
 [0.017 0.802 0.015 0.166]
 [0.12  0.711 0.029 0.14 ]]
Validation acc: 0.28214285714285714
Validation class_accuracies: [0.012706480304955527, 0.9406976744186046, 0.01485148514851485, 0.14049586776859505]
Validation sensitivity: 0.5637450199203188
Validation specificity: 0.012706480304955527
Validation icbhi_score: 0.2882257501126372
Validation roc_auc: None
Validation avg_accuracy: 0.27718787691016755
Validation one_indexed_epoch: 6
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 4 epochs
-----------------------------
258/258 - 463s - loss: 0.4644 - accuracy: 0.5163 - 463s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 7/100
Validation cm: [[2066   48  173   38]
 [  24    0    0    0]
 [ 151   93  174   64]
 [  18    0    3    3]]
Validation val_loss: 0.3732993977736835
Validation normalized_cm: [[0.889 0.021 0.074 0.016]
 [1.    0.    0.    0.   ]
 [0.313 0.193 0.361 0.133]
 [0.75  0.    0.125 0.125]]
Validation acc: 0.7856392294220665
Validation class_accuracies: [0.8886021505376344, 0.0, 0.36099585062240663, 0.125]
Validation sensitivity: 0.3339622641509434
Validation specificity: 0.8886021505376344
Validation icbhi_score: 0.6112822073442888
Validation roc_auc: None
Validation avg_accuracy: 0.34364950029001023
Validation one_indexed_epoch: 7
Validation cm: [[339 961  68 206]
 [ 76 718  20  46]
 [ 66 245  19  74]
 [ 35 159   5  43]]
Validation val_loss: 0.7765788766440963
Validation normalized_cm: [[0.215 0.611 0.043 0.131]
 [0.088 0.835 0.023 0.053]
 [0.163 0.606 0.047 0.183]
 [0.145 0.657 0.021 0.178]]
Validation acc: 0.3633116883116883
Validation class_accuracies: [0.2153748411689962, 0.8348837209302326, 0.04702970297029703, 0.17768595041322313]
Validation sensitivity: 0.5179282868525896
Validation specificity: 0.2153748411689962
Validation icbhi_score: 0.3666515640107929
Validation roc_auc: None
Validation avg_accuracy: 0.31874355387068726
Validation one_indexed_epoch: 7
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 5 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 5 epochs
-----------------------------
258/258 - 455s - loss: 0.4543 - accuracy: 0.5183 - 455s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 8/100
Validation cm: [[1472   86  612  155]
 [  11    0   13    0]
 [  76    9  207  190]
 [   1    0   14    9]]
Validation val_loss: 0.5950922708110448
Validation normalized_cm: [[0.633 0.037 0.263 0.067]
 [0.458 0.    0.542 0.   ]
 [0.158 0.019 0.429 0.394]
 [0.042 0.    0.583 0.375]]
Validation acc: 0.5912434325744308
Validation class_accuracies: [0.6331182795698925, 0.0, 0.42946058091286304, 0.375]
Validation sensitivity: 0.4075471698113208
Validation specificity: 0.6331182795698925
Validation icbhi_score: 0.5203327246906067
Validation roc_auc: None
Validation avg_accuracy: 0.3593947151206889
Validation one_indexed_epoch: 8
Validation cm: [[180 418 473 503]
 [ 47 353 199 261]
 [ 19  46 147 192]
 [ 33  60  45 104]]
Validation val_loss: 0.9166509538365818
Validation normalized_cm: [[0.114 0.266 0.301 0.32 ]
 [0.055 0.41  0.231 0.303]
 [0.047 0.114 0.364 0.475]
 [0.136 0.248 0.186 0.43 ]]
Validation acc: 0.2545454545454545
Validation class_accuracies: [0.11435832274459974, 0.4104651162790698, 0.36386138613861385, 0.4297520661157025]
Validation sensitivity: 0.40106241699867196
Validation specificity: 0.11435832274459974
Validation icbhi_score: 0.25771036987163587
Validation roc_auc: None
Validation avg_accuracy: 0.32960922281949645
Validation one_indexed_epoch: 8
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0012499999720603228
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0003124999930150807
-----------------------------
258/258 - 455s - loss: 0.4289 - accuracy: 0.5424 - 455s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 9/100
Validation cm: [[1973  163  129   60]
 [  20    3    1    0]
 [ 131   22  267   62]
 [  16    1    2    5]]
Validation val_loss: 0.3381013104321589
Validation normalized_cm: [[0.849 0.07  0.055 0.026]
 [0.833 0.125 0.042 0.   ]
 [0.272 0.046 0.554 0.129]
 [0.667 0.042 0.083 0.208]]
Validation acc: 0.7873905429071804
Validation class_accuracies: [0.8486021505376344, 0.125, 0.553941908713693, 0.20833333333333334]
Validation sensitivity: 0.5188679245283019
Validation specificity: 0.8486021505376344
Validation icbhi_score: 0.6837350375329682
Validation roc_auc: None
Validation avg_accuracy: 0.43396934814616517
Validation one_indexed_epoch: 9
Validation cm: [[ 197 1084  150  143]
 [  30  756   22   52]
 [  29  241   51   83]
 [  12  171   11   48]]
Validation val_loss: 0.8641570085502387
Validation normalized_cm: [[0.125 0.689 0.095 0.091]
 [0.035 0.879 0.026 0.06 ]
 [0.072 0.597 0.126 0.205]
 [0.05  0.707 0.045 0.198]]
Validation acc: 0.34155844155844156
Validation class_accuracies: [0.12515883100381195, 0.8790697674418605, 0.12623762376237624, 0.19834710743801653]
Validation sensitivity: 0.5677290836653387
Validation specificity: 0.12515883100381195
Validation icbhi_score: 0.34644395733457534
Validation roc_auc: None
Validation avg_accuracy: 0.3322033324115163
Validation one_indexed_epoch: 9
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 7 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 7 epochs
-----------------------------
258/258 - 456s - loss: 0.4141 - accuracy: 0.5349 - 456s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 10/100
Validation cm: [[1991  215   76   43]
 [  21    2    1    0]
 [ 146   50  257   29]
 [  10   10    1    3]]
Validation val_loss: 0.3340371016601919
Validation normalized_cm: [[0.856 0.092 0.033 0.018]
 [0.875 0.083 0.042 0.   ]
 [0.303 0.104 0.533 0.06 ]
 [0.417 0.417 0.042 0.125]]
Validation acc: 0.7891418563922942
Validation class_accuracies: [0.8563440860215054, 0.08333333333333333, 0.533195020746888, 0.125]
Validation sensitivity: 0.49433962264150944
Validation specificity: 0.8563440860215054
Validation icbhi_score: 0.6753418543315074
Validation roc_auc: None
Validation avg_accuracy: 0.3994681100254317
Validation one_indexed_epoch: 10
Validation cm: [[ 184 1156   90  144]
 [  36  792    8   24]
 [  36  283   28   57]
 [  21  183    6   32]]
Validation val_loss: 0.9137280211554138
Validation normalized_cm: [[0.117 0.734 0.057 0.091]
 [0.042 0.921 0.009 0.028]
 [0.089 0.7   0.069 0.141]
 [0.087 0.756 0.025 0.132]]
Validation acc: 0.33636363636363636
Validation class_accuracies: [0.11689961880559085, 0.9209302325581395, 0.06930693069306931, 0.1322314049586777]
Validation sensitivity: 0.5657370517928287
Validation specificity: 0.11689961880559085
Validation icbhi_score: 0.3413183352992098
Validation roc_auc: None
Validation avg_accuracy: 0.3098420467538694
Validation one_indexed_epoch: 10
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 8 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 8 epochs
-----------------------------
258/258 - 461s - loss: 0.3680 - accuracy: 0.5433 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 11/100
Validation cm: [[1930  293   64   38]
 [  20    4    0    0]
 [ 143   77  219   43]
 [   9   11    0    4]]
Validation val_loss: 0.37083786802554763
Validation normalized_cm: [[0.83  0.126 0.028 0.016]
 [0.833 0.167 0.    0.   ]
 [0.297 0.16  0.454 0.089]
 [0.375 0.458 0.    0.167]]
Validation acc: 0.7555166374781086
Validation class_accuracies: [0.8301075268817204, 0.16666666666666666, 0.45435684647302904, 0.16666666666666666]
Validation sensitivity: 0.42830188679245285
Validation specificity: 0.8301075268817204
Validation icbhi_score: 0.6292047068370866
Validation roc_auc: None
Validation avg_accuracy: 0.4044494266720207
Validation one_indexed_epoch: 11
Validation cm: [[ 153 1193   80  148]
 [  32  802    7   19]
 [  34  294   25   51]
 [  19  193    5   25]]
Validation val_loss: 0.9730090243669299
Validation normalized_cm: [[0.097 0.758 0.051 0.094]
 [0.037 0.933 0.008 0.022]
 [0.084 0.728 0.062 0.126]
 [0.079 0.798 0.021 0.103]]
Validation acc: 0.3262987012987013
Validation class_accuracies: [0.09720457433290978, 0.9325581395348838, 0.06188118811881188, 0.10330578512396695]
Validation sensitivity: 0.5657370517928287
Validation specificity: 0.09720457433290978
Validation icbhi_score: 0.33147081306286924
Validation roc_auc: None
Validation avg_accuracy: 0.2987374217776431
Validation one_indexed_epoch: 11
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 9 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 9 epochs
-----------------------------
258/258 - 461s - loss: 0.3568 - accuracy: 0.5586 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 12/100
Validation cm: [[2052  141   98   34]
 [  20    3    1    0]
 [ 168   30  258   26]
 [  15    4    2    3]]
Validation val_loss: 0.30044050423225355
Validation normalized_cm: [[0.883 0.061 0.042 0.015]
 [0.833 0.125 0.042 0.   ]
 [0.349 0.062 0.535 0.054]
 [0.625 0.167 0.083 0.125]]
Validation acc: 0.8112084063047286
Validation class_accuracies: [0.8825806451612903, 0.125, 0.5352697095435685, 0.125]
Validation sensitivity: 0.4981132075471698
Validation specificity: 0.8825806451612903
Validation icbhi_score: 0.6903469263542301
Validation roc_auc: None
Validation avg_accuracy: 0.4169625886762147
Validation one_indexed_epoch: 12
Validation cm: [[ 176 1155   84  159]
 [  37  794    6   23]
 [  33  284   23   64]
 [  23  180    8   31]]
Validation val_loss: 0.9887816335447284
Validation normalized_cm: [[0.112 0.734 0.053 0.101]
 [0.043 0.923 0.007 0.027]
 [0.082 0.703 0.057 0.158]
 [0.095 0.744 0.033 0.128]]
Validation acc: 0.33246753246753247
Validation class_accuracies: [0.11181702668360864, 0.9232558139534883, 0.05693069306930693, 0.128099173553719]
Validation sensitivity: 0.5630810092961488
Validation specificity: 0.11181702668360864
Validation icbhi_score: 0.3374490179898787
Validation roc_auc: None
Validation avg_accuracy: 0.30502567681503073
Validation one_indexed_epoch: 12
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 10 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 10 epochs
-----------------------------
258/258 - 469s - loss: 0.3441 - accuracy: 0.5643 - 469s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 13/100
Validation cm: [[1958  101  217   49]
 [  18    3    3    0]
 [ 143   26  263   50]
 [  10    2    8    4]]
Validation val_loss: 0.3247405348206999
Validation normalized_cm: [[0.842 0.043 0.093 0.021]
 [0.75  0.125 0.125 0.   ]
 [0.297 0.054 0.546 0.104]
 [0.417 0.083 0.333 0.167]]
Validation acc: 0.7803852889667251
Validation class_accuracies: [0.8421505376344086, 0.125, 0.5456431535269709, 0.16666666666666666]
Validation sensitivity: 0.5094339622641509
Validation specificity: 0.8421505376344086
Validation icbhi_score: 0.6757922499492798
Validation roc_auc: None
Validation avg_accuracy: 0.41986508945701156
Validation one_indexed_epoch: 13
Validation cm: [[ 199 1078  118  179]
 [  43  771   18   28]
 [  31  244   37   92]
 [  20  161    9   52]]
Validation val_loss: 0.9855472116759078
Validation normalized_cm: [[0.126 0.685 0.075 0.114]
 [0.05  0.897 0.021 0.033]
 [0.077 0.604 0.092 0.228]
 [0.083 0.665 0.037 0.215]]
Validation acc: 0.3438311688311688
Validation class_accuracies: [0.12642947903430748, 0.8965116279069767, 0.09158415841584158, 0.21487603305785125]
Validation sensitivity: 0.5710491367861886
Validation specificity: 0.12642947903430748
Validation icbhi_score: 0.34873930791024804
Validation roc_auc: None
Validation avg_accuracy: 0.33235032460374425
Validation one_indexed_epoch: 13
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 11 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 11 epochs
-----------------------------
258/258 - 461s - loss: 0.3368 - accuracy: 0.5711 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 14/100
Validation cm: [[2039  142  113   31]
 [  19    3    1    1]
 [ 161   22  272   27]
 [  15    2    3    4]]
Validation val_loss: 0.3040384528591484
Validation normalized_cm: [[0.877 0.061 0.049 0.013]
 [0.792 0.125 0.042 0.042]
 [0.334 0.046 0.564 0.056]
 [0.625 0.083 0.125 0.167]]
Validation acc: 0.8119089316987741
Validation class_accuracies: [0.8769892473118279, 0.125, 0.5643153526970954, 0.16666666666666666]
Validation sensitivity: 0.5264150943396226
Validation specificity: 0.8769892473118279
Validation icbhi_score: 0.7017021708257253
Validation roc_auc: None
Validation avg_accuracy: 0.4332428166688975
Validation one_indexed_epoch: 14
Validation cm: [[ 198 1111   86  179]
 [  45  778    4   33]
 [  40  263   28   73]
 [  21  173    9   39]]
Validation val_loss: 1.015456826294857
Validation normalized_cm: [[0.126 0.706 0.055 0.114]
 [0.052 0.905 0.005 0.038]
 [0.099 0.651 0.069 0.181]
 [0.087 0.715 0.037 0.161]]
Validation acc: 0.3386363636363636
Validation class_accuracies: [0.12579415501905972, 0.9046511627906977, 0.06930693069306931, 0.16115702479338842]
Validation sensitivity: 0.5610889774236387
Validation specificity: 0.12579415501905972
Validation icbhi_score: 0.34344156622134925
Validation roc_auc: None
Validation avg_accuracy: 0.3152273183240538
Validation one_indexed_epoch: 14
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 7.812499825377017e-05
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 1.9531249563442543e-05
-----------------------------
258/258 - 461s - loss: 0.3283 - accuracy: 0.5708 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 15/100
Validation cm: [[1992  142  148   43]
 [  18    4    1    1]
 [ 154   38  257   33]
 [  14    2    4    4]]
Validation val_loss: 0.32298760958837147
Validation normalized_cm: [[0.857 0.061 0.064 0.018]
 [0.75  0.167 0.042 0.042]
 [0.32  0.079 0.533 0.068]
 [0.583 0.083 0.167 0.167]]
Validation acc: 0.7905429071803853
Validation class_accuracies: [0.8567741935483871, 0.16666666666666666, 0.533195020746888, 0.16666666666666666]
Validation sensitivity: 0.5
Validation specificity: 0.8567741935483871
Validation icbhi_score: 0.6783870967741936
Validation roc_auc: None
Validation avg_accuracy: 0.4308256369071521
Validation one_indexed_epoch: 15
Validation cm: [[ 205 1090   80  199]
 [  39  778    6   37]
 [  37  252   25   90]
 [  21  167    8   46]]
Validation val_loss: 1.009156694478815
Validation normalized_cm: [[0.13  0.693 0.051 0.126]
 [0.045 0.905 0.007 0.043]
 [0.092 0.624 0.062 0.223]
 [0.087 0.69  0.033 0.19 ]]
Validation acc: 0.3422077922077922
Validation class_accuracies: [0.13024142312579415, 0.9046511627906977, 0.06188118811881188, 0.19008264462809918]
Validation sensitivity: 0.5637450199203188
Validation specificity: 0.13024142312579415
Validation icbhi_score: 0.34699322152305645
Validation roc_auc: None
Validation avg_accuracy: 0.32171410466585076
Validation one_indexed_epoch: 15
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 13 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 13 epochs
-----------------------------
258/258 - 459s - loss: 0.3176 - accuracy: 0.5860 - 459s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 16/100
Validation cm: [[1975  143  161   46]
 [  18    4    1    1]
 [ 153   40  255   34]
 [  12    4    4    4]]
Validation val_loss: 0.32870146018428886
Validation normalized_cm: [[0.849 0.062 0.069 0.02 ]
 [0.75  0.167 0.042 0.042]
 [0.317 0.083 0.529 0.071]
 [0.5   0.167 0.167 0.167]]
Validation acc: 0.7838879159369527
Validation class_accuracies: [0.8494623655913979, 0.16666666666666666, 0.529045643153527, 0.16666666666666666]
Validation sensitivity: 0.4962264150943396
Validation specificity: 0.8494623655913979
Validation icbhi_score: 0.6728443903428687
Validation roc_auc: None
Validation avg_accuracy: 0.4279603355195645
Validation one_indexed_epoch: 16
Validation cm: [[ 199 1096   81  198]
 [  39  778    7   36]
 [  35  252   25   92]
 [  20  168    8   46]]
Validation val_loss: 1.021661471025644
Validation normalized_cm: [[0.126 0.696 0.051 0.126]
 [0.045 0.905 0.008 0.042]
 [0.087 0.624 0.062 0.228]
 [0.083 0.694 0.033 0.19 ]]
Validation acc: 0.34025974025974026
Validation class_accuracies: [0.12642947903430748, 0.9046511627906977, 0.06188118811881188, 0.19008264462809918]
Validation sensitivity: 0.5637450199203188
Validation specificity: 0.12642947903430748
Validation icbhi_score: 0.3450872494773131
Validation roc_auc: None
Validation avg_accuracy: 0.32076111864297907
Validation one_indexed_epoch: 16
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 14 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 14 epochs
-----------------------------
258/258 - 459s - loss: 0.3187 - accuracy: 0.5815 - 459s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 17/100
Validation cm: [[1992  142  149   42]
 [  18    4    1    1]
 [ 155   41  258   28]
 [  14    2    4    4]]
Validation val_loss: 0.3237468879717409
Validation normalized_cm: [[0.857 0.061 0.064 0.018]
 [0.75  0.167 0.042 0.042]
 [0.322 0.085 0.535 0.058]
 [0.583 0.083 0.167 0.167]]
Validation acc: 0.7908931698774081
Validation class_accuracies: [0.8567741935483871, 0.16666666666666666, 0.5352697095435685, 0.16666666666666666]
Validation sensitivity: 0.5018867924528302
Validation specificity: 0.8567741935483871
Validation icbhi_score: 0.6793304930006087
Validation roc_auc: None
Validation avg_accuracy: 0.4313443091063222
Validation one_indexed_epoch: 17
Validation cm: [[ 197 1095   87  195]
 [  38  778    8   36]
 [  36  251   26   91]
 [  20  168    8   46]]
Validation val_loss: 1.0122412586482634
Validation normalized_cm: [[0.125 0.696 0.055 0.124]
 [0.044 0.905 0.009 0.042]
 [0.089 0.621 0.064 0.225]
 [0.083 0.694 0.033 0.19 ]]
Validation acc: 0.3399350649350649
Validation class_accuracies: [0.12515883100381195, 0.9046511627906977, 0.06435643564356436, 0.19008264462809918]
Validation sensitivity: 0.5644090305444888
Validation specificity: 0.12515883100381195
Validation icbhi_score: 0.34478393077415037
Validation roc_auc: None
Validation avg_accuracy: 0.3210622685165433
Validation one_indexed_epoch: 17
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 15 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 15 epochs
-----------------------------
258/258 - 461s - loss: 0.3169 - accuracy: 0.5794 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 18/100
Validation cm: [[1993  142  146   44]
 [  18    4    1    1]
 [ 154   41  257   30]
 [  12    4    4    4]]
Validation val_loss: 0.3249453908804398
Validation normalized_cm: [[0.857 0.061 0.063 0.019]
 [0.75  0.167 0.042 0.042]
 [0.32  0.085 0.533 0.062]
 [0.5   0.167 0.167 0.167]]
Validation acc: 0.7908931698774081
Validation class_accuracies: [0.8572043010752688, 0.16666666666666666, 0.533195020746888, 0.16666666666666666]
Validation sensitivity: 0.5
Validation specificity: 0.8572043010752688
Validation icbhi_score: 0.6786021505376344
Validation roc_auc: None
Validation avg_accuracy: 0.43093316378887253
Validation one_indexed_epoch: 18
Validation cm: [[ 194 1097   88  195]
 [  37  780    8   35]
 [  36  250   27   91]
 [  18  170    8   46]]
Validation val_loss: 1.0157433687168393
Validation normalized_cm: [[0.123 0.697 0.056 0.124]
 [0.043 0.907 0.009 0.041]
 [0.089 0.619 0.067 0.225]
 [0.074 0.702 0.033 0.19 ]]
Validation acc: 0.3399350649350649
Validation class_accuracies: [0.12325285895806862, 0.9069767441860465, 0.06683168316831684, 0.19008264462809918]
Validation sensitivity: 0.5664010624169987
Validation specificity: 0.12325285895806862
Validation icbhi_score: 0.34482696068753366
Validation roc_auc: None
Validation avg_accuracy: 0.3217859827351328
Validation one_indexed_epoch: 18
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 16 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 16 epochs
-----------------------------
258/258 - 461s - loss: 0.3196 - accuracy: 0.5788 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 19/100
Validation cm: [[1983  142  155   45]
 [  18    4    1    1]
 [ 153   41  253   35]
 [  12    4    4    4]]
Validation val_loss: 0.3292872976582667
Validation normalized_cm: [[0.853 0.061 0.067 0.019]
 [0.75  0.167 0.042 0.042]
 [0.317 0.085 0.525 0.073]
 [0.5   0.167 0.167 0.167]]
Validation acc: 0.7859894921190893
Validation class_accuracies: [0.8529032258064516, 0.16666666666666666, 0.524896265560166, 0.16666666666666666]
Validation sensitivity: 0.49245283018867925
Validation specificity: 0.8529032258064516
Validation icbhi_score: 0.6726780279975655
Validation roc_auc: None
Validation avg_accuracy: 0.4277832061749877
Validation one_indexed_epoch: 19
Validation cm: [[ 194 1094   87  199]
 [  39  776    8   37]
 [  32  250   29   93]
 [  21  166    8   47]]
Validation val_loss: 1.019432340374983
Validation normalized_cm: [[0.123 0.695 0.055 0.126]
 [0.045 0.902 0.009 0.043]
 [0.079 0.619 0.072 0.23 ]
 [0.087 0.686 0.033 0.194]]
Validation acc: 0.3396103896103896
Validation class_accuracies: [0.12325285895806862, 0.9023255813953488, 0.07178217821782178, 0.19421487603305784]
Validation sensitivity: 0.5657370517928287
Validation specificity: 0.12325285895806862
Validation icbhi_score: 0.34449495537544866
Validation roc_auc: None
Validation avg_accuracy: 0.32289387365107425
Validation one_indexed_epoch: 19
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 17 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 17 epochs
-----------------------------
258/258 - 461s - loss: 0.3130 - accuracy: 0.5788 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 20/100
Validation cm: [[2000  140  144   41]
 [  18    4    1    1]
 [ 157   46  255   24]
 [  13    3    4    4]]
Validation val_loss: 0.3228621284139584
Validation normalized_cm: [[0.86  0.06  0.062 0.018]
 [0.75  0.167 0.042 0.042]
 [0.326 0.095 0.529 0.05 ]
 [0.542 0.125 0.167 0.167]]
Validation acc: 0.7926444833625219
Validation class_accuracies: [0.8602150537634409, 0.16666666666666666, 0.529045643153527, 0.16666666666666666]
Validation sensitivity: 0.4962264150943396
Validation specificity: 0.8602150537634409
Validation icbhi_score: 0.6782207344288902
Validation roc_auc: None
Validation avg_accuracy: 0.4306485075625753
Validation one_indexed_epoch: 20
Validation cm: [[ 194 1096   89  195]
 [  42  773    9   36]
 [  35  249   27   93]
 [  22  166    8   46]]
Validation val_loss: 1.0151336873079462
Validation normalized_cm: [[0.123 0.696 0.057 0.124]
 [0.049 0.899 0.01  0.042]
 [0.087 0.616 0.067 0.23 ]
 [0.091 0.686 0.033 0.19 ]]
Validation acc: 0.33766233766233766
Validation class_accuracies: [0.12325285895806862, 0.8988372093023256, 0.06683168316831684, 0.19008264462809918]
Validation sensitivity: 0.5617529880478087
Validation specificity: 0.12325285895806862
Validation icbhi_score: 0.34250292350293865
Validation roc_auc: None
Validation avg_accuracy: 0.31975109901420257
Validation one_indexed_epoch: 20
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 18 epochs
Lr has been adjusted to 4.882812390860636e-06
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 18 epochs
-----------------------------
258/258 - 458s - loss: 0.3149 - accuracy: 0.5734 - 458s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 21/100
Validation cm: [[1987  148  147   43]
 [  18    4    1    1]
 [ 154   45  257   26]
 [  12    4    3    5]]
Validation val_loss: 0.3288119402067367
Validation normalized_cm: [[0.855 0.064 0.063 0.018]
 [0.75  0.167 0.042 0.042]
 [0.32  0.093 0.533 0.054]
 [0.5   0.167 0.125 0.208]]
Validation acc: 0.7891418563922942
Validation class_accuracies: [0.8546236559139785, 0.16666666666666666, 0.533195020746888, 0.20833333333333334]
Validation sensitivity: 0.5018867924528302
Validation specificity: 0.8546236559139785
Validation icbhi_score: 0.6782552241834043
Validation roc_auc: None
Validation avg_accuracy: 0.4407046691652166
Validation one_indexed_epoch: 21
Validation cm: [[ 195 1097   88  194]
 [  42  774    9   35]
 [  37  250   26   91]
 [  22  166    8   46]]
Validation val_loss: 1.015796784307262
Validation normalized_cm: [[0.124 0.697 0.056 0.123]
 [0.049 0.9   0.01  0.041]
 [0.092 0.619 0.064 0.225]
 [0.091 0.686 0.033 0.19 ]]
Validation acc: 0.337987012987013
Validation class_accuracies: [0.12388818297331639, 0.9, 0.06435643564356436, 0.19008264462809918]
Validation sensitivity: 0.5617529880478087
Validation specificity: 0.12388818297331639
Validation icbhi_score: 0.34282058551056255
Validation roc_auc: None
Validation avg_accuracy: 0.319581815811245
Validation one_indexed_epoch: 21
-----------------------------
The validation tracker metric at 0.7520105498072631 hasn't increased by 0 in 19 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.4955814185021878 hasn't increased by 0 in 19 epochs
-----------------------------
258/258 - 455s - loss: 0.3158 - accuracy: 0.5778 - 455s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 22/100
Validation cm: [[1986  152  144   43]
 [  18    4    1    1]
 [ 154   48  252   28]
 [  12    4    4    4]]
Validation val_loss: 0.3318552596334918
Validation normalized_cm: [[0.854 0.065 0.062 0.018]
 [0.75  0.167 0.042 0.042]
 [0.32  0.1   0.523 0.058]
 [0.5   0.167 0.167 0.167]]
Validation acc: 0.7866900175131348
Validation class_accuracies: [0.8541935483870968, 0.16666666666666666, 0.5228215767634855, 0.16666666666666666]
Validation sensitivity: 0.49056603773584906
Validation specificity: 0.8541935483870968
Validation icbhi_score: 0.672379793061473
Validation roc_auc: None
Validation avg_accuracy: 0.4275871146209789
Validation one_indexed_epoch: 22
Validation cm: [[ 191 1101   85  197]
 [  37  780    8   35]
 [  34  251   27   92]
 [  20  168    8   46]]
Validation val_loss: 1.0257950282265589
Validation normalized_cm: [[0.121 0.699 0.054 0.125]
 [0.043 0.907 0.009 0.041]
 [0.084 0.621 0.067 0.228]
 [0.083 0.694 0.033 0.19 ]]
Validation acc: 0.33896103896103896
Validation class_accuracies: [0.12134688691232529, 0.9069767441860465, 0.06683168316831684, 0.19008264462809918]
Validation sensitivity: 0.5664010624169987
Validation specificity: 0.12134688691232529
Validation icbhi_score: 0.343873974664662
Validation roc_auc: None
Validation avg_accuracy: 0.32130948972369694
Validation one_indexed_epoch: 22
-----------------------------
The number of epochs since last 1% equals the patience
-----------------------------
-----------------------------
The number of epochs since last 1% equals the patience
-----------------------------
258/258 - 454s - loss: 0.3135 - accuracy: 0.5728 - 454s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.7520105498072631
Best cm: [[2251    0   74    0]
 [  24    0    0    0]
 [ 198    0  284    0]
 [  24    0    0    0]]
Best val_loss: 0.4611773097890897
Best normalized_cm: [[0.968 0.    0.032 0.   ]
 [1.    0.    0.    0.   ]
 [0.411 0.    0.589 0.   ]
 [1.    0.    0.    0.   ]]
Best acc: 0.8879159369527145
Best class_accuracies: [0.9681720430107527, 0.0, 0.5892116182572614, 0.0]
Best sensitivity: 0.5358490566037736
Best specificity: 0.9681720430107527
Best roc_auc: None
Best avg_accuracy: 0.3893459153170035
Best one_indexed_epoch: 2
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.4955814185021878
Best cm: [[1558    0   16    0]
 [ 847    0   13    0]
 [ 402    0    2    0]
 [ 237    0    5    0]]
Best val_loss: 0.6463024694907975
Best normalized_cm: [[0.99  0.    0.01  0.   ]
 [0.985 0.    0.015 0.   ]
 [0.995 0.    0.005 0.   ]
 [0.979 0.    0.021 0.   ]]
Best acc: 0.5064935064935064
Best class_accuracies: [0.9898348157560356, 0.0, 0.0049504950495049506, 0.0]
Best sensitivity: 0.0013280212483399733
Best specificity: 0.9898348157560356
Best roc_auc: None
Best avg_accuracy: 0.24869632770138514
Best one_indexed_epoch: 2
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
icbhi_score
model
cm
val_loss
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.6507354974746704, 0.5538011193275452, 0.5243579745292664, 0.5000500082969666, 0.48233842849731445, 0.46441298723220825, 0.4543119966983795, 0.4288749396800995, 0.41407346725463867, 0.367978572845459, 0.35677570104599, 0.34409812092781067, 0.33683833479881287, 0.32828137278556824, 0.31758227944374084, 0.31872886419296265, 0.31691887974739075, 0.31962502002716064, 0.3130112588405609, 0.31490615010261536, 0.31580767035484314, 0.31354957818984985], 'accuracy': [0.4810902774333954, 0.4456383287906647, 0.4504947364330292, 0.45838645100593567, 0.48958903551101685, 0.5162994265556335, 0.5183026790618896, 0.5424027442932129, 0.5348752737045288, 0.5432525873184204, 0.5585503578186035, 0.5642566680908203, 0.5710556507110596, 0.5708128213882446, 0.5860499143600464, 0.5814970135688782, 0.5793722867965698, 0.5787652730941772, 0.5788259506225586, 0.5734232068061829, 0.5777939558029175, 0.5728161334991455]}
End
####################################
Job id is 4.
len of icbhi
7857
len of train icbhi
4769
len of val icbhi
3080
before icbhi addition
11752
after icbhi addition
16521
-----------------------
--- Final training dataset went from 0 to 16521 elements, with 11743 none's, 1633 crakles, 2164 wheezes and 981 both ---
--- Final Validation dataset contains 2807 elements, with 2407 none, 64 crackles, 256 wheezes and 80 both ---
Initializing weights...
weights = {0: 0.35172017372051434, 1: 2.529240661359461, 2: 1.9086182994454715, 3: 4.210244648318043}
Model: "leaf_model9_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_10 (Sequential)                      (None, 80, 200, 1)                          4                
                                                                                                              
 sequential_11 (Sequential)                      (None, 80, 200, 16)                         2352             
                                                                                                              
 sequential_12 (Sequential)                      (None, 80, 200, 16)                         6448             
                                                                                                              
 sequential_13 (Sequential)                      (None, 80, 200, 16)                         32               
                                                                                                              
 concatenate_2 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_14 (Sequential)                      (None, 2)                                   6192322          
                                                                                                              
==============================================================================================================
Total params: 6,201,318
Trainable params: 6,159,812
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is icbhi_score
Target metric is icbhi_score
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 1/100
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[2407    0    0    0]
 [  64    0    0    0]
 [ 256    0    0    0]
 [  80    0    0    0]]
Validation val_loss: 0.5962254212214337
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.8574991093694335
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Validation cm: [[1574    0    0    0]
 [ 860    0    0    0]
 [ 404    0    0    0]
 [ 242    0    0    0]]
Validation val_loss: 0.6478225389084259
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5110389610389611
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation sensitivity: 0.0
Validation specificity: 1.0
Validation icbhi_score: 0.5
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
-- New best results were achieved. --
-----------------------------
259/259 - 465s - loss: 0.6375 - accuracy: 0.4672 - 465s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 2/100
Validation cm: [[2364    0   43    0]
 [  64    0    0    0]
 [ 225    0   31    0]
 [  80    0    0    0]]
Validation val_loss: 0.450770087691444
Validation normalized_cm: [[0.982 0.    0.018 0.   ]
 [1.    0.    0.    0.   ]
 [0.879 0.    0.121 0.   ]
 [1.    0.    0.    0.   ]]
Validation acc: 0.8532240826505165
Validation class_accuracies: [0.9821354383049439, 0.0, 0.12109375, 0.0]
Validation sensitivity: 0.0775
Validation specificity: 0.9821354383049439
Validation icbhi_score: 0.5298177191524719
Validation roc_auc: None
Validation avg_accuracy: 0.27580729707623597
Validation one_indexed_epoch: 2
Validation cm: [[899 643  31   1]
 [311 547   2   0]
 [235 159  10   0]
 [139  96   7   0]]
Validation val_loss: 0.6247166634380044
Validation normalized_cm: [[5.712e-01 4.085e-01 1.970e-02 6.353e-04]
 [3.616e-01 6.360e-01 2.326e-03 0.000e+00]
 [5.817e-01 3.936e-01 2.475e-02 0.000e+00]
 [5.744e-01 3.967e-01 2.893e-02 0.000e+00]]
Validation acc: 0.4727272727272727
Validation class_accuracies: [0.571156289707751, 0.6360465116279069, 0.024752475247524754, 0.0]
Validation sensitivity: 0.3698539176626826
Validation specificity: 0.571156289707751
Validation icbhi_score: 0.4705051036852168
Validation roc_auc: None
Validation avg_accuracy: 0.3079888191457957
Validation one_indexed_epoch: 2
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
-----------------------------
259/259 - 463s - loss: 0.5515 - accuracy: 0.4382 - 463s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 3/100
Validation cm: [[1828   49  516   14]
 [  56    3    5    0]
 [ 136    6  113    1]
 [  55    6   19    0]]
Validation val_loss: 0.41433401258684033
Validation normalized_cm: [[0.759 0.02  0.214 0.006]
 [0.875 0.047 0.078 0.   ]
 [0.531 0.023 0.441 0.004]
 [0.688 0.075 0.237 0.   ]]
Validation acc: 0.6925543284645529
Validation class_accuracies: [0.7594515995014541, 0.046875, 0.44140625, 0.0]
Validation sensitivity: 0.29
Validation specificity: 0.7594515995014541
Validation icbhi_score: 0.5247257997507271
Validation roc_auc: None
Validation avg_accuracy: 0.31193321237536353
Validation one_indexed_epoch: 3
Validation cm: [[  44 1148  171  211]
 [   8  720   29  103]
 [   8  268   38   90]
 [   2  150   36   54]]
Validation val_loss: 0.8278625409832442
Validation normalized_cm: [[0.028 0.729 0.109 0.134]
 [0.009 0.837 0.034 0.12 ]
 [0.02  0.663 0.094 0.223]
 [0.008 0.62  0.149 0.223]]
Validation acc: 0.2779220779220779
Validation class_accuracies: [0.02795425667090216, 0.8372093023255814, 0.09405940594059406, 0.2231404958677686]
Validation sensitivity: 0.5391766268260292
Validation specificity: 0.02795425667090216
Validation icbhi_score: 0.28356544174846565
Validation roc_auc: None
Validation avg_accuracy: 0.29559086520121153
Validation one_indexed_epoch: 3
-----------------------------
The validation tracker metric at 0.5298177191524719 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
-----------------------------
259/259 - 460s - loss: 0.5287 - accuracy: 0.4308 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 4/100
Validation cm: [[2230   21   47  109]
 [  61    1    2    0]
 [ 180    2   16   58]
 [  56    4    5   15]]
Validation val_loss: 0.3775990774903458
Validation normalized_cm: [[0.926 0.009 0.02  0.045]
 [0.953 0.016 0.031 0.   ]
 [0.703 0.008 0.062 0.227]
 [0.7   0.05  0.062 0.188]]
Validation acc: 0.8058425365158532
Validation class_accuracies: [0.9264644786040714, 0.015625, 0.0625, 0.1875]
Validation sensitivity: 0.08
Validation specificity: 0.9264644786040714
Validation icbhi_score: 0.5032322393020358
Validation roc_auc: None
Validation avg_accuracy: 0.29802236965101786
Validation one_indexed_epoch: 4
Validation cm: [[  21 1096   37  420]
 [   2  672    9  177]
 [   3  200   13  188]
 [  13  136    7   86]]
Validation val_loss: 0.9127172337578876
Validation normalized_cm: [[0.013 0.696 0.024 0.267]
 [0.002 0.781 0.01  0.206]
 [0.007 0.495 0.032 0.465]
 [0.054 0.562 0.029 0.355]]
Validation acc: 0.2571428571428571
Validation class_accuracies: [0.013341804320203304, 0.7813953488372093, 0.03217821782178218, 0.35537190082644626]
Validation sensitivity: 0.5119521912350598
Validation specificity: 0.013341804320203304
Validation icbhi_score: 0.2626469977776315
Validation roc_auc: None
Validation avg_accuracy: 0.29557181795141024
Validation one_indexed_epoch: 4
-----------------------------
The validation tracker metric at 0.5298177191524719 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 3 epochs
-----------------------------
259/259 - 459s - loss: 0.5119 - accuracy: 0.4520 - 459s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 5/100
Validation cm: [[1749   45  541   72]
 [  29    2   12   21]
 [  69    4  150   33]
 [  17    6   24   33]]
Validation val_loss: 0.43016643981089486
Validation normalized_cm: [[0.727 0.019 0.225 0.03 ]
 [0.453 0.031 0.188 0.328]
 [0.27  0.016 0.586 0.129]
 [0.212 0.075 0.3   0.412]]
Validation acc: 0.6889918061987887
Validation class_accuracies: [0.7266306605733278, 0.03125, 0.5859375, 0.4125]
Validation sensitivity: 0.4625
Validation specificity: 0.7266306605733278
Validation icbhi_score: 0.5945653302866639
Validation roc_auc: None
Validation avg_accuracy: 0.43907954014333195
Validation one_indexed_epoch: 5
Validation cm: [[  56 1211   34  273]
 [   5  753    3   99]
 [  17  266   13  108]
 [   2  187    7   46]]
Validation val_loss: 0.762904304892502
Validation normalized_cm: [[0.036 0.769 0.022 0.173]
 [0.006 0.876 0.003 0.115]
 [0.042 0.658 0.032 0.267]
 [0.008 0.773 0.029 0.19 ]]
Validation acc: 0.2818181818181818
Validation class_accuracies: [0.035578144853875476, 0.8755813953488372, 0.03217821782178218, 0.19008264462809918]
Validation sensitivity: 0.5391766268260292
Validation specificity: 0.035578144853875476
Validation icbhi_score: 0.2873773858399523
Validation roc_auc: None
Validation avg_accuracy: 0.2833551006631485
Validation one_indexed_epoch: 5
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 4 epochs
-----------------------------
259/259 - 462s - loss: 0.4888 - accuracy: 0.4577 - 462s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 6/100
Validation cm: [[1410   26  772  199]
 [  12    1   27   24]
 [  44    0  112  100]
 [  34    0   21   25]]
Validation val_loss: 0.5997887786776231
Validation normalized_cm: [[0.586 0.011 0.321 0.083]
 [0.188 0.016 0.422 0.375]
 [0.172 0.    0.438 0.391]
 [0.425 0.    0.263 0.312]]
Validation acc: 0.5514784467402921
Validation class_accuracies: [0.5857914416285833, 0.015625, 0.4375, 0.3125]
Validation sensitivity: 0.345
Validation specificity: 0.5857914416285833
Validation icbhi_score: 0.46539572081429165
Validation roc_auc: None
Validation avg_accuracy: 0.33785411040714586
Validation one_indexed_epoch: 6
Validation cm: [[ 56 657 265 596]
 [  2 475  86 297]
 [ 15  97  82 210]
 [ 10  97  18 117]]
Validation val_loss: 0.9986815462407262
Validation normalized_cm: [[0.036 0.417 0.168 0.379]
 [0.002 0.552 0.1   0.345]
 [0.037 0.24  0.203 0.52 ]
 [0.041 0.401 0.074 0.483]]
Validation acc: 0.237012987012987
Validation class_accuracies: [0.035578144853875476, 0.5523255813953488, 0.20297029702970298, 0.4834710743801653]
Validation sensitivity: 0.44754316069057104
Validation specificity: 0.035578144853875476
Validation icbhi_score: 0.24156065277222327
Validation roc_auc: None
Validation avg_accuracy: 0.31858627441477316
Validation one_indexed_epoch: 6
-----------------------------
The validation tracker metric at 0.5945653302866639 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 5 epochs
-----------------------------
259/259 - 461s - loss: 0.4735 - accuracy: 0.4791 - 461s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 7/100
Validation cm: [[2039   37  303   28]
 [  50    8    6    0]
 [ 123    2  126    5]
 [  29    0   33   18]]
Validation val_loss: 0.34347687544191685
Validation normalized_cm: [[0.847 0.015 0.126 0.012]
 [0.781 0.125 0.094 0.   ]
 [0.48  0.008 0.492 0.02 ]
 [0.362 0.    0.412 0.225]]
Validation acc: 0.7805486284289277
Validation class_accuracies: [0.8471125882841711, 0.125, 0.4921875, 0.225]
Validation sensitivity: 0.38
Validation specificity: 0.8471125882841711
Validation icbhi_score: 0.6135562941420856
Validation roc_auc: None
Validation avg_accuracy: 0.42232502207104283
Validation one_indexed_epoch: 7
Validation cm: [[  32 1282  196   64]
 [  20  800   18   22]
 [   5  299   75   25]
 [   5  170   23   44]]
Validation val_loss: 0.8025537059968942
Validation normalized_cm: [[0.02  0.814 0.125 0.041]
 [0.023 0.93  0.021 0.026]
 [0.012 0.74  0.186 0.062]
 [0.021 0.702 0.095 0.182]]
Validation acc: 0.30876623376623374
Validation class_accuracies: [0.020330368487928845, 0.9302325581395349, 0.18564356435643564, 0.18181818181818182]
Validation sensitivity: 0.6102257636122178
Validation specificity: 0.020330368487928845
Validation icbhi_score: 0.3152780660500733
Validation roc_auc: None
Validation avg_accuracy: 0.3295061682005203
Validation one_indexed_epoch: 7
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 6 epochs
Lr has been adjusted to 0.0012499999720603228
-----------------------------
259/259 - 460s - loss: 0.4557 - accuracy: 0.4983 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 8/100
Validation cm: [[2045  185  137   40]
 [  38   24    0    2]
 [ 102   44   83   27]
 [  17   21   10   32]]
Validation val_loss: 0.3690884119570076
Validation normalized_cm: [[0.85  0.077 0.057 0.017]
 [0.594 0.375 0.    0.031]
 [0.398 0.172 0.324 0.105]
 [0.212 0.263 0.125 0.4  ]]
Validation acc: 0.7780548628428927
Validation class_accuracies: [0.8496053178230162, 0.375, 0.32421875, 0.4]
Validation sensitivity: 0.3475
Validation specificity: 0.8496053178230162
Validation icbhi_score: 0.5985526589115081
Validation roc_auc: None
Validation avg_accuracy: 0.48720601695575405
Validation one_indexed_epoch: 8
Validation cm: [[ 108 1216  108  142]
 [  42  780   20   18]
 [  27  287   48   42]
 [  25  165   17   35]]
Validation val_loss: 0.8569142608250213
Validation normalized_cm: [[0.069 0.773 0.069 0.09 ]
 [0.049 0.907 0.023 0.021]
 [0.067 0.71  0.119 0.104]
 [0.103 0.682 0.07  0.145]]
Validation acc: 0.31525974025974024
Validation class_accuracies: [0.06861499364675985, 0.9069767441860465, 0.1188118811881188, 0.1446280991735537]
Validation sensitivity: 0.5730411686586986
Validation specificity: 0.06861499364675985
Validation icbhi_score: 0.3208280811527292
Validation roc_auc: None
Validation avg_accuracy: 0.3097579295486197
Validation one_indexed_epoch: 8
-----------------------------
The validation tracker metric at 0.6135562941420856 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 7 epochs
-----------------------------
259/259 - 460s - loss: 0.4173 - accuracy: 0.4973 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 9/100
Validation cm: [[2179   95  109   24]
 [  43   21    0    0]
 [ 127   26   93   10]
 [  24   15   14   27]]
Validation val_loss: 0.314424061150202
Validation normalized_cm: [[0.905 0.039 0.045 0.01 ]
 [0.672 0.328 0.    0.   ]
 [0.496 0.102 0.363 0.039]
 [0.3   0.188 0.175 0.338]]
Validation acc: 0.8265051656572854
Validation class_accuracies: [0.9052762775238886, 0.328125, 0.36328125, 0.3375]
Validation sensitivity: 0.3525
Validation specificity: 0.9052762775238886
Validation icbhi_score: 0.6288881387619443
Validation roc_auc: None
Validation avg_accuracy: 0.4835456318809721
Validation one_indexed_epoch: 9
Validation cm: [[ 159 1163  109  143]
 [  34  786   14   26]
 [  28  261   39   76]
 [  11  168   11   52]]
Validation val_loss: 0.890878154523066
Validation normalized_cm: [[0.101 0.739 0.069 0.091]
 [0.04  0.914 0.016 0.03 ]
 [0.069 0.646 0.097 0.188]
 [0.045 0.694 0.045 0.215]]
Validation acc: 0.33636363636363636
Validation class_accuracies: [0.10101651842439645, 0.913953488372093, 0.09653465346534654, 0.21487603305785125]
Validation sensitivity: 0.5823373173970784
Validation specificity: 0.10101651842439645
Validation icbhi_score: 0.3416769179107374
Validation roc_auc: None
Validation avg_accuracy: 0.33159517332992183
Validation one_indexed_epoch: 9
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 8 epochs
-----------------------------
259/259 - 460s - loss: 0.3925 - accuracy: 0.5355 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 10/100
Validation cm: [[2154   29  178   46]
 [  55    3    6    0]
 [ 129    1  117    9]
 [  28    1   26   25]]
Validation val_loss: 0.29759235063314127
Validation normalized_cm: [[0.895 0.012 0.074 0.019]
 [0.859 0.047 0.094 0.   ]
 [0.504 0.004 0.457 0.035]
 [0.35  0.013 0.325 0.312]]
Validation acc: 0.8190238688991807
Validation class_accuracies: [0.8948899044453676, 0.046875, 0.45703125, 0.3125]
Validation sensitivity: 0.3625
Validation specificity: 0.8948899044453676
Validation icbhi_score: 0.6286949522226838
Validation roc_auc: None
Validation avg_accuracy: 0.4278240386113419
Validation one_indexed_epoch: 10
Validation cm: [[ 229 1068   68  209]
 [  84  712    7   57]
 [  35  232   30  107]
 [  17  155   16   54]]
Validation val_loss: 0.8563390736812847
Validation normalized_cm: [[0.145 0.679 0.043 0.133]
 [0.098 0.828 0.008 0.066]
 [0.087 0.574 0.074 0.265]
 [0.07  0.64  0.066 0.223]]
Validation acc: 0.3327922077922078
Validation class_accuracies: [0.1454891994917408, 0.827906976744186, 0.07425742574257425, 0.2231404958677686]
Validation sensitivity: 0.5285524568393094
Validation specificity: 0.1454891994917408
Validation icbhi_score: 0.3370208281655251
Validation roc_auc: None
Validation avg_accuracy: 0.3176985244615674
Validation one_indexed_epoch: 10
-----------------------------
The validation tracker metric at 0.6288881387619443 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 9 epochs
-----------------------------
259/259 - 460s - loss: 0.3792 - accuracy: 0.5473 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 11/100
Validation cm: [[2156  142   96   13]
 [  50   14    0    0]
 [ 133   29   80   14]
 [  21   34    7   18]]
Validation val_loss: 0.319616551087911
Validation normalized_cm: [[0.896 0.059 0.04  0.005]
 [0.781 0.219 0.    0.   ]
 [0.52  0.113 0.312 0.055]
 [0.263 0.425 0.087 0.225]]
Validation acc: 0.8079800498753117
Validation class_accuracies: [0.8957208142916494, 0.21875, 0.3125, 0.225]
Validation sensitivity: 0.28
Validation specificity: 0.8957208142916494
Validation icbhi_score: 0.5878604071458247
Validation roc_auc: None
Validation avg_accuracy: 0.4129927035729124
Validation one_indexed_epoch: 11
Validation cm: [[ 161 1206   53  154]
 [  52  774    1   33]
 [  25  306   15   58]
 [   6  182    7   47]]
Validation val_loss: 0.8952830880828951
Validation normalized_cm: [[0.102 0.766 0.034 0.098]
 [0.06  0.9   0.001 0.038]
 [0.062 0.757 0.037 0.144]
 [0.025 0.752 0.029 0.194]]
Validation acc: 0.3237012987012987
Validation class_accuracies: [0.102287166454892, 0.9, 0.03712871287128713, 0.19421487603305784]
Validation sensitivity: 0.5551128818061088
Validation specificity: 0.102287166454892
Validation icbhi_score: 0.3287000241305004
Validation roc_auc: None
Validation avg_accuracy: 0.30840768883980924
Validation one_indexed_epoch: 11
-----------------------------
The validation tracker metric at 0.6288881387619443 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 10 epochs
-----------------------------
259/259 - 460s - loss: 0.3714 - accuracy: 0.5388 - 460s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 12/100
Validation cm: [[2247   45   98   17]
 [  62    2    0    0]
 [ 162    1   87    6]
 [  33   19   14   14]]
Validation val_loss: 0.2799754190050963
Validation normalized_cm: [[0.934 0.019 0.041 0.007]
 [0.969 0.031 0.    0.   ]
 [0.633 0.004 0.34  0.023]
 [0.412 0.237 0.175 0.175]]
Validation acc: 0.8371927324545778
Validation class_accuracies: [0.9335272122974657, 0.03125, 0.33984375, 0.175]
Validation sensitivity: 0.2575
Validation specificity: 0.9335272122974657
Validation icbhi_score: 0.5955136061487328
Validation roc_auc: None
Validation avg_accuracy: 0.3699052405743664
Validation one_indexed_epoch: 12
Validation cm: [[ 250 1018  106  200]
 [ 104  672   13   71]
 [  42  213   35  114]
 [  25  148   11   58]]
Validation val_loss: 0.8472924030869715
Validation normalized_cm: [[0.159 0.647 0.067 0.127]
 [0.121 0.781 0.015 0.083]
 [0.104 0.527 0.087 0.282]
 [0.103 0.612 0.045 0.24 ]]
Validation acc: 0.32954545454545453
Validation class_accuracies: [0.1588310038119441, 0.7813953488372093, 0.08663366336633663, 0.2396694214876033]
Validation sensitivity: 0.5079681274900398
Validation specificity: 0.1588310038119441
Validation icbhi_score: 0.33339956565099194
Validation roc_auc: None
Validation avg_accuracy: 0.3166323593757734
Validation one_indexed_epoch: 12
-----------------------------
The validation tracker metric at 0.6288881387619443 hasn't increased by 0 in 3 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 11 epochs
-----------------------------
259/259 - 466s - loss: 0.3573 - accuracy: 0.5558 - 466s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 13/100
Validation cm: [[2212   71  103   21]
 [  53   11    0    0]
 [ 140   31   75   10]
 [  29   13   13   25]]
Validation val_loss: 0.2802448357768514
Validation normalized_cm: [[0.919 0.029 0.043 0.009]
 [0.828 0.172 0.    0.   ]
 [0.547 0.121 0.293 0.039]
 [0.362 0.163 0.163 0.312]]
Validation acc: 0.8275739223370147
Validation class_accuracies: [0.9189862899875364, 0.171875, 0.29296875, 0.3125]
Validation sensitivity: 0.2775
Validation specificity: 0.9189862899875364
Validation icbhi_score: 0.5982431449937682
Validation roc_auc: None
Validation avg_accuracy: 0.4240825099968841
Validation one_indexed_epoch: 13
Validation cm: [[278 836  94 366]
 [ 93 591  25 151]
 [ 32 201  21 150]
 [ 38  98  20  86]]
Validation val_loss: 0.9989387318092797
Validation normalized_cm: [[0.177 0.531 0.06  0.233]
 [0.108 0.687 0.029 0.176]
 [0.079 0.498 0.052 0.371]
 [0.157 0.405 0.083 0.355]]
Validation acc: 0.3168831168831169
Validation class_accuracies: [0.17662007623888182, 0.6872093023255814, 0.05198019801980198, 0.35537190082644626]
Validation sensitivity: 0.4634794156706507
Validation specificity: 0.17662007623888182
Validation icbhi_score: 0.32004974595476626
Validation roc_auc: None
Validation avg_accuracy: 0.3177953693526779
Validation one_indexed_epoch: 13
-----------------------------
The validation tracker metric at 0.6288881387619443 hasn't increased by 0 in 4 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 12 epochs
Lr has been adjusted to 0.0003124999930150807
-----------------------------
259/259 - 515s - loss: 0.3446 - accuracy: 0.5603 - 515s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 14/100
Validation cm: [[2191   52  145   19]
 [  50   10    4    0]
 [ 117    8  128    3]
 [  24   12   14   30]]
Validation val_loss: 0.27313728533642656
Validation normalized_cm: [[0.91  0.022 0.06  0.008]
 [0.781 0.156 0.062 0.   ]
 [0.457 0.031 0.5   0.012]
 [0.3   0.15  0.175 0.375]]
Validation acc: 0.8403990024937655
Validation class_accuracies: [0.9102617366015787, 0.15625, 0.5, 0.375]
Validation sensitivity: 0.42
Validation specificity: 0.9102617366015787
Validation icbhi_score: 0.6651308683007894
Validation roc_auc: None
Validation avg_accuracy: 0.48537793415039465
Validation one_indexed_epoch: 14
Validation cm: [[331 945 175 123]
 [122 686   9  43]
 [ 46 236  55  67]
 [ 24 152  11  55]]
Validation val_loss: 0.8525548242969898
Validation normalized_cm: [[0.21  0.6   0.111 0.078]
 [0.142 0.798 0.01  0.05 ]
 [0.114 0.584 0.136 0.166]
 [0.099 0.628 0.045 0.227]]
Validation acc: 0.3659090909090909
Validation class_accuracies: [0.210292249047014, 0.7976744186046512, 0.13613861386138615, 0.22727272727272727]
Validation sensitivity: 0.5285524568393094
Validation specificity: 0.210292249047014
Validation icbhi_score: 0.3694223529431617
Validation roc_auc: None
Validation avg_accuracy: 0.34284450219644463
Validation one_indexed_epoch: 14
-----------------------------
-- New best results were achieved. --
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 13 epochs
-----------------------------
259/259 - 512s - loss: 0.3124 - accuracy: 0.5633 - 512s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 15/100
Validation cm: [[2196   45  145   21]
 [  52    8    3    1]
 [ 122    4  124    6]
 [  21    9   20   30]]
Validation val_loss: 0.27001721493528513
Validation normalized_cm: [[0.912 0.019 0.06  0.009]
 [0.812 0.125 0.047 0.016]
 [0.477 0.016 0.484 0.023]
 [0.263 0.113 0.25  0.375]]
Validation acc: 0.8400427502671892
Validation class_accuracies: [0.9123390112172829, 0.125, 0.484375, 0.375]
Validation sensitivity: 0.405
Validation specificity: 0.9123390112172829
Validation icbhi_score: 0.6586695056086415
Validation roc_auc: None
Validation avg_accuracy: 0.4741785028043207
Validation one_indexed_epoch: 15
Validation cm: [[ 287 1004  152  131]
 [  85  724    7   44]
 [  46  244   48   66]
 [  32  155   10   45]]
Validation val_loss: 0.9069297825999243
Validation normalized_cm: [[0.182 0.638 0.097 0.083]
 [0.099 0.842 0.008 0.051]
 [0.114 0.604 0.119 0.163]
 [0.132 0.64  0.041 0.186]]
Validation acc: 0.35844155844155845
Validation class_accuracies: [0.1823379923761118, 0.8418604651162791, 0.1188118811881188, 0.1859504132231405]
Validation sensitivity: 0.5424966799468791
Validation specificity: 0.1823379923761118
Validation icbhi_score: 0.36241733616149546
Validation roc_auc: None
Validation avg_accuracy: 0.33224018797591254
Validation one_indexed_epoch: 15
-----------------------------
The validation tracker metric at 0.6651308683007894 hasn't increased by 0 in 1 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 14 epochs
-----------------------------
259/259 - 458s - loss: 0.3004 - accuracy: 0.5690 - 458s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 16/100
Validation cm: [[2176   38  159   34]
 [  49    7    7    1]
 [ 123    8  113   12]
 [  20    4   23   33]]
Validation val_loss: 0.2818256414897911
Validation normalized_cm: [[0.904 0.016 0.066 0.014]
 [0.766 0.109 0.109 0.016]
 [0.48  0.031 0.441 0.047]
 [0.25  0.05  0.287 0.412]]
Validation acc: 0.8297114356964731
Validation class_accuracies: [0.9040299127544661, 0.109375, 0.44140625, 0.4125]
Validation sensitivity: 0.3825
Validation specificity: 0.9040299127544661
Validation icbhi_score: 0.643264956377233
Validation roc_auc: None
Validation avg_accuracy: 0.4668277906886166
Validation one_indexed_epoch: 16
Validation cm: [[415 830 122 207]
 [187 602  11  60]
 [ 42 218  45  99]
 [ 27 136  13  66]]
Validation val_loss: 0.9170723532562374
Validation normalized_cm: [[0.264 0.527 0.078 0.132]
 [0.217 0.7   0.013 0.07 ]
 [0.104 0.54  0.111 0.245]
 [0.112 0.562 0.054 0.273]]
Validation acc: 0.36623376623376624
Validation class_accuracies: [0.2636594663278272, 0.7, 0.11138613861386139, 0.2727272727272727]
Validation sensitivity: 0.47343957503320055
Validation specificity: 0.2636594663278272
Validation icbhi_score: 0.3685495206805139
Validation roc_auc: None
Validation avg_accuracy: 0.3369432194172403
Validation one_indexed_epoch: 16
-----------------------------
The validation tracker metric at 0.6651308683007894 hasn't increased by 0 in 2 epochs
-----------------------------
-----------------------------
The validation tracker metric at 0.5 hasn't increased by 0 in 15 epochs
-----------------------------
259/259 - 457s - loss: 0.2914 - accuracy: 0.5684 - 457s/epoch - 2s/step
here
<class 'leaf_audio.frontend.MelFilterbanks'>
There is no such attribute
here2
Epoch 17/100
Validation cm: [[2196   72  113   26]
 [  54   10    0    0]
 [ 129   14  103   10]
 [  26   11   11   32]]
Validation val_loss: 0.2741066660916649
Validation normalized_cm: [[0.912 0.03  0.047 0.011]
 [0.844 0.156 0.    0.   ]
 [0.504 0.055 0.402 0.039]
 [0.325 0.138 0.138 0.4  ]]
Validation acc: 0.8339864624153901
Validation class_accuracies: [0.9123390112172829, 0.15625, 0.40234375, 0.4]
Validation sensitivity: 0.3625
Validation specificity: 0.9123390112172829
Validation icbhi_score: 0.6374195056086415
Validation roc_auc: None
Validation avg_accuracy: 0.4677331903043207
Validation one_indexed_epoch: 17
