Validation cm: [[633 184]
 [152  70]]
Validation normalized_cm: [[0.775 0.225]
 [0.685 0.315]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.7747858017135862, 0.3153153153153153]
Validation precision: 0.2755905511811024
Validation recall: 0.3153153153153153
Validation f1: 0.29411764705882354
Validation roc_auc: 0.6674826601387189
Validation avg_accuracy: 0.5450505585144507
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train45
Description: Leaf with model 9/mixednet with P-T trying solo crackles or wheezes detection
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
4055
1214
817
222
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 4055 0's, 1214 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 817 0's and 222 1's ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    129              
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[515 104]
 [ 22  11]] 
Patient Normalized Confusion matrix: 
 [[0.832 0.168]
 [0.667 0.333]] 
Patient Validation accuracy: 
 80.67 
Patient Validation class accuracies: 
 [0.8319870759289176, 0.3333333333333333] 
Saving model...
330/330 - 562s - loss: 0.4318 - accuracy: 0.7876 - 562s/epoch - 2s/step
Validation cm: [[696 121]
 [133  89]]
Validation normalized_cm: [[0.852 0.148]
 [0.599 0.401]]
Validation acc: 0.7555341674687199
Validation class_accuracies: [0.8518971848225214, 0.4009009009009009]
Validation precision: 0.4238095238095238
Validation recall: 0.4009009009009009
Validation f1: 0.4120370370370371
Validation roc_auc: 0.7303913460584206
Validation avg_accuracy: 0.6263990428617112
Validation one_indexed_epoch: 2
Epoch 2/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[600  19]
 [ 27   6]] 
Patient Normalized Confusion matrix: 
 [[0.969 0.031]
 [0.818 0.182]] 
Patient Validation accuracy: 
 92.94 
Patient Validation class accuracies: 
 [0.9693053311793215, 0.18181818181818182] 
Saving model...
330/330 - 542s - loss: 0.4006 - accuracy: 0.8058 - 542s/epoch - 2s/step
Validation cm: [[714 103]
 [167  55]]
Validation normalized_cm: [[0.874 0.126]
 [0.752 0.248]]
Validation acc: 0.7401347449470644
Validation class_accuracies: [0.8739290085679314, 0.24774774774774774]
Validation precision: 0.34810126582278483
Validation recall: 0.24774774774774774
Validation f1: 0.2894736842105263
Validation roc_auc: 0.7192045166341372
Validation avg_accuracy: 0.5608383781578395
Validation one_indexed_epoch: 3
Epoch 3/40
The validation tracker metric at 0.6263990428617112 hasn't increased by 0 in 1 epochs
330/330 - 538s - loss: 0.4022 - accuracy: 0.8032 - 538s/epoch - 2s/step
Validation cm: [[499 318]
 [ 75 147]]
Validation normalized_cm: [[0.611 0.389]
 [0.338 0.662]]
Validation acc: 0.6217516843118384
Validation class_accuracies: [0.6107711138310894, 0.6621621621621622]
Validation precision: 0.3161290322580645
Validation recall: 0.6621621621621622
Validation f1: 0.4279475982532751
Validation roc_auc: 0.6949287108405835
Validation avg_accuracy: 0.6364666379966257
Validation one_indexed_epoch: 4
Epoch 4/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[435 184]
 [ 17  16]] 
Patient Normalized Confusion matrix: 
 [[0.703 0.297]
 [0.515 0.485]] 
Patient Validation accuracy: 
 69.17 
Patient Validation class accuracies: 
 [0.7027463651050081, 0.48484848484848486] 
Saving model...
330/330 - 537s - loss: 0.3917 - accuracy: 0.8125 - 537s/epoch - 2s/step
Validation cm: [[777  40]
 [181  41]]
Validation normalized_cm: [[0.951 0.049]
 [0.815 0.185]]
Validation acc: 0.7872954764196343
Validation class_accuracies: [0.9510403916768666, 0.18468468468468469]
Validation precision: 0.5061728395061729
Validation recall: 0.18468468468468469
Validation f1: 0.2706270627062706
Validation roc_auc: 0.7276180709473242
Validation avg_accuracy: 0.5678625381807756
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.6364666379966257 hasn't increased by 0 in 1 epochs
330/330 - 543s - loss: 0.3724 - accuracy: 0.8184 - 543s/epoch - 2s/step
Validation cm: [[786  31]
 [196  26]]
Validation normalized_cm: [[0.962 0.038]
 [0.883 0.117]]
Validation acc: 0.7815206929740135
Validation class_accuracies: [0.9620563035495716, 0.11711711711711711]
Validation precision: 0.45614035087719296
Validation recall: 0.11711711711711711
Validation f1: 0.18637992831541217
Validation roc_auc: 0.801454453229239
Validation avg_accuracy: 0.5395867103333444
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.6364666379966257 hasn't increased by 0 in 2 epochs
330/330 - 545s - loss: 0.3532 - accuracy: 0.8337 - 545s/epoch - 2s/step
Validation cm: [[685 132]
 [136  86]]
Validation normalized_cm: [[0.838 0.162]
 [0.613 0.387]]
Validation acc: 0.7420596727622714
Validation class_accuracies: [0.8384332925336597, 0.38738738738738737]
Validation precision: 0.3944954128440367
Validation recall: 0.38738738738738737
Validation f1: 0.39090909090909093
Validation roc_auc: 0.7020686537210404
Validation avg_accuracy: 0.6129103399605236
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.6364666379966257 hasn't increased by 0 in 3 epochs
330/330 - 551s - loss: 0.3457 - accuracy: 0.8366 - 551s/epoch - 2s/step
Validation cm: [[724  93]
 [134  88]]
Validation normalized_cm: [[0.886 0.114]
 [0.604 0.396]]
Validation acc: 0.7815206929740135
Validation class_accuracies: [0.8861689106487148, 0.3963963963963964]
Validation precision: 0.4861878453038674
Validation recall: 0.3963963963963964
Validation f1: 0.43672456575682383
Validation roc_auc: 0.7909512940112695
Validation avg_accuracy: 0.6412826535225556
Validation one_indexed_epoch: 8
Epoch 8/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[606  13]
 [ 26   7]] 
Patient Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.788 0.212]] 
Patient Validation accuracy: 
 94.02 
Patient Validation class accuracies: 
 [0.9789983844911146, 0.21212121212121213] 
Saving model...
330/330 - 548s - loss: 0.3229 - accuracy: 0.8512 - 548s/epoch - 2s/step
Validation cm: [[692 125]
 [141  81]]
Validation normalized_cm: [[0.847 0.153]
 [0.635 0.365]]
Validation acc: 0.7439846005774784
Validation class_accuracies: [0.847001223990208, 0.36486486486486486]
Validation precision: 0.3932038834951456
Validation recall: 0.36486486486486486
Validation f1: 0.37850467289719625
Validation roc_auc: 0.7500413510205431
Validation avg_accuracy: 0.6059330444275365
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.6412826535225556 hasn't increased by 0 in 1 epochs
330/330 - 543s - loss: 0.3121 - accuracy: 0.8554 - 543s/epoch - 2s/step
Validation cm: [[739  78]
 [137  85]]
Validation normalized_cm: [[0.905 0.095]
 [0.617 0.383]]
Validation acc: 0.793070259865255
Validation class_accuracies: [0.9045287637698899, 0.38288288288288286]
Validation precision: 0.5214723926380368
Validation recall: 0.38288288288288286
Validation f1: 0.44155844155844154
Validation roc_auc: 0.7987528532204176
Validation avg_accuracy: 0.6437058233263864
Validation one_indexed_epoch: 10
Epoch 10/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[606  13]
 [ 26   7]] 
Patient Normalized Confusion matrix: 
 [[0.979 0.021]
 [0.788 0.212]] 
Patient Validation accuracy: 
 94.02 
Patient Validation class accuracies: 
 [0.9789983844911146, 0.21212121212121213] 
Saving model...
330/330 - 544s - loss: 0.3054 - accuracy: 0.8596 - 544s/epoch - 2s/step
Validation cm: [[736  81]
 [171  51]]
Validation normalized_cm: [[0.901 0.099]
 [0.77  0.23 ]]
Validation acc: 0.7574590952839269
Validation class_accuracies: [0.9008567931456548, 0.22972972972972974]
Validation precision: 0.38636363636363635
Validation recall: 0.22972972972972974
Validation f1: 0.288135593220339
Validation roc_auc: 0.7522191714358177
Validation avg_accuracy: 0.5652932614376923
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.6437058233263864 hasn't increased by 0 in 1 epochs
330/330 - 541s - loss: 0.2977 - accuracy: 0.8622 - 541s/epoch - 2s/step
Validation cm: [[665 152]
 [ 98 124]]
Validation normalized_cm: [[0.814 0.186]
 [0.441 0.559]]
Validation acc: 0.7593840230991338
Validation class_accuracies: [0.813953488372093, 0.5585585585585585]
Validation precision: 0.4492753623188406
Validation recall: 0.5585585585585585
Validation f1: 0.497991967871486
Validation roc_auc: 0.798648097301708
Validation avg_accuracy: 0.6862560234653258
Validation one_indexed_epoch: 12
Epoch 12/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[582  37]
 [ 17  16]] 
Patient Normalized Confusion matrix: 
 [[0.94  0.06 ]
 [0.515 0.485]] 
Patient Validation accuracy: 
 91.72 
Patient Validation class accuracies: 
 [0.9402261712439418, 0.48484848484848486] 
Saving model...
330/330 - 540s - loss: 0.2819 - accuracy: 0.8677 - 540s/epoch - 2s/step
Validation cm: [[733  84]
 [132  90]]
Validation normalized_cm: [[0.897 0.103]
 [0.595 0.405]]
Validation acc: 0.7921077959576516
Validation class_accuracies: [0.8971848225214198, 0.40540540540540543]
Validation precision: 0.5172413793103449
Validation recall: 0.40540540540540543
Validation f1: 0.4545454545454546
Validation roc_auc: 0.8029706573158225
Validation avg_accuracy: 0.6512951139634127
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 1 epochs
330/330 - 539s - loss: 0.2773 - accuracy: 0.8692 - 539s/epoch - 2s/step
Validation cm: [[719  98]
 [136  86]]
Validation normalized_cm: [[0.88  0.12 ]
 [0.613 0.387]]
Validation acc: 0.7747834456207893
Validation class_accuracies: [0.8800489596083231, 0.38738738738738737]
Validation precision: 0.4673913043478261
Validation recall: 0.38738738738738737
Validation f1: 0.4236453201970444
Validation roc_auc: 0.7811648858160486
Validation avg_accuracy: 0.6337181734978552
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 2 epochs
330/330 - 544s - loss: 0.2583 - accuracy: 0.8810 - 544s/epoch - 2s/step
Validation cm: [[753  64]
 [180  42]]
Validation normalized_cm: [[0.922 0.078]
 [0.811 0.189]]
Validation acc: 0.7651588065447545
Validation class_accuracies: [0.9216646266829865, 0.1891891891891892]
Validation precision: 0.39622641509433965
Validation recall: 0.1891891891891892
Validation f1: 0.2560975609756098
Validation roc_auc: 0.716905399891936
Validation avg_accuracy: 0.5554269079360878
Validation one_indexed_epoch: 15
Epoch 15/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 3 epochs
330/330 - 545s - loss: 0.2570 - accuracy: 0.8802 - 545s/epoch - 2s/step
Validation cm: [[679 138]
 [127  95]]
Validation normalized_cm: [[0.831 0.169]
 [0.572 0.428]]
Validation acc: 0.7449470644850819
Validation class_accuracies: [0.8310893512851897, 0.42792792792792794]
Validation precision: 0.40772532188841204
Validation recall: 0.42792792792792794
Validation f1: 0.4175824175824176
Validation roc_auc: 0.7285884415627377
Validation avg_accuracy: 0.6295086396065588
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 4 epochs
330/330 - 539s - loss: 0.2369 - accuracy: 0.8935 - 539s/epoch - 2s/step
Validation cm: [[745  72]
 [161  61]]
Validation normalized_cm: [[0.912 0.088]
 [0.725 0.275]]
Validation acc: 0.7757459095283927
Validation class_accuracies: [0.9118727050183598, 0.2747747747747748]
Validation precision: 0.45864661654135336
Validation recall: 0.2747747747747748
Validation f1: 0.3436619718309859
Validation roc_auc: 0.7744494800798352
Validation avg_accuracy: 0.5933237398965673
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 5 epochs
330/330 - 539s - loss: 0.2176 - accuracy: 0.9059 - 539s/epoch - 2s/step
Validation cm: [[725  92]
 [147  75]]
Validation normalized_cm: [[0.887 0.113]
 [0.662 0.338]]
Validation acc: 0.7699711260827719
Validation class_accuracies: [0.8873929008567931, 0.33783783783783783]
Validation precision: 0.4491017964071856
Validation recall: 0.33783783783783783
Validation f1: 0.3856041131105398
Validation roc_auc: 0.7702206490456185
Validation avg_accuracy: 0.6126153693473155
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 6 epochs
330/330 - 538s - loss: 0.1968 - accuracy: 0.9116 - 538s/epoch - 2s/step
Validation cm: [[749  68]
 [157  65]]
Validation normalized_cm: [[0.917 0.083]
 [0.707 0.293]]
Validation acc: 0.7834456207892204
Validation class_accuracies: [0.9167686658506732, 0.2927927927927928]
Validation precision: 0.48872180451127817
Validation recall: 0.2927927927927928
Validation f1: 0.36619718309859156
Validation roc_auc: 0.7699449755753304
Validation avg_accuracy: 0.604780729321733
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 7 epochs
330/330 - 538s - loss: 0.1896 - accuracy: 0.9191 - 538s/epoch - 2s/step
Validation cm: [[719  98]
 [135  87]]
Validation normalized_cm: [[0.88  0.12 ]
 [0.608 0.392]]
Validation acc: 0.7757459095283927
Validation class_accuracies: [0.8800489596083231, 0.3918918918918919]
Validation precision: 0.4702702702702703
Validation recall: 0.3918918918918919
Validation f1: 0.4275184275184275
Validation roc_auc: 0.7695038980228697
Validation avg_accuracy: 0.6359704257501075
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 8 epochs
330/330 - 534s - loss: 0.1768 - accuracy: 0.9254 - 534s/epoch - 2s/step
Validation cm: [[718  99]
 [132  90]]
Validation normalized_cm: [[0.879 0.121]
 [0.595 0.405]]
Validation acc: 0.7776708373435997
Validation class_accuracies: [0.8788249694002448, 0.40540540540540543]
Validation precision: 0.47619047619047616
Validation recall: 0.40540540540540543
Validation f1: 0.43795620437956206
Validation roc_auc: 0.7899698964570445
Validation avg_accuracy: 0.6421151874028251
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.6862560234653258 hasn't increased by 0 in 9 epochs
330/330 - 537s - loss: 0.1624 - accuracy: 0.9322 - 537s/epoch - 2s/step
Validation cm: [[688 129]
 [103 119]]
Validation normalized_cm: [[0.842 0.158]
 [0.464 0.536]]
Validation acc: 0.7767083734359962
Validation class_accuracies: [0.8421052631578947, 0.536036036036036]
Validation precision: 0.4798387096774194
Validation recall: 0.536036036036036
Validation f1: 0.5063829787234042
Validation roc_auc: 0.8001808417965087
Validation avg_accuracy: 0.6890706495969654
Validation one_indexed_epoch: 22
Epoch 22/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[581  38]
 [ 18  15]] 
Patient Normalized Confusion matrix: 
 [[0.939 0.061]
 [0.545 0.455]] 
Patient Validation accuracy: 
 91.41 
Patient Validation class accuracies: 
 [0.938610662358643, 0.45454545454545453] 
Saving model...
330/330 - 534s - loss: 0.1499 - accuracy: 0.9402 - 534s/epoch - 2s/step
Validation cm: [[704 113]
 [131  91]]
Validation normalized_cm: [[0.862 0.138]
 [0.59  0.41 ]]
Validation acc: 0.7651588065447545
Validation class_accuracies: [0.8616891064871481, 0.4099099099099099]
Validation precision: 0.44607843137254904
Validation recall: 0.4099099099099099
Validation f1: 0.4272300469483568
Validation roc_auc: 0.769911894758896
Validation avg_accuracy: 0.635799508198529
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 1 epochs
330/330 - 537s - loss: 0.1347 - accuracy: 0.9474 - 537s/epoch - 2s/step
Validation cm: [[660 157]
 [116 106]]
Validation normalized_cm: [[0.808 0.192]
 [0.523 0.477]]
Validation acc: 0.737247353224254
Validation class_accuracies: [0.8078335373317014, 0.4774774774774775]
Validation precision: 0.40304182509505704
Validation recall: 0.4774774774774775
Validation f1: 0.43711340206185567
Validation roc_auc: 0.7323817085138994
Validation avg_accuracy: 0.6426555074045894
Validation one_indexed_epoch: 24
Epoch 24/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 2 epochs
330/330 - 536s - loss: 0.1162 - accuracy: 0.9539 - 536s/epoch - 2s/step
Validation cm: [[703 114]
 [135  87]]
Validation normalized_cm: [[0.86  0.14 ]
 [0.608 0.392]]
Validation acc: 0.7603464870067372
Validation class_accuracies: [0.8604651162790697, 0.3918918918918919]
Validation precision: 0.43283582089552236
Validation recall: 0.3918918918918919
Validation f1: 0.41134751773049644
Validation roc_auc: 0.7682909347536029
Validation avg_accuracy: 0.6261785040854808
Validation one_indexed_epoch: 25
Epoch 25/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 3 epochs
330/330 - 533s - loss: 0.1147 - accuracy: 0.9531 - 533s/epoch - 2s/step
Validation cm: [[754  63]
 [158  64]]
Validation normalized_cm: [[0.923 0.077]
 [0.712 0.288]]
Validation acc: 0.7872954764196343
Validation class_accuracies: [0.9228886168910648, 0.2882882882882883]
Validation precision: 0.5039370078740157
Validation recall: 0.2882882882882883
Validation f1: 0.36676217765042984
Validation roc_auc: 0.7806025119366613
Validation avg_accuracy: 0.6055884525896765
Validation one_indexed_epoch: 26
Epoch 26/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 4 epochs
330/330 - 558s - loss: 0.1012 - accuracy: 0.9622 - 558s/epoch - 2s/step
Validation cm: [[721  96]
 [131  91]]
Validation normalized_cm: [[0.882 0.118]
 [0.59  0.41 ]]
Validation acc: 0.7815206929740135
Validation class_accuracies: [0.8824969400244798, 0.4099099099099099]
Validation precision: 0.48663101604278075
Validation recall: 0.4099099099099099
Validation f1: 0.4449877750611247
Validation roc_auc: 0.7748519633464553
Validation avg_accuracy: 0.6462034249671949
Validation one_indexed_epoch: 27
Epoch 27/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 5 epochs
330/330 - 554s - loss: 0.0865 - accuracy: 0.9668 - 554s/epoch - 2s/step
Validation cm: [[741  76]
 [137  85]]
Validation normalized_cm: [[0.907 0.093]
 [0.617 0.383]]
Validation acc: 0.794995187680462
Validation class_accuracies: [0.9069767441860465, 0.38288288288288286]
Validation precision: 0.5279503105590062
Validation recall: 0.38288288288288286
Validation f1: 0.44386422976501305
Validation roc_auc: 0.7820525543903757
Validation avg_accuracy: 0.6449298135344647
Validation one_indexed_epoch: 28
Epoch 28/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 6 epochs
330/330 - 546s - loss: 0.0793 - accuracy: 0.9721 - 546s/epoch - 2s/step
Validation cm: [[693 124]
 [112 110]]
Validation normalized_cm: [[0.848 0.152]
 [0.505 0.495]]
Validation acc: 0.7728585178055823
Validation class_accuracies: [0.8482252141982864, 0.4954954954954955]
Validation precision: 0.4700854700854701
Validation recall: 0.4954954954954955
Validation f1: 0.48245614035087725
Validation roc_auc: 0.779560466218973
Validation avg_accuracy: 0.671860354846891
Validation one_indexed_epoch: 29
Epoch 29/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 7 epochs
330/330 - 550s - loss: 0.0882 - accuracy: 0.9679 - 550s/epoch - 2s/step
Validation cm: [[680 137]
 [108 114]]
Validation normalized_cm: [[0.832 0.168]
 [0.486 0.514]]
Validation acc: 0.7641963426371511
Validation class_accuracies: [0.8323133414932681, 0.5135135135135135]
Validation precision: 0.4541832669322709
Validation recall: 0.5135135135135135
Validation f1: 0.4820295983086681
Validation roc_auc: 0.7755576874303924
Validation avg_accuracy: 0.6729134275033908
Validation one_indexed_epoch: 30
Epoch 30/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 8 epochs
330/330 - 548s - loss: 0.0715 - accuracy: 0.9736 - 548s/epoch - 2s/step
Validation cm: [[702 115]
 [129  93]]
Validation normalized_cm: [[0.859 0.141]
 [0.581 0.419]]
Validation acc: 0.7651588065447545
Validation class_accuracies: [0.8592411260709915, 0.4189189189189189]
Validation precision: 0.44711538461538464
Validation recall: 0.4189189189189189
Validation f1: 0.4325581395348837
Validation roc_auc: 0.7885805021667935
Validation avg_accuracy: 0.6390800224949552
Validation one_indexed_epoch: 31
Epoch 31/40
The validation tracker metric at 0.6890706495969654 hasn't increased by 0 in 9 epochs
330/330 - 550s - loss: 0.0760 - accuracy: 0.9706 - 550s/epoch - 2s/step
Validation cm: [[687 130]
 [121 101]]
Validation normalized_cm: [[0.841 0.159]
 [0.545 0.455]]
Validation acc: 0.7584215591915303
Validation class_accuracies: [0.8408812729498164, 0.45495495495495497]
Validation precision: 0.43722943722943725
Validation recall: 0.45495495495495497
Validation f1: 0.44591611479028703
Validation roc_auc: 0.7855646344018437
Validation avg_accuracy: 0.6479181139523857
Validation one_indexed_epoch: 32
Epoch 32/40
The number of epochs since last 1% equals the patience
330/330 - 541s - loss: 0.0575 - accuracy: 0.9786 - 541s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.6890706495969654
Best cm: [[688 129]
 [103 119]]
Best normalized_cm: [[0.842 0.158]
 [0.464 0.536]]
Best acc: 0.7767083734359962
Best class_accuracies: [0.8421052631578947, 0.536036036036036]
Best precision: 0.4798387096774194
Best recall: 0.536036036036036
Best f1: 0.5063829787234042
Best roc_auc: 0.8001808417965087
Best one_indexed_epoch: 22
Best patient_cm: [[581  38]
 [ 18  15]]
Validation cm: [[  0 817]
 [  0 222]]
Validation normalized_cm: [[0. 1.]
 [0. 1.]]
Validation acc: 0.2136669874879692
Validation class_accuracies: [0.0, 1.0]
Validation precision: 0.2136669874879692
Validation recall: 1.0
Validation f1: 0.352101506740682
Validation roc_auc: 0.4843886113775954
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization_5 (BatchNormalization)      multiple                                    4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_1 (Dense)                                 multiple                                    513              
                                                                                                              
==============================================================================================================
Total params: 6,201,205
Trainable params: 6,159,699
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[  0 619]
 [  0  33]] 
Patient Normalized Confusion matrix: 
 [[0. 1.]
 [0. 1.]] 
Patient Validation accuracy: 
 5.06 
Patient Validation class accuracies: 
 [0.0, 1.0] 
Saving model...
330/330 - 893s - accuracy: 0.7535 - student_loss: 0.3680 - distillation_loss: -1.5438e-03 - val_accuracy: 0.2137 - val_student_loss: 1.3270 - 893s/epoch - 3s/step
Validation cm: [[670 147]
 [185  37]]
Validation normalized_cm: [[0.82  0.18 ]
 [0.833 0.167]]
Validation acc: 0.6804619826756496
Validation class_accuracies: [0.8200734394124847, 0.16666666666666666]
Validation precision: 0.20108695652173914
Validation recall: 0.16666666666666666
Validation f1: 0.18226600985221675
Validation roc_auc: 0.43220086671739055
Validation avg_accuracy: 0.49337005303957565
Validation one_indexed_epoch: 2
Epoch 2/40
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
330/330 - 882s - accuracy: 0.7789 - student_loss: 0.3763 - distillation_loss: 0.0041 - val_accuracy: 0.6805 - val_student_loss: 0.1675 - 882s/epoch - 3s/step
Validation cm: [[721  96]
 [209  13]]
Validation normalized_cm: [[0.882 0.118]
 [0.941 0.059]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.8824969400244798, 0.05855855855855856]
Validation precision: 0.11926605504587157
Validation recall: 0.05855855855855856
Validation f1: 0.07854984894259819
Validation roc_auc: 0.5705668949243001
Validation avg_accuracy: 0.47052774929151914
Validation one_indexed_epoch: 3
Epoch 3/40
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
330/330 - 885s - accuracy: 0.7859 - student_loss: 0.2308 - distillation_loss: -6.1479e-04 - val_accuracy: 0.7064 - val_student_loss: 0.0032 - 885s/epoch - 3s/step
Validation cm: [[787  30]
 [212  10]]
Validation normalized_cm: [[0.963 0.037]
 [0.955 0.045]]
Validation acc: 0.7670837343599615
Validation class_accuracies: [0.9632802937576499, 0.04504504504504504]
Validation precision: 0.25
Validation recall: 0.04504504504504504
Validation f1: 0.07633587786259542
Validation roc_auc: 0.5962651758245393
Validation avg_accuracy: 0.5041626694013475
Validation one_indexed_epoch: 4
Epoch 4/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[609  10]
 [ 32   1]] 
Patient Normalized Confusion matrix: 
 [[0.984 0.016]
 [0.97  0.03 ]] 
Patient Validation accuracy: 
 93.56 
Patient Validation class accuracies: 
 [0.9838449111470113, 0.030303030303030304] 
Saving model...
330/330 - 886s - accuracy: 0.7983 - student_loss: 0.2123 - distillation_loss: -2.1472e-03 - val_accuracy: 0.7671 - val_student_loss: 0.0215 - 886s/epoch - 3s/step
Validation cm: [[791  26]
 [213   9]]
Validation normalized_cm: [[0.968 0.032]
 [0.959 0.041]]
Validation acc: 0.7699711260827719
Validation class_accuracies: [0.9681762545899633, 0.04054054054054054]
Validation precision: 0.2571428571428571
Validation recall: 0.04054054054054054
Validation f1: 0.07003891050583658
Validation roc_auc: 0.35490753911806544
Validation avg_accuracy: 0.5043583975652519
Validation one_indexed_epoch: 5
Epoch 5/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[612   7]
 [ 32   1]] 
Patient Normalized Confusion matrix: 
 [[0.989 0.011]
 [0.97  0.03 ]] 
Patient Validation accuracy: 
 94.02 
Patient Validation class accuracies: 
 [0.9886914378029079, 0.030303030303030304] 
Saving model...
330/330 - 878s - accuracy: 0.7965 - student_loss: 0.2451 - distillation_loss: -5.0251e-03 - val_accuracy: 0.7700 - val_student_loss: 8.7329e-04 - 878s/epoch - 3s/step
Validation cm: [[802  15]
 [218   4]]
Validation normalized_cm: [[0.982 0.018]
 [0.982 0.018]]
Validation acc: 0.7757459095283927
Validation class_accuracies: [0.981640146878825, 0.018018018018018018]
Validation precision: 0.21052631578947367
Validation recall: 0.018018018018018018
Validation f1: 0.03319502074688797
Validation roc_auc: 0.415153219314786
Validation avg_accuracy: 0.4998290824484215
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.5043583975652519 hasn't increased by 0 in 1 epochs
330/330 - 875s - accuracy: 0.7992 - student_loss: 0.5991 - distillation_loss: -2.5403e-03 - val_accuracy: 0.7757 - val_student_loss: 0.0000e+00 - 875s/epoch - 3s/step
Validation cm: [[709 108]
 [145  77]]
Validation normalized_cm: [[0.868 0.132]
 [0.653 0.347]]
Validation acc: 0.7564966313763234
Validation class_accuracies: [0.8678090575275398, 0.34684684684684686]
Validation precision: 0.41621621621621624
Validation recall: 0.34684684684684686
Validation f1: 0.3783783783783784
Validation roc_auc: 0.7665431649519776
Validation avg_accuracy: 0.6073279521871933
Validation one_indexed_epoch: 7
Epoch 7/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[586  33]
 [ 27   6]] 
Patient Normalized Confusion matrix: 
 [[0.947 0.053]
 [0.818 0.182]] 
Patient Validation accuracy: 
 90.80 
Patient Validation class accuracies: 
 [0.9466882067851373, 0.18181818181818182] 
Saving model...
330/330 - 877s - accuracy: 0.7960 - student_loss: 0.5791 - distillation_loss: 0.0093 - val_accuracy: 0.7565 - val_student_loss: 0.2755 - 877s/epoch - 3s/step
Validation cm: [[808   9]
 [218   4]]
Validation normalized_cm: [[0.989 0.011]
 [0.982 0.018]]
Validation acc: 0.7815206929740135
Validation class_accuracies: [0.988984088127295, 0.018018018018018018]
Validation precision: 0.3076923076923077
Validation recall: 0.018018018018018018
Validation f1: 0.03404255319148936
Validation roc_auc: 0.6473199025218609
Validation avg_accuracy: 0.5035010530726565
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.6073279521871933 hasn't increased by 0 in 1 epochs
330/330 - 876s - accuracy: 0.8060 - student_loss: 0.3115 - distillation_loss: -8.4552e-04 - val_accuracy: 0.7815 - val_student_loss: 0.0326 - 876s/epoch - 3s/step
Validation cm: [[791  26]
 [212  10]]
Validation normalized_cm: [[0.968 0.032]
 [0.955 0.045]]
Validation acc: 0.7709335899903753
Validation class_accuracies: [0.9681762545899633, 0.04504504504504504]
Validation precision: 0.2777777777777778
Validation recall: 0.04504504504504504
Validation f1: 0.07751937984496124
Validation roc_auc: 0.7296139468722087
Validation avg_accuracy: 0.5066106498175041
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.6073279521871933 hasn't increased by 0 in 2 epochs
330/330 - 879s - accuracy: 0.8043 - student_loss: 0.8327 - distillation_loss: -7.5751e-04 - val_accuracy: 0.7709 - val_student_loss: 0.1191 - 879s/epoch - 3s/step
Validation cm: [[778  39]
 [199  23]]
Validation normalized_cm: [[0.952 0.048]
 [0.896 0.104]]
Validation acc: 0.7709335899903753
Validation class_accuracies: [0.9522643818849449, 0.1036036036036036]
Validation precision: 0.3709677419354839
Validation recall: 0.1036036036036036
Validation f1: 0.1619718309859155
Validation roc_auc: 0.7350116334204461
Validation avg_accuracy: 0.5279339927442742
Validation one_indexed_epoch: 10
Epoch 10/40
The validation tracker metric at 0.6073279521871933 hasn't increased by 0 in 3 epochs
330/330 - 881s - accuracy: 0.8076 - student_loss: 0.2110 - distillation_loss: -1.5311e-03 - val_accuracy: 0.7709 - val_student_loss: 0.0823 - 881s/epoch - 3s/step
Validation cm: [[786  31]
 [217   5]]
Validation normalized_cm: [[0.962 0.038]
 [0.977 0.023]]
Validation acc: 0.7613089509143407
Validation class_accuracies: [0.9620563035495716, 0.02252252252252252]
Validation precision: 0.1388888888888889
Validation recall: 0.02252252252252252
Validation f1: 0.03875968992248062
Validation roc_auc: 0.5913140802981685
Validation avg_accuracy: 0.49228941303604706
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.6073279521871933 hasn't increased by 0 in 4 epochs
330/330 - 882s - accuracy: 0.8151 - student_loss: 0.1772 - distillation_loss: 0.0036 - val_accuracy: 0.7613 - val_student_loss: 0.0515 - 882s/epoch - 3s/step
Validation cm: [[799  18]
 [219   3]]
Validation normalized_cm: [[0.978 0.022]
 [0.986 0.014]]
Validation acc: 0.7718960538979788
Validation class_accuracies: [0.97796817625459, 0.013513513513513514]
Validation precision: 0.14285714285714285
Validation recall: 0.013513513513513514
Validation f1: 0.02469135802469136
Validation roc_auc: 0.5018139314344945
Validation avg_accuracy: 0.49574084488405173
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.6073279521871933 hasn't increased by 0 in 5 epochs
330/330 - 876s - accuracy: 0.8153 - student_loss: 1.2436 - distillation_loss: 0.0094 - val_accuracy: 0.7719 - val_student_loss: 3.3618e-05 - 876s/epoch - 3s/step
Validation cm: [[789  28]
 [208  14]]
Validation normalized_cm: [[0.966 0.034]
 [0.937 0.063]]
Validation acc: 0.7728585178055823
Validation class_accuracies: [0.9657282741738066, 0.06306306306306306]
Validation precision: 0.3333333333333333
Validation recall: 0.06306306306306306
Validation f1: 0.10606060606060606
Validation roc_auc: 0.6492165359974418
Validation avg_accuracy: 0.5143956686184348
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.6073279521871933 hasn't increased by 0 in 6 epochs
330/330 - 877s - accuracy: 0.8174 - student_loss: 1.0330 - distillation_loss: 0.0120 - val_accuracy: 0.7729 - val_student_loss: 0.1570 - 877s/epoch - 3s/step
Validation cm: [[609 208]
 [ 93 129]]
Validation normalized_cm: [[0.745 0.255]
 [0.419 0.581]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.7454100367197063, 0.581081081081081]
Validation precision: 0.3827893175074184
Validation recall: 0.581081081081081
Validation f1: 0.4615384615384615
Validation roc_auc: 0.7335009428032684
Validation avg_accuracy: 0.6632455589003936
Validation one_indexed_epoch: 14
Epoch 14/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[548  71]
 [ 23  10]] 
Patient Normalized Confusion matrix: 
 [[0.885 0.115]
 [0.697 0.303]] 
Patient Validation accuracy: 
 85.58 
Patient Validation class accuracies: 
 [0.8852988691437803, 0.30303030303030304] 
Saving model...
330/330 - 876s - accuracy: 0.8250 - student_loss: 0.2053 - distillation_loss: -3.9305e-03 - val_accuracy: 0.7103 - val_student_loss: 0.4069 - 876s/epoch - 3s/step
Validation cm: [[710 107]
 [142  80]]
Validation normalized_cm: [[0.869 0.131]
 [0.64  0.36 ]]
Validation acc: 0.7603464870067372
Validation class_accuracies: [0.8690330477356181, 0.36036036036036034]
Validation precision: 0.42780748663101603
Validation recall: 0.36036036036036034
Validation f1: 0.39119804400977987
Validation roc_auc: 0.6798328316076173
Validation avg_accuracy: 0.6146967040479892
Validation one_indexed_epoch: 15
Epoch 15/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 1 epochs
330/330 - 877s - accuracy: 0.8343 - student_loss: 0.2081 - distillation_loss: -4.9429e-04 - val_accuracy: 0.7603 - val_student_loss: 0.7752 - 877s/epoch - 3s/step
Validation cm: [[738  79]
 [178  44]]
Validation normalized_cm: [[0.903 0.097]
 [0.802 0.198]]
Validation acc: 0.7526467757459095
Validation class_accuracies: [0.9033047735618115, 0.1981981981981982]
Validation precision: 0.35772357723577236
Validation recall: 0.1981981981981982
Validation f1: 0.25507246376811593
Validation roc_auc: 0.6075788150451553
Validation avg_accuracy: 0.5507514858800049
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 2 epochs
330/330 - 875s - accuracy: 0.8317 - student_loss: 0.8756 - distillation_loss: 0.0045 - val_accuracy: 0.7526 - val_student_loss: 7.6430e-04 - 875s/epoch - 3s/step
Validation cm: [[781  36]
 [192  30]]
Validation normalized_cm: [[0.956 0.044]
 [0.865 0.135]]
Validation acc: 0.78055822906641
Validation class_accuracies: [0.95593635250918, 0.13513513513513514]
Validation precision: 0.45454545454545453
Validation recall: 0.13513513513513514
Validation f1: 0.20833333333333334
Validation roc_auc: 0.6789286226250731
Validation avg_accuracy: 0.5455357438221575
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 3 epochs
330/330 - 903s - accuracy: 0.8429 - student_loss: 0.4473 - distillation_loss: -6.3886e-03 - val_accuracy: 0.7806 - val_student_loss: 0.0330 - 903s/epoch - 3s/step
Validation cm: [[602 215]
 [102 120]]
Validation normalized_cm: [[0.737 0.263]
 [0.459 0.541]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.7368421052631579, 0.5405405405405406]
Validation precision: 0.3582089552238806
Validation recall: 0.5405405405405406
Validation f1: 0.4308797127468582
Validation roc_auc: 0.6758796740436888
Validation avg_accuracy: 0.6386913229018492
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 4 epochs
330/330 - 891s - accuracy: 0.8438 - student_loss: 0.1341 - distillation_loss: -2.6517e-04 - val_accuracy: 0.6949 - val_student_loss: 0.0404 - 891s/epoch - 3s/step
Validation cm: [[787  30]
 [215   7]]
Validation normalized_cm: [[0.963 0.037]
 [0.968 0.032]]
Validation acc: 0.7641963426371511
Validation class_accuracies: [0.9632802937576499, 0.03153153153153153]
Validation precision: 0.1891891891891892
Validation recall: 0.03153153153153153
Validation f1: 0.05405405405405405
Validation roc_auc: 0.42876597527760324
Validation avg_accuracy: 0.4974059126445907
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 5 epochs
330/330 - 875s - accuracy: 0.8478 - student_loss: 1.2360 - distillation_loss: 0.0071 - val_accuracy: 0.7642 - val_student_loss: 9.2048e-04 - 875s/epoch - 3s/step
Validation cm: [[791  26]
 [208  14]]
Validation normalized_cm: [[0.968 0.032]
 [0.937 0.063]]
Validation acc: 0.7747834456207893
Validation class_accuracies: [0.9681762545899633, 0.06306306306306306]
Validation precision: 0.35
Validation recall: 0.06306306306306306
Validation f1: 0.10687022900763357
Validation roc_auc: 0.48881868404512224
Validation avg_accuracy: 0.5156196588265132
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 6 epochs
330/330 - 883s - accuracy: 0.8527 - student_loss: 0.1712 - distillation_loss: -3.7099e-03 - val_accuracy: 0.7748 - val_student_loss: 0.0051 - 883s/epoch - 3s/step
Validation cm: [[795  22]
 [217   5]]
Validation normalized_cm: [[0.973 0.027]
 [0.977 0.023]]
Validation acc: 0.7699711260827719
Validation class_accuracies: [0.9730722154222766, 0.02252252252252252]
Validation precision: 0.18518518518518517
Validation recall: 0.02252252252252252
Validation f1: 0.040160642570281124
Validation roc_auc: 0.49169120160552227
Validation avg_accuracy: 0.49779736897239957
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 7 epochs
330/330 - 878s - accuracy: 0.8592 - student_loss: 0.4299 - distillation_loss: -3.4980e-03 - val_accuracy: 0.7700 - val_student_loss: 0.0032 - 878s/epoch - 3s/step
Validation cm: [[690 127]
 [125  97]]
Validation normalized_cm: [[0.845 0.155]
 [0.563 0.437]]
Validation acc: 0.7574590952839269
Validation class_accuracies: [0.8445532435740514, 0.4369369369369369]
Validation precision: 0.4330357142857143
Validation recall: 0.4369369369369369
Validation f1: 0.4349775784753363
Validation roc_auc: 0.6410510878075139
Validation avg_accuracy: 0.6407450902554941
Validation one_indexed_epoch: 22
Epoch 22/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 8 epochs
330/330 - 875s - accuracy: 0.8652 - student_loss: 0.2531 - distillation_loss: -4.3455e-03 - val_accuracy: 0.7575 - val_student_loss: 0.0251 - 875s/epoch - 3s/step
Validation cm: [[762  55]
 [180  42]]
Validation normalized_cm: [[0.933 0.067]
 [0.811 0.189]]
Validation acc: 0.7738209817131858
Validation class_accuracies: [0.9326805385556916, 0.1891891891891892]
Validation precision: 0.4329896907216495
Validation recall: 0.1891891891891892
Validation f1: 0.26332288401253917
Validation roc_auc: 0.5985477521585233
Validation avg_accuracy: 0.5609348638724404
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.6632455589003936 hasn't increased by 0 in 9 epochs
330/330 - 836s - accuracy: 0.8700 - student_loss: 0.2184 - distillation_loss: -3.7640e-03 - val_accuracy: 0.7738 - val_student_loss: 0.0014 - 836s/epoch - 3s/step
Validation cm: [[803  14]
 [214   8]]
Validation normalized_cm: [[0.983 0.017]
 [0.964 0.036]]
Validation acc: 0.78055822906641
Validation class_accuracies: [0.9828641370869033, 0.036036036036036036]
Validation precision: 0.36363636363636365
Validation recall: 0.036036036036036036
Validation f1: 0.06557377049180328
Validation roc_auc: 0.5594407136634798
Validation avg_accuracy: 0.5094500865614697
Validation one_indexed_epoch: 24
Epoch 24/40
The number of epochs since last 1% equals the patience
330/330 - 820s - accuracy: 0.8768 - student_loss: 0.1293 - distillation_loss: -2.8674e-03 - val_accuracy: 0.7806 - val_student_loss: 0.0141 - 820s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.6632455589003936
Best cm: [[609 208]
 [ 93 129]]
Best normalized_cm: [[0.745 0.255]
 [0.419 0.581]]
Best acc: 0.710298363811357
Best class_accuracies: [0.7454100367197063, 0.581081081081081]
Best precision: 0.3827893175074184
Best recall: 0.581081081081081
Best f1: 0.4615384615384615
Best roc_auc: 0.7335009428032684
Best one_indexed_epoch: 14
Best patient_cm: [[548  71]
 [ 23  10]]
Validation cm: [[750  82]
 [108  99]]
Validation normalized_cm: [[0.901 0.099]
 [0.522 0.478]]
Validation acc: 0.8171318575553417
Validation class_accuracies: [0.9014423076923077, 0.4782608695652174]
Validation precision: 0.5469613259668509
Validation recall: 0.4782608695652174
Validation f1: 0.5103092783505155
Validation roc_auc: 0.7489925910442214
Validation avg_accuracy: 0.6898515886287626
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
Job id is 2.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
3933
1336
832
207
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3933 0's, 1336 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 832 0's and 207 1's ---
Model: "leaf_mixednet_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_5 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_2 (Dense)                                 multiple                                    129              
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[552  28]
 [ 65   7]] 
Patient Normalized Confusion matrix: 
 [[0.952 0.048]
 [0.903 0.097]] 
Patient Validation accuracy: 
 85.74 
Patient Validation class accuracies: 
 [0.9517241379310345, 0.09722222222222222] 
Saving model...
330/330 - 518s - loss: 0.4848 - accuracy: 0.7863 - 518s/epoch - 2s/step
Validation cm: [[832   0]
 [206   1]]
Validation normalized_cm: [[1.    0.   ]
 [0.995 0.005]]
Validation acc: 0.8017324350336862
Validation class_accuracies: [1.0, 0.004830917874396135]
Validation precision: 1.0
Validation recall: 0.004830917874396135
Validation f1: 0.009615384615384614
Validation roc_auc: 0.6905628716090673
Validation avg_accuracy: 0.5024154589371981
Validation one_indexed_epoch: 2
Epoch 2/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 1 epochs
330/330 - 496s - loss: 0.4425 - accuracy: 0.8138 - 496s/epoch - 2s/step
Validation cm: [[799  33]
 [134  73]]
Validation normalized_cm: [[0.96  0.04 ]
 [0.647 0.353]]
Validation acc: 0.8392685274302214
Validation class_accuracies: [0.9603365384615384, 0.3526570048309179]
Validation precision: 0.6886792452830188
Validation recall: 0.3526570048309179
Validation f1: 0.46645367412140576
Validation roc_auc: 0.8484967251950947
Validation avg_accuracy: 0.6564967716462282
Validation one_indexed_epoch: 3
Epoch 3/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 2 epochs
330/330 - 499s - loss: 0.4274 - accuracy: 0.8136 - 499s/epoch - 2s/step
Validation cm: [[826   6]
 [185  22]]
Validation normalized_cm: [[0.993 0.007]
 [0.894 0.106]]
Validation acc: 0.8161693936477382
Validation class_accuracies: [0.9927884615384616, 0.10628019323671498]
Validation precision: 0.7857142857142857
Validation recall: 0.10628019323671498
Validation f1: 0.18723404255319148
Validation roc_auc: 0.6590980351170568
Validation avg_accuracy: 0.5495343273875882
Validation one_indexed_epoch: 4
Epoch 4/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 3 epochs
330/330 - 498s - loss: 0.4207 - accuracy: 0.8199 - 498s/epoch - 2s/step
Validation cm: [[791  41]
 [119  88]]
Validation normalized_cm: [[0.951 0.049]
 [0.575 0.425]]
Validation acc: 0.8460057747834456
Validation class_accuracies: [0.9507211538461539, 0.4251207729468599]
Validation precision: 0.6821705426356589
Validation recall: 0.4251207729468599
Validation f1: 0.5238095238095238
Validation roc_auc: 0.8020804301374953
Validation avg_accuracy: 0.6879209633965069
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 4 epochs
330/330 - 501s - loss: 0.4018 - accuracy: 0.8277 - 501s/epoch - 2s/step
Validation cm: [[802  30]
 [170  37]]
Validation normalized_cm: [[0.964 0.036]
 [0.821 0.179]]
Validation acc: 0.8075072184793071
Validation class_accuracies: [0.9639423076923077, 0.178743961352657]
Validation precision: 0.5522388059701493
Validation recall: 0.178743961352657
Validation f1: 0.2700729927007299
Validation roc_auc: 0.779075506317354
Validation avg_accuracy: 0.5713431345224823
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 5 epochs
330/330 - 509s - loss: 0.3909 - accuracy: 0.8296 - 509s/epoch - 2s/step
Validation cm: [[800  32]
 [135  72]]
Validation normalized_cm: [[0.962 0.038]
 [0.652 0.348]]
Validation acc: 0.8392685274302214
Validation class_accuracies: [0.9615384615384616, 0.34782608695652173]
Validation precision: 0.6923076923076923
Validation recall: 0.34782608695652173
Validation f1: 0.4630225080385852
Validation roc_auc: 0.8501631596060942
Validation avg_accuracy: 0.6546822742474916
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 6 epochs
330/330 - 502s - loss: 0.3884 - accuracy: 0.8337 - 502s/epoch - 2s/step
Validation cm: [[781  51]
 [116  91]]
Validation normalized_cm: [[0.939 0.061]
 [0.56  0.44 ]]
Validation acc: 0.8392685274302214
Validation class_accuracies: [0.9387019230769231, 0.4396135265700483]
Validation precision: 0.6408450704225352
Validation recall: 0.4396135265700483
Validation f1: 0.5214899713467048
Validation roc_auc: 0.83056658769974
Validation avg_accuracy: 0.6891577248234857
Validation one_indexed_epoch: 8
Epoch 8/40
The validation tracker metric at 0.6898515886287626 hasn't increased by 0 in 7 epochs
330/330 - 500s - loss: 0.3765 - accuracy: 0.8392 - 500s/epoch - 2s/step
Validation cm: [[772  60]
 [103 104]]
Validation normalized_cm: [[0.928 0.072]
 [0.498 0.502]]
Validation acc: 0.8431183830606352
Validation class_accuracies: [0.9278846153846154, 0.5024154589371981]
Validation precision: 0.6341463414634146
Validation recall: 0.5024154589371981
Validation f1: 0.5606469002695417
Validation roc_auc: 0.8376852238944631
Validation avg_accuracy: 0.7151500371609067
Validation one_indexed_epoch: 9
Epoch 9/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[552  28]
 [ 43  29]] 
Patient Normalized Confusion matrix: 
 [[0.952 0.048]
 [0.597 0.403]] 
Patient Validation accuracy: 
 89.11 
Patient Validation class accuracies: 
 [0.9517241379310345, 0.4027777777777778] 
Saving model...
330/330 - 539s - loss: 0.3669 - accuracy: 0.8468 - 539s/epoch - 2s/step
Validation cm: [[805  27]
 [138  69]]
Validation normalized_cm: [[0.968 0.032]
 [0.667 0.333]]
Validation acc: 0.8411934552454283
Validation class_accuracies: [0.9675480769230769, 0.3333333333333333]
Validation precision: 0.71875
Validation recall: 0.3333333333333333
Validation f1: 0.45544554455445546
Validation roc_auc: 0.8292427303976219
Validation avg_accuracy: 0.6504407051282051
Validation one_indexed_epoch: 10
Epoch 10/40
The validation tracker metric at 0.7151500371609067 hasn't increased by 0 in 1 epochs
330/330 - 553s - loss: 0.3574 - accuracy: 0.8495 - 553s/epoch - 2s/step
Validation cm: [[788  44]
 [109  98]]
Validation normalized_cm: [[0.947 0.053]
 [0.527 0.473]]
Validation acc: 0.8527430221366699
Validation class_accuracies: [0.9471153846153846, 0.47342995169082125]
Validation precision: 0.6901408450704225
Validation recall: 0.47342995169082125
Validation f1: 0.5616045845272207
Validation roc_auc: 0.8437993543292456
Validation avg_accuracy: 0.7102726681531029
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.7151500371609067 hasn't increased by 0 in 2 epochs
330/330 - 549s - loss: 0.3396 - accuracy: 0.8613 - 549s/epoch - 2s/step
Validation cm: [[795  37]
 [113  94]]
Validation normalized_cm: [[0.956 0.044]
 [0.546 0.454]]
Validation acc: 0.8556304138594802
Validation class_accuracies: [0.9555288461538461, 0.45410628019323673]
Validation precision: 0.7175572519083969
Validation recall: 0.45410628019323673
Validation f1: 0.5562130177514794
Validation roc_auc: 0.8520850752508361
Validation avg_accuracy: 0.7048175631735414
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.7151500371609067 hasn't increased by 0 in 3 epochs
330/330 - 557s - loss: 0.3267 - accuracy: 0.8689 - 557s/epoch - 2s/step
Validation cm: [[820  12]
 [163  44]]
Validation normalized_cm: [[0.986 0.014]
 [0.787 0.213]]
Validation acc: 0.8315688161693936
Validation class_accuracies: [0.9855769230769231, 0.21256038647342995]
Validation precision: 0.7857142857142857
Validation recall: 0.21256038647342995
Validation f1: 0.33460076045627374
Validation roc_auc: 0.8208118496841323
Validation avg_accuracy: 0.5990686547751766
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.7151500371609067 hasn't increased by 0 in 4 epochs
330/330 - 552s - loss: 0.3071 - accuracy: 0.8764 - 552s/epoch - 2s/step
Validation cm: [[794  38]
 [120  87]]
Validation normalized_cm: [[0.954 0.046]
 [0.58  0.42 ]]
Validation acc: 0.8479307025986526
Validation class_accuracies: [0.9543269230769231, 0.42028985507246375]
Validation precision: 0.696
Validation recall: 0.42028985507246375
Validation f1: 0.5240963855421686
Validation roc_auc: 0.8492225241545894
Validation avg_accuracy: 0.6873083890746934
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.7151500371609067 hasn't increased by 0 in 5 epochs
330/330 - 555s - loss: 0.2968 - accuracy: 0.8761 - 555s/epoch - 2s/step
Validation cm: [[787  45]
 [ 94 113]]
Validation normalized_cm: [[0.946 0.054]
 [0.454 0.546]]
Validation acc: 0.8662175168431184
Validation class_accuracies: [0.9459134615384616, 0.5458937198067633]
Validation precision: 0.7151898734177216
Validation recall: 0.5458937198067633
Validation f1: 0.6191780821917808
Validation roc_auc: 0.8523753948346339
Validation avg_accuracy: 0.7459035906726124
Validation one_indexed_epoch: 15
Epoch 15/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[572   8]
 [ 48  24]] 
Patient Normalized Confusion matrix: 
 [[0.986 0.014]
 [0.667 0.333]] 
Patient Validation accuracy: 
 91.41 
Patient Validation class accuracies: 
 [0.9862068965517241, 0.3333333333333333] 
Saving model...
330/330 - 557s - loss: 0.2929 - accuracy: 0.8764 - 557s/epoch - 2s/step
Validation cm: [[832   0]
 [206   1]]
Validation normalized_cm: [[1.    0.   ]
 [0.995 0.005]]
Validation acc: 0.8017324350336862
Validation class_accuracies: [1.0, 0.004830917874396135]
Validation precision: 1.0
Validation recall: 0.004830917874396135
Validation f1: 0.009615384615384614
Validation roc_auc: 0.548892721107395
Validation avg_accuracy: 0.5024154589371981
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 1 epochs
330/330 - 551s - loss: 0.2799 - accuracy: 0.8825 - 551s/epoch - 2s/step
Validation cm: [[824   8]
 [187  20]]
Validation normalized_cm: [[0.99  0.01 ]
 [0.903 0.097]]
Validation acc: 0.8123195380173244
Validation class_accuracies: [0.9903846153846154, 0.0966183574879227]
Validation precision: 0.7142857142857143
Validation recall: 0.0966183574879227
Validation f1: 0.1702127659574468
Validation roc_auc: 0.836616847826087
Validation avg_accuracy: 0.543501486436269
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 2 epochs
330/330 - 553s - loss: 0.2994 - accuracy: 0.8761 - 553s/epoch - 2s/step
Validation cm: [[760  72]
 [105 102]]
Validation normalized_cm: [[0.913 0.087]
 [0.507 0.493]]
Validation acc: 0.8296438883541867
Validation class_accuracies: [0.9134615384615384, 0.4927536231884058]
Validation precision: 0.5862068965517241
Validation recall: 0.4927536231884058
Validation f1: 0.5354330708661417
Validation roc_auc: 0.8253756735414344
Validation avg_accuracy: 0.7031075808249722
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 3 epochs
330/330 - 546s - loss: 0.2577 - accuracy: 0.8962 - 546s/epoch - 2s/step
Validation cm: [[788  44]
 [108  99]]
Validation normalized_cm: [[0.947 0.053]
 [0.522 0.478]]
Validation acc: 0.8537054860442733
Validation class_accuracies: [0.9471153846153846, 0.4782608695652174]
Validation precision: 0.6923076923076923
Validation recall: 0.4782608695652174
Validation f1: 0.5657142857142856
Validation roc_auc: 0.8423303372352285
Validation avg_accuracy: 0.7126881270903009
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 4 epochs
330/330 - 550s - loss: 0.2306 - accuracy: 0.9081 - 550s/epoch - 2s/step
Validation cm: [[785  47]
 [121  86]]
Validation normalized_cm: [[0.944 0.056]
 [0.585 0.415]]
Validation acc: 0.8383060635226179
Validation class_accuracies: [0.9435096153846154, 0.41545893719806765]
Validation precision: 0.6466165413533834
Validation recall: 0.41545893719806765
Validation f1: 0.5058823529411764
Validation roc_auc: 0.8334872027127462
Validation avg_accuracy: 0.6794842762913416
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 5 epochs
330/330 - 558s - loss: 0.2325 - accuracy: 0.9026 - 558s/epoch - 2s/step
Validation cm: [[793  39]
 [135  72]]
Validation normalized_cm: [[0.953 0.047]
 [0.652 0.348]]
Validation acc: 0.8325312800769971
Validation class_accuracies: [0.953125, 0.34782608695652173]
Validation precision: 0.6486486486486487
Validation recall: 0.34782608695652173
Validation f1: 0.4528301886792453
Validation roc_auc: 0.8283833844295801
Validation avg_accuracy: 0.6504755434782609
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 6 epochs
330/330 - 582s - loss: 0.2330 - accuracy: 0.9043 - 582s/epoch - 2s/step
Validation cm: [[753  79]
 [ 97 110]]
Validation normalized_cm: [[0.905 0.095]
 [0.469 0.531]]
Validation acc: 0.8306063522617901
Validation class_accuracies: [0.9050480769230769, 0.5314009661835749]
Validation precision: 0.582010582010582
Validation recall: 0.5314009661835749
Validation f1: 0.5555555555555556
Validation roc_auc: 0.8245511659234487
Validation avg_accuracy: 0.7182245215533258
Validation one_indexed_epoch: 22
Epoch 22/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 7 epochs
330/330 - 580s - loss: 0.2065 - accuracy: 0.9199 - 580s/epoch - 2s/step
Validation cm: [[779  53]
 [119  88]]
Validation normalized_cm: [[0.936 0.064]
 [0.575 0.425]]
Validation acc: 0.8344562078922041
Validation class_accuracies: [0.9362980769230769, 0.4251207729468599]
Validation precision: 0.624113475177305
Validation recall: 0.4251207729468599
Validation f1: 0.5057471264367815
Validation roc_auc: 0.8194299284652545
Validation avg_accuracy: 0.6807094249349683
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 8 epochs
330/330 - 576s - loss: 0.1946 - accuracy: 0.9231 - 576s/epoch - 2s/step
Validation cm: [[831   1]
 [205   2]]
Validation normalized_cm: [[0.999 0.001]
 [0.99  0.01 ]]
Validation acc: 0.8017324350336862
Validation class_accuracies: [0.9987980769230769, 0.00966183574879227]
Validation precision: 0.6666666666666666
Validation recall: 0.00966183574879227
Validation f1: 0.019047619047619046
Validation roc_auc: 0.7385933435525827
Validation avg_accuracy: 0.5042299563359346
Validation one_indexed_epoch: 24
Epoch 24/40
The validation tracker metric at 0.7459035906726124 hasn't increased by 0 in 9 epochs
330/330 - 574s - loss: 0.1729 - accuracy: 0.9351 - 574s/epoch - 2s/step
Validation cm: [[733  99]
 [ 86 121]]
Validation normalized_cm: [[0.881 0.119]
 [0.415 0.585]]
Validation acc: 0.821944177093359
Validation class_accuracies: [0.8810096153846154, 0.5845410628019324]
Validation precision: 0.55
Validation recall: 0.5845410628019324
Validation f1: 0.5667447306791569
Validation roc_auc: 0.8295736947231513
Validation avg_accuracy: 0.7327753390932739
Validation one_indexed_epoch: 25
Epoch 25/40
The number of epochs since last 1% equals the patience
330/330 - 581s - loss: 0.1685 - accuracy: 0.9326 - 581s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.7459035906726124
Best cm: [[787  45]
 [ 94 113]]
Best normalized_cm: [[0.946 0.054]
 [0.454 0.546]]
Best acc: 0.8662175168431184
Best class_accuracies: [0.9459134615384616, 0.5458937198067633]
Best precision: 0.7151898734177216
Best recall: 0.5458937198067633
Best f1: 0.6191780821917808
Best roc_auc: 0.8523753948346339
Best one_indexed_epoch: 15
Best patient_cm: [[572   8]
 [ 48  24]]
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.5916364734299516
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
Model: "leaf_model9_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization_16 (BatchNormalization)     multiple                                    4                
                                                                                                              
 sequential_6 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_7 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_8 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate_1 (Concatenate)                     multiple                                    0                
                                                                                                              
 sequential_9 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_3 (Dense)                                 multiple                                    513              
                                                                                                              
==============================================================================================================
Total params: 6,201,205
Trainable params: 6,159,699
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[580   0]
 [ 72   0]] 
Patient Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]] 
Patient Validation accuracy: 
 88.96 
Patient Validation class accuracies: 
 [1.0, 0.0] 
Saving model...
330/330 - 916s - accuracy: 0.7305 - student_loss: 0.4662 - distillation_loss: -5.7159e-03 - val_accuracy: 0.8008 - val_student_loss: 0.4575 - 916s/epoch - 3s/step
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.47370575529542924
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 2
Epoch 2/40
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
330/330 - 825s - accuracy: 0.7776 - student_loss: 0.6563 - distillation_loss: -7.2985e-03 - val_accuracy: 0.8008 - val_student_loss: 0.0016 - 825s/epoch - 2s/step
Validation cm: [[617 215]
 [128  79]]
Validation normalized_cm: [[0.742 0.258]
 [0.618 0.382]]
Validation acc: 0.6698748796920115
Validation class_accuracies: [0.7415865384615384, 0.38164251207729466]
Validation precision: 0.2687074829931973
Validation recall: 0.38164251207729466
Validation f1: 0.3153692614770459
Validation roc_auc: 0.6085533955778522
Validation avg_accuracy: 0.5616145252694166
Validation one_indexed_epoch: 3
Epoch 3/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[476 104]
 [ 58  14]] 
Patient Normalized Confusion matrix: 
 [[0.821 0.179]
 [0.806 0.194]] 
Patient Validation accuracy: 
 75.15 
Patient Validation class accuracies: 
 [0.8206896551724138, 0.19444444444444445] 
Saving model...
330/330 - 808s - accuracy: 0.7946 - student_loss: 0.7186 - distillation_loss: 9.0516e-04 - val_accuracy: 0.6699 - val_student_loss: 1.9257 - 808s/epoch - 2s/step
Validation cm: [[828   4]
 [207   0]]
Validation normalized_cm: [[0.995 0.005]
 [1.    0.   ]]
Validation acc: 0.7969201154956689
Validation class_accuracies: [0.9951923076923077, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.6327486296915644
Validation avg_accuracy: 0.49759615384615385
Validation one_indexed_epoch: 4
Epoch 4/40
The validation tracker metric at 0.5616145252694166 hasn't increased by 0 in 1 epochs
330/330 - 836s - accuracy: 0.7899 - student_loss: 0.4170 - distillation_loss: -1.7114e-03 - val_accuracy: 0.7969 - val_student_loss: 0.0874 - 836s/epoch - 3s/step
Validation cm: [[679 153]
 [161  46]]
Validation normalized_cm: [[0.816 0.184]
 [0.778 0.222]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.8161057692307693, 0.2222222222222222]
Validation precision: 0.23115577889447236
Validation recall: 0.2222222222222222
Validation f1: 0.22660098522167488
Validation roc_auc: 0.627424168524712
Validation avg_accuracy: 0.5191639957264957
Validation one_indexed_epoch: 5
Epoch 5/40
The validation tracker metric at 0.5616145252694166 hasn't increased by 0 in 2 epochs
330/330 - 841s - accuracy: 0.7939 - student_loss: 0.3957 - distillation_loss: -4.6535e-03 - val_accuracy: 0.6978 - val_student_loss: 0.4925 - 841s/epoch - 3s/step
Validation cm: [[831   1]
 [207   0]]
Validation normalized_cm: [[0.999 0.001]
 [1.    0.   ]]
Validation acc: 0.7998075072184793
Validation class_accuracies: [0.9987980769230769, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.6853719574507618
Validation avg_accuracy: 0.49939903846153844
Validation one_indexed_epoch: 6
Epoch 6/40
The validation tracker metric at 0.5616145252694166 hasn't increased by 0 in 3 epochs
330/330 - 842s - accuracy: 0.7973 - student_loss: 0.3857 - distillation_loss: 0.0026 - val_accuracy: 0.7998 - val_student_loss: 0.0680 - 842s/epoch - 3s/step
Validation cm: [[142 690]
 [ 21 186]]
Validation normalized_cm: [[0.171 0.829]
 [0.101 0.899]]
Validation acc: 0.3156881616939365
Validation class_accuracies: [0.17067307692307693, 0.8985507246376812]
Validation precision: 0.21232876712328766
Validation recall: 0.8985507246376812
Validation f1: 0.34349030470914127
Validation roc_auc: 0.5858213721664809
Validation avg_accuracy: 0.534611900780379
Validation one_indexed_epoch: 7
Epoch 7/40
The validation tracker metric at 0.5616145252694166 hasn't increased by 0 in 4 epochs
330/330 - 839s - accuracy: 0.7983 - student_loss: 0.1022 - distillation_loss: -1.7053e-03 - val_accuracy: 0.3157 - val_student_loss: 15.2492 - 839s/epoch - 3s/step
Validation cm: [[799  33]
 [169  38]]
Validation normalized_cm: [[0.96  0.04 ]
 [0.816 0.184]]
Validation acc: 0.8055822906641001
Validation class_accuracies: [0.9603365384615384, 0.18357487922705315]
Validation precision: 0.5352112676056338
Validation recall: 0.18357487922705315
Validation f1: 0.2733812949640288
Validation roc_auc: 0.5158369332961724
Validation avg_accuracy: 0.5719557088442958
Validation one_indexed_epoch: 8
Epoch 8/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[557  23]
 [ 54  18]] 
Patient Normalized Confusion matrix: 
 [[0.96 0.04]
 [0.75 0.25]] 
Patient Validation accuracy: 
 88.19 
Patient Validation class accuracies: 
 [0.9603448275862069, 0.25] 
Saving model...
330/330 - 837s - accuracy: 0.8019 - student_loss: 0.4394 - distillation_loss: -1.6752e-03 - val_accuracy: 0.8056 - val_student_loss: 1.6689e-06 - 837s/epoch - 3s/step
Validation cm: [[832   0]
 [206   1]]
Validation normalized_cm: [[1.    0.   ]
 [0.995 0.005]]
Validation acc: 0.8017324350336862
Validation class_accuracies: [1.0, 0.004830917874396135]
Validation precision: 1.0
Validation recall: 0.004830917874396135
Validation f1: 0.009615384615384614
Validation roc_auc: 0.6013592762913416
Validation avg_accuracy: 0.5024154589371981
Validation one_indexed_epoch: 9
Epoch 9/40
The validation tracker metric at 0.5719557088442958 hasn't increased by 0 in 1 epochs
330/330 - 836s - accuracy: 0.8077 - student_loss: 0.3266 - distillation_loss: -3.6603e-03 - val_accuracy: 0.8017 - val_student_loss: 0.1181 - 836s/epoch - 3s/step
Validation cm: [[792  40]
 [158  49]]
Validation normalized_cm: [[0.952 0.048]
 [0.763 0.237]]
Validation acc: 0.809432146294514
Validation class_accuracies: [0.9519230769230769, 0.23671497584541062]
Validation precision: 0.550561797752809
Validation recall: 0.23671497584541062
Validation f1: 0.33108108108108114
Validation roc_auc: 0.7131555416202155
Validation avg_accuracy: 0.5943190263842437
Validation one_indexed_epoch: 10
Epoch 10/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[555  25]
 [ 58  14]] 
Patient Normalized Confusion matrix: 
 [[0.957 0.043]
 [0.806 0.194]] 
Patient Validation accuracy: 
 87.27 
Patient Validation class accuracies: 
 [0.9568965517241379, 0.19444444444444445] 
Saving model...
330/330 - 835s - accuracy: 0.8093 - student_loss: 0.3284 - distillation_loss: -6.1379e-03 - val_accuracy: 0.8094 - val_student_loss: 0.1273 - 835s/epoch - 3s/step
Validation cm: [[810  22]
 [175  32]]
Validation normalized_cm: [[0.974 0.026]
 [0.845 0.155]]
Validation acc: 0.8103946102021174
Validation class_accuracies: [0.9735576923076923, 0.15458937198067632]
Validation precision: 0.5925925925925926
Validation recall: 0.15458937198067632
Validation f1: 0.24521072796934865
Validation roc_auc: 0.6306351031215162
Validation avg_accuracy: 0.5640735321441843
Validation one_indexed_epoch: 11
Epoch 11/40
The validation tracker metric at 0.5943190263842437 hasn't increased by 0 in 1 epochs
330/330 - 836s - accuracy: 0.8169 - student_loss: 0.3446 - distillation_loss: 0.0029 - val_accuracy: 0.8104 - val_student_loss: 0.2544 - 836s/epoch - 3s/step
Validation cm: [[829   3]
 [188  19]]
Validation normalized_cm: [[0.996 0.004]
 [0.908 0.092]]
Validation acc: 0.8161693936477382
Validation class_accuracies: [0.9963942307692307, 0.09178743961352658]
Validation precision: 0.8636363636363636
Validation recall: 0.09178743961352658
Validation f1: 0.16593886462882096
Validation roc_auc: 0.7153851960237829
Validation avg_accuracy: 0.5440908351913787
Validation one_indexed_epoch: 12
Epoch 12/40
The validation tracker metric at 0.5943190263842437 hasn't increased by 0 in 2 epochs
330/330 - 836s - accuracy: 0.8182 - student_loss: 1.0550 - distillation_loss: 0.0022 - val_accuracy: 0.8162 - val_student_loss: 0.0041 - 836s/epoch - 3s/step
Validation cm: [[817  15]
 [195  12]]
Validation normalized_cm: [[0.982 0.018]
 [0.942 0.058]]
Validation acc: 0.7978825794032723
Validation class_accuracies: [0.9819711538461539, 0.057971014492753624]
Validation precision: 0.4444444444444444
Validation recall: 0.057971014492753624
Validation f1: 0.10256410256410256
Validation roc_auc: 0.6251829013377925
Validation avg_accuracy: 0.5199710841694537
Validation one_indexed_epoch: 13
Epoch 13/40
The validation tracker metric at 0.5943190263842437 hasn't increased by 0 in 3 epochs
330/330 - 837s - accuracy: 0.8148 - student_loss: 0.4926 - distillation_loss: -1.2780e-03 - val_accuracy: 0.7979 - val_student_loss: 0.0496 - 837s/epoch - 3s/step
Validation cm: [[799  33]
 [160  47]]
Validation normalized_cm: [[0.96  0.04 ]
 [0.773 0.227]]
Validation acc: 0.8142444658325313
Validation class_accuracies: [0.9603365384615384, 0.22705314009661837]
Validation precision: 0.5875
Validation recall: 0.22705314009661837
Validation f1: 0.32752613240418116
Validation roc_auc: 0.6934370354886659
Validation avg_accuracy: 0.5936948392790784
Validation one_indexed_epoch: 14
Epoch 14/40
The validation tracker metric at 0.5943190263842437 hasn't increased by 0 in 4 epochs
330/330 - 822s - accuracy: 0.8199 - student_loss: 0.2860 - distillation_loss: -5.3199e-03 - val_accuracy: 0.8142 - val_student_loss: 0.0897 - 822s/epoch - 2s/step
Validation cm: [[634 198]
 [ 77 130]]
Validation normalized_cm: [[0.762 0.238]
 [0.372 0.628]]
Validation acc: 0.7353224254090471
Validation class_accuracies: [0.7620192307692307, 0.6280193236714976]
Validation precision: 0.39634146341463417
Validation recall: 0.6280193236714976
Validation f1: 0.48598130841121495
Validation roc_auc: 0.7519248188405797
Validation avg_accuracy: 0.6950192772203642
Validation one_indexed_epoch: 15
Epoch 15/40
-- New best results were achieved. --
Patient Confusion matrix: 
 [[440 140]
 [ 25  47]] 
Patient Normalized Confusion matrix: 
 [[0.759 0.241]
 [0.347 0.653]] 
Patient Validation accuracy: 
 74.69 
Patient Validation class accuracies: 
 [0.7586206896551724, 0.6527777777777778] 
Saving model...
330/330 - 797s - accuracy: 0.8216 - student_loss: 0.4230 - distillation_loss: -1.0825e-03 - val_accuracy: 0.7353 - val_student_loss: 0.2425 - 797s/epoch - 2s/step
Validation cm: [[755  77]
 [144  63]]
Validation normalized_cm: [[0.907 0.093]
 [0.696 0.304]]
Validation acc: 0.7872954764196343
Validation class_accuracies: [0.9074519230769231, 0.30434782608695654]
Validation precision: 0.45
Validation recall: 0.30434782608695654
Validation f1: 0.3631123919308358
Validation roc_auc: 0.612612063359346
Validation avg_accuracy: 0.6058998745819398
Validation one_indexed_epoch: 16
Epoch 16/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 1 epochs
330/330 - 799s - accuracy: 0.8273 - student_loss: 0.8176 - distillation_loss: 0.0093 - val_accuracy: 0.7873 - val_student_loss: 2.2080e-04 - 799s/epoch - 2s/step
Validation cm: [[707 125]
 [132  75]]
Validation normalized_cm: [[0.85  0.15 ]
 [0.638 0.362]]
Validation acc: 0.7526467757459095
Validation class_accuracies: [0.8497596153846154, 0.36231884057971014]
Validation precision: 0.375
Validation recall: 0.36231884057971014
Validation f1: 0.3685503685503685
Validation roc_auc: 0.621228748606466
Validation avg_accuracy: 0.6060392279821628
Validation one_indexed_epoch: 17
Epoch 17/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 2 epochs
330/330 - 797s - accuracy: 0.8313 - student_loss: 0.5445 - distillation_loss: 0.0015 - val_accuracy: 0.7526 - val_student_loss: 0.0400 - 797s/epoch - 2s/step
Validation cm: [[737  95]
 [114  93]]
Validation normalized_cm: [[0.886 0.114]
 [0.551 0.449]]
Validation acc: 0.7988450433108758
Validation class_accuracies: [0.8858173076923077, 0.4492753623188406]
Validation precision: 0.4946808510638298
Validation recall: 0.4492753623188406
Validation f1: 0.4708860759493671
Validation roc_auc: 0.7677123978075064
Validation avg_accuracy: 0.6675463350055741
Validation one_indexed_epoch: 18
Epoch 18/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 3 epochs
330/330 - 797s - accuracy: 0.8375 - student_loss: 0.2333 - distillation_loss: -8.7318e-04 - val_accuracy: 0.7988 - val_student_loss: 0.0233 - 797s/epoch - 2s/step
Validation cm: [[744  88]
 [144  63]]
Validation normalized_cm: [[0.894 0.106]
 [0.696 0.304]]
Validation acc: 0.7767083734359962
Validation class_accuracies: [0.8942307692307693, 0.30434782608695654]
Validation precision: 0.41721854304635764
Validation recall: 0.30434782608695654
Validation f1: 0.35195530726256985
Validation roc_auc: 0.6257112829803047
Validation avg_accuracy: 0.5992892976588629
Validation one_indexed_epoch: 19
Epoch 19/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 4 epochs
330/330 - 798s - accuracy: 0.8375 - student_loss: 0.3083 - distillation_loss: -2.5468e-03 - val_accuracy: 0.7767 - val_student_loss: 0.0083 - 798s/epoch - 2s/step
Validation cm: [[808  24]
 [164  43]]
Validation normalized_cm: [[0.971 0.029]
 [0.792 0.208]]
Validation acc: 0.8190567853705486
Validation class_accuracies: [0.9711538461538461, 0.20772946859903382]
Validation precision: 0.6417910447761194
Validation recall: 0.20772946859903382
Validation f1: 0.31386861313868614
Validation roc_auc: 0.6854880852842811
Validation avg_accuracy: 0.5894416573764399
Validation one_indexed_epoch: 20
Epoch 20/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 5 epochs
330/330 - 803s - accuracy: 0.8539 - student_loss: 0.3558 - distillation_loss: -4.1215e-03 - val_accuracy: 0.8191 - val_student_loss: 7.8530e-04 - 803s/epoch - 2s/step
Validation cm: [[676 156]
 [ 94 113]]
Validation normalized_cm: [[0.812 0.188]
 [0.454 0.546]]
Validation acc: 0.7593840230991338
Validation class_accuracies: [0.8125, 0.5458937198067633]
Validation precision: 0.4200743494423792
Validation recall: 0.5458937198067633
Validation f1: 0.47478991596638653
Validation roc_auc: 0.7474771228167968
Validation avg_accuracy: 0.6791968599033816
Validation one_indexed_epoch: 21
Epoch 21/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 6 epochs
330/330 - 796s - accuracy: 0.8584 - student_loss: 0.7870 - distillation_loss: 0.0043 - val_accuracy: 0.7594 - val_student_loss: 0.8399 - 796s/epoch - 2s/step
Validation cm: [[790  42]
 [160  47]]
Validation normalized_cm: [[0.95  0.05 ]
 [0.773 0.227]]
Validation acc: 0.8055822906641001
Validation class_accuracies: [0.9495192307692307, 0.22705314009661837]
Validation precision: 0.5280898876404494
Validation recall: 0.22705314009661837
Validation f1: 0.31756756756756754
Validation roc_auc: 0.7045330499814195
Validation avg_accuracy: 0.5882861854329245
Validation one_indexed_epoch: 22
Epoch 22/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 7 epochs
330/330 - 797s - accuracy: 0.8645 - student_loss: 1.0560 - distillation_loss: 0.0017 - val_accuracy: 0.8056 - val_student_loss: 0.0160 - 797s/epoch - 2s/step
Validation cm: [[813  19]
 [173  34]]
Validation normalized_cm: [[0.977 0.023]
 [0.836 0.164]]
Validation acc: 0.8152069297401348
Validation class_accuracies: [0.9771634615384616, 0.1642512077294686]
Validation precision: 0.6415094339622641
Validation recall: 0.1642512077294686
Validation f1: 0.26153846153846155
Validation roc_auc: 0.6906964186176142
Validation avg_accuracy: 0.5707073346339651
Validation one_indexed_epoch: 23
Epoch 23/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 8 epochs
330/330 - 797s - accuracy: 0.8548 - student_loss: 0.1131 - distillation_loss: 0.0048 - val_accuracy: 0.8152 - val_student_loss: 0.0041 - 797s/epoch - 2s/step
Validation cm: [[823   9]
 [164  43]]
Validation normalized_cm: [[0.989 0.011]
 [0.792 0.208]]
Validation acc: 0.8334937439846006
Validation class_accuracies: [0.9891826923076923, 0.20772946859903382]
Validation precision: 0.8269230769230769
Validation recall: 0.20772946859903382
Validation f1: 0.33204633204633205
Validation roc_auc: 0.7472622863247863
Validation avg_accuracy: 0.5984560804533631
Validation one_indexed_epoch: 24
Epoch 24/40
The validation tracker metric at 0.6950192772203642 hasn't increased by 0 in 9 epochs
330/330 - 798s - accuracy: 0.8694 - student_loss: 0.5463 - distillation_loss: 0.0051 - val_accuracy: 0.8335 - val_student_loss: 6.4817e-04 - 798s/epoch - 2s/step
Validation cm: [[513 319]
 [ 50 157]]
Validation normalized_cm: [[0.617 0.383]
 [0.242 0.758]]
Validation acc: 0.6448508180943214
Validation class_accuracies: [0.6165865384615384, 0.7584541062801933]
Validation precision: 0.32983193277310924
Validation recall: 0.7584541062801933
Validation f1: 0.4597364568081991
Validation roc_auc: 0.7692278660349312
Validation avg_accuracy: 0.6875203223708659
Validation one_indexed_epoch: 25
Epoch 25/40
The number of epochs since last 1% equals the patience
330/330 - 798s - accuracy: 0.8725 - student_loss: 0.0830 - distillation_loss: 0.0025 - val_accuracy: 0.6449 - val_student_loss: 0.0348 - 798s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.6950192772203642
Best cm: [[634 198]
 [ 77 130]]
Best normalized_cm: [[0.762 0.238]
 [0.372 0.628]]
Best acc: 0.7353224254090471
Best class_accuracies: [0.7620192307692307, 0.6280193236714976]
Best precision: 0.39634146341463417
Best recall: 0.6280193236714976
Best f1: 0.48598130841121495
Best roc_auc: 0.7519248188405797
Best one_indexed_epoch: 15
Best patient_cm: [[440 140]
 [ 25  47]]
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
