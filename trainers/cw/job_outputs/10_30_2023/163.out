Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train163
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
Job id is 1.
Job dir: ../cache/cw/train163/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
-----------------------
--- Final training dataset went from 0 to 3969 elements, with 1889 none's, 991 crakles, 597 wheezes and 492 both ---
--- Final Validation dataset contains 2096 elements, with 989 none, 843 crackles, 120 wheezes and 144 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5252779248279513, 1: 1.0012613521695257, 2: 1.6620603015075377, 3: 2.0167682926829267}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_1[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               204900    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 210,214
Non-trainable params: 23,587,712
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[544 236 132  77]
 [384 343  89  27]
 [ 53  25  28  14]
 [ 82  57   5   0]]
Validation normalized_cm: [[0.55  0.239 0.133 0.078]
 [0.456 0.407 0.106 0.032]
 [0.442 0.208 0.233 0.117]
 [0.569 0.396 0.035 0.   ]]
Validation acc: 0.43654580152671757
Validation class_accuracies: [0.5500505561172901, 0.4068801897983393, 0.23333333333333334, 0.0]
Validation sensitivity: 0.33514001806684734
Validation specificity: 0.5500505561172901
Validation icbhi_score: 0.44259528709206875
Validation roc_auc: None
Validation avg_accuracy: 0.2975660198122407
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
249/249 - 132s - loss: 0.7023 - accuracy: 0.5903 - 132s/epoch - 529ms/step
Epoch 2/80
Validation cm: [[207 205 213 364]
 [ 92 361 126 264]
 [ 10  24  21  65]
 [ 12  49  24  59]]
Validation normalized_cm: [[0.209 0.207 0.215 0.368]
 [0.109 0.428 0.149 0.313]
 [0.083 0.2   0.175 0.542]
 [0.083 0.34  0.167 0.41 ]]
Validation acc: 0.30916030534351147
Validation class_accuracies: [0.20930232558139536, 0.42823250296559906, 0.175, 0.4097222222222222]
Validation sensitivity: 0.3983739837398374
Validation specificity: 0.20930232558139536
Validation icbhi_score: 0.30383815466061637
Validation roc_auc: None
Validation avg_accuracy: 0.3055642626923042
Validation one_indexed_epoch: 2
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 122s - loss: 0.6813 - accuracy: 0.5488 - 122s/epoch - 490ms/step
Epoch 3/80
Validation cm: [[309 287 153 240]
 [161 447  72 163]
 [ 12  39  18  51]
 [ 32  65  19  28]]
Validation normalized_cm: [[0.312 0.29  0.155 0.243]
 [0.191 0.53  0.085 0.193]
 [0.1   0.325 0.15  0.425]
 [0.222 0.451 0.132 0.194]]
Validation acc: 0.38263358778625955
Validation class_accuracies: [0.31243680485338726, 0.5302491103202847, 0.15, 0.19444444444444445]
Validation sensitivity: 0.44534778681120146
Validation specificity: 0.31243680485338726
Validation icbhi_score: 0.37889229583229433
Validation roc_auc: None
Validation avg_accuracy: 0.2967825899045291
Validation one_indexed_epoch: 3
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 126s - loss: 0.6709 - accuracy: 0.5800 - 126s/epoch - 506ms/step
Epoch 4/80
Validation cm: [[334 241 215 199]
 [169 399 115 160]
 [ 13  33  37  37]
 [ 26  59  26  33]]
Validation normalized_cm: [[0.338 0.244 0.217 0.201]
 [0.2   0.473 0.136 0.19 ]
 [0.108 0.275 0.308 0.308]
 [0.181 0.41  0.181 0.229]]
Validation acc: 0.38311068702290074
Validation class_accuracies: [0.33771486349848334, 0.47330960854092524, 0.30833333333333335, 0.22916666666666666]
Validation sensitivity: 0.42366757000903343
Validation specificity: 0.33771486349848334
Validation icbhi_score: 0.3806912167537584
Validation roc_auc: None
Validation avg_accuracy: 0.3371311180098522
Validation one_indexed_epoch: 4
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 123s - loss: 0.6672 - accuracy: 0.5815 - 123s/epoch - 494ms/step
Epoch 5/80
Validation cm: [[311 161 296 221]
 [165 339 139 200]
 [ 16  21  35  48]
 [ 31  42  36  35]]
Validation normalized_cm: [[0.314 0.163 0.299 0.223]
 [0.196 0.402 0.165 0.237]
 [0.133 0.175 0.292 0.4  ]
 [0.215 0.292 0.25  0.243]]
Validation acc: 0.3435114503816794
Validation class_accuracies: [0.31445904954499493, 0.40213523131672596, 0.2916666666666667, 0.24305555555555555]
Validation sensitivity: 0.36946702800361336
Validation specificity: 0.31445904954499493
Validation icbhi_score: 0.3419630387743041
Validation roc_auc: None
Validation avg_accuracy: 0.3128291257709858
Validation one_indexed_epoch: 5
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 128s - loss: 0.6596 - accuracy: 0.5634 - 128s/epoch - 515ms/step
Epoch 6/80
Validation cm: [[450 107 280 152]
 [310 196 186 151]
 [ 31   7  51  31]
 [ 48  26  45  25]]
Validation normalized_cm: [[0.455 0.108 0.283 0.154]
 [0.368 0.233 0.221 0.179]
 [0.258 0.058 0.425 0.258]
 [0.333 0.181 0.312 0.174]]
Validation acc: 0.34446564885496184
Validation class_accuracies: [0.455005055611729, 0.232502965599051, 0.425, 0.1736111111111111]
Validation sensitivity: 0.24570912375790424
Validation specificity: 0.455005055611729
Validation icbhi_score: 0.3503570896848166
Validation roc_auc: None
Validation avg_accuracy: 0.3215297830804728
Validation one_indexed_epoch: 6
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 143s - loss: 0.6540 - accuracy: 0.5712 - 143s/epoch - 573ms/step
Epoch 7/80
Validation cm: [[562 146 161 120]
 [382 281 108  72]
 [ 46  14  33  27]
 [ 66  36  29  13]]
Validation normalized_cm: [[0.568 0.148 0.163 0.121]
 [0.453 0.333 0.128 0.085]
 [0.383 0.117 0.275 0.225]
 [0.458 0.25  0.201 0.09 ]]
Validation acc: 0.4241412213740458
Validation class_accuracies: [0.5682507583417593, 0.3333333333333333, 0.275, 0.09027777777777778]
Validation sensitivity: 0.2953929539295393
Validation specificity: 0.5682507583417593
Validation icbhi_score: 0.4318218561356493
Validation roc_auc: None
Validation avg_accuracy: 0.31671546736321754
Validation one_indexed_epoch: 7
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 160s - loss: 0.6433 - accuracy: 0.5510 - 160s/epoch - 644ms/step
Epoch 8/80
Validation cm: [[245 291 151 302]
 [ 82 441  59 261]
 [  8  24  13  75]
 [ 12  59  16  57]]
Validation normalized_cm: [[0.248 0.294 0.153 0.305]
 [0.097 0.523 0.07  0.31 ]
 [0.067 0.2   0.108 0.625]
 [0.083 0.41  0.111 0.396]]
Validation acc: 0.3606870229007634
Validation class_accuracies: [0.24772497472194135, 0.5231316725978647, 0.10833333333333334, 0.3958333333333333]
Validation sensitivity: 0.46160794941282746
Validation specificity: 0.24772497472194135
Validation icbhi_score: 0.3546664620673844
Validation roc_auc: None
Validation avg_accuracy: 0.31875582849661815
Validation one_indexed_epoch: 8
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 153s - loss: 0.6389 - accuracy: 0.5654 - 153s/epoch - 613ms/step
Epoch 9/80
Validation cm: [[265 183 236 305]
 [ 91 348  84 320]
 [ 10  17  35  58]
 [ 10  41  28  65]]
Validation normalized_cm: [[0.268 0.185 0.239 0.308]
 [0.108 0.413 0.1   0.38 ]
 [0.083 0.142 0.292 0.483]
 [0.069 0.285 0.194 0.451]]
Validation acc: 0.3401717557251908
Validation class_accuracies: [0.2679474216380182, 0.4128113879003559, 0.2916666666666667, 0.4513888888888889]
Validation sensitivity: 0.4046973803071364
Validation specificity: 0.2679474216380182
Validation icbhi_score: 0.3363224009725773
Validation roc_auc: None
Validation avg_accuracy: 0.3559535912734824
Validation one_indexed_epoch: 9
The validation tracker metric at 0.44259528709206875 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0005000000237487257
There is no such attribute
249/249 - 158s - loss: 0.6327 - accuracy: 0.5709 - 158s/epoch - 633ms/step
Epoch 10/80
Validation cm: [[469 283 106 131]
 [165 527  43 108]
 [ 32  37  19  32]
 [ 39  73  14  18]]
Validation normalized_cm: [[0.474 0.286 0.107 0.132]
 [0.196 0.625 0.051 0.128]
 [0.267 0.308 0.158 0.267]
 [0.271 0.507 0.097 0.125]]
Validation acc: 0.4928435114503817
Validation class_accuracies: [0.474216380182002, 0.6251482799525504, 0.15833333333333333, 0.125]
Validation sensitivity: 0.5094850948509485
Validation specificity: 0.474216380182002
Validation icbhi_score: 0.49185073751647523
Validation roc_auc: None
Validation avg_accuracy: 0.3456744983669714
Validation one_indexed_epoch: 10
-- New best results were achieved. --
There is no such attribute
249/249 - 156s - loss: 0.6198 - accuracy: 0.5770 - 156s/epoch - 627ms/step
Epoch 11/80
Validation cm: [[343 311 181 154]
 [125 495  84 139]
 [ 18  34  30  38]
 [ 26  68  26  24]]
Validation normalized_cm: [[0.347 0.314 0.183 0.156]
 [0.148 0.587 0.1   0.165]
 [0.15  0.283 0.25  0.317]
 [0.181 0.472 0.181 0.167]]
Validation acc: 0.4255725190839695
Validation class_accuracies: [0.3468149646107179, 0.5871886120996441, 0.25, 0.16666666666666666]
Validation sensitivity: 0.4959349593495935
Validation specificity: 0.3468149646107179
Validation icbhi_score: 0.42137496198015567
Validation roc_auc: None
Validation avg_accuracy: 0.3376675608442572
Validation one_indexed_epoch: 11
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 1 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 166s - loss: 0.6190 - accuracy: 0.5916 - 166s/epoch - 666ms/step
Epoch 12/80
Validation cm: [[350 312 138 189]
 [125 506  60 152]
 [ 11  38  25  46]
 [ 21  73  16  34]]
Validation normalized_cm: [[0.354 0.315 0.14  0.191]
 [0.148 0.6   0.071 0.18 ]
 [0.092 0.317 0.208 0.383]
 [0.146 0.507 0.111 0.236]]
Validation acc: 0.43654580152671757
Validation class_accuracies: [0.3538928210313448, 0.6002372479240806, 0.20833333333333334, 0.2361111111111111]
Validation sensitivity: 0.5103884372177055
Validation specificity: 0.3538928210313448
Validation icbhi_score: 0.43214062912452517
Validation roc_auc: None
Validation avg_accuracy: 0.3496436283499675
Validation one_indexed_epoch: 12
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 158s - loss: 0.6191 - accuracy: 0.5823 - 158s/epoch - 635ms/step
Epoch 13/80
Validation cm: [[266 302 169 252]
 [ 96 467  61 219]
 [  9  32  21  58]
 [ 12  69  15  48]]
Validation normalized_cm: [[0.269 0.305 0.171 0.255]
 [0.114 0.554 0.072 0.26 ]
 [0.075 0.267 0.175 0.483]
 [0.083 0.479 0.104 0.333]]
Validation acc: 0.38263358778625955
Validation class_accuracies: [0.268958543983822, 0.5539739027283511, 0.175, 0.3333333333333333]
Validation sensitivity: 0.48419150858175247
Validation specificity: 0.268958543983822
Validation icbhi_score: 0.3765750262827873
Validation roc_auc: None
Validation avg_accuracy: 0.3328164450113766
Validation one_indexed_epoch: 13
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 159s - loss: 0.6183 - accuracy: 0.5833 - 159s/epoch - 640ms/step
Epoch 14/80
Validation cm: [[362 300 145 182]
 [128 496  58 161]
 [ 16  33  24  47]
 [ 26  69  23  26]]
Validation normalized_cm: [[0.366 0.303 0.147 0.184]
 [0.152 0.588 0.069 0.191]
 [0.133 0.275 0.2   0.392]
 [0.181 0.479 0.16  0.181]]
Validation acc: 0.43320610687022904
Validation class_accuracies: [0.3660262891809909, 0.5883748517200474, 0.2, 0.18055555555555555]
Validation sensitivity: 0.4932249322493225
Validation specificity: 0.3660262891809909
Validation icbhi_score: 0.4296256107151567
Validation roc_auc: None
Validation avg_accuracy: 0.3337391741141485
Validation one_indexed_epoch: 14
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 156s - loss: 0.6168 - accuracy: 0.6029 - 156s/epoch - 627ms/step
Epoch 15/80
Validation cm: [[327 291 162 209]
 [117 473  53 200]
 [ 15  27  29  49]
 [ 21  67  22  34]]
Validation normalized_cm: [[0.331 0.294 0.164 0.211]
 [0.139 0.561 0.063 0.237]
 [0.125 0.225 0.242 0.408]
 [0.146 0.465 0.153 0.236]]
Validation acc: 0.41173664122137404
Validation class_accuracies: [0.3306370070778564, 0.561091340450771, 0.24166666666666667, 0.2361111111111111]
Validation sensitivity: 0.48419150858175247
Validation specificity: 0.3306370070778564
Validation icbhi_score: 0.40741425782980445
Validation roc_auc: None
Validation avg_accuracy: 0.34237653132660134
Validation one_indexed_epoch: 15
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 5 epochs
There is no such attribute
249/249 - 167s - loss: 0.6103 - accuracy: 0.5986 - 167s/epoch - 670ms/step
Epoch 16/80
Validation cm: [[408 309  87 185]
 [142 532  28 141]
 [ 19  38  20  43]
 [ 30  69  17  28]]
Validation normalized_cm: [[0.413 0.312 0.088 0.187]
 [0.168 0.631 0.033 0.167]
 [0.158 0.317 0.167 0.358]
 [0.208 0.479 0.118 0.194]]
Validation acc: 0.4713740458015267
Validation class_accuracies: [0.41253791708796766, 0.631079478054567, 0.16666666666666666, 0.19444444444444445]
Validation sensitivity: 0.5239385727190605
Validation specificity: 0.41253791708796766
Validation icbhi_score: 0.46823824490351407
Validation roc_auc: None
Validation avg_accuracy: 0.35118212656341147
Validation one_indexed_epoch: 16
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 159s - loss: 0.6051 - accuracy: 0.5928 - 159s/epoch - 638ms/step
Epoch 17/80
Validation cm: [[400 225 217 147]
 [168 436  95 144]
 [ 21  21  45  33]
 [ 32  57  35  20]]
Validation normalized_cm: [[0.404 0.228 0.219 0.149]
 [0.199 0.517 0.113 0.171]
 [0.175 0.175 0.375 0.275]
 [0.222 0.396 0.243 0.139]]
Validation acc: 0.42986641221374045
Validation class_accuracies: [0.4044489383215369, 0.5172004744958482, 0.375, 0.1388888888888889]
Validation sensitivity: 0.45257452574525747
Validation specificity: 0.4044489383215369
Validation icbhi_score: 0.4285117320333972
Validation roc_auc: None
Validation avg_accuracy: 0.3588845754265685
Validation one_indexed_epoch: 17
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 158s - loss: 0.6025 - accuracy: 0.6155 - 158s/epoch - 634ms/step
Epoch 18/80
Validation cm: [[314 333 122 220]
 [105 510  39 189]
 [ 13  33  20  54]
 [ 20  74  19  31]]
Validation normalized_cm: [[0.317 0.337 0.123 0.222]
 [0.125 0.605 0.046 0.224]
 [0.108 0.275 0.167 0.45 ]
 [0.139 0.514 0.132 0.215]]
Validation acc: 0.4174618320610687
Validation class_accuracies: [0.31749241658240646, 0.604982206405694, 0.16666666666666666, 0.2152777777777778]
Validation sensitivity: 0.5067750677506775
Validation specificity: 0.31749241658240646
Validation icbhi_score: 0.41213374216654197
Validation roc_auc: None
Validation avg_accuracy: 0.3261047668581363
Validation one_indexed_epoch: 18
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 0.0002500000118743628
There is no such attribute
249/249 - 157s - loss: 0.6040 - accuracy: 0.6090 - 157s/epoch - 631ms/step
Epoch 19/80
Validation cm: [[446 236 138 169]
 [187 434  59 163]
 [ 21  25  33  41]
 [ 35  60  23  26]]
Validation normalized_cm: [[0.451 0.239 0.14  0.171]
 [0.222 0.515 0.07  0.193]
 [0.175 0.208 0.275 0.342]
 [0.243 0.417 0.16  0.181]]
Validation acc: 0.44799618320610685
Validation class_accuracies: [0.45096056622851366, 0.5148279952550415, 0.275, 0.18055555555555555]
Validation sensitivity: 0.44534778681120146
Validation specificity: 0.45096056622851366
Validation icbhi_score: 0.44815417651985756
Validation roc_auc: None
Validation avg_accuracy: 0.3553360292597777
Validation one_indexed_epoch: 19
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 159s - loss: 0.6070 - accuracy: 0.5850 - 159s/epoch - 640ms/step
Epoch 20/80
Validation cm: [[320 333 159 177]
 [114 509  59 161]
 [ 12  32  34  42]
 [ 19  75  22  28]]
Validation normalized_cm: [[0.324 0.337 0.161 0.179]
 [0.135 0.604 0.07  0.191]
 [0.1   0.267 0.283 0.35 ]
 [0.132 0.521 0.153 0.194]]
Validation acc: 0.42509541984732824
Validation class_accuracies: [0.3235591506572295, 0.6037959667852907, 0.2833333333333333, 0.19444444444444445]
Validation sensitivity: 0.5158084914182475
Validation specificity: 0.3235591506572295
Validation icbhi_score: 0.4196838210377385
Validation roc_auc: None
Validation avg_accuracy: 0.3512832238050745
Validation one_indexed_epoch: 20
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 10 epochs
There is no such attribute
249/249 - 160s - loss: 0.5936 - accuracy: 0.6233 - 160s/epoch - 643ms/step
Epoch 21/80
Validation cm: [[273 331 168 217]
 [ 95 493  59 196]
 [  9  29  35  47]
 [ 15  70  24  35]]
Validation normalized_cm: [[0.276 0.335 0.17  0.219]
 [0.113 0.585 0.07  0.233]
 [0.075 0.242 0.292 0.392]
 [0.104 0.486 0.167 0.243]]
Validation acc: 0.3988549618320611
Validation class_accuracies: [0.27603640040444893, 0.5848161328588375, 0.2916666666666667, 0.24305555555555555]
Validation sensitivity: 0.5085817524841915
Validation specificity: 0.27603640040444893
Validation icbhi_score: 0.3923090764443202
Validation roc_auc: None
Validation avg_accuracy: 0.34889368887137717
Validation one_indexed_epoch: 21
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 11 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 155s - loss: 0.5995 - accuracy: 0.6102 - 155s/epoch - 621ms/step
Epoch 22/80
Validation cm: [[338 360 116 175]
 [116 553  48 126]
 [ 12  43  28  37]
 [ 19  78  15  32]]
Validation normalized_cm: [[0.342 0.364 0.117 0.177]
 [0.138 0.656 0.057 0.149]
 [0.1   0.358 0.233 0.308]
 [0.132 0.542 0.104 0.222]]
Validation acc: 0.45372137404580154
Validation class_accuracies: [0.3417593528816987, 0.6559905100830368, 0.23333333333333334, 0.2222222222222222]
Validation sensitivity: 0.5537488708220416
Validation specificity: 0.3417593528816987
Validation icbhi_score: 0.44775411185187014
Validation roc_auc: None
Validation avg_accuracy: 0.3633263546300728
Validation one_indexed_epoch: 22
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 12 epochs
There is no such attribute
249/249 - 149s - loss: 0.5929 - accuracy: 0.6211 - 149s/epoch - 598ms/step
Epoch 23/80
Validation cm: [[415 271 157 146]
 [162 482  60 139]
 [ 21  27  38  34]
 [ 30  65  27  22]]
Validation normalized_cm: [[0.42  0.274 0.159 0.148]
 [0.192 0.572 0.071 0.165]
 [0.175 0.225 0.317 0.283]
 [0.208 0.451 0.188 0.153]]
Validation acc: 0.45658396946564883
Validation class_accuracies: [0.4196157735085945, 0.571767497034401, 0.31666666666666665, 0.1527777777777778]
Validation sensitivity: 0.4896115627822945
Validation specificity: 0.4196157735085945
Validation icbhi_score: 0.4546136681454445
Validation roc_auc: None
Validation avg_accuracy: 0.36520692874686
Validation one_indexed_epoch: 23
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 13 epochs
There is no such attribute
249/249 - 168s - loss: 0.5913 - accuracy: 0.6198 - 168s/epoch - 675ms/step
Epoch 24/80
Validation cm: [[317 259 233 180]
 [113 450  89 191]
 [ 11  23  38  48]
 [ 16  62  38  28]]
Validation normalized_cm: [[0.321 0.262 0.236 0.182]
 [0.134 0.534 0.106 0.227]
 [0.092 0.192 0.317 0.4  ]
 [0.111 0.431 0.264 0.194]]
Validation acc: 0.3974236641221374
Validation class_accuracies: [0.320525783619818, 0.5338078291814946, 0.31666666666666665, 0.19444444444444445]
Validation sensitivity: 0.46612466124661245
Validation specificity: 0.320525783619818
Validation icbhi_score: 0.3933252224332152
Validation roc_auc: None
Validation avg_accuracy: 0.3413611809781059
Validation one_indexed_epoch: 24
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 14 epochs
There is no such attribute
249/249 - 165s - loss: 0.5952 - accuracy: 0.6127 - 165s/epoch - 664ms/step
Epoch 25/80
Validation cm: [[307 305 239 138]
 [110 493  91 149]
 [ 13  29  45  33]
 [ 17  72  37  18]]
Validation normalized_cm: [[0.31  0.308 0.242 0.14 ]
 [0.13  0.585 0.108 0.177]
 [0.108 0.242 0.375 0.275]
 [0.118 0.5   0.257 0.125]]
Validation acc: 0.41173664122137404
Validation class_accuracies: [0.3104145601617796, 0.5848161328588375, 0.375, 0.125]
Validation sensitivity: 0.5022583559168925
Validation specificity: 0.3104145601617796
Validation icbhi_score: 0.40633645803933605
Validation roc_auc: None
Validation avg_accuracy: 0.34880767325515427
Validation one_indexed_epoch: 25
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 15 epochs
There is no such attribute
249/249 - 156s - loss: 0.5902 - accuracy: 0.6233 - 156s/epoch - 628ms/step
Epoch 26/80
Validation cm: [[309 258 252 170]
 [100 459  90 194]
 [ 11  22  48  39]
 [ 16  62  38  28]]
Validation normalized_cm: [[0.312 0.261 0.255 0.172]
 [0.119 0.544 0.107 0.23 ]
 [0.092 0.183 0.4   0.325]
 [0.111 0.431 0.264 0.194]]
Validation acc: 0.4026717557251908
Validation class_accuracies: [0.31243680485338726, 0.5444839857651246, 0.4, 0.19444444444444445]
Validation sensitivity: 0.4832881662149955
Validation specificity: 0.31243680485338726
Validation icbhi_score: 0.39786248553419135
Validation roc_auc: None
Validation avg_accuracy: 0.3628413087657391
Validation one_indexed_epoch: 26
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 0.0001250000059371814
There is no such attribute
249/249 - 157s - loss: 0.5853 - accuracy: 0.6170 - 157s/epoch - 632ms/step
Epoch 27/80
Validation cm: [[318 350 152 169]
 [109 546  55 133]
 [ 13  37  30  40]
 [ 19  75  21  29]]
Validation normalized_cm: [[0.322 0.354 0.154 0.171]
 [0.129 0.648 0.065 0.158]
 [0.108 0.308 0.25  0.333]
 [0.132 0.521 0.146 0.201]]
Validation acc: 0.44036259541984735
Validation class_accuracies: [0.32153690596562184, 0.6476868327402135, 0.25, 0.2013888888888889]
Validation sensitivity: 0.5465221318879856
Validation specificity: 0.32153690596562184
Validation icbhi_score: 0.43402951892680375
Validation roc_auc: None
Validation avg_accuracy: 0.35515315689868104
Validation one_indexed_epoch: 27
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 17 epochs
There is no such attribute
249/249 - 168s - loss: 0.5836 - accuracy: 0.6080 - 168s/epoch - 675ms/step
Epoch 28/80
Validation cm: [[354 278 207 150]
 [120 484  78 161]
 [ 17  26  42  35]
 [ 24  67  33  20]]
Validation normalized_cm: [[0.358 0.281 0.209 0.152]
 [0.142 0.574 0.093 0.191]
 [0.142 0.217 0.35  0.292]
 [0.167 0.465 0.229 0.139]]
Validation acc: 0.42938931297709926
Validation class_accuracies: [0.3579373104145602, 0.5741399762752076, 0.35, 0.1388888888888889]
Validation sensitivity: 0.4932249322493225
Validation specificity: 0.3579373104145602
Validation icbhi_score: 0.42558112133194137
Validation roc_auc: None
Validation avg_accuracy: 0.3552415438946641
Validation one_indexed_epoch: 28
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 18 epochs
There is no such attribute
249/249 - 159s - loss: 0.5851 - accuracy: 0.6291 - 159s/epoch - 640ms/step
Epoch 29/80
Validation cm: [[307 318 190 174]
 [107 502  65 169]
 [ 13  31  36  40]
 [ 18  72  28  26]]
Validation normalized_cm: [[0.31  0.322 0.192 0.176]
 [0.127 0.595 0.077 0.2  ]
 [0.108 0.258 0.3   0.333]
 [0.125 0.5   0.194 0.181]]
Validation acc: 0.4155534351145038
Validation class_accuracies: [0.3104145601617796, 0.5954922894424673, 0.3, 0.18055555555555555]
Validation sensitivity: 0.5094850948509485
Validation specificity: 0.3104145601617796
Validation icbhi_score: 0.40994982750636405
Validation roc_auc: None
Validation avg_accuracy: 0.3466156012899506
Validation one_indexed_epoch: 29
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 19 epochs
There is no such attribute
249/249 - 161s - loss: 0.5839 - accuracy: 0.6332 - 161s/epoch - 647ms/step
Epoch 30/80
Validation cm: [[336 315 197 141]
 [120 522  73 128]
 [ 17  29  39  35]
 [ 23  70  29  22]]
Validation normalized_cm: [[0.34  0.319 0.199 0.143]
 [0.142 0.619 0.087 0.152]
 [0.142 0.242 0.325 0.292]
 [0.16  0.486 0.201 0.153]]
Validation acc: 0.43845419847328243
Validation class_accuracies: [0.339737108190091, 0.6192170818505338, 0.325, 0.1527777777777778]
Validation sensitivity: 0.5266485998193315
Validation specificity: 0.339737108190091
Validation icbhi_score: 0.4331928540047113
Validation roc_auc: None
Validation avg_accuracy: 0.3591829919546007
Validation one_indexed_epoch: 30
The number of epochs since last 1% equals the patience
There is no such attribute
249/249 - 162s - loss: 0.5865 - accuracy: 0.6259 - 162s/epoch - 649ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.49185073751647523
Best cm: [[469 283 106 131]
 [165 527  43 108]
 [ 32  37  19  32]
 [ 39  73  14  18]]
Best normalized_cm: [[0.474 0.286 0.107 0.132]
 [0.196 0.625 0.051 0.128]
 [0.267 0.308 0.158 0.267]
 [0.271 0.507 0.097 0.125]]
Best acc: 0.4928435114503817
Best class_accuracies: [0.474216380182002, 0.6251482799525504, 0.15833333333333333, 0.125]
Best sensitivity: 0.5094850948509485
Best specificity: 0.474216380182002
Best roc_auc: None
Best avg_accuracy: 0.3456744983669714
Best one_indexed_epoch: 10
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7022809386253357, 0.6813331246376038, 0.6709353923797607, 0.6671578288078308, 0.6595512628555298, 0.654025673866272, 0.6432968378067017, 0.6389065980911255, 0.632684588432312, 0.6198114156723022, 0.6190239191055298, 0.619128406047821, 0.6182977557182312, 0.6167964935302734, 0.6102839708328247, 0.6051476001739502, 0.6024549007415771, 0.6040030121803284, 0.6070475578308105, 0.5935591459274292, 0.5995234847068787, 0.5929232835769653, 0.5913039445877075, 0.5951875448226929, 0.5902336835861206, 0.5852836966514587, 0.5835689306259155, 0.5850804448127747, 0.5839014649391174, 0.586452305316925], 'accuracy': [0.5903249979019165, 0.5487528443336487, 0.5799949765205383, 0.5815066695213318, 0.5633661150932312, 0.5711766481399536, 0.5510203838348389, 0.5653817057609558, 0.5709246397018433, 0.5769715309143066, 0.5915848016738892, 0.5822625160217285, 0.5832703709602356, 0.6029226779937744, 0.5986394286155701, 0.592844545841217, 0.6155202984809875, 0.608969509601593, 0.5850340127944946, 0.62333083152771, 0.6102292537689209, 0.621063232421875, 0.6198034882545471, 0.6127488017082214, 0.62333083152771, 0.617031991481781, 0.6079617142677307, 0.629125714302063, 0.633156955242157, 0.6258503198623657]}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_2 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_2[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_1   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_3 (Dense)             (None, 100)               204900    
                                                                 
 dropout_2 (Dropout)         (None, 100)               0         
                                                                 
 dense_4 (Dense)             (None, 50)                5050      
                                                                 
 dropout_3 (Dropout)         (None, 50)                0         
                                                                 
 dense_5 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 99 104  52 734]
 [ 29  76  51 687]
 [  1   6   6 107]
 [  3   7   0 134]]
Validation normalized_cm: [[0.1   0.105 0.053 0.742]
 [0.034 0.09  0.06  0.815]
 [0.008 0.05  0.05  0.892]
 [0.021 0.049 0.    0.931]]
Validation acc: 0.15028625954198474
Validation class_accuracies: [0.10010111223458039, 0.09015421115065243, 0.05, 0.9305555555555556]
Validation sensitivity: 0.1951219512195122
Validation specificity: 0.10010111223458039
Validation icbhi_score: 0.1476115317270463
Validation roc_auc: None
Validation avg_accuracy: 0.2927027197351971
Validation one_indexed_epoch: 1
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 21 epochs
There is no such attribute
249/249 - 178s - loss: 0.7032 - accuracy: 0.5495 - 178s/epoch - 715ms/step
Epoch 2/80
Validation cm: [[133  30 468 358]
 [ 68  29 389 357]
 [  3   3  61  53]
 [  4   2  41  97]]
Validation normalized_cm: [[0.134 0.03  0.473 0.362]
 [0.081 0.034 0.461 0.423]
 [0.025 0.025 0.508 0.442]
 [0.028 0.014 0.285 0.674]]
Validation acc: 0.15267175572519084
Validation class_accuracies: [0.134479271991911, 0.03440094899169632, 0.5083333333333333, 0.6736111111111112]
Validation sensitivity: 0.16892502258355918
Validation specificity: 0.134479271991911
Validation icbhi_score: 0.1517021472877351
Validation roc_auc: None
Validation avg_accuracy: 0.33770616635701295
Validation one_indexed_epoch: 2
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 22 epochs
There is no such attribute
249/249 - 168s - loss: 0.6264 - accuracy: 0.6233 - 168s/epoch - 675ms/step
Epoch 3/80
Validation cm: [[653  83 167  86]
 [627  68 103  45]
 [ 22   4  66  28]
 [ 66  12  45  21]]
Validation normalized_cm: [[0.66  0.084 0.169 0.087]
 [0.744 0.081 0.122 0.053]
 [0.183 0.033 0.55  0.233]
 [0.458 0.083 0.312 0.146]]
Validation acc: 0.38549618320610685
Validation class_accuracies: [0.660262891809909, 0.08066429418742586, 0.55, 0.14583333333333334]
Validation sensitivity: 0.14001806684733514
Validation specificity: 0.660262891809909
Validation icbhi_score: 0.40014047932862207
Validation roc_auc: None
Validation avg_accuracy: 0.359190129832667
Validation one_indexed_epoch: 3
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 23 epochs
There is no such attribute
249/249 - 167s - loss: 0.5854 - accuracy: 0.6669 - 167s/epoch - 671ms/step
Epoch 4/80
Validation cm: [[315 495  37 142]
 [120 624  15  84]
 [ 11  30  26  53]
 [ 20  94  12  18]]
Validation normalized_cm: [[0.319 0.501 0.037 0.144]
 [0.142 0.74  0.018 0.1  ]
 [0.092 0.25  0.217 0.442]
 [0.139 0.653 0.083 0.125]]
Validation acc: 0.4689885496183206
Validation class_accuracies: [0.3185035389282103, 0.7402135231316725, 0.21666666666666667, 0.125]
Validation sensitivity: 0.6034327009936766
Validation specificity: 0.3185035389282103
Validation icbhi_score: 0.46096811996094345
Validation roc_auc: None
Validation avg_accuracy: 0.35009593218163737
Validation one_indexed_epoch: 4
The validation tracker metric at 0.49185073751647523 hasn't increased by 0 in 24 epochs
Lr has been adjusted to 6.25000029685907e-05
There is no such attribute
249/249 - 174s - loss: 0.5564 - accuracy: 0.7035 - 174s/epoch - 700ms/step
Epoch 5/80
Validation cm: [[467 369  54  99]
 [244 521  24  54]
 [ 19  28  39  34]
 [ 34  81  10  19]]
Validation normalized_cm: [[0.472 0.373 0.055 0.1  ]
 [0.289 0.618 0.028 0.064]
 [0.158 0.233 0.325 0.283]
 [0.236 0.562 0.069 0.132]]
Validation acc: 0.49904580152671757
Validation class_accuracies: [0.47219413549039435, 0.6180308422301305, 0.325, 0.13194444444444445]
Validation sensitivity: 0.5230352303523035
Validation specificity: 0.47219413549039435
Validation icbhi_score: 0.4976146829213489
Validation roc_auc: None
Validation avg_accuracy: 0.3867923555412423
Validation one_indexed_epoch: 5
-- New best results were achieved. --
There is no such attribute
249/249 - 170s - loss: 0.5255 - accuracy: 0.7428 - 170s/epoch - 683ms/step
Epoch 6/80
Validation cm: [[579 240  70 100]
 [305 456  38  44]
 [ 19  16  50  35]
 [ 46  45  21  32]]
Validation normalized_cm: [[0.585 0.243 0.071 0.101]
 [0.362 0.541 0.045 0.052]
 [0.158 0.133 0.417 0.292]
 [0.319 0.312 0.146 0.222]]
Validation acc: 0.5329198473282443
Validation class_accuracies: [0.5854398382204247, 0.5409252669039146, 0.4166666666666667, 0.2222222222222222]
Validation sensitivity: 0.4859981933152665
Validation specificity: 0.5854398382204247
Validation icbhi_score: 0.5357190157678455
Validation roc_auc: None
Validation avg_accuracy: 0.44131349850330703
Validation one_indexed_epoch: 6
-- New best results were achieved. --
There is no such attribute
249/249 - 170s - loss: 0.4996 - accuracy: 0.7488 - 170s/epoch - 685ms/step
Epoch 7/80
Validation cm: [[524 115 225 125]
 [326 165 177 175]
 [ 16   2  76  26]
 [ 40   6  64  34]]
Validation normalized_cm: [[0.53  0.116 0.228 0.126]
 [0.387 0.196 0.21  0.208]
 [0.133 0.017 0.633 0.217]
 [0.278 0.042 0.444 0.236]]
Validation acc: 0.3812022900763359
Validation class_accuracies: [0.5298281092012134, 0.19572953736654805, 0.6333333333333333, 0.2361111111111111]
Validation sensitivity: 0.24841915085817526
Validation specificity: 0.5298281092012134
Validation icbhi_score: 0.3891236300296943
Validation roc_auc: None
Validation avg_accuracy: 0.39875052275305145
Validation one_indexed_epoch: 7
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 1 epochs
There is no such attribute
249/249 - 137s - loss: 0.4885 - accuracy: 0.7463 - 137s/epoch - 550ms/step
Epoch 8/80
Validation cm: [[570 246  75  98]
 [397 347  40  59]
 [ 23  10  39  48]
 [ 53  34  30  27]]
Validation normalized_cm: [[0.576 0.249 0.076 0.099]
 [0.471 0.412 0.047 0.07 ]
 [0.192 0.083 0.325 0.4  ]
 [0.368 0.236 0.208 0.188]]
Validation acc: 0.4689885496183206
Validation class_accuracies: [0.5763397371081901, 0.41162514827995256, 0.325, 0.1875]
Validation sensitivity: 0.37308039747064137
Validation specificity: 0.5763397371081901
Validation icbhi_score: 0.4747100672894157
Validation roc_auc: None
Validation avg_accuracy: 0.37511622134703565
Validation one_indexed_epoch: 8
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 2 epochs
There is no such attribute
249/249 - 135s - loss: 0.4723 - accuracy: 0.7569 - 135s/epoch - 544ms/step
Epoch 9/80
Validation cm: [[576 128 186  99]
 [452 196 123  72]
 [ 18   8  74  20]
 [ 47   8  69  20]]
Validation normalized_cm: [[0.582 0.129 0.188 0.1  ]
 [0.536 0.233 0.146 0.085]
 [0.15  0.067 0.617 0.167]
 [0.326 0.056 0.479 0.139]]
Validation acc: 0.4131679389312977
Validation class_accuracies: [0.5824064711830131, 0.232502965599051, 0.6166666666666667, 0.1388888888888889]
Validation sensitivity: 0.26196928635953026
Validation specificity: 0.5824064711830131
Validation icbhi_score: 0.42218787877127173
Validation roc_auc: None
Validation avg_accuracy: 0.39261624808440493
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 3 epochs
There is no such attribute
249/249 - 134s - loss: 0.4530 - accuracy: 0.7697 - 134s/epoch - 537ms/step
Epoch 10/80
Validation cm: [[614 147 143  85]
 [473 220  75  75]
 [ 20   7  59  34]
 [ 51   8  53  32]]
Validation normalized_cm: [[0.621 0.149 0.145 0.086]
 [0.561 0.261 0.089 0.089]
 [0.167 0.058 0.492 0.283]
 [0.354 0.056 0.368 0.222]]
Validation acc: 0.4413167938931298
Validation class_accuracies: [0.6208291203235592, 0.2609727164887307, 0.49166666666666664, 0.2222222222222222]
Validation sensitivity: 0.2809394760614273
Validation specificity: 0.6208291203235592
Validation icbhi_score: 0.4508842981924932
Validation roc_auc: None
Validation avg_accuracy: 0.39892268142529475
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 4 epochs
There is no such attribute
249/249 - 134s - loss: 0.4427 - accuracy: 0.7732 - 134s/epoch - 537ms/step
Epoch 11/80
Validation cm: [[606 269  70  44]
 [391 402  25  25]
 [ 31  17  62  10]
 [ 51  50  36   7]]
Validation normalized_cm: [[0.613 0.272 0.071 0.044]
 [0.464 0.477 0.03  0.03 ]
 [0.258 0.142 0.517 0.083]
 [0.354 0.347 0.25  0.049]]
Validation acc: 0.5138358778625954
Validation class_accuracies: [0.6127401415571284, 0.47686832740213525, 0.5166666666666667, 0.04861111111111111]
Validation sensitivity: 0.4254742547425474
Validation specificity: 0.6127401415571284
Validation icbhi_score: 0.5191071981498379
Validation roc_auc: None
Validation avg_accuracy: 0.41372156168426033
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 5 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 136s - loss: 0.4267 - accuracy: 0.7838 - 136s/epoch - 547ms/step
Epoch 12/80
Validation cm: [[558 249 102  80]
 [387 319  78  59]
 [ 22   8  70  20]
 [ 40  30  51  23]]
Validation normalized_cm: [[0.564 0.252 0.103 0.081]
 [0.459 0.378 0.093 0.07 ]
 [0.183 0.067 0.583 0.167]
 [0.278 0.208 0.354 0.16 ]]
Validation acc: 0.4627862595419847
Validation class_accuracies: [0.564206268958544, 0.37841043890865955, 0.5833333333333334, 0.1597222222222222]
Validation sensitivity: 0.3721770551038844
Validation specificity: 0.564206268958544
Validation icbhi_score: 0.4681916620312142
Validation roc_auc: None
Validation avg_accuracy: 0.42141806585568975
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 6 epochs
There is no such attribute
249/249 - 134s - loss: 0.4200 - accuracy: 0.7868 - 134s/epoch - 540ms/step
Epoch 13/80
Validation cm: [[702 113 134  40]
 [584  76 139  44]
 [ 18  10  57  35]
 [ 65   1  59  19]]
Validation normalized_cm: [[0.71  0.114 0.135 0.04 ]
 [0.693 0.09  0.165 0.052]
 [0.15  0.083 0.475 0.292]
 [0.451 0.007 0.41  0.132]]
Validation acc: 0.4074427480916031
Validation class_accuracies: [0.7098078867542973, 0.09015421115065243, 0.475, 0.13194444444444445]
Validation sensitivity: 0.13730803974706413
Validation specificity: 0.7098078867542973
Validation icbhi_score: 0.42355796325068074
Validation roc_auc: None
Validation avg_accuracy: 0.35172663558734857
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 7 epochs
There is no such attribute
249/249 - 134s - loss: 0.4038 - accuracy: 0.7959 - 134s/epoch - 537ms/step
Epoch 14/80
Validation cm: [[489 354  90  56]
 [252 493  48  50]
 [ 17  18  52  33]
 [ 32  53  39  20]]
Validation normalized_cm: [[0.494 0.358 0.091 0.057]
 [0.299 0.585 0.057 0.059]
 [0.142 0.15  0.433 0.275]
 [0.222 0.368 0.271 0.139]]
Validation acc: 0.5028625954198473
Validation class_accuracies: [0.49443882709807885, 0.5848161328588375, 0.43333333333333335, 0.1388888888888889]
Validation sensitivity: 0.5103884372177055
Validation specificity: 0.49443882709807885
Validation icbhi_score: 0.5024136321578923
Validation roc_auc: None
Validation avg_accuracy: 0.41286929554478463
Validation one_indexed_epoch: 14
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 8 epochs
Lr has been adjusted to 3.125000148429535e-05
There is no such attribute
249/249 - 135s - loss: 0.3917 - accuracy: 0.7929 - 135s/epoch - 542ms/step
Epoch 15/80
Validation cm: [[529 259  87 114]
 [287 449  42  65]
 [ 14  16  47  43]
 [ 36  46  32  30]]
Validation normalized_cm: [[0.535 0.262 0.088 0.115]
 [0.34  0.533 0.05  0.077]
 [0.117 0.133 0.392 0.358]
 [0.25  0.319 0.222 0.208]]
Validation acc: 0.5033396946564885
Validation class_accuracies: [0.5348837209302325, 0.5326215895610913, 0.39166666666666666, 0.20833333333333334]
Validation sensitivity: 0.4751580849141825
Validation specificity: 0.5348837209302325
Validation icbhi_score: 0.5050209029222075
Validation roc_auc: None
Validation avg_accuracy: 0.41687632762283094
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 9 epochs
There is no such attribute
249/249 - 134s - loss: 0.3751 - accuracy: 0.7974 - 134s/epoch - 538ms/step
Epoch 16/80
Validation cm: [[404 428  47 110]
 [175 592  22  54]
 [ 15  20  36  49]
 [ 19  70  25  30]]
Validation normalized_cm: [[0.408 0.433 0.048 0.111]
 [0.208 0.702 0.026 0.064]
 [0.125 0.167 0.3   0.408]
 [0.132 0.486 0.174 0.208]]
Validation acc: 0.5066793893129771
Validation class_accuracies: [0.4084934277047523, 0.7022538552787663, 0.3, 0.20833333333333334]
Validation sensitivity: 0.5943992773261066
Validation specificity: 0.4084934277047523
Validation icbhi_score: 0.5014463525154295
Validation roc_auc: None
Validation avg_accuracy: 0.40477015407921296
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 10 epochs
There is no such attribute
249/249 - 134s - loss: 0.3630 - accuracy: 0.8138 - 134s/epoch - 537ms/step
Epoch 17/80
Validation cm: [[508 325  77  79]
 [275 496  31  41]
 [ 22  17  51  30]
 [ 31  56  39  18]]
Validation normalized_cm: [[0.514 0.329 0.078 0.08 ]
 [0.326 0.588 0.037 0.049]
 [0.183 0.142 0.425 0.25 ]
 [0.215 0.389 0.271 0.125]]
Validation acc: 0.5119274809160306
Validation class_accuracies: [0.5136501516683518, 0.5883748517200474, 0.425, 0.125]
Validation sensitivity: 0.5103884372177055
Validation specificity: 0.5136501516683518
Validation icbhi_score: 0.5120192944430286
Validation roc_auc: None
Validation avg_accuracy: 0.4130062508470998
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 11 epochs
There is no such attribute
249/249 - 135s - loss: 0.3613 - accuracy: 0.8080 - 135s/epoch - 543ms/step
Epoch 18/80
Validation cm: [[555 297  66  71]
 [317 464  29  33]
 [ 25  19  46  30]
 [ 46  45  38  15]]
Validation normalized_cm: [[0.561 0.3   0.067 0.072]
 [0.376 0.55  0.034 0.039]
 [0.208 0.158 0.383 0.25 ]
 [0.319 0.312 0.264 0.104]]
Validation acc: 0.5152671755725191
Validation class_accuracies: [0.5611729019211324, 0.5504151838671412, 0.38333333333333336, 0.10416666666666667]
Validation sensitivity: 0.4742547425474255
Validation specificity: 0.5611729019211324
Validation icbhi_score: 0.517713822234279
Validation roc_auc: None
Validation avg_accuracy: 0.3997720214470684
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 12 epochs
There is no such attribute
249/249 - 135s - loss: 0.3603 - accuracy: 0.7967 - 135s/epoch - 544ms/step
Epoch 19/80
Validation cm: [[549 229 105 106]
 [344 375  54  70]
 [ 21   7  47  45]
 [ 39  33  48  24]]
Validation normalized_cm: [[0.555 0.232 0.106 0.107]
 [0.408 0.445 0.064 0.083]
 [0.175 0.058 0.392 0.375]
 [0.271 0.229 0.333 0.167]]
Validation acc: 0.4747137404580153
Validation class_accuracies: [0.5551061678463094, 0.44483985765124556, 0.39166666666666666, 0.16666666666666666]
Validation sensitivity: 0.4028906955736224
Validation specificity: 0.5551061678463094
Validation icbhi_score: 0.4789984317099659
Validation roc_auc: None
Validation avg_accuracy: 0.3895698397077221
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 13 epochs
There is no such attribute
249/249 - 134s - loss: 0.3428 - accuracy: 0.8030 - 134s/epoch - 540ms/step
Epoch 20/80
Validation cm: [[535 306  61  87]
 [340 436  32  35]
 [ 19  16  44  41]
 [ 33  55  32  24]]
Validation normalized_cm: [[0.541 0.309 0.062 0.088]
 [0.403 0.517 0.038 0.042]
 [0.158 0.133 0.367 0.342]
 [0.229 0.382 0.222 0.167]]
Validation acc: 0.49570610687022904
Validation class_accuracies: [0.5409504550050556, 0.5172004744958482, 0.36666666666666664, 0.16666666666666666]
Validation sensitivity: 0.45528455284552843
Validation specificity: 0.5409504550050556
Validation icbhi_score: 0.49811750392529197
Validation roc_auc: None
Validation avg_accuracy: 0.3978710657085593
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 14 epochs
There is no such attribute
249/249 - 135s - loss: 0.3436 - accuracy: 0.8060 - 135s/epoch - 542ms/step
Epoch 21/80
Validation cm: [[549 260  82  98]
 [395 358  40  50]
 [ 23  13  42  42]
 [ 40  42  41  21]]
Validation normalized_cm: [[0.555 0.263 0.083 0.099]
 [0.469 0.425 0.047 0.059]
 [0.192 0.108 0.35  0.35 ]
 [0.278 0.292 0.285 0.146]]
Validation acc: 0.4627862595419847
Validation class_accuracies: [0.5551061678463094, 0.4246737841043891, 0.35, 0.14583333333333334]
Validation sensitivity: 0.3803071364046974
Validation specificity: 0.5551061678463094
Validation icbhi_score: 0.4677066521255034
Validation roc_auc: None
Validation avg_accuracy: 0.36890332132100795
Validation one_indexed_epoch: 21
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 15 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
249/249 - 136s - loss: 0.3340 - accuracy: 0.8118 - 136s/epoch - 546ms/step
Epoch 22/80
Validation cm: [[523 286  67 113]
 [307 454  35  47]
 [ 23  11  43  43]
 [ 38  47  34  25]]
Validation normalized_cm: [[0.529 0.289 0.068 0.114]
 [0.364 0.539 0.042 0.056]
 [0.192 0.092 0.358 0.358]
 [0.264 0.326 0.236 0.174]]
Validation acc: 0.4985687022900763
Validation class_accuracies: [0.5288169868554095, 0.538552787663108, 0.35833333333333334, 0.1736111111111111]
Validation sensitivity: 0.4715447154471545
Validation specificity: 0.5288169868554095
Validation icbhi_score: 0.500180851151282
Validation roc_auc: None
Validation avg_accuracy: 0.3998285547407405
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 16 epochs
Lr has been adjusted to 1.5625000742147677e-05
There is no such attribute
249/249 - 137s - loss: 0.3206 - accuracy: 0.8143 - 137s/epoch - 550ms/step
Epoch 23/80
Validation cm: [[506 330  60  93]
 [309 472  25  37]
 [ 25  19  44  32]
 [ 31  61  30  22]]
Validation normalized_cm: [[0.512 0.334 0.061 0.094]
 [0.367 0.56  0.03  0.044]
 [0.208 0.158 0.367 0.267]
 [0.215 0.424 0.208 0.153]]
Validation acc: 0.49809160305343514
Validation class_accuracies: [0.5116279069767442, 0.5599051008303677, 0.36666666666666664, 0.1527777777777778]
Validation sensitivity: 0.4859981933152665
Validation specificity: 0.5116279069767442
Validation icbhi_score: 0.49881305014600535
Validation roc_auc: None
Validation avg_accuracy: 0.3977443630628891
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 17 epochs
There is no such attribute
249/249 - 142s - loss: 0.3220 - accuracy: 0.8171 - 142s/epoch - 569ms/step
Epoch 24/80
Validation cm: [[603 227  74  85]
 [451 311  39  42]
 [ 27   7  53  33]
 [ 53  30  48  13]]
Validation normalized_cm: [[0.61  0.23  0.075 0.086]
 [0.535 0.369 0.046 0.05 ]
 [0.225 0.058 0.442 0.275]
 [0.368 0.208 0.333 0.09 ]]
Validation acc: 0.4675572519083969
Validation class_accuracies: [0.6097067745197169, 0.36892052194543296, 0.44166666666666665, 0.09027777777777778]
Validation sensitivity: 0.3405600722673893
Validation specificity: 0.6097067745197169
Validation icbhi_score: 0.47513342339355313
Validation roc_auc: None
Validation avg_accuracy: 0.37764293522739856
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 18 epochs
There is no such attribute
249/249 - 139s - loss: 0.3151 - accuracy: 0.8219 - 139s/epoch - 560ms/step
Epoch 25/80
Validation cm: [[508 305  64 112]
 [264 483  41  55]
 [ 20  11  45  44]
 [ 29  49  38  28]]
Validation normalized_cm: [[0.514 0.308 0.065 0.113]
 [0.313 0.573 0.049 0.065]
 [0.167 0.092 0.375 0.367]
 [0.201 0.34  0.264 0.194]]
Validation acc: 0.5076335877862596
Validation class_accuracies: [0.5136501516683518, 0.5729537366548043, 0.375, 0.19444444444444445]
Validation sensitivity: 0.5022583559168925
Validation specificity: 0.5136501516683518
Validation icbhi_score: 0.5079542537926222
Validation roc_auc: None
Validation avg_accuracy: 0.41401208319190014
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5357190157678455 hasn't increased by 0 in 19 epochs
There is no such attribute
249/249 - 139s - loss: 0.3151 - accuracy: 0.8168 - 139s/epoch - 558ms/step
Epoch 26/80
Validation cm: [[484 349  55 101]
 [269 503  27  44]
 [ 22  15  47  36]
 [ 30  58  33  23]]
Validation normalized_cm: [[0.489 0.353 0.056 0.102]
 [0.319 0.597 0.032 0.052]
 [0.183 0.125 0.392 0.3  ]
 [0.208 0.403 0.229 0.16 ]]
Validation acc: 0.504293893129771
Validation class_accuracies: [0.48938321536905965, 0.5966785290628707, 0.39166666666666666, 0.1597222222222222]
Validation sensitivity: 0.5176151761517616
Validation specificity: 0.48938321536905965
Validation icbhi_score: 0.5034991957604106
Validation roc_auc: None
Validation avg_accuracy: 0.4093626583302048
Validation one_indexed_epoch: 26
The number of epochs since last 1% equals the patience
There is no such attribute
249/249 - 139s - loss: 0.3082 - accuracy: 0.8201 - 139s/epoch - 559ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.5357190157678455
Best cm: [[579 240  70 100]
 [305 456  38  44]
 [ 19  16  50  35]
 [ 46  45  21  32]]
Best normalized_cm: [[0.585 0.243 0.071 0.101]
 [0.362 0.541 0.045 0.052]
 [0.158 0.133 0.417 0.292]
 [0.319 0.312 0.146 0.222]]
Best acc: 0.5329198473282443
Best class_accuracies: [0.5854398382204247, 0.5409252669039146, 0.4166666666666667, 0.2222222222222222]
Best sensitivity: 0.4859981933152665
Best specificity: 0.5854398382204247
Best roc_auc: None
Best avg_accuracy: 0.44131349850330703
Best one_indexed_epoch: 6
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
25
25
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7031673789024353, 0.626447319984436, 0.5853739380836487, 0.5564379692077637, 0.5254561305046082, 0.49959930777549744, 0.4884752035140991, 0.47230449318885803, 0.45304644107818604, 0.4426690340042114, 0.4267158806324005, 0.42002156376838684, 0.4038313329219818, 0.3917129635810852, 0.3751104176044464, 0.3629644215106964, 0.36125490069389343, 0.36032745242118835, 0.3428497612476349, 0.3435717225074768, 0.33402693271636963, 0.32056573033332825, 0.3219691216945648, 0.3150739371776581, 0.31509625911712646, 0.3081890344619751], 'accuracy': [0.5495086908340454, 0.62333083152771, 0.6669186353683472, 0.7034517526626587, 0.7427563667297363, 0.7488031983375549, 0.7462837100028992, 0.7568656802177429, 0.7697153091430664, 0.7732426524162292, 0.783824622631073, 0.7868480682373047, 0.795918345451355, 0.7928949594497681, 0.7974300980567932, 0.8138070106506348, 0.808012068271637, 0.7966742515563965, 0.8029730319976807, 0.8059964776039124, 0.8117913603782654, 0.8143109083175659, 0.817082405090332, 0.8218694925308228, 0.8168304562568665, 0.820105791091919]}
Job id is 3.
-----------------------
--- Final training dataset went from 0 to 4342 elements, with 1949 none's, 1225 crakles, 605 wheezes and 563 both ---
--- Final Validation dataset contains 1723 elements, with 929 none, 609 crackles, 112 wheezes and 73 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5569522832221652, 1: 0.8861224489795918, 2: 1.7942148760330578, 3: 1.9280639431616342}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_3 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_3[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_2   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_6 (Dense)             (None, 100)               204900    
                                                                 
 dropout_4 (Dropout)         (None, 100)               0         
                                                                 
 dense_7 (Dense)             (None, 50)                5050      
                                                                 
 dropout_5 (Dropout)         (None, 50)                0         
                                                                 
 dense_8 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_2"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_4 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_5 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_2 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 210,214
Non-trainable params: 23,587,712
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
/home/alirachidi/classification_algorithm/trainers/modules/main/helpers.py:20: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,2,n+1, )
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[825   9  73  22]
 [578   3  27   1]
 [108   0   4   0]
 [ 67   5   1   0]]
Validation normalized_cm: [[0.888 0.01  0.079 0.024]
 [0.949 0.005 0.044 0.002]
 [0.964 0.    0.036 0.   ]
 [0.918 0.068 0.014 0.   ]]
Validation acc: 0.4828786999419617
Validation class_accuracies: [0.8880516684607105, 0.0049261083743842365, 0.03571428571428571, 0.0]
Validation sensitivity: 0.008816120906801008
Validation specificity: 0.8880516684607105
Validation icbhi_score: 0.4484338946837558
Validation roc_auc: None
Validation avg_accuracy: 0.2321730156373451
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
272/272 - 113s - loss: 0.7490 - accuracy: 0.4765 - 113s/epoch - 416ms/step
Epoch 2/80
Validation cm: [[809  13  76  31]
 [573   4  29   3]
 [108   0   4   0]
 [ 67   5   0   1]]
Validation normalized_cm: [[0.871 0.014 0.082 0.033]
 [0.941 0.007 0.048 0.005]
 [0.964 0.    0.036 0.   ]
 [0.918 0.068 0.    0.014]]
Validation acc: 0.4747533372025537
Validation class_accuracies: [0.8708288482238966, 0.006568144499178982, 0.03571428571428571, 0.0136986301369863]
Validation sensitivity: 0.011335012594458438
Validation specificity: 0.8708288482238966
Validation icbhi_score: 0.44108193040917754
Validation roc_auc: None
Validation avg_accuracy: 0.23170247714358688
Validation one_indexed_epoch: 2
The validation tracker metric at 0.4484338946837558 hasn't increased by 0 in 1 epochs
There is no such attribute
272/272 - 108s - loss: 0.7530 - accuracy: 0.4800 - 108s/epoch - 399ms/step
Epoch 3/80
Validation cm: [[791  18  77  43]
 [570   7  29   3]
 [106   0   4   2]
 [ 66   5   1   1]]
Validation normalized_cm: [[0.851 0.019 0.083 0.046]
 [0.936 0.011 0.048 0.005]
 [0.946 0.    0.036 0.018]
 [0.904 0.068 0.014 0.014]]
Validation acc: 0.4660475914103308
Validation class_accuracies: [0.8514531754574811, 0.011494252873563218, 0.03571428571428571, 0.0136986301369863]
Validation sensitivity: 0.015113350125944584
Validation specificity: 0.8514531754574811
Validation icbhi_score: 0.43328326279171286
Validation roc_auc: None
Validation avg_accuracy: 0.22809008604557907
Validation one_indexed_epoch: 3
The validation tracker metric at 0.4484338946837558 hasn't increased by 0 in 2 epochs
There is no such attribute
272/272 - 110s - loss: 0.7480 - accuracy: 0.4777 - 110s/epoch - 405ms/step
Epoch 4/80
Validation cm: [[779  21  69  60]
 [568   9  24   8]
 [104   0   5   3]
 [ 66   5   1   1]]
Validation normalized_cm: [[0.839 0.023 0.074 0.065]
 [0.933 0.015 0.039 0.013]
 [0.929 0.    0.045 0.027]
 [0.904 0.068 0.014 0.014]]
Validation acc: 0.4608241439349971
Validation class_accuracies: [0.8385360602798708, 0.014778325123152709, 0.044642857142857144, 0.0136986301369863]
Validation sensitivity: 0.018891687657430732
Validation specificity: 0.8385360602798708
Validation icbhi_score: 0.4287138739686508
Validation roc_auc: None
Validation avg_accuracy: 0.22791396817071674
Validation one_indexed_epoch: 4
The validation tracker metric at 0.4484338946837558 hasn't increased by 0 in 3 epochs
There is no such attribute
272/272 - 108s - loss: 0.7453 - accuracy: 0.4862 - 108s/epoch - 398ms/step
Epoch 5/80
Validation cm: [[760  31  71  67]
 [563  13  21  12]
 [102   1   6   3]
 [ 64   7   1   1]]
Validation normalized_cm: [[0.818 0.033 0.076 0.072]
 [0.924 0.021 0.034 0.02 ]
 [0.911 0.009 0.054 0.027]
 [0.877 0.096 0.014 0.014]]
Validation acc: 0.4526987811955891
Validation class_accuracies: [0.8180839612486545, 0.021346469622331693, 0.05357142857142857, 0.0136986301369863]
Validation sensitivity: 0.02518891687657431
Validation specificity: 0.8180839612486545
Validation icbhi_score: 0.4216364390626144
Validation roc_auc: None
Validation avg_accuracy: 0.22667512239485027
Validation one_indexed_epoch: 5
The validation tracker metric at 0.4484338946837558 hasn't increased by 0 in 4 epochs
There is no such attribute
272/272 - 105s - loss: 0.7525 - accuracy: 0.4816 - 105s/epoch - 387ms/step
Epoch 6/80
Validation cm: [[748  36  70  75]
 [551  21  19  18]
 [100   2   7   3]
 [ 62   8   2   1]]
Validation normalized_cm: [[0.805 0.039 0.075 0.081]
 [0.905 0.034 0.031 0.03 ]
 [0.893 0.018 0.062 0.027]
 [0.849 0.11  0.027 0.014]]
Validation acc: 0.4509576320371445
Validation class_accuracies: [0.8051668460710442, 0.034482758620689655, 0.0625, 0.0136986301369863]
Validation sensitivity: 0.036523929471032744
Validation specificity: 0.8051668460710442
Validation icbhi_score: 0.42084538777103847
Validation roc_auc: None
Validation avg_accuracy: 0.22896205870718
Validation one_indexed_epoch: 6
The validation tracker metric at 0.4484338946837558 hasn't increased by 0 in 5 epochs
There is no such attribute
272/272 - 109s - loss: 0.7465 - accuracy: 0.4961 - 109s/epoch - 399ms/step
Epoch 7/80
