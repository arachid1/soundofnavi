Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train44
Description: Leaf with model 9/mixednet with P-T
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 507s - loss: 0.4427 - accuracy: 0.5595 - 507s/epoch - 2s/step
Validation cm: [[675  43  21   1]
 [ 57  12  22   1]
 [ 67   1   8   1]
 [ 49   4  76   1]]
Validation normalized_cm: [[0.912 0.058 0.028 0.001]
 [0.62  0.13  0.239 0.011]
 [0.87  0.013 0.104 0.013]
 [0.377 0.031 0.585 0.008]]
Validation acc: 0.6698748796920115
Validation class_accuracies: [0.9121621621621622, 0.13043478260869565, 0.1038961038961039, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28854633908981736
Validation one_indexed_epoch: 2
Epoch 2/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 519s - loss: 0.3869 - accuracy: 0.5897 - 519s/epoch - 2s/step
Validation cm: [[697   0  39   4]
 [ 71   0  17   4]
 [ 47   0  30   0]
 [ 31   0  98   1]]
Validation normalized_cm: [[0.942 0.    0.053 0.005]
 [0.772 0.    0.185 0.043]
 [0.61  0.    0.39  0.   ]
 [0.238 0.    0.754 0.008]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.9418918918918919, 0.0, 0.38961038961038963, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3347986472986473
Validation one_indexed_epoch: 3
Epoch 3/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 521s - loss: 0.3631 - accuracy: 0.6107 - 521s/epoch - 2s/step
Validation cm: [[644  76  17   3]
 [ 29  36  18   9]
 [ 50   2  23   2]
 [ 27  17  73  13]]
Validation normalized_cm: [[0.87  0.103 0.023 0.004]
 [0.315 0.391 0.196 0.098]
 [0.649 0.026 0.299 0.026]
 [0.208 0.131 0.562 0.1  ]]
Validation acc: 0.6891241578440809
Validation class_accuracies: [0.8702702702702703, 0.391304347826087, 0.2987012987012987, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.415068979199414
Validation one_indexed_epoch: 4
Epoch 4/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 539s - loss: 0.3421 - accuracy: 0.6235 - 539s/epoch - 2s/step
Validation cm: [[674  58   7   1]
 [ 46  44   0   2]
 [ 61   3  10   3]
 [ 87   7  26  10]]
Validation normalized_cm: [[0.911 0.078 0.009 0.001]
 [0.5   0.478 0.    0.022]
 [0.792 0.039 0.13  0.039]
 [0.669 0.054 0.2   0.077]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.9108108108108108, 0.4782608695652174, 0.12987012987012986, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3989662217923088
Validation one_indexed_epoch: 5
Epoch 5/40
[[0. 0.]]
The validation tracker metric at 0.415068979199414 hasn't increased by 0 in 1 epochs
330/330 - 534s - loss: 0.3252 - accuracy: 0.6170 - 534s/epoch - 2s/step
Validation cm: [[436 288   7   9]
 [  8  67   1  16]
 [ 32  26   5  14]
 [ 11  47  15  57]]
Validation normalized_cm: [[0.589 0.389 0.009 0.012]
 [0.087 0.728 0.011 0.174]
 [0.416 0.338 0.065 0.182]
 [0.085 0.362 0.115 0.438]]
Validation acc: 0.5437921077959577
Validation class_accuracies: [0.5891891891891892, 0.7282608695652174, 0.06493506493506493, 0.43846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4552116655377525
Validation one_indexed_epoch: 6
Epoch 6/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 559s - loss: 0.3062 - accuracy: 0.6191 - 559s/epoch - 2s/step
Validation cm: [[576  23  97  44]
 [ 38  13  17  24]
 [ 18   3  48   8]
 [ 26   7  90   7]]
Validation normalized_cm: [[0.778 0.031 0.131 0.059]
 [0.413 0.141 0.185 0.261]
 [0.234 0.039 0.623 0.104]
 [0.2   0.054 0.692 0.054]]
Validation acc: 0.6198267564966313
Validation class_accuracies: [0.7783783783783784, 0.14130434782608695, 0.6233766233766234, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39922637585681064
Validation one_indexed_epoch: 7
Epoch 7/40
[[0. 0.]]
The validation tracker metric at 0.4552116655377525 hasn't increased by 0 in 1 epochs
330/330 - 546s - loss: 0.2930 - accuracy: 0.6290 - 546s/epoch - 2s/step
Validation cm: [[657  39  33  11]
 [ 39  25  17  11]
 [ 37   3  29   8]
 [ 36  13  51  30]]
Validation normalized_cm: [[0.888 0.053 0.045 0.015]
 [0.424 0.272 0.185 0.12 ]
 [0.481 0.039 0.377 0.104]
 [0.277 0.1   0.392 0.231]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.8878378378378379, 0.2717391304347826, 0.37662337662337664, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.441742393916307
Validation one_indexed_epoch: 8
Epoch 8/40
[[0. 0.]]
The validation tracker metric at 0.4552116655377525 hasn't increased by 0 in 2 epochs
330/330 - 542s - loss: 0.2762 - accuracy: 0.6496 - 542s/epoch - 2s/step
Validation cm: [[567 127  33  13]
 [ 18  45  18  11]
 [ 26   5  34  12]
 [ 17  17  63  33]]
Validation normalized_cm: [[0.766 0.172 0.045 0.018]
 [0.196 0.489 0.196 0.12 ]
 [0.338 0.065 0.442 0.156]
 [0.131 0.131 0.485 0.254]]
Validation acc: 0.6535129932627527
Validation class_accuracies: [0.7662162162162162, 0.4891304347826087, 0.44155844155844154, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48768781160085506
Validation one_indexed_epoch: 9
Epoch 9/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 543s - loss: 0.2635 - accuracy: 0.6337 - 543s/epoch - 2s/step
Validation cm: [[557 159  21   3]
 [ 17  50  19   6]
 [ 43  14  10  10]
 [ 21  27  55  27]]
Validation normalized_cm: [[0.753 0.215 0.028 0.004]
 [0.185 0.543 0.207 0.065]
 [0.558 0.182 0.13  0.13 ]
 [0.162 0.208 0.423 0.208]]
Validation acc: 0.6198267564966313
Validation class_accuracies: [0.7527027027027027, 0.5434782608695652, 0.12987012987012986, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40843585028367635
Validation one_indexed_epoch: 10
Epoch 10/40
[[0. 0.]]
The validation tracker metric at 0.48768781160085506 hasn't increased by 0 in 1 epochs
330/330 - 546s - loss: 0.2451 - accuracy: 0.6658 - 546s/epoch - 2s/step
Validation cm: [[663  64  10   3]
 [ 60  22   7   3]
 [ 52   4  16   5]
 [ 48   8  42  32]]
Validation normalized_cm: [[0.896 0.086 0.014 0.004]
 [0.652 0.239 0.076 0.033]
 [0.675 0.052 0.208 0.065]
 [0.369 0.062 0.323 0.246]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.8959459459459459, 0.2391304347826087, 0.2077922077922078, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39725560866865217
Validation one_indexed_epoch: 11
Epoch 11/40
[[0. 0.]]
The validation tracker metric at 0.48768781160085506 hasn't increased by 0 in 2 epochs
330/330 - 550s - loss: 0.2453 - accuracy: 0.6495 - 550s/epoch - 2s/step
Validation cm: [[629   6  98   7]
 [ 45   6  33   8]
 [ 36   0  35   6]
 [ 21   0  75  34]]
Validation normalized_cm: [[0.85  0.008 0.132 0.009]
 [0.489 0.065 0.359 0.087]
 [0.468 0.    0.455 0.078]
 [0.162 0.    0.577 0.262]]
Validation acc: 0.6775745909528392
Validation class_accuracies: [0.85, 0.06521739130434782, 0.45454545454545453, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40782532684706596
Validation one_indexed_epoch: 12
Epoch 12/40
[[0. 0.]]
The validation tracker metric at 0.48768781160085506 hasn't increased by 0 in 3 epochs
330/330 - 554s - loss: 0.2263 - accuracy: 0.6462 - 554s/epoch - 2s/step
Validation cm: [[494  61 131  54]
 [ 23  27   9  33]
 [ 12   3  39  23]
 [ 10   7  39  74]]
Validation normalized_cm: [[0.668 0.082 0.177 0.073]
 [0.25  0.293 0.098 0.359]
 [0.156 0.039 0.506 0.299]
 [0.077 0.054 0.3   0.569]]
Validation acc: 0.6102021174205967
Validation class_accuracies: [0.6675675675675675, 0.29347826086956524, 0.5064935064935064, 0.5692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.509192526040352
Validation one_indexed_epoch: 13
Epoch 13/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 550s - loss: 0.2093 - accuracy: 0.6377 - 550s/epoch - 2s/step
Validation cm: [[597  63  64  16]
 [ 28  34  12  18]
 [ 25   5  31  16]
 [ 11  17  36  66]]
Validation normalized_cm: [[0.807 0.085 0.086 0.022]
 [0.304 0.37  0.13  0.196]
 [0.325 0.065 0.403 0.208]
 [0.085 0.131 0.277 0.508]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8067567567567567, 0.3695652173913043, 0.4025974025974026, 0.5076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5216529211094428
Validation one_indexed_epoch: 14
Epoch 14/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 547s - loss: 0.1921 - accuracy: 0.6584 - 547s/epoch - 2s/step
Validation cm: [[668  43  13  16]
 [ 40  18  18  16]
 [ 48   3  19   7]
 [ 25  16  53  36]]
Validation normalized_cm: [[0.903 0.058 0.018 0.022]
 [0.435 0.196 0.196 0.174]
 [0.623 0.039 0.247 0.091]
 [0.192 0.123 0.408 0.277]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.9027027027027027, 0.1956521739130435, 0.24675324675324675, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40550780007301745
Validation one_indexed_epoch: 15
Epoch 15/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 1 epochs
330/330 - 547s - loss: 0.1869 - accuracy: 0.6506 - 547s/epoch - 2s/step
Validation cm: [[603  69  48  20]
 [ 32  24  24  12]
 [ 34   1  31  11]
 [ 14   8  58  50]]
Validation normalized_cm: [[0.815 0.093 0.065 0.027]
 [0.348 0.261 0.261 0.13 ]
 [0.442 0.013 0.403 0.143]
 [0.108 0.062 0.446 0.385]]
Validation acc: 0.6814244465832531
Validation class_accuracies: [0.8148648648648649, 0.2608695652173913, 0.4025974025974026, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46573680432376086
Validation one_indexed_epoch: 16
Epoch 16/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 2 epochs
330/330 - 545s - loss: 0.1792 - accuracy: 0.6739 - 545s/epoch - 2s/step
Validation cm: [[619  67  40  14]
 [ 36  23  19  14]
 [ 35   5  25  12]
 [ 19  15  60  36]]
Validation normalized_cm: [[0.836 0.091 0.054 0.019]
 [0.391 0.25  0.207 0.152]
 [0.455 0.065 0.325 0.156]
 [0.146 0.115 0.462 0.277]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.8364864864864865, 0.25, 0.3246753246753247, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.42202122202122205
Validation one_indexed_epoch: 17
Epoch 17/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 3 epochs
330/330 - 544s - loss: 0.1508 - accuracy: 0.6656 - 544s/epoch - 2s/step
Validation cm: [[665  50  17   8]
 [ 53  19  13   7]
 [ 41   3  26   7]
 [ 28  12  50  40]]
Validation normalized_cm: [[0.899 0.068 0.023 0.011]
 [0.576 0.207 0.141 0.076]
 [0.532 0.039 0.338 0.091]
 [0.215 0.092 0.385 0.308]]
Validation acc: 0.7218479307025987
Validation class_accuracies: [0.8986486486486487, 0.20652173913043478, 0.33766233766233766, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43763125828343225
Validation one_indexed_epoch: 18
Epoch 18/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 4 epochs
330/330 - 544s - loss: 0.1503 - accuracy: 0.6607 - 544s/epoch - 2s/step
Validation cm: [[646  28  49  17]
 [ 43  15  14  20]
 [ 30   3  31  13]
 [ 22   6  46  56]]
Validation normalized_cm: [[0.873 0.038 0.066 0.023]
 [0.467 0.163 0.152 0.217]
 [0.39  0.039 0.403 0.169]
 [0.169 0.046 0.354 0.431]]
Validation acc: 0.7199230028873917
Validation class_accuracies: [0.8729729729729729, 0.16304347826086957, 0.4025974025974026, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.467345771150119
Validation one_indexed_epoch: 19
Epoch 19/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 5 epochs
330/330 - 548s - loss: 0.1258 - accuracy: 0.6441 - 548s/epoch - 2s/step
Validation cm: [[671  42  21   6]
 [ 50  18  12  12]
 [ 35   8  25   9]
 [ 28  17  45  40]]
Validation normalized_cm: [[0.907 0.057 0.028 0.008]
 [0.543 0.196 0.13  0.13 ]
 [0.455 0.104 0.325 0.117]
 [0.215 0.131 0.346 0.308]]
Validation acc: 0.7256977863330125
Validation class_accuracies: [0.9067567567567567, 0.1956521739130435, 0.3246753246753247, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43369414075935814
Validation one_indexed_epoch: 20
Epoch 20/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 6 epochs
330/330 - 550s - loss: 0.1228 - accuracy: 0.6514 - 550s/epoch - 2s/step
Validation cm: [[427 131  90  92]
 [ 13  29  12  38]
 [ 14   6  26  31]
 [  3  13  28  86]]
Validation normalized_cm: [[0.577 0.177 0.122 0.124]
 [0.141 0.315 0.13  0.413]
 [0.182 0.078 0.338 0.403]
 [0.023 0.1   0.215 0.662]]
Validation acc: 0.546679499518768
Validation class_accuracies: [0.577027027027027, 0.31521739130434784, 0.33766233766233766, 0.6615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4728613043830435
Validation one_indexed_epoch: 21
Epoch 21/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 7 epochs
330/330 - 543s - loss: 0.1073 - accuracy: 0.6383 - 543s/epoch - 2s/step
Validation cm: [[606 105  20   9]
 [ 29  38  12  13]
 [ 33   4  27  13]
 [ 16  23  42  49]]
Validation normalized_cm: [[0.819 0.142 0.027 0.012]
 [0.315 0.413 0.13  0.141]
 [0.429 0.052 0.351 0.169]
 [0.123 0.177 0.323 0.377]]
Validation acc: 0.6929740134744947
Validation class_accuracies: [0.8189189189189189, 0.41304347826086957, 0.35064935064935066, 0.3769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.489883706188054
Validation one_indexed_epoch: 22
Epoch 22/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 8 epochs
330/330 - 544s - loss: 0.1087 - accuracy: 0.6675 - 544s/epoch - 2s/step
Validation cm: [[660  61  12   7]
 [ 43  23  18   8]
 [ 47   3  21   6]
 [ 43  14  45  28]]
Validation normalized_cm: [[0.892 0.082 0.016 0.009]
 [0.467 0.25  0.196 0.087]
 [0.61  0.039 0.273 0.078]
 [0.331 0.108 0.346 0.215]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.8918918918918919, 0.25, 0.2727272727272727, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.407500945000945
Validation one_indexed_epoch: 23
Epoch 23/40
[[0. 0.]]
The validation tracker metric at 0.5216529211094428 hasn't increased by 0 in 9 epochs
330/330 - 543s - loss: 0.0990 - accuracy: 0.6523 - 543s/epoch - 2s/step
Validation cm: [[651  50  18  21]
 [ 35  33   8  16]
 [ 38   5  27   7]
 [ 25  24  36  45]]
Validation normalized_cm: [[0.88  0.068 0.024 0.028]
 [0.38  0.359 0.087 0.174]
 [0.494 0.065 0.351 0.091]
 [0.192 0.185 0.277 0.346]]
Validation acc: 0.7276227141482194
Validation class_accuracies: [0.8797297297297297, 0.358695652173913, 0.35064935064935066, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48380714467670993
Validation one_indexed_epoch: 24
Epoch 24/40
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 542s - loss: 0.0810 - accuracy: 0.6774 - 542s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5216529211094428
Best cm: [[597  63  64  16]
 [ 28  34  12  18]
 [ 25   5  31  16]
 [ 11  17  36  66]]
Best normalized_cm: [[0.807 0.085 0.086 0.022]
 [0.304 0.37  0.13  0.196]
 [0.325 0.065 0.403 0.208]
 [0.085 0.131 0.277 0.508]]
Best acc: 0.7006737247353224
Best class_accuracies: [0.8067567567567567, 0.3695652173913043, 0.4025974025974026, 0.5076923076923077]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 14
Validation cm: [[  0 740   0   0]
 [  0  92   0   0]
 [  0  77   0   0]
 [  0 130   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.08854667949951876
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization_5 (BatchNormalization)      multiple                                    4                
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_3 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_4 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense_1 (Dense)                                 multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
[[1. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 901s - accuracy: 0.5623 - student_loss: 0.6076 - distillation_loss: -1.6468e-03 - val_accuracy: 0.9259 - val_student_loss: 0.4687 - 901s/epoch - 3s/step
Validation cm: [[167  77 282 214]
 [  4  15  13  60]
 [  5   1  20  51]
 [  2   4  16 108]]
Validation normalized_cm: [[0.226 0.104 0.381 0.289]
 [0.043 0.163 0.141 0.652]
 [0.065 0.013 0.26  0.662]
 [0.015 0.031 0.123 0.831]]
Validation acc: 0.2983638113570741
Validation class_accuracies: [0.22567567567567567, 0.16304347826086957, 0.2597402597402597, 0.8307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3698071611115089
Validation one_indexed_epoch: 2
Epoch 2/40
[[0. 1.]]
-- New best results were achieved. --
Saving model...
330/330 - 883s - accuracy: 0.5994 - student_loss: 0.4954 - distillation_loss: -2.4289e-03 - val_accuracy: 0.2512 - val_student_loss: 2.5319 - 883s/epoch - 3s/step
Validation cm: [[738   2   0   0]
 [ 91   1   0   0]
 [ 74   0   2   1]
 [114   0   0  16]]
Validation normalized_cm: [[0.997 0.003 0.    0.   ]
 [0.989 0.011 0.    0.   ]
 [0.961 0.    0.026 0.013]
 [0.877 0.    0.    0.123]]
Validation acc: 0.7285851780558229
Validation class_accuracies: [0.9972972972972973, 0.010869565217391304, 0.025974025974025976, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28930445289140944
Validation one_indexed_epoch: 3
Epoch 3/40
[[0. 0.]]
The validation tracker metric at 0.3698071611115089 hasn't increased by 0 in 1 epochs
330/330 - 884s - accuracy: 0.5781 - student_loss: 0.3521 - distillation_loss: 0.0014 - val_accuracy: 0.6179 - val_student_loss: 5.4195e-04 - 884s/epoch - 3s/step
Validation cm: [[432  97 139  72]
 [ 19  43  14  16]
 [ 25   2  21  29]
 [ 18  11  48  53]]
Validation normalized_cm: [[0.584 0.131 0.188 0.097]
 [0.207 0.467 0.152 0.174]
 [0.325 0.026 0.273 0.377]
 [0.138 0.085 0.369 0.408]]
Validation acc: 0.5283926852743022
Validation class_accuracies: [0.5837837837837838, 0.4673913043478261, 0.2727272727272727, 0.4076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43289866713779757
Validation one_indexed_epoch: 4
Epoch 4/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 910s - accuracy: 0.6301 - student_loss: 0.3458 - distillation_loss: -6.4755e-03 - val_accuracy: 0.3205 - val_student_loss: 0.8542 - 910s/epoch - 3s/step
Validation cm: [[618 108  12   2]
 [ 51  40   1   0]
 [ 56   4  15   2]
 [ 77  11  24  18]]
Validation normalized_cm: [[0.835 0.146 0.016 0.003]
 [0.554 0.435 0.011 0.   ]
 [0.727 0.052 0.195 0.026]
 [0.592 0.085 0.185 0.138]]
Validation acc: 0.6650625601539942
Validation class_accuracies: [0.8351351351351352, 0.43478260869565216, 0.19480519480519481, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40079611927438014
Validation one_indexed_epoch: 5
Epoch 5/40
[[0. 0.]]
The validation tracker metric at 0.43289866713779757 hasn't increased by 0 in 1 epochs
330/330 - 913s - accuracy: 0.6132 - student_loss: 0.5029 - distillation_loss: 0.0021 - val_accuracy: 0.3523 - val_student_loss: 0.0127 - 913s/epoch - 3s/step
Validation cm: [[339  87 124 190]
 [  5  23   4  60]
 [ 23   5  20  29]
 [  3   3  23 101]]
Validation normalized_cm: [[0.458 0.118 0.168 0.257]
 [0.054 0.25  0.043 0.652]
 [0.299 0.065 0.26  0.377]
 [0.023 0.023 0.177 0.777]]
Validation acc: 0.46487006737247355
Validation class_accuracies: [0.4581081081081081, 0.25, 0.2597402597402597, 0.7769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43619286119286116
Validation one_indexed_epoch: 6
Epoch 6/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 899s - accuracy: 0.6333 - student_loss: 0.5258 - distillation_loss: -9.3452e-04 - val_accuracy: 0.5544 - val_student_loss: 2.6843 - 899s/epoch - 3s/step
Validation cm: [[581  33 113  13]
 [ 54  17  14   7]
 [ 24   1  52   0]
 [ 78   0  50   2]]
Validation normalized_cm: [[0.785 0.045 0.153 0.018]
 [0.587 0.185 0.152 0.076]
 [0.312 0.013 0.675 0.   ]
 [0.6   0.    0.385 0.015]]
Validation acc: 0.6275264677574591
Validation class_accuracies: [0.7851351351351351, 0.18478260869565216, 0.6753246753246753, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4151567586350195
Validation one_indexed_epoch: 7
Epoch 7/40
[[0. 0.]]
The validation tracker metric at 0.43619286119286116 hasn't increased by 0 in 1 epochs
330/330 - 899s - accuracy: 0.6151 - student_loss: 0.1423 - distillation_loss: 0.0016 - val_accuracy: 0.2618 - val_student_loss: 0.0075 - 899s/epoch - 3s/step
Validation cm: [[518  33 162  27]
 [ 29   9  39  15]
 [ 52   0  23   2]
 [ 54   3  63  10]]
Validation normalized_cm: [[0.7   0.045 0.219 0.036]
 [0.315 0.098 0.424 0.163]
 [0.675 0.    0.299 0.026]
 [0.415 0.023 0.485 0.077]]
Validation acc: 0.5389797882579404
Validation class_accuracies: [0.7, 0.09782608695652174, 0.2987012987012987, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2933626156452243
Validation one_indexed_epoch: 8
Epoch 8/40
[[0. 0.]]
The validation tracker metric at 0.43619286119286116 hasn't increased by 0 in 2 epochs
330/330 - 884s - accuracy: 0.6464 - student_loss: 0.4448 - distillation_loss: 0.0114 - val_accuracy: 0.1800 - val_student_loss: 2.0399 - 884s/epoch - 3s/step
Validation cm: [[506 108  86  40]
 [ 29  34  14  15]
 [ 16   9  40  12]
 [ 17  22  47  44]]
Validation normalized_cm: [[0.684 0.146 0.116 0.054]
 [0.315 0.37  0.152 0.163]
 [0.208 0.117 0.519 0.156]
 [0.131 0.169 0.362 0.338]]
Validation acc: 0.6005774783445621
Validation class_accuracies: [0.6837837837837838, 0.3695652173913043, 0.5194805194805194, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47782276477928654
Validation one_indexed_epoch: 9
Epoch 9/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 880s - accuracy: 0.6157 - student_loss: 0.2390 - distillation_loss: -3.3641e-03 - val_accuracy: 0.5149 - val_student_loss: 0.1264 - 880s/epoch - 3s/step
Validation cm: [[475  81  88  96]
 [ 26  19  25  22]
 [ 17   3  35  22]
 [  8   1  59  62]]
Validation normalized_cm: [[0.642 0.109 0.119 0.13 ]
 [0.283 0.207 0.272 0.239]
 [0.221 0.039 0.455 0.286]
 [0.062 0.008 0.454 0.477]]
Validation acc: 0.5688161693936478
Validation class_accuracies: [0.6418918918918919, 0.20652173913043478, 0.45454545454545453, 0.47692307692307695]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44497054062271457
Validation one_indexed_epoch: 10
Epoch 10/40
[[0. 0.]]
The validation tracker metric at 0.47782276477928654 hasn't increased by 0 in 1 epochs
330/330 - 888s - accuracy: 0.6405 - student_loss: 0.1900 - distillation_loss: 0.0018 - val_accuracy: 0.3898 - val_student_loss: 1.9357 - 888s/epoch - 3s/step
Validation cm: [[686  31  20   3]
 [ 79   7   6   0]
 [ 49   1  26   1]
 [ 58   5  55  12]]
Validation normalized_cm: [[0.927 0.042 0.027 0.004]
 [0.859 0.076 0.065 0.   ]
 [0.636 0.013 0.338 0.013]
 [0.446 0.038 0.423 0.092]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.927027027027027, 0.07608695652173914, 0.33766233766233766, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3582710033796991
Validation one_indexed_epoch: 11
Epoch 11/40
[[0. 0.]]
The validation tracker metric at 0.47782276477928654 hasn't increased by 0 in 2 epochs
330/330 - 889s - accuracy: 0.6229 - student_loss: 0.2558 - distillation_loss: -7.1485e-03 - val_accuracy: 0.2936 - val_student_loss: 0.0291 - 889s/epoch - 3s/step
Validation cm: [[598  41  97   4]
 [ 53   6  32   1]
 [ 43   2  29   3]
 [ 19   5  93  13]]
Validation normalized_cm: [[0.808 0.055 0.131 0.005]
 [0.576 0.065 0.348 0.011]
 [0.558 0.026 0.377 0.039]
 [0.146 0.038 0.715 0.1  ]]
Validation acc: 0.6217516843118384
Validation class_accuracies: [0.8081081081081081, 0.06521739130434782, 0.37662337662337664, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3374872190089582
Validation one_indexed_epoch: 12
Epoch 12/40
[[0. 0.]]
The validation tracker metric at 0.47782276477928654 hasn't increased by 0 in 3 epochs
330/330 - 890s - accuracy: 0.6641 - student_loss: 0.2284 - distillation_loss: 0.0030 - val_accuracy: 0.2907 - val_student_loss: 3.0955 - 890s/epoch - 3s/step
Validation cm: [[526  86  68  60]
 [ 22  39  20  11]
 [ 30   2  28  17]
 [ 15  10  50  55]]
Validation normalized_cm: [[0.711 0.116 0.092 0.081]
 [0.239 0.424 0.217 0.12 ]
 [0.39  0.026 0.364 0.221]
 [0.115 0.077 0.385 0.423]]
Validation acc: 0.6236766121270453
Validation class_accuracies: [0.7108108108108108, 0.42391304347826086, 0.36363636363636365, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48035928525058963
Validation one_indexed_epoch: 13
Epoch 13/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 883s - accuracy: 0.6445 - student_loss: 0.2853 - distillation_loss: -6.0388e-03 - val_accuracy: 0.5332 - val_student_loss: 1.7744 - 883s/epoch - 3s/step
Validation cm: [[407 256  42  35]
 [ 34  44   7   7]
 [ 12  24   5  36]
 [ 11  18  45  56]]
Validation normalized_cm: [[0.55  0.346 0.057 0.047]
 [0.37  0.478 0.076 0.076]
 [0.156 0.312 0.065 0.468]
 [0.085 0.138 0.346 0.431]]
Validation acc: 0.49278152069297404
Validation class_accuracies: [0.55, 0.4782608695652174, 0.06493506493506493, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3809912913173783
Validation one_indexed_epoch: 14
Epoch 14/40
[[0. 0.]]
The validation tracker metric at 0.48035928525058963 hasn't increased by 0 in 1 epochs
330/330 - 880s - accuracy: 0.6263 - student_loss: 0.6017 - distillation_loss: 0.0018 - val_accuracy: 0.6362 - val_student_loss: 0.3974 - 880s/epoch - 3s/step
Validation cm: [[569  37 124  10]
 [ 58  13  17   4]
 [ 26   0  48   3]
 [ 46   3  68  13]]
Validation normalized_cm: [[0.769 0.05  0.168 0.014]
 [0.63  0.141 0.185 0.043]
 [0.338 0.    0.623 0.039]
 [0.354 0.023 0.523 0.1  ]]
Validation acc: 0.6188642925890279
Validation class_accuracies: [0.768918918918919, 0.14130434782608695, 0.6233766233766234, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40839997253040733
Validation one_indexed_epoch: 15
Epoch 15/40
[[0. 0.]]
The validation tracker metric at 0.48035928525058963 hasn't increased by 0 in 2 epochs
330/330 - 883s - accuracy: 0.6350 - student_loss: 1.0728 - distillation_loss: 0.0124 - val_accuracy: 0.2089 - val_student_loss: 0.1052 - 883s/epoch - 3s/step
Validation cm: [[531  38  98  73]
 [ 32  12  21  27]
 [ 22   1  42  12]
 [  9   8  45  68]]
Validation normalized_cm: [[0.718 0.051 0.132 0.099]
 [0.348 0.13  0.228 0.293]
 [0.286 0.013 0.545 0.156]
 [0.069 0.062 0.346 0.523]]
Validation acc: 0.6284889316650626
Validation class_accuracies: [0.7175675675675676, 0.13043478260869565, 0.5454545454545454, 0.5230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4791334546769329
Validation one_indexed_epoch: 16
Epoch 16/40
[[0. 0.]]
The validation tracker metric at 0.48035928525058963 hasn't increased by 0 in 3 epochs
330/330 - 884s - accuracy: 0.6358 - student_loss: 0.1705 - distillation_loss: -5.3265e-03 - val_accuracy: 0.2705 - val_student_loss: 2.1067 - 884s/epoch - 3s/step
Validation cm: [[604 116   7  13]
 [ 41  47   1   3]
 [ 48   9  15   5]
 [ 70  23  15  22]]
Validation normalized_cm: [[0.816 0.157 0.009 0.018]
 [0.446 0.511 0.011 0.033]
 [0.623 0.117 0.195 0.065]
 [0.538 0.177 0.115 0.169]]
Validation acc: 0.6621751684311838
Validation class_accuracies: [0.8162162162162162, 0.5108695652173914, 0.19480519480519481, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4227804363673929
Validation one_indexed_epoch: 17
Epoch 17/40
[[0. 0.]]
The validation tracker metric at 0.48035928525058963 hasn't increased by 0 in 4 epochs
330/330 - 889s - accuracy: 0.6331 - student_loss: 0.2432 - distillation_loss: -3.2358e-03 - val_accuracy: 0.5371 - val_student_loss: 1.9500e-04 - 889s/epoch - 3s/step
Validation cm: [[627  77  21  15]
 [ 51  31   7   3]
 [ 47   3  26   1]
 [ 61   5  48  16]]
Validation normalized_cm: [[0.847 0.104 0.028 0.02 ]
 [0.554 0.337 0.076 0.033]
 [0.61  0.039 0.338 0.013]
 [0.469 0.038 0.369 0.123]]
Validation acc: 0.6737247353224254
Validation class_accuracies: [0.8472972972972973, 0.33695652173913043, 0.33766233766233766, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41124826994392216
Validation one_indexed_epoch: 18
Epoch 18/40
[[0. 0.]]
The validation tracker metric at 0.48035928525058963 hasn't increased by 0 in 5 epochs
330/330 - 890s - accuracy: 0.6827 - student_loss: 0.2465 - distillation_loss: -6.0053e-03 - val_accuracy: 0.3590 - val_student_loss: 0.0195 - 890s/epoch - 3s/step
Validation cm: [[694  21   9  16]
 [ 79   7   5   1]
 [ 59   0  18   0]
 [ 98   2  25   5]]
Validation normalized_cm: [[0.938 0.028 0.012 0.022]
 [0.859 0.076 0.054 0.011]
 [0.766 0.    0.234 0.   ]
 [0.754 0.015 0.192 0.038]]
Validation acc: 0.6968238691049086
Validation class_accuracies: [0.9378378378378378, 0.07608695652173914, 0.23376623376623376, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32153814164683736
Validation one_indexed_epoch: 19
Epoch 19/40
[[0. 0.]]
The validation tracker metric at 0.48035928525058963 hasn't increased by 0 in 6 epochs
330/330 - 890s - accuracy: 0.6491 - student_loss: 0.0411 - distillation_loss: 0.0014 - val_accuracy: 0.1530 - val_student_loss: 3.7834e-05 - 890s/epoch - 3s/step
Validation cm: [[551  91  79  19]
 [ 37  39  13   3]
 [ 28   5  38   6]
 [ 18  15  57  40]]
Validation normalized_cm: [[0.745 0.123 0.107 0.026]
 [0.402 0.424 0.141 0.033]
 [0.364 0.065 0.494 0.078]
 [0.138 0.115 0.438 0.308]]
Validation acc: 0.6429258902791145
Validation class_accuracies: [0.7445945945945946, 0.42391304347826086, 0.4935064935064935, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49242660981791414
Validation one_indexed_epoch: 20
Epoch 20/40
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 882s - accuracy: 0.6620 - student_loss: 0.6926 - distillation_loss: 0.0174 - val_accuracy: 0.3705 - val_student_loss: 0.8893 - 882s/epoch - 3s/step
Validation cm: [[643  46  41  10]
 [ 60  15  12   5]
 [ 33   4  34   6]
 [ 46  14  61   9]]
Validation normalized_cm: [[0.869 0.062 0.055 0.014]
 [0.652 0.163 0.13  0.054]
 [0.429 0.052 0.442 0.078]
 [0.354 0.108 0.469 0.069]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8689189189189189, 0.16304347826086957, 0.44155844155844154, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3856879019922498
Validation one_indexed_epoch: 21
Epoch 21/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 1 epochs
330/330 - 882s - accuracy: 0.6369 - student_loss: 0.5297 - distillation_loss: 0.0108 - val_accuracy: 0.3965 - val_student_loss: 0.0126 - 882s/epoch - 3s/step
Validation cm: [[615  56  40  29]
 [ 62  19   4   7]
 [ 43   2  27   5]
 [ 72   5  37  16]]
Validation normalized_cm: [[0.831 0.076 0.054 0.039]
 [0.674 0.207 0.043 0.076]
 [0.558 0.026 0.351 0.065]
 [0.554 0.038 0.285 0.123]]
Validation acc: 0.6515880654475458
Validation class_accuracies: [0.831081081081081, 0.20652173913043478, 0.35064935064935066, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37783227348444737
Validation one_indexed_epoch: 22
Epoch 22/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 2 epochs
330/330 - 880s - accuracy: 0.6434 - student_loss: 0.2393 - distillation_loss: -6.5969e-03 - val_accuracy: 0.3561 - val_student_loss: 2.0911e-04 - 880s/epoch - 3s/step
Validation cm: [[596  62  80   2]
 [ 54  14  22   2]
 [ 40   3  28   6]
 [ 23   8  85  14]]
Validation normalized_cm: [[0.805 0.084 0.108 0.003]
 [0.587 0.152 0.239 0.022]
 [0.519 0.039 0.364 0.078]
 [0.177 0.062 0.654 0.108]]
Validation acc: 0.6275264677574591
Validation class_accuracies: [0.8054054054054054, 0.15217391304347827, 0.36363636363636365, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3572269974443888
Validation one_indexed_epoch: 23
Epoch 23/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 3 epochs
330/330 - 883s - accuracy: 0.6333 - student_loss: 0.1687 - distillation_loss: -4.7761e-03 - val_accuracy: 0.2320 - val_student_loss: 0.7718 - 883s/epoch - 3s/step
Validation cm: [[550  77  98  15]
 [ 41  20  26   5]
 [ 24   4  39  10]
 [ 15   9  83  23]]
Validation normalized_cm: [[0.743 0.104 0.132 0.02 ]
 [0.446 0.217 0.283 0.054]
 [0.312 0.052 0.506 0.13 ]
 [0.115 0.069 0.638 0.177]]
Validation acc: 0.6082771896053898
Validation class_accuracies: [0.7432432432432432, 0.21739130434782608, 0.5064935064935064, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41101278275191316
Validation one_indexed_epoch: 24
Epoch 24/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 4 epochs
330/330 - 882s - accuracy: 0.6502 - student_loss: 0.2164 - distillation_loss: 0.0044 - val_accuracy: 0.3244 - val_student_loss: 2.1554 - 882s/epoch - 3s/step
Validation cm: [[700  34   5   1]
 [ 83   8   1   0]
 [ 62   2  13   0]
 [100   7  19   4]]
Validation normalized_cm: [[0.946 0.046 0.007 0.001]
 [0.902 0.087 0.011 0.   ]
 [0.805 0.026 0.169 0.   ]
 [0.769 0.054 0.146 0.031]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.9459459459459459, 0.08695652173913043, 0.16883116883116883, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.308125716821369
Validation one_indexed_epoch: 25
Epoch 25/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 5 epochs
330/330 - 909s - accuracy: 0.6684 - student_loss: 0.8540 - distillation_loss: 0.0050 - val_accuracy: 0.2907 - val_student_loss: 7.3571e-10 - 909s/epoch - 3s/step
Validation cm: [[528 141  52  19]
 [ 24  46  13   9]
 [ 37  10  26   4]
 [ 13  18  71  28]]
Validation normalized_cm: [[0.714 0.191 0.07  0.026]
 [0.261 0.5   0.141 0.098]
 [0.481 0.13  0.338 0.052]
 [0.1   0.138 0.546 0.215]]
Validation acc: 0.6044273339749759
Validation class_accuracies: [0.7135135135135136, 0.5, 0.33766233766233766, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4416401166401167
Validation one_indexed_epoch: 26
Epoch 26/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 6 epochs
330/330 - 893s - accuracy: 0.6356 - student_loss: 0.0391 - distillation_loss: -1.5839e-03 - val_accuracy: 0.4649 - val_student_loss: 3.1122 - 893s/epoch - 3s/step
Validation cm: [[678  51   7   4]
 [ 77  13   1   1]
 [ 50   4  23   0]
 [ 89   6  27   8]]
Validation normalized_cm: [[0.916 0.069 0.009 0.005]
 [0.837 0.141 0.011 0.011]
 [0.649 0.052 0.299 0.   ]
 [0.685 0.046 0.208 0.062]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.9162162162162162, 0.14130434782608695, 0.2987012987012987, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35444008107051583
Validation one_indexed_epoch: 27
Epoch 27/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 7 epochs
330/330 - 884s - accuracy: 0.6447 - student_loss: 0.9609 - distillation_loss: 0.0077 - val_accuracy: 0.4870 - val_student_loss: 1.1320e-05 - 884s/epoch - 3s/step
Validation cm: [[672  53   7   8]
 [ 63  19  10   0]
 [ 50   6  16   5]
 [ 51  10  53  16]]
Validation normalized_cm: [[0.908 0.072 0.009 0.011]
 [0.685 0.207 0.109 0.   ]
 [0.649 0.078 0.208 0.065]
 [0.392 0.077 0.408 0.123]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.9081081081081082, 0.20652173913043478, 0.2077922077922078, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3613747445269185
Validation one_indexed_epoch: 28
Epoch 28/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 8 epochs
330/330 - 891s - accuracy: 0.6895 - student_loss: 0.0213 - distillation_loss: -4.4193e-04 - val_accuracy: 0.3638 - val_student_loss: 0.3176 - 891s/epoch - 3s/step
Validation cm: [[582  26  76  56]
 [ 33  10  24  25]
 [ 26   1  43   7]
 [ 27   1  71  31]]
Validation normalized_cm: [[0.786 0.035 0.103 0.076]
 [0.359 0.109 0.261 0.272]
 [0.338 0.013 0.558 0.091]
 [0.208 0.008 0.546 0.238]]
Validation acc: 0.6410009624639076
Validation class_accuracies: [0.7864864864864864, 0.10869565217391304, 0.5584415584415584, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4230213088908741
Validation one_indexed_epoch: 29
Epoch 29/40
[[0. 0.]]
The validation tracker metric at 0.49242660981791414 hasn't increased by 0 in 9 epochs
330/330 - 882s - accuracy: 0.6563 - student_loss: 0.0343 - distillation_loss: -9.2401e-04 - val_accuracy: 0.3138 - val_student_loss: 0.0393 - 882s/epoch - 3s/step
Validation cm: [[676  51  10   3]
 [ 68  15   6   3]
 [ 55   2  18   2]
 [ 74   8  39   9]]
Validation normalized_cm: [[0.914 0.069 0.014 0.004]
 [0.739 0.163 0.065 0.033]
 [0.714 0.026 0.234 0.026]
 [0.569 0.062 0.3   0.069]]
Validation acc: 0.6910490856592878
Validation class_accuracies: [0.9135135135135135, 0.16304347826086957, 0.23376623376623376, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.34488849869284655
Validation one_indexed_epoch: 30
Epoch 30/40
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 883s - accuracy: 0.6373 - student_loss: 0.4746 - distillation_loss: -8.6686e-03 - val_accuracy: 0.4447 - val_student_loss: 8.9572e-04 - 883s/epoch - 3s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.49242660981791414
Best cm: [[551  91  79  19]
 [ 37  39  13   3]
 [ 28   5  38   6]
 [ 18  15  57  40]]
Best normalized_cm: [[0.745 0.123 0.107 0.026]
 [0.402 0.424 0.141 0.033]
 [0.364 0.065 0.494 0.078]
 [0.138 0.115 0.438 0.308]]
Best acc: 0.6429258902791145
Best class_accuracies: [0.7445945945945946, 0.42391304347826086, 0.4935064935064935, 0.3076923076923077]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 20
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
