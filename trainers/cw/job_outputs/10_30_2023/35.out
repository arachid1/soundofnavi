Validation cm: [[  0 740   0   0]
 [  0  92   0   0]
 [  0  77   0   0]
 [  0 130   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.08854667949951876
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train35
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization (BatchNormalization)        multiple                                    4                
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_3 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense (Dense)                                   multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[1. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 611s - loss: 0.5105 - accuracy: 0.5716 - 611s/epoch - 2s/step
Validation cm: [[541  53 144   2]
 [ 46  23  18   5]
 [ 15   2  60   0]
 [ 32   1  97   0]]
Validation normalized_cm: [[0.731 0.072 0.195 0.003]
 [0.5   0.25  0.196 0.054]
 [0.195 0.026 0.779 0.   ]
 [0.246 0.008 0.746 0.   ]]
Validation acc: 0.6005774783445621
Validation class_accuracies: [0.731081081081081, 0.25, 0.7792207792207793, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4400754650754651
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 1.]]
-- New best results were achieved. --
Saving model...
330/330 - 595s - loss: 0.4095 - accuracy: 0.5747 - 595s/epoch - 2s/step
Validation cm: [[614   2 118   6]
 [ 52   1  36   3]
 [ 22   0  53   2]
 [ 20   0 106   4]]
Validation normalized_cm: [[0.83  0.003 0.159 0.008]
 [0.565 0.011 0.391 0.033]
 [0.286 0.    0.688 0.026]
 [0.154 0.    0.815 0.031]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.8297297297297297, 0.010869565217391304, 0.6883116883116883, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38992005350701
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
The validation tracker metric at 0.4400754650754651 hasn't increased by 0 in 1 epochs
330/330 - 595s - loss: 0.3773 - accuracy: 0.6161 - 595s/epoch - 2s/step
Validation cm: [[529  51 139  21]
 [ 53  14  18   7]
 [ 20   1  39  17]
 [ 17   1  56  56]]
Validation normalized_cm: [[0.715 0.069 0.188 0.028]
 [0.576 0.152 0.196 0.076]
 [0.26  0.013 0.506 0.221]
 [0.131 0.008 0.431 0.431]]
Validation acc: 0.6140519730510106
Validation class_accuracies: [0.7148648648648649, 0.15217391304347827, 0.5064935064935064, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4510753787927701
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 593s - loss: 0.3628 - accuracy: 0.6197 - 593s/epoch - 2s/step
Validation cm: [[500 216  21   3]
 [ 21  48  12  11]
 [ 44  12  13   8]
 [ 10  29  74  17]]
Validation normalized_cm: [[0.676 0.292 0.028 0.004]
 [0.228 0.522 0.13  0.12 ]
 [0.571 0.156 0.169 0.104]
 [0.077 0.223 0.569 0.131]]
Validation acc: 0.5563041385948027
Validation class_accuracies: [0.6756756756756757, 0.5217391304347826, 0.16883116883116883, 0.13076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3742538014277144
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.4510753787927701 hasn't increased by 0 in 1 epochs
330/330 - 592s - loss: 0.3422 - accuracy: 0.6225 - 592s/epoch - 2s/step
Validation cm: [[633  22  64  21]
 [ 53   8  18  13]
 [ 24   0  35  18]
 [ 19   0  76  35]]
Validation normalized_cm: [[0.855 0.03  0.086 0.028]
 [0.576 0.087 0.196 0.141]
 [0.312 0.    0.455 0.234]
 [0.146 0.    0.585 0.269]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.8554054054054054, 0.08695652173913043, 0.45454545454545453, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4165345377301899
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.4510753787927701 hasn't increased by 0 in 2 epochs
330/330 - 593s - loss: 0.3309 - accuracy: 0.6102 - 593s/epoch - 2s/step
Validation cm: [[642  79  13   6]
 [ 35  48   3   6]
 [ 54   3  14   6]
 [ 32  10  67  21]]
Validation normalized_cm: [[0.868 0.107 0.018 0.008]
 [0.38  0.522 0.033 0.065]
 [0.701 0.039 0.182 0.078]
 [0.246 0.077 0.515 0.162]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.8675675675675676, 0.5217391304347826, 0.18181818181818182, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4331658353397484
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.4510753787927701 hasn't increased by 0 in 3 epochs
330/330 - 594s - loss: 0.3206 - accuracy: 0.6206 - 594s/epoch - 2s/step
Validation cm: [[545 104  64  27]
 [ 17  44  15  16]
 [ 17   4  46  10]
 [  6  11  83  30]]
Validation normalized_cm: [[0.736 0.141 0.086 0.036]
 [0.185 0.478 0.163 0.174]
 [0.221 0.052 0.597 0.13 ]
 [0.046 0.085 0.638 0.231]]
Validation acc: 0.6400384985563041
Validation class_accuracies: [0.7364864864864865, 0.4782608695652174, 0.5974025974025974, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.510729796055883
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 595s - loss: 0.3011 - accuracy: 0.6622 - 595s/epoch - 2s/step
Validation cm: [[510  18 144  68]
 [ 31  12  16  33]
 [ 12   2  16  47]
 [ 22  10  22  76]]
Validation normalized_cm: [[0.689 0.024 0.195 0.092]
 [0.337 0.13  0.174 0.359]
 [0.156 0.026 0.208 0.61 ]
 [0.169 0.077 0.169 0.585]]
Validation acc: 0.5909528392685275
Validation class_accuracies: [0.6891891891891891, 0.13043478260869565, 0.2077922077922078, 0.5846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40300789105136936
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 1.]]
The validation tracker metric at 0.510729796055883 hasn't increased by 0 in 1 epochs
330/330 - 590s - loss: 0.2908 - accuracy: 0.6633 - 590s/epoch - 2s/step
Validation cm: [[558 161  17   4]
 [ 17  59  10   6]
 [ 34   8  27   8]
 [  9  20  79  22]]
Validation normalized_cm: [[0.754 0.218 0.023 0.005]
 [0.185 0.641 0.109 0.065]
 [0.442 0.104 0.351 0.104]
 [0.069 0.154 0.608 0.169]]
Validation acc: 0.6410009624639076
Validation class_accuracies: [0.754054054054054, 0.6413043478260869, 0.35064935064935066, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47880963044006525
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.510729796055883 hasn't increased by 0 in 2 epochs
330/330 - 598s - loss: 0.2790 - accuracy: 0.6180 - 598s/epoch - 2s/step
Validation cm: [[697  30   5   8]
 [ 63  23   2   4]
 [ 49   3  19   6]
 [ 41  10  58  21]]
Validation normalized_cm: [[0.942 0.041 0.007 0.011]
 [0.685 0.25  0.022 0.043]
 [0.636 0.039 0.247 0.078]
 [0.315 0.077 0.446 0.162]]
Validation acc: 0.7314725697786333
Validation class_accuracies: [0.9418918918918919, 0.25, 0.24675324675324675, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.40004590004590007
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.510729796055883 hasn't increased by 0 in 3 epochs
330/330 - 610s - loss: 0.2619 - accuracy: 0.6354 - 610s/epoch - 2s/step
Validation cm: [[577 142  15   6]
 [ 23  57  10   2]
 [ 32  14  15  16]
 [ 13  23  64  30]]
Validation normalized_cm: [[0.78  0.192 0.02  0.008]
 [0.25  0.62  0.109 0.022]
 [0.416 0.182 0.195 0.208]
 [0.1   0.177 0.492 0.231]]
Validation acc: 0.6535129932627527
Validation class_accuracies: [0.7797297297297298, 0.6195652173913043, 0.19480519480519481, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4562173431738649
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.510729796055883 hasn't increased by 0 in 4 epochs
330/330 - 609s - loss: 0.2630 - accuracy: 0.6324 - 609s/epoch - 2s/step
Validation cm: [[536 109  58  37]
 [ 30  34   2  26]
 [ 15   3  26  33]
 [  6  20  15  89]]
Validation normalized_cm: [[0.724 0.147 0.078 0.05 ]
 [0.326 0.37  0.022 0.283]
 [0.195 0.039 0.338 0.429]
 [0.046 0.154 0.115 0.685]]
Validation acc: 0.6592877767083735
Validation class_accuracies: [0.7243243243243244, 0.3695652173913043, 0.33766233766233766, 0.6846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5290418159983377
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 604s - loss: 0.2432 - accuracy: 0.6343 - 604s/epoch - 2s/step
Validation cm: [[663  56  14   7]
 [ 56  30   4   2]
 [ 48   4  19   6]
 [ 53  12  37  28]]
Validation normalized_cm: [[0.896 0.076 0.019 0.009]
 [0.609 0.326 0.043 0.022]
 [0.623 0.052 0.247 0.078]
 [0.408 0.092 0.285 0.215]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.8959459459459459, 0.32608695652173914, 0.24675324675324675, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4210426911513868
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.5290418159983377 hasn't increased by 0 in 1 epochs
330/330 - 633s - loss: 0.2306 - accuracy: 0.6396 - 633s/epoch - 2s/step
Validation cm: [[664  60  11   5]
 [ 61  21   5   5]
 [ 54   2  20   1]
 [ 60   4  53  13]]
Validation normalized_cm: [[0.897 0.081 0.015 0.007]
 [0.663 0.228 0.054 0.054]
 [0.701 0.026 0.26  0.013]
 [0.462 0.031 0.408 0.1  ]]
Validation acc: 0.6910490856592878
Validation class_accuracies: [0.8972972972972973, 0.22826086956521738, 0.2597402597402597, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37132460665069367
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.5290418159983377 hasn't increased by 0 in 2 epochs
330/330 - 658s - loss: 0.2256 - accuracy: 0.6555 - 658s/epoch - 2s/step
Validation cm: [[676  50   6   8]
 [ 54  23   6   9]
 [ 56   5  12   4]
 [ 44  36  36  14]]
Validation normalized_cm: [[0.914 0.068 0.008 0.011]
 [0.587 0.25  0.065 0.098]
 [0.727 0.065 0.156 0.052]
 [0.338 0.277 0.277 0.108]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.9135135135135135, 0.25, 0.15584415584415584, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3567624942624943
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.5290418159983377 hasn't increased by 0 in 3 epochs
330/330 - 655s - loss: 0.2100 - accuracy: 0.6817 - 655s/epoch - 2s/step
Validation cm: [[618  59  47  16]
 [ 39  29  14  10]
 [ 25   5  46   1]
 [ 20   7  67  36]]
Validation normalized_cm: [[0.835 0.08  0.064 0.022]
 [0.424 0.315 0.152 0.109]
 [0.325 0.065 0.597 0.013]
 [0.154 0.054 0.515 0.277]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.8351351351351352, 0.31521739130434784, 0.5974025974025974, 0.27692307692307694]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5061695501912893
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The validation tracker metric at 0.5290418159983377 hasn't increased by 0 in 4 epochs
330/330 - 650s - loss: 0.2068 - accuracy: 0.6851 - 650s/epoch - 2s/step
Validation cm: [[522  52 118  48]
 [ 24  22  12  34]
 [ 12   2  49  14]
 [  6  12  46  66]]
Validation normalized_cm: [[0.705 0.07  0.159 0.065]
 [0.261 0.239 0.13  0.37 ]
 [0.156 0.026 0.636 0.182]
 [0.046 0.092 0.354 0.508]]
Validation acc: 0.6342637151106834
Validation class_accuracies: [0.7054054054054054, 0.2391304347826087, 0.6363636363636364, 0.5076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5221479460609896
Validation one_indexed_epoch: 18
Epoch 18/20
[[0. 0.]]
The validation tracker metric at 0.5290418159983377 hasn't increased by 0 in 5 epochs
330/330 - 646s - loss: 0.1831 - accuracy: 0.6517 - 646s/epoch - 2s/step
Validation cm: [[449  19 236  36]
 [ 22  13  34  23]
 [  8   3  55  11]
 [  4   7  48  71]]
Validation normalized_cm: [[0.607 0.026 0.319 0.049]
 [0.239 0.141 0.37  0.25 ]
 [0.104 0.039 0.714 0.143]
 [0.031 0.054 0.369 0.546]]
Validation acc: 0.5659287776708374
Validation class_accuracies: [0.6067567567567568, 0.14130434782608695, 0.7142857142857143, 0.5461538461538461]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.502125166255601
Validation one_indexed_epoch: 19
Epoch 19/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 644s - loss: 0.1757 - accuracy: 0.6758 - 644s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5290418159983377
Best cm: [[536 109  58  37]
 [ 30  34   2  26]
 [ 15   3  26  33]
 [  6  20  15  89]]
Best normalized_cm: [[0.724 0.147 0.078 0.05 ]
 [0.326 0.37  0.022 0.283]
 [0.195 0.039 0.338 0.429]
 [0.046 0.154 0.115 0.685]]
Best acc: 0.6592877767083735
Best class_accuracies: [0.7243243243243244, 0.3695652173913043, 0.33766233766233766, 0.6846153846153846]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 13
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_4 (Sequential)                       (None, 128)                                 105694           
                                                                                                              
 dense_1 (Dense)                                 multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 783s - accuracy: 0.5984 - student_loss: 0.2908 - distillation_loss: -1.3602e-03 - val_accuracy: 0.0741 - val_student_loss: 0.3713 - 783s/epoch - 2s/step
Validation cm: [[488 226  21   5]
 [ 21  58  10   3]
 [ 36  20  10  11]
 [ 11  34  75  10]]
Validation normalized_cm: [[0.659 0.305 0.028 0.007]
 [0.228 0.63  0.109 0.033]
 [0.468 0.26  0.13  0.143]
 [0.085 0.262 0.577 0.077]]
Validation acc: 0.5447545717035611
Validation class_accuracies: [0.6594594594594595, 0.6304347826086957, 0.12987012987012986, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3741718622153405
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 773s - accuracy: 0.6466 - student_loss: 0.3456 - distillation_loss: 0.0022 - val_accuracy: 0.7016 - val_student_loss: 0.8429 - 773s/epoch - 2s/step
Validation cm: [[619  96  17   8]
 [ 34  46  10   2]
 [ 59   8   8   2]
 [ 25  19  70  16]]
Validation normalized_cm: [[0.836 0.13  0.023 0.011]
 [0.37  0.5   0.109 0.022]
 [0.766 0.104 0.104 0.026]
 [0.192 0.146 0.538 0.123]]
Validation acc: 0.6631376323387873
Validation class_accuracies: [0.8364864864864865, 0.5, 0.1038961038961039, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3908648783648784
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 774s - accuracy: 0.6386 - student_loss: 0.7062 - distillation_loss: 0.0094 - val_accuracy: 0.7854 - val_student_loss: 1.7759 - 774s/epoch - 2s/step
Validation cm: [[608  61  43  28]
 [ 27  39  10  16]
 [ 24   4  37  12]
 [ 24   3  58  45]]
Validation normalized_cm: [[0.822 0.082 0.058 0.038]
 [0.293 0.424 0.109 0.174]
 [0.312 0.052 0.481 0.156]
 [0.185 0.023 0.446 0.346]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.8216216216216217, 0.42391304347826086, 0.4805194805194805, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5180519979433023
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 772s - accuracy: 0.6681 - student_loss: 0.2354 - distillation_loss: 0.0067 - val_accuracy: 0.6035 - val_student_loss: 1.3930 - 772s/epoch - 2s/step
Validation cm: [[608  62  52  18]
 [ 45  31   9   7]
 [ 20   2  41  14]
 [ 46   9  42  33]]
Validation normalized_cm: [[0.822 0.084 0.07  0.024]
 [0.489 0.337 0.098 0.076]
 [0.26  0.026 0.532 0.182]
 [0.354 0.069 0.323 0.254]]
Validation acc: 0.6862367661212705
Validation class_accuracies: [0.8216216216216217, 0.33695652173913043, 0.5324675324675324, 0.25384615384615383]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.48622295741860955
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.5180519979433023 hasn't increased by 0 in 1 epochs
330/330 - 773s - accuracy: 0.6396 - student_loss: 0.2178 - distillation_loss: 0.0022 - val_accuracy: 0.4687 - val_student_loss: 0.3501 - 773s/epoch - 2s/step
Validation cm: [[552 126  36  26]
 [ 19  49   9  15]
 [ 23   3  35  16]
 [  9  19  47  55]]
Validation normalized_cm: [[0.746 0.17  0.049 0.035]
 [0.207 0.533 0.098 0.163]
 [0.299 0.039 0.455 0.208]
 [0.069 0.146 0.362 0.423]]
Validation acc: 0.6650625601539942
Validation class_accuracies: [0.745945945945946, 0.532608695652174, 0.45454545454545453, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5390442548051244
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 769s - accuracy: 0.6367 - student_loss: 0.2853 - distillation_loss: 0.0035 - val_accuracy: 0.5717 - val_student_loss: 1.1599 - 769s/epoch - 2s/step
Validation cm: [[530  39 126  45]
 [ 24  21  23  24]
 [ 16   1  46  14]
 [  5   1  78  46]]
Validation normalized_cm: [[0.716 0.053 0.17  0.061]
 [0.261 0.228 0.25  0.261]
 [0.208 0.013 0.597 0.182]
 [0.038 0.008 0.6   0.354]]
Validation acc: 0.6188642925890279
Validation class_accuracies: [0.7162162162162162, 0.22826086956521738, 0.5974025974025974, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4739314592575462
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.5390442548051244 hasn't increased by 0 in 1 epochs
330/330 - 768s - accuracy: 0.6449 - student_loss: 0.2465 - distillation_loss: 0.0122 - val_accuracy: 0.2339 - val_student_loss: 1.9340 - 768s/epoch - 2s/step
Validation cm: [[676  38  16  10]
 [ 62  11  10   9]
 [ 42   1  26   8]
 [ 36   4  55  35]]
Validation normalized_cm: [[0.914 0.051 0.022 0.014]
 [0.674 0.12  0.109 0.098]
 [0.545 0.013 0.338 0.104]
 [0.277 0.031 0.423 0.269]]
Validation acc: 0.7199230028873917
Validation class_accuracies: [0.9135135135135135, 0.11956521739130435, 0.33766233766233766, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4099929594494812
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.5390442548051244 hasn't increased by 0 in 2 epochs
330/330 - 800s - accuracy: 0.6447 - student_loss: 0.0621 - distillation_loss: 0.0049 - val_accuracy: 0.4456 - val_student_loss: 0.9470 - 800s/epoch - 2s/step
Validation cm: [[535  31 106  68]
 [ 14  19  16  43]
 [ 16   1  36  24]
 [ 12   4  40  74]]
Validation normalized_cm: [[0.723 0.042 0.143 0.092]
 [0.152 0.207 0.174 0.467]
 [0.208 0.013 0.468 0.312]
 [0.092 0.031 0.308 0.569]]
Validation acc: 0.6390760346487007
Validation class_accuracies: [0.722972972972973, 0.20652173913043478, 0.4675324675324675, 0.5692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49156448721666113
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5390442548051244 hasn't increased by 0 in 3 epochs
330/330 - 804s - accuracy: 0.6548 - student_loss: 0.1795 - distillation_loss: 0.0052 - val_accuracy: 0.4196 - val_student_loss: 1.6576 - 804s/epoch - 2s/step
Validation cm: [[651  87   0   2]
 [ 42  47   1   2]
 [ 49  13  10   5]
 [ 56  30  13  31]]
Validation normalized_cm: [[0.88  0.118 0.    0.003]
 [0.457 0.511 0.011 0.022]
 [0.636 0.169 0.13  0.065]
 [0.431 0.231 0.1   0.238]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.8797297297297297, 0.5108695652173914, 0.12987012987012986, 0.23846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4397327408196974
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5390442548051244 hasn't increased by 0 in 4 epochs
330/330 - 798s - accuracy: 0.6576 - student_loss: 0.3040 - distillation_loss: 0.0091 - val_accuracy: 0.8287 - val_student_loss: 0.0340 - 798s/epoch - 2s/step
Validation cm: [[584 106  28  22]
 [ 16  49  12  15]
 [ 23   7  33  14]
 [ 22  12  48  48]]
Validation normalized_cm: [[0.789 0.143 0.038 0.03 ]
 [0.174 0.533 0.13  0.163]
 [0.299 0.091 0.429 0.182]
 [0.169 0.092 0.369 0.369]]
Validation acc: 0.687199230028874
Validation class_accuracies: [0.7891891891891892, 0.532608695652174, 0.42857142857142855, 0.36923076923076925]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5299000206608903
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.5390442548051244 hasn't increased by 0 in 5 epochs
330/330 - 783s - accuracy: 0.6703 - student_loss: 0.4408 - distillation_loss: 0.0041 - val_accuracy: 0.5929 - val_student_loss: 2.0973 - 783s/epoch - 2s/step
Validation cm: [[618  81  23  18]
 [ 24  44   8  16]
 [ 32   4  31  10]
 [ 26  27  30  47]]
Validation normalized_cm: [[0.835 0.109 0.031 0.024]
 [0.261 0.478 0.087 0.174]
 [0.416 0.052 0.403 0.13 ]
 [0.2   0.208 0.231 0.362]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [0.8351351351351352, 0.4782608695652174, 0.4025974025974026, 0.36153846153846153]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5193829672090542
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 793s - accuracy: 0.6445 - student_loss: 0.0289 - distillation_loss: 0.0078 - val_accuracy: 0.5852 - val_student_loss: 0.2841 - 793s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5390442548051244
Best cm: [[552 126  36  26]
 [ 19  49   9  15]
 [ 23   3  35  16]
 [  9  19  47  55]]
Best normalized_cm: [[0.746 0.17  0.049 0.035]
 [0.207 0.533 0.098 0.163]
 [0.299 0.039 0.455 0.208]
 [0.069 0.146 0.362 0.423]]
Best acc: 0.6650625601539942
Best class_accuracies: [0.745945945945946, 0.532608695652174, 0.45454545454545453, 0.4230769230769231]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 6
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
