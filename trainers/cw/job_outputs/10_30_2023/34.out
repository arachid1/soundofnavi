Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train34
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf__mo_e_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization (BatchNormalization)        multiple                                    4                
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 8)                          5761232          
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 8)                          5763280          
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 8)                          640048           
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_3 (Sequential)                       (None, 512)                                 6169888          
                                                                                                              
 dense (Dense)                                   multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 18,336,038
Trainable params: 18,295,156
Non-trainable params: 40,882
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 654s - loss: 0.5396 - accuracy: 0.5350 - 654s/epoch - 2s/step
Validation cm: [[710  26   3   1]
 [ 91   0   1   0]
 [ 77   0   0   0]
 [123   0   7   0]]
Validation normalized_cm: [[0.959 0.035 0.004 0.001]
 [0.989 0.    0.011 0.   ]
 [1.    0.    0.    0.   ]
 [0.946 0.    0.054 0.   ]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.9594594594594594, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.23986486486486486
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
The validation tracker metric at 0.25 hasn't increased by 0 in 1 epochs
330/330 - 640s - loss: 0.4528 - accuracy: 0.5227 - 640s/epoch - 2s/step
Validation cm: [[631  90  17   2]
 [ 44  33  11   4]
 [ 70   3   4   0]
 [ 41  27  62   0]]
Validation normalized_cm: [[0.853 0.122 0.023 0.003]
 [0.478 0.359 0.12  0.043]
 [0.909 0.039 0.052 0.   ]
 [0.315 0.208 0.477 0.   ]]
Validation acc: 0.6429258902791145
Validation class_accuracies: [0.8527027027027027, 0.358695652173913, 0.05194805194805195, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3158366017061669
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 615s - loss: 0.4452 - accuracy: 0.5350 - 615s/epoch - 2s/step
Validation cm: [[693  14  25   8]
 [ 67   2  22   1]
 [ 68   0   9   0]
 [ 51   3  75   1]]
Validation normalized_cm: [[0.936 0.019 0.034 0.011]
 [0.728 0.022 0.239 0.011]
 [0.883 0.    0.117 0.   ]
 [0.392 0.023 0.577 0.008]]
Validation acc: 0.6785370548604427
Validation class_accuracies: [0.9364864864864865, 0.021739130434782608, 0.11688311688311688, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2707002603741734
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
The validation tracker metric at 0.3158366017061669 hasn't increased by 0 in 1 epochs
330/330 - 581s - loss: 0.4253 - accuracy: 0.4988 - 581s/epoch - 2s/step
Validation cm: [[690  25  22   3]
 [ 65   5  20   2]
 [ 68   1   8   0]
 [ 52   3  75   0]]
Validation normalized_cm: [[0.932 0.034 0.03  0.004]
 [0.707 0.054 0.217 0.022]
 [0.883 0.013 0.104 0.   ]
 [0.4   0.023 0.577 0.   ]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.9324324324324325, 0.05434782608695652, 0.1038961038961039, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.27266909060387323
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.3158366017061669 hasn't increased by 0 in 2 epochs
330/330 - 582s - loss: 0.4034 - accuracy: 0.4859 - 582s/epoch - 2s/step
Validation cm: [[602  90  30  18]
 [ 26  34  13  19]
 [ 46   7  18   6]
 [ 28  27  68   7]]
Validation normalized_cm: [[0.814 0.122 0.041 0.024]
 [0.283 0.37  0.141 0.207]
 [0.597 0.091 0.234 0.078]
 [0.215 0.208 0.523 0.054]]
Validation acc: 0.6361886429258903
Validation class_accuracies: [0.8135135135135135, 0.3695652173913043, 0.23376623376623376, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3676727796293014
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 581s - loss: 0.3900 - accuracy: 0.5232 - 581s/epoch - 2s/step
Validation cm: [[688   8  31  13]
 [ 69   2  15   6]
 [ 57   0  17   3]
 [ 47   1  80   2]]
Validation normalized_cm: [[0.93  0.011 0.042 0.018]
 [0.75  0.022 0.163 0.065]
 [0.74  0.    0.221 0.039]
 [0.362 0.008 0.615 0.015]]
Validation acc: 0.6823869104908566
Validation class_accuracies: [0.9297297297297298, 0.021739130434782608, 0.22077922077922077, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.29690817408208714
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.3676727796293014 hasn't increased by 0 in 1 epochs
330/330 - 583s - loss: 0.3632 - accuracy: 0.5975 - 583s/epoch - 2s/step
Validation cm: [[339  77 198 126]
 [ 12  14  12  54]
 [ 10   2  29  36]
 [  6  10  32  82]]
Validation normalized_cm: [[0.458 0.104 0.268 0.17 ]
 [0.13  0.152 0.13  0.587]
 [0.13  0.026 0.377 0.468]
 [0.046 0.077 0.246 0.631]]
Validation acc: 0.4465832531280077
Validation class_accuracies: [0.4581081081081081, 0.15217391304347827, 0.37662337662337664, 0.6307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4044186571360484
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 583s - loss: 0.3394 - accuracy: 0.6088 - 583s/epoch - 2s/step
Validation cm: [[562  46  89  43]
 [ 38  18  21  15]
 [ 28   2  30  17]
 [ 15   0  88  27]]
Validation normalized_cm: [[0.759 0.062 0.12  0.058]
 [0.413 0.196 0.228 0.163]
 [0.364 0.026 0.39  0.221]
 [0.115 0.    0.677 0.208]]
Validation acc: 0.6130895091434071
Validation class_accuracies: [0.7594594594594595, 0.1956521739130435, 0.38961038961038963, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3881035826688
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.4044186571360484 hasn't increased by 0 in 1 epochs
330/330 - 583s - loss: 0.3174 - accuracy: 0.5743 - 583s/epoch - 2s/step
Validation cm: [[624  76  34   6]
 [ 47  29   8   8]
 [ 51   7  14   5]
 [ 39  24  60   7]]
Validation normalized_cm: [[0.843 0.103 0.046 0.008]
 [0.511 0.315 0.087 0.087]
 [0.662 0.091 0.182 0.065]
 [0.3   0.185 0.462 0.054]]
Validation acc: 0.6487006737247353
Validation class_accuracies: [0.8432432432432433, 0.31521739130434784, 0.18181818181818182, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.34853124255298173
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.4044186571360484 hasn't increased by 0 in 2 epochs
330/330 - 582s - loss: 0.2912 - accuracy: 0.6062 - 582s/epoch - 2s/step
Validation cm: [[588  56  73  23]
 [ 39  18  22  13]
 [ 25   2  35  15]
 [ 35   6  77  12]]
Validation normalized_cm: [[0.795 0.076 0.099 0.031]
 [0.424 0.196 0.239 0.141]
 [0.325 0.026 0.455 0.195]
 [0.269 0.046 0.592 0.092]]
Validation acc: 0.6284889316650626
Validation class_accuracies: [0.7945945945945946, 0.1956521739130435, 0.45454545454545453, 0.09230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38427497884019624
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.4044186571360484 hasn't increased by 0 in 3 epochs
330/330 - 583s - loss: 0.2758 - accuracy: 0.6193 - 583s/epoch - 2s/step
Validation cm: [[613 111   9   7]
 [ 36  37   5  14]
 [ 47   7  13  10]
 [ 27  26  38  39]]
Validation normalized_cm: [[0.828 0.15  0.012 0.009]
 [0.391 0.402 0.054 0.152]
 [0.61  0.091 0.169 0.13 ]
 [0.208 0.2   0.292 0.3  ]]
Validation acc: 0.6756496631376323
Validation class_accuracies: [0.8283783783783784, 0.40217391304347827, 0.16883116883116883, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4248458650632564
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 591s - loss: 0.2554 - accuracy: 0.5904 - 591s/epoch - 2s/step
Validation cm: [[556 100  44  40]
 [ 36  33   8  15]
 [ 26   5  23  23]
 [ 27  16  53  34]]
Validation normalized_cm: [[0.751 0.135 0.059 0.054]
 [0.391 0.359 0.087 0.163]
 [0.338 0.065 0.299 0.299]
 [0.208 0.123 0.408 0.262]]
Validation acc: 0.6217516843118384
Validation class_accuracies: [0.7513513513513513, 0.358695652173913, 0.2987012987012987, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4175716909412561
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.4248458650632564 hasn't increased by 0 in 1 epochs
330/330 - 580s - loss: 0.2423 - accuracy: 0.5956 - 580s/epoch - 2s/step
Validation cm: [[705  24   6   5]
 [ 75   8   1   8]
 [ 56   2  17   2]
 [ 71   3  54   2]]
Validation normalized_cm: [[0.953 0.032 0.008 0.007]
 [0.815 0.087 0.011 0.087]
 [0.727 0.026 0.221 0.026]
 [0.546 0.023 0.415 0.015]]
Validation acc: 0.7045235803657363
Validation class_accuracies: [0.9527027027027027, 0.08695652173913043, 0.22077922077922077, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3189557651514173
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.4248458650632564 hasn't increased by 0 in 2 epochs
330/330 - 583s - loss: 0.2174 - accuracy: 0.6088 - 583s/epoch - 2s/step
Validation cm: [[618 106   8   8]
 [ 41  30  10  11]
 [ 45  13  12   7]
 [ 41  28  55   6]]
Validation normalized_cm: [[0.835 0.143 0.011 0.011]
 [0.446 0.326 0.109 0.12 ]
 [0.584 0.169 0.156 0.091]
 [0.315 0.215 0.423 0.046]]
Validation acc: 0.6410009624639076
Validation class_accuracies: [0.8351351351351352, 0.32608695652173914, 0.15584415584415584, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3408050234137191
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.4248458650632564 hasn't increased by 0 in 3 epochs
330/330 - 582s - loss: 0.2124 - accuracy: 0.6512 - 582s/epoch - 2s/step
Validation cm: [[654  63  11  12]
 [ 49  20  10  13]
 [ 46   3  21   7]
 [ 42  13  62  13]]
Validation normalized_cm: [[0.884 0.085 0.015 0.016]
 [0.533 0.217 0.109 0.141]
 [0.597 0.039 0.273 0.091]
 [0.323 0.1   0.477 0.1  ]]
Validation acc: 0.6814244465832531
Validation class_accuracies: [0.8837837837837837, 0.21739130434782608, 0.2727272727272727, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36847559021472065
Validation one_indexed_epoch: 16
Epoch 16/20
[[0. 0.]]
The validation tracker metric at 0.4248458650632564 hasn't increased by 0 in 4 epochs
330/330 - 582s - loss: 0.1965 - accuracy: 0.6223 - 582s/epoch - 2s/step
Validation cm: [[609  96  18  17]
 [ 34  32  13  13]
 [ 38   4  24  11]
 [ 33  16  66  15]]
Validation normalized_cm: [[0.823 0.13  0.024 0.023]
 [0.37  0.348 0.141 0.141]
 [0.494 0.052 0.312 0.143]
 [0.254 0.123 0.508 0.115]]
Validation acc: 0.6544754571703562
Validation class_accuracies: [0.822972972972973, 0.34782608695652173, 0.3116883116883117, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3994679967506055
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The validation tracker metric at 0.4248458650632564 hasn't increased by 0 in 5 epochs
330/330 - 582s - loss: 0.1751 - accuracy: 0.6356 - 582s/epoch - 2s/step
Validation cm: [[653  71  11   5]
 [ 43  33  11   5]
 [ 54   4  17   2]
 [ 49  16  51  14]]
Validation normalized_cm: [[0.882 0.096 0.015 0.007]
 [0.467 0.359 0.12  0.054]
 [0.701 0.052 0.221 0.026]
 [0.377 0.123 0.392 0.108]]
Validation acc: 0.6900866217516843
Validation class_accuracies: [0.8824324324324324, 0.358695652173913, 0.22077922077922077, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3923999032694685
Validation one_indexed_epoch: 18
Epoch 18/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 582s - loss: 0.1587 - accuracy: 0.6303 - 582s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.4248458650632564
Best cm: [[613 111   9   7]
 [ 36  37   5  14]
 [ 47   7  13  10]
 [ 27  26  38  39]]
Best normalized_cm: [[0.828 0.15  0.012 0.009]
 [0.391 0.402 0.054 0.152]
 [0.61  0.091 0.169 0.13 ]
 [0.208 0.2   0.292 0.3  ]]
Best acc: 0.6756496631376323
Best class_accuracies: [0.8283783783783784, 0.40217391304347827, 0.16883116883116883, 0.3]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 12
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
