Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train32
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model9_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 batch_normalization (BatchNormalization)        multiple                                    4                
                                                                                                              
 sequential (Sequential)                         (None, 80, 500, 16)                         2352             
                                                                                                              
 sequential_1 (Sequential)                       (None, 80, 500, 16)                         6448             
                                                                                                              
 sequential_2 (Sequential)                       (None, 80, 500, 16)                         32               
                                                                                                              
 concatenate (Concatenate)                       multiple                                    0                
                                                                                                              
 sequential_3 (Sequential)                       (None, 512)                                 6191296          
                                                                                                              
 dense (Dense)                                   multiple                                    1026             
                                                                                                              
==============================================================================================================
Total params: 6,201,718
Trainable params: 6,160,212
Non-trainable params: 41,506
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 669s - loss: 0.5051 - accuracy: 0.5407 - 669s/epoch - 2s/step
Validation cm: [[677   1  61   1]
 [ 71   0  19   2]
 [ 28   1  43   5]
 [ 33   0  83  14]]
Validation normalized_cm: [[0.915 0.001 0.082 0.001]
 [0.772 0.    0.207 0.022]
 [0.364 0.013 0.558 0.065]
 [0.254 0.    0.638 0.108]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.9148648648648648, 0.0, 0.5584415584415584, 0.1076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39524968274968275
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 653s - loss: 0.4078 - accuracy: 0.5950 - 653s/epoch - 2s/step
Validation cm: [[658  36  46   0]
 [ 72   3  17   0]
 [ 35   0  42   0]
 [ 28   5  96   1]]
Validation normalized_cm: [[0.889 0.049 0.062 0.   ]
 [0.783 0.033 0.185 0.   ]
 [0.455 0.    0.545 0.   ]
 [0.215 0.038 0.738 0.008]]
Validation acc: 0.6775745909528392
Validation class_accuracies: [0.8891891891891892, 0.03260869565217391, 0.5454545454545454, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.36873618449705403
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
The validation tracker metric at 0.39524968274968275 hasn't increased by 0 in 1 epochs
330/330 - 655s - loss: 0.3809 - accuracy: 0.6244 - 655s/epoch - 2s/step
Validation cm: [[667  57  16   0]
 [ 55  21  16   0]
 [ 67   3   7   0]
 [ 58   3  69   0]]
Validation normalized_cm: [[0.901 0.077 0.022 0.   ]
 [0.598 0.228 0.174 0.   ]
 [0.87  0.039 0.091 0.   ]
 [0.446 0.023 0.531 0.   ]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.9013513513513514, 0.22826086956521738, 0.09090909090909091, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.30513032795641487
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
The validation tracker metric at 0.39524968274968275 hasn't increased by 0 in 2 epochs
330/330 - 654s - loss: 0.3608 - accuracy: 0.5959 - 654s/epoch - 2s/step
Validation cm: [[691   2  46   1]
 [ 66   0  25   1]
 [ 34   0  39   4]
 [ 34   0  87   9]]
Validation normalized_cm: [[0.934 0.003 0.062 0.001]
 [0.717 0.    0.272 0.011]
 [0.442 0.    0.506 0.052]
 [0.262 0.    0.669 0.069]]
Validation acc: 0.7112608277189605
Validation class_accuracies: [0.9337837837837838, 0.0, 0.5064935064935064, 0.06923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37737701487701486
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.39524968274968275 hasn't increased by 0 in 3 epochs
330/330 - 654s - loss: 0.3475 - accuracy: 0.6037 - 654s/epoch - 2s/step
Validation cm: [[578 128  23  11]
 [ 27  46   6  13]
 [ 45   4  23   5]
 [ 31  14  60  25]]
Validation normalized_cm: [[0.781 0.173 0.031 0.015]
 [0.293 0.5   0.065 0.141]
 [0.584 0.052 0.299 0.065]
 [0.238 0.108 0.462 0.192]]
Validation acc: 0.6467757459095284
Validation class_accuracies: [0.7810810810810811, 0.5, 0.2987012987012987, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.443022518022518
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 652s - loss: 0.3350 - accuracy: 0.6290 - 652s/epoch - 2s/step
Validation cm: [[635  95  10   0]
 [ 48  38   4   2]
 [ 47   4  22   4]
 [ 29  13  70  18]]
Validation normalized_cm: [[0.858 0.128 0.014 0.   ]
 [0.522 0.413 0.043 0.022]
 [0.61  0.052 0.286 0.052]
 [0.223 0.1   0.538 0.138]]
Validation acc: 0.6862367661212705
Validation class_accuracies: [0.8581081081081081, 0.41304347826086957, 0.2857142857142857, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4238318526362005
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.443022518022518 hasn't increased by 0 in 1 epochs
330/330 - 649s - loss: 0.3208 - accuracy: 0.6453 - 649s/epoch - 2s/step
Validation cm: [[684  31  10  15]
 [ 62  10   9  11]
 [ 53   1  21   2]
 [ 57   1  45  27]]
Validation normalized_cm: [[0.924 0.042 0.014 0.02 ]
 [0.674 0.109 0.098 0.12 ]
 [0.688 0.013 0.273 0.026]
 [0.438 0.008 0.346 0.208]]
Validation acc: 0.714148219441771
Validation class_accuracies: [0.9243243243243243, 0.10869565217391304, 0.2727272727272727, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3783598892294544
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
The validation tracker metric at 0.443022518022518 hasn't increased by 0 in 2 epochs
330/330 - 650s - loss: 0.3055 - accuracy: 0.6578 - 650s/epoch - 2s/step
Validation cm: [[678  25  34   3]
 [ 56   8  27   1]
 [ 40   0  37   0]
 [ 19   3 106   2]]
Validation normalized_cm: [[0.916 0.034 0.046 0.004]
 [0.609 0.087 0.293 0.011]
 [0.519 0.    0.481 0.   ]
 [0.146 0.023 0.815 0.015]]
Validation acc: 0.697786333012512
Validation class_accuracies: [0.9162162162162162, 0.08695652173913043, 0.4805194805194805, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3747692084648606
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.443022518022518 hasn't increased by 0 in 3 epochs
330/330 - 652s - loss: 0.2921 - accuracy: 0.6246 - 652s/epoch - 2s/step
Validation cm: [[622  63  41  14]
 [ 38  35  12   7]
 [ 28   2  33  14]
 [ 14  12  67  37]]
Validation normalized_cm: [[0.841 0.085 0.055 0.019]
 [0.413 0.38  0.13  0.076]
 [0.364 0.026 0.429 0.182]
 [0.108 0.092 0.515 0.285]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.8405405405405405, 0.3804347826086957, 0.42857142857142855, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4835405340840123
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 654s - loss: 0.2788 - accuracy: 0.6588 - 654s/epoch - 2s/step
Validation cm: [[648  44  39   9]
 [ 44  26  13   9]
 [ 21   1  48   7]
 [ 24   7  67  32]]
Validation normalized_cm: [[0.876 0.059 0.053 0.012]
 [0.478 0.283 0.141 0.098]
 [0.273 0.013 0.623 0.091]
 [0.185 0.054 0.515 0.246]]
Validation acc: 0.7256977863330125
Validation class_accuracies: [0.8756756756756757, 0.2826086956521739, 0.6233766233766234, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5069537102145798
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 652s - loss: 0.2801 - accuracy: 0.6453 - 652s/epoch - 2s/step
Validation cm: [[669  28  26  17]
 [ 55  18   7  12]
 [ 40   0  24  13]
 [ 29  21  25  55]]
Validation normalized_cm: [[0.904 0.038 0.035 0.023]
 [0.598 0.196 0.076 0.13 ]
 [0.519 0.    0.312 0.169]
 [0.223 0.162 0.192 0.423]]
Validation acc: 0.737247353224254
Validation class_accuracies: [0.904054054054054, 0.1956521739130435, 0.3116883116883117, 0.4230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4586178656830831
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5069537102145798 hasn't increased by 0 in 1 epochs
330/330 - 652s - loss: 0.2649 - accuracy: 0.6371 - 652s/epoch - 2s/step
Validation cm: [[591 120  17  12]
 [ 32  50   4   6]
 [ 28  10  21  18]
 [ 21  27  21  61]]
Validation normalized_cm: [[0.799 0.162 0.023 0.016]
 [0.348 0.543 0.043 0.065]
 [0.364 0.13  0.273 0.234]
 [0.162 0.208 0.162 0.469]]
Validation acc: 0.6958614051973051
Validation class_accuracies: [0.7986486486486486, 0.5434782608695652, 0.2727272727272727, 0.46923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.521021237869064
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 651s - loss: 0.2488 - accuracy: 0.6481 - 651s/epoch - 2s/step
Validation cm: [[569  89  74   8]
 [ 32  35  19   6]
 [ 15   4  43  15]
 [ 12  18  63  37]]
Validation normalized_cm: [[0.769 0.12  0.1   0.011]
 [0.348 0.38  0.207 0.065]
 [0.195 0.052 0.558 0.195]
 [0.092 0.138 0.485 0.285]]
Validation acc: 0.65832531280077
Validation class_accuracies: [0.768918918918919, 0.3804347826086957, 0.5584415584415584, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49810266114613944
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The validation tracker metric at 0.521021237869064 hasn't increased by 0 in 1 epochs
330/330 - 651s - loss: 0.2414 - accuracy: 0.6309 - 651s/epoch - 2s/step
Validation cm: [[661  44  19  16]
 [ 43  20  23   6]
 [ 37   2  34   4]
 [ 19  14  67  30]]
Validation normalized_cm: [[0.893 0.059 0.026 0.022]
 [0.467 0.217 0.25  0.065]
 [0.481 0.026 0.442 0.052]
 [0.146 0.108 0.515 0.231]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [0.8932432432432432, 0.21739130434782608, 0.44155844155844154, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4457405549796854
Validation one_indexed_epoch: 15
Epoch 15/20
[[0. 0.]]
The validation tracker metric at 0.521021237869064 hasn't increased by 0 in 2 epochs
330/330 - 596s - loss: 0.2340 - accuracy: 0.6525 - 596s/epoch - 2s/step
Validation cm: [[480 248   3   9]
 [ 39  43   5   5]
 [ 45  15  15   2]
 [ 44  14  35  37]]
Validation normalized_cm: [[0.649 0.335 0.004 0.012]
 [0.424 0.467 0.054 0.054]
 [0.584 0.195 0.195 0.026]
 [0.338 0.108 0.269 0.285]]
Validation acc: 0.5534167468719923
Validation class_accuracies: [0.6486486486486487, 0.4673913043478261, 0.19480519480519481, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3988651331042635
Validation one_indexed_epoch: 16
Epoch 16/20
[[1. 0.]]
The validation tracker metric at 0.521021237869064 hasn't increased by 0 in 3 epochs
330/330 - 595s - loss: 0.2214 - accuracy: 0.6496 - 595s/epoch - 2s/step
Validation cm: [[611  59  60  10]
 [ 41  17  32   2]
 [ 28   1  41   7]
 [  6  16  62  46]]
Validation normalized_cm: [[0.826 0.08  0.081 0.014]
 [0.446 0.185 0.348 0.022]
 [0.364 0.013 0.532 0.091]
 [0.046 0.123 0.477 0.354]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.8256756756756757, 0.18478260869565216, 0.5324675324675324, 0.35384615384615387]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4741929926712536
Validation one_indexed_epoch: 17
Epoch 17/20
[[0. 0.]]
The validation tracker metric at 0.521021237869064 hasn't increased by 0 in 4 epochs
330/330 - 596s - loss: 0.2045 - accuracy: 0.6364 - 596s/epoch - 2s/step
Validation cm: [[644  66  18  12]
 [ 53  36   2   1]
 [ 30   7  29  11]
 [ 24  38  20  48]]
Validation normalized_cm: [[0.87  0.089 0.024 0.016]
 [0.576 0.391 0.022 0.011]
 [0.39  0.091 0.377 0.143]
 [0.185 0.292 0.154 0.369]]
Validation acc: 0.7285851780558229
Validation class_accuracies: [0.8702702702702703, 0.391304347826087, 0.37662337662337664, 0.36923076923076925]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5018571909876257
Validation one_indexed_epoch: 18
Epoch 18/20
[[0. 0.]]
The validation tracker metric at 0.521021237869064 hasn't increased by 0 in 5 epochs
330/330 - 597s - loss: 0.1994 - accuracy: 0.6698 - 597s/epoch - 2s/step
Validation cm: [[585  36  93  26]
 [ 38  12  26  16]
 [ 22   2  41  12]
 [ 10   3  55  62]]
Validation normalized_cm: [[0.791 0.049 0.126 0.035]
 [0.413 0.13  0.283 0.174]
 [0.286 0.026 0.532 0.156]
 [0.077 0.023 0.423 0.477]]
Validation acc: 0.6737247353224254
Validation class_accuracies: [0.7905405405405406, 0.13043478260869565, 0.5324675324675324, 0.47692307692307695]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4825914831349614
Validation one_indexed_epoch: 19
Epoch 19/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 597s - loss: 0.1822 - accuracy: 0.6794 - 597s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.521021237869064
Best cm: [[591 120  17  12]
 [ 32  50   4   6]
 [ 28  10  21  18]
 [ 21  27  21  61]]
Best normalized_cm: [[0.799 0.162 0.023 0.016]
 [0.348 0.543 0.043 0.065]
 [0.364 0.13  0.273 0.234]
 [0.162 0.208 0.162 0.469]]
Best acc: 0.6958614051973051
Best class_accuracies: [0.7986486486486486, 0.5434782608695652, 0.2727272727272727, 0.46923076923076923]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 13
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
