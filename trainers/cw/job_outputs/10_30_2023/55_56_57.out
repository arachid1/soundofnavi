Mode:  cw
Testing:  0
File:  train55
Description:  mel
Output File:  cw/job_outputs/55.out
Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train55
Description: mel
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
0
0
0
0
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   105952           
                                                                                                              
==============================================================================================================
Total params: 105,952
Trainable params: 105,456
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/25
Validation cm: [[661   0  79   0]
 [ 78   0  14   0]
 [ 42   0  35   0]
 [ 44   0  86   0]]
Validation normalized_cm: [[0.893 0.    0.107 0.   ]
 [0.848 0.    0.152 0.   ]
 [0.545 0.    0.455 0.   ]
 [0.338 0.    0.662 0.   ]]
Validation acc: 0.6698748796920115
Validation class_accuracies: [0.8932432432432432, 0.0, 0.45454545454545453, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3369471744471744
Validation one_indexed_epoch: 1
-- New best results were achieved. --
330/330 - 99s - loss: 0.4394 - accuracy: 0.5504 - 99s/epoch - 300ms/step
Epoch 2/25
Validation cm: [[656  53  23   8]
 [ 51  21  10  10]
 [ 56   1  14   6]
 [ 35   5  82   8]]
Validation normalized_cm: [[0.886 0.072 0.031 0.011]
 [0.554 0.228 0.109 0.109]
 [0.727 0.013 0.182 0.078]
 [0.269 0.038 0.631 0.062]]
Validation acc: 0.6727622714148219
Validation class_accuracies: [0.8864864864864865, 0.22826086956521738, 0.18181818181818182, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3395259998520868
Validation one_indexed_epoch: 2
-- New best results were achieved. --
330/330 - 93s - loss: 0.3955 - accuracy: 0.5986 - 93s/epoch - 283ms/step
Epoch 3/25
Validation cm: [[262  45  12 421]
 [  5   1   1  85]
 [ 13   3   4  57]
 [  1   0   6 123]]
Validation normalized_cm: [[0.354 0.061 0.016 0.569]
 [0.054 0.011 0.011 0.924]
 [0.169 0.039 0.052 0.74 ]
 [0.008 0.    0.046 0.946]]
Validation acc: 0.3753609239653513
Validation class_accuracies: [0.35405405405405405, 0.010869565217391304, 0.05194805194805195, 0.9461538461538461]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.34075637934333586
Validation one_indexed_epoch: 3
-- New best results were achieved. --
330/330 - 92s - loss: 0.3767 - accuracy: 0.6356 - 92s/epoch - 280ms/step
Epoch 4/25
Validation cm: [[461 102  43 134]
 [ 25   9   3  55]
 [ 41   1  18  17]
 [ 10   8  77  35]]
Validation normalized_cm: [[0.623 0.138 0.058 0.181]
 [0.272 0.098 0.033 0.598]
 [0.532 0.013 0.234 0.221]
 [0.077 0.062 0.592 0.269]]
Validation acc: 0.5033686236766122
Validation class_accuracies: [0.6229729729729729, 0.09782608695652174, 0.23376623376623376, 0.2692307692307692]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3059490157316244
Validation one_indexed_epoch: 4
The validation tracker metric at 0.34075637934333586 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.3534 - accuracy: 0.6367 - 92s/epoch - 280ms/step
Epoch 5/25
Validation cm: [[588 115  37   0]
 [ 38  44  10   0]
 [ 35  13  24   5]
 [ 27   2  80  21]]
Validation normalized_cm: [[0.795 0.155 0.05  0.   ]
 [0.413 0.478 0.109 0.   ]
 [0.455 0.169 0.312 0.065]
 [0.208 0.015 0.615 0.162]]
Validation acc: 0.6515880654475458
Validation class_accuracies: [0.7945945945945946, 0.4782608695652174, 0.3116883116883117, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4365205593466463
Validation one_indexed_epoch: 5
-- New best results were achieved. --
330/330 - 92s - loss: 0.3389 - accuracy: 0.6533 - 92s/epoch - 278ms/step
Epoch 6/25
Validation cm: [[713   6  21   0]
 [ 67   5  19   1]
 [ 56   2  18   1]
 [ 63   0  61   6]]
Validation normalized_cm: [[0.964 0.008 0.028 0.   ]
 [0.728 0.054 0.207 0.011]
 [0.727 0.026 0.234 0.013]
 [0.485 0.    0.469 0.046]]
Validation acc: 0.714148219441771
Validation class_accuracies: [0.9635135135135136, 0.05434782608695652, 0.23376623376623376, 0.046153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32444535488013754
Validation one_indexed_epoch: 6
The validation tracker metric at 0.4365205593466463 hasn't increased by 0 in 1 epochs
330/330 - 93s - loss: 0.3436 - accuracy: 0.6261 - 93s/epoch - 281ms/step
Epoch 7/25
Validation cm: [[577  71  76  16]
 [ 27  24  20  21]
 [ 23   1  44   9]
 [ 17   0  63  50]]
Validation normalized_cm: [[0.78  0.096 0.103 0.022]
 [0.293 0.261 0.217 0.228]
 [0.299 0.013 0.571 0.117]
 [0.131 0.    0.485 0.385]]
Validation acc: 0.6689124157844081
Validation class_accuracies: [0.7797297297297298, 0.2608695652173913, 0.5714285714285714, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.49916081274776924
Validation one_indexed_epoch: 7
-- New best results were achieved. --
330/330 - 93s - loss: 0.3136 - accuracy: 0.6479 - 93s/epoch - 280ms/step
Epoch 8/25
Validation cm: [[591 122  26   1]
 [ 38  42  11   1]
 [ 39   9  28   1]
 [ 16  17  76  21]]
Validation normalized_cm: [[0.799 0.165 0.035 0.001]
 [0.413 0.457 0.12  0.011]
 [0.506 0.117 0.364 0.013]
 [0.123 0.131 0.585 0.162]]
Validation acc: 0.6564003849855631
Validation class_accuracies: [0.7986486486486486, 0.45652173913043476, 0.36363636363636365, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44508630323847714
Validation one_indexed_epoch: 8
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 1 epochs
330/330 - 92s - loss: 0.2951 - accuracy: 0.6924 - 92s/epoch - 279ms/step
Epoch 9/25
Validation cm: [[604 111  22   3]
 [ 33  52   1   6]
 [ 37  12  25   3]
 [ 56  35  17  22]]
Validation normalized_cm: [[0.816 0.15  0.03  0.004]
 [0.359 0.565 0.011 0.065]
 [0.481 0.156 0.325 0.039]
 [0.431 0.269 0.131 0.169]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.8162162162162162, 0.5652173913043478, 0.3246753246753247, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4688349253566645
Validation one_indexed_epoch: 9
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 2 epochs
330/330 - 94s - loss: 0.2760 - accuracy: 0.6914 - 94s/epoch - 284ms/step
Epoch 10/25
Validation cm: [[500 138  90  12]
 [ 24  43  20   5]
 [ 26  14  28   9]
 [ 22  19  51  38]]
Validation normalized_cm: [[0.676 0.186 0.122 0.016]
 [0.261 0.467 0.217 0.054]
 [0.338 0.182 0.364 0.117]
 [0.169 0.146 0.392 0.292]]
Validation acc: 0.5861405197305101
Validation class_accuracies: [0.6756756756756757, 0.4673913043478261, 0.36363636363636365, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44975275899188943
Validation one_indexed_epoch: 10
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 3 epochs
330/330 - 93s - loss: 0.2675 - accuracy: 0.6576 - 93s/epoch - 281ms/step
Epoch 11/25
Validation cm: [[652  43  45   0]
 [ 51  14  23   4]
 [ 34   5  33   5]
 [ 33   7  75  15]]
Validation normalized_cm: [[0.881 0.058 0.061 0.   ]
 [0.554 0.152 0.25  0.043]
 [0.442 0.065 0.429 0.065]
 [0.254 0.054 0.577 0.115]]
Validation acc: 0.687199230028874
Validation class_accuracies: [0.8810810810810811, 0.15217391304347827, 0.42857142857142855, 0.11538461538461539]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39430275952015087
Validation one_indexed_epoch: 11
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 4 epochs
330/330 - 93s - loss: 0.2493 - accuracy: 0.7089 - 93s/epoch - 281ms/step
Epoch 12/25
Validation cm: [[613  54  64   9]
 [ 57  11   7  17]
 [ 31   5  35   6]
 [ 21   8  63  38]]
Validation normalized_cm: [[0.828 0.073 0.086 0.012]
 [0.62  0.12  0.076 0.185]
 [0.403 0.065 0.455 0.078]
 [0.162 0.062 0.485 0.292]]
Validation acc: 0.670837343599615
Validation class_accuracies: [0.8283783783783784, 0.11956521739130435, 0.45454545454545453, 0.2923076923076923]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4236991856557074
Validation one_indexed_epoch: 12
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 5 epochs
330/330 - 92s - loss: 0.2415 - accuracy: 0.6893 - 92s/epoch - 279ms/step
Epoch 13/25
Validation cm: [[635   0 105   0]
 [ 66   1  23   2]
 [ 29   1  46   1]
 [ 33  14  75   8]]
Validation normalized_cm: [[0.858 0.    0.142 0.   ]
 [0.717 0.011 0.25  0.022]
 [0.377 0.013 0.597 0.013]
 [0.254 0.108 0.577 0.062]]
Validation acc: 0.6641000962463908
Validation class_accuracies: [0.8581081081081081, 0.010869565217391304, 0.5974025974025974, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3819796830666396
Validation one_indexed_epoch: 13
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 6 epochs
330/330 - 93s - loss: 0.2244 - accuracy: 0.6823 - 93s/epoch - 282ms/step
Epoch 14/25
Validation cm: [[599 115  21   5]
 [ 36  45   3   8]
 [ 32  13  25   7]
 [ 32  37  27  34]]
Validation normalized_cm: [[0.809 0.155 0.028 0.007]
 [0.391 0.489 0.033 0.087]
 [0.416 0.169 0.325 0.091]
 [0.246 0.285 0.208 0.262]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.8094594594594594, 0.4891304347826087, 0.3246753246753247, 0.26153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4712009201139636
Validation one_indexed_epoch: 14
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 7 epochs
330/330 - 93s - loss: 0.2157 - accuracy: 0.6825 - 93s/epoch - 282ms/step
Epoch 15/25
Validation cm: [[668  48  21   3]
 [ 64  15  10   3]
 [ 45   8  22   2]
 [ 48  30  28  24]]
Validation normalized_cm: [[0.903 0.065 0.028 0.004]
 [0.696 0.163 0.109 0.033]
 [0.584 0.104 0.286 0.026]
 [0.369 0.231 0.215 0.185]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.9027027027027027, 0.16304347826086957, 0.2857142857142857, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38401896282331066
Validation one_indexed_epoch: 15
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 8 epochs
330/330 - 93s - loss: 0.2016 - accuracy: 0.7015 - 93s/epoch - 280ms/step
Epoch 16/25
Validation cm: [[644  75  20   1]
 [ 52  30   3   7]
 [ 41   9  25   2]
 [ 44  32  35  19]]
Validation normalized_cm: [[0.87  0.101 0.027 0.001]
 [0.565 0.326 0.033 0.076]
 [0.532 0.117 0.325 0.026]
 [0.338 0.246 0.269 0.146]]
Validation acc: 0.6910490856592878
Validation class_accuracies: [0.8702702702702703, 0.32608695652173914, 0.3246753246753247, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41679659940529507
Validation one_indexed_epoch: 16
The validation tracker metric at 0.49916081274776924 hasn't increased by 0 in 9 epochs
330/330 - 92s - loss: 0.1883 - accuracy: 0.6967 - 92s/epoch - 279ms/step
Epoch 17/25
Validation cm: [[656  45  30   9]
 [ 59  14  11   8]
 [ 29   7  37   4]
 [ 23  22  48  37]]
Validation normalized_cm: [[0.886 0.061 0.041 0.012]
 [0.641 0.152 0.12  0.087]
 [0.377 0.091 0.481 0.052]
 [0.177 0.169 0.369 0.285]]
Validation acc: 0.7160731472569779
Validation class_accuracies: [0.8864864864864865, 0.15217391304347827, 0.4805194805194805, 0.2846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4509488161662075
Validation one_indexed_epoch: 17
The number of epochs since last 1% equals the patience
330/330 - 93s - loss: 0.1826 - accuracy: 0.7104 - 93s/epoch - 281ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.49916081274776924
Best cm: [[577  71  76  16]
 [ 27  24  20  21]
 [ 23   1  44   9]
 [ 17   0  63  50]]
Best normalized_cm: [[0.78  0.096 0.103 0.022]
 [0.293 0.261 0.217 0.228]
 [0.299 0.013 0.571 0.117]
 [0.131 0.    0.485 0.385]]
Best acc: 0.6689124157844081
Best class_accuracies: [0.7797297297297298, 0.2608695652173913, 0.5714285714285714, 0.38461538461538464]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 7
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train55.py", line 213, in <module>
    launch_job({"Bd": 0, "Jordan": 0, "Icbhi": 1, "Perch": 1, "Ant": 1, "SimAnt": 1,}, leaf_mixednet_model, spec_aug_params, audio_aug_params, None, [1,0])
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train55.py", line 174, in launch_job
    train_model(datasets, model, spec_aug_params, audio_aug_params, parse_function, label_passed)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train55.py", line 159, in train_model
    callbacks=[metrics_callback, viz_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/alirachidi/classification_algorithm/trainers/modules/callbacks/visualizationCallback.py", line 24, in on_train_end
    diff = self.final_specs[i][0] - self.initial_specs[i][0]
IndexError: list index out of range
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train56
Description: unt
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
0
0
0
0
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   105952           
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 105,456
Non-trainable params: 1,056
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/25
Validation cm: [[242 497   0   1]
 [  5  87   0   0]
 [ 14  63   0   0]
 [  8 122   0   0]]
Validation normalized_cm: [[0.327 0.672 0.    0.001]
 [0.054 0.946 0.    0.   ]
 [0.182 0.818 0.    0.   ]
 [0.062 0.938 0.    0.   ]]
Validation acc: 0.31665062560153995
Validation class_accuracies: [0.327027027027027, 0.9456521739130435, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3181698002350176
Validation one_indexed_epoch: 1
-- New best results were achieved. --
330/330 - 351s - loss: 0.4555 - accuracy: 0.5358 - 351s/epoch - 1s/step
Epoch 2/25
Validation cm: [[647  28  52  13]
 [ 52  10  16  14]
 [ 37   1  29  10]
 [ 18   2  85  25]]
Validation normalized_cm: [[0.874 0.038 0.07  0.018]
 [0.565 0.109 0.174 0.152]
 [0.481 0.013 0.377 0.13 ]
 [0.138 0.015 0.654 0.192]]
Validation acc: 0.6843118383060636
Validation class_accuracies: [0.8743243243243243, 0.10869565217391304, 0.37662337662337664, 0.19230769230769232]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38798776135732654
Validation one_indexed_epoch: 2
-- New best results were achieved. --
330/330 - 341s - loss: 0.3918 - accuracy: 0.5802 - 341s/epoch - 1s/step
Epoch 3/25
Validation cm: [[344 313  18  65]
 [ 16  54   2  20]
 [ 13  22   1  41]
 [ 12  47   3  68]]
Validation normalized_cm: [[0.465 0.423 0.024 0.088]
 [0.174 0.587 0.022 0.217]
 [0.169 0.286 0.013 0.532]
 [0.092 0.362 0.023 0.523]]
Validation acc: 0.4494706448508181
Validation class_accuracies: [0.4648648648648649, 0.5869565217391305, 0.012987012987012988, 0.5230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39697133066698287
Validation one_indexed_epoch: 3
-- New best results were achieved. --
330/330 - 342s - loss: 0.3561 - accuracy: 0.6170 - 342s/epoch - 1s/step
Epoch 4/25
Validation cm: [[733   0   5   2]
 [ 90   2   0   0]
 [ 74   0   3   0]
 [ 85   0  45   0]]
Validation normalized_cm: [[0.991 0.    0.007 0.003]
 [0.978 0.022 0.    0.   ]
 [0.961 0.    0.039 0.   ]
 [0.654 0.    0.346 0.   ]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.9905405405405405, 0.021739130434782608, 0.03896103896103896, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2628101774840905
Validation one_indexed_epoch: 4
The validation tracker metric at 0.39697133066698287 hasn't increased by 0 in 1 epochs
330/330 - 340s - loss: 0.3343 - accuracy: 0.6288 - 340s/epoch - 1s/step
Epoch 5/25
Validation cm: [[282 335  36  87]
 [  5  54  10  23]
 [ 12   9  10  46]
 [  2  24  22  82]]
Validation normalized_cm: [[0.381 0.453 0.049 0.118]
 [0.054 0.587 0.109 0.25 ]
 [0.156 0.117 0.13  0.597]
 [0.015 0.185 0.169 0.631]]
Validation acc: 0.41193455245428295
Validation class_accuracies: [0.3810810810810811, 0.5869565217391305, 0.12987012987012986, 0.6307692307692307]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43216924086489306
Validation one_indexed_epoch: 5
-- New best results were achieved. --
330/330 - 339s - loss: 0.3139 - accuracy: 0.6075 - 339s/epoch - 1s/step
Epoch 6/25
Validation cm: [[681   9  44   6]
 [ 71   4  12   5]
 [ 43   0  32   2]
 [ 39   0  84   7]]
Validation normalized_cm: [[0.92  0.012 0.059 0.008]
 [0.772 0.043 0.13  0.054]
 [0.558 0.    0.416 0.026]
 [0.3   0.    0.646 0.054]]
Validation acc: 0.6968238691049086
Validation class_accuracies: [0.9202702702702703, 0.043478260869565216, 0.4155844155844156, 0.05384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3582947751426013
Validation one_indexed_epoch: 6
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 1 epochs
330/330 - 347s - loss: 0.2946 - accuracy: 0.6221 - 347s/epoch - 1s/step
Epoch 7/25
Validation cm: [[441 184   1 114]
 [ 19  38   0  35]
 [ 33  20   3  21]
 [ 22  36   8  64]]
Validation normalized_cm: [[0.596 0.249 0.001 0.154]
 [0.207 0.413 0.    0.38 ]
 [0.429 0.26  0.039 0.273]
 [0.169 0.277 0.062 0.492]]
Validation acc: 0.5255052935514918
Validation class_accuracies: [0.595945945945946, 0.41304347826086957, 0.03896103896103896, 0.49230769230769234]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3850645388688867
Validation one_indexed_epoch: 7
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 2 epochs
330/330 - 345s - loss: 0.2690 - accuracy: 0.6339 - 345s/epoch - 1s/step
Epoch 8/25
Validation cm: [[173 385  38 144]
 [  0  50  11  31]
 [  7  16   6  48]
 [  5  30  36  59]]
Validation normalized_cm: [[0.234 0.52  0.051 0.195]
 [0.    0.543 0.12  0.337]
 [0.091 0.208 0.078 0.623]
 [0.038 0.231 0.277 0.454]]
Validation acc: 0.27718960538979787
Validation class_accuracies: [0.23378378378378378, 0.5434782608695652, 0.07792207792207792, 0.45384615384615384]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.32725756910539516
Validation one_indexed_epoch: 8
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 3 epochs
330/330 - 344s - loss: 0.2540 - accuracy: 0.6682 - 344s/epoch - 1s/step
Epoch 9/25
Validation cm: [[400  23 213 104]
 [ 39   7  18  28]
 [ 16   0  48  13]
 [ 33   1  51  45]]
Validation normalized_cm: [[0.541 0.031 0.288 0.141]
 [0.424 0.076 0.196 0.304]
 [0.208 0.    0.623 0.169]
 [0.254 0.008 0.392 0.346]]
Validation acc: 0.48123195380173245
Validation class_accuracies: [0.5405405405405406, 0.07608695652173914, 0.6233766233766234, 0.34615384615384615]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39653949164818736
Validation one_indexed_epoch: 9
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 4 epochs
330/330 - 346s - loss: 0.2300 - accuracy: 0.6768 - 346s/epoch - 1s/step
Epoch 10/25
Validation cm: [[633  37  56  14]
 [ 49   9  21  13]
 [ 32   4  36   5]
 [ 21   0  89  20]]
Validation normalized_cm: [[0.855 0.05  0.076 0.019]
 [0.533 0.098 0.228 0.141]
 [0.416 0.052 0.468 0.065]
 [0.162 0.    0.685 0.154]]
Validation acc: 0.6717998075072185
Validation class_accuracies: [0.8554054054054054, 0.09782608695652174, 0.4675324675324675, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3936525284351371
Validation one_indexed_epoch: 10
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 5 epochs
330/330 - 343s - loss: 0.2156 - accuracy: 0.6415 - 343s/epoch - 1s/step
Epoch 11/25
Validation cm: [[642  19  63  16]
 [ 50   8  19  15]
 [ 40   2  28   7]
 [ 38   6  66  20]]
Validation normalized_cm: [[0.868 0.026 0.085 0.022]
 [0.543 0.087 0.207 0.163]
 [0.519 0.026 0.364 0.091]
 [0.292 0.046 0.508 0.154]]
Validation acc: 0.6717998075072185
Validation class_accuracies: [0.8675675675675676, 0.08695652173913043, 0.36363636363636365, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3680016516973038
Validation one_indexed_epoch: 11
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 6 epochs
330/330 - 342s - loss: 0.1897 - accuracy: 0.6671 - 342s/epoch - 1s/step
Epoch 12/25
Validation cm: [[630  79  16  15]
 [ 43  32   6  11]
 [ 43   7  18   9]
 [ 44   5  60  21]]
Validation normalized_cm: [[0.851 0.107 0.022 0.02 ]
 [0.467 0.348 0.065 0.12 ]
 [0.558 0.091 0.234 0.117]
 [0.338 0.038 0.462 0.162]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8513513513513513, 0.34782608695652173, 0.23376623376623376, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39862053340314213
Validation one_indexed_epoch: 12
The validation tracker metric at 0.43216924086489306 hasn't increased by 0 in 7 epochs
330/330 - 345s - loss: 0.1786 - accuracy: 0.6559 - 345s/epoch - 1s/step
Epoch 13/25
Validation cm: [[660  56  15   9]
 [ 56  26   7   3]
 [ 49   0  27   1]
 [ 38   8  56  28]]
Validation normalized_cm: [[0.892 0.076 0.02  0.012]
 [0.609 0.283 0.076 0.033]
 [0.636 0.    0.351 0.013]
 [0.292 0.062 0.431 0.215]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.8918918918918919, 0.2826086956521739, 0.35064935064935066, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4351336383945079
Validation one_indexed_epoch: 13
-- New best results were achieved. --
330/330 - 343s - loss: 0.1538 - accuracy: 0.6388 - 343s/epoch - 1s/step
Epoch 14/25
Validation cm: [[647  35  38  20]
 [ 54  20  12   6]
 [ 32   2  37   6]
 [ 31  13  62  24]]
Validation normalized_cm: [[0.874 0.047 0.051 0.027]
 [0.587 0.217 0.13  0.065]
 [0.416 0.026 0.481 0.078]
 [0.238 0.1   0.477 0.185]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.8743243243243243, 0.21739130434782608, 0.4805194805194805, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4392126234517539
Validation one_indexed_epoch: 14
-- New best results were achieved. --
330/330 - 344s - loss: 0.1359 - accuracy: 0.6341 - 344s/epoch - 1s/step
Epoch 15/25
Validation cm: [[634  37  45  24]
 [ 54  17   8  13]
 [ 37   2  28  10]
 [ 24  11  52  43]]
Validation normalized_cm: [[0.857 0.05  0.061 0.032]
 [0.587 0.185 0.087 0.141]
 [0.481 0.026 0.364 0.13 ]
 [0.185 0.085 0.4   0.331]]
Validation acc: 0.6948989412897016
Validation class_accuracies: [0.8567567567567568, 0.18478260869565216, 0.36363636363636365, 0.33076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43398623996450086
Validation one_indexed_epoch: 15
The validation tracker metric at 0.4392126234517539 hasn't increased by 0 in 1 epochs
330/330 - 341s - loss: 0.1235 - accuracy: 0.6352 - 341s/epoch - 1s/step
Epoch 16/25
Validation cm: [[705  31   0   4]
 [ 75  13   4   0]
 [ 68   6   3   0]
 [102   4  16   8]]
Validation normalized_cm: [[0.953 0.042 0.    0.005]
 [0.815 0.141 0.043 0.   ]
 [0.883 0.078 0.039 0.   ]
 [0.785 0.031 0.123 0.062]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.9527027027027027, 0.14130434782608695, 0.03896103896103896, 0.06153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.29862663775707254
Validation one_indexed_epoch: 16
The validation tracker metric at 0.4392126234517539 hasn't increased by 0 in 2 epochs
330/330 - 342s - loss: 0.1161 - accuracy: 0.6271 - 342s/epoch - 1s/step
Epoch 17/25
Validation cm: [[601  72  25  42]
 [ 36  38   7  11]
 [ 54   3  11   9]
 [ 45  11  44  30]]
Validation normalized_cm: [[0.812 0.097 0.034 0.057]
 [0.391 0.413 0.076 0.12 ]
 [0.701 0.039 0.143 0.117]
 [0.346 0.085 0.338 0.231]]
Validation acc: 0.6544754571703562
Validation class_accuracies: [0.8121621621621622, 0.41304347826086957, 0.14285714285714285, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.39970800351235136
Validation one_indexed_epoch: 17
The validation tracker metric at 0.4392126234517539 hasn't increased by 0 in 3 epochs
330/330 - 342s - loss: 0.1021 - accuracy: 0.6369 - 342s/epoch - 1s/step
Epoch 18/25
Validation cm: [[391  15 268  66]
 [ 13   3  42  34]
 [ 12   0  51  14]
 [  0   0  81  49]]
Validation normalized_cm: [[0.528 0.02  0.362 0.089]
 [0.141 0.033 0.457 0.37 ]
 [0.156 0.    0.662 0.182]
 [0.    0.    0.623 0.377]]
Validation acc: 0.4754571703561116
Validation class_accuracies: [0.5283783783783784, 0.03260869565217391, 0.6623376623376623, 0.3769230769230769]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4000619533228229
Validation one_indexed_epoch: 18
The validation tracker metric at 0.4392126234517539 hasn't increased by 0 in 4 epochs
330/330 - 343s - loss: 0.0834 - accuracy: 0.6451 - 343s/epoch - 1s/step
Epoch 19/25
Validation cm: [[558  94  40  48]
 [ 24  40  11  17]
 [ 27   7  32  11]
 [ 23  17  51  39]]
Validation normalized_cm: [[0.754 0.127 0.054 0.065]
 [0.261 0.435 0.12  0.185]
 [0.351 0.091 0.416 0.143]
 [0.177 0.131 0.392 0.3  ]]
Validation acc: 0.643888354186718
Validation class_accuracies: [0.754054054054054, 0.43478260869565216, 0.4155844155844156, 0.3]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.47610526958353044
Validation one_indexed_epoch: 19
-- New best results were achieved. --
330/330 - 346s - loss: 0.0739 - accuracy: 0.6500 - 346s/epoch - 1s/step
Epoch 20/25
Validation cm: [[562  32  90  56]
 [ 33  13  25  21]
 [ 27   0  34  16]
 [  9   3  62  56]]
Validation normalized_cm: [[0.759 0.043 0.122 0.076]
 [0.359 0.141 0.272 0.228]
 [0.351 0.    0.442 0.208]
 [0.069 0.023 0.477 0.431]]
Validation acc: 0.6400384985563041
Validation class_accuracies: [0.7594594594594595, 0.14130434782608695, 0.44155844155844154, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44327286990330467
Validation one_indexed_epoch: 20
The validation tracker metric at 0.47610526958353044 hasn't increased by 0 in 1 epochs
330/330 - 342s - loss: 0.0711 - accuracy: 0.6106 - 342s/epoch - 1s/step
Epoch 21/25
Validation cm: [[419 151  76  94]
 [ 19  28  12  33]
 [ 18  12  24  23]
 [  7  15  28  80]]
Validation normalized_cm: [[0.566 0.204 0.103 0.127]
 [0.207 0.304 0.13  0.359]
 [0.234 0.156 0.312 0.299]
 [0.054 0.115 0.215 0.615]]
Validation acc: 0.5303176130895092
Validation class_accuracies: [0.5662162162162162, 0.30434782608695654, 0.3116883116883117, 0.6153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44940924234402496
Validation one_indexed_epoch: 21
The validation tracker metric at 0.47610526958353044 hasn't increased by 0 in 2 epochs
330/330 - 341s - loss: 0.0753 - accuracy: 0.6007 - 341s/epoch - 1s/step
Epoch 22/25
Validation cm: [[488  89  74  89]
 [ 18  25   9  40]
 [ 13   7  25  32]
 [  7   8  36  79]]
Validation normalized_cm: [[0.659 0.12  0.1   0.12 ]
 [0.196 0.272 0.098 0.435]
 [0.169 0.091 0.325 0.416]
 [0.054 0.062 0.277 0.608]]
Validation acc: 0.5938402309913379
Validation class_accuracies: [0.6594594594594595, 0.2717391304347826, 0.3246753246753247, 0.6076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4658915555654686
Validation one_indexed_epoch: 22
The validation tracker metric at 0.47610526958353044 hasn't increased by 0 in 3 epochs
330/330 - 345s - loss: 0.0668 - accuracy: 0.6333 - 345s/epoch - 1s/step
Epoch 23/25
Validation cm: [[509  77 102  52]
 [ 24  33  15  20]
 [ 18   3  41  15]
 [ 13   7  54  56]]
Validation normalized_cm: [[0.688 0.104 0.138 0.07 ]
 [0.261 0.359 0.163 0.217]
 [0.234 0.039 0.532 0.195]
 [0.1   0.054 0.415 0.431]]
Validation acc: 0.615014436958614
Validation class_accuracies: [0.6878378378378378, 0.358695652173913, 0.5324675324675324, 0.4307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5024425633121286
Validation one_indexed_epoch: 23
-- New best results were achieved. --
330/330 - 343s - loss: 0.0601 - accuracy: 0.6388 - 343s/epoch - 1s/step
Epoch 24/25
Validation cm: [[627  81  12  20]
 [ 49  26  11   6]
 [ 51   9   9   8]
 [ 38  17  53  22]]
Validation normalized_cm: [[0.847 0.109 0.016 0.027]
 [0.533 0.283 0.12  0.065]
 [0.662 0.117 0.117 0.104]
 [0.292 0.131 0.408 0.169]]
Validation acc: 0.65832531280077
Validation class_accuracies: [0.8472972972972973, 0.2826086956521739, 0.11688311688311688, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35400496976583934
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5024425633121286 hasn't increased by 0 in 1 epochs
330/330 - 345s - loss: 0.0494 - accuracy: 0.6403 - 345s/epoch - 1s/step
Epoch 25/25
Validation cm: [[595 107  10  28]
 [ 32  43   7  10]
 [ 47  10  10  10]
 [ 30  24  32  44]]
Validation normalized_cm: [[0.804 0.145 0.014 0.038]
 [0.348 0.467 0.076 0.109]
 [0.61  0.13  0.13  0.13 ]
 [0.231 0.185 0.246 0.338]]
Validation acc: 0.6660250240615977
Validation class_accuracies: [0.8040540540540541, 0.4673913043478261, 0.12987012987012986, 0.3384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4349442566833871
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5024425633121286 hasn't increased by 0 in 2 epochs
330/330 - 342s - loss: 0.0469 - accuracy: 0.6534 - 342s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5024425633121286
Best cm: [[509  77 102  52]
 [ 24  33  15  20]
 [ 18   3  41  15]
 [ 13   7  54  56]]
Best normalized_cm: [[0.688 0.104 0.138 0.07 ]
 [0.261 0.359 0.163 0.217]
 [0.234 0.039 0.532 0.195]
 [0.1   0.054 0.415 0.431]]
Best acc: 0.615014436958614
Best class_accuracies: [0.6878378378378378, 0.358695652173913, 0.5324675324675324, 0.4307692307692308]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 23
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Initial weights
[<tf.Variable 'kernel:0' shape=(80, 2) dtype=float32, numpy=
array([[3.682e-02, 1.919e+02],
       [3.682e-02, 9.594e+01],
       [4.909e-02, 1.919e+02],
       [6.136e-02, 1.919e+02],
       [7.363e-02, 1.919e+02],
       [8.590e-02, 9.594e+01],
       [9.817e-02, 9.594e+01],
       [9.817e-02, 9.594e+01],
       [1.104e-01, 9.594e+01],
       [1.227e-01, 9.594e+01],
       [1.350e-01, 9.594e+01],
       [1.473e-01, 9.594e+01],
       [1.595e-01, 9.594e+01],
       [1.841e-01, 9.594e+01],
       [1.963e-01, 9.594e+01],
       [2.086e-01, 9.594e+01],
       [2.209e-01, 1.919e+02],
       [2.332e-01, 9.594e+01],
       [2.454e-01, 9.594e+01],
       [2.700e-01, 9.594e+01],
       [2.823e-01, 9.594e+01],
       [2.945e-01, 9.594e+01],
       [3.191e-01, 9.594e+01],
       [3.313e-01, 9.594e+01],
       [3.559e-01, 6.396e+01],
       [3.682e-01, 9.594e+01],
       [3.927e-01, 6.396e+01],
       [4.172e-01, 9.594e+01],
       [4.295e-01, 6.396e+01],
       [4.541e-01, 6.396e+01],
       [4.786e-01, 6.396e+01],
       [5.031e-01, 6.396e+01],
       [5.277e-01, 6.396e+01],
       [5.522e-01, 6.396e+01],
       [5.768e-01, 6.396e+01],
       [6.013e-01, 6.396e+01],
       [6.259e-01, 6.396e+01],
       [6.504e-01, 6.396e+01],
       [6.750e-01, 4.797e+01],
       [7.118e-01, 4.797e+01],
       [7.363e-01, 4.797e+01],
       [7.731e-01, 4.797e+01],
       [7.977e-01, 4.797e+01],
       [8.345e-01, 4.797e+01],
       [8.713e-01, 4.797e+01],
       [8.958e-01, 4.797e+01],
       [9.327e-01, 4.797e+01],
       [9.695e-01, 3.838e+01],
       [1.006e+00, 3.838e+01],
       [1.055e+00, 3.838e+01],
       [1.092e+00, 3.838e+01],
       [1.129e+00, 3.838e+01],
       [1.178e+00, 3.198e+01],
       [1.215e+00, 3.198e+01],
       [1.264e+00, 3.838e+01],
       [1.313e+00, 3.198e+01],
       [1.362e+00, 3.198e+01],
       [1.411e+00, 3.198e+01],
       [1.460e+00, 2.741e+01],
       [1.509e+00, 2.741e+01],
       [1.559e+00, 3.198e+01],
       [1.620e+00, 2.741e+01],
       [1.681e+00, 2.741e+01],
       [1.730e+00, 2.399e+01],
       [1.792e+00, 2.399e+01],
       [1.865e+00, 2.399e+01],
       [1.927e+00, 2.399e+01],
       [1.988e+00, 2.399e+01],
       [2.062e+00, 2.132e+01],
       [2.135e+00, 2.132e+01],
       [2.197e+00, 1.919e+01],
       [2.283e+00, 1.919e+01],
       [2.356e+00, 2.132e+01],
       [2.430e+00, 1.919e+01],
       [2.516e+00, 1.919e+01],
       [2.602e+00, 1.744e+01],
       [2.688e+00, 1.744e+01],
       [2.773e+00, 1.599e+01],
       [2.872e+00, 1.744e+01],
       [2.970e+00, 1.599e+01]], dtype=float32)>, <tf.Variable 'leaf/learnable_pooling/kernel:0' shape=(1, 1, 80, 1) dtype=float32, numpy=
array([[[[0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4]]]], dtype=float32)>, <tf.Variable 'leaf/PCEN/alpha:0' shape=(80,) dtype=float32, numpy=
array([0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96], dtype=float32)>, <tf.Variable 'leaf/PCEN/delta:0' shape=(80,) dtype=float32, numpy=
array([2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.], dtype=float32)>, <tf.Variable 'leaf/PCEN/root:0' shape=(80,) dtype=float32, numpy=
array([2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.], dtype=float32)>, <tf.Variable 'leaf/PCEN/EMA/smooth:0' shape=(80,) dtype=float32, numpy=
array([0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04], dtype=float32)>]
Post training weights
[<tf.Variable 'kernel:0' shape=(80, 2) dtype=float32, numpy=
array([[3.682e-02, 1.919e+02],
       [3.682e-02, 9.594e+01],
       [4.909e-02, 1.919e+02],
       [6.136e-02, 1.919e+02],
       [7.363e-02, 1.919e+02],
       [8.590e-02, 9.594e+01],
       [9.817e-02, 9.594e+01],
       [9.817e-02, 9.594e+01],
       [1.104e-01, 9.594e+01],
       [1.227e-01, 9.594e+01],
       [1.350e-01, 9.594e+01],
       [1.473e-01, 9.594e+01],
       [1.595e-01, 9.594e+01],
       [1.841e-01, 9.594e+01],
       [1.963e-01, 9.594e+01],
       [2.086e-01, 9.594e+01],
       [2.209e-01, 1.919e+02],
       [2.332e-01, 9.594e+01],
       [2.454e-01, 9.594e+01],
       [2.700e-01, 9.594e+01],
       [2.823e-01, 9.594e+01],
       [2.945e-01, 9.594e+01],
       [3.191e-01, 9.594e+01],
       [3.313e-01, 9.594e+01],
       [3.559e-01, 6.396e+01],
       [3.682e-01, 9.594e+01],
       [3.927e-01, 6.396e+01],
       [4.172e-01, 9.594e+01],
       [4.295e-01, 6.396e+01],
       [4.541e-01, 6.396e+01],
       [4.786e-01, 6.396e+01],
       [5.031e-01, 6.396e+01],
       [5.277e-01, 6.396e+01],
       [5.522e-01, 6.396e+01],
       [5.768e-01, 6.396e+01],
       [6.013e-01, 6.396e+01],
       [6.259e-01, 6.396e+01],
       [6.504e-01, 6.396e+01],
       [6.750e-01, 4.797e+01],
       [7.118e-01, 4.797e+01],
       [7.363e-01, 4.797e+01],
       [7.731e-01, 4.797e+01],
       [7.977e-01, 4.797e+01],
       [8.345e-01, 4.797e+01],
       [8.713e-01, 4.797e+01],
       [8.958e-01, 4.797e+01],
       [9.327e-01, 4.797e+01],
       [9.695e-01, 3.838e+01],
       [1.006e+00, 3.838e+01],
       [1.055e+00, 3.838e+01],
       [1.092e+00, 3.838e+01],
       [1.129e+00, 3.838e+01],
       [1.178e+00, 3.198e+01],
       [1.215e+00, 3.198e+01],
       [1.264e+00, 3.838e+01],
       [1.313e+00, 3.198e+01],
       [1.362e+00, 3.198e+01],
       [1.411e+00, 3.198e+01],
       [1.460e+00, 2.741e+01],
       [1.509e+00, 2.741e+01],
       [1.559e+00, 3.198e+01],
       [1.620e+00, 2.741e+01],
       [1.681e+00, 2.741e+01],
       [1.730e+00, 2.399e+01],
       [1.792e+00, 2.399e+01],
       [1.865e+00, 2.399e+01],
       [1.927e+00, 2.399e+01],
       [1.988e+00, 2.399e+01],
       [2.062e+00, 2.132e+01],
       [2.135e+00, 2.132e+01],
       [2.197e+00, 1.919e+01],
       [2.283e+00, 1.919e+01],
       [2.356e+00, 2.132e+01],
       [2.430e+00, 1.919e+01],
       [2.516e+00, 1.919e+01],
       [2.602e+00, 1.744e+01],
       [2.688e+00, 1.744e+01],
       [2.773e+00, 1.599e+01],
       [2.872e+00, 1.744e+01],
       [2.970e+00, 1.599e+01]], dtype=float32)>, <tf.Variable 'leaf/learnable_pooling/kernel:0' shape=(1, 1, 80, 1) dtype=float32, numpy=
array([[[[0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4],
         [0.4]]]], dtype=float32)>, <tf.Variable 'leaf/PCEN/alpha:0' shape=(80,) dtype=float32, numpy=
array([0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96, 0.96,
       0.96, 0.96, 0.96], dtype=float32)>, <tf.Variable 'leaf/PCEN/delta:0' shape=(80,) dtype=float32, numpy=
array([2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.], dtype=float32)>, <tf.Variable 'leaf/PCEN/root:0' shape=(80,) dtype=float32, numpy=
array([2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.,
       2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2., 2.], dtype=float32)>, <tf.Variable 'leaf/PCEN/EMA/smooth:0' shape=(80,) dtype=float32, numpy=
array([0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04,
       0.04, 0.04, 0.04], dtype=float32)>]/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/home/alirachidi/classification_algorithm/trainers/modules/callbacks/visualizationCallback.py:32: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  print(np.array(self.model._frontend.weights) - np.array(self.first_weights))

Weight difference
[<tf.Tensor: shape=(80, 2), dtype=float32, numpy=
 array([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], dtype=float32)>
 <tf.Tensor: shape=(1, 1, 80, 1), dtype=float32, numpy=
 array([[[[0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.],
          [0.]]]], dtype=float32)>
 <tf.Tensor: shape=(80,), dtype=float32, numpy=
 array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)>
 <tf.Tensor: shape=(80,), dtype=float32, numpy=
 array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)>
 <tf.Tensor: shape=(80,), dtype=float32, numpy=
 array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)>
 <tf.Tensor: shape=(80,), dtype=float32, numpy=
 array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)>   ]
Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train57
Description: t w layers
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
0
0
0
0
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   105952           
                                                                                                              
==============================================================================================================
Total params: 106,512
Trainable params: 106,016
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/25
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
330/330 - 540s - loss: 0.4573 - accuracy: 0.5785 - 540s/epoch - 2s/step
Epoch 2/25
Validation cm: [[739   0   1   0]
 [ 88   0   4   0]
 [ 72   0   5   0]
 [ 67   0  63   0]]
Validation normalized_cm: [[0.999 0.    0.001 0.   ]
 [0.957 0.    0.043 0.   ]
 [0.935 0.    0.065 0.   ]
 [0.515 0.    0.485 0.   ]]
Validation acc: 0.7160731472569779
Validation class_accuracies: [0.9986486486486487, 0.0, 0.06493506493506493, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2658959283959284
Validation one_indexed_epoch: 2
-- New best results were achieved. --
330/330 - 528s - loss: 0.3653 - accuracy: 0.5961 - 528s/epoch - 2s/step
Epoch 3/25
Validation cm: [[691  49   0   0]
 [ 75  17   0   0]
 [ 75   2   0   0]
 [115  11   2   2]]
Validation normalized_cm: [[0.934 0.066 0.    0.   ]
 [0.815 0.185 0.    0.   ]
 [0.974 0.026 0.    0.   ]
 [0.885 0.085 0.015 0.015]]
Validation acc: 0.6833493743984601
Validation class_accuracies: [0.9337837837837838, 0.18478260869565216, 0.0, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28348775196601284
Validation one_indexed_epoch: 3
-- New best results were achieved. --
330/330 - 530s - loss: 0.3380 - accuracy: 0.6195 - 530s/epoch - 2s/step
Epoch 4/25
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 71   0   4   2]
 [108   0  11  11]]
Validation normalized_cm: [[1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.922 0.    0.052 0.026]
 [0.831 0.    0.085 0.085]]
Validation acc: 0.726660250240616
Validation class_accuracies: [1.0, 0.0, 0.05194805194805195, 0.08461538461538462]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2841408591408591
Validation one_indexed_epoch: 4
-- New best results were achieved. --
330/330 - 532s - loss: 0.3173 - accuracy: 0.6259 - 532s/epoch - 2s/step
Epoch 5/25
Validation cm: [[732   7   1   0]
 [ 88   4   0   0]
 [ 74   0   3   0]
 [113   2  13   2]]
Validation normalized_cm: [[0.989 0.009 0.001 0.   ]
 [0.957 0.043 0.    0.   ]
 [0.961 0.    0.039 0.   ]
 [0.869 0.015 0.1   0.015]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.9891891891891892, 0.043478260869565216, 0.03896103896103896, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.27175327610110217
Validation one_indexed_epoch: 5
The validation tracker metric at 0.2841408591408591 hasn't increased by 0 in 1 epochs
330/330 - 542s - loss: 0.2809 - accuracy: 0.6286 - 542s/epoch - 2s/step
Epoch 6/25
Validation cm: [[736   4   0   0]
 [ 90   1   1   0]
 [ 73   0   3   1]
 [ 98   1  27   4]]
Validation normalized_cm: [[0.995 0.005 0.    0.   ]
 [0.978 0.011 0.011 0.   ]
 [0.948 0.    0.039 0.013]
 [0.754 0.008 0.208 0.031]]
Validation acc: 0.7160731472569779
Validation class_accuracies: [0.9945945945945946, 0.010869565217391304, 0.03896103896103896, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26879860738556394
Validation one_indexed_epoch: 6
The validation tracker metric at 0.2841408591408591 hasn't increased by 0 in 2 epochs
330/330 - 533s - loss: 0.2628 - accuracy: 0.6073 - 533s/epoch - 2s/step
Epoch 7/25
Validation cm: [[575 165   0   0]
 [ 53  39   0   0]
 [ 44  27   0   6]
 [ 25  63   1  41]]
Validation normalized_cm: [[0.777 0.223 0.    0.   ]
 [0.576 0.424 0.    0.   ]
 [0.571 0.351 0.    0.078]
 [0.192 0.485 0.008 0.315]]
Validation acc: 0.6304138594802695
Validation class_accuracies: [0.777027027027027, 0.42391304347826086, 0.0, 0.3153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37908117147247583
Validation one_indexed_epoch: 7
-- New best results were achieved. --
330/330 - 539s - loss: 0.2305 - accuracy: 0.6223 - 539s/epoch - 2s/step
Epoch 8/25
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
The validation tracker metric at 0.37908117147247583 hasn't increased by 0 in 1 epochs
330/330 - 526s - loss: 0.2137 - accuracy: 0.6542 - 526s/epoch - 2s/step
Epoch 9/25
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 75   0   2   0]
 [116   9   2   3]]
Validation normalized_cm: [[1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.974 0.    0.026 0.   ]
 [0.892 0.069 0.015 0.023]]
Validation acc: 0.7170356111645814
Validation class_accuracies: [1.0, 0.0, 0.025974025974025976, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26226273726273724
Validation one_indexed_epoch: 9
The validation tracker metric at 0.37908117147247583 hasn't increased by 0 in 2 epochs
330/330 - 536s - loss: 0.1917 - accuracy: 0.6318 - 536s/epoch - 2s/step
Epoch 10/25
Validation cm: [[672  56   7   5]
 [ 62  24   2   4]
 [ 46   2  25   4]
 [ 58  11  29  32]]
Validation normalized_cm: [[0.908 0.076 0.009 0.007]
 [0.674 0.261 0.022 0.043]
 [0.597 0.026 0.325 0.052]
 [0.446 0.085 0.223 0.246]]
Validation acc: 0.7247353224254091
Validation class_accuracies: [0.9081081081081082, 0.2608695652173913, 0.3246753246753247, 0.24615384615384617]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4349517110386676
Validation one_indexed_epoch: 10
-- New best results were achieved. --
330/330 - 534s - loss: 0.1708 - accuracy: 0.6204 - 534s/epoch - 2s/step
Epoch 11/25
Validation cm: [[658  47  26   9]
 [ 62  17   4   9]
 [ 32   1  38   6]
 [ 42   8  57  23]]
Validation normalized_cm: [[0.889 0.064 0.035 0.012]
 [0.674 0.185 0.043 0.098]
 [0.416 0.013 0.494 0.078]
 [0.323 0.062 0.438 0.177]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.8891891891891892, 0.18478260869565216, 0.4935064935064935, 0.17692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.43610034207860293
Validation one_indexed_epoch: 11
-- New best results were achieved. --
330/330 - 533s - loss: 0.1388 - accuracy: 0.6496 - 533s/epoch - 2s/step
Epoch 12/25
Validation cm: [[692  28  18   2]
 [ 78   9   1   4]
 [ 43   1  27   6]
 [ 82   7  22  19]]
Validation normalized_cm: [[0.935 0.038 0.024 0.003]
 [0.848 0.098 0.011 0.043]
 [0.558 0.013 0.351 0.078]
 [0.631 0.054 0.169 0.146]]
Validation acc: 0.7189605389797883
Validation class_accuracies: [0.9351351351351351, 0.09782608695652174, 0.35064935064935066, 0.14615384615384616]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3824411047237134
Validation one_indexed_epoch: 12
The validation tracker metric at 0.43610034207860293 hasn't increased by 0 in 1 epochs
330/330 - 529s - loss: 0.1267 - accuracy: 0.6491 - 529s/epoch - 2s/step
Epoch 13/25
Validation cm: [[703  26   9   2]
 [ 72  14   5   1]
 [ 52   1  21   3]
 [ 71   9  32  18]]
Validation normalized_cm: [[0.95  0.035 0.012 0.003]
 [0.783 0.152 0.054 0.011]
 [0.675 0.013 0.273 0.039]
 [0.546 0.069 0.246 0.138]]
Validation acc: 0.7276227141482194
Validation class_accuracies: [0.95, 0.15217391304347827, 0.2727272727272727, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37834068105807234
Validation one_indexed_epoch: 13
The validation tracker metric at 0.43610034207860293 hasn't increased by 0 in 2 epochs
330/330 - 531s - loss: 0.1164 - accuracy: 0.6269 - 531s/epoch - 2s/step
Epoch 14/25
Validation cm: [[632  79  12  17]
 [ 40  28   9  15]
 [ 39   3  22  13]
 [ 27  10  41  52]]
Validation normalized_cm: [[0.854 0.107 0.016 0.023]
 [0.435 0.304 0.098 0.163]
 [0.506 0.039 0.286 0.169]
 [0.208 0.077 0.315 0.4  ]]
Validation acc: 0.7064485081809432
Validation class_accuracies: [0.8540540540540541, 0.30434782608695654, 0.2857142857142857, 0.4]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.46102904146382406
Validation one_indexed_epoch: 14
-- New best results were achieved. --
330/330 - 538s - loss: 0.0943 - accuracy: 0.6166 - 538s/epoch - 2s/step
Epoch 15/25
Validation cm: [[681  44  14   1]
 [ 73  15   3   1]
 [ 53   1  17   6]
 [ 55  10  37  28]]
Validation normalized_cm: [[0.92  0.059 0.019 0.001]
 [0.793 0.163 0.033 0.011]
 [0.688 0.013 0.221 0.078]
 [0.423 0.077 0.285 0.215]]
Validation acc: 0.7131857555341675
Validation class_accuracies: [0.9202702702702703, 0.16304347826086957, 0.22077922077922077, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.37986939617374404
Validation one_indexed_epoch: 15
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 1 epochs
330/330 - 496s - loss: 0.0764 - accuracy: 0.6394 - 496s/epoch - 2s/step
Epoch 16/25
Validation cm: [[608  91  25  16]
 [ 68  20   0   4]
 [ 34   9  13  21]
 [ 72  34   0  24]]
Validation normalized_cm: [[0.822 0.123 0.034 0.022]
 [0.739 0.217 0.    0.043]
 [0.442 0.117 0.169 0.273]
 [0.554 0.262 0.    0.185]]
Validation acc: 0.6400384985563041
Validation class_accuracies: [0.8216216216216217, 0.21739130434782608, 0.16883116883116883, 0.18461538461538463]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3481148698540003
Validation one_indexed_epoch: 16
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 2 epochs
330/330 - 486s - loss: 0.0749 - accuracy: 0.6273 - 486s/epoch - 1s/step
Epoch 17/25
Validation cm: [[678  35  19   8]
 [ 62  16  11   3]
 [ 39   0  32   6]
 [ 47  13  48  22]]
Validation normalized_cm: [[0.916 0.047 0.026 0.011]
 [0.674 0.174 0.12  0.033]
 [0.506 0.    0.416 0.078]
 [0.362 0.1   0.369 0.169]]
Validation acc: 0.7199230028873917
Validation class_accuracies: [0.9162162162162162, 0.17391304347826086, 0.4155844155844156, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.41873611112741554
Validation one_indexed_epoch: 17
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 3 epochs
330/330 - 485s - loss: 0.0719 - accuracy: 0.6417 - 485s/epoch - 1s/step
Epoch 18/25
Validation cm: [[699  20  16   5]
 [ 75   8   5   4]
 [ 46   2  28   1]
 [ 66   8  39  17]]
Validation normalized_cm: [[0.945 0.027 0.022 0.007]
 [0.815 0.087 0.054 0.043]
 [0.597 0.026 0.364 0.013]
 [0.508 0.062 0.3   0.131]]
Validation acc: 0.7237728585178056
Validation class_accuracies: [0.9445945945945946, 0.08695652173913043, 0.36363636363636365, 0.13076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3814891776848298
Validation one_indexed_epoch: 18
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 4 epochs
330/330 - 487s - loss: 0.0489 - accuracy: 0.6457 - 487s/epoch - 1s/step
Epoch 19/25
Validation cm: [[710  27   2   1]
 [ 79  12   1   0]
 [ 59   1  17   0]
 [ 76  14  27  13]]
Validation normalized_cm: [[0.959 0.036 0.003 0.001]
 [0.859 0.13  0.011 0.   ]
 [0.766 0.013 0.221 0.   ]
 [0.585 0.108 0.208 0.1  ]]
Validation acc: 0.7237728585178056
Validation class_accuracies: [0.9594594594594594, 0.13043478260869565, 0.22077922077922077, 0.1]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.35266836571184396
Validation one_indexed_epoch: 19
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 5 epochs
330/330 - 487s - loss: 0.0438 - accuracy: 0.6350 - 487s/epoch - 1s/step
Epoch 20/25
Validation cm: [[686  34  12   8]
 [ 63  15   7   7]
 [ 50   7  13   7]
 [ 58  22  21  29]]
Validation normalized_cm: [[0.927 0.046 0.016 0.011]
 [0.685 0.163 0.076 0.076]
 [0.649 0.091 0.169 0.091]
 [0.446 0.169 0.162 0.223]]
Validation acc: 0.7151106833493744
Validation class_accuracies: [0.927027027027027, 0.16304347826086957, 0.16883116883116883, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3704946492989971
Validation one_indexed_epoch: 20
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 6 epochs
330/330 - 485s - loss: 0.0464 - accuracy: 0.6280 - 485s/epoch - 1s/step
Epoch 21/25
Validation cm: [[713  26   0   1]
 [ 79  13   0   0]
 [ 72   3   1   1]
 [ 92  26   8   4]]
Validation normalized_cm: [[0.964 0.035 0.    0.001]
 [0.859 0.141 0.    0.   ]
 [0.935 0.039 0.013 0.013]
 [0.708 0.2   0.062 0.031]]
Validation acc: 0.7035611164581328
Validation class_accuracies: [0.9635135135135136, 0.14130434782608695, 0.012987012987012988, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.287143526273961
Validation one_indexed_epoch: 21
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 7 epochs
330/330 - 485s - loss: 0.0479 - accuracy: 0.6252 - 485s/epoch - 1s/step
Epoch 22/25
Validation cm: [[675  59   6   0]
 [ 73  18   0   1]
 [ 50  12   4  11]
 [ 83  38   4   5]]
Validation normalized_cm: [[0.912 0.08  0.008 0.   ]
 [0.793 0.196 0.    0.011]
 [0.649 0.156 0.052 0.143]
 [0.638 0.292 0.031 0.038]]
Validation acc: 0.6756496631376323
Validation class_accuracies: [0.9121621621621622, 0.1956521739130435, 0.05194805194805195, 0.038461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.29955598162119906
Validation one_indexed_epoch: 22
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 8 epochs
330/330 - 482s - loss: 0.0360 - accuracy: 0.6478 - 482s/epoch - 1s/step
Epoch 23/25
Validation cm: [[711  21   7   1]
 [ 82   9   1   0]
 [ 56   4  16   1]
 [ 76  16  22  16]]
Validation normalized_cm: [[0.961 0.028 0.009 0.001]
 [0.891 0.098 0.011 0.   ]
 [0.727 0.052 0.208 0.013]
 [0.585 0.123 0.169 0.123]]
Validation acc: 0.7237728585178056
Validation class_accuracies: [0.9608108108108108, 0.09782608695652174, 0.2077922077922078, 0.12307692307692308]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3473765071591159
Validation one_indexed_epoch: 23
The validation tracker metric at 0.46102904146382406 hasn't increased by 0 in 9 epochs
330/330 - 484s - loss: 0.0420 - accuracy: 0.6514 - 484s/epoch - 1s/step
Epoch 24/25
Validation cm: [[736   4   0   0]
 [ 91   1   0   0]
 [ 65   1  11   0]
 [ 93  11  22   4]]
Validation normalized_cm: [[0.995 0.005 0.    0.   ]
 [0.989 0.011 0.    0.   ]
 [0.844 0.013 0.143 0.   ]
 [0.715 0.085 0.169 0.031]]
Validation acc: 0.7237728585178056
Validation class_accuracies: [0.9945945945945946, 0.010869565217391304, 0.14285714285714285, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2947726333595899
Validation one_indexed_epoch: 24
The number of epochs since last 1% equals the patience
330/330 - 485s - loss: 0.0371 - accuracy: 0.6385 - 485s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.46102904146382406
Best cm: [[632  79  12  17]
 [ 40  28   9  15]
 [ 39   3  22  13]
 [ 27  10  41  52]]
Best normalized_cm: [[0.854 0.107 0.016 0.023]
 [0.435 0.304 0.098 0.163]
 [0.506 0.039 0.286 0.169]
 [0.208 0.077 0.315 0.4  ]]
Best acc: 0.7064485081809432
Best class_accuracies: [0.8540540540540541, 0.30434782608695654, 0.2857142857142857, 0.4]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 14
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train57.py", line 213, in <module>
    launch_job({"Bd": 0, "Jordan": 0, "Icbhi": 1, "Perch": 1, "Ant": 1, "SimAnt": 1,}, leaf_mixednet_model, spec_aug_params, audio_aug_params, None, [1,0])
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train57.py", line 174, in launch_job
    train_model(datasets, model, spec_aug_params, audio_aug_params, parse_function, label_passed)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train57.py", line 159, in train_model
    callbacks=[metrics_callback, viz_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/alirachidi/classification_algorithm/trainers/modules/callbacks/visualizationCallback.py", line 24, in on_train_end
    diff = self.final_specs[i][0] - self.initial_specs[i][0]
IndexError: list index out of range
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
