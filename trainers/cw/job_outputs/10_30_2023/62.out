Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train62
Description: solo wheezes
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
3933
1336
832
207
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3933 0's, 1336 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 832 0's and 207 1's ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/25
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.6919447928279451
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[580   0]
 [ 72   0]] 
Patient Normalized Confusion matrix: 
 [[1. 0.]
 [1. 0.]] 
Patient Validation accuracy: 
 88.96 
Patient Validation class accuracies: 
 [1.0, 0.0] 
330/330 - 549s - loss: 0.4529 - accuracy: 0.8100 - 549s/epoch - 2s/step
Epoch 2/25
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.45481756317354144
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 2
The validation tracker metric at 0.5 hasn't increased by 0 in 1 epochs
330/330 - 553s - loss: 0.3734 - accuracy: 0.8503 - 553s/epoch - 2s/step
Epoch 3/25
Validation cm: [[827   5]
 [206   1]]
Validation normalized_cm: [[0.994 0.006]
 [0.995 0.005]]
Validation acc: 0.7969201154956689
Validation class_accuracies: [0.9939903846153846, 0.004830917874396135]
Validation precision: 0.16666666666666666
Validation recall: 0.004830917874396135
Validation f1: 0.009389671361502348
Validation roc_auc: 0.49432425213675213
Validation avg_accuracy: 0.49941065124489037
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5 hasn't increased by 0 in 2 epochs
330/330 - 549s - loss: 0.3611 - accuracy: 0.8590 - 549s/epoch - 2s/step
Epoch 4/25
Validation cm: [[824   8]
 [152  55]]
Validation normalized_cm: [[0.99  0.01 ]
 [0.734 0.266]]
Validation acc: 0.8460057747834456
Validation class_accuracies: [0.9903846153846154, 0.26570048309178745]
Validation precision: 0.873015873015873
Validation recall: 0.26570048309178745
Validation f1: 0.40740740740740744
Validation roc_auc: 0.8209221711259755
Validation avg_accuracy: 0.6280425492382015
Validation one_indexed_epoch: 4
-- New best results were achieved. --
Patient Confusion matrix: 
 [[576   4]
 [ 52  20]] 
Patient Normalized Confusion matrix: 
 [[0.993 0.007]
 [0.722 0.278]] 
Patient Validation accuracy: 
 91.41 
Patient Validation class accuracies: 
 [0.993103448275862, 0.2777777777777778] 
330/330 - 549s - loss: 0.3359 - accuracy: 0.8725 - 549s/epoch - 2s/step
Epoch 5/25
Validation cm: [[830   2]
 [206   1]]
Validation normalized_cm: [[0.998 0.002]
 [0.995 0.005]]
Validation acc: 0.7998075072184793
Validation class_accuracies: [0.9975961538461539, 0.004830917874396135]
Validation precision: 0.3333333333333333
Validation recall: 0.004830917874396135
Validation f1: 0.009523809523809523
Validation roc_auc: 0.6001109020810108
Validation avg_accuracy: 0.501213535860275
Validation one_indexed_epoch: 5
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 1 epochs
330/330 - 550s - loss: 0.3268 - accuracy: 0.8708 - 550s/epoch - 2s/step
Epoch 6/25
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.36036498978075066
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 6
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 2 epochs
330/330 - 549s - loss: 0.3106 - accuracy: 0.8787 - 549s/epoch - 2s/step
Epoch 7/25
Validation cm: [[827   5]
 [204   3]]
Validation normalized_cm: [[0.994 0.006]
 [0.986 0.014]]
Validation acc: 0.7988450433108758
Validation class_accuracies: [0.9939903846153846, 0.014492753623188406]
Validation precision: 0.375
Validation recall: 0.014492753623188406
Validation f1: 0.027906976744186046
Validation roc_auc: 0.591999372909699
Validation avg_accuracy: 0.5042415691192865
Validation one_indexed_epoch: 7
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 3 epochs
330/330 - 548s - loss: 0.2910 - accuracy: 0.8884 - 548s/epoch - 2s/step
Epoch 8/25
Validation cm: [[829   3]
 [198   9]]
Validation normalized_cm: [[0.996 0.004]
 [0.957 0.043]]
Validation acc: 0.8065447545717036
Validation class_accuracies: [0.9963942307692307, 0.043478260869565216]
Validation precision: 0.75
Validation recall: 0.043478260869565216
Validation f1: 0.0821917808219178
Validation roc_auc: 0.6553877508361204
Validation avg_accuracy: 0.519936245819398
Validation one_indexed_epoch: 8
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 4 epochs
330/330 - 549s - loss: 0.2763 - accuracy: 0.8920 - 549s/epoch - 2s/step
Epoch 9/25
Validation cm: [[828   4]
 [192  15]]
Validation normalized_cm: [[0.995 0.005]
 [0.928 0.072]]
Validation acc: 0.8113570741097209
Validation class_accuracies: [0.9951923076923077, 0.07246376811594203]
Validation precision: 0.7894736842105263
Validation recall: 0.07246376811594203
Validation f1: 0.13274336283185842
Validation roc_auc: 0.5863787857673728
Validation avg_accuracy: 0.5338280379041249
Validation one_indexed_epoch: 9
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 5 epochs
330/330 - 549s - loss: 0.2770 - accuracy: 0.8975 - 549s/epoch - 2s/step
Epoch 10/25
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.4449466973244147
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 10
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 6 epochs
330/330 - 549s - loss: 0.2591 - accuracy: 0.9021 - 549s/epoch - 2s/step
Epoch 11/25
Validation cm: [[826   6]
 [186  21]]
Validation normalized_cm: [[0.993 0.007]
 [0.899 0.101]]
Validation acc: 0.8152069297401348
Validation class_accuracies: [0.9927884615384616, 0.10144927536231885]
Validation precision: 0.7777777777777778
Validation recall: 0.10144927536231885
Validation f1: 0.1794871794871795
Validation roc_auc: 0.5495314241917504
Validation avg_accuracy: 0.5471188684503903
Validation one_indexed_epoch: 11
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 7 epochs
330/330 - 553s - loss: 0.2423 - accuracy: 0.9062 - 553s/epoch - 2s/step
Epoch 12/25
Validation cm: [[830   2]
 [204   3]]
Validation normalized_cm: [[0.998 0.002]
 [0.986 0.014]]
Validation acc: 0.8017324350336862
Validation class_accuracies: [0.9975961538461539, 0.014492753623188406]
Validation precision: 0.6
Validation recall: 0.014492753623188406
Validation f1: 0.028301886792452834
Validation roc_auc: 0.6185636148272018
Validation avg_accuracy: 0.5060444537346711
Validation one_indexed_epoch: 12
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 8 epochs
330/330 - 548s - loss: 0.2453 - accuracy: 0.9087 - 548s/epoch - 2s/step
Epoch 13/25
Validation cm: [[818  14]
 [154  53]]
Validation normalized_cm: [[0.983 0.017]
 [0.744 0.256]]
Validation acc: 0.8383060635226179
Validation class_accuracies: [0.9831730769230769, 0.2560386473429952]
Validation precision: 0.7910447761194029
Validation recall: 0.2560386473429952
Validation f1: 0.3868613138686131
Validation roc_auc: 0.8216189381270903
Validation avg_accuracy: 0.619605862133036
Validation one_indexed_epoch: 13
The validation tracker metric at 0.6280425492382015 hasn't increased by 0 in 9 epochs
330/330 - 547s - loss: 0.2319 - accuracy: 0.9138 - 547s/epoch - 2s/step
Epoch 14/25
Validation cm: [[766  66]
 [156  51]]
Validation normalized_cm: [[0.921 0.079]
 [0.754 0.246]]
Validation acc: 0.7863330125120308
Validation class_accuracies: [0.9206730769230769, 0.2463768115942029]
Validation precision: 0.4358974358974359
Validation recall: 0.2463768115942029
Validation f1: 0.3148148148148148
Validation roc_auc: 0.5866284606094389
Validation avg_accuracy: 0.5835249442586399
Validation one_indexed_epoch: 14
The number of epochs since last 1% equals the patience
330/330 - 549s - loss: 0.2128 - accuracy: 0.9176 - 549s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.6280425492382015
Best cm: [[824   8]
 [152  55]]
Best normalized_cm: [[0.99  0.01 ]
 [0.734 0.266]]
Best acc: 0.8460057747834456
Best class_accuracies: [0.9903846153846154, 0.26570048309178745]
Best precision: 0.873015873015873
Best recall: 0.26570048309178745
Best f1: 0.40740740740740744
Best roc_auc: 0.8209221711259755
Best one_indexed_epoch: 4
Best patient_cm: [[576   4]
 [ 52  20]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
Traceback (most recent call last):
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train62.py", line 213, in <module>
    launch_job({"Bd": 0, "Jordan": 0, "Icbhi": 1, "Perch": 1, "Ant": 1, "SimAnt": 1,}, leaf_mixednet_model, spec_aug_params, audio_aug_params, None, [0,1])
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train62.py", line 174, in launch_job
    train_model(datasets, model, spec_aug_params, audio_aug_params, parse_function, label_passed)
  File "/home/alirachidi/classification_algorithm/trainers/cw/models/train62.py", line 159, in train_model
    callbacks=[metrics_callback, viz_callback]
  File "/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/alirachidi/classification_algorithm/trainers/modules/callbacks/visualizationCallback.py", line 24, in on_train_end
    diff = self.final_specs[i][0] - self.initial_specs[i][0]
IndexError: list index out of range
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
