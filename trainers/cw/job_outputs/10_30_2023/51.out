Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train51
Description: c+w solo
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
4055
1214
817
222
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 4055 0's, 1214 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 817 0's and 222 1's ---
Model: "leaf_mixednet_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential (Sequential)                         (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
Validation cm: [[815   2]
 [222   0]]
Validation normalized_cm: [[0.998 0.002]
 [1.    0.   ]]
Validation acc: 0.7844080846968239
Validation class_accuracies: [0.9975520195838433, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.7792958196874965
Validation avg_accuracy: 0.49877600979192166
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[617   2]
 [ 33   0]] 
Patient Normalized Confusion matrix: 
 [[0.997 0.003]
 [1.    0.   ]] 
Patient Validation accuracy: 
 94.63 
Patient Validation class accuracies: 
 [0.9967689822294022, 0.0] 
Saving model...
330/330 - 544s - loss: 0.4489 - accuracy: 0.7719 - 544s/epoch - 2s/step
Epoch 2/40
Validation cm: [[794  23]
 [212  10]]
Validation normalized_cm: [[0.972 0.028]
 [0.955 0.045]]
Validation acc: 0.7738209817131858
Validation class_accuracies: [0.9718482252141983, 0.04504504504504504]
Validation precision: 0.30303030303030304
Validation recall: 0.04504504504504504
Validation f1: 0.0784313725490196
Validation roc_auc: 0.5318072050018194
Validation avg_accuracy: 0.5084466351296217
Validation one_indexed_epoch: 2
-- New best results were achieved. --
Patient Confusion matrix: 
 [[616   3]
 [ 32   1]] 
Patient Normalized Confusion matrix: 
 [[0.995 0.005]
 [0.97  0.03 ]] 
Patient Validation accuracy: 
 94.63 
Patient Validation class accuracies: 
 [0.9951534733441034, 0.030303030303030304] 
Saving model...
330/330 - 537s - loss: 0.4007 - accuracy: 0.8013 - 537s/epoch - 2s/step
Epoch 3/40
Validation cm: [[241 576]
 [ 16 206]]
Validation normalized_cm: [[0.295 0.705]
 [0.072 0.928]]
Validation acc: 0.4302213666987488
Validation class_accuracies: [0.29498164014687883, 0.9279279279279279]
Validation precision: 0.26342710997442453
Validation recall: 0.9279279279279279
Validation f1: 0.4103585657370517
Validation roc_auc: 0.7631027600427844
Validation avg_accuracy: 0.6114547840374034
Validation one_indexed_epoch: 3
-- New best results were achieved. --
Patient Confusion matrix: 
 [[232 387]
 [  7  26]] 
Patient Normalized Confusion matrix: 
 [[0.375 0.625]
 [0.212 0.788]] 
Patient Validation accuracy: 
 39.57 
Patient Validation class accuracies: 
 [0.37479806138933763, 0.7878787878787878] 
Saving model...
330/330 - 539s - loss: 0.4210 - accuracy: 0.7954 - 539s/epoch - 2s/step
Epoch 4/40
Validation cm: [[817   0]
 [222   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.7863330125120308
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.7760621698810193
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 4
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 1 epochs
330/330 - 543s - loss: 0.4381 - accuracy: 0.7878 - 543s/epoch - 2s/step
Epoch 5/40
Validation cm: [[ 83 734]
 [ 57 165]]
Validation normalized_cm: [[0.102 0.898]
 [0.257 0.743]]
Validation acc: 0.2386910490856593
Validation class_accuracies: [0.10159118727050184, 0.7432432432432432]
Validation precision: 0.1835372636262514
Validation recall: 0.7432432432432432
Validation f1: 0.2943800178412132
Validation roc_auc: 0.43119741528554256
Validation avg_accuracy: 0.42241721525687254
Validation one_indexed_epoch: 5
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 2 epochs
330/330 - 537s - loss: 0.4084 - accuracy: 0.7979 - 537s/epoch - 2s/step
Epoch 6/40
Validation cm: [[817   0]
 [222   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.7863330125120308
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.44551038186289105
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 6
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 3 epochs
330/330 - 544s - loss: 0.3831 - accuracy: 0.8176 - 544s/epoch - 2s/step
Epoch 7/40
Validation cm: [[703 114]
 [148  74]]
Validation normalized_cm: [[0.86  0.14 ]
 [0.667 0.333]]
Validation acc: 0.7478344562078922
Validation class_accuracies: [0.8604651162790697, 0.3333333333333333]
Validation precision: 0.39361702127659576
Validation recall: 0.3333333333333333
Validation f1: 0.36097560975609755
Validation roc_auc: 0.6488967547719078
Validation avg_accuracy: 0.5968992248062015
Validation one_indexed_epoch: 7
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 4 epochs
330/330 - 547s - loss: 0.3702 - accuracy: 0.8178 - 547s/epoch - 2s/step
Epoch 8/40
Validation cm: [[769  48]
 [195  27]]
Validation normalized_cm: [[0.941 0.059]
 [0.878 0.122]]
Validation acc: 0.766121270452358
Validation class_accuracies: [0.9412484700122399, 0.12162162162162163]
Validation precision: 0.36
Validation recall: 0.12162162162162163
Validation f1: 0.18181818181818185
Validation roc_auc: 0.40815111316947295
Validation avg_accuracy: 0.5314350458169308
Validation one_indexed_epoch: 8
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 5 epochs
330/330 - 573s - loss: 0.3550 - accuracy: 0.8368 - 573s/epoch - 2s/step
Epoch 9/40
Validation cm: [[800  17]
 [217   5]]
Validation normalized_cm: [[0.979 0.021]
 [0.977 0.023]]
Validation acc: 0.7747834456207893
Validation class_accuracies: [0.9791921664626683, 0.02252252252252252]
Validation precision: 0.22727272727272727
Validation recall: 0.02252252252252252
Validation f1: 0.04098360655737705
Validation roc_auc: 0.3630288795527473
Validation avg_accuracy: 0.5008573444925954
Validation one_indexed_epoch: 9
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 6 epochs
330/330 - 568s - loss: 0.3760 - accuracy: 0.8224 - 568s/epoch - 2s/step
Epoch 10/40
Validation cm: [[759  58]
 [165  57]]
Validation normalized_cm: [[0.929 0.071]
 [0.743 0.257]]
Validation acc: 0.7853705486044273
Validation class_accuracies: [0.9290085679314566, 0.25675675675675674]
Validation precision: 0.4956521739130435
Validation recall: 0.25675675675675674
Validation f1: 0.3382789317507418
Validation roc_auc: 0.5259243331458754
Validation avg_accuracy: 0.5928826623441067
Validation one_indexed_epoch: 10
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 7 epochs
330/330 - 568s - loss: 0.3634 - accuracy: 0.8239 - 568s/epoch - 2s/step
Epoch 11/40
Validation cm: [[715 102]
 [168  54]]
Validation normalized_cm: [[0.875 0.125]
 [0.757 0.243]]
Validation acc: 0.7401347449470644
Validation class_accuracies: [0.8751529987760098, 0.24324324324324326]
Validation precision: 0.34615384615384615
Validation recall: 0.24324324324324326
Validation f1: 0.2857142857142857
Validation roc_auc: 0.5736764916691477
Validation avg_accuracy: 0.5591981210096265
Validation one_indexed_epoch: 11
The validation tracker metric at 0.6114547840374034 hasn't increased by 0 in 8 epochs
330/330 - 564s - loss: 0.3413 - accuracy: 0.8411 - 564s/epoch - 2s/step
Epoch 12/40
Validation cm: [[562 255]
 [ 81 141]]
Validation normalized_cm: [[0.688 0.312]
 [0.365 0.635]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.6878824969400245, 0.6351351351351351]
Validation precision: 0.3560606060606061
Validation recall: 0.6351351351351351
Validation f1: 0.4563106796116505
Validation roc_auc: 0.7240811803235305
Validation avg_accuracy: 0.6615088160375797
Validation one_indexed_epoch: 12
-- New best results were achieved. --
Patient Confusion matrix: 
 [[486 133]
 [ 18  15]] 
Patient Normalized Confusion matrix: 
 [[0.785 0.215]
 [0.545 0.455]] 
Patient Validation accuracy: 
 76.84 
Patient Validation class accuracies: 
 [0.7851373182552503, 0.45454545454545453] 
Saving model...
330/330 - 566s - loss: 0.3414 - accuracy: 0.8347 - 566s/epoch - 2s/step
Epoch 13/40
Validation cm: [[774  43]
 [191  31]]
Validation normalized_cm: [[0.947 0.053]
 [0.86  0.14 ]]
Validation acc: 0.7747834456207893
Validation class_accuracies: [0.9473684210526315, 0.13963963963963963]
Validation precision: 0.4189189189189189
Validation recall: 0.13963963963963963
Validation f1: 0.20945945945945946
Validation roc_auc: 0.6896192398028383
Validation avg_accuracy: 0.5435040303461356
Validation one_indexed_epoch: 13
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 1 epochs
330/330 - 551s - loss: 0.3325 - accuracy: 0.8402 - 551s/epoch - 2s/step
Epoch 14/40
Validation cm: [[811   6]
 [218   4]]
Validation normalized_cm: [[0.993 0.007]
 [0.982 0.018]]
Validation acc: 0.7844080846968239
Validation class_accuracies: [0.99265605875153, 0.018018018018018018]
Validation precision: 0.4
Validation recall: 0.018018018018018018
Validation f1: 0.034482758620689655
Validation roc_auc: 0.4215819246419002
Validation avg_accuracy: 0.505337038384774
Validation one_indexed_epoch: 14
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 2 epochs
330/330 - 546s - loss: 0.3250 - accuracy: 0.8495 - 546s/epoch - 2s/step
Epoch 15/40
Validation cm: [[705 112]
 [168  54]]
Validation normalized_cm: [[0.863 0.137]
 [0.757 0.243]]
Validation acc: 0.7305101058710298
Validation class_accuracies: [0.8629130966952264, 0.24324324324324326]
Validation precision: 0.3253012048192771
Validation recall: 0.24324324324324326
Validation f1: 0.27835051546391754
Validation roc_auc: 0.49217087344382326
Validation avg_accuracy: 0.5530781699692349
Validation one_indexed_epoch: 15
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 3 epochs
330/330 - 536s - loss: 0.3478 - accuracy: 0.8366 - 536s/epoch - 2s/step
Epoch 16/40
Validation cm: [[749  68]
 [182  40]]
Validation normalized_cm: [[0.917 0.083]
 [0.82  0.18 ]]
Validation acc: 0.7593840230991338
Validation class_accuracies: [0.9167686658506732, 0.18018018018018017]
Validation precision: 0.37037037037037035
Validation recall: 0.18018018018018017
Validation f1: 0.2424242424242424
Validation roc_auc: 0.4312001720202455
Validation avg_accuracy: 0.5484744230154267
Validation one_indexed_epoch: 16
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 4 epochs
330/330 - 535s - loss: 0.3257 - accuracy: 0.8472 - 535s/epoch - 2s/step
Epoch 17/40
Validation cm: [[735  82]
 [181  41]]
Validation normalized_cm: [[0.9   0.1  ]
 [0.815 0.185]]
Validation acc: 0.7468719923002888
Validation class_accuracies: [0.8996328029375765, 0.18468468468468469]
Validation precision: 0.3333333333333333
Validation recall: 0.18468468468468469
Validation f1: 0.23768115942028983
Validation roc_auc: 0.551363480984044
Validation avg_accuracy: 0.5421587438111306
Validation one_indexed_epoch: 17
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 5 epochs
330/330 - 533s - loss: 0.3133 - accuracy: 0.8537 - 533s/epoch - 2s/step
Epoch 18/40
Validation cm: [[543 274]
 [ 81 141]]
Validation normalized_cm: [[0.665 0.335]
 [0.365 0.635]]
Validation acc: 0.65832531280077
Validation class_accuracies: [0.6646266829865362, 0.6351351351351351]
Validation precision: 0.3397590361445783
Validation recall: 0.6351351351351351
Validation f1: 0.44270015698587123
Validation roc_auc: 0.690925932052003
Validation avg_accuracy: 0.6498809090608356
Validation one_indexed_epoch: 18
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 6 epochs
330/330 - 536s - loss: 0.2998 - accuracy: 0.8632 - 536s/epoch - 2s/step
Epoch 19/40
Validation cm: [[607 210]
 [127  95]]
Validation normalized_cm: [[0.743 0.257]
 [0.572 0.428]]
Validation acc: 0.6756496631376323
Validation class_accuracies: [0.7429620563035496, 0.42792792792792794]
Validation precision: 0.3114754098360656
Validation recall: 0.42792792792792794
Validation f1: 0.36053130929791277
Validation roc_auc: 0.6145478403740336
Validation avg_accuracy: 0.5854449921157387
Validation one_indexed_epoch: 19
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 7 epochs
330/330 - 534s - loss: 0.2871 - accuracy: 0.8635 - 534s/epoch - 2s/step
Epoch 20/40
Validation cm: [[781  36]
 [207  15]]
Validation normalized_cm: [[0.956 0.044]
 [0.932 0.068]]
Validation acc: 0.766121270452358
Validation class_accuracies: [0.95593635250918, 0.06756756756756757]
Validation precision: 0.29411764705882354
Validation recall: 0.06756756756756757
Validation f1: 0.10989010989010987
Validation roc_auc: 0.6030798240100566
Validation avg_accuracy: 0.5117519600383738
Validation one_indexed_epoch: 20
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 8 epochs
330/330 - 482s - loss: 0.2721 - accuracy: 0.8795 - 482s/epoch - 1s/step
Epoch 21/40
Validation cm: [[792  25]
 [200  22]]
Validation normalized_cm: [[0.969 0.031]
 [0.901 0.099]]
Validation acc: 0.7834456207892204
Validation class_accuracies: [0.9694002447980417, 0.0990990990990991]
Validation precision: 0.46808510638297873
Validation recall: 0.0990990990990991
Validation f1: 0.16356877323420074
Validation roc_auc: 0.6421151874028251
Validation avg_accuracy: 0.5342496719485704
Validation one_indexed_epoch: 21
The validation tracker metric at 0.6615088160375797 hasn't increased by 0 in 9 epochs
330/330 - 482s - loss: 0.2620 - accuracy: 0.8844 - 482s/epoch - 1s/step
Epoch 22/40
Validation cm: [[777  40]
 [201  21]]
Validation normalized_cm: [[0.951 0.049]
 [0.905 0.095]]
Validation acc: 0.7680461982675649
Validation class_accuracies: [0.9510403916768666, 0.0945945945945946]
Validation precision: 0.3442622950819672
Validation recall: 0.0945945945945946
Validation f1: 0.1484098939929329
Validation roc_auc: 0.5913085668287626
Validation avg_accuracy: 0.5228174931357306
Validation one_indexed_epoch: 22
The number of epochs since last 1% equals the patience
330/330 - 481s - loss: 0.2625 - accuracy: 0.8810 - 481s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.6615088160375797
Best cm: [[562 255]
 [ 81 141]]
Best normalized_cm: [[0.688 0.312]
 [0.365 0.635]]
Best acc: 0.6766121270452358
Best class_accuracies: [0.6878824969400245, 0.6351351351351351]
Best precision: 0.3560606060606061
Best recall: 0.6351351351351351
Best f1: 0.4563106796116505
Best roc_auc: 0.7240811803235305
Best one_indexed_epoch: 12
Best patient_cm: [[486 133]
 [ 18  15]]
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
Job id is 2.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
3933
1336
832
207
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3933 0's, 1336 1's and 0 others ---
--- Final Validation dataset contains 1039 elements, with 832 0's and 207 1's ---
Model: "leaf_mixednet_model_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 sequential_1 (Sequential)                       (None, 1)                                   105823           
                                                                                                              
==============================================================================================================
Total params: 106,383
Trainable params: 105,887
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/40
Validation cm: [[  7 825]
 [  3 204]]
Validation normalized_cm: [[0.008 0.992]
 [0.014 0.986]]
Validation acc: 0.2030798845043311
Validation class_accuracies: [0.008413461538461538, 0.9855072463768116]
Validation precision: 0.19825072886297376
Validation recall: 0.9855072463768116
Validation f1: 0.3300970873786408
Validation roc_auc: 0.3521779775176514
Validation avg_accuracy: 0.4969603539576366
Validation one_indexed_epoch: 1
-- New best results were achieved. --
Patient Confusion matrix: 
 [[  7 573]
 [  3  69]] 
Patient Normalized Confusion matrix: 
 [[0.012 0.988]
 [0.042 0.958]] 
Patient Validation accuracy: 
 11.66 
Patient Validation class accuracies: 
 [0.01206896551724138, 0.9583333333333334] 
Saving model...
330/330 - 488s - loss: 0.5487 - accuracy: 0.7421 - 488s/epoch - 1s/step
Epoch 2/40
Validation cm: [[825   7]
 [204   3]]
Validation normalized_cm: [[0.992 0.008]
 [0.986 0.014]]
Validation acc: 0.7969201154956689
Validation class_accuracies: [0.9915865384615384, 0.014492753623188406]
Validation precision: 0.3
Validation recall: 0.014492753623188406
Validation f1: 0.027649769585253458
Validation roc_auc: 0.6003431577480491
Validation avg_accuracy: 0.5030396460423634
Validation one_indexed_epoch: 2
-- New best results were achieved. --
Patient Confusion matrix: 
 [[573   7]
 [ 69   3]] 
Patient Normalized Confusion matrix: 
 [[0.988 0.012]
 [0.958 0.042]] 
Patient Validation accuracy: 
 88.34 
Patient Validation class accuracies: 
 [0.9879310344827587, 0.041666666666666664] 
Saving model...
330/330 - 484s - loss: 0.5155 - accuracy: 0.7569 - 484s/epoch - 1s/step
Epoch 3/40
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.6302983324043107
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 3
The validation tracker metric at 0.5030396460423634 hasn't increased by 0 in 1 epochs
330/330 - 484s - loss: 0.4913 - accuracy: 0.7768 - 484s/epoch - 1s/step
Epoch 4/40
Validation cm: [[832   0]
 [200   7]]
Validation normalized_cm: [[1.    0.   ]
 [0.966 0.034]]
Validation acc: 0.8075072184793071
Validation class_accuracies: [1.0, 0.033816425120772944]
Validation precision: 1.0
Validation recall: 0.033816425120772944
Validation f1: 0.06542056074766354
Validation roc_auc: 0.6743688452248234
Validation avg_accuracy: 0.5169082125603864
Validation one_indexed_epoch: 4
-- New best results were achieved. --
Patient Confusion matrix: 
 [[580   0]
 [ 71   1]] 
Patient Normalized Confusion matrix: 
 [[1.    0.   ]
 [0.986 0.014]] 
Patient Validation accuracy: 
 89.11 
Patient Validation class accuracies: 
 [1.0, 0.013888888888888888] 
Saving model...
330/330 - 483s - loss: 0.4921 - accuracy: 0.7724 - 483s/epoch - 1s/step
Epoch 5/40
Validation cm: [[413 419]
 [145  62]]
Validation normalized_cm: [[0.496 0.504]
 [0.7   0.3  ]]
Validation acc: 0.4571703561116458
Validation class_accuracies: [0.4963942307692308, 0.2995169082125604]
Validation precision: 0.1288981288981289
Validation recall: 0.2995169082125604
Validation f1: 0.1802325581395349
Validation roc_auc: 0.3847808667781494
Validation avg_accuracy: 0.3979555694908956
Validation one_indexed_epoch: 5
The validation tracker metric at 0.5169082125603864 hasn't increased by 0 in 1 epochs
330/330 - 485s - loss: 0.4860 - accuracy: 0.7785 - 485s/epoch - 1s/step
Epoch 6/40
Validation cm: [[456 376]
 [ 65 142]]
Validation normalized_cm: [[0.548 0.452]
 [0.314 0.686]]
Validation acc: 0.575553416746872
Validation class_accuracies: [0.5480769230769231, 0.6859903381642513]
Validation precision: 0.27413127413127414
Validation recall: 0.6859903381642513
Validation f1: 0.3917241379310345
Validation roc_auc: 0.6750888377926423
Validation avg_accuracy: 0.6170336306205872
Validation one_indexed_epoch: 6
-- New best results were achieved. --
Patient Confusion matrix: 
 [[399 181]
 [ 48  24]] 
Patient Normalized Confusion matrix: 
 [[0.688 0.312]
 [0.667 0.333]] 
Patient Validation accuracy: 
 64.88 
Patient Validation class accuracies: 
 [0.6879310344827586, 0.3333333333333333] 
Saving model...
330/330 - 484s - loss: 0.5001 - accuracy: 0.7601 - 484s/epoch - 1s/step
Epoch 7/40
Validation cm: [[831   1]
 [204   3]]
Validation normalized_cm: [[0.999 0.001]
 [0.986 0.014]]
Validation acc: 0.8026948989412896
Validation class_accuracies: [0.9987980769230769, 0.014492753623188406]
Validation precision: 0.75
Validation recall: 0.014492753623188406
Validation f1: 0.028436018957345974
Validation roc_auc: 0.6071946999256781
Validation avg_accuracy: 0.5066454152731327
Validation one_indexed_epoch: 7
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 1 epochs
330/330 - 484s - loss: 0.4709 - accuracy: 0.7859 - 484s/epoch - 1s/step
Epoch 8/40
Validation cm: [[818  14]
 [179  28]]
Validation normalized_cm: [[0.983 0.017]
 [0.865 0.135]]
Validation acc: 0.8142444658325313
Validation class_accuracies: [0.9831730769230769, 0.13526570048309178]
Validation precision: 0.6666666666666666
Validation recall: 0.13526570048309178
Validation f1: 0.22489959839357426
Validation roc_auc: 0.715646483649201
Validation avg_accuracy: 0.5592193887030843
Validation one_indexed_epoch: 8
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 2 epochs
330/330 - 484s - loss: 0.4764 - accuracy: 0.7759 - 484s/epoch - 1s/step
Epoch 9/40
Validation cm: [[  7 825]
 [  3 204]]
Validation normalized_cm: [[0.008 0.992]
 [0.014 0.986]]
Validation acc: 0.2030798845043311
Validation class_accuracies: [0.008413461538461538, 0.9855072463768116]
Validation precision: 0.19825072886297376
Validation recall: 0.9855072463768116
Validation f1: 0.3300970873786408
Validation roc_auc: 0.4969603539576366
Validation avg_accuracy: 0.4969603539576366
Validation one_indexed_epoch: 9
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 3 epochs
330/330 - 485s - loss: 0.4602 - accuracy: 0.7909 - 485s/epoch - 1s/step
Epoch 10/40
Validation cm: [[832   0]
 [201   6]]
Validation normalized_cm: [[1.    0.   ]
 [0.971 0.029]]
Validation acc: 0.8065447545717036
Validation class_accuracies: [1.0, 0.028985507246376812]
Validation precision: 1.0
Validation recall: 0.028985507246376812
Validation f1: 0.05633802816901409
Validation roc_auc: 0.5608190496098104
Validation avg_accuracy: 0.5144927536231884
Validation one_indexed_epoch: 10
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 4 epochs
330/330 - 485s - loss: 0.4487 - accuracy: 0.8041 - 485s/epoch - 1s/step
Epoch 11/40
Validation cm: [[ 80 752]
 [ 15 192]]
Validation normalized_cm: [[0.096 0.904]
 [0.072 0.928]]
Validation acc: 0.26179018286814243
Validation class_accuracies: [0.09615384615384616, 0.927536231884058]
Validation precision: 0.2033898305084746
Validation recall: 0.927536231884058
Validation f1: 0.3336229365768897
Validation roc_auc: 0.5359386612783352
Validation avg_accuracy: 0.5118450390189521
Validation one_indexed_epoch: 11
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 5 epochs
330/330 - 483s - loss: 0.4814 - accuracy: 0.7747 - 483s/epoch - 1s/step
Epoch 12/40
Validation cm: [[832   0]
 [206   1]]
Validation normalized_cm: [[1.    0.   ]
 [0.995 0.005]]
Validation acc: 0.8017324350336862
Validation class_accuracies: [1.0, 0.004830917874396135]
Validation precision: 1.0
Validation recall: 0.004830917874396135
Validation f1: 0.009615384615384614
Validation roc_auc: 0.5867097500929023
Validation avg_accuracy: 0.5024154589371981
Validation one_indexed_epoch: 12
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 6 epochs
330/330 - 484s - loss: 0.4672 - accuracy: 0.7897 - 484s/epoch - 1s/step
Epoch 13/40
Validation cm: [[832   0]
 [207   0]]
Validation normalized_cm: [[1. 0.]
 [1. 0.]]
Validation acc: 0.8007699711260827
Validation class_accuracies: [1.0, 0.0]
Validation precision: 0.0
Validation recall: 0.0
Validation f1: 0.0
Validation roc_auc: 0.5657486761426979
Validation avg_accuracy: 0.5
Validation one_indexed_epoch: 13
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 7 epochs
330/330 - 483s - loss: 0.4969 - accuracy: 0.7497 - 483s/epoch - 1s/step
Epoch 14/40
Validation cm: [[249 583]
 [ 75 132]]
Validation normalized_cm: [[0.299 0.701]
 [0.362 0.638]]
Validation acc: 0.3666987487969201
Validation class_accuracies: [0.29927884615384615, 0.6376811594202898]
Validation precision: 0.18461538461538463
Validation recall: 0.6376811594202898
Validation f1: 0.28633405639913234
Validation roc_auc: 0.5062389678558157
Validation avg_accuracy: 0.468480002787068
Validation one_indexed_epoch: 14
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 8 epochs
330/330 - 486s - loss: 0.4733 - accuracy: 0.7730 - 486s/epoch - 1s/step
Epoch 15/40
Validation cm: [[816  16]
 [177  30]]
Validation normalized_cm: [[0.981 0.019]
 [0.855 0.145]]
Validation acc: 0.8142444658325313
Validation class_accuracies: [0.9807692307692307, 0.14492753623188406]
Validation precision: 0.6521739130434783
Validation recall: 0.14492753623188406
Validation f1: 0.23715415019762848
Validation roc_auc: 0.7653491963953921
Validation avg_accuracy: 0.5628483835005574
Validation one_indexed_epoch: 15
The validation tracker metric at 0.6170336306205872 hasn't increased by 0 in 9 epochs
330/330 - 484s - loss: 0.4464 - accuracy: 0.7988 - 484s/epoch - 1s/step
Epoch 16/40
Validation cm: [[740  92]
 [149  58]]
Validation normalized_cm: [[0.889 0.111]
 [0.72  0.28 ]]
Validation acc: 0.7680461982675649
Validation class_accuracies: [0.8894230769230769, 0.28019323671497587]
Validation precision: 0.38666666666666666
Validation recall: 0.28019323671497587
Validation f1: 0.3249299719887956
Validation roc_auc: 0.6899706196581198
Validation avg_accuracy: 0.5848081568190264
Validation one_indexed_epoch: 16
The number of epochs since last 1% equals the patience
330/330 - 485s - loss: 0.4377 - accuracy: 0.8022 - 485s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.6170336306205872
Best cm: [[456 376]
 [ 65 142]]
Best normalized_cm: [[0.548 0.452]
 [0.314 0.686]]
Best acc: 0.575553416746872
Best class_accuracies: [0.5480769230769231, 0.6859903381642513]
Best precision: 0.27413127413127414
Best recall: 0.6859903381642513
Best f1: 0.3917241379310345
Best roc_auc: 0.6750888377926423
Best one_indexed_epoch: 6
Best patient_cm: [[399 181]
 [ 48  24]]
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
patient_cm
