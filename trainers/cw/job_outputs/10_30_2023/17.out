Validation cm: [[177 563   0   0]
 [ 46  46   0   0]
 [ 24  53   0   0]
 [106  24   0   0]]
Validation normalized_cm: [[0.239 0.761 0.    0.   ]
 [0.5   0.5   0.    0.   ]
 [0.312 0.688 0.    0.   ]
 [0.815 0.185 0.    0.   ]]
Validation acc: 0.21462945139557266
Validation class_accuracies: [0.2391891891891892, 0.5, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.1847972972972973
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train17
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    280              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,232
Trainable params: 280
Non-trainable params: 105,952
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/17
[[1. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 741s - loss: 0.6931 - accuracy: 0.8000 - 741s/epoch - 2s/step
Validation cm: [[500 240   0   0]
 [ 73  19   0   0]
 [ 48  29   0   0]
 [118  12   0   0]]
Validation normalized_cm: [[0.676 0.324 0.    0.   ]
 [0.793 0.207 0.    0.   ]
 [0.623 0.377 0.    0.   ]
 [0.908 0.092 0.    0.   ]]
Validation acc: 0.49951876804619827
Validation class_accuracies: [0.6756756756756757, 0.20652173913043478, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.22054935370152762
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 728s - loss: 0.6893 - accuracy: 0.8077 - 728s/epoch - 2s/step
Validation cm: [[425 315   0   0]
 [ 63  29   0   0]
 [ 39  38   0   0]
 [103  27   0   0]]
Validation normalized_cm: [[0.574 0.426 0.    0.   ]
 [0.685 0.315 0.    0.   ]
 [0.506 0.494 0.    0.   ]
 [0.792 0.208 0.    0.   ]]
Validation acc: 0.43695861405197306
Validation class_accuracies: [0.5743243243243243, 0.31521739130434784, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.22238542890716806
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 735s - loss: 0.6761 - accuracy: 0.8121 - 735s/epoch - 2s/step
Validation cm: [[409 331   0   0]
 [ 66  26   0   0]
 [ 40  37   0   0]
 [101  29   0   0]]
Validation normalized_cm: [[0.553 0.447 0.    0.   ]
 [0.717 0.283 0.    0.   ]
 [0.519 0.481 0.    0.   ]
 [0.777 0.223 0.    0.   ]]
Validation acc: 0.41867179980750724
Validation class_accuracies: [0.5527027027027027, 0.2826086956521739, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.20882784958871914
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
The validation tracker metric at 0.22238542890716806 hasn't increased by 0 in 1 epochs
330/330 - 731s - loss: 0.6755 - accuracy: 0.8129 - 731s/epoch - 2s/step
Validation cm: [[413 327   0   0]
 [ 58  34   0   0]
 [ 45  32   0   0]
 [107  23   0   0]]
Validation normalized_cm: [[0.558 0.442 0.    0.   ]
 [0.63  0.37  0.    0.   ]
 [0.584 0.416 0.    0.   ]
 [0.823 0.177 0.    0.   ]]
Validation acc: 0.4302213666987488
Validation class_accuracies: [0.5581081081081081, 0.3695652173913043, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2319183313748531
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 734s - loss: 0.6753 - accuracy: 0.8132 - 734s/epoch - 2s/step
Validation cm: [[402 338   0   0]
 [ 62  30   0   0]
 [ 43  34   0   0]
 [ 95  35   0   0]]
Validation normalized_cm: [[0.543 0.457 0.    0.   ]
 [0.674 0.326 0.    0.   ]
 [0.558 0.442 0.    0.   ]
 [0.731 0.269 0.    0.   ]]
Validation acc: 0.4157844080846968
Validation class_accuracies: [0.5432432432432432, 0.32608695652173914, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2173325499412456
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.2319183313748531 hasn't increased by 0 in 1 epochs
330/330 - 735s - loss: 0.6751 - accuracy: 0.8117 - 735s/epoch - 2s/step
Validation cm: [[406 334   0   0]
 [ 65  27   0   0]
 [ 39  38   0   0]
 [103  27   0   0]]
Validation normalized_cm: [[0.549 0.451 0.    0.   ]
 [0.707 0.293 0.    0.   ]
 [0.506 0.494 0.    0.   ]
 [0.792 0.208 0.    0.   ]]
Validation acc: 0.4167468719923003
Validation class_accuracies: [0.5486486486486486, 0.29347826086956524, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21053172737955345
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
The validation tracker metric at 0.2319183313748531 hasn't increased by 0 in 2 epochs
330/330 - 731s - loss: 0.6751 - accuracy: 0.8121 - 731s/epoch - 2s/step
Validation cm: [[394 346   0   0]
 [ 61  31   0   0]
 [ 41  36   0   0]
 [ 98  32   0   0]]
Validation normalized_cm: [[0.532 0.468 0.    0.   ]
 [0.663 0.337 0.    0.   ]
 [0.532 0.468 0.    0.   ]
 [0.754 0.246 0.    0.   ]]
Validation acc: 0.40904716073147257
Validation class_accuracies: [0.5324324324324324, 0.33695652173913043, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21734723854289073
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The validation tracker metric at 0.2319183313748531 hasn't increased by 0 in 3 epochs
Lr has been adjusted to 0.0005000000237487257
330/330 - 750s - loss: 0.6750 - accuracy: 0.8115 - 750s/epoch - 2s/step
Validation cm: [[392 348   0   0]
 [ 60  32   0   0]
 [ 39  38   0   0]
 [ 98  32   0   0]]
Validation normalized_cm: [[0.53  0.47  0.    0.   ]
 [0.652 0.348 0.    0.   ]
 [0.506 0.494 0.    0.   ]
 [0.754 0.246 0.    0.   ]]
Validation acc: 0.4080846968238691
Validation class_accuracies: [0.5297297297297298, 0.34782608695652173, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21938895417156287
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.2319183313748531 hasn't increased by 0 in 4 epochs
330/330 - 745s - loss: 0.6749 - accuracy: 0.8110 - 745s/epoch - 2s/step
Validation cm: [[392 348   0   0]
 [ 61  31   0   0]
 [ 38  39   0   0]
 [101  29   0   0]]
Validation normalized_cm: [[0.53  0.47  0.    0.   ]
 [0.663 0.337 0.    0.   ]
 [0.494 0.506 0.    0.   ]
 [0.777 0.223 0.    0.   ]]
Validation acc: 0.40712223291626565
Validation class_accuracies: [0.5297297297297298, 0.33695652173913043, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21667156286721506
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
The validation tracker metric at 0.2319183313748531 hasn't increased by 0 in 5 epochs
330/330 - 755s - loss: 0.6748 - accuracy: 0.8123 - 755s/epoch - 2s/step
Validation cm: [[384 356   0   0]
 [ 60  32   0   0]
 [ 38  39   0   0]
 [100  30   0   0]]
Validation normalized_cm: [[0.519 0.481 0.    0.   ]
 [0.652 0.348 0.    0.   ]
 [0.494 0.506 0.    0.   ]
 [0.769 0.231 0.    0.   ]]
Validation acc: 0.40038498556304136
Validation class_accuracies: [0.518918918918919, 0.34782608695652173, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21668625146886017
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The number of epochs since last 1% equals the patience
Lr has been adjusted to 0.0002500000118743628
330/330 - 758s - loss: 0.6747 - accuracy: 0.8127 - 758s/epoch - 2s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.2319183313748531
Best cm: [[413 327   0   0]
 [ 58  34   0   0]
 [ 45  32   0   0]
 [107  23   0   0]]
Best normalized_cm: [[0.558 0.442 0.    0.   ]
 [0.63  0.37  0.    0.   ]
 [0.584 0.416 0.    0.   ]
 [0.823 0.177 0.    0.   ]]
Best acc: 0.4302213666987488
Best class_accuracies: [0.5581081081081081, 0.3695652173913043, 0.0, 0.0]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 5
Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
Target metric is avg_accuracy
Epoch 1/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 468s - loss: 0.5386 - accuracy: 0.3171 - 468s/epoch - 1s/step
Validation cm: [[738   2   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [129   1   0   0]]
Validation normalized_cm: [[0.997 0.003 0.    0.   ]
 [1.    0.    0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.992 0.008 0.    0.   ]]
Validation acc: 0.710298363811357
Validation class_accuracies: [0.9972972972972973, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24932432432432433
Validation one_indexed_epoch: 2
Epoch 2/17
[[0. 0.]]
The validation tracker metric at 0.25 hasn't increased by 0 in 1 epochs
330/330 - 456s - loss: 0.5043 - accuracy: 0.3097 - 456s/epoch - 1s/step
Validation cm: [[724  16   0   0]
 [ 88   4   0   0]
 [ 77   0   0   0]
 [122   7   1   0]]
Validation normalized_cm: [[0.978 0.022 0.    0.   ]
 [0.957 0.043 0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.938 0.054 0.008 0.   ]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.9783783783783784, 0.043478260869565216, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2554641598119859
Validation one_indexed_epoch: 3
Epoch 3/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 467s - loss: 0.4948 - accuracy: 0.3261 - 467s/epoch - 1s/step
Validation cm: [[719  20   1   0]
 [ 85   5   2   0]
 [ 74   0   3   0]
 [121   7   2   0]]
Validation normalized_cm: [[0.972 0.027 0.001 0.   ]
 [0.924 0.054 0.022 0.   ]
 [0.961 0.    0.039 0.   ]
 [0.931 0.054 0.015 0.   ]]
Validation acc: 0.699711260827719
Validation class_accuracies: [0.9716216216216216, 0.05434782608695652, 0.03896103896103896, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26623262166740425
Validation one_indexed_epoch: 4
Epoch 4/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 457s - loss: 0.4866 - accuracy: 0.3031 - 457s/epoch - 1s/step
Validation cm: [[714  26   0   0]
 [ 86   6   0   0]
 [ 76   0   1   0]
 [120   8   2   0]]
Validation normalized_cm: [[0.965 0.035 0.    0.   ]
 [0.935 0.065 0.    0.   ]
 [0.987 0.    0.013 0.   ]
 [0.923 0.062 0.015 0.   ]]
Validation acc: 0.6939364773820982
Validation class_accuracies: [0.9648648648648649, 0.06521739130434782, 0.012987012987012988, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2607673172890564
Validation one_indexed_epoch: 5
Epoch 5/17
[[0. 0.]]
The validation tracker metric at 0.26623262166740425 hasn't increased by 0 in 1 epochs
330/330 - 457s - loss: 0.4841 - accuracy: 0.3490 - 457s/epoch - 1s/step
Validation cm: [[707  12  21   0]
 [ 86   2   4   0]
 [ 72   0   5   0]
 [103   6  20   1]]
Validation normalized_cm: [[0.955 0.016 0.028 0.   ]
 [0.935 0.022 0.043 0.   ]
 [0.935 0.    0.065 0.   ]
 [0.792 0.046 0.154 0.008]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.9554054054054054, 0.021739130434782608, 0.06493506493506493, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26244297711689013
Validation one_indexed_epoch: 6
Epoch 6/17
[[0. 0.]]
The validation tracker metric at 0.26623262166740425 hasn't increased by 0 in 2 epochs
330/330 - 465s - loss: 0.4796 - accuracy: 0.3822 - 465s/epoch - 1s/step
Validation cm: [[526  16 198   0]
 [ 25   4  63   0]
 [ 49   0  28   0]
 [ 19   6 105   0]]
Validation normalized_cm: [[0.711 0.022 0.268 0.   ]
 [0.272 0.043 0.685 0.   ]
 [0.636 0.    0.364 0.   ]
 [0.146 0.046 0.808 0.   ]]
Validation acc: 0.5370548604427334
Validation class_accuracies: [0.7108108108108108, 0.043478260869565216, 0.36363636363636365, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2794813588291849
Validation one_indexed_epoch: 7
Epoch 7/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 455s - loss: 0.4745 - accuracy: 0.3712 - 455s/epoch - 1s/step
Validation cm: [[707  14  19   0]
 [ 84   4   4   0]
 [ 71   0   6   0]
 [105   6  19   0]]
Validation normalized_cm: [[0.955 0.019 0.026 0.   ]
 [0.913 0.043 0.043 0.   ]
 [0.922 0.    0.078 0.   ]
 [0.808 0.046 0.146 0.   ]]
Validation acc: 0.6900866217516843
Validation class_accuracies: [0.9554054054054054, 0.043478260869565216, 0.07792207792207792, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2692014360492621
Validation one_indexed_epoch: 8
Epoch 8/17
[[0. 0.]]
The validation tracker metric at 0.2794813588291849 hasn't increased by 0 in 1 epochs
330/330 - 463s - loss: 0.4713 - accuracy: 0.4050 - 463s/epoch - 1s/step
Validation cm: [[724  16   0   0]
 [ 87   5   0   0]
 [ 77   0   0   0]
 [123   7   0   0]]
Validation normalized_cm: [[0.978 0.022 0.    0.   ]
 [0.946 0.054 0.    0.   ]
 [1.    0.    0.    0.   ]
 [0.946 0.054 0.    0.   ]]
Validation acc: 0.7016361886429259
Validation class_accuracies: [0.9783783783783784, 0.05434782608695652, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25818155111633373
Validation one_indexed_epoch: 9
Epoch 9/17
[[0. 0.]]
The validation tracker metric at 0.2794813588291849 hasn't increased by 0 in 2 epochs
330/330 - 462s - loss: 0.4699 - accuracy: 0.4092 - 462s/epoch - 1s/step
Validation cm: [[718  15   4   3]
 [ 87   4   1   0]
 [ 69   0   8   0]
 [115   4   8   3]]
Validation normalized_cm: [[0.97  0.02  0.005 0.004]
 [0.946 0.043 0.011 0.   ]
 [0.896 0.    0.104 0.   ]
 [0.885 0.031 0.062 0.023]]
Validation acc: 0.7054860442733397
Validation class_accuracies: [0.9702702702702702, 0.043478260869565216, 0.1038961038961039, 0.023076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2851803895282156
Validation one_indexed_epoch: 10
Epoch 10/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 454s - loss: 0.4638 - accuracy: 0.3944 - 454s/epoch - 1s/step
Validation cm: [[726   8   2   4]
 [ 89   2   1   0]
 [ 72   0   5   0]
 [115   2   9   4]]
Validation normalized_cm: [[0.981 0.011 0.003 0.005]
 [0.967 0.022 0.011 0.   ]
 [0.935 0.    0.065 0.   ]
 [0.885 0.015 0.069 0.031]]
Validation acc: 0.7093358999037536
Validation class_accuracies: [0.981081081081081, 0.021739130434782608, 0.06493506493506493, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.27463112680503987
Validation one_indexed_epoch: 11
Epoch 11/17
[[0. 0.]]
The validation tracker metric at 0.2851803895282156 hasn't increased by 0 in 1 epochs
330/330 - 467s - loss: 0.4573 - accuracy: 0.4316 - 467s/epoch - 1s/step
Validation cm: [[706  19  14   1]
 [ 86   4   2   0]
 [ 67   0   7   3]
 [105   4  17   4]]
Validation normalized_cm: [[0.954 0.026 0.019 0.001]
 [0.935 0.043 0.022 0.   ]
 [0.87  0.    0.091 0.039]
 [0.808 0.031 0.131 0.031]]
Validation acc: 0.6939364773820982
Validation class_accuracies: [0.9540540540540541, 0.043478260869565216, 0.09090909090909091, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2798026591504852
Validation one_indexed_epoch: 12
Epoch 12/17
[[0. 0.]]
The validation tracker metric at 0.2851803895282156 hasn't increased by 0 in 2 epochs
330/330 - 460s - loss: 0.4563 - accuracy: 0.4060 - 460s/epoch - 1s/step
Validation cm: [[576  23 141   0]
 [ 39   5  48   0]
 [ 53   0  24   0]
 [ 25   4 100   1]]
Validation normalized_cm: [[0.778 0.031 0.191 0.   ]
 [0.424 0.054 0.522 0.   ]
 [0.688 0.    0.312 0.   ]
 [0.192 0.031 0.769 0.008]]
Validation acc: 0.5832531280076997
Validation class_accuracies: [0.7783783783783784, 0.05434782608695652, 0.3116883116883117, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2880267059614886
Validation one_indexed_epoch: 13
Epoch 13/17
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 460s - loss: 0.4544 - accuracy: 0.4172 - 460s/epoch - 1s/step
Validation cm: [[717  14   9   0]
 [ 86   4   2   0]
 [ 70   0   7   0]
 [109   5  16   0]]
Validation normalized_cm: [[0.969 0.019 0.012 0.   ]
 [0.935 0.043 0.022 0.   ]
 [0.909 0.    0.091 0.   ]
 [0.838 0.038 0.123 0.   ]]
Validation acc: 0.7006737247353224
Validation class_accuracies: [0.9689189189189189, 0.043478260869565216, 0.09090909090909091, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.27582656767439373
Validation one_indexed_epoch: 14
Epoch 14/17
[[0. 0.]]
The validation tracker metric at 0.2880267059614886 hasn't increased by 0 in 1 epochs
330/330 - 468s - loss: 0.4521 - accuracy: 0.4373 - 468s/epoch - 1s/step
Validation cm: [[693  19  28   0]
 [ 78   4  10   0]
 [ 72   0   5   0]
 [ 94   1  34   1]]
Validation normalized_cm: [[0.936 0.026 0.038 0.   ]
 [0.848 0.043 0.109 0.   ]
 [0.935 0.    0.065 0.   ]
 [0.723 0.008 0.262 0.008]]
Validation acc: 0.6766121270452358
Validation class_accuracies: [0.9364864864864865, 0.043478260869565216, 0.06493506493506493, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26314802999585607
Validation one_indexed_epoch: 15
Epoch 15/17
[[0. 0.]]
The validation tracker metric at 0.2880267059614886 hasn't increased by 0 in 2 epochs
330/330 - 453s - loss: 0.4452 - accuracy: 0.4234 - 453s/epoch - 1s/step
Validation cm: [[693  24  23   0]
 [ 78   4  10   0]
 [ 70   0   7   0]
 [ 99   3  26   2]]
Validation normalized_cm: [[0.936 0.032 0.031 0.   ]
 [0.848 0.043 0.109 0.   ]
 [0.909 0.    0.091 0.   ]
 [0.762 0.023 0.2   0.015]]
Validation acc: 0.6794995187680462
Validation class_accuracies: [0.9364864864864865, 0.043478260869565216, 0.09090909090909091, 0.015384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2715646134124395
Validation one_indexed_epoch: 16
Epoch 16/17
[[0. 0.]]
The validation tracker metric at 0.2880267059614886 hasn't increased by 0 in 3 epochs
Lr has been adjusted to 0.0001250000059371814
330/330 - 465s - loss: 0.4459 - accuracy: 0.4407 - 465s/epoch - 1s/step
Validation cm: [[706  16  18   0]
 [ 81   4   7   0]
 [ 68   0   9   0]
 [102   1  26   1]]
Validation normalized_cm: [[0.954 0.022 0.024 0.   ]
 [0.88  0.043 0.076 0.   ]
 [0.883 0.    0.117 0.   ]
 [0.785 0.008 0.2   0.008]]
Validation acc: 0.6929740134744947
Validation class_accuracies: [0.9540540540540541, 0.043478260869565216, 0.11688311688311688, 0.007692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28052693487476094
Validation one_indexed_epoch: 17
Epoch 17/17
[[0. 0.]]
The validation tracker metric at 0.2880267059614886 hasn't increased by 0 in 4 epochs
330/330 - 463s - loss: 0.4385 - accuracy: 0.4413 - 463s/epoch - 1s/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.2880267059614886
Best cm: [[576  23 141   0]
 [ 39   5  48   0]
 [ 53   0  24   0]
 [ 25   4 100   1]]
Best normalized_cm: [[0.778 0.031 0.191 0.   ]
 [0.424 0.054 0.522 0.   ]
 [0.688 0.    0.312 0.   ]
 [0.192 0.031 0.769 0.008]]
Best acc: 0.5832531280076997
Best class_accuracies: [0.7783783783783784, 0.05434782608695652, 0.3116883116883117, 0.007692307692307693]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 13
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
