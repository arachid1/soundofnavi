Validation cm: [[740   0   0   0]
 [ 92   0   0   0]
 [ 77   0   0   0]
 [130   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.7122232916265641
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
Tensorflow Version: 2.7.1
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train28
-----------------------
Job id is 1.
- Loading Perch.
3278 Perch audios have been loaded.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Loading Antwerp.
131 Antwerp audios have been loaded.
- Preparing Perch.
862 Perch groups of audio chunks (by filename or patients) have been prepared.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
- Preparing Antwerp.
15 Antwerp groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Perch training dataset went from 0 to 2649 elements, with 2346 none's, 61 crakles, 186 wheezes and 56 both ---
--- Perch Validation dataset contains 629 elements, with 551 none, 12 crackles, 54 wheezes and 12 both ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
--- Antwerp training dataset went from 0 to 580 elements, with 82 none's, 16 crakles, 448 wheezes and 34 both ---
--- Antwerp Validation dataset contains 111 elements, with 17 none, 10 crackles, 5 wheezes and 79 both ---
-----------------------
--- Final training dataset went from 0 to 5269 elements, with 3135 none's, 797 crakles, 919 wheezes and 417 both ---
--- Final Validation dataset contains 1039 elements, with 740 none, 92 crackles, 77 wheezes and 130 both ---
Model: "leaf_model"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 sincnet (SincNet)                               multiple                                    320              
                                                                                                              
 sequential (Sequential)                         (None, 128)                                 105694           
                                                                                                              
 dense (Dense)                                   multiple                                    258              
                                                                                                              
==============================================================================================================
Total params: 106,272
Trainable params: 105,776
Non-trainable params: 496
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 178s - loss: 0.4419 - accuracy: 0.5870 - 178s/epoch - 538ms/step
Validation cm: [[611 111  11   7]
 [ 29  47   3  13]
 [ 52   6  12   7]
 [ 35  30  61   4]]
Validation normalized_cm: [[0.826 0.15  0.015 0.009]
 [0.315 0.511 0.033 0.141]
 [0.675 0.078 0.156 0.091]
 [0.269 0.231 0.469 0.031]]
Validation acc: 0.6487006737247353
Validation class_accuracies: [0.8256756756756757, 0.5108695652173914, 0.15584415584415584, 0.03076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.38078965687661337
Validation one_indexed_epoch: 2
Epoch 2/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 175s - loss: 0.3675 - accuracy: 0.6033 - 175s/epoch - 532ms/step
Validation cm: [[619  63  43  15]
 [ 38  21  18  15]
 [ 33   2  35   7]
 [ 25   3  84  18]]
Validation normalized_cm: [[0.836 0.085 0.058 0.02 ]
 [0.413 0.228 0.196 0.163]
 [0.429 0.026 0.455 0.091]
 [0.192 0.023 0.646 0.138]]
Validation acc: 0.6669874879692012
Validation class_accuracies: [0.8364864864864865, 0.22826086956521738, 0.45454545454545453, 0.13846153846153847]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4144385872646742
Validation one_indexed_epoch: 3
Epoch 3/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 175s - loss: 0.3370 - accuracy: 0.6331 - 175s/epoch - 531ms/step
Validation cm: [[587 102  40  11]
 [ 31  33   8  20]
 [ 30   4  32  11]
 [ 16  19  65  30]]
Validation normalized_cm: [[0.793 0.138 0.054 0.015]
 [0.337 0.359 0.087 0.217]
 [0.39  0.052 0.416 0.143]
 [0.123 0.146 0.5   0.231]]
Validation acc: 0.6564003849855631
Validation class_accuracies: [0.7932432432432432, 0.358695652173913, 0.4155844155844156, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4495731354427007
Validation one_indexed_epoch: 4
Epoch 4/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 176s - loss: 0.3178 - accuracy: 0.6339 - 176s/epoch - 533ms/step
Validation cm: [[675  29  19  17]
 [ 57  19  11   5]
 [ 46   1  21   9]
 [ 62   4  43  21]]
Validation normalized_cm: [[0.912 0.039 0.026 0.023]
 [0.62  0.207 0.12  0.054]
 [0.597 0.013 0.273 0.117]
 [0.477 0.031 0.331 0.162]]
Validation acc: 0.7083734359961501
Validation class_accuracies: [0.9121621621621622, 0.20652173913043478, 0.2727272727272727, 0.16153846153846155]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3882374088895828
Validation one_indexed_epoch: 5
Epoch 5/20
[[0. 0.]]
The validation tracker metric at 0.4495731354427007 hasn't increased by 0 in 1 epochs
330/330 - 176s - loss: 0.2942 - accuracy: 0.6303 - 176s/epoch - 533ms/step
Validation cm: [[535 117  43  45]
 [ 20  37   4  31]
 [ 23  13  14  27]
 [ 18  17  32  63]]
Validation normalized_cm: [[0.723 0.158 0.058 0.061]
 [0.217 0.402 0.043 0.337]
 [0.299 0.169 0.182 0.351]
 [0.138 0.131 0.246 0.485]]
Validation acc: 0.6246390760346487
Validation class_accuracies: [0.722972972972973, 0.40217391304347827, 0.18181818181818182, 0.4846153846153846]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44789511311250446
Validation one_indexed_epoch: 6
Epoch 6/20
[[0. 0.]]
The validation tracker metric at 0.4495731354427007 hasn't increased by 0 in 2 epochs
330/330 - 176s - loss: 0.2700 - accuracy: 0.6538 - 176s/epoch - 532ms/step
Validation cm: [[613  24  62  41]
 [ 40   7  24  21]
 [ 33   1  37   6]
 [ 31   1  71  27]]
Validation normalized_cm: [[0.828 0.032 0.084 0.055]
 [0.435 0.076 0.261 0.228]
 [0.429 0.013 0.481 0.078]
 [0.238 0.008 0.546 0.208]]
Validation acc: 0.65832531280077
Validation class_accuracies: [0.8283783783783784, 0.07608695652173914, 0.4805194805194805, 0.2076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3981692807779764
Validation one_indexed_epoch: 7
Epoch 7/20
[[0. 0.]]
The validation tracker metric at 0.4495731354427007 hasn't increased by 0 in 3 epochs
330/330 - 176s - loss: 0.2484 - accuracy: 0.6899 - 176s/epoch - 533ms/step
Validation cm: [[593 108  21  18]
 [ 30  44   7  11]
 [ 32   5  29  11]
 [ 20  21  39  50]]
Validation normalized_cm: [[0.801 0.146 0.028 0.024]
 [0.326 0.478 0.076 0.12 ]
 [0.416 0.065 0.377 0.143]
 [0.154 0.162 0.3   0.385]]
Validation acc: 0.6891241578440809
Validation class_accuracies: [0.8013513513513514, 0.4782608695652174, 0.37662337662337664, 0.38461538461538464]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.5102127455388326
Validation one_indexed_epoch: 8
Epoch 8/20
[[0. 0.]]
-- New best results were achieved. --
Saving model...
330/330 - 176s - loss: 0.2213 - accuracy: 0.6775 - 176s/epoch - 533ms/step
Validation cm: [[586  98  33  23]
 [ 28  35   8  21]
 [ 30   7  29  11]
 [ 27  25  49  29]]
Validation normalized_cm: [[0.792 0.132 0.045 0.031]
 [0.304 0.38  0.087 0.228]
 [0.39  0.091 0.377 0.143]
 [0.208 0.192 0.377 0.223]]
Validation acc: 0.6535129932627527
Validation class_accuracies: [0.7918918918918919, 0.3804347826086957, 0.37662337662337664, 0.2230769230769231]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.44300674355022185
Validation one_indexed_epoch: 9
Epoch 9/20
[[0. 0.]]
The validation tracker metric at 0.5102127455388326 hasn't increased by 0 in 1 epochs
330/330 - 176s - loss: 0.2034 - accuracy: 0.6643 - 176s/epoch - 532ms/step
Validation cm: [[621  30  76  13]
 [ 56  14  14   8]
 [ 31   0  35  11]
 [ 29   2  71  28]]
Validation normalized_cm: [[0.839 0.041 0.103 0.018]
 [0.609 0.152 0.152 0.087]
 [0.403 0.    0.455 0.143]
 [0.223 0.015 0.546 0.215]]
Validation acc: 0.6717998075072185
Validation class_accuracies: [0.8391891891891892, 0.15217391304347827, 0.45454545454545453, 0.2153846153846154]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4153232930406844
Validation one_indexed_epoch: 10
Epoch 10/20
[[0. 0.]]
The validation tracker metric at 0.5102127455388326 hasn't increased by 0 in 2 epochs
330/330 - 176s - loss: 0.1753 - accuracy: 0.7077 - 176s/epoch - 533ms/step
Validation cm: [[621  70  42   7]
 [ 43  28  14   7]
 [ 40   1  31   5]
 [ 20  12  78  20]]
Validation normalized_cm: [[0.839 0.095 0.057 0.009]
 [0.467 0.304 0.152 0.076]
 [0.519 0.013 0.403 0.065]
 [0.154 0.092 0.6   0.154]]
Validation acc: 0.6737247353224254
Validation class_accuracies: [0.8391891891891892, 0.30434782608695654, 0.4025974025974026, 0.15384615384615385]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4249951429299256
Validation one_indexed_epoch: 11
Epoch 11/20
[[0. 0.]]
The validation tracker metric at 0.5102127455388326 hasn't increased by 0 in 3 epochs
330/330 - 177s - loss: 0.1586 - accuracy: 0.6927 - 177s/epoch - 535ms/step
Validation cm: [[621 102  14   3]
 [ 34  46   5   7]
 [ 45   7  19   6]
 [ 36  30  42  22]]
Validation normalized_cm: [[0.839 0.138 0.019 0.004]
 [0.37  0.5   0.054 0.076]
 [0.584 0.091 0.247 0.078]
 [0.277 0.231 0.323 0.169]]
Validation acc: 0.6814244465832531
Validation class_accuracies: [0.8391891891891892, 0.5, 0.24675324675324675, 0.16923076923076924]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4387933012933013
Validation one_indexed_epoch: 12
Epoch 12/20
[[0. 0.]]
The validation tracker metric at 0.5102127455388326 hasn't increased by 0 in 4 epochs
330/330 - 175s - loss: 0.1423 - accuracy: 0.6937 - 175s/epoch - 531ms/step
Validation cm: [[596  64  60  20]
 [ 45  25  11  11]
 [ 28   3  37   9]
 [ 24   6  57  43]]
Validation normalized_cm: [[0.805 0.086 0.081 0.027]
 [0.489 0.272 0.12  0.12 ]
 [0.364 0.039 0.481 0.117]
 [0.185 0.046 0.438 0.331]]
Validation acc: 0.6746871992300288
Validation class_accuracies: [0.8054054054054054, 0.2717391304347826, 0.4805194805194805, 0.33076923076923076]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.4721083117822248
Validation one_indexed_epoch: 13
Epoch 13/20
[[0. 0.]]
The validation tracker metric at 0.5102127455388326 hasn't increased by 0 in 5 epochs
330/330 - 176s - loss: 0.1179 - accuracy: 0.6884 - 176s/epoch - 534ms/step
Validation cm: [[655  58  21   6]
 [ 54  25  10   3]
 [ 51   3  18   5]
 [ 57  14  42  17]]
Validation normalized_cm: [[0.885 0.078 0.028 0.008]
 [0.587 0.272 0.109 0.033]
 [0.662 0.039 0.234 0.065]
 [0.438 0.108 0.323 0.131]]
Validation acc: 0.6881616939364774
Validation class_accuracies: [0.8851351351351351, 0.2717391304347826, 0.23376623376623376, 0.13076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3803524325263456
Validation one_indexed_epoch: 14
Epoch 14/20
[[0. 0.]]
The number of epochs since last 1% equals the patience
330/330 - 176s - loss: 0.1007 - accuracy: 0.6893 - 176s/epoch - 533ms/step
----------------------------------
The best metrics for this job are: 

Best avg_accuracy: 0.5102127455388326
Best cm: [[593 108  21  18]
 [ 30  44   7  11]
 [ 32   5  29  11]
 [ 20  21  39  50]]
Best normalized_cm: [[0.801 0.146 0.028 0.024]
 [0.326 0.478 0.076 0.12 ]
 [0.416 0.065 0.377 0.143]
 [0.154 0.162 0.3   0.385]]
Best acc: 0.6891241578440809
Best class_accuracies: [0.8013513513513514, 0.4782608695652174, 0.37662337662337664, 0.38461538461538464]
Best precision: None
Best recall: None
Best f1: None
Best roc_auc: None
Best one_indexed_epoch: 8
/home/alirachidi/anaconda3/envs/LungSoundClass/lib/python3.7/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
avg_accuracy
model
cm
normalized_cm
acc
class_accuracies
precision
recall
f1
roc_auc
one_indexed_epoch
