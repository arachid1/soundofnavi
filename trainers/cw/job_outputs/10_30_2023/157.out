Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train157
Description:  effnet: kfold, mel, no normalizing, 1 optimizer w adaptive lr, overlap threshold = 0.3,
-----------------------
Job id is 1.
Job dir: ../cache/cw/train157/1
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
Job id is 2.
-----------------------
--- Final training dataset went from 0 to 4349 elements, with 1920 none's, 1272 crakles, 648 wheezes and 509 both ---
--- Final Validation dataset contains 1716 elements, with 958 none, 562 crackles, 69 wheezes and 127 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.5662760416666667, 1: 0.8547562893081762, 2: 1.677854938271605, 3: 2.1360510805500983}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_1[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d (G  (None, 2048)             0         
 lobalAveragePooling2D)                                          
                                                                 
 dense (Dense)               (None, 100)               204900    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 50)                5050      
                                                                 
 dropout_1 (Dropout)         (None, 50)                0         
                                                                 
 dense_2 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks (MelFilterbanks)                multiple                                    0                
                                                                                                              
 mel_filterbanks_1 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[218 728   0  12]
 [108 438   1  15]
 [ 14  52   0   3]
 [ 14 111   0   2]]
Validation normalized_cm: [[0.228 0.76  0.    0.013]
 [0.192 0.779 0.002 0.027]
 [0.203 0.754 0.    0.043]
 [0.11  0.874 0.    0.016]]
Validation acc: 0.38344988344988346
Validation class_accuracies: [0.22755741127348644, 0.7793594306049823, 0.0, 0.015748031496062992]
Validation sensitivity: 0.5804749340369393
Validation specificity: 0.22755741127348644
Validation icbhi_score: 0.40401617265521284
Validation roc_auc: None
Validation avg_accuracy: 0.2556662183436329
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
136/136 - 139s - loss: 0.7426 - accuracy: 0.7048 - 139s/epoch - 1s/step
Epoch 2/80
Validation cm: [[289 512  52 105]
 [233 276  18  35]
 [ 30  25   7   7]
 [ 54  53   9  11]]
Validation normalized_cm: [[0.302 0.534 0.054 0.11 ]
 [0.415 0.491 0.032 0.062]
 [0.435 0.362 0.101 0.101]
 [0.425 0.417 0.071 0.087]]
Validation acc: 0.33974358974358976
Validation class_accuracies: [0.30167014613778703, 0.49110320284697506, 0.10144927536231885, 0.08661417322834646]
Validation sensitivity: 0.38786279683377306
Validation specificity: 0.30167014613778703
Validation icbhi_score: 0.34476647148578005
Validation roc_auc: None
Validation avg_accuracy: 0.24520919939385685
Validation one_indexed_epoch: 2
The validation tracker metric at 0.40401617265521284 hasn't increased by 0 in 1 epochs
There is no such attribute
136/136 - 133s - loss: 0.6905 - accuracy: 0.6036 - 133s/epoch - 976ms/step
Epoch 3/80
Validation cm: [[145 162 139 512]
 [128  71 102 261]
 [ 11   5  17  36]
 [ 16  18  18  75]]
Validation normalized_cm: [[0.151 0.169 0.145 0.534]
 [0.228 0.126 0.181 0.464]
 [0.159 0.072 0.246 0.522]
 [0.126 0.142 0.142 0.591]]
Validation acc: 0.1794871794871795
Validation class_accuracies: [0.151356993736952, 0.12633451957295375, 0.2463768115942029, 0.5905511811023622]
Validation sensitivity: 0.21503957783641162
Validation specificity: 0.151356993736952
Validation icbhi_score: 0.1831982857866818
Validation roc_auc: None
Validation avg_accuracy: 0.2786548765016177
Validation one_indexed_epoch: 3
The validation tracker metric at 0.40401617265521284 hasn't increased by 0 in 2 epochs
There is no such attribute
136/136 - 127s - loss: 0.6630 - accuracy: 0.6063 - 127s/epoch - 936ms/step
Epoch 4/80
Validation cm: [[194  47 504 213]
 [ 96  14 316 136]
 [  8   1  41  19]
 [ 24   2  68  33]]
Validation normalized_cm: [[0.203 0.049 0.526 0.222]
 [0.171 0.025 0.562 0.242]
 [0.116 0.014 0.594 0.275]
 [0.189 0.016 0.535 0.26 ]]
Validation acc: 0.16433566433566432
Validation class_accuracies: [0.20250521920668058, 0.02491103202846975, 0.5942028985507246, 0.25984251968503935]
Validation sensitivity: 0.11609498680738786
Validation specificity: 0.20250521920668058
Validation icbhi_score: 0.15930010300703423
Validation roc_auc: None
Validation avg_accuracy: 0.27036541736772857
Validation one_indexed_epoch: 4
The validation tracker metric at 0.40401617265521284 hasn't increased by 0 in 3 epochs
There is no such attribute
136/136 - 127s - loss: 0.6475 - accuracy: 0.6238 - 127s/epoch - 934ms/step
Epoch 5/80
Validation cm: [[179   8 623 148]
 [126  24 280 132]
 [  7   0  50  12]
 [  7   2  67  51]]
Validation normalized_cm: [[0.187 0.008 0.65  0.154]
 [0.224 0.043 0.498 0.235]
 [0.101 0.    0.725 0.174]
 [0.055 0.016 0.528 0.402]]
Validation acc: 0.17715617715617715
Validation class_accuracies: [0.18684759916492694, 0.042704626334519574, 0.7246376811594203, 0.4015748031496063]
Validation sensitivity: 0.16490765171503957
Validation specificity: 0.18684759916492694
Validation icbhi_score: 0.17587762543998325
Validation roc_auc: None
Validation avg_accuracy: 0.33894117745211827
Validation one_indexed_epoch: 5
The validation tracker metric at 0.40401617265521284 hasn't increased by 0 in 4 epochs
There is no such attribute
136/136 - 131s - loss: 0.6256 - accuracy: 0.6491 - 131s/epoch - 964ms/step
Epoch 6/80
Validation cm: [[343 272 215 128]
 [ 98 281  67 116]
 [ 14  13  26  16]
 [ 25  59  16  27]]
Validation normalized_cm: [[0.358 0.284 0.224 0.134]
 [0.174 0.5   0.119 0.206]
 [0.203 0.188 0.377 0.232]
 [0.197 0.465 0.126 0.213]]
Validation acc: 0.3945221445221445
Validation class_accuracies: [0.35803757828810023, 0.5, 0.37681159420289856, 0.2125984251968504]
Validation sensitivity: 0.44063324538258575
Validation specificity: 0.35803757828810023
Validation icbhi_score: 0.399335411835343
Validation roc_auc: None
Validation avg_accuracy: 0.36186189942196234
Validation one_indexed_epoch: 6
The validation tracker metric at 0.40401617265521284 hasn't increased by 0 in 5 epochs
There is no such attribute
136/136 - 123s - loss: 0.6092 - accuracy: 0.6298 - 123s/epoch - 904ms/step
Epoch 7/80
Validation cm: [[583 104 227  44]
 [322 130  67  43]
 [ 35   3  26   5]
 [ 51  18  33  25]]
Validation normalized_cm: [[0.609 0.109 0.237 0.046]
 [0.573 0.231 0.119 0.077]
 [0.507 0.043 0.377 0.072]
 [0.402 0.142 0.26  0.197]]
Validation acc: 0.44522144522144524
Validation class_accuracies: [0.6085594989561587, 0.2313167259786477, 0.37681159420289856, 0.1968503937007874]
Validation sensitivity: 0.23878627968337732
Validation specificity: 0.6085594989561587
Validation icbhi_score: 0.423672889319768
Validation roc_auc: None
Validation avg_accuracy: 0.35338455320962314
Validation one_indexed_epoch: 7
-- New best results were achieved. --
There is no such attribute
136/136 - 125s - loss: 0.5856 - accuracy: 0.6815 - 125s/epoch - 919ms/step
Epoch 8/80
Validation cm: [[813  88  51   6]
 [417 110  27   8]
 [ 56   2  10   1]
 [ 92  25   8   2]]
Validation normalized_cm: [[0.849 0.092 0.053 0.006]
 [0.742 0.196 0.048 0.014]
 [0.812 0.029 0.145 0.014]
 [0.724 0.197 0.063 0.016]]
Validation acc: 0.5448717948717948
Validation class_accuracies: [0.848643006263048, 0.19572953736654805, 0.14492753623188406, 0.015748031496062992]
Validation sensitivity: 0.16094986807387862
Validation specificity: 0.848643006263048
Validation icbhi_score: 0.5047964371684633
Validation roc_auc: None
Validation avg_accuracy: 0.30126202783938577
Validation one_indexed_epoch: 8
-- New best results were achieved. --
There is no such attribute
136/136 - 131s - loss: 0.5704 - accuracy: 0.6880 - 131s/epoch - 964ms/step
Epoch 9/80
Validation cm: [[640 117 108  93]
 [291 170  45  56]
 [ 31   6  19  13]
 [ 48  20  40  19]]
Validation normalized_cm: [[0.668 0.122 0.113 0.097]
 [0.518 0.302 0.08  0.1  ]
 [0.449 0.087 0.275 0.188]
 [0.378 0.157 0.315 0.15 ]]
Validation acc: 0.49417249417249415
Validation class_accuracies: [0.6680584551148225, 0.302491103202847, 0.2753623188405797, 0.14960629921259844]
Validation sensitivity: 0.27440633245382584
Validation specificity: 0.6680584551148225
Validation icbhi_score: 0.4712323937843242
Validation roc_auc: None
Validation avg_accuracy: 0.3488795440927119
Validation one_indexed_epoch: 9
The validation tracker metric at 0.5047964371684633 hasn't increased by 0 in 1 epochs
There is no such attribute
136/136 - 133s - loss: 0.5540 - accuracy: 0.7225 - 133s/epoch - 979ms/step
Epoch 10/80
Validation cm: [[573  29 302  54]
 [341  48 124  49]
 [ 27   1  36   5]
 [ 43   1  73  10]]
Validation normalized_cm: [[0.598 0.03  0.315 0.056]
 [0.607 0.085 0.221 0.087]
 [0.391 0.014 0.522 0.072]
 [0.339 0.008 0.575 0.079]]
Validation acc: 0.3886946386946387
Validation class_accuracies: [0.5981210855949896, 0.08540925266903915, 0.5217391304347826, 0.07874015748031496]
Validation sensitivity: 0.12401055408970976
Validation specificity: 0.5981210855949896
Validation icbhi_score: 0.36106581984234964
Validation roc_auc: None
Validation avg_accuracy: 0.32100240654478157
Validation one_indexed_epoch: 10
The validation tracker metric at 0.5047964371684633 hasn't increased by 0 in 2 epochs
There is no such attribute
136/136 - 132s - loss: 0.5403 - accuracy: 0.7215 - 132s/epoch - 971ms/step
Epoch 11/80
Validation cm: [[651 103 115  89]
 [333 151  39  39]
 [ 26   6  24  13]
 [ 56  34  21  16]]
Validation normalized_cm: [[0.68  0.108 0.12  0.093]
 [0.593 0.269 0.069 0.069]
 [0.377 0.087 0.348 0.188]
 [0.441 0.268 0.165 0.126]]
Validation acc: 0.49067599067599066
Validation class_accuracies: [0.6795407098121086, 0.26868327402135234, 0.34782608695652173, 0.12598425196850394]
Validation sensitivity: 0.2519788918205805
Validation specificity: 0.6795407098121086
Validation icbhi_score: 0.4657598008163445
Validation roc_auc: None
Validation avg_accuracy: 0.35550858068962166
Validation one_indexed_epoch: 11
The validation tracker metric at 0.5047964371684633 hasn't increased by 0 in 3 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
136/136 - 132s - loss: 0.5302 - accuracy: 0.7452 - 132s/epoch - 969ms/step
Epoch 12/80
Validation cm: [[712 153  57  36]
 [362 160  21  19]
 [ 45   9  11   4]
 [ 76  45   4   2]]
Validation normalized_cm: [[0.743 0.16  0.059 0.038]
 [0.644 0.285 0.037 0.034]
 [0.652 0.13  0.159 0.058]
 [0.598 0.354 0.031 0.016]]
Validation acc: 0.5157342657342657
Validation class_accuracies: [0.7432150313152401, 0.2846975088967972, 0.15942028985507245, 0.015748031496062992]
Validation sensitivity: 0.22823218997361477
Validation specificity: 0.7432150313152401
Validation icbhi_score: 0.4857236106444275
Validation roc_auc: None
Validation avg_accuracy: 0.3007702153907932
Validation one_indexed_epoch: 12
The validation tracker metric at 0.5047964371684633 hasn't increased by 0 in 4 epochs
There is no such attribute
136/136 - 132s - loss: 0.5172 - accuracy: 0.7365 - 132s/epoch - 974ms/step
Epoch 13/80
Validation cm: [[512 239 103 104]
 [169 302  33  58]
 [ 28  10  19  12]
 [ 38  39  20  30]]
Validation normalized_cm: [[0.534 0.249 0.108 0.109]
 [0.301 0.537 0.059 0.103]
 [0.406 0.145 0.275 0.174]
 [0.299 0.307 0.157 0.236]]
Validation acc: 0.502913752913753
Validation class_accuracies: [0.534446764091858, 0.5373665480427047, 0.2753623188405797, 0.23622047244094488]
Validation sensitivity: 0.4630606860158311
Validation specificity: 0.534446764091858
Validation icbhi_score: 0.4987537250538445
Validation roc_auc: None
Validation avg_accuracy: 0.3958490258540218
Validation one_indexed_epoch: 13
The validation tracker metric at 0.5047964371684633 hasn't increased by 0 in 5 epochs
There is no such attribute
136/136 - 133s - loss: 0.4959 - accuracy: 0.7519 - 133s/epoch - 979ms/step
Epoch 14/80
Validation cm: [[630 187  75  66]
 [230 258  19  55]
 [ 33   8  20   8]
 [ 54  30  21  22]]
Validation normalized_cm: [[0.658 0.195 0.078 0.069]
 [0.409 0.459 0.034 0.098]
 [0.478 0.116 0.29  0.116]
 [0.425 0.236 0.165 0.173]]
Validation acc: 0.541958041958042
Validation class_accuracies: [0.6576200417536534, 0.45907473309608543, 0.2898550724637681, 0.1732283464566929]
Validation sensitivity: 0.39577836411609496
Validation specificity: 0.6576200417536534
Validation icbhi_score: 0.5266992029348742
Validation roc_auc: None
Validation avg_accuracy: 0.39494454844254995
Validation one_indexed_epoch: 14
-- New best results were achieved. --
There is no such attribute
136/136 - 133s - loss: 0.4884 - accuracy: 0.7701 - 133s/epoch - 975ms/step
Epoch 15/80
Validation cm: [[575 181 103  99]
 [257 215  26  64]
 [ 27   7  21  14]
 [ 45  31  19  32]]
Validation normalized_cm: [[0.6   0.189 0.108 0.103]
 [0.457 0.383 0.046 0.114]
 [0.391 0.101 0.304 0.203]
 [0.354 0.244 0.15  0.252]]
Validation acc: 0.49125874125874125
Validation class_accuracies: [0.6002087682672234, 0.38256227758007116, 0.30434782608695654, 0.25196850393700787]
Validation sensitivity: 0.35356200527704484
Validation specificity: 0.6002087682672234
Validation icbhi_score: 0.4768853867721341
Validation roc_auc: None
Validation avg_accuracy: 0.3847718439678147
Validation one_indexed_epoch: 15
The validation tracker metric at 0.5266992029348742 hasn't increased by 0 in 1 epochs
There is no such attribute
136/136 - 131s - loss: 0.4773 - accuracy: 0.7671 - 131s/epoch - 964ms/step
Epoch 16/80
Validation cm: [[545 121 139 153]
 [219 186  59  98]
 [ 18   7  23  21]
 [ 37  16  25  49]]
Validation normalized_cm: [[0.569 0.126 0.145 0.16 ]
 [0.39  0.331 0.105 0.174]
 [0.261 0.101 0.333 0.304]
 [0.291 0.126 0.197 0.386]]
Validation acc: 0.46794871794871795
Validation class_accuracies: [0.5688935281837161, 0.3309608540925267, 0.3333333333333333, 0.3858267716535433]
Validation sensitivity: 0.3403693931398417
Validation specificity: 0.5688935281837161
Validation icbhi_score: 0.4546314606617789
Validation roc_auc: None
Validation avg_accuracy: 0.40475362181577984
Validation one_indexed_epoch: 16
The validation tracker metric at 0.5266992029348742 hasn't increased by 0 in 2 epochs
There is no such attribute
136/136 - 130s - loss: 0.4612 - accuracy: 0.7703 - 130s/epoch - 956ms/step
Epoch 17/80
Validation cm: [[700  98  90  70]
 [351 147  28  36]
 [ 35   4  22   8]
 [ 67  15  28  17]]
Validation normalized_cm: [[0.731 0.102 0.094 0.073]
 [0.625 0.262 0.05  0.064]
 [0.507 0.058 0.319 0.116]
 [0.528 0.118 0.22  0.134]]
Validation acc: 0.5163170163170163
Validation class_accuracies: [0.7306889352818372, 0.2615658362989324, 0.3188405797101449, 0.13385826771653545]
Validation sensitivity: 0.24538258575197888
Validation specificity: 0.7306889352818372
Validation icbhi_score: 0.48803576051690806
Validation roc_auc: None
Validation avg_accuracy: 0.3612384047518625
Validation one_indexed_epoch: 17
The validation tracker metric at 0.5266992029348742 hasn't increased by 0 in 3 epochs
There is no such attribute
136/136 - 133s - loss: 0.4503 - accuracy: 0.7749 - 133s/epoch - 975ms/step
Epoch 18/80
Validation cm: [[510 192 102 154]
 [160 268  38  96]
 [ 21   7  19  22]
 [ 36  23  28  40]]
Validation normalized_cm: [[0.532 0.2   0.106 0.161]
 [0.285 0.477 0.068 0.171]
 [0.304 0.101 0.275 0.319]
 [0.283 0.181 0.22  0.315]]
Validation acc: 0.48776223776223776
Validation class_accuracies: [0.5323590814196242, 0.47686832740213525, 0.2753623188405797, 0.31496062992125984]
Validation sensitivity: 0.4313984168865435
Validation specificity: 0.5323590814196242
Validation icbhi_score: 0.4818787491530838
Validation roc_auc: None
Validation avg_accuracy: 0.39988758939589975
Validation one_indexed_epoch: 18
The validation tracker metric at 0.5266992029348742 hasn't increased by 0 in 4 epochs
There is no such attribute
136/136 - 132s - loss: 0.4290 - accuracy: 0.7855 - 132s/epoch - 973ms/step
Epoch 19/80
Validation cm: [[644  89 146  79]
 [332 104  61  65]
 [ 33   8  20   8]
 [ 54  23  23  27]]
Validation normalized_cm: [[0.672 0.093 0.152 0.082]
 [0.591 0.185 0.109 0.116]
 [0.478 0.116 0.29  0.116]
 [0.425 0.181 0.181 0.213]]
Validation acc: 0.4632867132867133
Validation class_accuracies: [0.6722338204592901, 0.18505338078291814, 0.2898550724637681, 0.2125984251968504]
Validation sensitivity: 0.19920844327176782
Validation specificity: 0.6722338204592901
Validation icbhi_score: 0.43572113186552897
Validation roc_auc: None
Validation avg_accuracy: 0.3399351747257067
Validation one_indexed_epoch: 19
The validation tracker metric at 0.5266992029348742 hasn't increased by 0 in 5 epochs
There is no such attribute
136/136 - 134s - loss: 0.4150 - accuracy: 0.7882 - 134s/epoch - 987ms/step
Epoch 20/80
Validation cm: [[750 164  29  15]
 [358 182  10  12]
 [ 46   8  13   2]
 [ 75  42   7   3]]
Validation normalized_cm: [[0.783 0.171 0.03  0.016]
 [0.637 0.324 0.018 0.021]
 [0.667 0.116 0.188 0.029]
 [0.591 0.331 0.055 0.024]]
Validation acc: 0.5524475524475524
Validation class_accuracies: [0.7828810020876826, 0.3238434163701068, 0.18840579710144928, 0.023622047244094488]
Validation sensitivity: 0.2612137203166227
Validation specificity: 0.7828810020876826
Validation icbhi_score: 0.5220473612021527
Validation roc_auc: None
Validation avg_accuracy: 0.32968806570083325
Validation one_indexed_epoch: 20
The validation tracker metric at 0.5266992029348742 hasn't increased by 0 in 6 epochs
There is no such attribute
136/136 - 130s - loss: 0.4008 - accuracy: 0.7905 - 130s/epoch - 954ms/step
Epoch 21/80
Validation cm: [[671 195  40  52]
 [248 273  14  27]
 [ 35  14  13   7]
 [ 58  38   9  22]]
Validation normalized_cm: [[0.7   0.204 0.042 0.054]
 [0.441 0.486 0.025 0.048]
 [0.507 0.203 0.188 0.101]
 [0.457 0.299 0.071 0.173]]
Validation acc: 0.5705128205128205
Validation class_accuracies: [0.7004175365344467, 0.48576512455516013, 0.18840579710144928, 0.1732283464566929]
Validation sensitivity: 0.40633245382585753
Validation specificity: 0.7004175365344467
Validation icbhi_score: 0.5533749951801521
Validation roc_auc: None
Validation avg_accuracy: 0.38695420116193724
Validation one_indexed_epoch: 21
-- New best results were achieved. --
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
136/136 - 132s - loss: 0.3996 - accuracy: 0.7873 - 132s/epoch - 973ms/step
Epoch 22/80
Validation cm: [[479 111 218 150]
 [214 164  79 105]
 [ 25   0  24  20]
 [ 30   9  44  44]]
Validation normalized_cm: [[0.5   0.116 0.228 0.157]
 [0.381 0.292 0.141 0.187]
 [0.362 0.    0.348 0.29 ]
 [0.236 0.071 0.346 0.346]]
Validation acc: 0.4143356643356643
Validation class_accuracies: [0.5, 0.2918149466192171, 0.34782608695652173, 0.3464566929133858]
Validation sensitivity: 0.30606860158311344
Validation specificity: 0.5
Validation icbhi_score: 0.4030343007915567
Validation roc_auc: None
Validation avg_accuracy: 0.37152443162228116
Validation one_indexed_epoch: 22
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 1 epochs
There is no such attribute
136/136 - 133s - loss: 0.3795 - accuracy: 0.7963 - 133s/epoch - 979ms/step
Epoch 23/80
Validation cm: [[406 205  94 253]
 [138 237  37 150]
 [ 14   6  19  30]
 [ 18  23  24  62]]
Validation normalized_cm: [[0.424 0.214 0.098 0.264]
 [0.246 0.422 0.066 0.267]
 [0.203 0.087 0.275 0.435]
 [0.142 0.181 0.189 0.488]]
Validation acc: 0.4219114219114219
Validation class_accuracies: [0.42379958246346555, 0.42170818505338076, 0.2753623188405797, 0.4881889763779528]
Validation sensitivity: 0.41952506596306066
Validation specificity: 0.42379958246346555
Validation icbhi_score: 0.4216623242132631
Validation roc_auc: None
Validation avg_accuracy: 0.4022647656838447
Validation one_indexed_epoch: 23
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 2 epochs
There is no such attribute
136/136 - 133s - loss: 0.3643 - accuracy: 0.8108 - 133s/epoch - 979ms/step
Epoch 24/80
Validation cm: [[584 255  44  75]
 [218 316  10  18]
 [ 26  13  14  16]
 [ 34  49  20  24]]
Validation normalized_cm: [[0.61  0.266 0.046 0.078]
 [0.388 0.562 0.018 0.032]
 [0.377 0.188 0.203 0.232]
 [0.268 0.386 0.157 0.189]]
Validation acc: 0.5466200466200466
Validation class_accuracies: [0.6096033402922756, 0.5622775800711743, 0.2028985507246377, 0.1889763779527559]
Validation sensitivity: 0.46701846965699206
Validation specificity: 0.6096033402922756
Validation icbhi_score: 0.5383109049746339
Validation roc_auc: None
Validation avg_accuracy: 0.39093896226021085
Validation one_indexed_epoch: 24
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 3 epochs
There is no such attribute
136/136 - 133s - loss: 0.3481 - accuracy: 0.8119 - 133s/epoch - 980ms/step
Epoch 25/80
Validation cm: [[725 132  45  56]
 [335 185  11  31]
 [ 38   8  15   8]
 [ 59  39  17  12]]
Validation normalized_cm: [[0.757 0.138 0.047 0.058]
 [0.596 0.329 0.02  0.055]
 [0.551 0.116 0.217 0.116]
 [0.465 0.307 0.134 0.094]]
Validation acc: 0.546037296037296
Validation class_accuracies: [0.7567849686847599, 0.3291814946619217, 0.21739130434782608, 0.09448818897637795]
Validation sensitivity: 0.2796833773087071
Validation specificity: 0.7567849686847599
Validation icbhi_score: 0.5182341729967335
Validation roc_auc: None
Validation avg_accuracy: 0.3494614891677214
Validation one_indexed_epoch: 25
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 4 epochs
There is no such attribute
136/136 - 132s - loss: 0.3370 - accuracy: 0.8156 - 132s/epoch - 972ms/step
Epoch 26/80
Validation cm: [[544 121 180 113]
 [252 182  49  79]
 [ 18   3  31  17]
 [ 34  25  33  35]]
Validation normalized_cm: [[0.568 0.126 0.188 0.118]
 [0.448 0.324 0.087 0.141]
 [0.261 0.043 0.449 0.246]
 [0.268 0.197 0.26  0.276]]
Validation acc: 0.46153846153846156
Validation class_accuracies: [0.5678496868475992, 0.3238434163701068, 0.4492753623188406, 0.2755905511811024]
Validation sensitivity: 0.32717678100263853
Validation specificity: 0.5678496868475992
Validation icbhi_score: 0.4475132339251189
Validation roc_auc: None
Validation avg_accuracy: 0.4041397541794122
Validation one_indexed_epoch: 26
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 5 epochs
There is no such attribute
136/136 - 133s - loss: 0.3157 - accuracy: 0.8105 - 133s/epoch - 980ms/step
Epoch 27/80
Validation cm: [[467 206  76 209]
 [188 251  31  92]
 [ 23   7  17  22]
 [ 27  20  28  52]]
Validation normalized_cm: [[0.487 0.215 0.079 0.218]
 [0.335 0.447 0.055 0.164]
 [0.333 0.101 0.246 0.319]
 [0.213 0.157 0.22  0.409]]
Validation acc: 0.4586247086247086
Validation class_accuracies: [0.48747390396659707, 0.44661921708185054, 0.2463768115942029, 0.4094488188976378]
Validation sensitivity: 0.42216358839050133
Validation specificity: 0.48747390396659707
Validation icbhi_score: 0.4548187461785492
Validation roc_auc: None
Validation avg_accuracy: 0.39747968788507204
Validation one_indexed_epoch: 27
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 6 epochs
There is no such attribute
136/136 - 135s - loss: 0.3141 - accuracy: 0.8246 - 135s/epoch - 990ms/step
Epoch 28/80
Validation cm: [[666 177  46  69]
 [297 210  22  33]
 [ 33  13  15   8]
 [ 43  54  14  16]]
Validation normalized_cm: [[0.695 0.185 0.048 0.072]
 [0.528 0.374 0.039 0.059]
 [0.478 0.188 0.217 0.116]
 [0.339 0.425 0.11  0.126]]
Validation acc: 0.5285547785547785
Validation class_accuracies: [0.6951983298538622, 0.3736654804270463, 0.21739130434782608, 0.12598425196850394]
Validation sensitivity: 0.3179419525065963
Validation specificity: 0.6951983298538622
Validation icbhi_score: 0.5065701411802292
Validation roc_auc: None
Validation avg_accuracy: 0.35305984164930965
Validation one_indexed_epoch: 28
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 7 epochs
There is no such attribute
136/136 - 132s - loss: 0.2899 - accuracy: 0.8211 - 132s/epoch - 972ms/step
Epoch 29/80
Validation cm: [[661 238  30  29]
 [245 283  17  17]
 [ 39  16  13   1]
 [ 58  55   9   5]]
Validation normalized_cm: [[0.69  0.248 0.031 0.03 ]
 [0.436 0.504 0.03  0.03 ]
 [0.565 0.232 0.188 0.014]
 [0.457 0.433 0.071 0.039]]
Validation acc: 0.5606060606060606
Validation class_accuracies: [0.6899791231732777, 0.50355871886121, 0.18840579710144928, 0.03937007874015748]
Validation sensitivity: 0.3970976253298153
Validation specificity: 0.6899791231732777
Validation icbhi_score: 0.5435383742515465
Validation roc_auc: None
Validation avg_accuracy: 0.35532842946902354
Validation one_indexed_epoch: 29
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 8 epochs
There is no such attribute
136/136 - 133s - loss: 0.2832 - accuracy: 0.8206 - 133s/epoch - 981ms/step
Epoch 30/80
Validation cm: [[417 250 102 189]
 [138 298  34  92]
 [ 11   9  22  27]
 [ 20  29  22  56]]
Validation normalized_cm: [[0.435 0.261 0.106 0.197]
 [0.246 0.53  0.06  0.164]
 [0.159 0.13  0.319 0.391]
 [0.157 0.228 0.173 0.441]]
Validation acc: 0.4621212121212121
Validation class_accuracies: [0.4352818371607516, 0.5302491103202847, 0.3188405797101449, 0.4409448818897638]
Validation sensitivity: 0.49604221635883905
Validation specificity: 0.4352818371607516
Validation icbhi_score: 0.4656620267597953
Validation roc_auc: None
Validation avg_accuracy: 0.43132910227023624
Validation one_indexed_epoch: 30
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 9 epochs
There is no such attribute
136/136 - 132s - loss: 0.2661 - accuracy: 0.8370 - 132s/epoch - 974ms/step
Epoch 31/80
Validation cm: [[480 299  60 119]
 [164 335  13  50]
 [ 17  18  15  19]
 [ 25  50  18  34]]
Validation normalized_cm: [[0.501 0.312 0.063 0.124]
 [0.292 0.596 0.023 0.089]
 [0.246 0.261 0.217 0.275]
 [0.197 0.394 0.142 0.268]]
Validation acc: 0.5034965034965035
Validation class_accuracies: [0.5010438413361169, 0.5960854092526691, 0.21739130434782608, 0.2677165354330709]
Validation sensitivity: 0.5065963060686016
Validation specificity: 0.5010438413361169
Validation icbhi_score: 0.5038200737023593
Validation roc_auc: None
Validation avg_accuracy: 0.39555927259242074
Validation one_indexed_epoch: 31
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 10 epochs
Mel loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
sinc loss: <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.5>
There is no such attribute
136/136 - 133s - loss: 0.2580 - accuracy: 0.8381 - 133s/epoch - 978ms/step
Epoch 32/80
Validation cm: [[709 174  56  19]
 [321 200  27  14]
 [ 41   8  19   1]
 [ 63  32  26   6]]
Validation normalized_cm: [[0.74  0.182 0.058 0.02 ]
 [0.571 0.356 0.048 0.025]
 [0.594 0.116 0.275 0.014]
 [0.496 0.252 0.205 0.047]]
Validation acc: 0.5442890442890443
Validation class_accuracies: [0.7400835073068893, 0.35587188612099646, 0.2753623188405797, 0.047244094488188976]
Validation sensitivity: 0.29683377308707126
Validation specificity: 0.7400835073068893
Validation icbhi_score: 0.5184586401969803
Validation roc_auc: None
Validation avg_accuracy: 0.3546404516891636
Validation one_indexed_epoch: 32
The validation tracker metric at 0.5533749951801521 hasn't increased by 0 in 11 epochs
There is no such attribute
136/136 - 132s - loss: 0.2455 - accuracy: 0.8427 - 132s/epoch - 970ms/step
Epoch 33/80
Validation cm: [[734 163  44  17]
 [296 238  15  13]
 [ 43   6  14   6]
 [ 58  37  22  10]]
Validation normalized_cm: [[0.766 0.17  0.046 0.018]
 [0.527 0.423 0.027 0.023]
 [0.623 0.087 0.203 0.087]
 [0.457 0.291 0.173 0.079]]
Validation acc: 0.5804195804195804
Validation class_accuracies: [0.7661795407098121, 0.4234875444839858, 0.2028985507246377, 0.07874015748031496]
Validation sensitivity: 0.34564643799472294
Validation specificity: 0.7661795407098121
Validation icbhi_score: 0.5559129893522675
Validation roc_auc: None
Validation avg_accuracy: 0.36782644834968764
Validation one_indexed_epoch: 33
-- New best results were achieved. --
There is no such attribute
136/136 - 129s - loss: 0.2306 - accuracy: 0.8416 - 129s/epoch - 951ms/step
Epoch 34/80
Validation cm: [[792 104  45  17]
 [342 195  18   7]
 [ 46   6  15   2]
 [ 75  25  19   8]]
Validation normalized_cm: [[0.827 0.109 0.047 0.018]
 [0.609 0.347 0.032 0.012]
 [0.667 0.087 0.217 0.029]
 [0.591 0.197 0.15  0.063]]
Validation acc: 0.5885780885780886
Validation class_accuracies: [0.826722338204593, 0.3469750889679715, 0.21739130434782608, 0.06299212598425197]
Validation sensitivity: 0.287598944591029
Validation specificity: 0.826722338204593
Validation icbhi_score: 0.557160641397811
Validation roc_auc: None
Validation avg_accuracy: 0.36352021437616067
Validation one_indexed_epoch: 34
-- New best results were achieved. --
There is no such attribute
136/136 - 133s - loss: 0.2196 - accuracy: 0.8476 - 133s/epoch - 978ms/step
Epoch 35/80
Validation cm: [[515 352  36  55]
 [158 367  11  26]
 [ 23  21  15  10]
 [ 28  54  16  29]]
Validation normalized_cm: [[0.538 0.367 0.038 0.057]
 [0.281 0.653 0.02  0.046]
 [0.333 0.304 0.217 0.145]
 [0.22  0.425 0.126 0.228]]
Validation acc: 0.5396270396270396
Validation class_accuracies: [0.5375782881002088, 0.6530249110320284, 0.21739130434782608, 0.2283464566929134]
Validation sensitivity: 0.5422163588390502
Validation specificity: 0.5375782881002088
Validation icbhi_score: 0.5398973234696295
Validation roc_auc: None
Validation avg_accuracy: 0.4090852400432442
Validation one_indexed_epoch: 35
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 1 epochs
There is no such attribute
136/136 - 135s - loss: 0.2097 - accuracy: 0.8476 - 135s/epoch - 994ms/step
Epoch 36/80
Validation cm: [[514 106 202 136]
 [240 167  82  73]
 [ 19   1  29  20]
 [ 32  10  52  33]]
Validation normalized_cm: [[0.537 0.111 0.211 0.142]
 [0.427 0.297 0.146 0.13 ]
 [0.275 0.014 0.42  0.29 ]
 [0.252 0.079 0.409 0.26 ]]
Validation acc: 0.432983682983683
Validation class_accuracies: [0.5365344467640919, 0.297153024911032, 0.42028985507246375, 0.25984251968503935]
Validation sensitivity: 0.3021108179419525
Validation specificity: 0.5365344467640919
Validation icbhi_score: 0.4193226323530222
Validation roc_auc: None
Validation avg_accuracy: 0.3784549616081567
Validation one_indexed_epoch: 36
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 2 epochs
There is no such attribute
136/136 - 134s - loss: 0.1984 - accuracy: 0.8489 - 134s/epoch - 987ms/step
Epoch 37/80
Validation cm: [[718  94 111  35]
 [356 142  47  17]
 [ 38   2  25   4]
 [ 61  13  42  11]]
Validation normalized_cm: [[0.749 0.098 0.116 0.037]
 [0.633 0.253 0.084 0.03 ]
 [0.551 0.029 0.362 0.058]
 [0.48  0.102 0.331 0.087]]
Validation acc: 0.5221445221445221
Validation class_accuracies: [0.7494780793319415, 0.2526690391459075, 0.36231884057971014, 0.08661417322834646]
Validation sensitivity: 0.23482849604221637
Validation specificity: 0.7494780793319415
Validation icbhi_score: 0.49215328768707894
Validation roc_auc: None
Validation avg_accuracy: 0.3627700330714764
Validation one_indexed_epoch: 37
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 3 epochs
There is no such attribute
136/136 - 133s - loss: 0.1885 - accuracy: 0.8505 - 133s/epoch - 979ms/step
Epoch 38/80
Validation cm: [[664 198  44  52]
 [277 238  21  26]
 [ 40   9  15   5]
 [ 49  44  26   8]]
Validation normalized_cm: [[0.693 0.207 0.046 0.054]
 [0.493 0.423 0.037 0.046]
 [0.58  0.13  0.217 0.072]
 [0.386 0.346 0.205 0.063]]
Validation acc: 0.539044289044289
Validation class_accuracies: [0.6931106471816284, 0.4234875444839858, 0.21739130434782608, 0.06299212598425197]
Validation sensitivity: 0.34432717678100266
Validation specificity: 0.6931106471816284
Validation icbhi_score: 0.5187189119813156
Validation roc_auc: None
Validation avg_accuracy: 0.34924540549942307
Validation one_indexed_epoch: 38
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 4 epochs
There is no such attribute
136/136 - 135s - loss: 0.1750 - accuracy: 0.8584 - 135s/epoch - 989ms/step
Epoch 39/80
Validation cm: [[551 348  22  37]
 [167 374   7  14]
 [ 25  22  12  10]
 [ 33  68  13  13]]
Validation normalized_cm: [[0.575 0.363 0.023 0.039]
 [0.297 0.665 0.012 0.025]
 [0.362 0.319 0.174 0.145]
 [0.26  0.535 0.102 0.102]]
Validation acc: 0.5536130536130536
Validation class_accuracies: [0.5751565762004175, 0.6654804270462633, 0.17391304347826086, 0.10236220472440945]
Validation sensitivity: 0.5263852242744064
Validation specificity: 0.5751565762004175
Validation icbhi_score: 0.5507709002374119
Validation roc_auc: None
Validation avg_accuracy: 0.37922806286233773
Validation one_indexed_epoch: 39
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 5 epochs
There is no such attribute
136/136 - 134s - loss: 0.1716 - accuracy: 0.8572 - 134s/epoch - 984ms/step
Epoch 40/80
Validation cm: [[786 109  41  22]
 [406 126  14  16]
 [ 50   5  12   2]
 [ 83  20  23   1]]
Validation normalized_cm: [[0.82  0.114 0.043 0.023]
 [0.722 0.224 0.025 0.028]
 [0.725 0.072 0.174 0.029]
 [0.654 0.157 0.181 0.008]]
Validation acc: 0.539044289044289
Validation class_accuracies: [0.8204592901878914, 0.22419928825622776, 0.17391304347826086, 0.007874015748031496]
Validation sensitivity: 0.18337730870712401
Validation specificity: 0.8204592901878914
Validation icbhi_score: 0.5019182994475078
Validation roc_auc: None
Validation avg_accuracy: 0.3066114094176029
Validation one_indexed_epoch: 40
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 6 epochs
There is no such attribute
136/136 - 134s - loss: 0.1684 - accuracy: 0.8590 - 134s/epoch - 982ms/step
Epoch 41/80
Validation cm: [[579 176 101 102]
 [274 212  28  48]
 [ 30   5  21  13]
 [ 37  23  38  29]]
Validation normalized_cm: [[0.604 0.184 0.105 0.106]
 [0.488 0.377 0.05  0.085]
 [0.435 0.072 0.304 0.188]
 [0.291 0.181 0.299 0.228]]
Validation acc: 0.49009324009324007
Validation class_accuracies: [0.6043841336116911, 0.37722419928825623, 0.30434782608695654, 0.2283464566929134]
Validation sensitivity: 0.34564643799472294
Validation specificity: 0.6043841336116911
Validation icbhi_score: 0.475015285803207
Validation roc_auc: None
Validation avg_accuracy: 0.3785756539199543
Validation one_indexed_epoch: 41
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 7 epochs
There is no such attribute
136/136 - 131s - loss: 0.1564 - accuracy: 0.8618 - 131s/epoch - 965ms/step
Epoch 42/80
Validation cm: [[630 242  50  36]
 [208 320  19  15]
 [ 40  11  14   4]
 [ 40  62  21   4]]
Validation normalized_cm: [[0.658 0.253 0.052 0.038]
 [0.37  0.569 0.034 0.027]
 [0.58  0.159 0.203 0.058]
 [0.315 0.488 0.165 0.031]]
Validation acc: 0.5641025641025641
Validation class_accuracies: [0.6576200417536534, 0.5693950177935944, 0.2028985507246377, 0.031496062992125984]
Validation sensitivity: 0.44591029023746703
Validation specificity: 0.6576200417536534
Validation icbhi_score: 0.5517651659955602
Validation roc_auc: None
Validation avg_accuracy: 0.36535241831600285
Validation one_indexed_epoch: 42
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 8 epochs
There is no such attribute
136/136 - 134s - loss: 0.1494 - accuracy: 0.8676 - 134s/epoch - 985ms/step
Epoch 43/80
Validation cm: [[410 265 125 158]
 [178 265  39  80]
 [ 14   5  24  26]
 [ 16  31  30  50]]
Validation normalized_cm: [[0.428 0.277 0.13  0.165]
 [0.317 0.472 0.069 0.142]
 [0.203 0.072 0.348 0.377]
 [0.126 0.244 0.236 0.394]]
Validation acc: 0.4364801864801865
Validation class_accuracies: [0.4279749478079332, 0.47153024911032027, 0.34782608695652173, 0.3937007874015748]
Validation sensitivity: 0.4472295514511873
Validation specificity: 0.4279749478079332
Validation icbhi_score: 0.4376022496295603
Validation roc_auc: None
Validation avg_accuracy: 0.4102580178190875
Validation one_indexed_epoch: 43
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 9 epochs
There is no such attribute
136/136 - 133s - loss: 0.1422 - accuracy: 0.8666 - 133s/epoch - 980ms/step
Epoch 44/80
Validation cm: [[798 125  30   5]
 [360 185  12   5]
 [ 48   6  13   2]
 [ 72  39  14   2]]
Validation normalized_cm: [[0.833 0.13  0.031 0.005]
 [0.641 0.329 0.021 0.009]
 [0.696 0.087 0.188 0.029]
 [0.567 0.307 0.11  0.016]]
Validation acc: 0.5815850815850816
Validation class_accuracies: [0.8329853862212944, 0.3291814946619217, 0.18840579710144928, 0.015748031496062992]
Validation sensitivity: 0.2638522427440633
Validation specificity: 0.8329853862212944
Validation icbhi_score: 0.5484188144826788
Validation roc_auc: None
Validation avg_accuracy: 0.3415801773701821
Validation one_indexed_epoch: 44
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 10 epochs
There is no such attribute
136/136 - 132s - loss: 0.1332 - accuracy: 0.8570 - 132s/epoch - 970ms/step
Epoch 45/80
Validation cm: [[439 283  69 167]
 [178 286  31  67]
 [ 15  12  19  23]
 [ 28  34  20  45]]
Validation normalized_cm: [[0.458 0.295 0.072 0.174]
 [0.317 0.509 0.055 0.119]
 [0.217 0.174 0.275 0.333]
 [0.22  0.268 0.157 0.354]]
Validation acc: 0.4597902097902098
Validation class_accuracies: [0.4582463465553236, 0.5088967971530249, 0.2753623188405797, 0.3543307086614173]
Validation sensitivity: 0.46174142480211083
Validation specificity: 0.4582463465553236
Validation icbhi_score: 0.45999388567871724
Validation roc_auc: None
Validation avg_accuracy: 0.3992090428025864
Validation one_indexed_epoch: 45
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 11 epochs
There is no such attribute
136/136 - 136s - loss: 0.1241 - accuracy: 0.8595 - 136s/epoch - 1s/step
Epoch 46/80
Validation cm: [[510 306  60  82]
 [220 298  16  28]
 [ 27  10  18  14]
 [ 24  59  18  26]]
Validation normalized_cm: [[0.532 0.319 0.063 0.086]
 [0.391 0.53  0.028 0.05 ]
 [0.391 0.145 0.261 0.203]
 [0.189 0.465 0.142 0.205]]
Validation acc: 0.4965034965034965
Validation class_accuracies: [0.5323590814196242, 0.5302491103202847, 0.2608695652173913, 0.2047244094488189]
Validation sensitivity: 0.45118733509234826
Validation specificity: 0.5323590814196242
Validation icbhi_score: 0.49177320825598625
Validation roc_auc: None
Validation avg_accuracy: 0.3820505416015298
Validation one_indexed_epoch: 46
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 12 epochs
There is no such attribute
136/136 - 132s - loss: 0.1226 - accuracy: 0.8590 - 132s/epoch - 970ms/step
Epoch 47/80
Validation cm: [[583 294  25  56]
 [228 314   6  14]
 [ 29  21  15   4]
 [ 40  61  13  13]]
Validation normalized_cm: [[0.609 0.307 0.026 0.058]
 [0.406 0.559 0.011 0.025]
 [0.42  0.304 0.217 0.058]
 [0.315 0.48  0.102 0.102]]
Validation acc: 0.539044289044289
Validation class_accuracies: [0.6085594989561587, 0.5587188612099644, 0.21739130434782608, 0.10236220472440945]
Validation sensitivity: 0.45118733509234826
Validation specificity: 0.6085594989561587
Validation icbhi_score: 0.5298734170242535
Validation roc_auc: None
Validation avg_accuracy: 0.3717579673095897
Validation one_indexed_epoch: 47
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 13 epochs
There is no such attribute
136/136 - 135s - loss: 0.1155 - accuracy: 0.8613 - 135s/epoch - 990ms/step
Epoch 48/80
Validation cm: [[542 347  28  41]
 [193 339  15  15]
 [ 30  16  15   8]
 [ 32  64  14  17]]
Validation normalized_cm: [[0.566 0.362 0.029 0.043]
 [0.343 0.603 0.027 0.027]
 [0.435 0.232 0.217 0.116]
 [0.252 0.504 0.11  0.134]]
Validation acc: 0.532051282051282
Validation class_accuracies: [0.5657620041753654, 0.603202846975089, 0.21739130434782608, 0.13385826771653545]
Validation sensitivity: 0.4894459102902375
Validation specificity: 0.5657620041753654
Validation icbhi_score: 0.5276039572328014
Validation roc_auc: None
Validation avg_accuracy: 0.380053605803704
Validation one_indexed_epoch: 48
The validation tracker metric at 0.557160641397811 hasn't increased by 0 in 14 epochs
There is no such attribute
136/136 - 132s - loss: 0.1157 - accuracy: 0.8551 - 132s/epoch - 972ms/step
Epoch 49/80
Validation cm: [[740 106  92  20]
 [384 143  25  10]
 [ 32   2  26   9]
 [ 59  12  43  13]]
Validation normalized_cm: [[0.772 0.111 0.096 0.021]
 [0.683 0.254 0.044 0.018]
 [0.464 0.029 0.377 0.13 ]
 [0.465 0.094 0.339 0.102]]
Validation acc: 0.5372960372960373
Validation class_accuracies: [0.7724425887265136, 0.25444839857651247, 0.37681159420289856, 0.10236220472440945]
Validation sensitivity: 0.24010554089709762
Validation specificity: 0.7724425887265136
Validation icbhi_score: 0.5062740648118056
Validation roc_auc: None
Validation avg_accuracy: 0.37651619655758356
Validation one_indexed_epoch: 49
The number of epochs since last 1% equals the patience
There is no such attribute
136/136 - 125s - loss: 0.1044 - accuracy: 0.8648 - 125s/epoch - 921ms/step
----------------------------------
The best metrics for this job are: 

Best icbhi_score: 0.557160641397811
Best cm: [[792 104  45  17]
 [342 195  18   7]
 [ 46   6  15   2]
 [ 75  25  19   8]]
Best normalized_cm: [[0.827 0.109 0.047 0.018]
 [0.609 0.347 0.032 0.012]
 [0.667 0.087 0.217 0.029]
 [0.591 0.197 0.15  0.063]]
Best acc: 0.5885780885780886
Best class_accuracies: [0.826722338204593, 0.3469750889679715, 0.21739130434782608, 0.06299212598425197]
Best sensitivity: 0.287598944591029
Best specificity: 0.826722338204593
Best roc_auc: None
Best avg_accuracy: 0.36352021437616067
Best one_indexed_epoch: 34
icbhi_score
model
cm
normalized_cm
acc
class_accuracies
sensitivity
specificity
roc_auc
avg_accuracy
one_indexed_epoch
Initial weights
[]
Post training weights
[]
Weight difference
[]
{'loss': [0.7425938248634338, 0.6904577016830444, 0.6629939675331116, 0.6475098729133606, 0.6256091594696045, 0.6091850996017456, 0.5855879783630371, 0.570379912853241, 0.5539966821670532, 0.5402811765670776, 0.5301849842071533, 0.5172043442726135, 0.49587082862854004, 0.4884106516838074, 0.47728627920150757, 0.4611571133136749, 0.4503479301929474, 0.4290180504322052, 0.41497403383255005, 0.4008071720600128, 0.3995618522167206, 0.37950950860977173, 0.36433112621307373, 0.34807056188583374, 0.33699220418930054, 0.31572285294532776, 0.3140731751918793, 0.289941668510437, 0.2831868529319763, 0.2661115229129791, 0.2579546272754669, 0.24547256529331207, 0.23059138655662537, 0.21957994997501373, 0.2097499519586563, 0.1984289437532425, 0.18853788077831268, 0.17501774430274963, 0.17158298194408417, 0.16836011409759521, 0.15639162063598633, 0.14943456649780273, 0.14215488731861115, 0.13321931660175323, 0.12406981736421585, 0.1226496621966362, 0.11554071307182312, 0.11574937403202057, 0.10442852228879929], 'accuracy': [0.7047597169876099, 0.6035870313644409, 0.6063463091850281, 0.6238215565681458, 0.649114727973938, 0.6297999620437622, 0.6815359592437744, 0.6879742741584778, 0.722464919090271, 0.7215451598167419, 0.7452287673950195, 0.7364911437034607, 0.7518969774246216, 0.7700620889663696, 0.7670729160308838, 0.7702920436859131, 0.7748907804489136, 0.7854679226875305, 0.7882272005081177, 0.7905265688896179, 0.7873074412345886, 0.7962750196456909, 0.8107610940933228, 0.8119108080863953, 0.8155897855758667, 0.8105311393737793, 0.824557363986969, 0.8211082816123962, 0.8206484317779541, 0.836974024772644, 0.8381236791610718, 0.842722475528717, 0.8415727615356445, 0.847551167011261, 0.847551167011261, 0.8489307761192322, 0.8505403399467468, 0.8583582639694214, 0.8572085499763489, 0.859048068523407, 0.8618072867393494, 0.8675557374954224, 0.8666360378265381, 0.8569785952568054, 0.8595079183578491, 0.859048068523407, 0.8613474369049072, 0.8551391363143921, 0.86479651927948]}
Job id is 3.
-----------------------
--- Final training dataset went from 0 to 4634 elements, with 2343 none's, 1342 crakles, 519 wheezes and 430 both ---
--- Final Validation dataset contains 1431 elements, with 535 none, 492 crackles, 198 wheezes and 206 both ---
[LogicalDevice(name='/device:GPU:0', device_type='GPU')]
Initializing weights...
weights = {0: 0.4944515578318395, 1: 0.863263785394933, 2: 2.2321772639691715, 3: 2.694186046511628}
Model: "resnet50"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_2 (InputLayer)           [(None, 80, 500, 3)  0           []                               
                                ]                                                                 
                                                                                                  
 conv1_pad (ZeroPadding2D)      (None, 86, 506, 3)   0           ['input_2[0][0]']                
                                                                                                  
 conv1_conv (Conv2D)            (None, 40, 250, 64)  9472        ['conv1_pad[0][0]']              
                                                                                                  
 conv1_bn (BatchNormalization)  (None, 40, 250, 64)  256         ['conv1_conv[0][0]']             
                                                                                                  
 conv1_relu (Activation)        (None, 40, 250, 64)  0           ['conv1_bn[0][0]']               
                                                                                                  
 pool1_pad (ZeroPadding2D)      (None, 42, 252, 64)  0           ['conv1_relu[0][0]']             
                                                                                                  
 pool1_pool (MaxPooling2D)      (None, 20, 125, 64)  0           ['pool1_pad[0][0]']              
                                                                                                  
 conv2_block1_1_conv (Conv2D)   (None, 20, 125, 64)  4160        ['pool1_pool[0][0]']             
                                                                                                  
 conv2_block1_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block1_1_relu[0][0]']    
                                                                                                  
 conv2_block1_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block1_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block1_0_conv (Conv2D)   (None, 20, 125, 256  16640       ['pool1_pool[0][0]']             
                                )                                                                 
                                                                                                  
 conv2_block1_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block1_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block1_0_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_0_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block1_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block1_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_0_bn[0][0]',      
                                )                                 'conv2_block1_3_bn[0][0]']      
                                                                                                  
 conv2_block1_out (Activation)  (None, 20, 125, 256  0           ['conv2_block1_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block2_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block1_out[0][0]']       
                                                                                                  
 conv2_block2_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block2_1_relu[0][0]']    
                                                                                                  
 conv2_block2_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block2_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block2_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block2_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block2_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block2_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block2_add (Add)         (None, 20, 125, 256  0           ['conv2_block1_out[0][0]',       
                                )                                 'conv2_block2_3_bn[0][0]']      
                                                                                                  
 conv2_block2_out (Activation)  (None, 20, 125, 256  0           ['conv2_block2_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv2_block3_1_conv (Conv2D)   (None, 20, 125, 64)  16448       ['conv2_block2_out[0][0]']       
                                                                                                  
 conv2_block3_1_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_1_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_2_conv (Conv2D)   (None, 20, 125, 64)  36928       ['conv2_block3_1_relu[0][0]']    
                                                                                                  
 conv2_block3_2_bn (BatchNormal  (None, 20, 125, 64)  256        ['conv2_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv2_block3_2_relu (Activatio  (None, 20, 125, 64)  0          ['conv2_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv2_block3_3_conv (Conv2D)   (None, 20, 125, 256  16640       ['conv2_block3_2_relu[0][0]']    
                                )                                                                 
                                                                                                  
 conv2_block3_3_bn (BatchNormal  (None, 20, 125, 256  1024       ['conv2_block3_3_conv[0][0]']    
 ization)                       )                                                                 
                                                                                                  
 conv2_block3_add (Add)         (None, 20, 125, 256  0           ['conv2_block2_out[0][0]',       
                                )                                 'conv2_block3_3_bn[0][0]']      
                                                                                                  
 conv2_block3_out (Activation)  (None, 20, 125, 256  0           ['conv2_block3_add[0][0]']       
                                )                                                                 
                                                                                                  
 conv3_block1_1_conv (Conv2D)   (None, 10, 63, 128)  32896       ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block1_1_relu[0][0]']    
                                                                                                  
 conv3_block1_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block1_0_conv (Conv2D)   (None, 10, 63, 512)  131584      ['conv2_block3_out[0][0]']       
                                                                                                  
 conv3_block1_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block1_2_relu[0][0]']    
                                                                                                  
 conv3_block1_0_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block1_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_0_bn[0][0]',      
                                                                  'conv3_block1_3_bn[0][0]']      
                                                                                                  
 conv3_block1_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block1_add[0][0]']       
                                                                                                  
 conv3_block2_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block1_out[0][0]']       
                                                                                                  
 conv3_block2_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block2_1_relu[0][0]']    
                                                                                                  
 conv3_block2_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block2_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block2_2_relu[0][0]']    
                                                                                                  
 conv3_block2_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block2_add (Add)         (None, 10, 63, 512)  0           ['conv3_block1_out[0][0]',       
                                                                  'conv3_block2_3_bn[0][0]']      
                                                                                                  
 conv3_block2_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block2_add[0][0]']       
                                                                                                  
 conv3_block3_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block2_out[0][0]']       
                                                                                                  
 conv3_block3_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block3_1_relu[0][0]']    
                                                                                                  
 conv3_block3_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block3_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block3_2_relu[0][0]']    
                                                                                                  
 conv3_block3_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block3_add (Add)         (None, 10, 63, 512)  0           ['conv3_block2_out[0][0]',       
                                                                  'conv3_block3_3_bn[0][0]']      
                                                                                                  
 conv3_block3_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block3_add[0][0]']       
                                                                                                  
 conv3_block4_1_conv (Conv2D)   (None, 10, 63, 128)  65664       ['conv3_block3_out[0][0]']       
                                                                                                  
 conv3_block4_1_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_1_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_2_conv (Conv2D)   (None, 10, 63, 128)  147584      ['conv3_block4_1_relu[0][0]']    
                                                                                                  
 conv3_block4_2_bn (BatchNormal  (None, 10, 63, 128)  512        ['conv3_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_2_relu (Activatio  (None, 10, 63, 128)  0          ['conv3_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv3_block4_3_conv (Conv2D)   (None, 10, 63, 512)  66048       ['conv3_block4_2_relu[0][0]']    
                                                                                                  
 conv3_block4_3_bn (BatchNormal  (None, 10, 63, 512)  2048       ['conv3_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv3_block4_add (Add)         (None, 10, 63, 512)  0           ['conv3_block3_out[0][0]',       
                                                                  'conv3_block4_3_bn[0][0]']      
                                                                                                  
 conv3_block4_out (Activation)  (None, 10, 63, 512)  0           ['conv3_block4_add[0][0]']       
                                                                                                  
 conv4_block1_1_conv (Conv2D)   (None, 5, 32, 256)   131328      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block1_1_relu[0][0]']    
                                                                                                  
 conv4_block1_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block1_0_conv (Conv2D)   (None, 5, 32, 1024)  525312      ['conv3_block4_out[0][0]']       
                                                                                                  
 conv4_block1_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block1_2_relu[0][0]']    
                                                                                                  
 conv4_block1_0_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block1_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_0_bn[0][0]',      
                                                                  'conv4_block1_3_bn[0][0]']      
                                                                                                  
 conv4_block1_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block1_add[0][0]']       
                                                                                                  
 conv4_block2_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block1_out[0][0]']       
                                                                                                  
 conv4_block2_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block2_1_relu[0][0]']    
                                                                                                  
 conv4_block2_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block2_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block2_2_relu[0][0]']    
                                                                                                  
 conv4_block2_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block2_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block1_out[0][0]',       
                                                                  'conv4_block2_3_bn[0][0]']      
                                                                                                  
 conv4_block2_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block2_add[0][0]']       
                                                                                                  
 conv4_block3_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block2_out[0][0]']       
                                                                                                  
 conv4_block3_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block3_1_relu[0][0]']    
                                                                                                  
 conv4_block3_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block3_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block3_2_relu[0][0]']    
                                                                                                  
 conv4_block3_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block3_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block2_out[0][0]',       
                                                                  'conv4_block3_3_bn[0][0]']      
                                                                                                  
 conv4_block3_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block3_add[0][0]']       
                                                                                                  
 conv4_block4_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block3_out[0][0]']       
                                                                                                  
 conv4_block4_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block4_1_relu[0][0]']    
                                                                                                  
 conv4_block4_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block4_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block4_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block4_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block4_2_relu[0][0]']    
                                                                                                  
 conv4_block4_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block4_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block4_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block3_out[0][0]',       
                                                                  'conv4_block4_3_bn[0][0]']      
                                                                                                  
 conv4_block4_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block4_add[0][0]']       
                                                                                                  
 conv4_block5_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block4_out[0][0]']       
                                                                                                  
 conv4_block5_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block5_1_relu[0][0]']    
                                                                                                  
 conv4_block5_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block5_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block5_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block5_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block5_2_relu[0][0]']    
                                                                                                  
 conv4_block5_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block5_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block5_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block4_out[0][0]',       
                                                                  'conv4_block5_3_bn[0][0]']      
                                                                                                  
 conv4_block5_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block5_add[0][0]']       
                                                                                                  
 conv4_block6_1_conv (Conv2D)   (None, 5, 32, 256)   262400      ['conv4_block5_out[0][0]']       
                                                                                                  
 conv4_block6_1_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_1_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_2_conv (Conv2D)   (None, 5, 32, 256)   590080      ['conv4_block6_1_relu[0][0]']    
                                                                                                  
 conv4_block6_2_bn (BatchNormal  (None, 5, 32, 256)  1024        ['conv4_block6_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_2_relu (Activatio  (None, 5, 32, 256)  0           ['conv4_block6_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv4_block6_3_conv (Conv2D)   (None, 5, 32, 1024)  263168      ['conv4_block6_2_relu[0][0]']    
                                                                                                  
 conv4_block6_3_bn (BatchNormal  (None, 5, 32, 1024)  4096       ['conv4_block6_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv4_block6_add (Add)         (None, 5, 32, 1024)  0           ['conv4_block5_out[0][0]',       
                                                                  'conv4_block6_3_bn[0][0]']      
                                                                                                  
 conv4_block6_out (Activation)  (None, 5, 32, 1024)  0           ['conv4_block6_add[0][0]']       
                                                                                                  
 conv5_block1_1_conv (Conv2D)   (None, 3, 16, 512)   524800      ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block1_1_relu[0][0]']    
                                                                                                  
 conv5_block1_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block1_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block1_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block1_0_conv (Conv2D)   (None, 3, 16, 2048)  2099200     ['conv4_block6_out[0][0]']       
                                                                                                  
 conv5_block1_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block1_2_relu[0][0]']    
                                                                                                  
 conv5_block1_0_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_0_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block1_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block1_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_0_bn[0][0]',      
                                                                  'conv5_block1_3_bn[0][0]']      
                                                                                                  
 conv5_block1_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block1_add[0][0]']       
                                                                                                  
 conv5_block2_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block1_out[0][0]']       
                                                                                                  
 conv5_block2_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block2_1_relu[0][0]']    
                                                                                                  
 conv5_block2_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block2_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block2_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block2_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block2_2_relu[0][0]']    
                                                                                                  
 conv5_block2_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block2_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block2_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block1_out[0][0]',       
                                                                  'conv5_block2_3_bn[0][0]']      
                                                                                                  
 conv5_block2_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block2_add[0][0]']       
                                                                                                  
 conv5_block3_1_conv (Conv2D)   (None, 3, 16, 512)   1049088     ['conv5_block2_out[0][0]']       
                                                                                                  
 conv5_block3_1_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_1_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_1_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_1_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_2_conv (Conv2D)   (None, 3, 16, 512)   2359808     ['conv5_block3_1_relu[0][0]']    
                                                                                                  
 conv5_block3_2_bn (BatchNormal  (None, 3, 16, 512)  2048        ['conv5_block3_2_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_2_relu (Activatio  (None, 3, 16, 512)  0           ['conv5_block3_2_bn[0][0]']      
 n)                                                                                               
                                                                                                  
 conv5_block3_3_conv (Conv2D)   (None, 3, 16, 2048)  1050624     ['conv5_block3_2_relu[0][0]']    
                                                                                                  
 conv5_block3_3_bn (BatchNormal  (None, 3, 16, 2048)  8192       ['conv5_block3_3_conv[0][0]']    
 ization)                                                                                         
                                                                                                  
 conv5_block3_add (Add)         (None, 3, 16, 2048)  0           ['conv5_block2_out[0][0]',       
                                                                  'conv5_block3_3_bn[0][0]']      
                                                                                                  
 conv5_block3_out (Activation)  (None, 3, 16, 2048)  0           ['conv5_block3_add[0][0]']       
                                                                                                  
==================================================================================================
Total params: 23,587,712
Trainable params: 23,534,592
Non-trainable params: 53,120
__________________________________________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 resnet50 (Functional)       (None, 3, 16, 2048)       23587712  
                                                                 
 global_average_pooling2d_1   (None, 2048)             0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_3 (Dense)             (None, 100)               204900    
                                                                 
 dropout_2 (Dropout)         (None, 100)               0         
                                                                 
 dense_4 (Dense)             (None, 50)                5050      
                                                                 
 dropout_3 (Dropout)         (None, 50)                0         
                                                                 
 dense_5 (Dense)             (None, 2)                 102       
                                                                 
=================================================================
Total params: 23,797,764
Trainable params: 23,744,644
Non-trainable params: 53,120
_________________________________________________________________
Model: "leaf_model9_model_efnet1_1"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 mel_filterbanks_2 (MelFilterbanks)              multiple                                    0                
                                                                                                              
 mel_filterbanks_3 (MelFilterbanks)              multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 sequential_1 (Sequential)                       (None, 2)                                   23797764         
                                                                                                              
==============================================================================================================
Total params: 23,797,926
Trainable params: 23,744,806
Non-trainable params: 53,120
______________________________________________________________________________________________________________
Target metric is icbhi_score
Epoch 1/80
/home/alirachidi/classification_algorithm/trainers/modules/main/global_helpers.py:48: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'Variable:0', 'Variable:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[ 69  35 281 150]
 [ 33  13 305 141]
 [ 43  22  88  45]
 [ 24   4 126  52]]
Validation normalized_cm: [[0.129 0.065 0.525 0.28 ]
 [0.067 0.026 0.62  0.287]
 [0.217 0.111 0.444 0.227]
 [0.117 0.019 0.612 0.252]]
Validation acc: 0.15513626834381553
Validation class_accuracies: [0.12897196261682242, 0.026422764227642278, 0.4444444444444444, 0.2524271844660194]
Validation sensitivity: 0.17075892857142858
Validation specificity: 0.12897196261682242
Validation icbhi_score: 0.1498654455941255
Validation roc_auc: None
Validation avg_accuracy: 0.21306658893873212
Validation one_indexed_epoch: 1
-- New best results were achieved. --
There is no such attribute
145/145 - 118s - loss: 0.7372 - accuracy: 0.3686 - 118s/epoch - 813ms/step
Epoch 2/80
