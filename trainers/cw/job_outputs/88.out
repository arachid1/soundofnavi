Tensorflow Version: 2.8.0
Num GPUs Available:  1
Collecting Variables...
All variables have been collected.
../cache/
cw
train88
Description: efbnetb1
-----------------------
Job id is 1.
- Loading Icbhi.
725 Icbhi audios have been loaded.
- Preparing Icbhi.
112 Icbhi groups of audio chunks (by filename or patients) have been prepared.
--- Samples are being split into training/val groups and de-grouped by patient ---
--- Icbhi training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Icbhi Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
0
0
0
0
-----------------------
--- Final training dataset went from 0 to 2040 elements, with 707 none's, 720 crakles, 285 wheezes and 327 both ---
--- Final Validation dataset contains 299 elements, with 172 none, 70 crackles, 18 wheezes and 39 both ---
Model: "leaf_resnet_bis"
______________________________________________________________________________________________________________
 Layer (type)                                    Output Shape                                Param #          
==============================================================================================================
 leaf (Leaf)                                     multiple                                    560              
                                                                                                              
 mel_filterbanks (MelFilterbanks)                multiple                                    0 (unused)       
                                                                                                              
 sincnet (SincNet)                               multiple                                    0 (unused)       
                                                                                                              
 leaf (Leaf)                                     multiple                                    0 (unused)       
                                                                                                              
 sequential (Sequential)                         (None, 2)                                   6577801          
                                                                                                              
==============================================================================================================
Total params: 6,578,681
Trainable params: 6,516,626
Non-trainable params: 62,055
______________________________________________________________________________________________________________
Target metric is avg_accuracy
Epoch 1/60
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
WARNING:tensorflow:Gradients do not exist for variables ['kernel:0', 'kernel:0', 'kernel:0', 'kernel:0'] when minimizing the loss. If you're using `model.compile()`, did you forget to provide a `loss`argument?
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 1
-- New best results were achieved. --
128/128 - 202s - loss: 0.7027 - accuracy: 0.8005 - 202s/epoch - 2s/step
Epoch 2/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 2
128/128 - 180s - loss: 0.6703 - accuracy: 0.8422 - 180s/epoch - 1s/step
Epoch 3/60
Validation cm: [[172   0   0   0]
 [ 70   0   0   0]
 [ 18   0   0   0]
 [ 39   0   0   0]]
Validation normalized_cm: [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Validation acc: 0.5752508361204013
Validation class_accuracies: [1.0, 0.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 3
128/128 - 181s - loss: 0.6563 - accuracy: 0.8431 - 181s/epoch - 1s/step
Epoch 4/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 4
128/128 - 180s - loss: 0.6582 - accuracy: 0.8426 - 180s/epoch - 1s/step
Epoch 5/60
Validation cm: [[142  30   0   0]
 [ 58  12   0   0]
 [ 13   5   0   0]
 [ 31   8   0   0]]
Validation normalized_cm: [[0.826 0.174 0.    0.   ]
 [0.829 0.171 0.    0.   ]
 [0.722 0.278 0.    0.   ]
 [0.795 0.205 0.    0.   ]]
Validation acc: 0.5150501672240803
Validation class_accuracies: [0.8255813953488372, 0.17142857142857143, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24925249169435215
Validation one_indexed_epoch: 5
128/128 - 179s - loss: 0.6555 - accuracy: 0.8426 - 179s/epoch - 1s/step
Epoch 6/60
Validation cm: [[35 41 96  0]
 [15 20 35  0]
 [ 5  3 10  0]
 [ 6 12 21  0]]
Validation normalized_cm: [[0.203 0.238 0.558 0.   ]
 [0.214 0.286 0.5   0.   ]
 [0.278 0.167 0.556 0.   ]
 [0.154 0.308 0.538 0.   ]]
Validation acc: 0.21739130434782608
Validation class_accuracies: [0.20348837209302326, 0.2857142857142857, 0.5555555555555556, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26118955334071614
Validation one_indexed_epoch: 6
-- New best results were achieved. --
128/128 - 180s - loss: 0.6539 - accuracy: 0.8510 - 180s/epoch - 1s/step
Epoch 7/60
Validation cm: [[  6  17 105  44]
 [  0  16  38  16]
 [  2   3  12   1]
 [  2   1  27   9]]
Validation normalized_cm: [[0.035 0.099 0.61  0.256]
 [0.    0.229 0.543 0.229]
 [0.111 0.167 0.667 0.056]
 [0.051 0.026 0.692 0.231]]
Validation acc: 0.14381270903010032
Validation class_accuracies: [0.03488372093023256, 0.22857142857142856, 0.6666666666666666, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.29022276173438966
Validation one_indexed_epoch: 7
-- New best results were achieved. --
128/128 - 180s - loss: 0.6474 - accuracy: 0.8456 - 180s/epoch - 1s/step
Epoch 8/60
Validation cm: [[  0   0   0 172]
 [  0   0   0  70]
 [  0   0   0  18]
 [  0   0   0  39]]
Validation normalized_cm: [[0. 0. 0. 1.]
 [0. 0. 0. 1.]
 [0. 0. 0. 1.]
 [0. 0. 0. 1.]]
Validation acc: 0.13043478260869565
Validation class_accuracies: [0.0, 0.0, 0.0, 1.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 8
128/128 - 179s - loss: 0.6335 - accuracy: 0.8225 - 179s/epoch - 1s/step
Epoch 9/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 9
128/128 - 179s - loss: 0.6439 - accuracy: 0.8422 - 179s/epoch - 1s/step
Epoch 10/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 10
128/128 - 180s - loss: 0.6530 - accuracy: 0.8588 - 180s/epoch - 1s/step
Epoch 11/60
Validation cm: [[  4 166   0   2]
 [  2  68   0   0]
 [  0  18   0   0]
 [  2  37   0   0]]
Validation normalized_cm: [[0.023 0.965 0.    0.012]
 [0.029 0.971 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.051 0.949 0.    0.   ]]
Validation acc: 0.2408026755852843
Validation class_accuracies: [0.023255813953488372, 0.9714285714285714, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24867109634551496
Validation one_indexed_epoch: 11
128/128 - 186s - loss: 0.6527 - accuracy: 0.8598 - 186s/epoch - 1s/step
Epoch 12/60
Validation cm: [[  0 172   0   0]
 [  1  69   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0.    1.    0.    0.   ]
 [0.014 0.986 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.23076923076923078
Validation class_accuracies: [0.0, 0.9857142857142858, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24642857142857144
Validation one_indexed_epoch: 12
128/128 - 185s - loss: 0.6521 - accuracy: 0.8603 - 185s/epoch - 1s/step
Epoch 13/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 13
128/128 - 181s - loss: 0.6508 - accuracy: 0.8603 - 181s/epoch - 1s/step
Epoch 14/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 14
128/128 - 181s - loss: 0.6527 - accuracy: 0.8603 - 181s/epoch - 1s/step
Epoch 15/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 15
128/128 - 181s - loss: 0.6520 - accuracy: 0.8603 - 181s/epoch - 1s/step
Epoch 16/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 16
128/128 - 181s - loss: 0.6515 - accuracy: 0.8583 - 181s/epoch - 1s/step
Epoch 17/60
Validation cm: [[  1 171   0   0]
 [  1  69   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0.006 0.994 0.    0.   ]
 [0.014 0.986 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.005813953488372093, 0.9857142857142858, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24788205980066447
Validation one_indexed_epoch: 17
128/128 - 181s - loss: 0.6505 - accuracy: 0.8583 - 181s/epoch - 1s/step
Epoch 18/60
Validation cm: [[89 83  0  0]
 [40 30  0  0]
 [12  6  0  0]
 [23 16  0  0]]
Validation normalized_cm: [[0.517 0.483 0.    0.   ]
 [0.571 0.429 0.    0.   ]
 [0.667 0.333 0.    0.   ]
 [0.59  0.41  0.    0.   ]]
Validation acc: 0.3979933110367893
Validation class_accuracies: [0.5174418604651163, 0.42857142857142855, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.23650332225913623
Validation one_indexed_epoch: 18
128/128 - 181s - loss: 0.6479 - accuracy: 0.8559 - 181s/epoch - 1s/step
Epoch 19/60
Validation cm: [[  0 167   0   5]
 [  0  69   0   1]
 [  0  18   0   0]
 [  0  38   0   1]]
Validation normalized_cm: [[0.    0.971 0.    0.029]
 [0.    0.986 0.    0.014]
 [0.    1.    0.    0.   ]
 [0.    0.974 0.    0.026]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 0.9857142857142858, 0.0, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25283882783882783
Validation one_indexed_epoch: 19
128/128 - 181s - loss: 0.6521 - accuracy: 0.8603 - 181s/epoch - 1s/step
Epoch 20/60
Validation cm: [[  0 127   0  45]
 [  0  50   0  20]
 [  0  10   0   8]
 [  0  30   0   9]]
Validation normalized_cm: [[0.    0.738 0.    0.262]
 [0.    0.714 0.    0.286]
 [0.    0.556 0.    0.444]
 [0.    0.769 0.    0.231]]
Validation acc: 0.19732441471571907
Validation class_accuracies: [0.0, 0.7142857142857143, 0.0, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.23626373626373626
Validation one_indexed_epoch: 20
128/128 - 180s - loss: 0.6495 - accuracy: 0.8583 - 180s/epoch - 1s/step
Epoch 21/60
Validation cm: [[  0   4   0 168]
 [  0   0   0  70]
 [  0   0   0  18]
 [  0   0   0  39]]
Validation normalized_cm: [[0.    0.023 0.    0.977]
 [0.    0.    0.    1.   ]
 [0.    0.    0.    1.   ]
 [0.    0.    0.    1.   ]]
Validation acc: 0.13043478260869565
Validation class_accuracies: [0.0, 0.0, 0.0, 1.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 21
128/128 - 180s - loss: 0.6481 - accuracy: 0.8603 - 180s/epoch - 1s/step
Epoch 22/60
Validation cm: [[  0 172   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]]
Validation acc: 0.23411371237458195
Validation class_accuracies: [0.0, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25
Validation one_indexed_epoch: 22
128/128 - 181s - loss: 0.6491 - accuracy: 0.8603 - 181s/epoch - 1s/step
Epoch 23/60
Validation cm: [[  0 125   2  45]
 [  0  50   1  19]
 [  0  10   0   8]
 [  0  32   0   7]]
Validation normalized_cm: [[0.    0.727 0.012 0.262]
 [0.    0.714 0.014 0.271]
 [0.    0.556 0.    0.444]
 [0.    0.821 0.    0.179]]
Validation acc: 0.19063545150501673
Validation class_accuracies: [0.0, 0.7142857142857143, 0.0, 0.1794871794871795]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.22344322344322345
Validation one_indexed_epoch: 23
128/128 - 182s - loss: 0.6496 - accuracy: 0.8598 - 182s/epoch - 1s/step
Epoch 24/60
Validation cm: [[  0 157   0  15]
 [  0  66   0   4]
 [  0  18   0   0]
 [  0  36   0   3]]
Validation normalized_cm: [[0.    0.913 0.    0.087]
 [0.    0.943 0.    0.057]
 [0.    1.    0.    0.   ]
 [0.    0.923 0.    0.077]]
Validation acc: 0.23076923076923078
Validation class_accuracies: [0.0, 0.9428571428571428, 0.0, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2549450549450549
Validation one_indexed_epoch: 24
128/128 - 181s - loss: 0.6475 - accuracy: 0.8583 - 181s/epoch - 1s/step
Epoch 25/60
Validation cm: [[33 85 54  0]
 [14 27 29  0]
 [ 1 10  7  0]
 [ 5 18 16  0]]
Validation normalized_cm: [[0.192 0.494 0.314 0.   ]
 [0.2   0.386 0.414 0.   ]
 [0.056 0.556 0.389 0.   ]
 [0.128 0.462 0.41  0.   ]]
Validation acc: 0.22408026755852842
Validation class_accuracies: [0.19186046511627908, 0.38571428571428573, 0.3888888888888889, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24161590992986343
Validation one_indexed_epoch: 25
128/128 - 181s - loss: 0.6476 - accuracy: 0.8598 - 181s/epoch - 1s/step
Epoch 26/60
Validation cm: [[  3 132  18  19]
 [  0  55   9   6]
 [  0  14   2   2]
 [  0  28   2   9]]
Validation normalized_cm: [[0.017 0.767 0.105 0.11 ]
 [0.    0.786 0.129 0.086]
 [0.    0.778 0.111 0.111]
 [0.    0.718 0.051 0.231]]
Validation acc: 0.23076923076923078
Validation class_accuracies: [0.01744186046511628, 0.7857142857142857, 0.1111111111111111, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.286259122014936
Validation one_indexed_epoch: 26
128/128 - 181s - loss: 0.6433 - accuracy: 0.8451 - 181s/epoch - 1s/step
Epoch 27/60
Validation cm: [[ 72 100   0   0]
 [ 22  48   0   0]
 [  7  11   0   0]
 [ 12  26   0   1]]
Validation normalized_cm: [[0.419 0.581 0.    0.   ]
 [0.314 0.686 0.    0.   ]
 [0.389 0.611 0.    0.   ]
 [0.308 0.667 0.    0.026]]
Validation acc: 0.40468227424749165
Validation class_accuracies: [0.4186046511627907, 0.6857142857142857, 0.0, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2824899906295255
Validation one_indexed_epoch: 27
128/128 - 180s - loss: 0.6444 - accuracy: 0.8480 - 180s/epoch - 1s/step
Epoch 28/60
Validation cm: [[ 10 159   3   0]
 [  1  68   0   1]
 [  2  16   0   0]
 [  3  35   1   0]]
Validation normalized_cm: [[0.058 0.924 0.017 0.   ]
 [0.014 0.971 0.    0.014]
 [0.111 0.889 0.    0.   ]
 [0.077 0.897 0.026 0.   ]]
Validation acc: 0.2608695652173913
Validation class_accuracies: [0.05813953488372093, 0.9714285714285714, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2573920265780731
Validation one_indexed_epoch: 28
128/128 - 180s - loss: 0.6440 - accuracy: 0.8412 - 180s/epoch - 1s/step
Epoch 29/60
Validation cm: [[  2 170   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  39   0   0]]
Validation normalized_cm: [[0.012 0.988 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]]
Validation acc: 0.2408026755852843
Validation class_accuracies: [0.011627906976744186, 1.0, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25290697674418605
Validation one_indexed_epoch: 29
128/128 - 180s - loss: 0.6437 - accuracy: 0.8544 - 180s/epoch - 1s/step
Epoch 30/60
Validation cm: [[  5 167   0   0]
 [  1  69   0   0]
 [  0  18   0   0]
 [  2  37   0   0]]
Validation normalized_cm: [[0.029 0.971 0.    0.   ]
 [0.014 0.986 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.051 0.949 0.    0.   ]]
Validation acc: 0.24749163879598662
Validation class_accuracies: [0.029069767441860465, 0.9857142857142858, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25369601328903657
Validation one_indexed_epoch: 30
128/128 - 180s - loss: 0.6380 - accuracy: 0.8368 - 180s/epoch - 1s/step
Epoch 31/60
Validation cm: [[  3 136  13  20]
 [  0  57   1  12]
 [  0  16   0   2]
 [  0  34   3   2]]
Validation normalized_cm: [[0.017 0.791 0.076 0.116]
 [0.    0.814 0.014 0.171]
 [0.    0.889 0.    0.111]
 [0.    0.872 0.077 0.051]]
Validation acc: 0.20735785953177258
Validation class_accuracies: [0.01744186046511628, 0.8142857142857143, 0.0, 0.05128205128205128]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.22075240650822048
Validation one_indexed_epoch: 31
128/128 - 180s - loss: 0.6410 - accuracy: 0.8279 - 180s/epoch - 1s/step
Epoch 32/60
Validation cm: [[  2 170   0   0]
 [  0  70   0   0]
 [  0  18   0   0]
 [  0  37   0   2]]
Validation normalized_cm: [[0.012 0.988 0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    1.    0.    0.   ]
 [0.    0.949 0.    0.051]]
Validation acc: 0.24749163879598662
Validation class_accuracies: [0.011627906976744186, 1.0, 0.0, 0.05128205128205128]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2657274895646989
Validation one_indexed_epoch: 32
128/128 - 180s - loss: 0.6389 - accuracy: 0.8368 - 180s/epoch - 1s/step
Epoch 33/60
Validation cm: [[ 53 108   1  10]
 [ 16  46   0   8]
 [  5  11   0   2]
 [ 12  26   0   1]]
Validation normalized_cm: [[0.308 0.628 0.006 0.058]
 [0.229 0.657 0.    0.114]
 [0.278 0.611 0.    0.111]
 [0.308 0.667 0.    0.026]]
Validation acc: 0.33444816053511706
Validation class_accuracies: [0.3081395348837209, 0.6571428571428571, 0.0, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.24773085441690093
Validation one_indexed_epoch: 33
128/128 - 180s - loss: 0.6358 - accuracy: 0.8314 - 180s/epoch - 1s/step
Epoch 34/60
Validation cm: [[ 14 157   0   1]
 [  2  66   0   2]
 [  1  17   0   0]
 [  2  37   0   0]]
Validation normalized_cm: [[0.081 0.913 0.    0.006]
 [0.029 0.943 0.    0.029]
 [0.056 0.944 0.    0.   ]
 [0.051 0.949 0.    0.   ]]
Validation acc: 0.26755852842809363
Validation class_accuracies: [0.08139534883720931, 0.9428571428571428, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.256063122923588
Validation one_indexed_epoch: 34
128/128 - 181s - loss: 0.6349 - accuracy: 0.8402 - 181s/epoch - 1s/step
Epoch 35/60
Validation cm: [[  4 167   0   1]
 [  1  69   0   0]
 [  1  17   0   0]
 [  1  37   0   1]]
Validation normalized_cm: [[0.023 0.971 0.    0.006]
 [0.014 0.986 0.    0.   ]
 [0.056 0.944 0.    0.   ]
 [0.026 0.949 0.    0.026]]
Validation acc: 0.24749163879598662
Validation class_accuracies: [0.023255813953488372, 0.9857142857142858, 0.0, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.25865278132719993
Validation one_indexed_epoch: 35
128/128 - 181s - loss: 0.6304 - accuracy: 0.8240 - 181s/epoch - 1s/step
Epoch 36/60
Validation cm: [[ 15 157   0   0]
 [  4  65   0   1]
 [  0  18   0   0]
 [  2  37   0   0]]
Validation normalized_cm: [[0.087 0.913 0.    0.   ]
 [0.057 0.929 0.    0.014]
 [0.    1.    0.    0.   ]
 [0.051 0.949 0.    0.   ]]
Validation acc: 0.26755852842809363
Validation class_accuracies: [0.0872093023255814, 0.9285714285714286, 0.0, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2539451827242525
Validation one_indexed_epoch: 36
128/128 - 181s - loss: 0.6328 - accuracy: 0.8240 - 181s/epoch - 1s/step
Epoch 37/60
Validation cm: [[  6 109  13  44]
 [  4  33   6  27]
 [  1   8   4   5]
 [  3  23   5   8]]
Validation normalized_cm: [[0.035 0.634 0.076 0.256]
 [0.057 0.471 0.086 0.386]
 [0.056 0.444 0.222 0.278]
 [0.077 0.59  0.128 0.205]]
Validation acc: 0.1705685618729097
Validation class_accuracies: [0.03488372093023256, 0.4714285714285714, 0.2222222222222222, 0.20512820512820512]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.23341567992730783
Validation one_indexed_epoch: 37
128/128 - 181s - loss: 0.6223 - accuracy: 0.8250 - 181s/epoch - 1s/step
Epoch 38/60
Validation cm: [[ 62 108   2   0]
 [ 13  57   0   0]
 [  4  13   1   0]
 [ 14  24   0   1]]
Validation normalized_cm: [[0.36  0.628 0.012 0.   ]
 [0.186 0.814 0.    0.   ]
 [0.222 0.722 0.056 0.   ]
 [0.359 0.615 0.    0.026]]
Validation acc: 0.40468227424749165
Validation class_accuracies: [0.36046511627906974, 0.8142857142857143, 0.05555555555555555, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3139868529403413
Validation one_indexed_epoch: 38
-- New best results were achieved. --
128/128 - 181s - loss: 0.6142 - accuracy: 0.8093 - 181s/epoch - 1s/step
Epoch 39/60
Validation cm: [[ 47 124   1   0]
 [ 10  55   0   5]
 [  3  15   0   0]
 [ 16  22   0   1]]
Validation normalized_cm: [[0.273 0.721 0.006 0.   ]
 [0.143 0.786 0.    0.071]
 [0.167 0.833 0.    0.   ]
 [0.41  0.564 0.    0.026]]
Validation acc: 0.34448160535117056
Validation class_accuracies: [0.27325581395348836, 0.7857142857142857, 0.0, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2711527813271999
Validation one_indexed_epoch: 39
128/128 - 181s - loss: 0.6223 - accuracy: 0.8142 - 181s/epoch - 1s/step
Epoch 40/60
Validation cm: [[120  47   2   3]
 [ 59  10   0   1]
 [ 13   5   0   0]
 [ 26  11   1   1]]
Validation normalized_cm: [[0.698 0.273 0.012 0.017]
 [0.843 0.143 0.    0.014]
 [0.722 0.278 0.    0.   ]
 [0.667 0.282 0.026 0.026]]
Validation acc: 0.43812709030100333
Validation class_accuracies: [0.6976744186046512, 0.14285714285714285, 0.0, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21654314677570494
Validation one_indexed_epoch: 40
128/128 - 183s - loss: 0.6057 - accuracy: 0.8191 - 183s/epoch - 1s/step
Epoch 41/60
Validation cm: [[120  37  12   3]
 [ 45  16   7   2]
 [ 13   0   3   2]
 [ 26   6   6   1]]
Validation normalized_cm: [[0.698 0.215 0.07  0.017]
 [0.643 0.229 0.1   0.029]
 [0.722 0.    0.167 0.111]
 [0.667 0.154 0.154 0.026]]
Validation acc: 0.4682274247491639
Validation class_accuracies: [0.6976744186046512, 0.22857142857142856, 0.16666666666666666, 0.02564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.279638384870943
Validation one_indexed_epoch: 41
128/128 - 183s - loss: 0.5991 - accuracy: 0.8123 - 183s/epoch - 1s/step
Epoch 42/60
Validation cm: [[57 50 26 39]
 [12 17 11 30]
 [ 1  4  3 10]
 [ 9 10  6 14]]
Validation normalized_cm: [[0.331 0.291 0.151 0.227]
 [0.171 0.243 0.157 0.429]
 [0.056 0.222 0.167 0.556]
 [0.231 0.256 0.154 0.359]]
Validation acc: 0.30434782608695654
Validation class_accuracies: [0.3313953488372093, 0.24285714285714285, 0.16666666666666666, 0.358974358974359]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2749733793338444
Validation one_indexed_epoch: 42
128/128 - 182s - loss: 0.5860 - accuracy: 0.8088 - 182s/epoch - 1s/step
Epoch 43/60
Validation cm: [[125  27  14   6]
 [ 50  10   8   2]
 [ 11   3   4   0]
 [ 29   5   5   0]]
Validation normalized_cm: [[0.727 0.157 0.081 0.035]
 [0.714 0.143 0.114 0.029]
 [0.611 0.167 0.222 0.   ]
 [0.744 0.128 0.128 0.   ]]
Validation acc: 0.46488294314381273
Validation class_accuracies: [0.7267441860465116, 0.14285714285714285, 0.2222222222222222, 0.0]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2729558877814692
Validation one_indexed_epoch: 43
128/128 - 182s - loss: 0.5731 - accuracy: 0.8078 - 182s/epoch - 1s/step
Epoch 44/60
Validation cm: [[ 30 100  12  30]
 [  8  29   9  24]
 [  1  10   1   6]
 [  4  15   4  16]]
Validation normalized_cm: [[0.174 0.581 0.07  0.174]
 [0.114 0.414 0.129 0.343]
 [0.056 0.556 0.056 0.333]
 [0.103 0.385 0.103 0.41 ]]
Validation acc: 0.25418060200668896
Validation class_accuracies: [0.1744186046511628, 0.4142857142857143, 0.05555555555555555, 0.41025641025641024]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.26362907118721074
Validation one_indexed_epoch: 44
128/128 - 181s - loss: 0.5648 - accuracy: 0.7971 - 181s/epoch - 1s/step
Epoch 45/60
Validation cm: [[74 49 41  8]
 [30 13 26  1]
 [ 3  3 10  2]
 [ 9  5 15 10]]
Validation normalized_cm: [[0.43  0.285 0.238 0.047]
 [0.429 0.186 0.371 0.014]
 [0.167 0.167 0.556 0.111]
 [0.231 0.128 0.385 0.256]]
Validation acc: 0.35785953177257523
Validation class_accuracies: [0.43023255813953487, 0.18571428571428572, 0.5555555555555556, 0.2564102564102564]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.3569781639549081
Validation one_indexed_epoch: 45
-- New best results were achieved. --
128/128 - 182s - loss: 0.5493 - accuracy: 0.8074 - 182s/epoch - 1s/step
Epoch 46/60
Validation cm: [[15 33 35 89]
 [ 5 16 14 35]
 [ 0  8  2  8]
 [ 1 11  9 18]]
Validation normalized_cm: [[0.087 0.192 0.203 0.517]
 [0.071 0.229 0.2   0.5  ]
 [0.    0.444 0.111 0.444]
 [0.026 0.282 0.231 0.462]]
Validation acc: 0.1705685618729097
Validation class_accuracies: [0.0872093023255814, 0.22857142857142856, 0.1111111111111111, 0.46153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.22210757588664565
Validation one_indexed_epoch: 46
128/128 - 187s - loss: 0.5123 - accuracy: 0.7980 - 187s/epoch - 1s/step
Epoch 47/60
Validation cm: [[70 66  9 27]
 [29 22  2 17]
 [ 2  7  3  6]
 [ 9 16  2 12]]
Validation normalized_cm: [[0.407 0.384 0.052 0.157]
 [0.414 0.314 0.029 0.243]
 [0.111 0.389 0.167 0.333]
 [0.231 0.41  0.051 0.308]]
Validation acc: 0.35785953177257523
Validation class_accuracies: [0.4069767441860465, 0.3142857142857143, 0.16666666666666666, 0.3076923076923077]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2989053582076838
Validation one_indexed_epoch: 47
128/128 - 207s - loss: 0.4982 - accuracy: 0.8049 - 207s/epoch - 2s/step
Epoch 48/60
Validation cm: [[42 56 31 43]
 [18 15 18 19]
 [ 2  6  2  8]
 [ 5 15 10  9]]
Validation normalized_cm: [[0.244 0.326 0.18  0.25 ]
 [0.257 0.214 0.257 0.271]
 [0.111 0.333 0.111 0.444]
 [0.128 0.385 0.256 0.231]]
Validation acc: 0.22742474916387959
Validation class_accuracies: [0.2441860465116279, 0.21428571428571427, 0.1111111111111111, 0.23076923076923078]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.20008802566942102
Validation one_indexed_epoch: 48
128/128 - 191s - loss: 0.4554 - accuracy: 0.8020 - 191s/epoch - 1s/step
Epoch 49/60
Validation cm: [[ 55 102   1  14]
 [ 15  49   1   5]
 [  3  13   1   1]
 [ 11  23   2   3]]
Validation normalized_cm: [[0.32  0.593 0.006 0.081]
 [0.214 0.7   0.014 0.071]
 [0.167 0.722 0.056 0.056]
 [0.282 0.59  0.051 0.077]]
Validation acc: 0.3612040133779264
Validation class_accuracies: [0.31976744186046513, 0.7, 0.05555555555555555, 0.07692307692307693]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28806151858477436
Validation one_indexed_epoch: 49
128/128 - 168s - loss: 0.4150 - accuracy: 0.8034 - 168s/epoch - 1s/step
Epoch 50/60
Validation cm: [[40 71 32 29]
 [16 25 13 16]
 [ 2  9  4  3]
 [12  9  7 11]]
Validation normalized_cm: [[0.233 0.413 0.186 0.169]
 [0.229 0.357 0.186 0.229]
 [0.111 0.5   0.222 0.167]
 [0.308 0.231 0.179 0.282]]
Validation acc: 0.26755852842809363
Validation class_accuracies: [0.23255813953488372, 0.35714285714285715, 0.2222222222222222, 0.28205128205128205]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2734936252378113
Validation one_indexed_epoch: 50
128/128 - 156s - loss: 0.3835 - accuracy: 0.8206 - 156s/epoch - 1s/step
Epoch 51/60
Validation cm: [[51 53 20 48]
 [18 24  9 19]
 [ 3  3  1 11]
 [10 10  2 17]]
Validation normalized_cm: [[0.297 0.308 0.116 0.279]
 [0.257 0.343 0.129 0.271]
 [0.167 0.167 0.056 0.611]
 [0.256 0.256 0.051 0.436]]
Validation acc: 0.3110367892976589
Validation class_accuracies: [0.29651162790697677, 0.34285714285714286, 0.05555555555555555, 0.4358974358974359]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.28270544055427776
Validation one_indexed_epoch: 51
128/128 - 157s - loss: 0.3366 - accuracy: 0.7779 - 157s/epoch - 1s/step
Epoch 52/60
Validation cm: [[48 48 30 46]
 [16 18 13 23]
 [ 3  4  3  8]
 [12  8  6 13]]
Validation normalized_cm: [[0.279 0.279 0.174 0.267]
 [0.229 0.257 0.186 0.329]
 [0.167 0.222 0.167 0.444]
 [0.308 0.205 0.154 0.333]]
Validation acc: 0.27424749163879597
Validation class_accuracies: [0.27906976744186046, 0.2571428571428571, 0.16666666666666666, 0.3333333333333333]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2590531561461794
Validation one_indexed_epoch: 52
128/128 - 157s - loss: 0.3032 - accuracy: 0.8147 - 157s/epoch - 1s/step
Epoch 53/60
Validation cm: [[28 45 33 66]
 [ 5 16 13 36]
 [ 2  4  1 11]
 [ 3  7  7 22]]
Validation normalized_cm: [[0.163 0.262 0.192 0.384]
 [0.071 0.229 0.186 0.514]
 [0.111 0.222 0.056 0.611]
 [0.077 0.179 0.179 0.564]]
Validation acc: 0.22408026755852842
Validation class_accuracies: [0.16279069767441862, 0.22857142857142856, 0.05555555555555555, 0.5641025641025641]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2527550614759917
Validation one_indexed_epoch: 53
128/128 - 157s - loss: 0.2655 - accuracy: 0.7907 - 157s/epoch - 1s/step
Epoch 54/60
Validation cm: [[55 38 32 47]
 [ 9 19 16 26]
 [ 2  3  3 10]
 [ 9 11 11  8]]
Validation normalized_cm: [[0.32  0.221 0.186 0.273]
 [0.129 0.271 0.229 0.371]
 [0.111 0.167 0.167 0.556]
 [0.231 0.282 0.282 0.205]]
Validation acc: 0.2842809364548495
Validation class_accuracies: [0.31976744186046513, 0.2714285714285714, 0.16666666666666666, 0.20512820512820512]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2407477212709771
Validation one_indexed_epoch: 54
128/128 - 157s - loss: 0.2449 - accuracy: 0.7765 - 157s/epoch - 1s/step
Epoch 55/60
Validation cm: [[55 67 27 23]
 [18 24 12 16]
 [ 4  5  1  8]
 [16 11  7  5]]
Validation normalized_cm: [[0.32  0.39  0.157 0.134]
 [0.257 0.343 0.171 0.229]
 [0.222 0.278 0.056 0.444]
 [0.41  0.282 0.179 0.128]]
Validation acc: 0.2842809364548495
Validation class_accuracies: [0.31976744186046513, 0.34285714285714286, 0.05555555555555555, 0.1282051282051282]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.21159631711957294
Validation one_indexed_epoch: 55
128/128 - 158s - loss: 0.1855 - accuracy: 0.7917 - 158s/epoch - 1s/step
Epoch 56/60
Validation cm: [[37 84  9 42]
 [15 29  4 22]
 [ 1  9  0  8]
 [ 6 15  0 18]]
Validation normalized_cm: [[0.215 0.488 0.052 0.244]
 [0.214 0.414 0.057 0.314]
 [0.056 0.5   0.    0.444]
 [0.154 0.385 0.    0.462]]
Validation acc: 0.2809364548494983
Validation class_accuracies: [0.21511627906976744, 0.4142857142857143, 0.0, 0.46153846153846156]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.2727351137234858
Validation one_indexed_epoch: 56
128/128 - 157s - loss: 0.1851 - accuracy: 0.7848 - 157s/epoch - 1s/step
Epoch 57/60
Validation cm: [[48 83 20 21]
 [13 29 14 14]
 [ 4  7  1  6]
 [ 9 19  3  8]]
Validation normalized_cm: [[0.279 0.483 0.116 0.122]
 [0.186 0.414 0.2   0.2  ]
 [0.222 0.389 0.056 0.333]
 [0.231 0.487 0.077 0.205]]
Validation acc: 0.28762541806020064
Validation class_accuracies: [0.27906976744186046, 0.4142857142857143, 0.05555555555555555, 0.20512820512820512]
Validation precision: None
Validation recall: None
Validation f1: None
Validation roc_auc: None
Validation avg_accuracy: 0.23850981060283388
Validation one_indexed_epoch: 57
128/128 - 157s - loss: 0.1777 - accuracy: 0.7672 - 157s/epoch - 1s/step
Epoch 58/60
2022-05-14 19:54:25.931130: F tensorflow/core/platform/default/env.cc:73] Check failed: ret == 0 (11 vs. 0)Thread tf_data_iterator_resource creation via pthread_create() failed.
